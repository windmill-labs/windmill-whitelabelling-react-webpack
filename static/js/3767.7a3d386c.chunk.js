"use strict";(self.webpackChunkWindmill_Whitelabel_Example=self.webpackChunkWindmill_Whitelabel_Example||[]).push([[3767],{3767:(e,t,i)=>{i.d(t,{_:()=>Lt,a:()=>Ud,c:()=>xn,d:()=>xs,f:()=>Es,g:()=>Qt,h:()=>ii,i:()=>em,l:()=>kn,m:()=>Yt,n:()=>tm,o:()=>Ga,p:()=>hi,r:()=>im,s:()=>Vn,t:()=>om,u:()=>En});var o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C,w,y,f,S,E,k,_,I,x,A,V,D,M,T,R,O,W,L,J,G,N,K,Z,B,P,F,Y,Q,X,H,U,j,z,q,$,ee,te,ie,oe,se,re,ne,ae,de,le,ce,he,ue,ge,pe,be,me,ve,Ce,we,ye,fe,Se,Ee,ke,_e,Ie,xe,Ae,Ve,De,Me,Te,Re,Oe,We,Le,Je,Ge,Ne,Ke,Ze,Be,Pe,Fe,Ye,Qe,Xe,He,Ue,je,ze,qe,$e,et,tt,it,ot,st,rt=i(9379),nt=i(9495),at=i(1359),dt=i(6095),lt=i(3373),ct=i(2182),ht=i(8638),ut=i(3227),gt=i(8871),pt=i(1439),bt=i(1070),mt=i(1532),vt=i(6361),Ct=i(5537),wt=i(8610),yt=i(2278),ft=i(9796),St=i(3087),Et=i(6300);(0,at.Xb)(),(0,at.Mb)(),(0,dt.f)(),(0,at.ox)(),(0,at.Kb)(),(0,at.Tb)(),(0,at.Ol)(),(0,at.Lo)(),(0,at.yb)(),(0,at.Xd)(),(0,at.Ma)(),(0,ut.N)(),(0,pt.Nt)(),(0,ut.q)();var kt=class extends dt.l{constructor(e,t,i,o,s,r,n,a){super(e,t,s,i),this.storageService=i,this.instantiationService=o,this.contextMenuService=r,this.extensionService=n,this.contextService=a}create(e){super.create(e),this.viewPaneContainer=this._register(this.createViewPaneContainer(e)),this._register(this.viewPaneContainer.onTitleAreaUpdate(()=>this.updateTitleArea())),this.viewPaneContainer.create(e)}setVisible(e){var t;super.setVisible(e),null===(t=this.viewPaneContainer)||void 0===t||t.setVisible(e)}layout(e){var t;null===(t=this.viewPaneContainer)||void 0===t||t.layout(e)}setBoundarySashes(e){var t;null===(t=this.viewPaneContainer)||void 0===t||t.setBoundarySashes(e)}getOptimalWidth(){var e,t;return null!==(e=null===(t=this.viewPaneContainer)||void 0===t?void 0:t.getOptimalWidth())&&void 0!==e?e:0}openView(e,t){var i;return null===(i=this.viewPaneContainer)||void 0===i?void 0:i.openView(e,t)}getViewPaneContainer(){return this.viewPaneContainer}getActionsContext(){var e;return null===(e=this.getViewPaneContainer())||void 0===e?void 0:e.getActionsContext()}getContextMenuActions(){var e,t;return null!==(e=null===(t=this.viewPaneContainer)||void 0===t||null===(t=t.menuActions)||void 0===t?void 0:t.getContextMenuActions())&&void 0!==e?e:[]}getMenuIds(){var e;let t=[];return null!==(e=this.viewPaneContainer)&&void 0!==e&&e.menuActions&&(t.push(this.viewPaneContainer.menuActions.menuId),this.viewPaneContainer.isViewMergedWithContainer()&&t.push(this.viewPaneContainer.panes[0].menuActions.menuId)),t}getActions(){var e;let t=[];if(null!==(e=this.viewPaneContainer)&&void 0!==e&&e.menuActions&&(t.push(...this.viewPaneContainer.menuActions.getPrimaryActions()),this.viewPaneContainer.isViewMergedWithContainer())){let e=this.viewPaneContainer.panes[0];e.shouldShowFilterInHeader()&&t.push(ut.U),t.push(...e.menuActions.getPrimaryActions())}return t}getSecondaryActions(){var e;if(null===(e=this.viewPaneContainer)||void 0===e||!e.menuActions)return[];let t=this.viewPaneContainer.isViewMergedWithContainer()?this.viewPaneContainer.panes[0].menuActions.getSecondaryActions():[],i=this.viewPaneContainer.menuActions.getSecondaryActions(),o=i.findIndex(e=>e instanceof at.wb&&e.item.submenu===ut.M);if(-1!==o){let e=i[o];e.actions.some(e=>{let{enabled:t}=e;return t})?1===i.length&&0===t.length?i=e.actions.slice():0!==o&&(i=[e,...i.slice(0,o),...i.slice(o+1)]):i.splice(o,1)}return i.length&&t.length?[...i,new at.Wb,...t]:i.length?i:t}getActionViewItem(e,t){var i;return null===(i=this.viewPaneContainer)||void 0===i?void 0:i.getActionViewItem(e,t)}getTitle(){var e,t;return null!==(e=null===(t=this.viewPaneContainer)||void 0===t?void 0:t.getTitle())&&void 0!==e?e:""}focus(){var e;super.focus(),null===(e=this.viewPaneContainer)||void 0===e||e.focus()}};kt=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.Io),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,at.Yd),(0,at.Yb)(5,at.El),(0,at.Yb)(6,pt.Mt),(0,at.Yb)(7,at.ja)],kt);var _t=class e extends dt.u{static create(t,i,o,s,r,n,a){return new e(t,i,o,s,r,n,a)}constructor(e,t,i,o,s,r,n){super(e,t,i,o,s,r),this.iconUrl=n}},It="workbench.contributions.viewlets",xt="workbench.contributions.panels",At="workbench.contributions.auxiliary",Vt=class extends dt.d{registerPaneComposite(e){super.registerComposite(e)}deregisterPaneComposite(e){super.deregisterComposite(e)}getPaneComposite(e){return this.getComposite(e)}getPaneComposites(){return this.getComposites()}};at.jb.add(It,new Vt),at.jb.add(xt,new Vt),at.jb.add(At,new Vt),(0,at.vE)(),(0,at.TM)(),(0,at.zc)(),(0,at.wj)(),(0,at.sj)(),(0,at.aP)(),(0,at.Ur)(),(0,at.Bn)(),(0,gt.pt)(),(0,at.Vo)(),(0,at.au)(),(0,at.Va)(),(0,at.oS)(),(0,at.vl)(),(0,at.GM)(),(0,at.ei)(),(0,ut.Z)(),(0,dt.pr)(),(0,at.Ii)(),(0,at.ia)(),(0,at.bE)({});var Dt,Mt,Tt,Rt=class extends gt.ft{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super(b,m,a,t,o),this.notificationService=e,this.storageService=t,this.contextMenuService=i,this.keybindingService=s,this.hoverService=r,this.instantiationService=n,this.registry=d,this.activeCompositeSettingsKey=l,this.defaultCompositeId=c,this.nameForTelemetry=h,this.compositeCSSClass=u,this.titleForegroundColor=g,this.titleBorderColor=p,this.onDidCompositeOpen=this._register(new at.ej),this.onDidCompositeClose=this._register(new at.ej),this.mapCompositeToCompositeContainer=new Map,this.mapActionsBindingToComposite=new Map,this.instantiatedCompositeItems=new Map,this.actionsListener=this._register(new at.vj),this.lastActiveCompositeId=t.get(l,at.Ro.WORKSPACE,this.defaultCompositeId),this.toolbarHoverDelegate=this._register((0,at.na)())}openComposite(e,t){var i;return(null===(i=this.activeComposite)||void 0===i?void 0:i.getId())===e?(t&&this.activeComposite.focus(),this.activeComposite):this.element?this.doOpenComposite(e,t):void 0}doOpenComposite(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=at.Rc.nextId();this.currentCompositeOpenToken=o,this.activeComposite&&this.hideActiveComposite(),this.updateTitle(e);let s=this.createComposite(e,!0);if(!(this.currentCompositeOpenToken!==o||this.activeComposite&&this.activeComposite.getId()!==s.getId()))return(null===(t=this.activeComposite)||void 0===t?void 0:t.getId())===s.getId()?(i&&s.focus(),this.onDidCompositeOpen.fire({composite:s,focus:i}),s):(this.showComposite(s),i&&s.focus(),s&&this.onDidCompositeOpen.fire({composite:s,focus:i}),s)}createComposite(e,t){let i=this.instantiatedCompositeItems.get(e);if(i)return i.composite;let o=this.registry.getComposite(e);if(o){let i=this,s=new ut.X((0,at.UM)(this.progressBar),new class extends ut.J{constructor(){super(o.id,!!t),this._register(i.onDidCompositeOpen.event(e=>this.onScopeOpened(e.composite.getId()))),this._register(i.onDidCompositeClose.event(e=>this.onScopeClosed(e.getId())))}}),r=this._register(this.instantiationService.createChild(new at.iu([at.za,s]))),n=o.instantiate(r),a=new at.gj;return this.instantiatedCompositeItems.set(e,{composite:n,disposable:a,progress:s}),a.add(n.onTitleAreaUpdate(()=>this.onTitleAreaUpdate(n.getId()),this)),a.add(r),n}throw Error("Unable to find composite with id ".concat(e))}showComposite(e){var t;this.activeComposite=e;let i=this.activeComposite.getId();i===this.defaultCompositeId?this.storageService.remove(this.activeCompositeSettingsKey,at.Ro.WORKSPACE):this.storageService.store(this.activeCompositeSettingsKey,i,at.Ro.WORKSPACE,at.zo.MACHINE),this.lastActiveCompositeId=this.activeComposite.getId();let o=this.mapCompositeToCompositeContainer.get(e.getId());if(o||(o=(0,at.px)(".composite"),o.classList.add(...this.compositeCSSClass.split(" ")),o.id=e.getId(),e.create(o),e.updateStyles(),this.mapCompositeToCompositeContainer.set(e.getId(),o)),!this.activeComposite||e.getId()!==this.activeComposite.getId())return;null!==(t=this.getContentArea())&&void 0!==t&&t.appendChild(o),(0,at.BS)(o);let s=(0,at.UM)(this.toolBar);s.actionRunner=e.getActionRunner();let r=this.registry.getComposite(e.getId());r&&r.name!==e.getTitle()&&this.updateTitle(e.getId(),e.getTitle());let n=this.mapActionsBindingToComposite.get(e.getId());n||(n=this.collectCompositeActions(e),this.mapActionsBindingToComposite.set(e.getId(),n)),n(),this.actionsListener.value=s.actionRunner.onDidRun(e=>{e.error&&!(0,at.oP)(e.error)&&this.notificationService.error(e.error)}),e.setVisible(!0),this.activeComposite&&e.getId()===this.activeComposite.getId()&&(this.contentAreaSize&&e.layout(this.contentAreaSize),this.boundarySashes&&e.setBoundarySashes(this.boundarySashes))}onTitleAreaUpdate(e){var t;let i=this.instantiatedCompositeItems.get(e);if(i&&this.updateTitle(e,i.composite.getTitle()),(null===(t=this.activeComposite)||void 0===t?void 0:t.getId())===e){let e=this.collectCompositeActions(this.activeComposite);this.mapActionsBindingToComposite.set(this.activeComposite.getId(),e),e()}else this.mapActionsBindingToComposite.delete(e)}updateTitle(e,t){var i;let o=this.registry.getComposite(e);if(!o||!this.titleLabel)return;t||(t=o.name);let s=this.keybindingService.lookupKeybinding(e);this.titleLabel.updateTitle(e,t,null!==(i=null===s||void 0===s?void 0:s.getLabel())&&void 0!==i?i:void 0),(0,at.UM)(this.toolBar).setAriaLabel((0,at.EM)(2958,"{0} actions",t))}collectCompositeActions(e){let t=null===e||void 0===e?void 0:e.getMenuIds(),i=(null===e||void 0===e?void 0:e.getActions().slice(0))||[],o=(null===e||void 0===e?void 0:e.getSecondaryActions().slice(0))||[],s=(0,at.UM)(this.toolBar);return s.context=this.actionsContextProvider(),()=>s.setActions((0,at.Wr)(i),(0,at.Wr)(o),t)}getActiveComposite(){return this.activeComposite}getLastActiveCompositeId(){return this.lastActiveCompositeId}hideActiveComposite(){var e;if(!this.activeComposite)return;let t=this.activeComposite;this.activeComposite=void 0;let i=this.mapCompositeToCompositeContainer.get(t.getId());return t.setVisible(!1),i&&(i.remove(),(0,at.aS)(i)),null!==(e=this.progressBar)&&void 0!==e&&e.stop().hide(),this.toolBar&&this.collectCompositeActions()(),this.onDidCompositeClose.fire(t),t}createTitleArea(e){let t=(0,at.Dx)(e,(0,at.px)(".composite"));t.classList.add("title"),this.titleLabel=this.createTitleLabel(t);let i=(0,at.Dx)(t,(0,at.px)(".title-actions"));return this.toolBar=this._register(this.instantiationService.createInstance(dt.fr,i,{actionViewItemProvider:(e,t)=>this.actionViewItemProvider(e,t),orientation:at.Hr.HORIZONTAL,getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:(0,at.EM)(2959,"Views and More Actions..."),telemetrySource:this.nameForTelemetry,hoverDelegate:this.toolbarHoverDelegate})),this.collectCompositeActions()(),t}createTitleLabel(e){let t=(0,at.Dx)((0,at.Dx)(e,(0,at.px)(".title-label")),(0,at.px)("h2"));this.titleLabelElement=t;let i=this._register(this.hoverService.setupManagedHover((0,at.ra)("mouse"),t,"")),o=this;return{updateTitle:(e,o,s)=>{(!this.activeComposite||this.activeComposite.getId()===e)&&(t.textContent=o,i.update(s?(0,at.EM)(2960,"{0} ({1})",o,s):o))},updateStyles:()=>{t.style.color=o.titleForegroundColor&&o.getColor(o.titleForegroundColor)||"";let i=o.titleBorderColor?o.getColor(o.titleBorderColor):void 0;e.style.borderBottom=i?"1px solid ".concat(i):""}}}createHeaderArea(){return(0,at.px)(".composite")}createFooterArea(){return(0,at.px)(".composite")}updateStyles(){super.updateStyles(),(0,at.UM)(this.titleLabel).updateStyles()}actionViewItemProvider(e,t){return this.activeComposite?this.activeComposite.getActionViewItem(e,t):(0,at.Jr)(this.instantiationService,e,t)}actionsContextProvider(){return this.activeComposite?this.activeComposite.getActionsContext():null}createContentArea(e){let t=(0,at.Dx)(e,(0,at.px)(".content"));return this.progressBar=this._register(new at.zn(t,at.Ni)),this.progressBar.hide(),t}getProgressIndicator(e){let t=this.instantiatedCompositeItems.get(e);return t?t.progress:void 0}getTitleAreaDropDownAnchorAlignment(){return at.gl.RIGHT}layout(e,t,i,o){var s;super.layout(e,t,i,o),this.contentAreaSize=at.mx.lift(super.layoutContents(e,t).contentSize),null===(s=this.activeComposite)||void 0===s||s.layout(this.contentAreaSize)}setBoundarySashes(e){var t;this.boundarySashes=e,null===(t=this.activeComposite)||void 0===t||t.setBoundarySashes(e)}removeComposite(e){var t;if((null===(t=this.activeComposite)||void 0===t?void 0:t.getId())===e)return!1;this.mapCompositeToCompositeContainer.delete(e),this.mapActionsBindingToComposite.delete(e);let i=this.instantiatedCompositeItems.get(e);return i&&(i.composite.dispose(),(0,at.Sj)(i.disposable),this.instantiatedCompositeItems.delete(e)),!0}dispose(){this.mapCompositeToCompositeContainer.clear(),this.mapActionsBindingToComposite.clear(),this.instantiatedCompositeItems.forEach(e=>{e.composite.dispose(),(0,at.Sj)(e.disposable)}),this.instantiatedCompositeItems.clear(),super.dispose()}};(0,at.vE)(),(0,at.Xb)(),(0,at.sj)(),(0,at.ox)(),(0,ut.xf)(),(0,ut.yb)(),(0,at.wj)(),(0,pt.W)(),(0,pt.st)(),(0,gt.E)(),(0,at.oS)(),(0,at.Mb)(),(0,at.Fd)(),(0,at.Lo)(),(0,at.Ol)(),(0,at.Dd)(),(0,at.Xd)(),(0,at.Pb)(),(0,pt.Nt)(),(0,at.TM)(),(0,ut.B)(),(0,dt.er)(),(0,at.Tb)(),(0,at.ni)(),(0,at.Ur)(),(0,at.lm)(),(0,at.HT)(),(0,at.Kb)(),(0,ut.N)(),(0,at.ei)(),(0,at.rr)(),(0,dt.pr)(),(0,at.Ww)(),(0,at.bE)({}),(Tt=Mt||(Mt={}))[Tt.TOP=0]="TOP",Tt[Tt.TITLE=1]="TITLE",Tt[Tt.BOTTOM=2]="BOTTOM";var Ot,Wt=(o=class extends Rt{get snap(){var e;return this.layoutService.isVisible(this.partId)||!(null===(e=this.paneCompositeBar.value)||void 0===e||!e.getVisiblePaneCompositeIds().length)}get onDidPaneCompositeOpen(){return at.tj.map(this.onDidCompositeOpen.event,e=>e.composite)}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C,w,y){var f;let S=ut.gf.Sidebar,E=It,k=at.xb.SidebarTitle;e===pt.V.PANEL_PART?(S=ut.gf.Panel,E=xt,k=at.xb.PanelTitle):e===pt.V.AUXILIARYBAR_PART&&(S=ut.gf.AuxiliaryBar,E=At,k=at.xb.AuxiliaryBarTitle),super(l,c,h,u,g,p,b,m,at.jb.as(E),i,(null===(f=v.getDefaultViewContainer(S))||void 0===f?void 0:f.id)||"",r,n,a,d,e,t),this.partId=e,this.activePaneContextKey=o,this.paneFocusContextKey=s,this.viewDescriptorService=v,this.contextKeyService=C,this.extensionService=w,this.menuService=y,this.onDidPaneCompositeClose=this.onDidCompositeClose.event,this.headerFooterCompositeBarDispoables=this._register(new at.gj),this.paneCompositeBar=this._register(new at.vj),this.compositeBarPosition=void 0,this.blockOpening=void 0,this.location=S,this.globalActionsMenuId=k,this.registerListeners()}registerListeners(){this._register(this.onDidPaneCompositeOpen(e=>this.onDidOpen(e))),this._register(this.onDidPaneCompositeClose(this.onDidClose,this)),this._register(this.registry.onDidDeregister(e=>{let t=this.viewDescriptorService.getViewContainersByLocation(this.location).filter(e=>this.viewDescriptorService.getViewContainerModel(e).activeViewDescriptors.length>0);var i;if(t.length){if((null===(i=this.getActiveComposite())||void 0===i?void 0:i.getId())===e.id){var o;let e=null===(o=this.viewDescriptorService.getDefaultViewContainer(this.location))||void 0===o?void 0:o.id,i=t.filter(t=>t.id===e)[0]||t[0];this.doOpenPaneComposite(i.id)}}else this.layoutService.setPartHidden(!0,this.partId);this.removeComposite(e.id)})),this._register(this.extensionService.onDidRegisterExtensions(()=>{this.layoutCompositeBar()}))}onDidOpen(e){this.activePaneContextKey.set(e.getId())}onDidClose(e){let t=e.getId();this.activePaneContextKey.get()===t&&this.activePaneContextKey.reset()}showComposite(e){super.showComposite(e),this.layoutCompositeBar(),this.layoutEmptyMessage()}hideActiveComposite(){let e=super.hideActiveComposite();return this.layoutCompositeBar(),this.layoutEmptyMessage(),e}create(e){this.element=e,this.element.classList.add("pane-composite-part"),super.create(e);let t=this.getContentArea();t&&this.createEmptyPaneMessage(t),this.updateCompositeBar();let i=this._register((0,at.US)(e));this._register(i.onDidFocus(()=>this.paneFocusContextKey.set(!0))),this._register(i.onDidBlur(()=>this.paneFocusContextKey.set(!1)))}createEmptyPaneMessage(e){this.emptyPaneMessageElement=(0,at.px)(".empty-pane-message-area");let t=(0,at.px)(".empty-pane-message");t.textContent=(0,at.EM)(3503,"Drag a view here to display."),this.emptyPaneMessageElement.appendChild(t),e.appendChild(this.emptyPaneMessageElement);let i=e=>{var t;let i=!this.getActiveComposite()||!e,o=e&&(null===(t=this.theme.getColor(dt._t))||void 0===t?void 0:t.toString())||"";this.titleContainer&&i&&(this.titleContainer.style.backgroundColor=o),this.headerFooterCompositeBarContainer&&i&&(this.headerFooterCompositeBarContainer.style.backgroundColor=o),this.emptyPaneMessageElement.style.backgroundColor=o};this._register(ut.P.INSTANCE.registerTarget(this.element,{onDragOver:e=>{if(at.gx.stop(e.eventData,!0),this.paneCompositeBar.value){let t=this.paneCompositeBar.value.dndHandler.onDragEnter(e.dragAndDropData,void 0,e.eventData);(0,ut.H)(e.eventData.dataTransfer,"move",t)}},onDragEnter:e=>{at.gx.stop(e.eventData,!0),this.paneCompositeBar.value&&i(this.paneCompositeBar.value.dndHandler.onDragEnter(e.dragAndDropData,void 0,e.eventData))},onDragLeave:e=>{at.gx.stop(e.eventData,!0),i(!1)},onDragEnd:e=>{at.gx.stop(e.eventData,!0),i(!1)},onDrop:e=>{if(at.gx.stop(e.eventData,!0),i(!1),this.paneCompositeBar.value)this.paneCompositeBar.value.dndHandler.drop(e.dragAndDropData,void 0,e.eventData);else{let t=e.dragAndDropData.getData();if("composite"===t.type){let e=this.viewDescriptorService.getViewContainerById(t.id);this.viewDescriptorService.moveViewContainerToLocation(e,this.location,void 0,"dnd"),this.openPaneComposite(e.id,!0)}else if("view"===t.type){let e=this.viewDescriptorService.getViewDescriptorById(t.id);if(e&&e.canMoveView){this.viewDescriptorService.moveViewToLocation(e,this.location,"dnd");let t=this.viewDescriptorService.getViewContainerByViewId(e.id);this.openPaneComposite(t.id,!0).then(t=>{null===t||void 0===t||t.openView(e.id,!0)})}}}}}))}createTitleArea(e){let t=super.createTitleArea(e);this._register((0,at.Sx)(t,at._x.CONTEXT_MENU,e=>{this.onTitleAreaContextMenu(new at.BT((0,at.$x)(t),e))})),this._register(at.cm.addTarget(t)),this._register((0,at.Sx)(t,at.sm.Contextmenu,e=>{this.onTitleAreaContextMenu(new at.BT((0,at.$x)(t),e))}));let i=t.appendChild((0,at.px)(".global-actions"));return this.globalToolBar=this._register(this.instantiationService.createInstance(dt.dr,i,this.globalActionsMenuId,{actionViewItemProvider:(e,t)=>this.actionViewItemProvider(e,t),orientation:at.Hr.HORIZONTAL,getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:(0,at.EM)(3504,"More Actions..."),hoverDelegate:this.toolbarHoverDelegate,hiddenItemStrategy:dt.ur.NoHide,highlightToggledItems:!0,telemetrySource:this.nameForTelemetry})),t}createTitleLabel(e){this.titleContainer=e;let t=super.createTitleLabel(e);return this.titleLabelElement.draggable=!0,this._register(ut.P.INSTANCE.registerDraggable(this.titleLabelElement,()=>({type:"composite",id:this.getActivePaneComposite().getId()}),{})),t}updateCompositeBar(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=void 0!==this.compositeBarPosition,o=this.shouldShowCompositeBar(),s=this.compositeBarPosition,r=o?this.getCompositeBarPosition():void 0;if(t||s!==r){if(i){let e=s===Mt.TITLE?this.titleContainer:this.headerFooterCompositeBarContainer;if(!this.paneCompositeBarContainer||!this.paneCompositeBar.value||!e)throw Error("Composite bar containers should exist when removing the previous composite bar");this.paneCompositeBarContainer.remove(),this.paneCompositeBarContainer=void 0,this.paneCompositeBar.value=void 0,e.classList.remove("has-composite-bar"),s===Mt.TOP?this.removeFooterHeaderArea(!0):s===Mt.BOTTOM&&this.removeFooterHeaderArea(!1)}switch(r){case Mt.TOP:e=this.createHeaderArea();break;case Mt.TITLE:e=this.titleContainer;break;case Mt.BOTTOM:e=this.createFooterArea()}if(o){if(this.paneCompositeBarContainer||this.paneCompositeBar.value||!e)throw Error("Invalid composite bar state when creating the new composite bar");e.classList.add("has-composite-bar"),this.paneCompositeBarContainer=(0,at.kS)(e,(0,at.px)(".composite-bar-container")),this.paneCompositeBar.value=this.createCompositeBar(),this.paneCompositeBar.value.create(this.paneCompositeBarContainer),r===Mt.TOP?this.setHeaderArea(e):r===Mt.BOTTOM&&this.setFooterArea(e)}this.compositeBarPosition=r,t&&this.layoutCompositeBar()}}createHeaderArea(){let e=super.createHeaderArea();return this.createHeaderFooterCompositeBarArea(e)}createFooterArea(){let e=super.createFooterArea();return this.createHeaderFooterCompositeBarArea(e)}createHeaderFooterCompositeBarArea(e){if(this.headerFooterCompositeBarContainer)throw Error("Header or Footer composite bar already exists");return this.headerFooterCompositeBarContainer=e,this.headerFooterCompositeBarDispoables.add((0,at.Sx)(e,at._x.CONTEXT_MENU,t=>{this.onCompositeBarAreaContextMenu(new at.BT((0,at.$x)(e),t))})),this.headerFooterCompositeBarDispoables.add(at.cm.addTarget(e)),this.headerFooterCompositeBarDispoables.add((0,at.Sx)(e,at.sm.Contextmenu,t=>{this.onCompositeBarAreaContextMenu(new at.BT((0,at.$x)(e),t))})),e}removeFooterHeaderArea(e){this.headerFooterCompositeBarContainer=void 0,this.headerFooterCompositeBarDispoables.clear(),e?this.removeHeaderArea():this.removeFooterArea()}createCompositeBar(){return this.instantiationService.createInstance(gt.T,this.getCompositeBarOptions(),this.partId,this)}onTitleAreaUpdate(e){super.onTitleAreaUpdate(e),this.layoutCompositeBar()}async openPaneComposite(e,t){if("string"==typeof e&&this.getPaneComposite(e)||(await this.extensionService.whenInstalledExtensionsRegistered(),"string"==typeof e&&this.getPaneComposite(e)))return this.doOpenPaneComposite(e,t)}async doOpenPaneComposite(e,t){if(this.blockOpening)return this.blockOpening.p;let i;if(!this.layoutService.isVisible(this.partId))try{i=this.blockOpening=new at.xw,this.layoutService.setPartHidden(!1,this.partId)}finally{this.blockOpening=void 0}try{var o;let s=this.openComposite(e,t);return null!==(o=i)&&void 0!==o&&o.complete(s),s}catch(e){var s;throw null!==(s=i)&&void 0!==s&&s.error(e),e}}getPaneComposite(e){return this.registry.getPaneComposite(e)}getPaneComposites(){return this.registry.getPaneComposites().sort((e,t)=>"number"==typeof e.order?"number"==typeof t.order?e.order-t.order:-1:1)}getPinnedPaneCompositeIds(){var e,t;return null!==(e=null===(t=this.paneCompositeBar.value)||void 0===t?void 0:t.getPinnedPaneCompositeIds())&&void 0!==e?e:[]}getVisiblePaneCompositeIds(){var e,t;return null!==(e=null===(t=this.paneCompositeBar.value)||void 0===t?void 0:t.getVisiblePaneCompositeIds())&&void 0!==e?e:[]}getPaneCompositeIds(){var e,t;return null!==(e=null===(t=this.paneCompositeBar.value)||void 0===t?void 0:t.getPaneCompositeIds())&&void 0!==e?e:[]}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.layoutService.isVisible(this.partId)&&this.layoutService.setPartHidden(!0,this.partId),this.hideActiveComposite()}focusCompositeBar(){var e;null===(e=this.paneCompositeBar.value)||void 0===e||e.focus()}layout(e,t,i,o){this.layoutService.isVisible(this.partId)&&(this.contentDimension=new at.mx(e,t),super.layout(this.contentDimension.width,this.contentDimension.height,i,o),this.layoutCompositeBar(),this.layoutEmptyMessage())}layoutCompositeBar(){if(this.contentDimension&&this.dimension&&this.paneCompositeBar.value){let e=this.compositeBarPosition===Mt.TITLE?16:8,t=this.partId===pt.V.PANEL_PART?0:1,i=this.contentDimension.width-e-t;i=Math.max(Dt.MIN_COMPOSITE_BAR_WIDTH,i-this.getToolbarWidth()),this.paneCompositeBar.value.layout(i,this.dimension.height)}}layoutEmptyMessage(){var e;let t=!this.getActiveComposite();this.element.classList.toggle("empty",t),t&&(null===(e=this.titleLabel)||void 0===e||e.updateTitle("",""))}getToolbarWidth(){return this.toolBar&&this.compositeBarPosition===Mt.TITLE&&this.getActivePaneComposite()?this.toolBar.getItemsWidth()+4*this.toolBar.getItemsLength()+(this.globalToolBar?this.globalToolBar.getItemsWidth()+4*this.globalToolBar.getItemsLength():0)+5:0}onTitleAreaContextMenu(e){if(this.shouldShowCompositeBar()&&this.getCompositeBarPosition()===Mt.TITLE)return this.onCompositeBarContextMenu(e);{let t=this.getActivePaneComposite(),i=t?t.getContextMenuActions():[];i.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>i,getActionViewItem:(e,t)=>this.actionViewItemProvider(e,t),actionRunner:t.getActionRunner(),skipTelemetry:!0})}}onCompositeBarAreaContextMenu(e){return this.onCompositeBarContextMenu(e)}onCompositeBarContextMenu(e){if(this.paneCompositeBar.value){let t=[...this.paneCompositeBar.value.getContextMenuActions()];t.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>t,skipTelemetry:!0})}}getViewsSubmenuAction(){var e;let t=null===(e=this.getActivePaneComposite())||void 0===e?void 0:e.getViewPaneContainer();if(t){let e=new at.gj,i=e.add(this.contextKeyService.createScoped(this.element));i.createKey("viewContainer",t.viewContainer.id);let o=(0,at.Xr)(this.menuService.getMenuActions(ut.M,i,{shouldForwardArgs:!0,renderShortTitle:!0}),()=>!0).primary;return e.dispose(),o.length>1&&o.some(e=>e.enabled)?new at.Gb("views",(0,at.EM)(3505,"Views"),o):void 0}}},{_:Dt=o},{_:o.MIN_COMPOSITE_BAR_WIDTH=50},o);Wt=Dt=(0,at.Jb)([(0,at.Yb)(9,at.Pd),(0,at.Yb)(10,at.Io),(0,at.Yb)(11,at.El),(0,at.Yb)(12,pt.ot),(0,at.Yb)(13,at.Ed),(0,at.Yb)(14,at.nr),(0,at.Yb)(15,at.rx),(0,at.Yb)(16,at.Yd),(0,at.Yb)(17,ut.vb),(0,at.Yb)(18,at.Nb),(0,at.Yb)(19,pt.Mt),(0,at.Yb)(20,at.ti)],Wt),(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.Pb)(),(0,at.Ol)(),(0,at.ox)(),(0,at.Dd)(),(0,at.Fd)(),(0,at.Lo)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.Xd)(),(0,pt.tr)(),(0,dt.er)(),(0,ut.yb)(),(0,pt.Nt)(),(0,pt.W)(),(0,pt.st)(),(0,at.Tl)(),(0,at.Kb)(),(0,gt.rt)(),(0,at.GM)(),(0,at.Xt)(),(0,gt.tt)(),(0,at.Rb)(),(0,at.Ur)(),(0,at.Tb)(),(0,at.ni)(),(0,at.i_)(),(0,at.ei)(),(0,at.rr)(),(0,at.bE)({});var Lt=(s=class extends Wt{get preferredHeight(){return.4*this.layoutService.mainContainerDimension.height}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g){super(pt.V.AUXILIARYBAR_PART,{hasTitle:!0,borderWidth:()=>this.getColor(dt.Zt)||this.getColor(at.dg)?1:0},Ot.activeViewSettingsKey,pt.Jt.bindTo(l),pt.dn.bindTo(l),"auxiliarybar","auxiliarybar",void 0,dt.on,e,t,i,o,s,r,n,a,d,l,c,u),this.commandService=h,this.configurationService=g,this.minimumWidth=170,this.maximumWidth=1/0,this.minimumHeight=0,this.maximumHeight=1/0,this.priority=at.qt.Low,this.configuration=this.resolveConfiguration(),this._register(g.onDidChangeConfiguration(e=>{e.affectsConfiguration(pt.z.ACTIVITY_BAR_LOCATION)?(this.configuration=this.resolveConfiguration(),this.onDidChangeActivityBarLocation()):e.affectsConfiguration("workbench.secondarySideBar.showLabels")&&(this.configuration=this.resolveConfiguration(),this.updateCompositeBar(!0))}))}resolveConfiguration(){let e=this.configurationService.getValue(pt.z.ACTIVITY_BAR_LOCATION),t=e!==pt.I.TOP&&e!==pt.I.BOTTOM;return{position:e,canShowLabels:t,showLabels:t&&!1!==this.configurationService.getValue("workbench.secondarySideBar.showLabels")}}onDidChangeActivityBarLocation(){var e;this.updateCompositeBar();let t=null===(e=this.getActiveComposite())||void 0===e?void 0:e.getId();t&&this.onTitleAreaUpdate(t)}updateStyles(){super.updateStyles();let e=(0,at.UM)(this.getContainer());e.style.backgroundColor=this.getColor(dt.Xt)||"";let t=this.getColor(dt.Zt)||this.getColor(at.dg),i=this.layoutService.getSideBarPosition()===pt.H.RIGHT;e.style.color=this.getColor(dt.$t)||"",e.style.borderLeftColor=null!==t&&void 0!==t?t:"",e.style.borderRightColor=null!==t&&void 0!==t?t:"",e.style.borderLeftStyle=t&&!i?"solid":"none",e.style.borderRightStyle=t&&i?"solid":"none",e.style.borderLeftWidth=t&&!i?"1px":"0px",e.style.borderRightWidth=t&&i?"1px":"0px"}getCompositeBarOptions(){let e=this;return{partContainerClass:"auxiliarybar",pinnedViewContainersKey:Ot.pinnedViewsKey,placeholderViewContainersKey:Ot.placeholdeViewContainersKey,viewContainersWorkspaceStateKey:Ot.viewContainersWorkspaceStateKey,icon:!this.configuration.showLabels,orientation:at.Hr.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===Mt.BOTTOM?at.xl.ABOVE:at.xl.BELOW},fillExtraContextMenuActions:e=>this.fillExtraContextMenuActions(e),compositeSize:0,iconSize:16,get overflowActionSize(){return e.getCompositeBarPosition()===Mt.TITLE?40:30},colors:t=>({activeBackgroundColor:t.getColor(dt.Xt),inactiveBackgroundColor:t.getColor(dt.Xt),get activeBorderBottomColor(){return e.getCompositeBarPosition()===Mt.TITLE?t.getColor(dt.Nt):t.getColor(dt.pt)},get activeForegroundColor(){return e.getCompositeBarPosition()===Mt.TITLE?t.getColor(dt.Pt):t.getColor(dt.ht)},get inactiveForegroundColor(){return e.getCompositeBarPosition()===Mt.TITLE?t.getColor(dt.Rt):t.getColor(dt.gt)},badgeBackground:t.getColor(dt.st),badgeForeground:t.getColor(dt.ct),get dragAndDropBorder(){return e.getCompositeBarPosition()===Mt.TITLE?t.getColor(dt.Lt):t.getColor(dt.mt)}}),compact:!0}}fillExtraContextMenuActions(e){let t=this.layoutService.getSideBarPosition()===pt.H.LEFT;if(this.getCompositeBarPosition()===Mt.TITLE){let t=this.getViewsSubmenuAction();t&&(e.push(new at.Wb),e.push(t))}let i=(0,at.Zr)(this.menuService.getMenuActions(at.xb.ActivityBarPositionMenu,this.contextKeyService,{shouldForwardArgs:!0,renderShortTitle:!0})).secondary,o=(0,at.qb)({id:"workbench.action.auxiliarybar.toggleShowLabels",label:this.configuration.showLabels?(0,at.EM)(2940,"Show Icons"):(0,at.EM)(2941,"Show Labels"),enabled:this.configuration.canShowLabels,run:()=>this.configurationService.updateValue("workbench.secondarySideBar.showLabels",!this.configuration.showLabels)});e.push(new at.Wb,new at.Gb("workbench.action.panel.position",(0,at.EM)(2942,"Activity Bar Position"),i),(0,at.qb)({id:gt.X.ID,label:t?(0,at.EM)(2943,"Move Secondary Side Bar Left"):(0,at.EM)(2944,"Move Secondary Side Bar Right"),run:()=>this.commandService.executeCommand(gt.X.ID)}),o,(0,at.qb)({id:gt.nt.ID,label:(0,at.EM)(2945,"Hide Secondary Side Bar"),run:()=>this.commandService.executeCommand(gt.nt.ID)}))}shouldShowCompositeBar(){return this.configuration.position!==pt.I.HIDDEN}getCompositeBarPosition(){switch(this.configuration.position){case pt.I.TOP:return Mt.TOP;case pt.I.BOTTOM:return Mt.BOTTOM;case pt.I.HIDDEN:case pt.I.DEFAULT:default:return Mt.TITLE}}toJSON(){return{type:pt.V.AUXILIARYBAR_PART}}},{_:Ot=s},{_:s.activeViewSettingsKey="workbench.auxiliarybar.activepanelid"},{_:s.pinnedViewsKey="workbench.auxiliarybar.pinnedPanels"},{_:s.placeholdeViewContainersKey="workbench.auxiliarybar.placeholderPanels"},{_:s.viewContainersWorkspaceStateKey="workbench.auxiliarybar.viewContainersWorkspaceState"},s);Lt=Ot=(0,at.Jb)([(0,at.Yb)(0,at.Pd),(0,at.Yb)(1,at.Io),(0,at.Yb)(2,at.El),(0,at.Yb)(3,pt.ot),(0,at.Yb)(4,at.Ed),(0,at.Yb)(5,at.nr),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.Yd),(0,at.Yb)(8,ut.vb),(0,at.Yb)(9,at.Nb),(0,at.Yb)(10,pt.Mt),(0,at.Yb)(11,at.Lb),(0,at.Yb)(12,at.ti),(0,at.Yb)(13,at.r_)],Lt);var Jt={};(0,at.vE)(),(0,at.oS)(),(0,at.tn)(),(0,at.Xt)(),(0,at.AN)(),(0,at.kv)(),(0,at.sj)(),(0,at.wj)(),(0,at.WC)(),(0,at.GM)(),(0,at.bE)(Jt);var Gt={separatorBorder:at.Ev.transparent};function Nt(e){return e===at.Zt.VERTICAL?at.Zt.HORIZONTAL:at.Zt.VERTICAL}var Kt=class{constructor(e){this.isLayoutEnabled=e}};function Zt(e,t){if(Math.abs(e)>t)throw Error("Invalid index");return(0,at.GC)(e,t+1)}var Bt=class e{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get absoluteOffset(){return this._absoluteOffset}get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}get styles(){return this._styles}get width(){return this.orientation===at.Zt.HORIZONTAL?this.size:this.orthogonalSize}get height(){return this.orientation===at.Zt.HORIZONTAL?this.orthogonalSize:this.size}get top(){return this.orientation===at.Zt.HORIZONTAL?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return this.orientation===at.Zt.HORIZONTAL?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return 0===this.children.length?0:Math.max(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.minimumOrthogonalSize:0))}get maximumSize(){return Math.min(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.maximumOrthogonalSize:1/0))}get priority(){if(0===this.children.length)return at.qt.Normal;let e=this.children.map(e=>void 0===e.priority?at.qt.Normal:e.priority);return e.some(e=>e===at.qt.High)?at.qt.High:e.some(e=>e===at.qt.Low)?at.qt.Low:at.qt.Normal}get proportionalLayout(){return 0===this.children.length||this.children.every(e=>e.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return this.orientation===at.Zt.HORIZONTAL?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===at.Zt.HORIZONTAL?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===at.Zt.HORIZONTAL?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===at.Zt.HORIZONTAL?this.maximumSize:this.maximumOrthogonalSize}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){if(this._boundarySashes.start!==e.start||this._boundarySashes.end!==e.end||this._boundarySashes.orthogonalStart!==e.orthogonalStart||this._boundarySashes.orthogonalEnd!==e.orthogonalEnd){this._boundarySashes=e,this.splitview.orthogonalStartSash=e.orthogonalStart,this.splitview.orthogonalEndSash=e.orthogonalEnd;for(let t=0;t<this.children.length;t++){let i=this.children[t],o=0===t,s=t===this.children.length-1;i.boundarySashes={start:e.orthogonalStart,end:e.orthogonalEnd,orthogonalStart:o?e.start:i.boundarySashes.orthogonalStart,orthogonalEnd:s?e.end:i.boundarySashes.orthogonalEnd}}}}get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(t){if(this._edgeSnapping!==t){this._edgeSnapping=t;for(let i of this.children)i instanceof e&&(i.edgeSnapping=t);this.updateSplitviewEdgeSnappingEnablement()}}constructor(e,t,i,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,n=arguments.length>7?arguments[7]:void 0;if(this.orientation=e,this.layoutController=t,this.splitviewProportionalLayout=o,this.children=[],this._absoluteOffset=0,this._absoluteOrthogonalOffset=0,this.absoluteOrthogonalSize=0,this._onDidChange=new at.ej,this.onDidChange=this._onDidChange.event,this._onDidVisibilityChange=new at.ej,this.onDidVisibilityChange=this._onDidVisibilityChange.event,this.childrenVisibilityChangeDisposable=new at.gj,this._onDidScroll=new at.ej,this.onDidScrollDisposable=at.mj.None,this.onDidScroll=this._onDidScroll.event,this.childrenChangeDisposable=at.mj.None,this._onDidSashReset=new at.ej,this.onDidSashReset=this._onDidSashReset.event,this.splitviewSashResetDisposable=at.mj.None,this.childrenSashResetDisposable=at.mj.None,this._boundarySashes={},this._edgeSnapping=!1,this._styles=i,this._size=s,this._orthogonalSize=r,this.element=(0,at.px)(".monaco-grid-branch-node"),n){let t={views:n.map(e=>({view:e.node,size:e.node.size,visible:!1!==e.visible})),size:this.orthogonalSize},s={proportionalLayout:o,orientation:e,styles:i};this.children=n.map(e=>e.node),this.splitview=new at.Yt(this.element,(0,rt.A)((0,rt.A)({},s),{},{descriptor:t})),this.children.forEach((e,t)=>{let i=0===t,o=t===this.children.length;e.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:i?this.boundarySashes.start:this.splitview.sashes[t-1],orthogonalEnd:o?this.boundarySashes.end:this.splitview.sashes[t]}})}else this.splitview=new at.Yt(this.element,{orientation:e,styles:i,proportionalLayout:o}),this.splitview.layout(s,{orthogonalSize:r,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:s,absoluteOrthogonalSize:r});this.splitviewSashResetDisposable=at.tj.map(this.splitview.onDidSashReset,e=>[e])(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}style(t){this._styles=t,this.splitview.style(t);for(let i of this.children)i instanceof e&&i.style(t)}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(void 0===i)throw Error("Invalid state");this._size=i.orthogonalSize,this._orthogonalSize=e,this._absoluteOffset=i.absoluteOffset+t,this._absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=i.absoluteOrthogonalSize,this.splitview.layout(i.orthogonalSize,{orthogonalSize:e,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:i.absoluteOrthogonalSize,absoluteOrthogonalSize:i.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(e){for(let t of this.children)t.setVisible(e)}addChild(e,t,i,o){i=Zt(i,this.children.length),this.splitview.addView(e,t,i,o),this.children.splice(i,0,e),this.updateBoundarySashes(),this.onDidChildrenChange()}removeChild(e,t){e=Zt(e,this.children.length);let i=this.splitview.removeView(e,t);return this.children.splice(e,1),this.updateBoundarySashes(),this.onDidChildrenChange(),i}removeAllChildren(){let e=this.splitview.removeAllViews();return this.children.splice(0,this.children.length),this.updateBoundarySashes(),this.onDidChildrenChange(),e}moveChild(e,t){(e=Zt(e,this.children.length))!==(t=Zt(t,this.children.length))&&(e<t&&--t,this.splitview.moveView(e,t),this.children.splice(t,0,this.children.splice(e,1)[0]),this.updateBoundarySashes(),this.onDidChildrenChange())}swapChildren(e,t){(e=Zt(e,this.children.length))!==(t=Zt(t,this.children.length))&&(this.splitview.swapViews(e,t),[this.children[e].boundarySashes,this.children[t].boundarySashes]=[this.children[e].boundarySashes,this.children[t].boundarySashes],[this.children[e],this.children[t]]=[this.children[t],this.children[e]],this.onDidChildrenChange())}resizeChild(e,t){e=Zt(e,this.children.length),this.splitview.resizeView(e,t)}isChildExpanded(e){return this.splitview.isViewExpanded(e)}distributeViewSizes(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.splitview.distributeViewSizes(),t)for(let i of this.children)i instanceof e&&i.distributeViewSizes(!0)}getChildSize(e){return e=Zt(e,this.children.length),this.splitview.getViewSize(e)}isChildVisible(e){return e=Zt(e,this.children.length),this.splitview.isViewVisible(e)}setChildVisible(e,t){if(e=Zt(e,this.children.length),this.splitview.isViewVisible(e)===t)return;let i=0===this.splitview.contentSize;this.splitview.setViewVisible(e,t);let o=0===this.splitview.contentSize;(t&&i||!t&&o)&&this._onDidVisibilityChange.fire(t)}getChildCachedVisibleSize(e){return e=Zt(e,this.children.length),this.splitview.getViewCachedVisibleSize(e)}updateBoundarySashes(){for(let e=0;e<this.children.length;e++)this.children[e].boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:0===e?this.boundarySashes.start:this.splitview.sashes[e-1],orthogonalEnd:e===this.children.length-1?this.boundarySashes.end:this.splitview.sashes[e]}}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){let t=at.tj.map(at.tj.any(...this.children.map(e=>e.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=t(this._onDidChange.fire,this._onDidChange);let i=at.tj.any(...this.children.map((e,t)=>at.tj.map(e.onDidSashReset,e=>[t,...e])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=i(this._onDidSashReset.fire,this._onDidSashReset);let o=at.tj.any(at.tj.signal(this.splitview.onDidScroll),...this.children.map(e=>e.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=o(this._onDidScroll.fire,this._onDidScroll),this.childrenVisibilityChangeDisposable.clear(),this.children.forEach((t,i)=>{t instanceof e&&this.childrenVisibilityChangeDisposable.add(t.onDidVisibilityChange(e=>{this.setChildVisible(i,e)}))})}trySet2x2(e){if(2!==this.children.length||2!==e.children.length||this.getChildSize(0)!==e.getChildSize(0))return at.mj.None;let[t,i]=this.children,[o,s]=e.children;if(!(t instanceof Pt)||!(i instanceof Pt)||!(o instanceof Pt)||!(s instanceof Pt))return at.mj.None;this.orientation===at.Zt.VERTICAL?(i.linkedWidthNode=o.linkedHeightNode=t,t.linkedWidthNode=s.linkedHeightNode=i,s.linkedWidthNode=t.linkedHeightNode=o,o.linkedWidthNode=i.linkedHeightNode=s):(o.linkedWidthNode=i.linkedHeightNode=t,s.linkedWidthNode=t.linkedHeightNode=i,t.linkedWidthNode=s.linkedHeightNode=o,i.linkedWidthNode=o.linkedHeightNode=s);let r=this.splitview.sashes[0],n=e.splitview.sashes[0];return r.linkedSash=n,n.linkedSash=r,this._onDidChange.fire(void 0),e._onDidChange.fire(void 0),(0,at.kj)(()=>{r.linkedSash=n.linkedSash=void 0,t.linkedHeightNode=t.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,o.linkedHeightNode=o.linkedWidthNode=void 0,s.linkedHeightNode=s.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(let e of this.children)e.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this._onDidVisibilityChange.dispose(),this.childrenVisibilityChangeDisposable.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.onDidScrollDisposable.dispose(),this.splitview.dispose()}};var Pt=class{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(e){this._onDidLinkedWidthNodeChange.input=e?e._onDidViewChange:at.tj.None,this._linkedWidthNode=e,this._onDidSetLinkedNode.fire(void 0)}get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(e){this._onDidLinkedHeightNodeChange.input=e?e._onDidViewChange:at.tj.None,this._linkedHeightNode=e,this._onDidSetLinkedNode.fire(void 0)}constructor(e,t,i,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.view=e,this.orientation=t,this.layoutController=i,this._size=0,this.absoluteOffset=0,this.absoluteOrthogonalOffset=0,this.onDidScroll=at.tj.None,this.onDidSashReset=at.tj.None,this._onDidLinkedWidthNodeChange=new at.ij,this._linkedWidthNode=void 0,this._onDidLinkedHeightNodeChange=new at.ij,this._linkedHeightNode=void 0,this._onDidSetLinkedNode=new at.ej,this.disposables=new at.gj,this._boundarySashes={},this.cachedWidth=0,this.cachedHeight=0,this.cachedTop=0,this.cachedLeft=0,this._orthogonalSize=o,this._size=s;let r=function(e){let[t,i]=at.tj.split(e.onDidChange,at.eN);return at.tj.any(i,at.tj.map(at.tj.latch(at.tj.map(t,t=>[e.minimumWidth,e.maximumWidth,e.minimumHeight,e.maximumHeight]),at.TN),e=>{}))}(e);this._onDidViewChange=at.tj.map(r,e=>e&&(this.orientation===at.Zt.VERTICAL?e.width:e.height),this.disposables),this.onDidChange=at.tj.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}get width(){return this.orientation===at.Zt.HORIZONTAL?this.orthogonalSize:this.size}get height(){return this.orientation===at.Zt.HORIZONTAL?this.size:this.orthogonalSize}get top(){return this.orientation===at.Zt.HORIZONTAL?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return this.orientation===at.Zt.HORIZONTAL?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return this.orientation===at.Zt.HORIZONTAL?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===at.Zt.HORIZONTAL?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){var e;return null===(e=this.view.proportionalLayout)||void 0===e||e}get snap(){return this.view.snap}get minimumOrthogonalSize(){return this.orientation===at.Zt.HORIZONTAL?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===at.Zt.HORIZONTAL?this.maximumWidth:this.maximumHeight}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){var t,i;this._boundarySashes=e,null===(t=(i=this.view).setBoundarySashes)||void 0===t||t.call(i,function(e,t){return t===at.Zt.HORIZONTAL?{left:e.start,right:e.end,top:e.orthogonalStart,bottom:e.orthogonalEnd}:{top:e.start,bottom:e.end,left:e.orthogonalStart,right:e.orthogonalEnd}}(e,this.orientation))}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(void 0===i)throw Error("Invalid state");this._size=e,this._orthogonalSize=i.orthogonalSize,this.absoluteOffset=i.absoluteOffset+t,this.absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}_layout(e,t,i,o){this.cachedWidth===e&&this.cachedHeight===t&&this.cachedTop===i&&this.cachedLeft===o||(this.cachedWidth=e,this.cachedHeight=t,this.cachedTop=i,this.cachedLeft=o,this.view.layout(e,t,i,o))}setVisible(e){var t,i;null===(t=(i=this.view).setVisible)||void 0===t||t.call(i,e)}dispose(){this.disposables.dispose()}};function Ft(e,t,i){if(e instanceof Bt){let o=new Bt(Nt(e.orientation),e.layoutController,e.styles,e.splitviewProportionalLayout,t,i,e.edgeSnapping),s=0;for(let r=e.children.length-1;r>=0;r--){let n=e.children[r],a=n instanceof Bt?n.orthogonalSize:n.size,d=0===e.size?0:Math.round(t*a/e.size);s+=d,0===r&&(d+=t-s),o.addChild(Ft(n,i,d),d,0,!0)}return e.dispose(),o}{let t=new Pt(e.view,Nt(e.orientation),e.layoutController,i);return e.dispose(),t}}var Yt,Qt,Xt=class e{get root(){return this._root}set root(e){let t=this._root;t&&(t.element.remove(),t.dispose()),this._root=e,this.element.appendChild(e.element),this.onDidSashResetRelay.input=e.onDidSashReset,this._onDidChange.input=at.tj.map(e.onDidChange,()=>{}),this._onDidScroll.input=e.onDidScroll}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(e){if(this._root.orientation===e)return;let{size:t,orthogonalSize:i,absoluteOffset:o,absoluteOrthogonalOffset:s}=this._root;this.root=Ft(this._root,i,t),this.root.layout(t,0,{orthogonalSize:i,absoluteOffset:s,absoluteOrthogonalOffset:o,absoluteSize:t,absoluteOrthogonalSize:i}),this.boundarySashes=this.boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.root.boundarySashes=function(e,t){return t===at.Zt.HORIZONTAL?{start:e.left,end:e.right,orthogonalStart:e.top,orthogonalEnd:e.bottom}:{start:e.top,end:e.bottom,orthogonalStart:e.left,orthogonalEnd:e.right}}(e,this.orientation)}set edgeSnapping(e){this.root.edgeSnapping=e}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.onDidSashResetRelay=new at.ij,this._onDidScroll=new at.ij,this._onDidChange=new at.ij,this._boundarySashes={},this.disposable2x2=at.mj.None,this.onDidSashReset=this.onDidSashResetRelay.event,this.onDidScroll=this._onDidScroll.event,this.onDidChange=this._onDidChange.event,this.maximizedNode=void 0,this._onDidChangeViewMaximized=new at.ej,this.onDidChangeViewMaximized=this._onDidChangeViewMaximized.event,this.element=(0,at.px)(".monaco-grid-view"),this.styles=e.styles||Gt,this.proportionalLayout=void 0===e.proportionalLayout||!!e.proportionalLayout,this.layoutController=new Kt(!1),this.root=new Bt(at.Zt.VERTICAL,this.layoutController,this.styles,this.proportionalLayout)}style(e){this.styles=e,this.root.style(e)}layout(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.layoutController.isLayoutEnabled=!0;let[s,r,n,a]=this.root.orientation===at.Zt.HORIZONTAL?[t,e,i,o]:[e,t,o,i];this.root.layout(s,0,{orthogonalSize:r,absoluteOffset:n,absoluteOrthogonalOffset:a,absoluteSize:s,absoluteOrthogonalSize:r})}addView(e,t,i){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=at.mj.None;let[o,s]=(0,at.GN)(i),[r,n]=this.getNode(o);if(n instanceof Bt){let i=new Pt(e,Nt(n.orientation),this.layoutController,n.orthogonalSize);try{n.addChild(i,t,s)}catch(e){throw i.dispose(),e}}else{let[,i]=(0,at.GN)(r),[,a]=(0,at.GN)(o),d=0,l=i.getChildCachedVisibleSize(a);"number"==typeof l&&(d=at.Jt.Invisible(l)),i.removeChild(a).dispose();let c=new Bt(n.orientation,n.layoutController,this.styles,this.proportionalLayout,n.size,n.orthogonalSize,i.edgeSnapping);i.addChild(c,n.size,a);let h=new Pt(n.view,i.orientation,this.layoutController,n.size);c.addChild(h,d,0),"number"!=typeof t&&"split"===t.type&&(t=at.Jt.Split(0));let u=new Pt(e,i.orientation,this.layoutController,n.size);c.addChild(u,t,s)}this.trySet2x2()}removeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=at.mj.None;let[i,o]=(0,at.GN)(e),[s,r]=this.getNode(i);if(!(r instanceof Bt))throw Error("Invalid location");let n=r.children[o];if(!(n instanceof Pt))throw Error("Invalid location");if(r.removeChild(o,t),n.dispose(),0===r.children.length)throw Error("Invalid grid state");if(r.children.length>1)return this.trySet2x2(),n.view;if(0===s.length){let e=r.children[0];return e instanceof Pt||(r.removeChild(0),r.dispose(),this.root=e,this.boundarySashes=this.boundarySashes,this.trySet2x2()),n.view}let[,a]=(0,at.GN)(s),[,d]=(0,at.GN)(i),l=r.isChildVisible(0),c=r.removeChild(0),h=a.children.map((e,t)=>a.getChildSize(t));if(a.removeChild(d,t),r.dispose(),c instanceof Bt){h.splice(d,1,...c.children.map(e=>e.size));let e=c.removeAllChildren();for(let t=0;t<e.length;t++)a.addChild(e[t],e[t].size,d+t)}else{let e=new Pt(c.view,Nt(c.orientation),this.layoutController,c.size),t=l?c.orthogonalSize:at.Jt.Invisible(c.orthogonalSize);a.addChild(e,t,d)}c.dispose();for(let u=0;u<h.length;u++)a.resizeChild(u,h[u]);return this.trySet2x2(),n.view}moveView(e,t,i){this.hasMaximizedView()&&this.exitMaximizedView();let[,o]=this.getNode(e);if(!(o instanceof Bt))throw Error("Invalid location");o.moveChild(t,i),this.trySet2x2()}swapViews(e,t){this.hasMaximizedView()&&this.exitMaximizedView();let[i,o]=(0,at.GN)(e),[,s]=this.getNode(i);if(!(s instanceof Bt))throw Error("Invalid from location");let r=s.getChildSize(o),n=s.children[o];if(!(n instanceof Pt))throw Error("Invalid from location");let[a,d]=(0,at.GN)(t),[,l]=this.getNode(a);if(!(l instanceof Bt))throw Error("Invalid to location");let c=l.getChildSize(d),h=l.children[d];if(!(h instanceof Pt))throw Error("Invalid to location");s===l?s.swapChildren(o,d):(s.removeChild(o),l.removeChild(d),s.addChild(h,r,o),l.addChild(n,c,d)),this.trySet2x2()}resizeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView();let[i,o]=(0,at.GN)(e),[s,r]=this.getNode(i);if(!(r instanceof Bt))throw Error("Invalid location");if(!t.width&&!t.height)return;let[n,a]=r.orientation===at.Zt.HORIZONTAL?[t.width,t.height]:[t.height,t.width];if("number"==typeof a&&s.length>0){let[,e]=(0,at.GN)(s),[,t]=(0,at.GN)(i);e.resizeChild(t,a)}"number"==typeof n&&r.resizeChild(o,n),this.trySet2x2()}getViewSize(e){if(!e)return{width:this.root.width,height:this.root.height};let[,t]=this.getNode(e);return{width:t.width,height:t.height}}getViewCachedVisibleSize(e){let[t,i]=(0,at.GN)(e),[,o]=this.getNode(t);if(!(o instanceof Bt))throw Error("Invalid location");return o.getChildCachedVisibleSize(i)}expandView(e){this.hasMaximizedView()&&this.exitMaximizedView();let[t,i]=this.getNode(e);if(!(i instanceof Pt))throw Error("Invalid location");for(let o=0;o<t.length;o++)t[o].resizeChild(e[o],1/0)}isViewExpanded(e){if(this.hasMaximizedView())return!1;let[t,i]=this.getNode(e);if(!(i instanceof Pt))throw Error("Invalid location");for(let o=0;o<t.length;o++)if(!t[o].isChildExpanded(e[o]))return!1;return!0}maximizeView(e){let[,t]=this.getNode(e);if(!(t instanceof Pt))throw Error("Location is not a LeafNode");this.maximizedNode!==t&&(this.hasMaximizedView()&&this.exitMaximizedView(),function e(t,i){for(let o=0;o<t.children.length;o++){let s=t.children[o];s instanceof Pt?s!==i&&t.setChildVisible(o,!1):e(s,i)}}(this.root,t),this.maximizedNode=t,this._onDidChangeViewMaximized.fire(!0))}exitMaximizedView(){this.maximizedNode&&(this.maximizedNode=void 0,function e(t){for(let i=t.children.length-1;i>=0;i--){let o=t.children[i];o instanceof Pt?t.setChildVisible(i,!0):e(o)}}(this.root),this._onDidChangeViewMaximized.fire(!1))}hasMaximizedView(){return void 0!==this.maximizedNode}isViewMaximized(e){let[,t]=this.getNode(e);if(!(t instanceof Pt))throw Error("Location is not a LeafNode");return t===this.maximizedNode}distributeViewSizes(e){if(this.hasMaximizedView()&&this.exitMaximizedView(),!e)return void this.root.distributeViewSizes(!0);let[,t]=this.getNode(e);if(!(t instanceof Bt))throw Error("Invalid location");t.distributeViewSizes(),this.trySet2x2()}isViewVisible(e){let[t,i]=(0,at.GN)(e),[,o]=this.getNode(t);if(!(o instanceof Bt))throw Error("Invalid from location");return o.isChildVisible(i)}setViewVisible(e,t){if(this.hasMaximizedView())return void this.exitMaximizedView();let[i,o]=(0,at.GN)(e),[,s]=this.getNode(i);if(!(s instanceof Bt))throw Error("Invalid from location");s.setChildVisible(o,t)}getView(e){let t=e?this.getNode(e)[1]:this._root;return this._getViews(t,this.orientation)}static deserialize(t,i){var o;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("number"!=typeof t.orientation)throw Error("Invalid JSON: 'orientation' property must be a number.");if("number"!=typeof t.width)throw Error("Invalid JSON: 'width' property must be a number.");if("number"!=typeof t.height)throw Error("Invalid JSON: 'height' property must be a number.");if("branch"!==(null===(o=t.root)||void 0===o?void 0:o.type))throw Error("Invalid JSON: 'root' property must have 'type' value of branch.");let r=t.orientation,n=t.height,a=new e(s);return a._deserialize(t.root,r,i,n),a}_deserialize(e,t,i,o){this.root=this._deserializeNode(e,t,i,o)}_deserializeNode(e,t,i,o){let s;if("branch"===e.type){let r=e.data.map(o=>({node:this._deserializeNode(o,Nt(t),i,e.size),visible:o.visible}));s=new Bt(t,this.layoutController,this.styles,this.proportionalLayout,e.size,o,void 0,r)}else s=new Pt(i.fromJSON(e.data),t,this.layoutController,o,e.size),e.maximized&&!this.maximizedNode&&(this.maximizedNode=s,this._onDidChangeViewMaximized.fire(!0));return s}_getViews(e,t,i){let o={top:e.top,left:e.left,width:e.width,height:e.height};if(e instanceof Pt)return{view:e.view,box:o,cachedVisibleSize:i,maximized:this.maximizedNode===e};let s=[];for(let r=0;r<e.children.length;r++){let i=e.children[r],o=e.getChildCachedVisibleSize(r);s.push(this._getViews(i,Nt(t),o))}return{children:s,box:o}}getNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===e.length)return[i,t];if(!(t instanceof Bt))throw Error("Invalid location");let[o,...s]=e;if(o<0||o>=t.children.length)throw Error("Invalid location");let r=t.children[o];return i.push(t),this.getNode(s,r,i)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=at.mj.None,2!==this.root.children.length)return;let[e,t]=this.root.children;!(e instanceof Bt)||!(t instanceof Bt)||(this.disposable2x2=e.trySet2x2(t))}getViewMap(e,t){t||(t=this.root),t instanceof Bt?t.children.forEach(t=>this.getViewMap(e,t)):e.set(t.view,t.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element.remove()}};function Ht(e){return!!e.children}function Ut(e,t){if(0===t.length)return e;if(!Ht(e))throw Error("Invalid location");let[i,...o]=t;return Ut(e.children[i],o)}function jt(e,t){let i=qt(t);return{offset:t===Yt.Up?e.top:t===Yt.Right?e.left+e.width:t===Yt.Down?e.top+e.height:e.left,range:{start:i===at.Zt.HORIZONTAL?e.top:e.left,end:i===at.Zt.HORIZONTAL?e.top+e.height:e.left+e.width}}}function zt(e,t){return t.length%2==0?Nt(e):e}function qt(e){return e===Yt.Up||e===Yt.Down?at.Zt.VERTICAL:at.Zt.HORIZONTAL}function $t(e,t,i){if(zt(e,t)===qt(i)){let[e,o]=(0,at.GN)(t);return(i===Yt.Right||i===Yt.Down)&&(o+=1),[...e,o]}{let e=i===Yt.Right||i===Yt.Down?1:0;return[...t,e]}}function ei(e){let t=e.parentElement;if(!t)throw Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(t.className))return[];let i=function(e){let t=e.parentElement;if(!t)throw Error("Invalid grid element");let i=t.firstElementChild,o=0;for(;i!==e&&i!==t.lastElementChild&&i;)i=i.nextElementSibling,o++;return o}(t);return[...ei(t.parentElement.parentElement.parentElement.parentElement),i]}(0,at.vE)(),(0,at.tn)(),(0,at.AN)(),(0,at.wj)(),(0,at.Xt)(),(0,at.bE)(Jt),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(Yt||(Yt={})),function(e){e.Distribute={type:"distribute"},e.Split={type:"split"},e.Auto={type:"auto"},e.Invisible=function(e){return{type:"invisible",cachedVisibleSize:e}}}(Qt||(Qt={}));var ti=class extends at.mj{get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(e){this.gridview.boundarySashes=e}set edgeSnapping(e){this.gridview.edgeSnapping=e}get element(){return this.gridview.element}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.views=new Map,this.didLayout=!1,e instanceof Xt?(this.gridview=e,this.gridview.getViewMap(this.views)):this.gridview=new Xt(t),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),e instanceof Xt||this._addView(e,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll,this.onDidChangeViewMaximized=this.gridview.onDidChangeViewMaximized}style(e){this.gridview.style(e)}layout(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.gridview.layout(e,t,i,o),this.didLayout=!0}addView(e,t,i,o){if(this.views.has(e))throw Error("Can't add same view twice");let s=qt(o);1===this.views.size&&this.orientation!==s&&(this.orientation=s);let r,n=this.getViewLocation(i),a=$t(this.gridview.orientation,n,o);if("number"==typeof t)r=t;else if("split"===t.type){let[,e]=(0,at.GN)(n);r=at.Jt.Split(e)}else if("distribute"===t.type)r=at.Jt.Distribute;else if("auto"===t.type){let[,e]=(0,at.GN)(n);r=at.Jt.Auto(e)}else r=t;this._addView(e,r,a)}addViewAt(e,t,i){if(this.views.has(e))throw Error("Can't add same view twice");let o;o="number"==typeof t?t:"distribute"===t.type?at.Jt.Distribute:t,this._addView(e,o,i)}_addView(e,t,i){this.views.set(e,e.element),this.gridview.addView(e,t,i)}removeView(e,t){if(1===this.views.size)throw Error("Can't remove last view");let i,o=this.getViewLocation(e);if("distribute"===(null===t||void 0===t?void 0:t.type))i=at.Jt.Distribute;else if("auto"===(null===t||void 0===t?void 0:t.type)){let e=o[o.length-1];i=at.Jt.Auto(0===e?1:e-1)}this.gridview.removeView(o,i),this.views.delete(e)}moveView(e,t,i,o){let[s,r]=(0,at.GN)(this.getViewLocation(e)),n=this.getViewLocation(i),[a,d]=(0,at.GN)($t(this.gridview.orientation,n,o));(0,at.TN)(s,a)?this.gridview.moveView(s,r,d):(this.removeView(e,"number"==typeof t?void 0:t),this.addView(e,t,i,o))}moveViewTo(e,t){let i=this.getViewLocation(e),[o,s]=(0,at.GN)(i),[r,n]=(0,at.GN)(t);if((0,at.TN)(o,r))this.gridview.moveView(o,s,n);else{let o=this.getViewSize(e),s=zt(this.gridview.orientation,i),r=this.getViewCachedVisibleSize(e),n=void 0===r?s===at.Zt.HORIZONTAL?o.width:o.height:Qt.Invisible(r);this.removeView(e),this.addViewAt(e,n,t)}}swapViews(e,t){let i=this.getViewLocation(e),o=this.getViewLocation(t);return this.gridview.swapViews(i,o)}resizeView(e,t){let i=this.getViewLocation(e);return this.gridview.resizeView(i,t)}isViewExpanded(e){let t=this.getViewLocation(e);return this.gridview.isViewExpanded(t)}isViewMaximized(e){let t=this.getViewLocation(e);return this.gridview.isViewMaximized(t)}hasMaximizedView(){return this.gridview.hasMaximizedView()}getViewSize(e){if(!e)return this.gridview.getViewSize();let t=this.getViewLocation(e);return this.gridview.getViewSize(t)}getViewCachedVisibleSize(e){let t=this.getViewLocation(e);return this.gridview.getViewCachedVisibleSize(t)}maximizeView(e){if(this.views.size<2)throw Error("At least two views are required to maximize a view");let t=this.getViewLocation(e);this.gridview.maximizeView(t)}exitMaximizedView(){this.gridview.exitMaximizedView()}expandView(e){let t=this.getViewLocation(e);this.gridview.expandView(t)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(e){let t=this.getViewLocation(e);return this.gridview.isViewVisible(t)}setViewVisible(e,t){let i=this.getViewLocation(e);this.gridview.setViewVisible(i,t)}getViews(){return this.gridview.getView()}getNeighborViews(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.didLayout)throw Error("Can't call getNeighborViews before first layout");let o=this.getViewLocation(e),s=this.getViews(),r=Ut(s,o),n=jt(r.box,t);return i&&(t===Yt.Up&&0===r.box.top?n={offset:s.box.top+s.box.height,range:n.range}:t===Yt.Right&&r.box.left+r.box.width===s.box.width||t===Yt.Down&&r.box.top+r.box.height===s.box.height?n={offset:0,range:n.range}:t===Yt.Left&&0===r.box.left&&(n={offset:s.box.left+s.box.width,range:n.range})),function(e,t,i){let o=[];return function e(t,i,s){if(Ht(t))for(let o of t.children)e(o,i,s);else{let{offset:e,range:r}=jt(t.box,i);e===s.offset&&function(e,t){return!(e.start>=t.end||t.start>=e.end)}(r,s.range)&&o.push(t)}}(e,t,i),o}(s,function(e){switch(e){case Yt.Up:return Yt.Down;case Yt.Down:return Yt.Up;case Yt.Left:return Yt.Right;case Yt.Right:return Yt.Left}}(t),n).map(e=>e.view)}getViewLocation(e){let t=this.views.get(e);if(!t)throw Error("View not found");return ei(t)}onDidSashReset(e){let t=e=>{let t=this.gridview.getView(e);if(Ht(t))return!1;let i=zt(this.orientation,e),o=i===at.Zt.HORIZONTAL?t.view.preferredWidth:t.view.preferredHeight;if("number"!=typeof o)return!1;let s=i===at.Zt.HORIZONTAL?{width:Math.round(o)}:{height:Math.round(o)};return this.gridview.resizeView(e,s),!0};if(t(e))return;let[i,o]=(0,at.GN)(e);t([...i,o+1])||this.gridview.distributeViewSizes(i)}},ii=class e extends ti{constructor(){super(...arguments),this.initialLayoutContext=!0}static serializeNode(t,i){let o=i===at.Zt.VERTICAL?t.box.width:t.box.height;if(!Ht(t)){let e={type:"leaf",data:t.view.toJSON(),size:o};return"number"==typeof t.cachedVisibleSize?(e.size=t.cachedVisibleSize,e.visible=!1):t.maximized&&(e.maximized=!0),e}let s=t.children.map(t=>e.serializeNode(t,Nt(i)));return s.some(e=>!1!==e.visible)?{type:"branch",data:s,size:o}:{type:"branch",data:s,size:o,visible:!1}}static deserialize(t,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("number"!=typeof t.orientation)throw Error("Invalid JSON: 'orientation' property must be a number.");if("number"!=typeof t.width)throw Error("Invalid JSON: 'width' property must be a number.");if("number"!=typeof t.height)throw Error("Invalid JSON: 'height' property must be a number.");return new e(Xt.deserialize(t,i,o),o)}static from(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.deserialize(ai(t),{fromJSON:e=>e},i)}serialize(){return{root:e.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super.layout(e,t,i,o),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}};function oi(e){return!!e.groups}function si(e,t){if(!t&&e.groups&&e.groups.length<=1&&(e.groups=void 0),!oi(e))return;let i=0,o=0;for(let r of e.groups)si(r,!1),r.size&&(i+=r.size,o++);let s=(o>0?i:1)/(e.groups.length-o);for(let r of e.groups)r.size||(r.size=s)}function ri(e){return oi(e)?{type:"branch",data:e.groups.map(e=>ri(e)),size:e.size}:{type:"leaf",data:e.data,size:e.size}}function ni(e,t){if("branch"===e.type){let i=e.data.map(e=>ni(e,Nt(t)));return t===at.Zt.VERTICAL?{width:e.size||(0===i.length?void 0:Math.max(...i.map(e=>e.width||0))),height:0===i.length?void 0:i.reduce((e,t)=>e+(t.height||0),0)}:{width:0===i.length?void 0:i.reduce((e,t)=>e+(t.width||0),0),height:e.size||(0===i.length?void 0:Math.max(...i.map(e=>e.height||0)))}}return{width:t===at.Zt.VERTICAL?e.size:void 0,height:t===at.Zt.VERTICAL?void 0:e.size}}function ai(e){si(e,!0);let t=ri(e),{width:i,height:o}=ni(t,e.orientation);return{root:t,orientation:e.orientation,width:i||1,height:o||1}}(0,at.oS)(),(0,at.Ji)(),(0,at.ia)(),(0,at.Oc)();var di,li,ci,hi=class{constructor(e){this._container=e}set text(e){(0,at.jS)(this._container,...(0,at.Ac)(null!==e&&void 0!==e?e:""))}set title(e){!this.hover&&e?this.hover=(0,at.qi)().setupManagedHover((0,at.ra)("mouse"),this._container,e):this.hover&&this.hover.update(e)}dispose(){var e;null===(e=this.hover)||void 0===e||e.dispose()}};(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.rA)(),(0,at.Wd)(),(0,bt.en)(),(0,dt.c)(),(0,at.yb)(),(0,at.zp)(),(0,at.XA)(),(0,at.Xd)(),(0,at.oS)(),(0,at.wj)(),(0,at.Lo)(),(0,at.GM)(),(0,at.Rb)(),(0,at.es)(),(0,at.Ma)(),(0,at.jr)(),(0,gt.f)(),(0,at.Xn)(),(0,at.Ii)(),(0,at.Qs)(),(0,at.ps)(),(0,at.Ap)(),(0,at.Vl)(),(0,gt.gn)(),(0,at.bE)({});var ui=(r=class extends dt.s{constructor(e,t,i,o,s){super(e,t,i,o,s),this.inputDisposable=this._register(new at.vj)}createEditor(e){this.container=(0,at.px)(".monaco-editor-pane-placeholder",{tabIndex:0}),this.container.style.outline="none",this.scrollbar=this._register(new at.Fp(this.container,{horizontal:at.YA.Auto,vertical:at.YA.Auto})),e.appendChild(this.scrollbar.getDomNode())}async setInput(e,t,i,o){await super.setInput(e,t,i,o),!o.isCancellationRequested&&(this.inputDisposable.value=await this.renderInput(e,t))}async renderInput(e,t){let[i,o]=(0,at.HM)(this.container,this.scrollbar);(0,at.Ox)(i);let s=new at.gj,{icon:r,label:n,actions:a}=await this.getContents(e,t,s),d=(0,at.OA)(n,di.PLACEHOLDER_LABEL_MAX_LENGTH),l=i.appendChild((0,at.px)(".editor-placeholder-icon-container"));s.add(new hi(l)).text=r;let c=i.appendChild((0,at.px)(".editor-placeholder-label-container")),h=(0,at.px)("span");if(h.textContent=d,c.appendChild(h),i.setAttribute("aria-label","".concat((0,gt.d)(e,void 0,this.group,void 0),", ").concat(d)),a.length){let e=i.appendChild((0,at.px)(".editor-placeholder-buttons-container")),t=s.add(new at.Kn(e));for(let i=0;i<a.length;i++){let e=s.add(t.addButton((0,rt.A)((0,rt.A)({},at.Ti),{},{secondary:0!==i})));e.label=a[i].label,s.add(e.onDidClick(e=>{e&&at.gx.stop(e,!0),a[i].run()}))}}return o.scanDomNode(),s}clearInput(){this.container&&(0,at.Ox)(this.container),this.inputDisposable.clear(),super.clearInput()}layout(e){let[t,i]=(0,at.HM)(this.container,this.scrollbar);(0,at.VS)(t,e.width,e.height),i.scanDomNode(),t.classList.toggle("max-height-200px",e.height<=200)}focus(){var e;super.focus(),null===(e=this.container)||void 0===e||e.focus()}dispose(){var e;null!==(e=this.container)&&void 0!==e&&e.remove(),super.dispose()}},{_:di=r},{_:r.PLACEHOLDER_LABEL_MAX_LENGTH=1024},r);ui=di=(0,at.Jb)([(0,at.Yb)(2,at.vb),(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,at.Io)],ui);var gi=(n=class extends ui{constructor(e,t,i,o,s,r){super(li.ID,e,t,i,r),this.commandService=o,this.workspaceService=s}getTitle(){return li.LABEL}async getContents(){return{icon:"$(workspace-untrusted)",label:(0,at.rs)((0,at.ds)(this.workspaceService.getWorkspace()))?(0,at.EM)(3340,"The file is not displayed in the editor because trust has not been granted to the folder."):(0,at.EM)(3341,"The file is not displayed in the editor because trust has not been granted to the workspace."),actions:[{label:(0,at.EM)(3342,"Manage Workspace Trust"),run:()=>this.commandService.executeCommand("workbench.trust.manage")}]}}},{_:li=n},{_:n.ID="workbench.editors.workspaceTrustRequiredEditor"},{_:n.LABEL=(0,at.EM)(3339,"Workspace Trust Required")},{_:n.DESCRIPTOR=gt.u.create(li,n.ID,n.LABEL)},n);gi=li=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.Yd),(0,at.Yb)(3,at.Lb),(0,at.Yb)(4,at.ja),(0,at.Yb)(5,at.Io)],gi);var pi=(a=class extends ui{constructor(e,t,i,o,s,r,n){super(ci.ID,e,t,i,o),this.fileService=s,this.dialogService=r,this.commandService=n}async getContents(e,t,i){let o,s=e.resource,r=t.error,n=(null===r||void 0===r?void 0:r.fileOperationResult)===at.ks.FILE_NOT_FOUND;o=n?(0,at.EM)(3344,"The editor could not be opened because the file was not found."):(0,bt.on)(r)&&r.forceMessage?r.message:r?(0,at.EM)(3345,"The editor could not be opened due to an unexpected error. Please consult the log for more details."):(0,at.EM)(3346,"The editor could not be opened due to an unexpected error.");let a,d="$(error)";return(0,bt.on)(r)&&(r.forceSeverity===at.Ud.Info?d="$(info)":r.forceSeverity===at.Ud.Warning&&(d="$(warning)")),a=(0,bt.on)(r)&&r.actions.length>0?r.actions.map(e=>({label:e.label,run:()=>{let t=e.run();t instanceof Promise&&t.catch(e=>this.dialogService.error((0,at.Mp)(e)))}})):[{label:(0,at.EM)(3347,"Try Again"),run:()=>this.group.openEditor(e,(0,rt.A)((0,rt.A)({},t),{},{source:at.Dr.USER}))},{label:(0,at.EM)(3348,"Show Logs"),run:()=>this.commandService.executeCommand(gt._n)}],n&&s&&this.fileService.hasProvider(s)&&i.add(this.fileService.onDidFilesChange(i=>{i.contains(s,at.Cs.ADDED,at.Cs.UPDATED)&&this.group.openEditor(e,t)})),{icon:d,label:o,actions:null!==a&&void 0!==a?a:[]}}},{_:ci=a},{_:a.ID="workbench.editors.errorEditor"},{_:a.LABEL=(0,at.EM)(3343,"Error Editor")},{_:a.DESCRIPTOR=gt.u.create(ci,a.ID,a.LABEL)},a);pi=ci=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.Yd),(0,at.Yb)(3,at.Io),(0,at.Yb)(4,at.fs),(0,at.Yb)(5,at.zl),(0,at.Yb)(6,at.Lb)],pi),(0,at.Xb)(),(0,at.TM)(),(0,at.sj)(),(0,at.Wd)(),(0,at.wj)(),(0,bt.en)(),(0,at.oS)(),(0,at.Mb)(),(0,pt.st)(),(0,at.ox)(),(0,pt.gt)(),(0,at.Va)(),(0,dt.tt)(),(0,at.GM)(),(0,at.Ta)(),(0,at.jr)(),(0,at.aP)(),(0,at.Ap)(),(0,at.gb)(),(0,at.Vl)(),(0,dt.z)();var bi=class extends at.mj{get minimumWidth(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.minimumWidth)&&void 0!==e?e:dt.X.width}get minimumHeight(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.minimumHeight)&&void 0!==e?e:dt.X.height}get maximumWidth(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.maximumWidth)&&void 0!==e?e:dt.Y.width}get maximumHeight(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.maximumHeight)&&void 0!==e?e:dt.Y.height}get activeEditorPane(){return this._activeEditorPane}constructor(e,t,i,o,s,r,n,a,d,l){super(),this.editorGroupParent=e,this.editorPanesParent=t,this.groupView=i,this.layoutService=o,this.instantiationService=s,this.workspaceTrustService=n,this.logService=a,this.dialogService=d,this.hostService=l,this._onDidFocus=this._register(new at.ej),this.onDidFocus=this._onDidFocus.event,this._onDidChangeSizeConstraints=this._register(new at.ej),this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this._activeEditorPane=null,this.editorPanes=[],this.mapEditorPaneToPendingSetInput=new Map,this.activeEditorPaneDisposables=this._register(new at.gj),this.editorPanesRegistry=at.jb.as(bt.Rt.EditorPane),this.editorOperation=this._register(new pt.ft(r)),this.registerListeners()}registerListeners(){this._register(this.workspaceTrustService.onDidChangeTrust(()=>this.onDidChangeWorkspaceTrust()))}onDidChangeWorkspaceTrust(){var e,t;let i=null===(e=this._activeEditorPane)||void 0===e?void 0:e.input,o=null===(t=this._activeEditorPane)||void 0===t?void 0:t.options;(null===i||void 0===i?void 0:i.hasCapability(bt.zt.RequiresTrust))&&this.groupView.openEditor(i,o)}async openEditor(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object.create(null);try{return await this.doOpenEditor(this.getEditorPaneDescriptor(e),e,t,i,o)}catch(s){return null!==t&&void 0!==t&&t.ignoreError?{error:s}:this.doShowError(s,e,t,i,o)}}async doShowError(e,t,i,o,s){this.logService.error(e);let r=!1;if((null===i||void 0===i?void 0:i.source)===at.Dr.USER&&(!(0,bt.on)(e)||e.allowDialog)&&(r=await this.doShowErrorDialog(e,t)),r)return{error:e};let n=(0,rt.A)({},i);return(0,at.oP)(e)||(n.error=e),(0,rt.A)((0,rt.A)({},await this.doOpenEditor(pi.DESCRIPTOR,t,n,o,s)),{},{error:e})}async doShowErrorDialog(e,t){var i;let o,s,r=at.Ud.Error,n=(0,at.Mp)(e);(0,bt.on)(e)&&(s=e.actions,r=null!==(i=e.forceSeverity)&&void 0!==i?i:at.Ud.Error,e.forceMessage&&(o=e.message,n=void 0)),o||(o=(0,at.EM)(3336,"Unable to open '{0}'",t.getName()));let a,d=[];if(s&&s.length>0)for(let h of s)d.push({label:h.label,run:()=>h});else d.push({label:(0,at.EM)(3337,"&&OK"),run:()=>{}});1===d.length&&(a={run:()=>{l=!0}});let l=!1,{result:c}=await this.dialogService.prompt({type:r,message:o,detail:n,buttons:d,cancelButton:a});if(c){let e=c.run();e instanceof Promise&&e.catch(e=>this.dialogService.error((0,at.Mp)(e))),l=!0}return l}async doOpenEditor(e,t,i,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Object.create(null),r=this.doShowEditorPane(e),n=(0,at.zx)(),{changed:a,cancelled:d}=await this.doSetInput(r,t,i,s);return d||(i&&i.preserveFocus||!this.shouldRestoreFocus(n)?(null===o||void 0===o?void 0:o.preserveWindowOrder)||this.hostService.moveTop((0,at.eS)(this.groupView.windowId,!0).window):r.focus()),{pane:r,changed:a,cancelled:d}}shouldRestoreFocus(e){if(!this.layoutService.isRestored()||!e)return!0;let t=(0,at.zx)();return!(t&&t!==e.ownerDocument.body&&e!==t&&(0,at.fS)(t)&&!(0,at.lS)(t,this.editorGroupParent))}getEditorPaneDescriptor(e){return e.hasCapability(bt.zt.RequiresTrust)&&!this.workspaceTrustService.isWorkspaceTrusted()?gi.DESCRIPTOR:(0,at.UM)(this.editorPanesRegistry.getEditorPane(e))}doShowEditorPane(e){if(this._activeEditorPane&&e.describes(this._activeEditorPane))return this._activeEditorPane;this.doHideActiveEditorPane();let t=this.doCreateEditorPane(e);this.doSetActiveEditorPane(t);let i=(0,at.UM)(t.getContainer());return this.editorPanesParent.appendChild(i),(0,at.BS)(i),t.setVisible(!0),this.pagePosition&&t.layout(new at.mx(this.pagePosition.width,this.pagePosition.height),{top:this.pagePosition.top,left:this.pagePosition.left}),this.boundarySashes&&t.setBoundarySashes(this.boundarySashes),t}doCreateEditorPane(e){let t=this.doInstantiateEditorPane(e);if(!t.getContainer()){let e=(0,at.px)(".editor-instance");this.editorPanesParent.appendChild(e);try{t.create(e)}catch(t){throw e.remove(),(0,at.aS)(e),t}}return t}doInstantiateEditorPane(e){let t=this.editorPanes.find(t=>e.describes(t));if(t)return t;let i=this._register(e.instantiate(this.instantiationService,this.groupView));return this.editorPanes.push(i),i}doSetActiveEditorPane(e){this._activeEditorPane=e,this.activeEditorPaneDisposables.clear(),e&&(this.activeEditorPaneDisposables.add(e.onDidChangeSizeConstraints(e=>this._onDidChangeSizeConstraints.fire(e))),this.activeEditorPaneDisposables.add(e.onDidFocus(()=>this._onDidFocus.fire()))),this._onDidChangeSizeConstraints.fire(void 0)}async doSetInput(e,t,i,o){var s,r;let n=null===(s=e.input)||void 0===s?void 0:s.matches(t);if(n&&(null===i||void 0===i||!i.forceReload))return this.mapEditorPaneToPendingSetInput.has(e)&&await this.mapEditorPaneToPendingSetInput.get(e),n=null===(r=e.input)||void 0===r?void 0:r.matches(t),n&&e.setOptions(i),{changed:!1,cancelled:!n};let a=this.editorOperation.start(this.layoutService.isRestored()?800:3200),d=!1;try{e.clearInput();let s=e.setInput(t,i,o,a.token);this.mapEditorPaneToPendingSetInput.set(e,s),await s,a.isCurrent()||(d=!0)}catch(e){if(a.isCurrent())throw e;d=!0}finally{a.isCurrent()&&this.mapEditorPaneToPendingSetInput.delete(e),a.stop()}return{changed:!n,cancelled:d}}doHideActiveEditorPane(){if(!this._activeEditorPane)return;this.editorOperation.stop(),this.safeRun(()=>{var e;return null===(e=this._activeEditorPane)||void 0===e?void 0:e.clearInput()}),this.safeRun(()=>{var e;return null===(e=this._activeEditorPane)||void 0===e?void 0:e.setVisible(!1)}),this.mapEditorPaneToPendingSetInput.delete(this._activeEditorPane);let e=this._activeEditorPane.getContainer();e&&(e.remove(),(0,at.aS)(e)),this.doSetActiveEditorPane(null)}closeEditor(e){var t;(null===(t=this._activeEditorPane)||void 0===t?void 0:t.input)&&e.matches(this._activeEditorPane.input)&&this.doHideActiveEditorPane()}setVisible(e){this.safeRun(()=>{var t;return null===(t=this._activeEditorPane)||void 0===t?void 0:t.setVisible(e)})}layout(e){this.pagePosition=e,this.safeRun(()=>{var t;return null===(t=this._activeEditorPane)||void 0===t?void 0:t.layout(new at.mx(e.width,e.height),e)})}setBoundarySashes(e){this.boundarySashes=e,this.safeRun(()=>{var t;return null===(t=this._activeEditorPane)||void 0===t?void 0:t.setBoundarySashes(e)})}safeRun(e){try{e()}catch(e){this.logService.error(e)}}};bi=(0,at.Jb)([(0,at.Yb)(3,pt.ot),(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.za),(0,at.Yb)(6,at.Ca),(0,at.Yb)(7,at.mb),(0,at.Yb)(8,at.zl),(0,at.Yb)(9,dt.R)],bi),(0,at.Xb)(),(0,at.oS)(),(0,at.yn)(),(0,at.AN)(),(0,at.wj)(),(0,at.iM)(),(0,at.TM)(),(0,at.Ib)(),(0,at.i_)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.Dd)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.Ii)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.es)(),(0,at.Ma)();var mi,vi={text:(0,at.EM)(3323,"Show All Commands"),id:"workbench.action.showCommands"},Ci={text:(0,at.EM)(3324,"Go to File"),id:"workbench.action.quickOpen"},wi={text:(0,at.EM)(3325,"Open File"),id:"workbench.action.files.openFile"},yi={text:(0,at.EM)(3326,"Open Folder"),id:"workbench.action.files.openFolder"},fi={text:(0,at.EM)(3327,"Open File or Folder"),id:"workbench.action.files.openFileFolder"},Si={text:(0,at.EM)(3328,"Open Recent"),id:"workbench.action.openRecent"},Ei={text:(0,at.EM)(3329,"New Untitled Text File"),id:"workbench.action.files.newUntitledFile"},ki={text:(0,at.EM)(3330,"Find in Files"),id:"workbench.action.findInFiles"},_i={text:(0,at.EM)(3331,"Toggle Terminal"),id:"workbench.action.terminal.toggleTerminal",when:{web:at.Mk.equals("terminalProcessSupported",!0)}},Ii={text:(0,at.EM)(3332,"Start Debugging"),id:"workbench.action.debug.start",when:{web:at.Mk.equals("terminalProcessSupported",!0)}},xi={text:(0,at.EM)(3333,"Open Settings"),id:"workbench.action.openSettings"},Ai=at.Mk.and(at.Mk.equals("chatSetupHidden",!1),at.Mk.equals("chatSetupDisabled",!1)),Vi={text:(0,at.EM)(3334,"Open Chat"),id:"workbench.action.chat.open",when:{native:Ai,web:Ai}},Di=(0,at._N)([vi,...at.pM&&!at._M?[fi]:[wi,yi],Si,at.pM&&!at._M?Ei:void 0,Vi]),Mi=[],Ti=[vi,Ci,Vi],Ri=[ki,Ii,_i,xi],Oi=(d=class extends at.mj{constructor(e,t,i,o,s,r){super(),this.keybindingService=t,this.contextService=i,this.contextKeyService=o,this.configurationService=s,this.storageService=r,this.transientDisposables=this._register(new at.gj),this.keybindingLabels=this._register(new at.gj),this.enabled=!1,this.cachedWhen=this.storageService.getObject(mi.CACHED_WHEN,at.Ro.PROFILE,Object.create(null)),this.workbenchState=this.contextService.getWorkbenchState();let n=(0,at.iS)(".editor-group-watermark",[(0,at.iS)(".letterpress"),(0,at.iS)(".shortcuts@shortcuts")]);(0,at.Dx)(e,n.root),this.shortcuts=n.shortcuts,this.registerListeners(),this.render()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("workbench.tips.enabled")&&this.enabled!==this.configurationService.getValue("workbench.tips.enabled")&&this.render()})),this._register(this.contextService.onDidChangeWorkbenchState(e=>{this.workbenchState!==e&&(this.workbenchState=e,this.render())})),this._register(this.storageService.onWillSaveState(e=>{if(e.reason===at.Bo.SHUTDOWN){let e=[...Di,...Mi,...Ti,...Ri];for(let o of e){var t,i;let e=at._M?null===(t=o.when)||void 0===t?void 0:t.web:null===(i=o.when)||void 0===i?void 0:i.native;e&&(this.cachedWhen[o.id]=this.contextKeyService.contextMatchesRules(e))}this.storageService.store(mi.CACHED_WHEN,JSON.stringify(this.cachedWhen),at.Ro.PROFILE,at.zo.MACHINE)}}))}render(){if(this.enabled=this.configurationService.getValue("workbench.tips.enabled"),(0,at.Ox)(this.shortcuts),this.transientDisposables.clear(),!this.enabled)return;let e=this.filterEntries(this.workbenchState===at.Xo.EMPTY?Di:Ti,!1),t=this.filterEntries(this.workbenchState===at.Xo.EMPTY?Mi:Ri,!0).slice(0,Math.max(0,5-e.length)),i=[...e,...t],o=(0,at.Dx)(this.shortcuts,(0,at.px)(".watermark-box")),s=()=>{(0,at.Ox)(o),this.keybindingLabels.clear();for(let e of i){let t=this.keybindingService.lookupKeybinding(e.id);if(!t)continue;let i=(0,at.Dx)(o,(0,at.px)("dl"));(0,at.Dx)(i,(0,at.px)("dt")).textContent=e.text;let s=(0,at.Dx)(i,(0,at.px)("dd"));this.keybindingLabels.add(new at.vn(s,at.eM,(0,rt.A)({renderUnboundKeybindings:!0},at.Ai))).set(t)}};s(),this.transientDisposables.add(this.keybindingService.onDidUpdateKeybindings(s))}filterEntries(e,t){let i=e.filter(e=>{var t,i;return at._M&&!(null!==(t=e.when)&&void 0!==t&&t.web)||!at._M&&!(null!==(i=e.when)&&void 0!==i&&i.native)||this.cachedWhen[e.id]}).filter(e=>!!at.Fb.getCommand(e.id)).filter(e=>!!this.keybindingService.lookupKeybinding(e.id));return t&&(0,at.HN)(i),i}},{_:mi=d},{_:d.CACHED_WHEN="editorGroupWatermark.whenConditions"},d);Oi=mi=(0,at.Jb)([(0,at.Yb)(1,at.Ed),(0,at.Yb)(2,at.ja),(0,at.Yb)(3,at.Nb),(0,at.Yb)(4,at.r_),(0,at.Yb)(5,at.Io)],Oi),(0,at.Fg)("editorWatermark.foreground",{dark:(0,at.Ig)(at.kh,.6),light:(0,at.Ig)(at.kh,.68),hcDark:at.kh,hcLight:at.kh},(0,at.EM)(3335,"Foreground color for the labels in the editor watermark."));(0,at.vE)(),(0,at.oS)(),(0,at.Wg)(),(0,at.zp)(),(0,at.AN)(),(0,at.Vb)(),(0,at.sj)(),(0,at.wj)(),(0,at.XA)(),(0,at.bE)({});var Wi=class{},Li=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:at.YA.Auto,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;this._disposables=new at.gj,this._onDidSelectItem=new at.ej,this._onDidFocusItem=new at.ej,this._onDidChangeFocus=new at.ej,this.onDidSelectItem=this._onDidSelectItem.event,this.onDidFocusItem=this._onDidFocusItem.event,this.onDidChangeFocus=this._onDidChangeFocus.event,this._items=[],this._nodes=[],this._freeNodes=[],this._enabled=!0,this._focusedItemIdx=-1,this._selectedItemIdx=-1,this._domNode=(0,at.jx)("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new at.Fp(this._domNode,{vertical:at.YA.Hidden,horizontal:i,horizontalScrollbarSize:t,useShadows:!1,scrollYToX:!0}),this._separatorIcon=o,this._disposables.add(this._scrollable),this._disposables.add((0,at.Tx)(this._domNode,"click",e=>this._onClick(e))),e.appendChild(this._scrollable.getDomNode());let r=(0,at.Hg)(this._domNode);this._style(r,s);let n=(0,at.US)(this._domNode);this._disposables.add(n),this._disposables.add(n.onDidBlur(e=>this._onDidChangeFocus.fire(!1))),this._disposables.add(n.onDidFocus(e=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(e){this._scrollable.updateOptions({horizontalScrollbarSize:e})}setHorizontalScrollbarVisibility(e){this._scrollable.updateOptions({horizontal:e})}dispose(){var e,t;this._disposables.dispose(),null!==(e=this._pendingLayout)&&void 0!==e&&e.dispose(),null!==(t=this._pendingDimLayout)&&void 0!==t&&t.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(e){var t,i;e&&at.mx.equals(e,this._dimension)||(e?(null!==(t=this._pendingDimLayout)&&void 0!==t&&t.dispose(),this._pendingDimLayout=this._updateDimensions(e)):(null!==(i=this._pendingLayout)&&void 0!==i&&i.dispose(),this._pendingLayout=this._updateScrollbar()))}_updateDimensions(e){let t=new at.gj;return t.add((0,at.wS)((0,at.$x)(this._domNode),()=>{this._dimension=e,this._domNode.style.width="".concat(e.width,"px"),this._domNode.style.height="".concat(e.height,"px"),t.add(this._updateScrollbar())})),t}_updateScrollbar(){return(0,at.CS)((0,at.$x)(this._domNode),()=>{(0,at.CS)((0,at.$x)(this._domNode),()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(e,t){let i="";t.breadcrumbsBackground&&(i+=".monaco-breadcrumbs { background-color: ".concat(t.breadcrumbsBackground,"}")),t.breadcrumbsForeground&&(i+=".monaco-breadcrumbs .monaco-breadcrumb-item { color: ".concat(t.breadcrumbsForeground,"}\n")),t.breadcrumbsFocusForeground&&(i+=".monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ".concat(t.breadcrumbsFocusForeground,"}\n")),t.breadcrumbsFocusAndSelectionForeground&&(i+=".monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ".concat(t.breadcrumbsFocusAndSelectionForeground,"}\n")),t.breadcrumbsHoverForeground&&(i+=".monaco-breadcrumbs:not(.disabled\t) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ".concat(t.breadcrumbsHoverForeground,"}\n")),e.textContent=i}setEnabled(e){this._enabled=e,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){let e=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;e>=0&&e<this._items.length?this._focus(e,void 0):this._domNode.focus()}isDOMFocused(){return(0,at.uS)(this._domNode)}getFocused(){return this._items[this._focusedItemIdx]}setFocused(e,t){this._focus(this._items.indexOf(e),t)}focusPrev(e){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,e)}focusNext(e){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,e)}_focus(e,t){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let t=this._nodes[i];i===e?(this._focusedItemIdx=i,t.classList.add("focused"),t.focus()):t.classList.remove("focused")}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:t})}reveal(e){let t=this._items.indexOf(e);t>=0&&this._reveal(t,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(e,t){if(e<0||e>=this._nodes.length)return;let i=this._nodes[e];if(!i)return;let{width:o}=this._scrollable.getScrollDimensions(),{scrollLeft:s}=this._scrollable.getScrollPosition();(!t||i.offsetLeft>s+o||i.offsetLeft<s)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(e,t){this._select(this._items.indexOf(e),t)}_select(e,t){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let t=this._nodes[i];i===e?(this._selectedItemIdx=i,t.classList.add("selected")):t.classList.remove("selected")}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:t})}getItems(){return this._items}setItems(e){let t,i=[];try{t=(0,at.yN)(this._items,e,(e,t)=>e.equals(t)),i=this._items.splice(t,this._items.length-t,...e.slice(t)),this._render(t),(0,at.Sj)(i),(0,at.Sj)(e.slice(0,t)),this._focus(-1,void 0)}catch(o){let s=Error("BreadcrumbsItem#setItems: newItems: ".concat(e.length,", prefix: ").concat(t,", removed: ").concat(i.length));throw s.name=o.name,s.stack=o.stack,s}}_render(e){let t=!1;for(;e<this._items.length&&e<this._nodes.length;e++){let i=this._items[e],o=this._nodes[e];this._renderItem(i,o),t=!0}for(;e<this._nodes.length;){let e=this._nodes.pop();e&&(this._freeNodes.push(e),e.remove(),t=!0)}for(;e<this._items.length;e++){let i=this._items[e],o=this._freeNodes.length>0?this._freeNodes.pop():(0,at.jx)("div");o&&(this._renderItem(i,o),this._domNode.appendChild(o),this._nodes.push(o),t=!0)}t&&this.layout(void 0)}_renderItem(e,t){(0,at.Ox)(t),t.className="";try{e.render(t)}catch(e){t.textContent="<<RENDER ERROR>>",console.error(e)}t.tabIndex=-1,t.setAttribute("role","listitem"),t.classList.add("monaco-breadcrumb-item");let i=(0,at.px)(at.Bb.asCSSSelector(this._separatorIcon));t.appendChild(i)}_onClick(e){if(this._enabled)for(let t=e.target;t;t=t.parentElement){let i=this._nodes.indexOf(t);if(i>=0){this._focus(i,e),this._select(i,e);break}}}};(0,at.sj)(),(0,at.TM)(),(0,at.A_)(),(0,at.Jp)(),(0,at.Mb)(),(0,at.ox)();var Ji=class{constructor(){this._map=new Map}register(e,t){if(this._map.has(e))throw Error("group (".concat(e,") has already a widget"));return this._map.set(e,t),{dispose:()=>this._map.delete(e)}}getWidget(e){return this._map.get(e)}},Gi=(l=class{constructor(){}static _stub(e){return{bindTo(t){let i=new at.ej,o=t.onDidChangeConfiguration(t=>{t.affectsConfiguration(e)&&i.fire(void 0)});return new class{constructor(){this.name=e,this.onDidChange=i.event}getValue(i){return i?t.getValue(e,i):t.getValue(e)}updateValue(i,o){return o?t.updateValue(e,i,o):t.updateValue(e,i)}dispose(){o.dispose(),i.dispose()}}}}}},{_:l.IsEnabled=l._stub("breadcrumbs.enabled")},{_:l.UseQuickPick=l._stub("breadcrumbs.useQuickPick")},{_:l.FilePath=l._stub("breadcrumbs.filePath")},{_:l.SymbolPath=l._stub("breadcrumbs.symbolPath")},{_:l.SymbolSortOrder=l._stub("breadcrumbs.symbolSortOrder")},{_:l.Icons=l._stub("breadcrumbs.icons")},{_:l.TitleScrollbarSizing=l._stub("workbench.editor.titleScrollbarSizing")},{_:l.TitleScrollbarVisibility=l._stub("workbench.editor.titleScrollbarVisibility")},{_:l.FileExcludes=l._stub("files.exclude")},l);at.jb.as(at.b_.Configuration).registerConfiguration({id:"breadcrumbs",title:(0,at.EM)(2970,"Breadcrumb Navigation"),order:101,type:"object",properties:{"breadcrumbs.enabled":{description:(0,at.EM)(2971,"Enable/disable navigation breadcrumbs."),type:"boolean",default:!0},"breadcrumbs.filePath":{description:(0,at.EM)(2972,"Controls whether and how file paths are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[(0,at.EM)(2973,"Show the file path in the breadcrumbs view."),(0,at.EM)(2974,"Do not show the file path in the breadcrumbs view."),(0,at.EM)(2975,"Only show the last element of the file path in the breadcrumbs view.")]},"breadcrumbs.symbolPath":{description:(0,at.EM)(2976,"Controls whether and how symbols are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[(0,at.EM)(2977,"Show all symbols in the breadcrumbs view."),(0,at.EM)(2978,"Do not show symbols in the breadcrumbs view."),(0,at.EM)(2979,"Only show the current symbol in the breadcrumbs view.")]},"breadcrumbs.symbolSortOrder":{description:(0,at.EM)(2980,"Controls how symbols are sorted in the breadcrumbs outline view."),type:"string",default:"position",scope:at.y_.LANGUAGE_OVERRIDABLE,enum:["position","name","type"],enumDescriptions:[(0,at.EM)(2981,"Show symbol outline in file position order."),(0,at.EM)(2982,"Show symbol outline in alphabetical order."),(0,at.EM)(2983,"Show symbol outline in symbol type order.")]},"breadcrumbs.icons":{description:(0,at.EM)(2984,"Render breadcrumb items with icons."),type:"boolean",default:!0},"breadcrumbs.showFiles":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2985,"When enabled breadcrumbs show `file`-symbols.")},"breadcrumbs.showModules":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2986,"When enabled breadcrumbs show `module`-symbols.")},"breadcrumbs.showNamespaces":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2987,"When enabled breadcrumbs show `namespace`-symbols.")},"breadcrumbs.showPackages":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2988,"When enabled breadcrumbs show `package`-symbols.")},"breadcrumbs.showClasses":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2989,"When enabled breadcrumbs show `class`-symbols.")},"breadcrumbs.showMethods":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2990,"When enabled breadcrumbs show `method`-symbols.")},"breadcrumbs.showProperties":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2991,"When enabled breadcrumbs show `property`-symbols.")},"breadcrumbs.showFields":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2992,"When enabled breadcrumbs show `field`-symbols.")},"breadcrumbs.showConstructors":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2993,"When enabled breadcrumbs show `constructor`-symbols.")},"breadcrumbs.showEnums":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2994,"When enabled breadcrumbs show `enum`-symbols.")},"breadcrumbs.showInterfaces":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2995,"When enabled breadcrumbs show `interface`-symbols.")},"breadcrumbs.showFunctions":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2996,"When enabled breadcrumbs show `function`-symbols.")},"breadcrumbs.showVariables":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2997,"When enabled breadcrumbs show `variable`-symbols.")},"breadcrumbs.showConstants":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2998,"When enabled breadcrumbs show `constant`-symbols.")},"breadcrumbs.showStrings":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(2999,"When enabled breadcrumbs show `string`-symbols.")},"breadcrumbs.showNumbers":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3e3,"When enabled breadcrumbs show `number`-symbols.")},"breadcrumbs.showBooleans":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3001,"When enabled breadcrumbs show `boolean`-symbols.")},"breadcrumbs.showArrays":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3002,"When enabled breadcrumbs show `array`-symbols.")},"breadcrumbs.showObjects":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3003,"When enabled breadcrumbs show `object`-symbols.")},"breadcrumbs.showKeys":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3004,"When enabled breadcrumbs show `key`-symbols.")},"breadcrumbs.showNull":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3005,"When enabled breadcrumbs show `null`-symbols.")},"breadcrumbs.showEnumMembers":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3006,"When enabled breadcrumbs show `enumMember`-symbols.")},"breadcrumbs.showStructs":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3007,"When enabled breadcrumbs show `struct`-symbols.")},"breadcrumbs.showEvents":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3008,"When enabled breadcrumbs show `event`-symbols.")},"breadcrumbs.showOperators":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3009,"When enabled breadcrumbs show `operator`-symbols.")},"breadcrumbs.showTypeParameters":{type:"boolean",default:!0,scope:at.y_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,at.EM)(3010,"When enabled breadcrumbs show `typeParameter`-symbols.")}}}),(0,at.Xb)(),(0,at.LA)(),(0,at.aP)(),(0,at.sj)(),(0,at.wj)(),(0,at.ET)(),(0,at.dT)(),(0,at.i_)(),(0,at.Qs)(),(0,at.es)(),(0,at.Ma)(),(0,gt.Ot)(),(0,gt.jn)();var Ni=class{constructor(e,t){this.uri=e,this.kind=t}},Ki=class{constructor(e,t){this.element=e,this.outline=t}},Zi=class{constructor(e,t,i,o,s){this.resource=e,this.editor=t,this._workspaceService=o,this._outlineService=s,this._disposables=new at.gj,this._currentOutline=new at.vj,this._outlineDisposables=new at.gj,this._onDidUpdate=new at.ej,this.onDidUpdate=this._onDidUpdate.event,this._cfgFilePath=Gi.FilePath.bindTo(i),this._cfgSymbolPath=Gi.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(e=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(e=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(e),t&&(this._bindToEditor(t),this._disposables.add(s.onDidChange(()=>this._bindToEditor(t))),this._disposables.add(t.onDidChangeControl(()=>this._bindToEditor(t)))),this._onDidUpdate.fire(this)}dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let e=[];if("on"===this._cfgFilePath.getValue()?e=e.concat(this._fileInfo.path):"last"===this._cfgFilePath.getValue()&&this._fileInfo.path.length>0&&(e=e.concat(this._fileInfo.path.slice(-1))),"off"===this._cfgSymbolPath.getValue()||!this._currentOutline.value)return e;let t=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i="last"===this._cfgSymbolPath.getValue()&&t.length>0?t.length-1:0;i<t.length;i++)e.push(new Ki(t[i],this._currentOutline.value));return 0===t.length&&!this._currentOutline.value.isEmpty&&e.push(new Ki(this._currentOutline.value,this._currentOutline.value)),e}_initFilePathInfo(e){var t;if((0,at.OT)(e,at.TT.untitled,at.TT.data))return{folder:void 0,path:[]};let i={folder:null!==(t=this._workspaceService.getWorkspaceFolder(e))&&void 0!==t?t:void 0,path:[]},o=e;for(;o&&"/"!==o.path&&(!i.folder||!(0,at.pT)(i.folder.uri,o));){i.path.unshift(new Ni(o,0===i.path.length?at.Ts.FILE:at.Ts.FOLDER));let e=o.path.length;if(o=(0,at.oT)(o),o.path.length===e)break}return i.folder&&this._workspaceService.getWorkbenchState()===at.Xo.WORKSPACE&&i.path.unshift(new Ni(i.folder.uri,at.Ts.ROOT_FOLDER)),i}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(e){let t=new at.FA;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add((0,at.kj)(()=>t.dispose(!0))),this._outlineService.createOutline(e,gt.Dt.Breadcrumbs,t.token).then(e=>{var i;t.token.isCancellationRequested&&(null!==(i=e)&&void 0!==i&&i.dispose(),e=void 0),this._currentOutline.value=e,this._onDidUpdate.fire(this),e&&this._outlineDisposables.add(e.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(e=>{this._onDidUpdate.fire(this),(0,at.sP)(e)})}};Zi=(0,at.Jb)([(0,at.Yb)(2,at.r_),(0,at.Yb)(3,at.ja),(0,at.Yb)(4,gt.An)],Zi);var Bi={};(0,at.vE)(),(0,at.Xb)(),(0,at.ln)(),(0,at.aP)(),(0,at.sj)(),(0,at.rl)(),(0,at._a)(),(0,at.wj)(),(0,at.DO)(),(0,at.dT)(),(0,at.SO)(),(0,at.i_)(),(0,at.Qs)(),(0,at.ps)(),(0,at.ox)(),(0,at.Ct)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.es)(),(0,at.Ma)(),(0,ut.tt)(),(0,at.Xd)(),(0,at.TM)(),(0,dt.q)(),(0,bt.At)(),(0,at.pv)(),(0,at.oS)(),(0,at.bE)(Bi);var Pi=class{constructor(e,t,i,o,s){this.resource=t,this._instantiationService=i,this._themeService=o,this._configurationService=s,this._disposables=new at.gj,this._fakeEvent=new UIEvent("fakeEvent"),this._onWillPickElement=new at.ej,this.onWillPickElement=this._onWillPickElement.event,this._previewDispoables=new at.vj,this._domNode=(0,at.jx)("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",e.appendChild(this._domNode)}dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(e,t,i,o,s){let r=this._themeService.getColorTheme().getColor(at.uh);this._arrow=(0,at.jx)("div"),this._arrow.className="arrow",this._arrow.style.borderColor="transparent transparent ".concat(r?r.toString():""),this._domNode.appendChild(this._arrow),this._treeContainer=(0,at.jx)("div"),this._treeContainer.style.background=r?r.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow="0 0 8px 2px ".concat(this._themeService.getColorTheme().getColor(at.ag)),this._treeContainer.style.border="1px solid ".concat(this._themeService.getColorTheme().getColor(at.ig)),this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:t,width:i,arrowSize:o,arrowOffset:s,inputHeight:0},this._tree=this._createTree(this._treeContainer,e),this._disposables.add(this._tree.onDidOpen(async e=>{let{element:t,editorOptions:i,sideBySide:o}=e;await this._revealElement(t,(0,rt.A)((0,rt.A)({},i),{},{preserveFocus:!1}),o)})),this._disposables.add(this._tree.onDidChangeFocus(e=>{this._previewDispoables.value=this._previewElement(e.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(e),this._layout()}catch(e){(0,at.sP)(e)}}_layout(){let e=2*this._layoutInfo.arrowSize,t=Math.min(this._layoutInfo.maxHeight-e,this._tree.contentHeight),i=t+e;this._domNode.style.height="".concat(i,"px"),this._domNode.style.width="".concat(this._layoutInfo.width,"px"),this._arrow.style.top="-".concat(2*this._layoutInfo.arrowSize,"px"),this._arrow.style.borderWidth="".concat(this._layoutInfo.arrowSize,"px"),this._arrow.style.marginLeft="".concat(this._layoutInfo.arrowOffset,"px"),this._treeContainer.style.height="".concat(t,"px"),this._treeContainer.style.width="".concat(this._layoutInfo.width,"px"),this._tree.layout(t,this._layoutInfo.width)}restoreViewState(){}};Pi=(0,at.Jb)([(0,at.Yb)(2,at.rx),(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,at.r_)],Pi);var Fi=class{getHeight(e){return 22}getTemplateId(e){return"FileStat"}},Yi=class{getId(e){return at.xO.isUri(e)?e.toString():(0,at.ss)(e)?e.id:(0,at.cs)(e)?e.uri.toString():e.resource.toString()}},Qi=class{constructor(e){this._fileService=e}hasChildren(e){return at.xO.isUri(e)||(0,at.ss)(e)||(0,at.cs)(e)||e.isDirectory}async getChildren(e){var t;if((0,at.ss)(e))return e.folders;let i;return i=(0,at.cs)(e)?e.uri:at.xO.isUri(e)?e:e.resource,null!==(t=(await this._fileService.resolve(i)).children)&&void 0!==t?t:[]}};Qi=(0,at.Jb)([(0,at.Yb)(0,at.fs)],Qi);var Xi=class{constructor(e,t){this._labels=e,this._configService=t,this.templateId="FileStat"}renderTemplate(e){return this._labels.create(e,{supportHighlights:!0})}renderElement(e,t,i){let o,s,r=this._configService.getValue("explorer.decorations"),{element:n}=e;(0,at.cs)(n)?(o=n.uri,s=at.Ts.ROOT_FOLDER):(o=n.resource,s=n.isDirectory?at.Ts.FOLDER:at.Ts.FILE),i.setFile(o,{fileKind:s,hidePath:!0,fileDecorations:r,matches:(0,at.el)(e.filterData),extraClasses:["picker-item"]})}disposeTemplate(e){e.dispose()}};Xi=(0,at.Jb)([(0,at.Yb)(1,at.r_)],Xi);var Hi=class{getKeyboardNavigationLabel(e){return e.name}},Ui=class{getWidgetAriaLabel(){return(0,at.EM)(3021,"Breadcrumbs")}getAriaLabel(e){return e.name}},ji=class{constructor(e,t){this._workspaceService=e,this._cachedExpressions=new Map,this._disposables=new at.gj;let i=Gi.FileExcludes.bindTo(t),o=()=>{e.getWorkspace().folders.forEach(e=>{let t=i.getValue({resource:e.uri});if(!t)return;let o={};for(let i in t){if("boolean"!=typeof t[i])continue;o[0===i.indexOf("**/")?i:at.MO.join(e.uri.path,i)]=t[i]}this._cachedExpressions.set(e.uri.toString(),(0,at.ba)(o))})};o(),this._disposables.add(i),this._disposables.add(i.onDidChange(o)),this._disposables.add(e.onDidChangeWorkspaceFolders(o))}dispose(){this._disposables.dispose()}filter(e,t){if((0,at.cs)(e))return!0;let i=this._workspaceService.getWorkspaceFolder(e.resource);return!i||!this._cachedExpressions.has(i.uri.toString())||!this._cachedExpressions.get(i.uri.toString())((0,at.NO)(i.uri.path,e.resource.path),(0,at.iT)(e.resource))}};ji=(0,at.Jb)([(0,at.Yb)(0,at.ja),(0,at.Yb)(1,at.r_)],ji);var zi=class{compare(e,t){return(0,at.cs)(e)&&(0,at.cs)(t)?e.index-t.index:e.isDirectory===t.isDirectory?(0,at.sn)(e.name,t.name):e.isDirectory?-1:1}},qi=class extends Pi{constructor(e,t,i,o,s,r,n){super(e,t,i,o,s),this._workspaceService=r,this._editorService=n}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");let t=e=>{this._treeContainer.classList.toggle("align-icons-and-twisties",e.hasFileIcons&&!e.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",!0===e.hidesExplorerArrows)};this._disposables.add(this._themeService.onDidFileIconThemeChange(t)),t(this._themeService.getFileIconTheme());let i=this._instantiationService.createInstance(ut.et,ut.Q);return this._disposables.add(i),this._instantiationService.createInstance(at.it,"BreadcrumbsFilePicker",e,new Fi,[this._instantiationService.createInstance(Xi,i)],this._instantiationService.createInstance(Qi),{multipleSelectionSupport:!1,sorter:new zi,filter:this._instantiationService.createInstance(ji),identityProvider:new Yi,keyboardNavigationLabelProvider:new Hi,accessibilityProvider:this._instantiationService.createInstance(Ui),showNotFoundMessage:!1,overrideStyles:{listBackground:at.uh}})}async _setInput(e){let t,{uri:i,kind:o}=e;t=o===at.Ts.ROOT_FOLDER?this._workspaceService.getWorkspace():(0,at.oT)(i);let s,r=this._tree;await r.setInput(t);for(let{element:n}of r.getNode().children){if((0,at.cs)(n)&&(0,at.pT)(n.uri,i)){s=n;break}if((0,at.pT)(n.resource,i)){s=n;break}}s&&(r.reveal(s,.5),r.setFocus([s],this._fakeEvent)),r.domFocus()}_previewElement(e){return at.mj.None}async _revealElement(e,t,i){return!((0,at.cs)(e)||!e.isFile)&&(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:e.resource,options:t},i?-2:void 0),!0)}};qi=(0,at.Jb)([(0,at.Yb)(2,at.rx),(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,at.r_),(0,at.Yb)(5,at.ja),(0,at.Yb)(6,bt.kt)],qi);var $i=class{constructor(e,t,i){this.comparator=e,this._order=i.getValue(t,"breadcrumbs.symbolSortOrder")}compare(e,t){return"name"===this._order?this.comparator.compareByName(e,t):"type"===this._order?this.comparator.compareByType(e,t):this.comparator.compareByPosition(e,t)}};$i=(0,at.Jb)([(0,at.Yb)(2,at.dv)],$i);var eo,to,io,oo=class extends Pi{_createTree(e,t){let{config:i}=t.outline;return this._instantiationService.createInstance(at.at,"BreadcrumbsOutlinePicker",e,i.delegate,i.renderers,i.treeDataSource,(0,rt.A)((0,rt.A)({},i.options),{},{sorter:this._instantiationService.createInstance($i,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1}))}_setInput(e){let t=e.outline.captureViewState();this.restoreViewState=()=>{t.dispose()};let i=this._tree;return i.setInput(e.outline),e.element!==e.outline&&(i.reveal(e.element,.5),i.setFocus([e.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(e){return this._tree.getInput().preview(e)}async _revealElement(e,t,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(e,t,i,!1),!0}};(0,at.vE)(),(0,at.Xb)(),(0,at.oS)(),(0,at.HT)(),(0,dt.io)(),(0,at.ta)(),(0,at.ia)(),(0,at.Ww)(),(0,at.pO)(),(0,at.sj)(),(0,at.QO)(),(0,at.wj)(),(0,at.dT)(),(0,at.SO)(),(0,ut._S)(),(0,at.TM)(),(0,vt.c)(),(0,at.Tb)(),(0,at.i_)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.Ol)(),(0,ut.Um)(),(0,at.Qs)(),(0,at.ps)(),(0,at.ox)(),(0,at.Ab)(),(0,at.Ua)(),(0,at.Ct)(),(0,at.Tt)(),(0,at.dc)(),(0,at.Ii)(),(0,at.G)(),(0,bt.en)(),(0,bt.G)(),(0,dt.q)(),(0,bt.At)(),(0,ut.B)(),(0,ut.tt)(),(0,gt.tr)(),(0,at.XA)(),(0,at.bE)(Bi);var so=eo=class extends Wi{constructor(e,t,i,o){super(),this.model=e,this.element=t,this.options=i,this._instantiationService=o,this._disposables=new at.gj}dispose(){this._disposables.dispose()}equals(e){return e instanceof eo&&(this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons)}render(e){let{element:t,outline:i}=this.element;if(t===i){let t=(0,at.px)("span",void 0,"\u2026");return void e.appendChild(t)}let o=i.config.delegate.getTemplateId(t),s=i.config.renderers.find(e=>e.templateId===o);if(!s)return void(e.textContent="<<NO RENDERER>>");let r=s.renderTemplate(e);s.renderElement({element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,r,void 0),this._disposables.add((0,at.kj)(()=>{s.disposeTemplate(r)})),t instanceof ut.hS&&i.uri&&this._disposables.add(this._instantiationService.invokeFunction(o=>no(o,e,t.symbol.name,{symbol:t.symbol,uri:i.uri},this.model,this.options.dragEditor)))}};so=eo=(0,at.Jb)([(0,at.Yb)(3,at.rx)],so);var ro=to=class extends Wi{constructor(e,t,i,o,s,r){super(),this.model=e,this.element=t,this.options=i,this._labels=o,this._hoverDelegate=s,this._instantiationService=r,this._disposables=new at.gj}dispose(){this._disposables.dispose()}equals(e){return e instanceof to&&(at.sT.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons)}render(e){let t=this._labels.create(e,{hoverDelegate:this._hoverDelegate});t.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===at.Ts.FOLDER||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add(at.Ts[this.element.kind].toLowerCase()),this._disposables.add(t),this._disposables.add(this._instantiationService.invokeFunction(t=>no(t,e,(0,at.iT)(this.element.uri),this.element.uri,this.model,this.options.dragEditor)))}};function no(e,t,i,o,s,r){let n=e.get(at.rx);return t.draggable=!0,new at.hx(t,{onDragStart:e=>{e.dataTransfer&&(e.dataTransfer.effectAllowed="copyMove",n.invokeFunction(t=>{var i;at.xO.isUri(o)?(0,ut.z)(t,[o],e):((0,ut.z)(t,[{resource:o.uri,selection:o.symbol.range}],e),(0,ut.Hm)([{name:o.symbol.name,fsPath:o.uri.fsPath,range:o.symbol.range,kind:o.symbol.kind}],e)),r&&s.editor&&(null===(i=s.editor)||void 0===i?void 0:i.input)&&ut.Bm.getInstance().setData([new ut.I({editor:s.editor.input,groupId:s.editor.group.id})],ut.I.prototype)}),(0,at.ea)(e,t,i))}})}ro=to=(0,at.Jb)([(0,at.Yb)(5,at.rx)],ro);var ao=(0,at.K)("breadcrumb-separator",at.fO.chevronRight,(0,at.EM)(3011,"Icon for the separator in the breadcrumbs.")),lo=(c=class{get onDidVisibilityChange(){return this._onDidVisibilityChange.event}constructor(e,t,i,o,s,r,n,a,d,l,c,h){var u,g,p,b;this._options=t,this._editorGroup=i,this._contextKeyService=o,this._contextViewService=s,this._instantiationService=r,this._quickInputService=n,this._fileService=a,this._editorService=d,this._labelService=l,this._disposables=new at.gj,this._breadcrumbsDisposables=new at.gj,this._model=new at.vj,this._breadcrumbsPickerShowing=!1,this._onDidVisibilityChange=this._disposables.add(new at.ej),this.domNode=(0,at.jx)("div"),this.domNode.classList.add("breadcrumbs-control"),(0,at.Dx)(e,this.domNode),this._cfUseQuickPick=Gi.UseQuickPick.bindTo(c),this._cfShowIcons=Gi.Icons.bindTo(c),this._cfTitleScrollbarSizing=Gi.TitleScrollbarSizing.bindTo(c),this._cfTitleScrollbarVisibility=Gi.TitleScrollbarVisibility.bindTo(c),this._labels=this._instantiationService.createInstance(ut.et,ut.Q);let m=null!==(u=this._cfTitleScrollbarSizing.getValue())&&void 0!==u?u:"default",v=null!==(g=t.widgetStyles)&&void 0!==g?g:at.wi,C=null!==(p=null===(b=this._cfTitleScrollbarVisibility)||void 0===b?void 0:b.getValue())&&void 0!==p?p:"auto";this._widget=new Li(this.domNode,io.SCROLLBAR_SIZES[m],io.SCROLLBAR_VISIBILITY[C],ao,v),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=io.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=io.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=io.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._hoverDelegate=(0,at.ra)("mouse"),this._disposables.add(h.register(this._editorGroup.id,this._widget)),this.hide()}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._model.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(e){this._widget.layout(e)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){let e=this.isHidden();this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0),e||this._onDidVisibilityChange.fire()}show(){let e=this.isHidden();this._ckBreadcrumbsVisible.set(!0),this.domNode.classList.toggle("hidden",!1),e&&this._onDidVisibilityChange.fire()}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();let e=bt.Ht.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:bt.Jt.PRIMARY}),t=this.isHidden();if(!e||!this._fileService.hasProvider(e))return this._ckBreadcrumbsPossible.set(!1),!t&&(this.hide(),!0);let i=bt.Ht.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:bt.Jt.PRIMARY});this.show(),this._ckBreadcrumbsPossible.set(!0);let o=this._instantiationService.createInstance(Zi,null!==i&&void 0!==i?i:e,this._editorGroup.activeEditorPane);this._model.value=o,this.domNode.classList.toggle("backslash-path","\\"===this._labelService.getSeparator(e.scheme,e.authority));let s=()=>{this.domNode.classList.toggle("relative-path",o.isRelative());let e=this._cfShowIcons.getValue(),t=(0,rt.A)((0,rt.A)({},this._options),{},{showFileIcons:this._options.showFileIcons&&e,showSymbolIcons:this._options.showSymbolIcons&&e}),i=o.getElements().map(e=>e instanceof Ni?this._instantiationService.createInstance(ro,o,e,t,this._labels,this._hoverDelegate):this._instantiationService.createInstance(so,o,e,t));0===i.length?(this._widget.setEnabled(!1),this._widget.setItems([new class extends Wi{render(e){e.textContent=(0,at.EM)(3015,"no elements")}equals(e){return e===this}dispose(){}}])):(this._widget.setEnabled(!0),this._widget.setItems(i),this._widget.reveal(i[i.length-1]))},r=o.onDidUpdate(s),n=this._cfShowIcons.onDidChange(s);s(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(r),this._breadcrumbsDisposables.add((0,at.kj)(()=>this._model.clear())),this._breadcrumbsDisposables.add(n),this._breadcrumbsDisposables.add((0,at.kj)(()=>this._widget.setItems([])));let a=()=>{var e,t,i;let o=null!==(e=this._cfTitleScrollbarSizing.getValue())&&void 0!==e?e:"default",s=null!==(t=null===(i=this._cfTitleScrollbarVisibility)||void 0===i?void 0:i.getValue())&&void 0!==t?t:"auto";this._widget.setHorizontalScrollbarSize(io.SCROLLBAR_SIZES[o]),this._widget.setHorizontalScrollbarVisibility(io.SCROLLBAR_VISIBILITY[s])};a();let d=this._cfTitleScrollbarSizing.onDidChange(a),l=this._cfTitleScrollbarVisibility.onDidChange(a);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add(l),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),t!==this.isHidden()}_onFocusEvent(e){e.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(e.item))}_onSelectEvent(e){if(!e.item)return;if(e.item===this._breadcrumbsPickerIgnoreOnceItem)return this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),void this._widget.setSelection(void 0);let{element:t}=e.item;this._editorGroup.focus();let i,o,s=this._getEditorGroup(e.payload);return void 0!==s?(this._widget.setFocused(void 0),this._widget.setSelection(void 0),void this._revealInEditor(e,t,s)):this._cfUseQuickPick.getValue()?(this._widget.setFocused(void 0),this._widget.setSelection(void 0),void this._quickInputService.quickAccess.show(t instanceof Ki?"@":"")):void this._contextViewService.showContextView({render:t=>{e.item instanceof ro?i=this._instantiationService.createInstance(qi,t,e.item.model.resource):e.item instanceof so&&(i=this._instantiationService.createInstance(oo,t,e.item.model.resource));let o=i.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),s=dt.ro.getInstance((0,at.$x)(this.domNode)).onDidChange(()=>this._contextViewService.hideContextView({source:this})),r=(0,at.US)(t),n=r.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?e.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),(0,at.xj)(i,o,s,r,n)},getAnchor:()=>{if(!o){let s,r=(0,at.$x)(this.domNode),n=r.innerWidth-8,a=Math.min(.7*r.innerHeight,300),d=Math.min(n,Math.max(240,n/4.17)),l=(0,at.Gx)(e.node.firstChild),c=l.top+l.height+8;c+a>=r.innerHeight&&(a=r.innerHeight-c-30);let h=l.left;if(h+d>=n&&(h=n-d),e.payload instanceof at.BT){let t=d-16;s=e.payload.posx-h,s>t&&(h=Math.min(n-d,h+s-t),s=t)}else s=l.left+.3*l.width-h;i.show(t,a,d,8,Math.max(0,s)),o={x:h,y:c}}return o},onHide:e=>{null!==e&&void 0!==e&&e.didPick||i.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),(null===e||void 0===e?void 0:e.source)===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),i.dispose()}})}_updateCkBreadcrumbsActive(){let e=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(e)}async _revealInEditor(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t instanceof Ni)if(t.kind===at.Ts.FILE)await this._editorService.openEditor({resource:t.uri,options:{pinned:o}},i);else{let t=this._widget.getItems(),i=t.indexOf(e.item);this._widget.setFocused(t[i+1]),this._widget.setSelection(t[i+1],io.Payload_Pick)}else t.outline.reveal(t,{pinned:o},-2===i,!1)}_getEditorGroup(e){return e===io.Payload_RevealAside?-2:e===io.Payload_Reveal?-1:void 0}},{_:io=c},{_:c.HEIGHT=22},{_:c.SCROLLBAR_SIZES={default:3,large:8}},{_:c.SCROLLBAR_VISIBILITY={auto:at.YA.Auto,visible:at.YA.Visible,hidden:at.YA.Hidden}},{_:c.Payload_Reveal={}},{_:c.Payload_RevealAside={}},{_:c.Payload_Pick={}},{_:c.CK_BreadcrumbsPossible=new at.Nk("breadcrumbsPossible",!1,(0,at.EM)(3012,"Whether the editor can show breadcrumbs"))},{_:c.CK_BreadcrumbsVisible=new at.Nk("breadcrumbsVisible",!1,(0,at.EM)(3013,"Whether breadcrumbs are currently visible"))},{_:c.CK_BreadcrumbsActive=new at.Nk("breadcrumbsActive",!1,(0,at.EM)(3014,"Whether breadcrumbs have focus"))},c);lo=io=(0,at.Jb)([(0,at.Yb)(3,at.Nb),(0,at.Yb)(4,at.Dl),(0,at.Yb)(5,at.rx),(0,at.Yb)(6,at.uc),(0,at.Yb)(7,at.fs),(0,at.Yb)(8,bt.kt),(0,at.Yb)(9,at.Ha),(0,at.Yb)(10,at.r_),(0,at.Yb)(11,gt.er)],lo);var co=class{get control(){return this._control}get onDidEnablementChange(){return this._onDidEnablementChange.event}get onDidVisibilityChange(){return this._onDidVisibilityChange.event}constructor(e,t,i,o,s,r){this._container=e,this._editorGroup=t,this._options=i,this._instantiationService=s,this._disposables=new at.gj,this._controlDisposables=new at.gj,this._onDidEnablementChange=this._disposables.add(new at.ej),this._onDidVisibilityChange=this._disposables.add(new at.ej);let n=this._disposables.add(Gi.IsEnabled.bindTo(o));this._disposables.add(n.onDidChange(()=>{let e=n.getValue();!e&&this._control?(this._controlDisposables.clear(),this._control=void 0,this._onDidEnablementChange.fire()):e&&!this._control&&(this._control=this.createControl(),this._control.update(),this._onDidEnablementChange.fire())})),n.getValue()&&(this._control=this.createControl()),this._disposables.add(r.onDidChangeFileSystemProviderRegistrations(e=>{var t,i;(null===(t=this._control)||void 0===t?void 0:t.model)&&this._control.model.resource.scheme!==e.scheme||(null===(i=this._control)||void 0===i?void 0:i.update())&&this._onDidEnablementChange.fire()}))}createControl(){let e=this._controlDisposables.add(this._instantiationService.createInstance(lo,this._container,this._options,this._editorGroup));return this._controlDisposables.add(e.onDidVisibilityChange(()=>this._onDidVisibilityChange.fire())),e}dispose(){this._disposables.dispose(),this._controlDisposables.dispose()}};function ho(e,t){let i=e.get(bt.W),o=e.get(gt.er).getWidget(i.activeGroup.id);if(o){let e=o.getItems().at(-1);o.setFocused(e),t&&o.setSelection(e,lo.Payload_Pick)}}co=(0,at.Jb)([(0,at.Yb)(3,at.r_),(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.fs)],co),(0,at.Db)(class extends at.bb{constructor(){super({id:"breadcrumbs.toggle",title:(0,at.DM)(3016,"Toggle Breadcrumbs"),category:vt.s.View,toggled:{condition:at.Mk.equals("config.breadcrumbs.enabled",!0),title:(0,at.EM)(3017,"Toggle Breadcrumbs"),mnemonicTitle:(0,at.EM)(3018,"&&Breadcrumbs")},menu:[{id:at.xb.CommandPalette},{id:at.xb.MenubarAppearanceMenu,group:"4_editor",order:2},{id:at.xb.NotebookToolbar,group:"notebookLayout",order:2},{id:at.xb.StickyScrollContext},{id:at.xb.NotebookStickyScrollContext,group:"notebookView",order:2},{id:at.xb.NotebookToolbarContext,group:"notebookView",order:2}]})}run(e){let t=e.get(at.r_),i=Gi.IsEnabled.bindTo(t).getValue();Gi.IsEnabled.bindTo(t).updateValue(!i)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"breadcrumbs.focusAndSelect",title:(0,at.DM)(3019,"Focus and Select Breadcrumbs"),precondition:lo.CK_BreadcrumbsVisible,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.Period,when:lo.CK_BreadcrumbsPossible},f1:!0})}run(e){ho(e,!0)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"breadcrumbs.focus",title:(0,at.DM)(3020,"Focus Breadcrumbs"),precondition:lo.CK_BreadcrumbsVisible,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.Semicolon,when:lo.CK_BreadcrumbsPossible},f1:!0})}run(e){ho(e,!1)}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.Period,when:at.Mk.not("config.breadcrumbs.enabled"),handler:async e=>{let t=e.get(at.rx),i=e.get(at.r_),o=Gi.IsEnabled.bindTo(i);return o.getValue()||(await o.updateValue(!0),await(0,at.$w)(50)),t.invokeFunction(ho,!0)}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:at.Ob.WorkbenchContrib,primary:at.KO.RightArrow,secondary:[at.JO.CtrlCmd|at.KO.RightArrow],mac:{primary:at.KO.RightArrow,secondary:[at.JO.Alt|at.KO.RightArrow]},when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive),handler(e){let t=e.get(bt.W),i=e.get(gt.er).getWidget(t.activeGroup.id);i&&i.focusNext()}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:at.Ob.WorkbenchContrib,primary:at.KO.LeftArrow,secondary:[at.JO.CtrlCmd|at.KO.LeftArrow],mac:{primary:at.KO.LeftArrow,secondary:[at.JO.Alt|at.KO.LeftArrow]},when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive),handler(e){let t=e.get(bt.W),i=e.get(gt.er).getWidget(t.activeGroup.id);i&&i.focusPrev()}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:at.Ob.WorkbenchContrib+1,primary:at.JO.CtrlCmd|at.KO.RightArrow,mac:{primary:at.JO.Alt|at.KO.RightArrow},when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive,at.st),handler(e){let t=e.get(bt.W),i=e.get(gt.er).getWidget(t.activeGroup.id);i&&i.focusNext()}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:at.Ob.WorkbenchContrib+1,primary:at.JO.CtrlCmd|at.KO.LeftArrow,mac:{primary:at.JO.Alt|at.KO.LeftArrow},when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive,at.st),handler(e){let t=e.get(bt.W),i=e.get(gt.er).getWidget(t.activeGroup.id);i&&i.focusPrev()}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:at.Ob.WorkbenchContrib,primary:at.KO.Enter,secondary:[at.KO.DownArrow],when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive),handler(e){let t=e.get(bt.W),i=e.get(gt.er).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),lo.Payload_Pick)}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:at.Ob.WorkbenchContrib,primary:at.KO.Space,secondary:[at.JO.CtrlCmd|at.KO.Enter],when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive),handler(e){let t=e.get(bt.W),i=e.get(gt.er).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),lo.Payload_Reveal)}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:at.Ob.WorkbenchContrib+1,primary:at.KO.Escape,when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive),handler(e){var t;let i=e.get(bt.W),o=e.get(gt.er).getWidget(i.activeGroup.id);o&&(o.setFocused(void 0),o.setSelection(void 0),null===(t=i.activeGroup.activeEditorPane)||void 0===t||t.focus())}}),at.kb.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.KO.Enter,when:at.Mk.and(lo.CK_BreadcrumbsVisible,lo.CK_BreadcrumbsActive,at.st),handler(e){let t=e.get(bt.kt),i=e.get(at.wt).lastFocusedList;if(!(i instanceof at.at)&&!(i instanceof at.it))return;let o=i.getFocus()[0];if(at.xO.isUri(null===o||void 0===o?void 0:o.resource))return t.openEditor({resource:o.resource,options:{pinned:!0}},-2);let s=i.getInput();return s&&"string"==typeof s.outlineKind?s.reveal(o,{pinned:!0,preserveFocus:!1},!0,!1):void 0}});var uo,go,po;(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.ur)(),(0,gt.Lt)(),(0,bt.Q)(),(0,bt.G)(),(0,bt.en)(),(0,bt.At)(),(0,at.ex)(),(0,at.ev)(),(0,vt.o)(),(0,gt.At)(),(0,at.pO)(),(0,at.Vb)(),(0,at.bE)({});var bo=class extends gt.Ft{constructor(e,t,i,o,s){super(e,{canAcceptInBackground:!0,noResultsPick:{label:(0,at.EM)(3349,"No matching editors"),groupId:-1}}),this.editorGroupService=t,this.editorService=i,this.modelService=o,this.languageService=s,this.pickState=new class{constructor(){this.scorerCache=Object.create(null),this.isQuickNavigating=void 0}reset(e){e||(this.scorerCache=Object.create(null)),this.isQuickNavigating=e}}}provide(e,t){return this.pickState.reset(!!e.quickNavigate),super.provide(e,t)}_getPicks(e){let t=(0,gt.jt)(e),i=this.doGetEditorPickItems().filter(e=>{if(!t.normalized)return!0;let i=(0,gt.Mt)(e,t,!0,at.dr,this.pickState.scorerCache);return!!i.score&&(e.highlights={label:i.labelMatch,description:i.descriptionMatch},!0)});if(t.normalized){let e=this.editorGroupService.getGroups(bt.X.GRID_APPEARANCE).map(e=>e.id);i.sort((i,o)=>i.groupId===o.groupId?(0,gt.kt)(i,o,t,!0,at.dr,this.pickState.scorerCache):e.indexOf(i.groupId)-e.indexOf(o.groupId))}let o=[];if(this.editorGroupService.count>1){let e;for(let t of i){if("number"!=typeof e||e!==t.groupId){let i=this.editorGroupService.getGroup(t.groupId);i&&o.push({type:"separator",label:i.label}),e=t.groupId}o.push(t)}}else o.push(...i);return o}doGetEditorPickItems(){let e=this.doGetEditors(),t=new Map;for(let{groupId:i}of e)if(!t.has(i)){let e=this.editorGroupService.getGroup(i);e&&t.set(i,e.ariaLabel)}return this.doGetEditors().map(e=>{var i;let{editor:o,groupId:s}=e,r=bt.Ht.getOriginalUri(o,{supportSideBySide:bt.Jt.PRIMARY}),n=o.isDirty()&&!o.isSaving(),a=o.getDescription(),d=a?"".concat(o.getName()," ").concat(a):o.getName();return{groupId:s,resource:r,label:o.getName(),ariaLabel:t.size>1?n?(0,at.EM)(3350,"{0}, unsaved changes, {1}",d,t.get(s)):(0,at.EM)(3351,"{0}, {1}",d,t.get(s)):n?(0,at.EM)(3352,"{0}, unsaved changes",d):d,description:a,iconClasses:(0,vt.i)(this.modelService,this.languageService,r,void 0,o.getIcon()).concat(o.getLabelExtraClasses()),italic:!(null!==(i=this.editorGroupService.getGroup(s))&&void 0!==i&&i.isPinned(o)),buttons:[{iconClass:n?"dirty-editor "+at.Bb.asClassName(at.fO.closeDirty):at.Bb.asClassName(at.fO.close),tooltip:(0,at.EM)(3353,"Close Editor"),alwaysVisible:n}],trigger:async()=>{let e=this.editorGroupService.getGroup(s);return e&&(await e.closeEditor(o,{preserveFocus:!0}),!e.contains(o))?gt.It.REMOVE_ITEM:gt.It.NO_ACTION},accept:(e,t)=>{var i;return null===(i=this.editorGroupService.getGroup(s))||void 0===i?void 0:i.openEditor(o,{preserveFocus:t.inBackground})}}})}};bo=(0,at.Jb)([(0,at.Yb)(1,bt.W),(0,at.Yb)(2,bt.kt),(0,at.Yb)(3,at.$b),(0,at.Yb)(4,at.$_)],bo);var mo=(h=class extends bo{constructor(e,t,i,o){super(uo.PREFIX,e,t,i,o)}doGetEditors(){let e=this.editorGroupService.activeGroup;return e.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE).map(t=>({editor:t,groupId:e.id}))}},{_:uo=h},{_:h.PREFIX="edt active "},h);mo=uo=(0,at.Jb)([(0,at.Yb)(0,bt.W),(0,at.Yb)(1,bt.kt),(0,at.Yb)(2,at.$b),(0,at.Yb)(3,at.$_)],mo);var vo=(u=class extends bo{constructor(e,t,i,o){super(go.PREFIX,e,t,i,o)}doGetEditors(){let e=[];for(let t of this.editorGroupService.getGroups(bt.X.GRID_APPEARANCE))for(let i of t.getEditors(bt.Ut.SEQUENTIAL))e.push({editor:i,groupId:t.id});return e}},{_:go=u},{_:u.PREFIX="edt "},u);vo=go=(0,at.Jb)([(0,at.Yb)(0,bt.W),(0,at.Yb)(1,bt.kt),(0,at.Yb)(2,at.$b),(0,at.Yb)(3,at.$_)],vo);var Co=(g=class extends bo{constructor(e,t,i,o){super(po.PREFIX,e,t,i,o)}doGetEditors(){let e=[];for(let t of this.editorService.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE))e.push(t);return e}},{_:po=g},{_:g.PREFIX="edt mru "},g);Co=po=(0,at.Jb)([(0,at.Yb)(0,bt.W),(0,at.Yb)(1,bt.kt),(0,at.Yb)(2,at.$b),(0,at.Yb)(3,at.$_)],Co),(0,at.Xb)(),(0,at.TM)(),(0,at.LM)(),(0,at.sj)(),(0,at.GM)(),(0,at.wj)(),(0,bt.en)(),(0,gt.f)(),(0,at.Lo)(),(0,at.ox)(),(0,at.yb)(),(0,at.Xd)(),(0,at.pv)(),(0,bt.G)(),(0,bt.At)(),(0,at.jr)(),(0,at.ps)();var wo,yo=(p=class extends Et.s{constructor(e,t,i,o,s,r,n,a,d,l){super(e,t,wo.VIEW_STATE_PREFERENCE_KEY,i,o,s,r,n,a,d),this.fileService=l,this._onDidChangeSelection=this._register(new at.ej),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeScroll=this._register(new at.ej),this.onDidChangeScroll=this._onDidChangeScroll.event,this.inputListener=this._register(new at.vj),this._register(this.textResourceConfigurationService.onDidChangeConfiguration(e=>this.handleConfigurationChangeEvent(e))),this._register(at.tj.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{var e;let t=this.computeAriaLabel();null!==(e=this.editorContainer)&&void 0!==e&&e.setAttribute("aria-label",t),this.updateEditorControlOptions({ariaLabel:t})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(e=>this.onDidChangeFileSystemProvider(e.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(e=>this.onDidChangeFileSystemProvider(e.scheme)))}handleConfigurationChangeEvent(e){let t=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(e,t)&&(this.isVisible()?this.updateEditorConfiguration(t):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(e,t){return e.affectsConfiguration(t,"editor")||e.affectsConfiguration(t,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.hasPendingConfigurationChange=(this.updateEditorConfiguration(),!1))}computeConfiguration(e){let t=(0,at.ZM)(e.editor)?(0,at.MM)(e.editor):Object.create(null);return Object.assign(t,this.getConfigurationOverrides(e)),t.ariaLabel=this.computeAriaLabel(),t}computeAriaLabel(){return this.input?(0,gt.d)(this.input,void 0,this.group,this.editorGroupService.count):(0,at.EM)(3422,"Editor")}onDidChangeFileSystemProvider(e){var t;this.input&&(null===(t=this.getActiveResource())||void 0===t?void 0:t.scheme)===e&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(e){this.input===e&&this.updateReadonly(e)}updateReadonly(e){this.updateEditorControlOptions((0,rt.A)({},this.getReadonlyConfiguration(e.isReadonly())))}getReadonlyConfiguration(e){return{readOnly:!!e,readOnlyMessage:"boolean"==typeof e?void 0:e}}getConfigurationOverrides(e){var t,i;return(0,rt.A)((0,rt.A)({overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0},this.getReadonlyConfiguration(null===(t=this.input)||void 0===t?void 0:t.isReadonly())),{},{renderValidationDecorations:!1===(null===(i=e.problems)||void 0===i?void 0:i.visibility)?"off":"on"})}createEditor(e){this.editorContainer=e,this.createEditorControl(e,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let e=this.getMainControl();e&&(this._register(e.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeCursorPosition(e=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(e)}))),this._register(e.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:bt.Bt.EDIT}))),this._register(e.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(e){switch(e.source){case at.Ar.PROGRAMMATIC:return bt.Bt.PROGRAMMATIC;case at.Ar.NAVIGATION:return bt.Bt.NAVIGATION;case at.Ar.JUMP:return bt.Bt.JUMP;default:return bt.Bt.USER}}getSelection(){let e=this.getMainControl();if(e){let t=e.getSelection();if(t)return new fo(t)}}async setInput(e,t,i,o){await super.setInput(e,t,i,o),this.inputListener.value=e.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(e)),this.updateEditorConfiguration(),(0,at.UM)(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let e=this.getMainControl();if(!e)throw Error("Control has not yet been initialized");return{scrollTop:e.getScrollTop()-e.getTopForLineNumber(1),scrollLeft:e.getScrollLeft()}}setScrollPosition(e){let t=this.getMainControl();if(!t)throw Error("Control has not yet been initialized");t.setScrollTop(e.scrollTop),e.scrollLeft&&t.setScrollLeft(e.scrollLeft)}setEditorVisible(e){e&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(e)}toEditorViewStateResource(e){return e.resource}updateEditorConfiguration(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getActiveResource();if(t&&(e=this.textResourceConfigurationService.getValue(t)),!e)return;let i=this.computeConfiguration(e),o=i;this.lastAppliedEditorOptions&&(o=(0,at.PM)(this.lastAppliedEditorOptions,o)),Object.keys(o).length>0&&(this.lastAppliedEditorOptions=i,this.updateEditorControlOptions(o))}getActiveResource(){let e=this.getMainControl();if(e){let t=e.getModel();if(t)return t.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}},{_:wo=p},{_:p.VIEW_STATE_PREFERENCE_KEY="textEditorViewState"},p);yo=wo=(0,at.Jb)([(0,at.Yb)(2,at.vb),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,at.Io),(0,at.Yb)(5,at.dv),(0,at.Yb)(6,at.Yd),(0,at.Yb)(7,bt.kt),(0,at.Yb)(8,bt.W),(0,at.Yb)(9,at.fs)],yo);var fo=(b=class e{constructor(e){this.textSelection=e}compare(t){if(!(t instanceof e))return bt.Vt.DIFFERENT;let i=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),o=Math.min(t.textSelection.selectionStartLineNumber,t.textSelection.positionLineNumber);return i===o?bt.Vt.IDENTICAL:Math.abs(i-o)<e.TEXT_EDITOR_SELECTION_THRESHOLD?bt.Vt.SIMILAR:bt.Vt.DIFFERENT}restore(e){return(0,rt.A)((0,rt.A)({},e),{},{selection:this.textSelection,selectionRevealType:at.kr.CenterIfOutsideViewport})}log(){return"line: ".concat(this.textSelection.startLineNumber,"-").concat(this.textSelection.endLineNumber,", col:  ").concat(this.textSelection.startColumn,"-").concat(this.textSelection.endColumn)}},{_:b.TEXT_EDITOR_SELECTION_THRESHOLD=10},b);(0,at.Xb)(),(0,at.TM)(),(0,at.LM)(),(0,at.GM)(),(0,bt.en)(),(0,ht.h)(),(0,bt.it)(),(0,bt._t)(),(0,at.yb)(),(0,at.Lo)(),(0,at.pv)(),(0,at.ox)(),(0,at.Xd)(),(0,bt.h)(),(0,at.iv)(),(0,at.Mb)(),(0,at.SO)(),(0,bt.G)(),(0,bt.At)(),(0,at.jr)(),(0,at.Pb)(),(0,at.dT)(),(0,at.rA)(),(0,at.Qs)(),(0,at.ps)(),(0,Ct.i)(),(0,at.uj)(),(0,ht.S)();var So,Eo=(m=class extends yo{get scopedContextKeyService(){if(!this.diffEditorControl)return;let e=this.diffEditorControl.getOriginalEditor(),t=this.diffEditorControl.getModifiedEditor();return(e.hasTextFocus()?e:t).invokeWithinContext(e=>e.get(at.Nb))}constructor(e,t,i,o,s,r,n,a,d,l){super(So.ID,e,t,i,o,s,n,r,a,d),this.preferencesService=l,this.diffEditorControl=void 0,this.inputLifecycleStopWatch=void 0,this._previousViewModel=null}getTitle(){return this.input?this.input.getName():(0,at.EM)(3419,"Text Diff Editor")}createEditorControl(e,t){this.diffEditorControl=this._register(this.instantiationService.createInstance(ht.x,e,t,{}))}updateEditorControlOptions(e){var t;null===(t=this.diffEditorControl)||void 0===t||t.updateOptions(e)}getMainControl(){var e;return null===(e=this.diffEditorControl)||void 0===e?void 0:e.getModifiedEditor()}async setInput(e,t,i,o){this._previousViewModel&&(this._previousViewModel=(this._previousViewModel.dispose(),null)),this.inputLifecycleStopWatch=void 0,await super.setInput(e,t,i,o);try{var s,r;let n=await e.resolve();if(o.isCancellationRequested)return;if(!(n instanceof bt.gt))return void this.openAsBinary(e,t);let a=(0,at.UM)(this.diffEditorControl),d=n,l=d.textDiffEditorModel?a.createViewModel(d.textDiffEditorModel):null;this._previousViewModel=l,await(null===l||void 0===l?void 0:l.waitForDiff()),a.setModel(l);let c=!1;(0,bt.hn)(null===t||void 0===t?void 0:t.viewState)||(c=this.restoreTextDiffEditorViewState(e,t,i,a));let h=!1;t&&(h=(0,ht.m)(t,a,at.rv.Immediate)),!h&&!c&&a.revealFirstDiff(),a.updateOptions((0,rt.A)((0,rt.A)({},this.getReadonlyConfiguration(null===(s=d.modifiedModel)||void 0===s?void 0:s.isReadonly())),{},{originalEditable:!(null!==(r=d.originalModel)&&void 0!==r&&r.isReadonly())})),a.handleInitialized(),this.inputLifecycleStopWatch=new at.lj(!1)}catch(i){await this.handleSetInputError(i,e,t)}}async handleSetInputError(e,t,i){if(this.isFileBinaryError(e))return this.openAsBinary(t,i);if(e.fileOperationResult===at.ks.FILE_TOO_LARGE){let o;throw o=e instanceof at.Ls?(0,at.EM)(3420,"At least one file is not displayed in the text compare editor because it is very large ({0}).",at.hs.formatSize(e.size)):(0,at.EM)(3421,"At least one file is not displayed in the text compare editor because it is very large."),(0,bt.Qt)(this.group,t,i,o,this.preferencesService)}throw e}restoreTextDiffEditorViewState(e,t,i,o){let s=this.loadEditorViewState(e,i);return!!s&&(null!==t&&void 0!==t&&t.selection&&s.modified&&(s.modified.cursorState=[]),o.restoreViewState(s),null!==t&&void 0!==t&&t.revealIfVisible&&o.revealFirstDiff(),!0)}openAsBinary(e,t){let i=e.original,o=e.modified,s=this.instantiationService.createInstance(bt.nt,e.getName(),e.getDescription(),i,o,!0),r=at.jb.as(bt.Rt.EditorFactory).getFileEditorFactory();r.isFileEditor(i)&&i.setForceOpenAsBinary(),r.isFileEditor(o)&&o.setForceOpenAsBinary(),this.group.replaceEditors([{editor:e,replacement:s,options:(0,rt.A)((0,rt.A)({},t),{},{activation:at.Er.PRESERVE,pinned:this.group.isPinned(e),sticky:this.group.isSticky(e)})}])}setOptions(e){super.setOptions(e),e&&(0,ht.m)(e,(0,at.UM)(this.diffEditorControl),at.rv.Smooth)}shouldHandleConfigurationChangeEvent(e,t){return!!super.shouldHandleConfigurationChangeEvent(e,t)||(e.affectsConfiguration(t,"diffEditor")||e.affectsConfiguration(t,"accessibility.verbosity.diffEditor"))}computeConfiguration(e){var t,i;let o=super.computeConfiguration(e);if((0,at.ZM)(e.diffEditor)){let t=(0,at.MM)(e.diffEditor);t.diffCodeLens=t.codeLens,delete t.codeLens,t.diffWordWrap=t.wordWrap,delete t.wordWrap,Object.assign(o,t)}return o.accessibilityVerbose=null!==(t=null===(i=e.accessibility)||void 0===i||null===(i=i.verbosity)||void 0===i?void 0:i.diffEditor)&&void 0!==t&&t,o}getConfigurationOverrides(e){var t;return(0,rt.A)((0,rt.A)((0,rt.A)({},super.getConfigurationOverrides(e)),this.getReadonlyConfiguration(null===(t=this.input)||void 0===t?void 0:t.isReadonly())),{},{originalEditable:this.input instanceof bt.nt&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"})}updateReadonly(e){var t;e instanceof bt.nt?null===(t=this.diffEditorControl)||void 0===t||t.updateOptions((0,rt.A)((0,rt.A)({},this.getReadonlyConfiguration(e.isReadonly())),{},{originalEditable:!e.original.isReadonly()})):super.updateReadonly(e)}isFileBinaryError(e){return Array.isArray(e)?e.some(e=>this.isFileBinaryError(e)):e.textFileOperationResult===bt.p.FILE_IS_BINARY}clearInput(){var e,t,i;this._previousViewModel&&(this._previousViewModel=(this._previousViewModel.dispose(),null)),super.clearInput();let o=null===(e=this.inputLifecycleStopWatch)||void 0===e?void 0:e.elapsed();this.inputLifecycleStopWatch=void 0,"number"==typeof o&&this.logInputLifecycleTelemetry(o,null===(t=this.getControl())||void 0===t||null===(t=t.getModel())||void 0===t||null===(t=t.modified)||void 0===t?void 0:t.getLanguageId()),null===(i=this.diffEditorControl)||void 0===i||i.setModel(null)}logInputLifecycleTelemetry(e,t){let i=!1;this.diffEditorControl instanceof ht.x&&(i=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:e,languageId:null!==t&&void 0!==t?t:"",collapseUnchangedRegions:i})}getControl(){return this.diffEditorControl}focus(){var e;super.focus(),null===(e=this.diffEditorControl)||void 0===e||e.focus()}hasFocus(){var e;return(null===(e=this.diffEditorControl)||void 0===e?void 0:e.hasTextFocus())||super.hasFocus()}setEditorVisible(e){var t,i;super.setEditorVisible(e),e?null===(t=this.diffEditorControl)||void 0===t||t.onVisible():null===(i=this.diffEditorControl)||void 0===i||i.onHide()}layout(e){var t;null===(t=this.diffEditorControl)||void 0===t||t.layout(e)}setBoundarySashes(e){var t;null===(t=this.diffEditorControl)||void 0===t||t.setBoundarySashes(e)}tracksEditorViewState(e){return e instanceof bt.nt}computeEditorViewState(e){var t;if(!this.diffEditorControl)return;let i=this.diffEditorControl.getModel();if(!i||!i.modified||!i.original)return;let o=this.toEditorViewStateResource(i);return o&&(0,at.pT)(o,e)&&null!==(t=this.diffEditorControl.saveViewState())&&void 0!==t?t:void 0}toEditorViewStateResource(e){let t,i;if(e instanceof bt.nt?(t=e.original.resource,i=e.modified.resource):(0,bt.rn)(e)||(t=e.original.uri,i=e.modified.uri),t&&i)return at.xO.from({scheme:"diff",path:"".concat((0,at.hA)(t.toString())).concat((0,at.hA)(i.toString()))})}},{_:So=m},{_:m.ID=bt.Yt},m);Eo=So=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.rx),(0,at.Yb)(3,at.Io),(0,at.Yb)(4,at.dv),(0,at.Yb)(5,bt.kt),(0,at.Yb)(6,at.Yd),(0,at.Yb)(7,bt.W),(0,at.Yb)(8,at.fs),(0,at.Yb)(9,Ct.r)],Eo),(0,at.QO)(),(0,at.dT)(),(0,at.SO)(),(0,at.pv)(),(0,at.TM)(),(0,at.Tb)(),(0,at.Pk)(),(0,at.Ab)(),(0,pt.tr)(),(0,bt.it)(),(0,bt.At)(),(0,at.Gp)(),(0,bt.G)(),(0,lt.o)();var ko="toggle.diff.renderSideBySide",_o="workbench.action.compareEditor.nextChange",Io="workbench.action.compareEditor.previousChange",xo="workbench.action.compareEditor.focusPrimarySide",Ao="workbench.action.compareEditor.focusSecondarySide",Vo="workbench.action.compareEditor.focusOtherSide",Do="workbench.action.compareEditor.openSide",Mo="toggle.diff.ignoreTrimWhitespace",To="workbench.action.compareEditor.swapSides";(0,at.QO)(),(0,at.ET)(),(0,at.dT)(),(0,at.GM)(),(0,at.SO)(),(0,at.Gp)(),(0,at.TM)(),(0,vt.c)(),(0,at.Tb)(),(0,at.Ib)(),(0,at.Rb)(),(0,at.i_)(),(0,at.Pk)(),(0,at.jr)(),(0,at.ox)(),(0,at.Ab)(),(0,at.Tt)(),(0,at.hl)(),(0,at.dc)(),(0,at.yb)(),(0,pt.tr)(),(0,bt.en)(),(0,bt.Ot)(),(0,ut.ca)(),(0,bt.Q)(),(0,bt.G)(),(0,dt.V)(),(0,dt.q)(),(0,bt.At)(),(0,bt.j)(),(0,bt.T)(),(0,dt.tt)();var Ro,Oo="workbench.action.closeUnmodifiedEditors",Wo="workbench.action.closeEditorsInGroup",Lo="workbench.action.closeEditorsAndGroup",Jo="workbench.action.closeEditorsToTheRight",Go="workbench.action.closeActiveEditor",No="workbench.action.closeActivePinnedEditor",Ko="workbench.action.closeGroup",Zo="workbench.action.closeOtherEditors",Bo="moveActiveEditor",Po="copyActiveEditor",Fo="layoutEditorGroups",Yo="workbench.action.keepEditor",Qo="workbench.action.toggleKeepEditors",Xo="workbench.action.toggleEditorGroupLock",Ho="workbench.action.lockEditorGroup",Uo="workbench.action.unlockEditorGroup",jo="workbench.action.showEditorsInGroup",zo="workbench.action.reopenWithEditor",qo="workbench.action.pinEditor",$o="workbench.action.unpinEditor",es="workbench.action.splitEditor",ts="workbench.action.splitEditorUp",is="workbench.action.splitEditorDown",os="workbench.action.splitEditorLeft",ss="workbench.action.splitEditorRight",rs="workbench.action.moveEditorToAboveGroup",ns="workbench.action.moveEditorToBelowGroup",as="workbench.action.moveEditorToLeftGroup",ds="workbench.action.moveEditorToRightGroup",ls="workbench.action.toggleMaximizeEditorGroup",cs="workbench.action.splitEditorInGroup",hs="workbench.action.joinEditorInGroup",us="workbench.action.toggleSplitEditorInGroupLayout",gs="workbench.action.focusFirstSideEditor",ps="workbench.action.focusSecondSideEditor",bs="workbench.action.openEditorAtIndex",ms="workbench.action.moveEditorToNewWindow",vs="workbench.action.copyEditorToNewWindow",Cs="workbench.action.moveEditorGroupToNewWindow",ws="workbench.action.copyEditorGroupToNewWindow",ys="workbench.action.newEmptyEditorWindow",fs="_workbench.open",Ss="_workbench.diff",Es=[es,Go,$o,Uo,ls],ks=function(e){return!(!(0,at.ZM)(e)||!(0,at.QM)(e.to)||!(0,at.eN)(e.by)&&!(0,at.QM)(e.by)||!(0,at.eN)(e.value)&&!(0,at.XM)(e.value))};function _s(){let e={type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right"]},by:{type:"string",enum:["tab","group"]},value:{type:"number"}}};function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.create(null),o=arguments.length>2?arguments[2]:void 0;t.to=t.to||"right",t.by=t.by||"tab",t.value="number"==typeof t.value?t.value:1;let s=o.get(bt.W).activeGroup,r=s.selectedEditors;if(r.length>0)switch(t.by){case"tab":if(e)return i(t,s,r);break;case"group":return function(e,t,i,o,s){var r;let n,a=s.get(bt.W),d=s.get(at.r_);switch(t.to){case"left":n=a.findGroup({direction:bt.K.LEFT},i),n||(n=a.addGroup(i,bt.K.LEFT));break;case"right":n=a.findGroup({direction:bt.K.RIGHT},i),n||(n=a.addGroup(i,bt.K.RIGHT));break;case"up":n=a.findGroup({direction:bt.K.UP},i),n||(n=a.addGroup(i,bt.K.UP));break;case"down":n=a.findGroup({direction:bt.K.DOWN},i),n||(n=a.addGroup(i,bt.K.DOWN));break;case"first":n=a.findGroup({location:bt.q.FIRST},i);break;case"last":n=a.findGroup({location:bt.q.LAST},i);break;case"previous":n=a.findGroup({location:bt.q.PREVIOUS},i);break;case"next":n=a.findGroup({location:bt.q.NEXT},i),n||(n=a.addGroup(i,(0,bt.tt)(d)));break;case"center":n=a.getGroups(bt.X.GRID_APPEARANCE)[a.count/2-1];break;case"position":n=a.getGroups(bt.X.GRID_APPEARANCE)[(null!==(r=t.value)&&void 0!==r?r:1)-1]}if(n){let t=(0,dt.nt)(i,o);e?i.moveEditors(t,n):i.id!==n.id&&i.copyEditors(t,n),n.focus()}}(e,t,s,r,o)}}function i(e,t,i){var s;let r=e.to;("first"===r||"right"===r||"position"===r&&(null!==(s=e.value)&&void 0!==s?s:1)<t.getIndexOfEditor(i[0]))&&(i=[...i].reverse());for(let n of i)o(e,t,n)}function o(e,t,i){var o,s,r;let n=t.getIndexOfEditor(i);switch(e.to){case"first":n=0;break;case"last":n=t.count-1;break;case"left":n-=null!==(o=e.value)&&void 0!==o?o:1;break;case"right":n+=null!==(s=e.value)&&void 0!==s?s:1;break;case"center":n=Math.round(t.count/2)-1;break;case"position":n=(null!==(r=e.value)&&void 0!==r?r:1)-1}n=n<0?0:n>=t.count?t.count-1:n,t.moveEditor(i,t,{index:n})}at.kb.registerCommandAndKeybindingRule({id:Bo,weight:at.Ob.WorkbenchContrib,when:at.Wp.editorTextFocus,primary:0,handler:(e,i)=>t(!0,i,e),metadata:{description:(0,at.EM)(3289,"Move the active editor by tabs or groups"),args:[{name:(0,at.EM)(3290,"Active editor move argument"),description:(0,at.EM)(3291,"Argument Properties:\n\t* 'to': String value providing where to move.\n\t* 'by': String value providing the unit for move (by tab or by group).\n\t* 'value': Number value providing how many positions or an absolute position to move."),constraint:ks,schema:e}]}}),at.kb.registerCommandAndKeybindingRule({id:Po,weight:at.Ob.WorkbenchContrib,when:at.Wp.editorTextFocus,primary:0,handler:(e,i)=>t(!1,i,e),metadata:{description:(0,at.EM)(3292,"Copy the active editor by groups"),args:[{name:(0,at.EM)(3293,"Active editor copy argument"),description:(0,at.EM)(3294,"Argument Properties:\n\t* 'to': String value providing where to copy.\n\t* 'value': Number value providing how many positions or an absolute position to copy."),constraint:ks,schema:e}]}})}function Is(e,t,i){if(!i.groupedEditors.length)return;let{group:o,editors:s}=i.groupedEditors[0],r=i.preserveFocus,n=e.addGroup(o,t);for(let a of s)a&&!a.hasCapability(bt.zt.Singleton)&&o.copyEditor(a,n,{preserveFocus:r});n.focus()}(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.ca)(),(0,at.oS)(),(0,at.HT)(),(0,at.Ur)(),(0,at.Kb)(),(0,at.wj)(),(0,at.ei)(),(0,at.Tb)(),(0,at.Pb)(),(0,at.Ol)(),(0,at.ox)(),(0,at.Dd)(),(0,at.Fd)(),(0,at.dc)(),(0,at.sp)(),(0,at.Xd)(),(0,ut.B)(),(0,dt.c)(),(0,bt.en)(),(0,pt.tr)(),(0,at.vl)(),(0,at.GM)(),(0,at.oE)(),(0,at.aP)(),(0,bt.Ot)(),(0,dt.pr)(),(0,ut.Um)(),(0,dt.V)(),(0,bt.Q)(),(0,at.iM)(),(0,dt.z)(),(0,at.au)(),(0,at.Vc)(),(0,at.ta)(),(0,at.bE)({});var xs=class extends at.Ub{constructor(e){super(),this.context=e}run(e,t){let i=this.context;return null!==t&&void 0!==t&&t.preserveFocus&&(i=(0,rt.A)((0,rt.A)({},this.context),{},{preserveFocus:!0})),super.run(e,i)}},As=(v=class extends at.ap{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g){super(h),this.parent=e,this.editorPartsView=t,this.groupsView=i,this.groupView=o,this.tabsModel=s,this.contextMenuService=r,this.instantiationService=n,this.contextKeyService=a,this.keybindingService=d,this.notificationService=l,this.quickInputService=c,this.editorResolverService=u,this.hostService=g,this.editorTransfer=ut.Bm.getInstance(),this.groupTransfer=ut.Bm.getInstance(),this.treeItemsTransfer=ut.Bm.getInstance(),this.editorActionsToolbarDisposables=this._register(new at.gj),this.editorActionsDisposables=this._register(new at.gj),this.renderDropdownAsChildElement=!1;let p=this.create(e);this.contextMenuContextKeyService=this._register(this.contextKeyService.createScoped(p));let b=this._register(this.instantiationService.createChild(new at.iu([at.Nb,this.contextMenuContextKeyService])));this.resourceContext=this._register(b.createInstance(pt.Bn)),this.editorPinnedContext=pt.on.bindTo(this.contextMenuContextKeyService),this.editorIsFirstContext=pt.nn.bindTo(this.contextMenuContextKeyService),this.editorIsLastContext=pt.an.bindTo(this.contextMenuContextKeyService),this.editorStickyContext=pt.cn.bindTo(this.contextMenuContextKeyService),this.editorAvailableEditorIds=pt.Xt.bindTo(this.contextMenuContextKeyService),this.editorCanSplitInGroupContext=pt.Qt.bindTo(this.contextMenuContextKeyService),this.sideBySideEditorContext=pt.Un.bindTo(this.contextMenuContextKeyService),this.groupLockedContext=pt.in.bindTo(this.contextMenuContextKeyService)}create(e){return this.updateTabHeight(),e}get editorActionsEnabled(){return"default"===this.groupsView.partOptions.editorActionsLocation&&"none"!==this.groupsView.partOptions.showTabs}createEditorActionsToolBar(e,t){this.editorActionsToolbarContainer=(0,at.px)("div"),this.editorActionsToolbarContainer.classList.add(...t),e.appendChild(this.editorActionsToolbarContainer),this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer)}handleEditorActionToolBarVisibility(e){var t;let i=this.editorActionsEnabled,o=!!this.editorActionsToolbar;i&&!o?this.doCreateEditorActionsToolBar(e):!i&&o&&(null!==(t=this.editorActionsToolbar)&&void 0!==t&&t.getElement().remove(),this.editorActionsToolbar=void 0,this.editorActionsToolbarDisposables.clear(),this.editorActionsDisposables.clear()),e.classList.toggle("hidden",!i)}doCreateEditorActionsToolBar(e){let t={groupId:this.groupView.id};this.editorActionsToolbar=this.editorActionsToolbarDisposables.add(this.instantiationService.createInstance(dt.fr,e,{actionViewItemProvider:(e,t)=>this.actionViewItemProvider(e,t),orientation:at.Hr.HORIZONTAL,ariaLabel:(0,at.EM)(3414,"Editor actions"),getKeyBinding:e=>this.getKeybinding(e),actionRunner:this.editorActionsToolbarDisposables.add(new xs(t)),anchorAlignmentProvider:()=>at.gl.RIGHT,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:at.xb.EditorTitle,overflowBehavior:{maxItems:9,exempted:Es},highlightToggledItems:!0})),this.editorActionsToolbar.context=t,this.editorActionsToolbarDisposables.add(this.editorActionsToolbar.actionRunner.onDidRun(e=>{e.error&&!(0,at.oP)(e.error)&&this.notificationService.error(e.error)}))}actionViewItemProvider(e,t){let i=this.groupView.activeEditorPane;if(i instanceof dt.s){let o=i.getActionViewItem(e,t);if(o)return o}return(0,at.Jr)(this.instantiationService,e,(0,rt.A)((0,rt.A)({},t),{},{menuAsChild:this.renderDropdownAsChildElement}))}updateEditorActionsToolbar(){if(!this.editorActionsEnabled)return;this.editorActionsDisposables.clear();let e=this.groupView.createEditorActions(this.editorActionsDisposables);this.editorActionsDisposables.add(e.onDidChange(()=>this.updateEditorActionsToolbar()));let t=(0,at.UM)(this.editorActionsToolbar),{primary:i,secondary:o}=this.prepareEditorActions(e.actions);t.setActions((0,at.Wr)(i),(0,at.Wr)(o))}getEditorPaneAwareContextKeyService(){var e,t;return null!==(e=null===(t=this.groupView.activeEditorPane)||void 0===t?void 0:t.scopedContextKeyService)&&void 0!==e?e:this.contextKeyService}clearEditorActionsToolbar(){this.editorActionsEnabled&&(0,at.UM)(this.editorActionsToolbar).setActions([],[])}onGroupDragStart(e,t){var i;if(e.target!==t)return!1;let o=this.isNewWindowOperation(e);this.groupTransfer.setData([new ut.F(this.groupView.id)],ut.F.prototype),e.dataTransfer&&(e.dataTransfer.effectAllowed="copyMove");let s=!1;if("multiple"===this.groupsView.partOptions.showTabs?s=this.doFillResourceDataTransfers(this.groupView.getEditors(bt.Ut.SEQUENTIAL),e,o):this.groupView.activeEditor&&(s=this.doFillResourceDataTransfers([this.groupView.activeEditor],e,o)),!s&&at.lE&&null!==(i=e.dataTransfer)&&void 0!==i&&i.setData(at.oa.TEXT,String(this.groupView.label)),this.groupView.activeEditor){let i=this.groupView.activeEditor.getName();"multiple"===this.groupsView.partOptions.showTabs&&this.groupView.count>1&&(i=(0,at.EM)(3415,"{0} (+{1})",i,this.groupView.count-1)),(0,at.ea)(e,t,i)}return o}async onGroupDragEnd(e,t,i,o){if(this.groupTransfer.clearData(ut.F.prototype),e.target!==i||!o||(0,ut.V)())return;let s=await this.maybeCreateAuxiliaryEditorPartAt(e,i);if(!s)return;let r=s.activeGroup;this.groupsView.mergeGroup(this.groupView,r.id,{mode:this.isMoveOperation(null!==t&&void 0!==t?t:e,r.id)?bt.Z.MOVE_EDITORS:bt.Z.COPY_EDITORS}),r.focus()}async maybeCreateAuxiliaryEditorPartAt(e,t){var i;let{point:o,display:s}=null!==(i=await this.hostService.getCursorScreenPoint())&&void 0!==i?i:{point:{x:e.screenX,y:e.screenY}},r=(0,at.Bx)();if("visible"===r.document.visibilityState&&r.document.hasFocus()&&o.x>=r.screenX&&o.x<=r.screenX+r.outerWidth&&o.y>=r.screenY&&o.y<=r.screenY+r.outerHeight)return;let n=t.offsetWidth/2,a=30+t.offsetHeight/2,d={x:o.x-n,y:o.y-a};return s&&(d.x<s.x&&(d.x=s.x),d.y<s.y&&(d.y=s.y)),this.editorPartsView.createAuxiliaryEditorPart({bounds:d})}isNewWindowOperation(e){return this.groupsView.partOptions.dragToOpenWindow?!e.altKey:e.altKey}isMoveOperation(e,t,i){return!(null===i||void 0===i||!i.hasCapability(bt.zt.Singleton))||(!(e.ctrlKey&&!at.pM||e.altKey&&at.pM)||t===this.groupView.id)}doFillResourceDataTransfers(e,t,i){return!!e.length&&(this.instantiationService.invokeFunction(ut.z,e.map(e=>({editor:e,groupId:this.groupView.id})),t,{disableStandardTransfer:i}),!0)}onTabContextMenu(e,t,i){this.resourceContext.set(bt.Ht.getOriginalUri(e,{supportSideBySide:bt.Jt.PRIMARY})),this.editorPinnedContext.set(this.tabsModel.isPinned(e)),this.editorIsFirstContext.set(this.tabsModel.isFirst(e)),this.editorIsLastContext.set(this.tabsModel.isLast(e)),this.editorStickyContext.set(this.tabsModel.isSticky(e)),this.groupLockedContext.set(this.tabsModel.isLocked),this.editorCanSplitInGroupContext.set(e.hasCapability(bt.zt.CanSplitInGroup)),this.sideBySideEditorContext.set(e.typeId===bt.Et.ID),(0,pt.$n)(this.editorAvailableEditorIds,e,this.editorResolverService);let o=i;(0,at.SS)(t)&&(o=new at.BT((0,at.$x)(i),t)),this.contextMenuService.showContextMenu({getAnchor:()=>o,menuId:at.xb.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextMenuContextKeyService,getActionsContext:()=>({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(e)}),getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id,this.contextMenuContextKeyService),onHide:()=>this.groupsView.activeGroup.focus()})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){var t;let i=this.getKeybinding(e);return i&&null!==(t=i.getLabel())&&void 0!==t?t:void 0}get tabHeight(){return"compact"===this.groupsView.partOptions.tabHeight?Ro.EDITOR_TAB_HEIGHT.compact:Ro.EDITOR_TAB_HEIGHT.normal}getHoverTitle(e){let t=e.getTitle(bt.Xt.LONG);return this.tabsModel.isPinned(e)?t:{markdown:new at.Bc("",{supportThemeIcons:!0,isTrusted:!0}).appendText(t).appendMarkdown(' (_preview_ [$(gear)](command:workbench.action.openSettings?%5B%22workbench.editor.enablePreview%22%5D "Configure Preview Mode"))'),markdownNotSupportedFallback:t+" (preview)"}}updateTabHeight(){this.parent.style.setProperty("--editor-group-tab-height","".concat(this.tabHeight,"px"))}updateOptions(e,t){e.tabHeight!==t.tabHeight&&this.updateTabHeight(),(e.editorActionsLocation!==t.editorActionsLocation||e.showTabs!==t.showTabs)&&this.editorActionsToolbarContainer&&(this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer),this.updateEditorActionsToolbar())}},{_:Ro=v},{_:v.EDITOR_TAB_HEIGHT={normal:35,compact:22}},v);As=Ro=(0,at.Jb)([(0,at.Yb)(5,at.El),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.Nb),(0,at.Yb)(8,at.Ed),(0,at.Yb)(9,at.Pd),(0,at.Yb)(10,at.uc),(0,at.Yb)(11,at.Yd),(0,at.Yb)(12,dt.B),(0,at.Yb)(13,dt.R)],As),(0,at.Xb)(),(0,at.TM)(),(0,at.Kb)(),(0,bt.en)(),(0,bt.Ot)(),(0,pt.W)(),(0,pt.st)(),(0,gt.s)(),(0,gt.Fn)(),(0,at.Dd)(),(0,at.Rb)(),(0,bt.Q)(),(0,bt.G)(),(0,bt.At)(),(0,at.i_)(),(0,ut.Pb)(),(0,ut.ta)(),(0,at.Vl)(),(0,at.ur)(),(0,at.dc)(),(0,at.pO)(),(0,at.Vb)(),(0,bt.i)(),(0,bt.V)(),(0,dt.V)(),(0,at.iM)(),(0,at.Tb)(),(0,at.Pk)(),(0,at.QO)(),(0,at.Ab)(),(0,at.gb)(),(0,vt.c)(),(0,pt.tr)(),(0,at.oS)(),(0,pt.gt)(),(0,at.Va)(),(0,at.Tt)(),(0,dt.tt)();var Vs=class extends at.bb{constructor(e,t,i){super(e),this.commandId=t,this.commandArgs=i}run(e){return e.get(at.Lb).executeCommand(this.commandId,this.commandArgs)}},Ds=class extends at.bb{getDirection(e){return(0,bt.tt)(e)}async run(e){let t=e.get(bt.W),i=e.get(at.r_),o=e.get(bt.kt),s=e.get(at.wt);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Is(t,this.getDirection(i),(0,Et.t)(n,o,t,s))}},Ms=(C=class e extends Ds{constructor(){super({id:e.ID,title:(0,at.DM)(3163,"Split Editor"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.KO.Backslash},category:vt.s.View})}},{_:C.ID=es},C),Ts=({_:(w=class extends Vs{constructor(){super({id:ts,title:(0,at.DM)(3167,"Split Editor Up"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.Backslash)},category:vt.s.View},ts)}}).LABEL=(0,at.EM)(3167,"Split Editor Up")},w),Rs=({_:(y=class extends Vs{constructor(){super({id:is,title:(0,at.DM)(3168,"Split Editor Down"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.Backslash)},category:vt.s.View},is)}}).LABEL=(0,at.EM)(3168,"Split Editor Down")},y),Os=class extends at.bb{constructor(){super({id:"workbench.action.joinTwoGroups",title:(0,at.DM)(3169,"Join Editor Group with Next Group"),f1:!0,category:vt.s.View})}async run(e,t){let i,o=e.get(bt.W);if(i=t&&"number"==typeof t.groupId?o.getGroup(t.groupId):o.activeGroup,i){let e=[bt.K.RIGHT,bt.K.DOWN,bt.K.LEFT,bt.K.UP];for(let t of e){let e=o.findGroup({direction:t},i);if(e&&i!==e){o.mergeGroup(i,e);break}}}}},Ws=class extends at.bb{constructor(){super({id:"workbench.action.joinAllGroups",title:(0,at.DM)(3170,"Join All Editor Groups"),f1:!0,category:vt.s.View})}async run(e){let t=e.get(bt.W);t.mergeAllGroups(t.activeGroup)}},Ls=class extends at.bb{constructor(){super({id:"workbench.action.navigateEditorGroups",title:(0,at.DM)(3171,"Navigate Between Editor Groups"),f1:!0,category:vt.s.View})}async run(e){var t;let i=e.get(bt.W);null===(t=i.findGroup({location:bt.q.NEXT},i.activeGroup,!0))||void 0===t||t.focus()}},Js=class extends at.bb{constructor(){super({id:"workbench.action.focusActiveEditorGroup",title:(0,at.DM)(3172,"Focus Active Editor Group"),f1:!0,category:vt.s.View})}async run(e){e.get(bt.W).activeGroup.focus()}},Gs=class extends at.bb{constructor(e,t){super(e),this.scope=t}async run(e){var t;let i=e.get(bt.W);null===(t=i.findGroup(this.scope,i.activeGroup,!0))||void 0===t||t.focus()}},Ns=(f=class extends at.Hb{constructor(e,t,i){super(e,t,at.Bb.asClassName(at.fO.close)),this.commandService=i}run(e){return this.commandService.executeCommand(Go,void 0,e)}},{_:f.ID="workbench.action.closeActiveEditor"},{_:f.LABEL=(0,at.EM)(3181,"Close Editor")},f);Ns=(0,at.Jb)([(0,at.Yb)(2,at.Lb)],Ns);var Ks=(S=class extends at.Hb{constructor(e,t,i){super(e,t,at.Bb.asClassName(at.fO.pinned)),this.commandService=i}run(e){return this.commandService.executeCommand($o,void 0,e)}},{_:S.ID="workbench.action.unpinActiveEditor"},{_:S.LABEL=(0,at.EM)(3182,"Unpin Editor")},S);Ks=(0,at.Jb)([(0,at.Yb)(2,at.Lb)],Ks);var Zs=(E=class extends at.Hb{constructor(e,t,i){super(e,t,at.Bb.asClassName(at.fO.close)),this.editorGroupService=i}async run(e){let t=e?this.editorGroupService.getGroup(e.groupId):this.editorGroupService.activeGroup;if(!t)return;let i=void 0===(null===e||void 0===e?void 0:e.editorIndex)?t.activeEditor:t.getEditorByIndex(e.editorIndex);if(!i)return;let o=[];t.isSelected(i)?o.push(...t.selectedEditors):o.push(i);for(let s of o)await t.closeEditor(s,{preserveFocus:null===e||void 0===e?void 0:e.preserveFocus})}},{_:E.ID="workbench.action.closeActiveEditor"},{_:E.LABEL=(0,at.EM)(3183,"Close")},E);Zs=(0,at.Jb)([(0,at.Yb)(2,bt.W)],Zs);var Bs=class extends at.bb{constructor(){super({id:"workbench.action.revertAndCloseActiveEditor",title:(0,at.DM)(3184,"Revert and Close Editor"),f1:!0,category:vt.s.View})}async run(e){let t=e.get(bt.kt),i=e.get(at.mb),o=t.activeEditorPane;if(o){let e=o.input,s=o.group;try{await t.revert({editor:e,groupId:s.id})}catch(o){i.error(o),await t.revert({editor:e,groupId:s.id},{soft:!0})}await s.closeEditor(e)}}},Ps=class extends at.bb{constructor(){super({id:"workbench.action.closeEditorsToTheLeft",title:(0,at.DM)(3185,"Close Editors to the Left in Group"),f1:!0,category:vt.s.View})}async run(e,t){let i=e.get(bt.W),{group:o,editor:s}=this.getTarget(i,t);o&&s&&await o.closeEditors({direction:bt.Pt.LEFT,except:s,excludeSticky:!0})}getTarget(e,t){return t?{editor:t.editor,group:e.getGroup(t.groupId)}:{group:e.activeGroup,editor:e.activeGroup.activeEditor}}},Fs=class extends at.bb{groupsToClose(e){let t=[],i=e.getGroups(bt.X.GRID_APPEARANCE);for(let o=i.length-1;o>=0;o--)t.push(i[o]);return t}async run(e){let t=e.get(bt.kt),i=e.get(at.mb),o=e.get(at.Ba),s=e.get(bt.W),r=e.get(bt.B),n=e.get(at.Bl),a=new Set,d=new Set,l=new Set,c=new Map;for(let{editor:p,groupId:b}of t.getEditors(bt.Ut.SEQUENTIAL,{excludeSticky:this.excludeSticky})){var h;let t=!1,o=!1;if(p.closeHandler)try{t=p.closeHandler.showConfirm()}catch(e){i.error(e),o=!0}if((!p.closeHandler||o)&&(t=p.isDirty()&&!p.isSaving()),t)if("function"==typeof(null===(h=p.closeHandler)||void 0===h?void 0:h.confirm)){let e=c.get(p.typeId);e||(e=new Set,c.set(p.typeId,e)),e.add({editor:p,groupId:b})}else p.hasCapability(bt.zt.Untitled)||r.getAutoSaveMode(p).mode!==bt.n.ON_FOCUS_CHANGE?at.hM&&(at.yM||at.dM)&&!p.hasCapability(bt.zt.Untitled)&&r.getAutoSaveMode(p).mode===bt.n.ON_WINDOW_CHANGE?l.add({editor:p,groupId:b}):a.add({editor:p,groupId:b}):d.add({editor:p,groupId:b})}if(a.size>0){let e=Array.from(a.values());switch(await this.revealEditorsToConfirm(e,s),await n.showSaveConfirm(e.map(e=>{let{editor:t}=e;return t instanceof bt.Et?t.primary.getName():t.getName()}))){case ut.ea.CANCEL:return;case ut.ea.DONT_SAVE:await this.revertEditors(t,i,o,e);break;case ut.ea.SAVE:await t.save(e,{reason:bt.Kt.EXPLICIT})}}for(let[,p]of c){var u,g;let e=Array.from(p.values());await this.revealEditorsToConfirm(e,s);let r=await(null===(u=e.at(0))||void 0===u||null===(u=u.editor.closeHandler)||void 0===u||null===(g=u.confirm)||void 0===g?void 0:g.call(u,e));if("number"==typeof r)switch(r){case ut.ea.CANCEL:return;case ut.ea.DONT_SAVE:await this.revertEditors(t,i,o,e);break;case ut.ea.SAVE:await t.save(e,{reason:bt.Kt.EXPLICIT})}}if(d.size>0){let e=Array.from(d.values());await t.save(e,{reason:bt.Kt.FOCUS_CHANGE})}if(l.size>0){let e=Array.from(l.values());await t.save(e,{reason:bt.Kt.WINDOW_CHANGE})}return this.doCloseAll(s)}revertEditors(e,t,i,o){return i.withProgress({location:pt.mt.Window,delay:800,title:(0,at.EM)(3186,"Reverting Editors...")},()=>this.doRevertEditors(e,t,o))}async doRevertEditors(e,t,i){try{await e.revert(i)}catch(o){t.error(o),await e.revert(i,{soft:!0})}}async revealEditorsToConfirm(e,t){try{let o=new Set;for(let{editor:s,groupId:r}of e){var i;o.has(r)||(o.add(r),await(null===(i=t.getGroup(r))||void 0===i?void 0:i.openEditor(s)))}}catch(o){}}async doCloseAll(e){await Promise.all(this.groupsToClose(e).map(e=>e.closeAllEditors({excludeSticky:this.excludeSticky})))}},Ys=(k=class e extends Fs{constructor(){super({id:e.ID,title:e.LABEL,f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.KeyW)},icon:at.fO.closeAll,category:vt.s.View})}get excludeSticky(){return!0}},{_:k.ID="workbench.action.closeAllEditors"},{_:k.LABEL=(0,at.DM)(3187,"Close All Editors")},k),Qs=class extends at.bb{constructor(){super({id:"workbench.action.closeEditorsInOtherGroups",title:(0,at.DM)(3189,"Close Editors in Other Groups"),f1:!0,category:vt.s.View})}async run(e,t){let i=e.get(bt.W),o=t?i.getGroup(t.groupId):i.activeGroup;await Promise.all(i.getGroups(bt.X.MOST_RECENTLY_ACTIVE).map(async e=>{if(!o||e.id!==o.id)return e.closeAllEditors({excludeSticky:!0})}))}},Xs=class extends at.bb{constructor(){super({id:"workbench.action.closeEditorInAllGroups",title:(0,at.DM)(3190,"Close Editor in All Groups"),f1:!0,category:vt.s.View})}async run(e){let t=e.get(bt.kt),i=e.get(bt.W),o=t.activeEditor;o&&await Promise.all(i.getGroups(bt.X.MOST_RECENTLY_ACTIVE).map(e=>e.closeEditor(o)))}},Hs=class extends at.bb{constructor(e,t,i){super(e),this.direction=t,this.isMove=i}async run(e,t){let i,o=e.get(bt.W);if(i=t&&"number"==typeof t.groupId?o.getGroup(t.groupId):o.activeGroup,i){let e;if(this.isMove){let t=this.findTargetGroup(o,i);t&&(e=o.moveGroup(i,t,this.direction))}else e=o.copyGroup(i,i,this.direction);e&&o.activateGroup(e)}}findTargetGroup(e,t){let i=[this.direction];switch(this.direction){case bt.K.LEFT:case bt.K.RIGHT:i.push(bt.K.UP,bt.K.DOWN);break;case bt.K.UP:case bt.K.DOWN:i.push(bt.K.LEFT,bt.K.RIGHT)}for(let o of i){let i=e.findGroup({direction:o},t);if(i)return i}}},Us=class extends Hs{constructor(e,t){super(e,t,!0)}},js=class extends Hs{constructor(e,t){super(e,t,!1)}},zs=class extends at.bb{constructor(){super({id:"workbench.action.minimizeOtherEditors",title:(0,at.DM)(3199,"Expand Editor Group"),f1:!0,category:vt.s.View,precondition:pt.kn})}async run(e){e.get(bt.W).arrangeGroups(bt.Y.EXPAND)}},qs=class extends at.bb{constructor(){super({id:"workbench.action.minimizeOtherEditorsHideSidebar",title:(0,at.DM)(3200,"Expand Editor Group and Hide Side Bars"),f1:!0,category:vt.s.View,precondition:at.Mk.or(pt.kn,pt.Hn,pt.pn)})}async run(e){let t=e.get(bt.W),i=e.get(pt.ot);i.setPartHidden(!0,pt.V.SIDEBAR_PART),i.setPartHidden(!0,pt.V.AUXILIARYBAR_PART),t.arrangeGroups(bt.Y.EXPAND)}},$s=class extends at.bb{constructor(){super({id:"workbench.action.evenEditorWidths",title:(0,at.DM)(3201,"Reset Editor Group Sizes"),f1:!0,category:vt.s.View})}async run(e){e.get(bt.W).arrangeGroups(bt.Y.EVEN)}},er=class extends at.bb{constructor(){super({id:"workbench.action.toggleEditorWidths",title:(0,at.DM)(3202,"Toggle Editor Group Sizes"),f1:!0,category:vt.s.View})}async run(e){e.get(bt.W).toggleExpandGroup()}},tr=class extends at.bb{constructor(){super({id:"workbench.action.maximizeEditorHideSidebar",title:(0,at.DM)(3203,"Maximize Editor Group and Hide Side Bars"),f1:!0,category:vt.s.View,precondition:at.Mk.or(at.Mk.and(pt.gn.negate(),pt._n),pt.Hn,pt.pn)})}async run(e){let t=e.get(pt.ot),i=e.get(bt.W);e.get(bt.kt).activeEditor&&(t.setPartHidden(!0,pt.V.SIDEBAR_PART),t.setPartHidden(!0,pt.V.AUXILIARYBAR_PART),i.arrangeGroups(bt.Y.MAXIMIZE))}},ir=class extends at.bb{constructor(){super({id:ls,title:(0,at.DM)(3204,"Toggle Maximize Editor Group"),f1:!0,category:vt.s.View,precondition:at.Mk.or(pt._n,pt.gn),keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.KeyM)},menu:[{id:at.xb.EditorTitle,order:-1e4,group:"navigation",when:pt.gn},{id:at.xb.EmptyEditorGroup,order:-1e4,group:"navigation",when:pt.gn}],icon:at.fO.screenFull,toggled:{condition:pt.gn,title:(0,at.EM)(3205,"Unmaximize Group")}})}async run(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(bt.W),r=(0,Et.t)(i,e.get(bt.kt),s,e.get(at.wt));r.groupedEditors.length&&s.toggleMaximizeGroup(r.groupedEditors[0].group)}},or=class extends at.bb{async run(e){let t=e.get(bt.W),i=this.navigate(t);if(!i)return;let{groupId:o,editor:s}=i;if(!s)return;let r=t.getGroup(o);r&&await r.openEditor(s)}},sr=(_=class e extends at.bb{constructor(){super({id:e.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3212,"Go Forward")),{},{mnemonicTitle:(0,at.EM)(3213,"&&Forward")}),f1:!0,icon:at.fO.arrowRight,precondition:at.Mk.has("canNavigateForward"),keybinding:{weight:at.Ob.WorkbenchContrib,win:{primary:at.JO.Alt|at.KO.RightArrow,secondary:[at.KO.BrowserForward]},mac:{primary:at.JO.WinCtrl|at.JO.Shift|at.KO.Minus,secondary:[at.KO.BrowserForward]},linux:{primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.Minus,secondary:[at.KO.BrowserForward]}},menu:[{id:at.xb.MenubarGoMenu,group:"1_history_nav",order:2},{id:at.xb.CommandCenter,order:2,when:at.Mk.has("config.workbench.navigationControl.enabled")}]})}async run(e){await e.get(gt.Pn).goForward(gt.a.NONE)}},{_:_.ID="workbench.action.navigateForward"},{_:_.LABEL=(0,at.EM)(3212,"Go Forward")},_),rr=(I=class e extends at.bb{constructor(){super({id:e.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3214,"Go Back")),{},{mnemonicTitle:(0,at.EM)(3215,"&&Back")}),f1:!0,precondition:at.Mk.has("canNavigateBack"),icon:at.fO.arrowLeft,keybinding:{weight:at.Ob.WorkbenchContrib,win:{primary:at.JO.Alt|at.KO.LeftArrow,secondary:[at.KO.BrowserBack]},mac:{primary:at.JO.WinCtrl|at.KO.Minus,secondary:[at.KO.BrowserBack]},linux:{primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.Minus,secondary:[at.KO.BrowserBack]}},menu:[{id:at.xb.MenubarGoMenu,group:"1_history_nav",order:1},{id:at.xb.CommandCenter,order:1,when:at.Mk.has("config.workbench.navigationControl.enabled")}]})}async run(e){await e.get(gt.Pn).goBack(gt.a.NONE)}},{_:I.ID="workbench.action.navigateBack"},{_:I.LABEL=(0,at.EM)(3214,"Go Back")},I),nr=class extends at.bb{constructor(){super({id:"workbench.action.navigateLast",title:(0,at.DM)(3216,"Go Previous"),f1:!0})}async run(e){await e.get(gt.Pn).goPrevious(gt.a.NONE)}},ar=class extends at.bb{constructor(){super({id:"workbench.action.navigateForwardInEditLocations",title:(0,at.DM)(3217,"Go Forward in Edit Locations"),f1:!0})}async run(e){await e.get(gt.Pn).goForward(gt.a.EDITS)}},dr=class extends at.bb{constructor(){super({id:"workbench.action.navigateBackInEditLocations",title:(0,at.DM)(3218,"Go Back in Edit Locations"),f1:!0})}async run(e){await e.get(gt.Pn).goBack(gt.a.EDITS)}},lr=class extends at.bb{constructor(){super({id:"workbench.action.navigatePreviousInEditLocations",title:(0,at.DM)(3219,"Go Previous in Edit Locations"),f1:!0})}async run(e){await e.get(gt.Pn).goPrevious(gt.a.EDITS)}},cr=class extends at.bb{constructor(){super({id:"workbench.action.navigateToLastEditLocation",title:(0,at.DM)(3220,"Go to Last Edit Location"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.KeyQ)}})}async run(e){await e.get(gt.Pn).goLast(gt.a.EDITS)}},hr=class extends at.bb{constructor(){super({id:"workbench.action.navigateForwardInNavigationLocations",title:(0,at.DM)(3221,"Go Forward in Navigation Locations"),f1:!0})}async run(e){await e.get(gt.Pn).goForward(gt.a.NAVIGATION)}},ur=class extends at.bb{constructor(){super({id:"workbench.action.navigateBackInNavigationLocations",title:(0,at.DM)(3222,"Go Back in Navigation Locations"),f1:!0})}async run(e){await e.get(gt.Pn).goBack(gt.a.NAVIGATION)}},gr=class extends at.bb{constructor(){super({id:"workbench.action.navigatePreviousInNavigationLocations",title:(0,at.DM)(3223,"Go Previous in Navigation Locations"),f1:!0})}async run(e){await e.get(gt.Pn).goPrevious(gt.a.NAVIGATION)}},pr=class extends at.bb{constructor(){super({id:"workbench.action.navigateToLastNavigationLocation",title:(0,at.DM)(3224,"Go to Last Navigation Location"),f1:!0})}async run(e){await e.get(gt.Pn).goLast(gt.a.NAVIGATION)}},br=(x=class e extends at.bb{constructor(){super({id:e.ID,title:(0,at.DM)(3225,"Reopen Closed Editor"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.KeyT},category:vt.s.View})}async run(e){await e.get(gt.Pn).reopenLastClosedEditor()}},{_:x.ID="workbench.action.reopenClosedEditor"},x),mr=(A=class e extends at.bb{constructor(){super({id:e.ID,title:(0,at.DM)(3226,"Clear Recently Opened..."),f1:!0,category:vt.s.File})}async run(e){let t=e.get(at.zl),i=e.get(ut.Nb),o=e.get(gt.Pn),{confirmed:s}=await t.confirm({type:"warning",message:(0,at.EM)(3227,"Do you want to clear all recently opened files and workspaces?"),detail:(0,at.EM)(3228,"This action is irreversible!"),primaryButton:(0,at.EM)(3229,"&&Clear")});s&&(i.clearRecentlyOpened(),o.clearRecentlyOpened())}},{_:A.ID="workbench.action.clearRecentFiles"},A),vr=(V=class e extends at.bb{constructor(){super({id:e.ID,title:(0,at.DM)(3230,"Show Editors in Active Group By Most Recently Used"),f1:!0,category:vt.s.View})}async run(e){e.get(at.uc).quickAccess.show(mo.PREFIX)}},{_:V.ID="workbench.action.showEditorsInActiveGroup"},V),Cr=(D=class e extends at.bb{constructor(){super({id:e.ID,title:(0,at.DM)(3231,"Show All Editors By Appearance"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.KeyP),mac:{primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.Tab}},category:vt.s.File})}async run(e){e.get(at.uc).quickAccess.show(vo.PREFIX)}},{_:D.ID="workbench.action.showAllEditors"},D),wr=(M=class e extends at.bb{constructor(){super({id:e.ID,title:(0,at.DM)(3232,"Show All Editors By Most Recently Used"),f1:!0,category:vt.s.View})}async run(e){e.get(at.uc).quickAccess.show(Co.PREFIX)}},{_:M.ID="workbench.action.showAllEditorsByMostRecentlyUsed"},M),yr=class extends at.bb{constructor(e,t,i){super(e),this.prefix=t,this.itemActivation=i}async run(e){let t=e.get(at.Ed),i=e.get(at.uc),o=t.lookupKeybindings(this.desc.id);i.quickAccess.show(this.prefix,{quickNavigateConfiguration:{keybindings:o},itemActivation:this.itemActivation})}},fr=(T=class e extends at.bb{constructor(){super({id:e.ID,title:(0,at.DM)(3237,"Quick Open Previous Editor from History"),f1:!0})}async run(t){let i,o=t.get(at.Ed),s=t.get(at.uc),r=t.get(bt.W),n=o.lookupKeybindings(e.ID);0===r.activeGroup.count&&(i=at.lr.FIRST),s.quickAccess.show("",{quickNavigateConfiguration:{keybindings:n},itemActivation:i})}},{_:T.ID="workbench.action.openPreviousEditorFromHistory"},T),Sr=class extends at.bb{constructor(){super({id:"workbench.action.openNextRecentlyUsedEditor",title:(0,at.DM)(3238,"Open Next Recently Used Editor"),f1:!0,category:vt.s.View})}async run(e){e.get(gt.Pn).openNextRecentlyUsedEditor()}},Er=class extends at.bb{constructor(){super({id:"workbench.action.openPreviousRecentlyUsedEditor",title:(0,at.DM)(3239,"Open Previous Recently Used Editor"),f1:!0,category:vt.s.View})}async run(e){e.get(gt.Pn).openPreviouslyUsedEditor()}},kr=class extends at.bb{constructor(){super({id:"workbench.action.openNextRecentlyUsedEditorInGroup",title:(0,at.DM)(3240,"Open Next Recently Used Editor In Group"),f1:!0,category:vt.s.View})}async run(e){let t=e.get(gt.Pn),i=e.get(bt.W);t.openNextRecentlyUsedEditor(i.activeGroup.id)}},_r=class extends at.bb{constructor(){super({id:"workbench.action.openPreviousRecentlyUsedEditorInGroup",title:(0,at.DM)(3241,"Open Previous Recently Used Editor In Group"),f1:!0,category:vt.s.View})}async run(e){let t=e.get(gt.Pn),i=e.get(bt.W);t.openPreviouslyUsedEditor(i.activeGroup.id)}},Ir=class extends at.bb{constructor(){super({id:"workbench.action.clearEditorHistoryWithoutConfirm",title:(0,at.DM)(3242,"Clear Editor History without Confirmation"),f1:!0,precondition:pt.bn})}async run(e){e.get(gt.Pn).clear()}},xr=class extends at.bb{constructor(){super({id:"workbench.action.clearEditorHistory",title:(0,at.DM)(3243,"Clear Editor History"),f1:!0})}async run(e){let t=e.get(at.zl),i=e.get(gt.Pn),{confirmed:o}=await t.confirm({type:"warning",message:(0,at.EM)(3244,"Do you want to clear the history of recently opened editors?"),detail:(0,at.EM)(3228,"This action is irreversible!"),primaryButton:(0,at.EM)(3229,"&&Clear")});o&&i.clear()}},Ar=({_:(R=class extends Vs{constructor(){super({id:"workbench.action.splitEditorToLeftGroup",title:(0,at.DM)(3259,"Split Editor into Left Group"),f1:!0,category:vt.s.View},Po,{to:"left",by:"group"})}}).ID="workbench.action.splitEditorToLeftGroup"},{_:R.LABEL=(0,at.EM)(3259,"Split Editor into Left Group")},R),Vr=(O=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3263,"Single Column Editor Layout"),f1:!0,category:vt.s.View},Fo,{groups:[{}],orientation:bt.J.HORIZONTAL})}},{_:O.ID="workbench.action.editorLayoutSingle"},O),Dr=(W=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3264,"Two Columns Editor Layout"),f1:!0,category:vt.s.View},Fo,{groups:[{},{}],orientation:bt.J.HORIZONTAL})}},{_:W.ID="workbench.action.editorLayoutTwoColumns"},W),Mr=(L=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3265,"Three Columns Editor Layout"),f1:!0,category:vt.s.View},Fo,{groups:[{},{},{}],orientation:bt.J.HORIZONTAL})}},{_:L.ID="workbench.action.editorLayoutThreeColumns"},L),Tr=(J=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3266,"Two Rows Editor Layout"),f1:!0,category:vt.s.View},Fo,{groups:[{},{}],orientation:bt.J.VERTICAL})}},{_:J.ID="workbench.action.editorLayoutTwoRows"},J),Rr=(G=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3267,"Three Rows Editor Layout"),f1:!0,category:vt.s.View},Fo,{groups:[{},{},{}],orientation:bt.J.VERTICAL})}},{_:G.ID="workbench.action.editorLayoutThreeRows"},G),Or=(N=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3268,"Grid Editor Layout (2x2)"),f1:!0,category:vt.s.View},Fo,{groups:[{groups:[{},{}]},{groups:[{},{}]}],orientation:bt.J.HORIZONTAL})}},{_:N.ID="workbench.action.editorLayoutTwoByTwoGrid"},N),Wr=(K=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3269,"Two Columns Bottom Editor Layout"),f1:!0,category:vt.s.View},Fo,{groups:[{},{groups:[{},{}]}],orientation:bt.J.VERTICAL})}},{_:K.ID="workbench.action.editorLayoutTwoColumnsBottom"},K),Lr=(Z=class e extends Vs{constructor(){super({id:e.ID,title:(0,at.DM)(3270,"Two Rows Right Editor Layout"),f1:!0,category:vt.s.View},Fo,{groups:[{},{groups:[{},{}]}],orientation:bt.J.HORIZONTAL})}},{_:Z.ID="workbench.action.editorLayoutTwoRowsRight"},Z),Jr=class extends at.bb{constructor(e,t){super(e),this.direction=t}async run(e){let t=e.get(bt.W),i=e.get(pt.ot),o=(0,at.Rx)(),s=i.hasFocus(pt.V.EDITOR_PART)||o.activeElement===o.body,r=t.addGroup(t.activeGroup,this.direction);t.activateGroup(r),s&&r.focus()}},Gr=class extends at.bb{constructor(){super({id:"workbench.action.toggleEditorType",title:(0,at.DM)(3275,"Toggle Editor Type"),f1:!0,category:vt.s.View,precondition:pt.Xt})}async run(e){let t=e.get(bt.kt),i=e.get(dt.B),o=t.activeEditorPane;if(!o)return;let s=bt.Ht.getCanonicalUri(o.input);if(!s)return;let r=i.getEditors(s).map(e=>e.id).filter(e=>e!==o.input.editorId);0!==r.length&&await t.replaceEditors([{editor:o.input,replacement:{resource:s,options:{override:r[0]}}}],o.group)}},Nr=class extends at.bb{constructor(){super({id:"workbench.action.reopenTextEditor",title:(0,at.DM)(3276,"Reopen Editor with Text Editor"),f1:!0,category:vt.s.View,precondition:pt.Xt})}async run(e){let t=e.get(bt.kt),i=t.activeEditorPane;if(!i)return;let o=bt.Ht.getCanonicalUri(i.input);o&&await t.replaceEditors([{editor:i.input,replacement:{resource:o,options:{override:bt.Ft.id}}}],i.group)}},Kr=class extends at.bb{constructor(e,t,i,o){super({id:e,title:t,category:vt.s.View,precondition:pt.en,keybinding:i,f1:!0}),this.move=o}async run(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(bt.W),r=(0,Et.t)(i,e.get(bt.kt),s,e.get(at.wt));if(!r.groupedEditors.length)return;let n=await s.createAuxiliaryEditorPart(),{group:a,editors:d}=r.groupedEditors[0],l=(0,dt.nt)(a,d,r.preserveFocus);this.move?a.moveEditors(l,n.activeGroup):a.copyEditors(l,n.activeGroup),n.activeGroup.focus()}},Zr=class extends at.bb{constructor(e,t,i){super({id:e,title:t,category:vt.s.View,f1:!0}),this.move=i}async run(e){let t=e.get(bt.W),i=t.activeGroup,o=await t.createAuxiliaryEditorPart();t.mergeGroup(i,o.activeGroup,{mode:this.move?bt.Z.MOVE_EDITORS:bt.Z.COPY_EDITORS}),o.activeGroup.focus()}},Br=class extends at.bb{constructor(){super({id:"workbench.action.restoreEditorsToMainWindow",title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3285,"Restore Editors into Main Window")),{},{mnemonicTitle:(0,at.EM)(3286,"&&Restore Editors into Main Window")}),f1:!0,precondition:pt.Cn,category:vt.s.View})}async run(e){let t=e.get(bt.W);t.mergeAllGroups(t.mainPart.activeGroup)}},Pr=class extends at.bb{constructor(){super({id:ys,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3287,"New Empty Editor Window")),{},{mnemonicTitle:(0,at.EM)(3288,"&&New Empty Editor Window")}),f1:!0,category:vt.s.View})}async run(e){(await e.get(bt.W).createAuxiliaryEditorPart()).activeGroup.focus()}};(0,bt.en)(),(0,at.sj)(),(0,at.wj)();var Fr,Yr=class extends at.mj{constructor(e){super(),this.model=e,this._onDidModelChange=this._register(new at.ej),this.onDidModelChange=this._onDidModelChange.event,this._register(this.model.onDidModelChange(e=>{var t;let i=null!==(t=e.editorIndex)&&void 0!==t?t:e.editor;void 0!==i&&!this.filter(i)||this._onDidModelChange.fire(e)}))}get id(){return this.model.id}get isLocked(){return this.model.isLocked}get stickyCount(){return this.model.stickyCount}get activeEditor(){return this.model.activeEditor&&this.filter(this.model.activeEditor)?this.model.activeEditor:null}get previewEditor(){return this.model.previewEditor&&this.filter(this.model.previewEditor)?this.model.previewEditor:null}get selectedEditors(){return this.model.selectedEditors.filter(e=>this.filter(e))}isPinned(e){return this.model.isPinned(e)}isTransient(e){return this.model.isTransient(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}isSelected(e){return this.model.isSelected(e)}isFirst(e){return this.model.isFirst(e,this.getEditors(bt.Ut.SEQUENTIAL))}isLast(e){return this.model.isLast(e,this.getEditors(bt.Ut.SEQUENTIAL))}getEditors(e,t){return this.model.getEditors(e,t).filter(e=>this.filter(e))}findEditor(e,t){let i=this.model.findEditor(e,t);if(i)return this.filter(i[1])?i:void 0}},Qr=class extends Yr{get count(){return this.model.stickyCount}getEditors(e,t){return null!==t&&void 0!==t&&t.excludeSticky?[]:e===bt.Ut.SEQUENTIAL?this.model.getEditors(bt.Ut.SEQUENTIAL).slice(0,this.model.stickyCount):super.getEditors(e,t)}isSticky(e){return!0}getEditorByIndex(e){return e<this.count?this.model.getEditorByIndex(e):void 0}indexOf(e,t,i){let o=this.model.indexOf(e,t,i);return o<0||o>=this.model.stickyCount?-1:o}contains(e,t){let i=this.model.indexOf(e,void 0,t);return i>=0&&i<this.model.stickyCount}filter(e){return this.model.isSticky(e)}},Xr=class extends Yr{get count(){return this.model.count-this.model.stickyCount}get stickyCount(){return 0}isSticky(e){return!1}getEditors(e,t){return e===bt.Ut.SEQUENTIAL?this.model.getEditors(bt.Ut.SEQUENTIAL).slice(this.model.stickyCount):super.getEditors(e,t)}getEditorByIndex(e){return e>=0?this.model.getEditorByIndex(e+this.model.stickyCount):void 0}indexOf(e,t,i){let o=this.model.indexOf(e,t,i);return o<this.model.stickyCount||o>=this.model.count?-1:o-this.model.stickyCount}contains(e,t){let i=this.model.indexOf(e,void 0,t);return i>=this.model.stickyCount&&i<this.model.count}filter(e){return!this.model.isSticky(e)}};(0,at.vE)(),(0,at.Xb)(),(0,at.iM)(),(0,bt.ot)(),(0,bt.en)(),(0,gt.f)(),(0,at.KT)(),(0,at.lm)(),(0,at.QO)(),(0,ut.tt)(),(0,at.Ur)(),(0,at.Ol)(),(0,at.ox)(),(0,at.Dd)(),(0,at.Pb)(),(0,at.Tb)(),(0,at.dc)(),(0,at.wj)(),(0,at.zp)(),(0,at.XA)(),(0,at.Hj)(),(0,at.sp)(),(0,at.Xd)(),(0,dt.er)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,ut.B)(),(0,at.Fd)(),(0,bt.Q)(),(0,at.oS)(),(0,at.TM)(),(0,dt.tt)(),(0,at.GM)(),(0,bt.At)(),(0,at.dT)(),(0,at.Ww)(),(0,bt.j)(),(0,at.DO)(),(0,at.AN)(),(0,at.mm)(),(0,at.oE)(),(0,at.LM)(),(0,at.jr)(),(0,at.HT)(),(0,ut.yS)(),(0,ut.rm)(),(0,dt.V)(),(0,dt.z)(),(0,at.aP)(),(0,at.ta)(),(0,at.bE)({});var Hr=(B=class extends As{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super(e,t,i,o,s,r,n,a,d,l,c,h,b,m),this.editorService=u,this.pathService=g,this.treeViewsDragAndDropService=p,this.closeEditorAction=this._register(this.instantiationService.createInstance(Zs,Zs.ID,Zs.LABEL)),this.unpinEditorAction=this._register(this.instantiationService.createInstance(Ks,Ks.ID,Ks.LABEL)),this.tabResourceLabels=this._register(this.instantiationService.createInstance(ut.et,ut.Q)),this.tabLabels=[],this.tabActionBars=[],this.tabDisposables=[],this.dimensions={container:at.mx.None,available:at.mx.None},this.layoutScheduler=this._register(new at.vj),this.path=at.yM?at.FO:at.MO,this.lastMouseWheelEventTime=0,this.isMouseOverTabs=!1,this.updateEditorLabelScheduler=this._register(new at.Aw(()=>this.doUpdateEditorLabels(),0)),(async()=>{this.path=await this.pathService.path})(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}create(e){return super.create(e),this.titleContainer=e,this.tabsAndActionsContainer=(0,at.px)(".tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=(0,at.px)(".tabs-container",{role:"tablist",draggable:!0}),this._register(at.cm.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new at.gj),this.updateTabSizing(!1),this.tabsScrollbar=this.createTabsScrollbar(this.tabsContainer),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.createEditorActionsToolBar(this.tabsAndActionsContainer,["editor-actions"]),this.updateTabsControlVisibility(),this.tabsAndActionsContainer}createTabsScrollbar(e){let t=this._register(new at.Lp(e,{horizontal:this.getTabsScrollbarVisibility(),horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:at.YA.Hidden,scrollYToX:!0,useShadows:!1}));return this._register(t.onScroll(t=>{t.scrollLeftChanged&&(e.scrollLeft=t.scrollLeft)})),t}updateTabsScrollbarSizing(){var e;null===(e=this.tabsScrollbar)||void 0===e||e.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabsScrollbarVisibility(){var e;null===(e=this.tabsScrollbar)||void 0===e||e.updateOptions({horizontal:this.getTabsScrollbarVisibility()})}updateTabSizing(e){let[t,i]=(0,at.HM)(this.tabsContainer,this.tabSizingFixedDisposables);i.clear();let o=this.groupsView.partOptions;"fixed"===o.tabSizing?(t.style.setProperty("--tab-sizing-fixed-min-width","".concat(o.tabSizingFixedMinWidth,"px")),t.style.setProperty("--tab-sizing-fixed-max-width","".concat(o.tabSizingFixedMaxWidth,"px")),i.add((0,at.Sx)(t,at._x.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),i.add((0,at.Sx)(t,at._x.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(t.style.removeProperty("--tab-sizing-fixed-min-width"),t.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((t,i,o)=>{if(e){let{width:e}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width","".concat(e,"px"))}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return"large"===this.groupsView.partOptions.titleScrollbarSizing?Fr.SCROLLBAR_SIZES.large:Fr.SCROLLBAR_SIZES.default}getTabsScrollbarVisibility(){switch(this.groupsView.partOptions.titleScrollbarVisibility){case"visible":return at.YA.Visible;case"hidden":return at.YA.Hidden;default:return at.YA.Auto}}registerTabsContainerListeners(e,t){this._register((0,at.Sx)(e,at._x.SCROLL,()=>{e.classList.contains("scroll")&&t.setScrollPosition({scrollLeft:e.scrollLeft})}));for(let r of[at.sm.Tap,at._x.DBLCLICK])this._register((0,at.Sx)(e,r,t=>{if(r===at._x.DBLCLICK){if(t.target!==e)return}else if(2!==t.tapCount||t.initialTarget!==e)return;at.gx.stop(t),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.groupView.count,override:bt.Ft.id}},this.groupView.id)}));this._register((0,at.Sx)(e,at._x.MOUSE_DOWN,e=>{1===e.button&&e.preventDefault()})),at.dM&&this._register((0,at.Sx)(e,at._x.MOUSE_UP,e=>{1===e.button&&e.preventDefault()}));let i,o=!1;this._register(new at.hx(e,{onDragStart:t=>{o=this.onGroupDragStart(t,e)},onDrag:e=>{i=e},onDragEnter:t=>{if(e.classList.add("scroll"),t.target===e){if(!this.isSupportedDropTransfer(t))return void(t.dataTransfer&&(t.dataTransfer.dropEffect="none"));this.editorTransfer.hasData(ut.I.prototype)||t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,t)}},onDragLeave:t=>{this.updateDropFeedback(e,!1,t),e.classList.remove("scroll")},onDragEnd:t=>{this.updateDropFeedback(e,!1,t),e.classList.remove("scroll"),this.onGroupDragEnd(t,i,e,o)},onDrop:t=>{if(this.updateDropFeedback(e,!1,t),e.classList.remove("scroll"),t.target===e){let i=this.groupTransfer.hasData(ut.F.prototype);this.onDrop(t,i?this.groupView.count:this.tabsModel.count,e)}}})),this._register((0,at.Sx)(e,at._x.MOUSE_WHEEL,e=>{let t=this.groupView.activeEditor;if(!t||this.groupView.count<2)return;if(!0===this.groupsView.partOptions.scrollToSwitchTabs){if(e.shiftKey)return}else if(!e.shiftKey)return;let i,o=Date.now();if(o-this.lastMouseWheelEventTime<Fr.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(e.deltaX)+Math.abs(e.deltaY)))return;if(this.lastMouseWheelEventTime=o,e.deltaX+e.deltaY<-Fr.MOUSE_WHEEL_DISTANCE_THRESHOLD)i=-1;else{if(!(e.deltaX+e.deltaY>Fr.MOUSE_WHEEL_DISTANCE_THRESHOLD))return;i=1}let s=this.groupView.getEditorByIndex(this.groupView.getIndexOfEditor(t)+i);s&&(this.groupView.openEditor(s),at.gx.stop(e,!0))}));let s=t=>{at.gx.stop(t);let i=e;(0,at.SS)(t)&&(i=new at.BT((0,at.$x)(this.parent),t)),this.contextMenuService.showContextMenu({getAnchor:()=>i,menuId:at.xb.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.groupView.id}),getKeyBinding:e=>this.getKeybinding(e),onHide:()=>this.groupView.focus()})};this._register((0,at.Sx)(e,at.sm.Contextmenu,e=>s(e))),this._register((0,at.Sx)(e,at._x.CONTEXT_MENU,e=>s(e)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e,t){let i=this.handleOpenedEditors();return null!==t&&void 0!==t&&t.focusTabControl&&this.withTab(e,(e,t,i)=>i.focus()),i}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){this.updateTabsControlVisibility();let[e,t]=(0,at.HM)(this.tabsContainer,this.tabsScrollbar);for(let r=e.children.length;r<this.tabsModel.count;r++)e.appendChild(this.createTab(r,e,t));let i=this.didActiveEditorChange(),o=this.tabLabels;this.computeTabLabels();let s=!1;return i||o.length!==this.tabLabels.length||o.some((e,t)=>!this.equalsEditorInputLabel(e,this.tabLabels.at(t)))?(this.redraw({forceRevealActiveTab:!0}),s=!0):this.layout(this.dimensions,{forceRevealActiveTab:!0}),s}didActiveEditorChange(){var e,t,i;return!((null!==(e=this.activeTabLabel)&&void 0!==e&&e.editor||!this.tabsModel.activeEditor)&&(null===(t=this.activeTabLabel)||void 0===t||!t.editor||this.tabsModel.activeEditor)&&null!==(i=this.activeTabLabel)&&void 0!==i&&i.editor&&this.tabsModel.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,t){return e===t||!(!e||!t)&&(e.name===t.name&&e.description===t.description&&e.forceDescription===t.forceDescription&&e.title===t.title&&e.ariaLabel===t.ariaLabel)}beforeCloseEditor(e){if(this.isMouseOverTabs&&"fixed"===this.groupsView.partOptions.tabSizing){let t=this.tabsModel.isLast(e);this.updateTabsFixedWidth(!t)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){if(this.tabsModel.count){let t=(0,at.UM)(this.tabsContainer);for(;t.children.length>this.tabsModel.count;){var e;null!==(e=t.lastChild)&&void 0!==e&&e.remove(),(0,at.Sj)(this.tabDisposables.pop())}this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&(0,at.Ox)(this.tabsContainer),this.tabDisposables=(0,at.Sj)(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),this.updateTabsControlVisibility()}moveEditor(e,t,i){let o=this.tabLabels[t];this.tabLabels.splice(t,1),this.tabLabels.splice(i,0,o),this.forEachTab((e,t,i,o,s,r)=>{this.redrawTab(e,t,i,o,s,r)},Math.min(t,i),Math.max(t,i)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(e,t,i,o,s)=>this.redrawTabLabel(e,t,i,o,s))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(e,t,i,o,s,r)=>this.redrawTab(e,t,i,o,s,r)),this.forEachTab((e,t,i,o,s)=>{this.redrawTabBorders(t,i)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((t,i,o,s,r,n)=>{this.redrawTabSelectedActiveAndDirty(e,t,o,n)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorSelections(){this.forEachTab((e,t,i,o,s,r)=>{this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r)})}updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,t,i,o,s)=>{this.redrawTabLabel(e,t,i,o,s)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(e,t,i,o,s,r)=>this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r))}updateOptions(e,t){super.updateOptions(e,t),e.labelFormat!==t.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==t.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),e.titleScrollbarVisibility!==t.titleScrollbarVisibility&&this.updateTabsScrollbarVisibility(),e.alwaysShowEditorActions!==t.alwaysShowEditorActions&&this.updateEditorActionsToolbar(),(e.tabSizingFixedMinWidth!==t.tabSizingFixedMinWidth||e.tabSizingFixedMaxWidth!==t.tabSizingFixedMaxWidth||e.tabSizing!==t.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==t.labelFormat||e.tabActionLocation!==t.tabActionLocation||e.tabActionCloseVisibility!==t.tabActionCloseVisibility||e.tabActionUnpinVisibility!==t.tabActionUnpinVisibility||e.tabSizing!==t.tabSizing||e.pinnedTabSizing!==t.pinnedTabSizing||e.showIcons!==t.showIcons||e.hasIcons!==t.hasIcons||e.highlightModifiedTabs!==t.highlightModifiedTabs||e.wrapTabs!==t.wrapTabs||e.showTabIndex!==t.showTabIndex||!(0,at.FM)(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,t,i){this.tabsModel.getEditors(bt.Ut.SEQUENTIAL).forEach((o,s)=>{"number"==typeof t&&t>s||"number"==typeof i&&i<s||this.doWithTab(s,o,e)})}withTab(e,t){this.doWithTab(this.tabsModel.indexOf(e),e,t)}doWithTab(e,t,i){let o=(0,at.UM)(this.tabsContainer).children[e],s=this.tabResourceLabels.get(e),r=this.tabLabels[e],n=this.tabActionBars[e];o&&s&&r&&i(t,e,o,s,r,n)}createTab(e,t,i){let o=(0,at.px)(".tab",{draggable:!0,role:"tab"});this._register(at.cm.addTarget(o));let s=(0,at.px)(".tab-border-top-container");o.appendChild(s);let r=this.tabResourceLabels.create(o,{hoverTargetOverride:o}),n=(0,at.px)(".tab-actions");o.appendChild(n);let a=this,d=new xs({groupId:this.groupView.id,get editorIndex(){return a.toEditorIndex(e)}}),l=new at.Vr(n,{ariaLabel:(0,at.EM)(3416,"Tab actions"),actionRunner:d}),c=(0,at.xj)(d,l,l.onWillRun(e=>{e.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()}),(0,at.kj)((0,at.jN)(this.tabActionBars,l))),h=(0,at.px)(".tab-fade-hider");o.appendChild(h);let u=(0,at.px)(".tab-border-bottom-container");o.appendChild(u);let g=this.registerTabListeners(o,e,t,i);return this.tabDisposables.push((0,at.xj)(g,c,d,r)),o}toEditorIndex(e){let t=(0,at.UM)(this.tabsModel.getEditorByIndex(e));return this.groupView.getIndexOfEditor(t)}registerTabListeners(e,t,i,o){let s=new at.gj,r=async(i,o)=>{if(e.blur(),(0,at.SS)(i)&&(0!==i.button||at.pM&&i.ctrlKey))return void(1===i.button&&i.preventDefault());if(this.originatesFromTabActionBar(i))return;let s=this.tabsModel.getEditorByIndex(t);if(s)if(i.shiftKey){let e;if(this.lastSingleSelectSelectedEditor&&this.tabsModel.isSelected(this.lastSingleSelectSelectedEditor))e=this.lastSingleSelectSelectedEditor;else{let t=(0,at.UM)(this.groupView.activeEditor);this.lastSingleSelectSelectedEditor=t,e=t}await this.selectEditorsBetween(s,e)}else if(i.ctrlKey&&!at.pM||i.metaKey&&at.pM)this.tabsModel.isSelected(s)?await this.unselectEditor(s):(await this.selectEditor(s),this.lastSingleSelectSelectedEditor=s);else{let e=this.tabsModel.isSelected(s)?this.groupView.selectedEditors.filter(e=>!e.matches(s)):[];await this.groupView.openEditor(s,{preserveFocus:o,activation:at.Er.ACTIVATE},{inactiveSelection:e,focusTabControl:!0})}},n=i=>{at.gx.stop(i);let o=this.tabsModel.getEditorByIndex(t);o&&this.onTabContextMenu(o,i,e)};s.add((0,at.Sx)(e,at._x.MOUSE_DOWN,e=>r(e,!1))),s.add((0,at.Sx)(e,at.sm.Tap,e=>r(e,!0))),s.add((0,at.Sx)(e,at.sm.Change,e=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-e.translationX})})),s.add((0,at.Sx)(e,at._x.MOUSE_UP,async t=>{at.gx.stop(t),e.blur(),(!(0,at.SS)(t)||!(0!==t.button||at.pM&&t.ctrlKey))&&(this.originatesFromTabActionBar(t)||!(t.ctrlKey&&!at.pM||t.metaKey&&at.pM)&&!t.shiftKey&&this.groupView.selectedEditors.length>1&&await this.unselectAllEditors())})),s.add((0,at.Sx)(e,at._x.AUXCLICK,e=>{if(1===e.button){at.gx.stop(e,!0);let i=this.tabsModel.getEditorByIndex(t);if(i){if((0,bt.vn)(this.tabsModel,i,bt.Lt.MOUSE,this.groupsView.partOptions))return;this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(i)})}}})),s.add((0,at.Sx)(e,at._x.KEY_DOWN,e=>{let t=new at.GT(e);t.shiftKey&&t.keyCode===at.KO.F10&&n(e)})),s.add((0,at.Sx)(e,at.sm.Contextmenu,e=>{n(e)})),s.add((0,at.Sx)(e,at._x.KEY_UP,e=>{let s=new at.GT(e),r=!1;if(s.equals(at.KO.Enter)||s.equals(at.KO.Space)){r=!0;let e=this.tabsModel.getEditorByIndex(t);e&&this.groupView.openEditor(e)}else if([at.KO.LeftArrow,at.KO.RightArrow,at.KO.UpArrow,at.KO.DownArrow,at.KO.Home,at.KO.End].some(e=>s.equals(e))){let e=this.toEditorIndex(t);s.equals(at.KO.LeftArrow)||s.equals(at.KO.UpArrow)?--e:s.equals(at.KO.RightArrow)||s.equals(at.KO.DownArrow)?e+=1:e=s.equals(at.KO.Home)?0:this.groupView.count-1;let i=this.groupView.getEditorByIndex(e);i&&(r=!0,this.groupView.openEditor(i,{preserveFocus:!0},{focusTabControl:!0}))}r&&at.gx.stop(e,!0),o.setScrollPosition({scrollLeft:i.scrollLeft})}));for(let l of[at.sm.Tap,at._x.DBLCLICK])s.add((0,at.Sx)(e,l,e=>{if(l===at._x.DBLCLICK)at.gx.stop(e);else if(2!==e.tapCount)return;let i=this.tabsModel.getEditorByIndex(t);if(i&&this.tabsModel.isPinned(i))switch(this.groupsView.partOptions.doubleClickTabToToggleEditorGroupSizes){case"maximize":this.groupsView.toggleMaximizeGroup(this.groupView);break;case"expand":this.groupsView.toggleExpandGroup(this.groupView)}else this.groupView.pinEditor(i)}));s.add((0,at.Sx)(e,at._x.CONTEXT_MENU,i=>{at.gx.stop(i,!0);let o=this.tabsModel.getEditorByIndex(t);o&&this.onTabContextMenu(o,i,e)},!0));let a,d=!1;return s.add(new at.hx(e,{onDragStart:i=>{let o=this.tabsModel.getEditorByIndex(t);if(!o)return;d=this.isNewWindowOperation(i);let s=this.groupView.selectedEditors;this.editorTransfer.setData(s.map(e=>new ut.I({editor:e,groupId:this.groupView.id})),ut.I.prototype),i.dataTransfer&&(i.dataTransfer.effectAllowed="copyMove",s.length>1?(0,at.ea)(i,e,"".concat(o.getName()," + ").concat(s.length-1)):i.dataTransfer.setDragImage(e,0,0)),this.doFillResourceDataTransfers(s,i,d),(0,at.IS)((0,at.$x)(this.parent),()=>this.updateDropFeedback(e,!1,i,t))},onDrag:e=>{a=e},onDragEnter:i=>{this.isSupportedDropTransfer(i)?(this.editorTransfer.hasData(ut.I.prototype)||i.dataTransfer&&(i.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,i,t)):i.dataTransfer&&(i.dataTransfer.dropEffect="none")},onDragOver:(i,o)=>{if(o>=Fr.DRAG_OVER_OPEN_TAB_THRESHOLD){let e=this.tabsModel.getEditorByIndex(t);e&&this.tabsModel.activeEditor!==e&&this.groupView.openEditor(e,{preserveFocus:!0})}this.updateDropFeedback(e,!0,i,t)},onDragEnd:async i=>{this.updateDropFeedback(e,!1,i,t);let o=this.editorTransfer.getData(ut.I.prototype);if(this.editorTransfer.clearData(ut.I.prototype),!d||(0,ut.V)()||!o||0===o.length)return;let s=await this.maybeCreateAuxiliaryEditorPartAt(i,e);if(!s)return;let r=s.activeGroup,n=(0,dt.nt)(this.groupView,o.map(e=>e.identifier.editor));this.isMoveOperation(null!==a&&void 0!==a?a:i,r.id,o[0].identifier.editor)?this.groupView.moveEditors(n,r):this.groupView.copyEditors(n,r),r.focus()},onDrop:o=>{this.updateDropFeedback(e,!1,o,t);let s=t;"right"===this.getTabDragOverLocation(o,e)&&s++,this.onDrop(o,s,i)}})),s}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(ut.F.prototype)){let e=this.groupTransfer.getData(ut.F.prototype);return!(Array.isArray(e)&&e.length>0&&e[0].identifier===this.groupView.id)}return!!(this.editorTransfer.hasData(ut.I.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,t,i,o){let s;s=t?"number"==typeof o?this.computeDropTarget(i,o,e):{leftElement:e.lastElementChild,rightElement:void 0}:void 0,this.updateDropTarget(s)}updateDropTarget(e){var t,i,o,s;let r=this.dropTarget;if(r===e||r&&e&&r.leftElement===e.leftElement&&r.rightElement===e.rightElement)return;let n="drop-target-left",a="drop-target-right";r&&(null!==(t=r.leftElement)&&void 0!==t&&t.classList.remove(n),null!==(i=r.rightElement)&&void 0!==i&&i.classList.remove(a)),e&&(null!==(o=e.leftElement)&&void 0!==o&&o.classList.add(n),null!==(s=e.rightElement)&&void 0!==s&&s.classList.add(a)),this.dropTarget=e}getTabDragOverLocation(e,t){let i=t.getBoundingClientRect();return e.clientX-i.left<=i.width/2?"left":"right"}computeDropTarget(e,t,i){let o="left"===this.getTabDragOverLocation(e,i),s=t===this.tabsModel.count-1;return o&&0===t?{leftElement:void 0,rightElement:i}:!o&&s?{leftElement:i,rightElement:void 0}:{leftElement:o?i.previousElementSibling:i,rightElement:o?i:i.nextElementSibling}}async selectEditor(e){this.groupView.isActive(e)||await this.groupView.setSelection(e,this.groupView.selectedEditors)}async selectEditorsBetween(e,t){let i=this.groupView.getIndexOfEditor(e);if(-1===i)throw new at.qN;let o=this.groupView.getIndexOfEditor(t);if(-1===o)throw new at.qN;let s=this.groupView.selectedEditors,r=o;for(;r>=0&&r<=this.groupView.count-1;){r=o<i?r-1:r+1;let e=this.groupView.getEditorByIndex(r);if(!e||!this.groupView.isSelected(e))break;s=s.filter(t=>!t.matches(e))}let n=o<i?o:i,a=o<i?i:o,d=this.groupView.getEditors(bt.Ut.SEQUENTIAL).slice(n,a+1);for(let c of d)this.groupView.isSelected(c)||s.push(c);let l=s.filter(t=>!t.matches(e));await this.groupView.setSelection(e,l)}async unselectEditor(e){let t=this.groupView.isActive(e);if(t&&1===this.groupView.selectedEditors.length)return;let i=(0,at.UM)(this.groupView.activeEditor);if(t){let e=this.groupView.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE);for(let t=1;t<e.length;t++){let o=e[t];if(this.groupView.isSelected(o)){i=o;break}}}let o=this.groupView.selectedEditors.filter(t=>!t.matches(e)&&!t.matches(i));await this.groupView.setSelection(i,o)}async unselectAllEditors(){if(this.groupView.selectedEditors.length>1){let e=(0,at.UM)(this.groupView.activeEditor);await this.groupView.setSelection(e,[])}}computeTabLabels(){let{labelFormat:e}=this.groupsView.partOptions,{verbosity:t,shortenDuplicates:i}=this.getLabelConfigFlags(e),o=[],s=-1;this.tabsModel.getEditors(bt.Ut.SEQUENTIAL).forEach((e,i)=>{o.push({editor:e,name:e.getName(),description:e.getDescription(t),forceDescription:e.hasCapability(bt.zt.ForceDescription),title:e.getTitle(bt.Xt.LONG),ariaLabel:(0,gt.d)(e,i,this.groupView,this.editorPartsView.count)}),e===this.tabsModel.activeEditor&&(s=i)}),i&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[s]}shortenTabLabels(e){let t=new Map;for(let i of e)"string"==typeof i.description?(0,at.Vj)(t,i.name,[]).push(i):i.description="";for(let[,i]of t){if(1===i.length&&!i[0].forceDescription){i[0].description="";continue}let e=new Map;for(let r of i)(0,at.Vj)(e,r.description,[]).push(r);let t=!1;for(let[,i]of e)if(!t&&i.length>1){let[e,...o]=i.map(e=>{let{editor:t}=e;return t.getDescription(bt.Xt.LONG)});t=o.some(t=>t!==e)}if(t){e.clear();for(let t of i)t.description=t.editor.getDescription(bt.Xt.LONG),(0,at.Vj)(e,t.description,[]).push(t)}let o=[];for(let[i]of e)o.push(i);if(1===o.length){for(let t of e.get(o[0])||[])t.forceDescription||(t.description="");continue}let s=(0,bt.ut)(o,this.path.sep);o.forEach((t,i)=>{for(let o of e.get(t)||[])o.description=s[i]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:bt.Xt.SHORT,shortenDuplicates:!1};case"medium":return{verbosity:bt.Xt.MEDIUM,shortenDuplicates:!1};case"long":return{verbosity:bt.Xt.LONG,shortenDuplicates:!1};default:return{verbosity:bt.Xt.MEDIUM,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let e=this.getColor(dt.Et);!e&&(0,at.gm)(this.theme.type)&&(e=this.getColor(dt.On)||this.getColor(at.dg)),e?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",e.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((e,t,i,o,s,r)=>{this.redrawTab(e,t,i,o,s,r)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,t,i,o,s,r){let n=this.tabsModel.isSticky(t),a=this.groupsView.partOptions;this.redrawTabLabel(e,t,i,o,s);let d,l=n&&a.tabActionUnpinVisibility,c=!l&&a.tabActionCloseVisibility,h=l||c;d=h?l?this.unpinEditorAction:this.closeEditorAction:n?this.unpinEditorAction:this.closeEditorAction,r.hasAction(d)||(r.isEmpty()||r.clear(),r.push(d,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(d)})),i.classList.toggle("pinned-action-off",n&&!l),i.classList.toggle("close-action-off",!l&&!c);for(let g of["left","right"])i.classList.toggle("tab-actions-".concat(g),h&&a.tabActionLocation===g);let u=n&&"shrink"===a.pinnedTabSizing?"shrink":a.tabSizing;for(let g of["fit","shrink","fixed"])i.classList.toggle("sizing-".concat(g),u===g);i.classList.toggle("has-icon",a.showIcons&&a.hasIcons),i.classList.toggle("sticky",n);for(let g of["normal","compact","shrink"])i.classList.toggle("sticky-".concat(g),n&&a.pinnedTabSizing===g);if(!a.wrapTabs&&n&&"normal"!==a.pinnedTabSizing){let e=0;switch(a.pinnedTabSizing){case"compact":e=Fr.TAB_WIDTH.compact;break;case"shrink":e=Fr.TAB_WIDTH.shrink}i.style.left="".concat(t*e,"px")}else i.style.left="auto";this.redrawTabBorders(t,i),this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r)}redrawTabLabel(e,t,i,o,s){var r,n,a;let d,l,c,h=this.groupsView.partOptions,u=!1,g=!(null===(r=h.decorations)||void 0===r||!r.badges),p=!(null===(n=h.decorations)||void 0===n||!n.colors);"compact"===h.pinnedTabSizing&&this.tabsModel.isSticky(t)?(d=h.showIcons&&h.hasIcons?"":null===(a=s.name)||void 0===a?void 0:a.charAt(0).toUpperCase(),c="",u=!0,g=!1):(d=s.name,l=h.showTabIndex?"".concat(this.toEditorIndex(t)+1,": "):void 0,c=s.description||""),s.ariaLabel&&(i.setAttribute("aria-label",s.ariaLabel),i.setAttribute("aria-description","")),o.setResource({name:d,description:c,resource:bt.Ht.getOriginalUri(e,{supportSideBySide:bt.Jt.BOTH})},{title:this.getHoverTitle(e),extraClasses:(0,at._N)(["tab-label",g?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.tabsModel.isPinned(e),forceLabel:u,fileDecorations:{colors:p,badges:g},icon:e.getIcon(),hideIcon:!1===h.showIcons,namePrefix:l});let b=bt.Ht.getOriginalUri(e,{supportSideBySide:bt.Jt.PRIMARY});b?i.setAttribute("data-resource-name",(0,at.aT)(b)):i.removeAttribute("data-resource-name")}redrawTabSelectedActiveAndDirty(e,t,i,o){let s=this.tabsModel.isActive(t),r=this.doRedrawTabDirty(e,s,t,i);this.doRedrawTabActive(e,!r,t,i,o)}doRedrawTabActive(e,t,i,o,s){let r=this.tabsModel.isActive(i),n=this.tabsModel.isSelected(i);if(o.classList.toggle("active",r),o.classList.toggle("selected",n),o.setAttribute("aria-selected",r?"true":"false"),o.tabIndex=r?0:-1,s.setFocusable(r),r){let t=this.getColor(e?dt.wn:dt.Ln);o.classList.toggle("tab-border-bottom",!!t),o.style.setProperty("--tab-border-bottom-color",null!==t&&void 0!==t?t:"")}let a=null;t&&(r&&(a=this.getColor(e?dt.Tn:dt.Rn)),null===a&&n&&(a=this.getColor(dt.Fn))),o.classList.toggle("tab-border-top",!!a),o.style.setProperty("--tab-border-top-color",null!==a&&void 0!==a?a:"")}doRedrawTabDirty(e,t,i,o){let s=!1;if(i.isDirty()&&!i.isSaving())if(o.classList.add("dirty"),this.groupsView.partOptions.highlightModifiedTabs){let i;i=e&&t?this.getColor(dt.Dn):e&&!t?this.getColor(dt.Nn):!e&&t?this.getColor(dt.Bn):this.getColor(dt.Gn),i&&(s=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",i))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return s}redrawTabBorders(e,t){let i=this.tabsModel.isSticky(e)&&this.tabsModel.stickyCount===e+1,o=this.tabsModel.stickyCount!==this.tabsModel.count,s=(i&&o?this.getColor(dt.Pn):void 0)||this.getColor(dt.On)||this.getColor(at.dg);t.style.borderRight=s?"1px solid ".concat(s):"",t.style.outlineColor=this.getColor(at.ug)||""}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(e=>e.id===Uo),secondary:e.secondary}}getHeight(){return this.dimensions.used?this.dimensions.used.height:this.computeHeight()}computeHeight(){var e;let t;return t=this.visible?this.groupsView.partOptions.wrapTabs&&null!==(e=this.tabsAndActionsContainer)&&void 0!==e&&e.classList.contains("wrapping")?this.tabsAndActionsContainer.offsetHeight:this.tabHeight:0,t}layout(e,t){if(Object.assign(this.dimensions,e),this.visible){if(!this.layoutScheduler.value){let e=(0,at.IS)((0,at.$x)(this.parent),()=>{var e;this.doLayout(this.dimensions,null===(e=this.layoutScheduler.value)||void 0===e?void 0:e.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:t,dispose:()=>e.dispose()}}(null===t||void 0===t?void 0:t.forceRevealActiveTab)&&(this.layoutScheduler.value.options=(0,rt.A)((0,rt.A)({},this.layoutScheduler.value.options),{},{forceRevealActiveTab:!0}))}return this.dimensions.used||(this.dimensions.used=new at.mx(e.container.width,this.computeHeight())),this.dimensions.used}doLayout(e,t){e.container!==at.mx.None&&e.available!==at.mx.None&&this.doLayoutTabs(e,t);let i=this.dimensions.used,o=this.dimensions.used=new at.mx(e.container.width,this.computeHeight());i&&i.height!==o.height&&this.groupView.relayout()}doLayoutTabs(e,t){this.doLayoutTabsWrapping(e)||this.doLayoutTabsNonWrapping(t)}doLayoutTabsWrapping(e){let[t,i,o,s]=(0,at.HM)(this.tabsAndActionsContainer,this.tabsContainer,this.editorActionsToolbarContainer,this.tabsScrollbar),r=t.classList.contains("wrapping"),n=r;function a(e){n=e,t.classList.toggle("wrapping",n),i.style.setProperty("--last-tab-margin-right",n?"".concat(o.offsetWidth,"px"):"0");for(let t of i.children)t.classList.remove("last-in-row")}if(this.groupsView.partOptions.wrapTabs){let t=i.offsetWidth,s=i.scrollWidth,r=()=>{let t=this.getLastTab();return!t||!(t.offsetWidth+o.offsetWidth-e.available.width>1)};(n||s>t&&r())&&a(!0),n&&(i.offsetHeight>e.available.height||s===t&&i.offsetHeight===this.tabHeight||!r())&&a(!1)}else r&&a(!1);if(n&&!r){let e=i.offsetWidth;s.setScrollDimensions({width:e,scrollWidth:e})}if(n){let e,t,o=new Map;for(let s of i.children){let i=s,r=i.offsetTop;r!==e&&(e=r,t&&o.set(t,!0)),t=i,o.set(i,!1)}t&&o.set(t,!0);for(let[i,s]of o)i.classList.toggle("last-in-row",s)}return n}doLayoutTabsNonWrapping(e){var t;let[i,o]=(0,at.HM)(this.tabsContainer,this.tabsScrollbar),s=i.offsetWidth,r=i.scrollWidth,n=0;if(this.tabsModel.stickyCount>0){let e=0;switch(this.groupsView.partOptions.pinnedTabSizing){case"compact":e=Fr.TAB_WIDTH.compact;break;case"shrink":e=Fr.TAB_WIDTH.shrink}n=this.tabsModel.stickyCount*e}let a,d,[l,c]=null!==(t=this.tabsModel.activeEditor?this.getTabAndIndex(this.tabsModel.activeEditor):void 0)&&void 0!==t?t:[void 0,void 0],h="normal"!==this.groupsView.partOptions.pinnedTabSizing&&"number"==typeof c&&this.tabsModel.isSticky(c),u=s-n;this.tabsModel.stickyCount>0&&u<Fr.TAB_WIDTH.fit?(i.classList.add("disable-sticky-tabs"),u=s,n=0,h=!1):i.classList.remove("disable-sticky-tabs"),!this.blockRevealActiveTab&&l&&(a=l.offsetLeft,d=l.offsetWidth);let{width:g,scrollWidth:p}=o.getScrollDimensions();o.setScrollDimensions({width:s,scrollWidth:r});let b=g!==s||p!==r;if(this.blockRevealActiveTab||"number"!=typeof a||"number"!=typeof d||h||!b&&(null===e||void 0===e||!e.forceRevealActiveTab))return void(this.blockRevealActiveTab=!1);let m=o.getScrollPosition().scrollLeft,v=d<=u,C=a-n;v&&m+u<C+d?o.setScrollPosition({scrollLeft:m+(C+d-(m+u))}):(m>C||!v)&&o.setScrollPosition({scrollLeft:C})}updateTabsControlVisibility(){(0,at.UM)(this.tabsAndActionsContainer).classList.toggle("empty",!this.visible),!this.visible&&this.dimensions&&(this.dimensions.used=void 0)}get visible(){return this.tabsModel.count>0}getTabAndIndex(e){let t=this.tabsModel.indexOf(e),i=this.getTabAtIndex(t);if(i)return[i,t]}getTabAtIndex(e){if(e>=0)return(0,at.UM)(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.tabsModel.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let t;return t=(0,at.SS)(e)?e.target||e.srcElement:e.initialTarget,!!(0,at.Lx)(t,"action-item","tab")}async onDrop(e,t,i){at.gx.stop(e,!0),this.updateDropFeedback(i,!1,e,t),i.classList.remove("scroll");let o=this.tabsModel instanceof Xr?t+this.groupView.stickyCount:t,s={sticky:this.tabsModel instanceof Qr&&this.tabsModel.stickyCount===o,index:o};if(this.groupTransfer.hasData(ut.F.prototype)){let t=this.groupTransfer.getData(ut.F.prototype);if(Array.isArray(t)&&t.length>0){let i=this.editorPartsView.getGroup(t[0].identifier);if(i){let t={index:o};this.isMoveOperation(e,i.id)||(t.mode=bt.Z.COPY_EDITORS),this.groupsView.mergeGroup(i,this.groupView,t)}this.groupView.focus(),this.groupTransfer.clearData(ut.F.prototype)}}else if(this.editorTransfer.hasData(ut.I.prototype)){let t=this.editorTransfer.getData(ut.I.prototype);if(Array.isArray(t)&&t.length>0){let i=this.editorPartsView.getGroup(t[0].identifier.groupId);if(i)for(let r of t){let t=r.identifier.editor;if(i.id!==r.identifier.groupId)continue;let n=i.getIndexOfEditor(t);i===this.groupView&&n<o&&o--,this.isMoveOperation(e,r.identifier.groupId,t)?i.moveEditor(t,this.groupView,(0,rt.A)((0,rt.A)({},s),{},{index:o})):i.copyEditor(t,this.groupView,(0,rt.A)((0,rt.A)({},s),{},{index:o})),o++}}this.groupView.focus(),this.editorTransfer.clearData(ut.I.prototype)}else if(this.treeItemsTransfer.hasData(ut.tm.prototype)){let e=this.treeItemsTransfer.getData(ut.tm.prototype);if(Array.isArray(e)&&e.length>0){let t=[];for(let i of e){let e=await this.treeViewsDragAndDropService.removeDragOperationTransfer(i.identifier);if(e){let i=await(0,ut.R)(e);t.push(...i.map(e=>(0,rt.A)((0,rt.A)({},e),{},{options:(0,rt.A)((0,rt.A)({},e.options),{},{pinned:!0,index:o})})))}}this.editorService.openEditors(t,this.groupView,{validateTrust:!0})}this.treeItemsTransfer.clearData(ut.tm.prototype)}else this.instantiationService.createInstance(ut.L,{allowWorkspaceOpen:!1}).handleDrop(e,(0,at.$x)(this.parent),()=>this.groupView,()=>this.groupView.focus(),s)}dispose(){super.dispose(),this.tabDisposables=(0,at.Sj)(this.tabDisposables)}},{_:Fr=B},{_:B.SCROLLBAR_SIZES={default:3,large:10}},{_:B.TAB_WIDTH={compact:38,shrink:80,fit:120}},{_:B.DRAG_OVER_OPEN_TAB_THRESHOLD=1500},{_:B.MOUSE_WHEEL_EVENT_THRESHOLD=150},{_:B.MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5},B);Hr=Fr=(0,at.Jb)([(0,at.Yb)(5,at.El),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.Nb),(0,at.Yb)(8,at.Ed),(0,at.Yb)(9,at.Pd),(0,at.Yb)(10,at.uc),(0,at.Yb)(11,at.Yd),(0,at.Yb)(12,bt.kt),(0,at.Yb)(13,bt.A),(0,at.Yb)(14,ut.vS),(0,at.Yb)(15,dt.B),(0,at.Yb)(16,dt.R)],Hr),(0,at.cp)((e,t)=>{let i=e.getColor(dt.On);i&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {\n\t\t\t\tborder-bottom: 1px solid ".concat(i,";\n\t\t\t}\n\t\t"));let o=e.getColor(at.ug);o&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {\n\t\t\t\toutline: 1px solid;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.selected:not(.active):not(:hover)  {\n\t\t\t\toutline: 1px dotted;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:focus {\n\t\t\t\toutline-style: dashed;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {\n\t\t\t\toutline: 1px dotted;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\toutline: 1px dashed;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t");let s=e.getColor(at.dg);s&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {\n\t\t\t\toutline: 1px solid ".concat(s,"\n\t\t\t}\n\t\t"));let r=e.getColor(dt.kn);r&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover {\n\t\t\t\tbackground-color: ".concat(r," !important;\n\t\t\t}\n\t\t"));let n=e.getColor(dt.Vn);n&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {\n\t\t\t\tbackground-color: ".concat(n," !important;\n\t\t\t}\n\t\t"));let a=e.getColor(dt.jn);a&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover  {\n\t\t\t\tcolor: ".concat(a," !important;\n\t\t\t}\n\t\t"));let d=e.getColor(dt.Un);d&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {\n\t\t\t\tcolor: ".concat(d," !important;\n\t\t\t}\n\t\t"));let l=e.getColor(dt.An);l&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t\twidth: 100%;\n\t\t\t\tz-index: 10;\n\t\t\t\tbottom: 0;\n\t\t\t\theight: 1px;\n\t\t\t\tbackground-color: ".concat(l,";\n\t\t\t}\n\t\t"));let c=e.getColor(dt.Hn);if(c&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t\twidth: 100%;\n\t\t\t\tz-index: 10;\n\t\t\t\tbottom: 0;\n\t\t\t\theight: 1px;\n\t\t\t\tbackground-color: ".concat(c,";\n\t\t\t}\n\t\t")),!(0,at.gm)(e.type)&&!at.dE&&!o){let i,o,s=(0,dt.$n)(e),a=e.getColor(at.yh),d=e.getColor(dt.Tt),l=e.getColor(dt._t);d&&a&&(i=d.flatten(a,a,s)),d&&a&&l&&a&&(o=d.flatten(a,l,a,s));let c=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"\n\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container".concat(i?".active":""," > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,\n\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container").concat(i?".active":""," > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\tbackground: linear-gradient(to left, ").concat(e,", transparent) !important;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":""," > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":""," > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\tbackground: linear-gradient(to left, ").concat(t,", transparent) !important;\n\t\t\t}\n\t\t")};if(r&&i&&o){let e=r.flatten(i),s=r.flatten(o);t.addRule(c(e,s,!0))}if(n&&i&&o){let e=n.flatten(i),s=n.flatten(o);t.addRule(c(e,s))}if(l&&o){let e=l.flatten(o);t.addRule("\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ".concat(e,", transparent) !important;\n\t\t\t\t}\n\t\t"))}let h=(e,t,i,o)=>"\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container".concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-shrink").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container").concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-fixed").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ").concat(e,", transparent);\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-shrink").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-fixed").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ").concat(t,", transparent);\n\t\t\t\t}\n\t\t"),u=e.getColor(dt.Cn);if(u&&i&&o){let e=u.flatten(i),s=u.flatten(o);t.addRule(h(e,s,!0,!0))}let g=e.getColor(dt.In);if(g&&i&&o){let e=g.flatten(i),s=g.flatten(o);t.addRule(h(e,s,!1,!0))}let p=e.getColor(dt.Mn);if(p&&i&&o){let e=p.flatten(i),s=p.flatten(o);t.addRule(h(e,s,!0,!1))}let b=e.getColor(dt.Wn);if(b&&i&&o){let e=b.flatten(i),s=b.flatten(o);t.addRule(h(e,s,!1,!1))}}});var Ur={};(0,at.vE)(),(0,bt.en)(),(0,ut.tt)(),(0,dt.er)(),(0,at.lm)(),(0,at.oS)(),(0,at.kv)(),(0,at.GM)(),(0,at.LM)(),(0,at.wj)(),(0,at.Ii)(),(0,at.bE)(Ur);var jr=class extends As{constructor(){super(...arguments),this.activeLabel=Object.create(null)}get breadcrumbsControl(){var e;return null===(e=this.breadcrumbsControlFactory)||void 0===e?void 0:e.control}create(e){super.create(e);let t=this.titleContainer=e;t.draggable=!0,this.registerContainerListeners(t),this._register(at.cm.addTarget(t));let i=(0,at.px)(".label-container");return t.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(ut.$,i,{})).element,this._register((0,at.Sx)(this.editorLabel.element,at._x.CLICK,e=>this.onTitleLabelClick(e))),this.breadcrumbsControlFactory=this._register(this.instantiationService.createInstance(co,i,this.groupView,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:(0,rt.A)((0,rt.A)({},at.wi),{},{breadcrumbsBackground:at.Ev.transparent.toString()}),showPlaceholder:!1,dragEditor:!0})),this._register(this.breadcrumbsControlFactory.onDidEnablementChange(()=>this.handleBreadcrumbsEnablementChange())),t.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register((0,at.kj)(()=>t.classList.remove("breadcrumbs"))),this.createEditorActionsToolBar(t,["title-actions"]),t}registerContainerListeners(e){let t,i=!1;this._register(new at.hx(e,{onDragStart:t=>{i=this.onGroupDragStart(t,e)},onDrag:e=>{t=e},onDragEnd:o=>{this.onGroupDragEnd(o,t,e,i)}})),this._register((0,at.Sx)(e,at._x.DBLCLICK,e=>this.onTitleDoubleClick(e))),this._register((0,at.Sx)(e,at._x.AUXCLICK,e=>this.onTitleAuxClick(e))),this._register((0,at.Sx)(e,at.sm.Tap,e=>this.onTitleTap(e)));for(let o of[at._x.CONTEXT_MENU,at.sm.Contextmenu])this._register((0,at.Sx)(e,o,t=>{this.tabsModel.activeEditor&&this.onTabContextMenu(this.tabsModel.activeEditor,t,e)}))}onTitleLabelClick(e){at.gx.stop(e,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(e){at.gx.stop(e),this.groupView.pinEditor()}onTitleAuxClick(e){1===e.button&&this.tabsModel.activeEditor&&(at.gx.stop(e,!0),(0,bt.vn)(this.tabsModel,this.tabsModel.activeEditor,bt.Lt.MOUSE,this.groupsView.partOptions)||this.groupView.closeEditor(this.tabsModel.activeEditor))}onTitleTap(e){let t=e.initialTarget;!(0,at._S)(t)||!this.editorLabel||!(0,at.lS)(t,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(e){return this.doHandleOpenEditor()}openEditors(e){return this.doHandleOpenEditor()}doHandleOpenEditor(){let e=this.ifActiveEditorChanged(()=>this.redraw());return e||this.ifActiveEditorPropertiesChanged(()=>this.redraw()),e}beforeCloseEditor(e){}closeEditor(e){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(e){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(e,t,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(e){this.ifEditorIsActive(e,()=>this.redraw())}stickEditor(e){}unstickEditor(e){}setActive(e){this.redraw()}updateEditorSelections(){}updateEditorLabel(e){this.ifEditorIsActive(e,()=>this.redraw())}updateEditorDirty(e){this.ifEditorIsActive(e,()=>{let t=(0,at.UM)(this.titleContainer);e.isDirty()&&!e.isSaving()?t.classList.add("dirty"):t.classList.remove("dirty")})}updateOptions(e,t){super.updateOptions(e,t),(e.labelFormat!==t.labelFormat||!(0,at.FM)(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){(0,at.UM)(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(e){return!(!(!this.activeLabel.editor&&this.tabsModel.activeEditor||this.activeLabel.editor&&!this.tabsModel.activeEditor)&&this.activeLabel.editor&&this.tabsModel.isActive(this.activeLabel.editor))&&(e(),!0)}ifActiveEditorPropertiesChanged(e){!this.activeLabel.editor||!this.tabsModel.activeEditor||this.activeLabel.pinned!==this.tabsModel.isPinned(this.tabsModel.activeEditor)&&e()}ifEditorIsActive(e,t){this.tabsModel.isActive(e)&&t()}redraw(){var e;let t=null!==(e=this.tabsModel.activeEditor)&&void 0!==e?e:void 0,i=this.groupsView.partOptions,o=!!t&&this.tabsModel.isPinned(t),s=this.groupsView.activeGroup===this.groupView;this.activeLabel={editor:t,pinned:o},this.breadcrumbsControl&&(s?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!o)):this.breadcrumbsControl.hide());let[r,n]=(0,at.HM)(this.titleContainer,this.editorLabel);if(t){var a,d;this.updateEditorDirty(t);let e,{labelFormat:l}=this.groupsView.partOptions;e=this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||"default"===l&&!s?"":t.getDescription(this.getVerbosity(l))||"",n.setResource({resource:bt.Ht.getOriginalUri(t,{supportSideBySide:bt.Jt.BOTH}),name:t.getName(),description:e},{title:this.getHoverTitle(t),italic:!o,extraClasses:["single-tab","title-label"].concat(t.getLabelExtraClasses()),fileDecorations:{colors:!(null===(a=i.decorations)||void 0===a||!a.colors),badges:!(null===(d=i.decorations)||void 0===d||!d.badges)},icon:t.getIcon(),hideIcon:!1===i.showIcons}),r.style.color=s?this.getColor(dt.En)||"":this.getColor(dt.zn)||"",this.updateEditorActionsToolbar()}else r.classList.remove("dirty"),n.clear(),this.clearEditorActionsToolbar()}getVerbosity(e){switch(e){case"short":return bt.Xt.SHORT;case"long":return bt.Xt.LONG;default:return bt.Xt.MEDIUM}}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(e=>"workbench.action.closeActiveEditor"===e.id||"workbench.action.unlockEditorGroup"===e.id),secondary:e.secondary}}getHeight(){return this.tabHeight}layout(e){var t;return null!==(t=this.breadcrumbsControl)&&void 0!==t&&t.layout(void 0),new at.mx(e.container.width,this.getHeight())}};(0,at.Xb)(),(0,at.oS)(),(0,at.ox)(),(0,at.wj)();var zr=class extends at.mj{constructor(e,t,i,o,s,r){super(),this.parent=e,this.groupsView=i,this.groupView=o,this.model=s,this.instantiationService=r;let n=this._register(new Qr(this.model)),a=this._register(new Xr(this.model));this.stickyEditorTabsControl=this._register(this.instantiationService.createInstance(Hr,this.parent,t,this.groupsView,this.groupView,n)),this.unstickyEditorTabsControl=this._register(this.instantiationService.createInstance(Hr,this.parent,t,this.groupsView,this.groupView,a)),this.handleTabBarsStateChange()}handleTabBarsStateChange(){this.activeControl=this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0,this.handleTabBarsLayoutChange()}handleTabBarsLayoutChange(){if(0===this.groupView.count)return;let e=this.parent.classList.contains("two-tab-bars"),t=this.groupView.count!==this.groupView.stickyCount&&this.groupView.stickyCount>0;this.parent.classList.toggle("two-tab-bars",t),e!==t&&this.groupView.relayout()}didActiveControlChange(){return this.activeControl!==(this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0)}getEditorTabsController(e){return this.model.isSticky(e)?this.stickyEditorTabsControl:this.unstickyEditorTabsControl}openEditor(e,t){let i=this.didActiveControlChange(),o=this.getEditorTabsController(e).openEditor(e,t)||i;return o&&this.handleOpenedEditors(),o}openEditors(e){let t=e.filter(e=>this.model.isSticky(e)),i=e.filter(e=>!this.model.isSticky(e)),o=this.didActiveControlChange(),s=this.stickyEditorTabsControl.openEditors(t),r=this.unstickyEditorTabsControl.openEditors(i),n=s||r||o;return n&&this.handleOpenedEditors(),n}handleOpenedEditors(){this.handleTabBarsStateChange()}beforeCloseEditor(e){this.getEditorTabsController(e).beforeCloseEditor(e)}closeEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){let t=e.filter(e=>this.model.isSticky(e)),i=e.filter(e=>!this.model.isSticky(e));this.stickyEditorTabsControl.closeEditors(t),this.unstickyEditorTabsControl.closeEditors(i),this.handleClosedEditors()}handleClosedEditors(){this.handleTabBarsStateChange()}moveEditor(e,t,i,o){o?(this.model.isSticky(e)?(this.stickyEditorTabsControl.openEditor(e),this.unstickyEditorTabsControl.closeEditor(e)):(this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e)),this.handleTabBarsStateChange()):this.model.isSticky(e)?this.stickyEditorTabsControl.moveEditor(e,t,i,o):this.unstickyEditorTabsControl.moveEditor(e,t-this.model.stickyCount,i-this.model.stickyCount,o)}pinEditor(e){this.getEditorTabsController(e).pinEditor(e)}stickEditor(e){this.unstickyEditorTabsControl.closeEditor(e),this.stickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}unstickEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}setActive(e){this.stickyEditorTabsControl.setActive(e),this.unstickyEditorTabsControl.setActive(e)}updateEditorSelections(){this.stickyEditorTabsControl.updateEditorSelections(),this.unstickyEditorTabsControl.updateEditorSelections()}updateEditorLabel(e){this.getEditorTabsController(e).updateEditorLabel(e)}updateEditorDirty(e){this.getEditorTabsController(e).updateEditorDirty(e)}updateOptions(e,t){this.stickyEditorTabsControl.updateOptions(e,t),this.unstickyEditorTabsControl.updateOptions(e,t)}layout(e){let t=this.stickyEditorTabsControl.layout(e),i={container:e.container,available:new at.mx(e.available.width,e.available.height-t.height)},o=this.unstickyEditorTabsControl.layout(i);return new at.mx(e.container.width,t.height+o.height)}getHeight(){return this.stickyEditorTabsControl.getHeight()+this.unstickyEditorTabsControl.getHeight()}dispose(){this.parent.classList.toggle("two-tab-bars",!1),super.dispose()}};zr=(0,at.Jb)([(0,at.Yb)(5,at.rx)],zr),(0,at.vE)(),(0,at.oS)(),(0,at.bE)(Ur);var qr=class extends As{constructor(){super(...arguments),this.activeEditor=null}prepareEditorActions(e){return{primary:[],secondary:[]}}openEditor(e){return this.handleOpenedEditors()}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){let e=this.activeEditorChanged();return this.activeEditor=this.tabsModel.activeEditor,e}activeEditorChanged(){return!(!(!this.activeEditor&&this.tabsModel.activeEditor||this.activeEditor&&!this.tabsModel.activeEditor)&&this.activeEditor&&this.tabsModel.isActive(this.activeEditor))}beforeCloseEditor(e){}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){this.activeEditor=this.tabsModel.activeEditor}moveEditor(e,t,i){}pinEditor(e){}stickEditor(e){}unstickEditor(e){}setActive(e){}updateEditorSelections(){}updateEditorLabel(e){}updateEditorDirty(e){}getHeight(){return 0}layout(e){return new at.mx(e.container.width,this.getHeight())}};(0,at.vE)(),(0,at.Xb)(),(0,at.oS)(),(0,at.ox)(),(0,at.sp)(),(0,at.Xd)(),(0,at.wj)(),(0,at.bE)({});var $r,en=class extends at.ap{get breadcrumbsControl(){var e;return null===(e=this.breadcrumbsControlFactory)||void 0===e?void 0:e.control}constructor(e,t,i,o,s,r,n){super(n),this.parent=e,this.editorPartsView=t,this.groupsView=i,this.groupView=o,this.model=s,this.instantiationService=r,this.editorTabsControlDisposable=this._register(new at.gj),this.breadcrumbsControlDisposables=this._register(new at.gj),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()}createEditorTabsControl(){let e;switch(this.groupsView.partOptions.showTabs){case"none":e=qr;break;case"single":e=jr;break;default:e=this.groupsView.partOptions.pinnedTabsOnSeparateRow?zr:Hr}let t=this.instantiationService.createInstance(e,this.parent,this.editorPartsView,this.groupsView,this.groupView,this.model);return this.editorTabsControlDisposable.add(t)}createBreadcrumbsControl(){if("single"===this.groupsView.partOptions.showTabs)return;let e=(0,at.px)(".breadcrumbs-below-tabs");this.parent.appendChild(e);let t=this.breadcrumbsControlDisposables.add(this.instantiationService.createInstance(co,e,this.groupView,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0,dragEditor:!1}));return this.breadcrumbsControlDisposables.add(t.onDidEnablementChange(()=>this.groupView.relayout())),this.breadcrumbsControlDisposables.add(t.onDidVisibilityChange(()=>this.groupView.relayout())),t}openEditor(e,t){let i=this.editorTabsControl.openEditor(e,t);this.handleOpenedEditors(i)}openEditors(e){let t=this.editorTabsControl.openEditors(e);this.handleOpenedEditors(t)}handleOpenedEditors(e){var t,i;e?null===(t=this.breadcrumbsControl)||void 0===t||t.update():null===(i=this.breadcrumbsControl)||void 0===i||i.revealLast()}beforeCloseEditor(e){return this.editorTabsControl.beforeCloseEditor(e)}closeEditor(e){this.editorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){this.editorTabsControl.closeEditors(e),this.handleClosedEditors()}handleClosedEditors(){var e;this.groupView.activeEditor||null===(e=this.breadcrumbsControl)||void 0===e||e.update()}moveEditor(e,t,i,o){return this.editorTabsControl.moveEditor(e,t,i,o)}pinEditor(e){return this.editorTabsControl.pinEditor(e)}stickEditor(e){return this.editorTabsControl.stickEditor(e)}unstickEditor(e){return this.editorTabsControl.unstickEditor(e)}setActive(e){return this.editorTabsControl.setActive(e)}updateEditorSelections(){this.editorTabsControl.updateEditorSelections()}updateEditorLabel(e){return this.editorTabsControl.updateEditorLabel(e)}updateEditorDirty(e){return this.editorTabsControl.updateEditorDirty(e)}updateOptions(e,t){e.showTabs!==t.showTabs||"single"!==t.showTabs&&e.pinnedTabsOnSeparateRow!==t.pinnedTabsOnSeparateRow?(this.editorTabsControlDisposable.clear(),this.breadcrumbsControlDisposables.clear(),(0,at.Ox)(this.parent),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()):this.editorTabsControl.updateOptions(e,t)}layout(e){var t;let i,o=this.editorTabsControl.layout(e);return!1===(null===(t=this.breadcrumbsControl)||void 0===t?void 0:t.isHidden())&&(i=new at.mx(e.container.width,lo.HEIGHT),this.breadcrumbsControl.layout(i)),new at.mx(e.container.width,o.height+(i?i.height:0))}getHeight(){var e;let t=this.editorTabsControl.getHeight();return{total:t+(!1===(null===(e=this.breadcrumbsControl)||void 0===e?void 0:e.isHidden())?lo.HEIGHT:0),offset:t}}};en=(0,at.Jb)([(0,at.Yb)(5,at.rx),(0,at.Yb)(6,at.Yd)],en),(0,at.vE)(),(0,at.Xb)(),(0,ut.ra)(),(0,bt.en)(),(0,pt.tr)(),(0,bt.Ot)(),(0,at.sj)(),(0,at.ox)(),(0,at.oS)(),(0,at.au)(),(0,at.Pb)(),(0,at.Bn)(),(0,at.sp)(),(0,at.Xd)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,dt.er)(),(0,bt.Q)(),(0,at.Va)(),(0,ut.Z)(),(0,at.TM)(),(0,at.AN)(),(0,at.wj)(),(0,at.yb)(),(0,at.Ww)(),(0,at.lm)(),(0,dt.tt)(),(0,at.Ur)(),(0,at.Dd)(),(0,at.Tb)(),(0,at.ni)(),(0,at.HT)(),(0,at.ei)(),(0,at.Ol)(),(0,bt.At)(),(0,at.JC)(),(0,at.pa)(),(0,at.dT)(),(0,at.ET)(),(0,at.jr)(),(0,ut.ta)(),(0,at.Vl)(),(0,bt.i)(),(0,bt.V)(),(0,at.SO)(),(0,at.Go)(),(0,at.iM)(),(0,at.gb)(),(0,ut.Qb)(),(0,at.Ii)(),(0,dt.c)(),(0,dt.V)(),(0,dt.z)(),(0,bt.it)(),(0,at.Qs)(),(0,at.ps)(),(0,at.bE)({});var tn=$r=class extends at.ap{static createNew(e,t,i,o,s,r){return s.createInstance($r,null,e,t,i,o,r)}static createFromSerialized(e,t,i,o,s,r,n){return r.createInstance($r,e,t,i,o,s,n)}static createCopy(e,t,i,o,s,r,n){return r.createInstance($r,e,t,i,o,s,n)}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C,w,y,f){var S;super(d),this.editorPartsView=t,this.groupsView=i,this.groupsLabel=o,this._index=s,this.instantiationService=n,this.contextKeyService=a,this.telemetryService=l,this.keybindingService=c,this.menuService=h,this.contextMenuService=u,this.fileDialogService=g,this.editorService=p,this.filesConfigurationService=b,this.uriIdentityService=m,this.logService=v,this.editorResolverService=C,this.hostService=w,this.dialogService=y,this.fileService=f,this._onDidFocus=this._register(new at.ej),this.onDidFocus=this._onDidFocus.event,this._onWillDispose=this._register(new at.ej),this.onWillDispose=this._onWillDispose.event,this._onDidModelChange=this._register(new at.ej),this.onDidModelChange=this._onDidModelChange.event,this._onDidActiveEditorChange=this._register(new at.ej),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidOpenEditorFail=this._register(new at.ej),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onWillCloseEditor=this._register(new at.ej),this.onWillCloseEditor=this._onWillCloseEditor.event,this._onDidCloseEditor=this._register(new at.ej),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onWillMoveEditor=this._register(new at.ej),this.onWillMoveEditor=this._onWillMoveEditor.event,this._onWillOpenEditor=this._register(new at.ej),this.onWillOpenEditor=this._onWillOpenEditor.event,this.disposedEditorsWorker=this._register(new at.jw(e=>this.handleDisposedEditors(e),0)),this.mapEditorToPendingConfirmation=new Map,this.containerToolBarMenuDisposable=this._register(new at.vj),this.whenRestoredPromise=new at.xw,this.whenRestored=this.whenRestoredPromise.p,this._disposed=!1,this.element=(0,at.px)("div"),this._onDidChange=this._register(new at.ij),this.onDidChange=this._onDidChange.event,e instanceof $r?this.model=this._register(e.model.clone()):(0,ut.oa)(e)?this.model=this._register(n.createInstance(ut.na,e)):this.model=this._register(n.createInstance(ut.na,void 0)),this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.element)),this.element.classList.add(...(0,at._N)(["editor-group-container",this.model.isLocked?"locked":void 0])),this.registerContainerListeners(),this.createContainerToolbar(),this.createContainerContextMenu(),this._register(this.instantiationService.createInstance(Oi,this.element)),this.progressBar=this._register(new at.zn(this.element,at.Ni)),this.progressBar.hide(),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new at.iu([at.Nb,this.scopedContextKeyService],[at.za,this._register(new ut.Y(this.progressBar,this))]))),this.resourceContext=this._register(this.scopedInstantiationService.createInstance(pt.Bn)),this.handleGroupContextKeys(),this.titleContainer=(0,at.px)(".title"),this.element.appendChild(this.titleContainer),this.titleControl=this._register(this.scopedInstantiationService.createInstance(en,this.titleContainer,this.editorPartsView,this.groupsView,this,this.model)),this.editorContainer=(0,at.px)(".editor-container"),this.element.appendChild(this.editorContainer),this.editorPane=this._register(this.scopedInstantiationService.createInstance(bi,this.element,this.editorContainer,this)),this._onDidChange.input=this.editorPane.onDidChangeSizeConstraints,this.doTrackFocus(),this.updateTitleContainer(),this.updateContainer(),this.updateStyles(),(null!==(S=this.restoreEditors(e,r))&&void 0!==S?S:Promise.resolve()).finally(()=>{this.whenRestoredPromise.complete()}),this.registerListeners()}handleGroupContextKeys(){let e=this.editorPartsView.bind(pt.tn,this),t=this.editorPartsView.bind(pt.on,this),i=this.editorPartsView.bind(pt.nn,this),o=this.editorPartsView.bind(pt.an,this),s=this.editorPartsView.bind(pt.cn,this),r=this.editorPartsView.bind(pt.hn,this),n=this.editorPartsView.bind(pt.in,this),a=pt.An.bindTo(this.scopedContextKeyService),d=pt.Qn.bindTo(this.scopedContextKeyService),l=pt.Vn.bindTo(this.scopedContextKeyService),c=this.editorPartsView.bind(pt.en,this),h=this.editorPartsView.bind(pt.sn,this),u=this.editorPartsView.bind(pt.Zt,this),g=this.editorPartsView.bind(pt.$t,this),p=this.editorPartsView.bind(pt.Yt,this),b=this.editorPartsView.bind(pt.Yn,this),m=this.editorPartsView.bind(pt.Jn,this),v=this.editorPartsView.bind(pt.Xt,this),C=this.editorPartsView.bind(pt.Qt,this),w=this.editorPartsView.bind(pt.Un,this),y=this._register(new at.vj),f=()=>{y.clear(),this.scopedContextKeyService.bufferChangeEvents(()=>{let t=this.activeEditor,i=this.activeEditorPane;if(this.resourceContext.set(bt.Ht.getOriginalUri(t,{supportSideBySide:bt.Jt.PRIMARY})),(0,pt.$n)(v,t,this.editorResolverService),t?(C.set(t.hasCapability(bt.zt.CanSplitInGroup)),w.set(t.typeId===bt.Et.ID),e.set(t.isDirty()&&!t.isSaving()),y.value=t.onDidChangeDirty(()=>{e.set(t.isDirty()&&!t.isSaving())})):(C.set(!1),w.set(!1),e.set(!1)),i){c.set(i.getId()),u.set(!i.input.hasCapability(bt.zt.Untitled)),h.set(!!i.input.isReadonly());let e=bt.Ht.getOriginalUri(i.input,{supportSideBySide:bt.Jt.PRIMARY}),t=bt.Ht.getOriginalUri(i.input,{supportSideBySide:bt.Jt.SECONDARY});p.set(i.input instanceof bt.nt&&!i.input.original.isReadonly()&&!!e&&(this.fileService.hasProvider(e)||e.scheme===at.TT.untitled)&&!!t&&(this.fileService.hasProvider(t)||t.scheme===at.TT.untitled)),g.set(!!e&&this.fileService.hasProvider(e)&&!this.fileService.hasCapability(e,at.js.Readonly));let o=(null===i||void 0===i?void 0:i.getId())===bt.Yt;m.set(o),b.set(o)}else c.reset(),u.reset(),h.reset(),p.reset(),g.reset()})},S=e=>{switch(e.kind){case bt.Wt.GROUP_LOCKED:n.set(this.isLocked);break;case bt.Wt.EDITOR_ACTIVE:i.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor)),t.set(!!this.model.activeEditor&&this.model.isPinned(this.model.activeEditor)),s.set(!!this.model.activeEditor&&this.model.isSticky(this.model.activeEditor));break;case bt.Wt.EDITOR_CLOSE:t.set(!!this.model.activeEditor&&this.model.isPinned(this.model.activeEditor)),s.set(!!this.model.activeEditor&&this.model.isSticky(this.model.activeEditor));case bt.Wt.EDITOR_OPEN:case bt.Wt.EDITOR_MOVE:i.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor));break;case bt.Wt.EDITOR_PIN:e.editor&&e.editor===this.model.activeEditor&&t.set(this.model.isPinned(this.model.activeEditor));break;case bt.Wt.EDITOR_STICKY:e.editor&&e.editor===this.model.activeEditor&&s.set(this.model.isSticky(this.model.activeEditor));break;case bt.Wt.EDITORS_SELECTION:a.set(this.model.selectedEditors.length>1),d.set(2===this.model.selectedEditors.length),l.set(this.model.selectedEditors.every(e=>e.resource&&(this.fileService.hasProvider(e.resource)||e.resource.scheme===at.TT.untitled)))}r.set(this.count)};this._register(this.onDidModelChange(e=>S(e))),this._register(this.onDidActiveEditorChange(()=>f())),f(),S({kind:bt.Wt.EDITOR_ACTIVE}),S({kind:bt.Wt.GROUP_LOCKED})}registerContainerListeners(){this._register((0,at.Sx)(this.element,at._x.DBLCLICK,e=>{this.isEmpty&&(at.gx.stop(e),this.editorService.openEditor({resource:void 0,options:{pinned:!0,override:bt.Ft.id}},this.id))})),this._register((0,at.Sx)(this.element,at._x.AUXCLICK,e=>{this.isEmpty&&1===e.button&&(at.gx.stop(e,!0),this.groupsView.removeGroup(this))}))}createContainerToolbar(){let e=(0,at.px)(".editor-group-container-toolbar");this.element.appendChild(e);let t=this._register(new at.Vr(e,{ariaLabel:(0,at.EM)(3316,"Empty editor group actions"),highlightToggledItems:!0})),i=this._register(this.menuService.createMenu(at.xb.EmptyEditorGroup,this.scopedContextKeyService)),o=()=>{this.containerToolBarMenuDisposable.value=(0,at.kj)(()=>t.clear());let e=(0,at.Xr)(i.getActions({arg:{groupId:this.id},shouldForwardArgs:!0}),"navigation");for(let i of[...e.primary,...e.secondary]){let e=this.keybindingService.lookupKeybinding(i.id);t.push(i,{icon:!0,label:!1,keybinding:null===e||void 0===e?void 0:e.getLabel()})}};o(),this._register(i.onDidChange(o))}createContainerContextMenu(){this._register((0,at.Sx)(this.element,at._x.CONTEXT_MENU,e=>this.onShowContainerContextMenu(e))),this._register((0,at.Sx)(this.element,at.sm.Contextmenu,()=>this.onShowContainerContextMenu()))}onShowContainerContextMenu(e){if(!this.isEmpty)return;let t=this.element;e&&(t=new at.BT((0,at.$x)(this.element),e)),this.contextMenuService.showContextMenu({menuId:at.xb.EmptyEditorGroupContext,contextKeyService:this.contextKeyService,getAnchor:()=>t,onHide:()=>this.focus()})}doTrackFocus(){let e=this._register((0,at.US)(this.element));this._register(e.onDidFocus(()=>{this.isEmpty&&this._onDidFocus.fire()}));let t=e=>{let t;if((0,at.SS)(e)){if(0!==e.button||at.pM&&e.ctrlKey)return;t=e.target}else t=e.initialTarget;(0,at.Lx)(t,"monaco-action-bar",this.titleContainer)||(0,at.Lx)(t,"monaco-breadcrumb-item",this.titleContainer)||setTimeout(()=>{this.focus()})};this._register((0,at.Sx)(this.titleContainer,at._x.MOUSE_DOWN,e=>t(e))),this._register((0,at.Sx)(this.titleContainer,at.sm.Tap,e=>t(e))),this._register(this.editorPane.onDidFocus(()=>{this._onDidFocus.fire()}))}updateContainer(){this.isEmpty?(this.element.classList.add("empty"),this.element.tabIndex=0,this.element.setAttribute("aria-label",(0,at.EM)(3317,"{0} (empty)",this.ariaLabel))):(this.element.classList.remove("empty"),this.element.removeAttribute("tabIndex"),this.element.removeAttribute("aria-label")),this.updateStyles()}updateTitleContainer(){this.titleContainer.classList.toggle("tabs","multiple"===this.groupsView.partOptions.showTabs),this.titleContainer.classList.toggle("show-file-icons",this.groupsView.partOptions.showIcons)}restoreEditors(e,t){if(0===this.count)return;let i;i=e instanceof $r?(0,dt.Q)(e):Object.create(null);let o=this.model.activeEditor;if(!o)return;i.pinned=this.model.isPinned(o),i.sticky=this.model.isSticky(o),i.preserveFocus=!0;let s=(0,at.zx)(),r=this.doShowEditor(o,{active:!0,isNew:!1},i,{preserveWindowOrder:!0,skipTitleUpdate:!0}).then(()=>{this.groupsView.activeGroup===this&&s&&(0,at.cS)(s)&&(null===t||void 0===t||!t.preserveFocus)&&this.focus()});return this.titleControl.openEditors(this.editors),r}registerListeners(){this._register(this.model.onDidModelChange(e=>this.onDidGroupModelChange(e))),this._register(this.groupsView.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this._register(this.groupsView.onDidVisibilityChange(e=>this.onDidVisibilityChange(e))),this._register(this.onDidFocus(()=>this.onDidGainFocus()))}onDidGroupModelChange(e){switch(this._onDidModelChange.fire(e),e.kind){case bt.Wt.GROUP_LOCKED:this.element.classList.toggle("locked",this.isLocked);break;case bt.Wt.EDITORS_SELECTION:this.onDidChangeEditorSelection()}if(e.editor)switch(e.kind){case bt.Wt.EDITOR_OPEN:(0,ut.aa)(e)&&this.onDidOpenEditor(e.editor,e.editorIndex);break;case bt.Wt.EDITOR_CLOSE:(0,ut.ia)(e)&&this.handleOnDidCloseEditor(e.editor,e.editorIndex,e.context,e.sticky);break;case bt.Wt.EDITOR_WILL_DISPOSE:this.onWillDisposeEditor(e.editor);break;case bt.Wt.EDITOR_DIRTY:this.onDidChangeEditorDirty(e.editor);break;case bt.Wt.EDITOR_TRANSIENT:this.onDidChangeEditorTransient(e.editor);break;case bt.Wt.EDITOR_LABEL:this.onDidChangeEditorLabel(e.editor)}}onDidOpenEditor(e,t){this.telemetryService.publicLog("editorOpened",this.toEditorTelemetryDescriptor(e)),this.updateContainer()}handleOnDidCloseEditor(e,t,i,o){this._onWillCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o});let s=[e];e instanceof bt.Et&&s.push(e.primary,e.secondary);for(let r of s)this.canDispose(r)&&r.dispose();this.updateContainer(),this._onDidCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o})}canDispose(e){for(let t of this.editorPartsView.groups)if(t instanceof $r&&t.model.contains(e,{strictEquals:!0,supportSideBySide:bt.Jt.ANY}))return!1;return!0}toResourceTelemetryDescriptor(e){if(!e)return;let t=e?e.scheme===at.TT.file?e.fsPath:e.path:void 0;if(!t)return;let i=(0,at.uT)(e),o=i.indexOf("?");return i=-1===o?i:i.substr(0,o),{mimeType:new ut.Yb((0,at.fa)(e).join(", ")),scheme:e.scheme,ext:i,path:(0,at.qC)(t)}}toEditorTelemetryDescriptor(e){let t=e.getTelemetryDescriptor(),i=bt.Ht.getOriginalUri(e,{supportSideBySide:bt.Jt.BOTH});return at.xO.isUri(i)?(t.resource=this.toResourceTelemetryDescriptor(i),t):i?(i.primary&&(t.resource=this.toResourceTelemetryDescriptor(i.primary)),i.secondary&&(t.resourceSecondary=this.toResourceTelemetryDescriptor(i.secondary)),t):t}onWillDisposeEditor(e){this.disposedEditorsWorker.work(e)}handleDisposedEditors(e){let t,i=[];for(let o of e){let e=this.model.findEditor(o);if(!e)continue;let s=e[0];s.isDisposed()&&(this.model.isActive(s)?t=s:i.push(s))}for(let o of i)this.doCloseEditor(o,!0);t&&this.doCloseEditor(t,!0)}onDidChangeEditorPartOptions(e){this.updateTitleContainer(),this.titleControl.updateOptions(e.oldPartOptions,e.newPartOptions),(e.oldPartOptions.showTabs!==e.newPartOptions.showTabs||e.oldPartOptions.tabHeight!==e.newPartOptions.tabHeight||"multiple"===e.oldPartOptions.showTabs&&e.oldPartOptions.pinnedTabsOnSeparateRow!==e.newPartOptions.pinnedTabsOnSeparateRow)&&(this.relayout(),this.model.activeEditor&&this.titleControl.openEditors(this.model.getEditors(bt.Ut.SEQUENTIAL))),this.updateStyles(),e.oldPartOptions.enablePreview&&!e.newPartOptions.enablePreview&&this.model.previewEditor&&this.pinEditor(this.model.previewEditor)}onDidChangeEditorDirty(e){this.pinEditor(e),this.titleControl.updateEditorDirty(e)}onDidChangeEditorTransient(e){!this.model.isTransient(e)&&!this.groupsView.partOptions.enablePreview&&this.pinEditor(e)}onDidChangeEditorLabel(e){this.titleControl.updateEditorLabel(e)}onDidChangeEditorSelection(){this.titleControl.updateEditorSelections()}onDidVisibilityChange(e){this.editorPane.setVisible(e)}onDidGainFocus(){this.activeEditor&&this.model.setTransient(this.activeEditor,!1)}get index(){return this._index}get label(){return this.groupsLabel?(0,at.EM)(3318,"{0}: Group {1}",this.groupsLabel,this._index+1):(0,at.EM)(3319,"Group {0}",this._index+1)}get ariaLabel(){return this.groupsLabel?(0,at.EM)(3320,"{0}: Editor Group {1}",this.groupsLabel,this._index+1):(0,at.EM)(3321,"Editor Group {0}",this._index+1)}get disposed(){return this._disposed}get isEmpty(){return 0===this.count}get titleHeight(){return this.titleControl.getHeight()}notifyIndexChanged(e){this._index!==e&&(this._index=e,this.model.setIndex(e))}notifyLabelChanged(e){this.groupsLabel!==e&&(this.groupsLabel=e,this.model.setLabel(e))}setActive(e){this.active=e,!e&&this.activeEditor&&this.selectedEditors.length>1&&this.setSelection(this.activeEditor,[]),this.element.classList.toggle("active",e),this.element.classList.toggle("inactive",!e),this.titleControl.setActive(e),this.updateStyles(),this.model.setActive(void 0)}get id(){return this.model.id}get windowId(){return this.groupsView.windowId}get editors(){return this.model.getEditors(bt.Ut.SEQUENTIAL)}get count(){return this.model.count}get stickyCount(){return this.model.stickyCount}get activeEditorPane(){var e;return this.editorPane&&null!==(e=this.editorPane.activeEditorPane)&&void 0!==e?e:void 0}get activeEditor(){return this.model.activeEditor}get selectedEditors(){return this.model.selectedEditors}get previewEditor(){return this.model.previewEditor}isPinned(e){return this.model.isPinned(e)}isSticky(e){return this.model.isSticky(e)}isSelected(e){return this.model.isSelected(e)}isTransient(e){return this.model.isTransient(e)}isActive(e){return this.model.isActive(e)}async setSelection(e,t){this.isActive(e)?this.model.setSelection(e,t):await this.openEditor(e,{activation:at.Er.ACTIVATE},{inactiveSelection:t})}contains(e,t){return this.model.contains(e,t)}getEditors(e,t){return this.model.getEditors(e,t)}findEditors(e,t){var i;let o=this.uriIdentityService.asCanonicalUri(e);return this.getEditors(null!==(i=null===t||void 0===t?void 0:t.order)&&void 0!==i?i:bt.Ut.SEQUENTIAL).filter(e=>{if(e.resource&&(0,at.pT)(e.resource,o))return!0;if((null===t||void 0===t?void 0:t.supportSideBySide)===bt.Jt.PRIMARY||(null===t||void 0===t?void 0:t.supportSideBySide)===bt.Jt.ANY){let t=bt.Ht.getCanonicalUri(e,{supportSideBySide:bt.Jt.PRIMARY});if(t&&(0,at.pT)(t,o))return!0}if((null===t||void 0===t?void 0:t.supportSideBySide)===bt.Jt.SECONDARY||(null===t||void 0===t?void 0:t.supportSideBySide)===bt.Jt.ANY){let t=bt.Ht.getCanonicalUri(e,{supportSideBySide:bt.Jt.SECONDARY});if(t&&(0,at.pT)(t,o))return!0}return!1})}getEditorByIndex(e){return this.model.getEditorByIndex(e)}getIndexOfEditor(e){return this.model.indexOf(e)}isFirst(e){return this.model.isFirst(e)}isLast(e){return this.model.isLast(e)}focus(){this.activeEditorPane?this.activeEditorPane.focus():this.element.focus(),this._onDidFocus.fire()}pinEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0;if(e&&!this.model.isPinned(e)){let t=this.model.pin(e);t&&this.titleControl.pinEditor(t)}}stickEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0;this.doStickEditor(e,!0)}unstickEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0;this.doStickEditor(e,!1)}doStickEditor(e,t){if(e&&this.model.isSticky(e)!==t){let i=this.getIndexOfEditor(e),o=t?this.model.stick(e):this.model.unstick(e);if(!o)return;let s=this.getIndexOfEditor(o);s!==i&&this.titleControl.moveEditor(o,i,s,!0),t?this.titleControl.stickEditor(o):this.titleControl.unstickEditor(o)}}async openEditor(e,t,i){return this.doOpenEditor(e,t,(0,rt.A)((0,rt.A)({},i),{},{supportSideBySide:bt.Jt.BOTH}))}async doOpenEditor(e,t,i){var o,s;if(!e||e.isDisposed())return;this._onWillOpenEditor.fire({editor:e,groupId:this.id});let r=(null===t||void 0===t?void 0:t.sticky)||!this.groupsView.partOptions.enablePreview&&!(null!==t&&void 0!==t&&t.transient)||e.isDirty()||(null!==(o=null===t||void 0===t?void 0:t.pinned)&&void 0!==o?o:"number"==typeof(null===t||void 0===t?void 0:t.index))||"number"==typeof(null===t||void 0===t?void 0:t.index)&&this.model.isSticky(t.index)||e.hasCapability(bt.zt.Scratchpad),n={index:t?t.index:void 0,pinned:r,sticky:(null===t||void 0===t?void 0:t.sticky)||"number"==typeof(null===t||void 0===t?void 0:t.index)&&this.model.isSticky(t.index),transient:!(null===t||void 0===t||!t.transient),inactiveSelection:null===i||void 0===i?void 0:i.inactiveSelection,active:0===this.count||!t||!t.inactive,supportSideBySide:null===i||void 0===i?void 0:i.supportSideBySide};!n.active&&!n.pinned&&this.model.activeEditor&&!this.model.isPinned(this.model.activeEditor)&&(n.active=!0);let a=!1,d=!1;if((null===t||void 0===t?void 0:t.activation)===at.Er.ACTIVATE?a=!0:(null===t||void 0===t?void 0:t.activation)===at.Er.RESTORE?d=!0:(null===t||void 0===t?void 0:t.activation)===at.Er.PRESERVE?(a=!1,d=!1):n.active&&(a=!t||!t.preserveFocus,d=!a),"number"==typeof n.index){let t=this.model.indexOf(e);-1!==t&&t!==n.index&&this.doMoveEditorInsideGroup(e,n)}let{editor:l,isNew:c}=this.model.openEditor(e,n);c&&1===this.count&&this.editorPartsView.groups.length>1&&l.editorId&&(null===(s=this.groupsView.partOptions.autoLockGroups)||void 0===s?void 0:s.has(l.editorId))&&this.lock(!0);let h=this.doShowEditor(l,{active:!!n.active,isNew:c},t,i);return a?this.groupsView.activateGroup(this):d&&this.groupsView.restoreGroup(this),h}doShowEditor(e,t,i,o){let s;return s=t.active?(async()=>{let{pane:s,changed:r,cancelled:n,error:a}=await this.editorPane.openEditor(e,i,o,{newInGroup:t.isNew});if(!n)return r&&this._onDidActiveEditorChange.fire({editor:e}),a&&this._onDidOpenEditorFail.fire(e),!s&&this.activeEditor===e&&this.doCloseEditor(e,null===i||void 0===i?void 0:i.preserveFocus,{fromError:!0}),s})():Promise.resolve(void 0),null!==o&&void 0!==o&&o.skipTitleUpdate||this.titleControl.openEditor(e,o),s}async openEditors(e){var t;let i=(0,at._N)(e).filter(e=>{let{editor:t}=e;return!t.isDisposed()}),o=i.at(0);if(!o)return;let s={supportSideBySide:bt.Jt.BOTH};await this.doOpenEditor(o.editor,o.options,s);let r=i.slice(1),n=this.getIndexOfEditor(o.editor)+1;return await at.Dw.settled(r.map((e,t)=>{let{editor:i,options:o}=e;return this.doOpenEditor(i,(0,rt.A)((0,rt.A)({},o),{},{inactive:!0,pinned:!0,index:n+t}),(0,rt.A)((0,rt.A)({},s),{},{skipTitleUpdate:!0}))})),this.titleControl.openEditors(r.map(e=>{let{editor:t}=e;return t})),null!==(t=this.editorPane.activeEditorPane)&&void 0!==t?t:void 0}moveEditors(e,t){let i={skipTitleUpdate:this!==t},o=!1,s=new Set;for(let{editor:r,options:n}of e)this.moveEditor(r,t,n,i)?s.add(r):o=!0;return i.skipTitleUpdate&&(t.titleControl.openEditors(Array.from(s)),this.titleControl.closeEditors(Array.from(s))),!o}moveEditor(e,t,i,o){return this===t?(this.doMoveEditorInsideGroup(e,i),!0):this.doMoveOrCopyEditorAcrossGroups(e,t,i,(0,rt.A)((0,rt.A)({},o),{},{keepCopy:!1}))}doMoveEditorInsideGroup(e,t){let i=t?t.index:void 0;if("number"!=typeof i)return;let o=this.model.indexOf(e),s=this.model.getEditorByIndex(o);if(s){if(o!==i){let e=this.model.stickyCount;this.model.moveEditor(s,i),this.model.pin(s),this.titleControl.moveEditor(s,o,i,e!==this.model.stickyCount),this.titleControl.pinEditor(s)}(null===t||void 0===t?void 0:t.sticky)&&this.stickEditor(s)}}doMoveOrCopyEditorAcrossGroups(e,t,i,o){var s;let r=null===o||void 0===o?void 0:o.keepCopy;if(!r||e.hasCapability(bt.zt.Singleton)){let i=e.canMove(this.id,t.id);if("string"==typeof i)return this.dialogService.error(i,(0,at.EM)(3322,"Try saving or reverting the editor first and then try again.")),!1}let n=(0,dt.Q)(this,e,(0,rt.A)((0,rt.A)({},i),{},{pinned:!0,sticky:null!==(s=null===i||void 0===i?void 0:i.sticky)&&void 0!==s?s:!r&&this.model.isSticky(e)}));return r||this._onWillMoveEditor.fire({groupId:this.id,editor:e,target:t.id}),t.doOpenEditor(r?e.copy():e,n,o),r||this.doCloseEditor(e,!0,(0,rt.A)((0,rt.A)({},o),{},{context:bt.It.MOVE})),!0}copyEditors(e,t){let i={skipTitleUpdate:this!==t};for(let{editor:o,options:s}of e)this.copyEditor(o,t,s,i);if(i.skipTitleUpdate){let i=e.map(e=>{let{editor:t}=e;return t});t.titleControl.openEditors(i)}}copyEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,(0,rt.A)((0,rt.A)({},o),{},{keepCopy:!0}))}async closeEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0,t=arguments.length>1?arguments[1]:void 0;return this.doCloseEditorWithConfirmationHandling(e,t)}async doCloseEditorWithConfirmationHandling(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return!(!e||await this.handleCloseConfirmation([e]))&&(this.doCloseEditor(e,null===t||void 0===t?void 0:t.preserveFocus,i),!0)}doCloseEditor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.groupsView.activeGroup!==this,i=arguments.length>2?arguments[2]:void 0;null!==i&&void 0!==i&&i.skipTitleUpdate||this.titleControl.beforeCloseEditor(e),this.model.isActive(e)?this.doCloseActiveEditor(t,i):this.doCloseInactiveEditor(e,i),(null===i||void 0===i?void 0:i.skipTitleUpdate)||this.titleControl.closeEditor(e)}doCloseActiveEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.groupsView.activeGroup!==this,t=arguments.length>1?arguments[1]:void 0,i=this.activeEditor,o=!e&&this.shouldRestoreFocus(this.element),s=this.groupsView.partOptions.closeEmptyGroups;if(s&&this.active&&1===this.count){let e=this.groupsView.getGroups(bt.X.MOST_RECENTLY_ACTIVE)[1];e&&(o?e.focus():this.groupsView.activateGroup(e,!0))}i&&this.model.closeEditor(i,null===t||void 0===t?void 0:t.context);let r=this.model.activeEditor;if(r){let i;e&&this.groupsView.activeGroup!==this&&(i=at.Er.PRESERVE);let o={preserveFocus:e,activation:i,ignoreError:null===t||void 0===t?void 0:t.fromError};this.doOpenEditor(r,o,{preserveWindowOrder:!0})}else i&&this.editorPane.closeEditor(i),o&&!s&&this.focus(),this._onDidActiveEditorChange.fire({editor:void 0}),s&&this.groupsView.removeGroup(this,e)}shouldRestoreFocus(e){let t=(0,at.zx)();return t===(0,at.Jx)(e)||(0,at.lS)(t,e)}doCloseInactiveEditor(e,t){this.model.closeEditor(e,null===t||void 0===t?void 0:t.context)}async handleCloseConfirmation(e){if(!e.length)return!1;let t,i=e.shift(),o=this.mapEditorToPendingConfirmation.get(i);o||(o=this.doHandleCloseConfirmation(i),this.mapEditorToPendingConfirmation.set(i,o));try{t=await o}finally{this.mapEditorToPendingConfirmation.delete(i)}return t||this.handleCloseConfirmation(e)}async doHandleCloseConfirmation(e,t){if(!this.shouldConfirmClose(e)||e instanceof bt.Et&&this.model.contains(e.primary)||this.editorPartsView.groups.some(t=>{if(t===this)return!1;let i=t;return!!(i.contains(e,{supportSideBySide:bt.Jt.BOTH})||e instanceof bt.Et&&i.contains(e.primary))}))return!1;let i=ut.ea.CANCEL,o=bt.Kt.EXPLICIT,s=!1;if(!e.hasCapability(bt.zt.Untitled)&&!(null!==t&&void 0!==t&&t.skipAutoSave)&&!e.closeHandler&&(this.filesConfigurationService.getAutoSaveMode(e).mode===bt.n.ON_FOCUS_CHANGE?(s=!0,i=ut.ea.SAVE,o=bt.Kt.FOCUS_CHANGE):at.hM&&(at.yM||at.dM)&&this.filesConfigurationService.getAutoSaveMode(e).mode===bt.n.ON_WINDOW_CHANGE&&(s=!0,i=ut.ea.SAVE,o=bt.Kt.WINDOW_CHANGE)),!s){var r,n;(!this.activeEditor||!this.activeEditor.matches(e))&&await this.doOpenEditor(e),await this.hostService.focus((0,at.$x)(this.element));let t=!1;if("function"==typeof(null===(r=e.closeHandler)||void 0===r?void 0:r.confirm))try{i=await e.closeHandler.confirm([{editor:e,groupId:this.id}])}catch(e){this.logService.error(e),t=!0}if("function"!=typeof(null===(n=e.closeHandler)||void 0===n?void 0:n.confirm)||t){let t;t=e instanceof bt.Et?e.primary.getName():e.getName(),i=await this.fileDialogService.showSaveConfirm([t])}}if(!e.closeHandler&&!this.shouldConfirmClose(e))return i===ut.ea.CANCEL;switch(i){case ut.ea.SAVE:return!await e.save(this.id,{reason:o})&&s?this.doHandleCloseConfirmation(e,{skipAutoSave:!0}):e.isDirty();case ut.ea.DONT_SAVE:try{return await e.revert(this.id),e.isDirty()}catch(t){return this.logService.error(t),await e.revert(this.id,{soft:!0}),e.isDirty()}case ut.ea.CANCEL:return!0}}shouldConfirmClose(e){if(e.closeHandler)try{return e.closeHandler.showConfirm()}catch(e){this.logService.error(e)}return e.isDirty()&&!e.isSaving()}async closeEditors(e,t){if(this.isEmpty)return!0;let i=this.doGetEditorsToClose(e);return!await this.handleCloseConfirmation(i.slice(0))&&(this.doCloseEditors(i,t),!0)}doGetEditorsToClose(e){if(Array.isArray(e))return e;let t=e,i="number"==typeof t.direction,o=this.model.getEditors(i?bt.Ut.SEQUENTIAL:bt.Ut.MOST_RECENTLY_ACTIVE,t);return t.savedOnly?o=o.filter(e=>!e.isDirty()||e.isSaving()):i&&t.except?o=t.direction===bt.Pt.LEFT?o.slice(0,this.model.indexOf(t.except,o)):o.slice(this.model.indexOf(t.except,o)+1):t.except&&(o=o.filter(e=>t.except&&!e.matches(t.except))),o}doCloseEditors(e,t){let i=!1;for(let o of e)this.isActive(o)?i=!0:this.doCloseInactiveEditor(o);i&&this.doCloseActiveEditor(null===t||void 0===t?void 0:t.preserveFocus),e.length&&this.titleControl.closeEditors(e)}closeAllEditors(e){return this.isEmpty?(this.groupsView.partOptions.closeEmptyGroups&&this.groupsView.removeGroup(this),!0):null!==e&&void 0!==e&&e.excludeConfirming?(this.doCloseAllEditors(e),!0):this.handleCloseConfirmation(this.model.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE,e)).then(t=>!t&&(this.doCloseAllEditors(e),!0))}doCloseAllEditors(e){let t=this.model.getEditors(bt.Ut.SEQUENTIAL,e);(null===e||void 0===e?void 0:e.excludeConfirming)&&(t=t.filter(e=>!this.shouldConfirmClose(e)));let i=[];for(let o of t)this.isActive(o)||this.doCloseInactiveEditor(o),i.push(o);this.activeEditor&&i.includes(this.activeEditor)&&this.doCloseActiveEditor(),i.length&&this.titleControl.closeEditors(i)}async replaceEditors(e){let t,i=[];for(let{editor:s,replacement:r,forceReplaceDirty:n,options:a}of e){let e=this.getIndexOfEditor(s);if(e>=0){var o;let d=this.isActive(s);a?a.index=e:a={index:e},a.inactive=!d,a.pinned=null===(o=a.pinned)||void 0===o||o;let l={editor:s,replacement:r,forceReplaceDirty:n,options:a};d?t=l:i.push(l)}}for(let{editor:s,replacement:r,forceReplaceDirty:n,options:a}of i)if(await this.doOpenEditor(r,a),!s.matches(r)){let e=!1;if(n?(this.doCloseEditor(s,!0,{context:bt.It.REPLACE}),e=!0):e=await this.doCloseEditorWithConfirmationHandling(s,{preserveFocus:!0},{context:bt.It.REPLACE}),!e)return}if(t){let e=this.doOpenEditor(t.replacement,t.options);t.editor.matches(t.replacement)||(t.forceReplaceDirty?this.doCloseEditor(t.editor,!0,{context:bt.It.REPLACE}):await this.doCloseEditorWithConfirmationHandling(t.editor,{preserveFocus:!0},{context:bt.It.REPLACE})),await e}}get isLocked(){return this.model.isLocked}lock(e){this.model.lock(e)}createEditorActions(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:at.xb.EditorTitle,o={primary:[],secondary:[]},s=this.activeEditorPane;if(s instanceof dt.s){var r;let n=null!==(r=s.scopedContextKeyService)&&void 0!==r?r:this.scopedContextKeyService,a=e.add(this.menuService.createMenu(i,n,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:0}));t=a.onDidChange,o=(0,at.Xr)(a.getActions({arg:this.resourceContext.get(),shouldForwardArgs:!0}),"navigation",(e,t)=>"navigation"===t&&e.actions.length<=1)}else{let i=e.add(new at.ej);t=i.event,e.add(this.onDidActiveEditorChange(()=>i.fire()))}return{actions:o,onDidChange:t}}updateStyles(){let e=this.isEmpty;this.element.style.backgroundColor=e&&this.getColor(dt.St)||"";let t=this.getColor(dt.Ct)||this.getColor(at.dg);!e&&t?(this.titleContainer.classList.add("title-border-bottom"),this.titleContainer.style.setProperty("--title-border-bottom-color",t)):(this.titleContainer.classList.remove("title-border-bottom"),this.titleContainer.style.removeProperty("--title-border-bottom-color"));let{showTabs:i}=this.groupsView.partOptions;this.titleContainer.style.backgroundColor=this.getColor("multiple"===i?dt.Tt:dt.wt)||"",this.editorContainer.style.backgroundColor=this.getColor(at.yh)||""}get minimumWidth(){return this.editorPane.minimumWidth}get minimumHeight(){return this.editorPane.minimumHeight}get maximumWidth(){return this.editorPane.maximumWidth}get maximumHeight(){return this.editorPane.maximumHeight}get proportionalLayout(){return!this.lastLayout||!(this.lastLayout.width===this.minimumWidth||this.lastLayout.height===this.minimumHeight)}layout(e,t,i,o){this.lastLayout={width:e,height:t,top:i,left:o},this.element.classList.toggle("max-height-478px",t<=478);let s=this.titleControl.layout({container:new at.mx(e,t),available:new at.mx(e,t-this.editorPane.minimumHeight)});this.progressBar.getContainer().style.top="".concat(Math.max(this.titleHeight.offset-2,0),"px");let r=Math.max(0,t-s.height);this.editorContainer.style.height="".concat(r,"px"),this.editorPane.layout({width:e,height:r,top:i+s.height,left:o})}relayout(){if(this.lastLayout){let{width:e,height:t,top:i,left:o}=this.lastLayout;this.layout(e,t,i,o)}}setBoundarySashes(e){this.editorPane.setBoundarySashes(e)}toJSON(){return this.model.serialize()}dispose(){this._disposed=!0,this._onWillDispose.fire(),super.dispose()}};tn=$r=(0,at.Jb)([(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.Nb),(0,at.Yb)(8,at.Yd),(0,at.Yb)(9,at.vb),(0,at.Yb)(10,at.Ed),(0,at.Yb)(11,at.ti),(0,at.Yb)(12,at.El),(0,at.Yb)(13,at.Bl),(0,at.Yb)(14,bt.kt),(0,at.Yb)(15,bt.B),(0,at.Yb)(16,at.Wo),(0,at.Yb)(17,at.mb),(0,at.Yb)(18,dt.B),(0,at.Yb)(19,dt.R),(0,at.Yb)(20,at.zl),(0,at.Yb)(21,at.fs)],tn);var on;function sn(e){return e.getValue("editor.dropIntoEditor.enabled")}function rn(e){return e.shiftKey}(0,at.vE)(),(0,at.Xb)(),(0,at.ca)(),(0,at.oS)(),(0,at.Nn)(),(0,at.Ww)(),(0,at.wj)(),(0,at.iM)(),(0,at.GM)(),(0,at.TM)(),(0,at.i_)(),(0,at.ox)(),(0,at.Mb)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.sp)(),(0,at.Xd)(),(0,at.es)(),(0,at.Ma)(),(0,ut.Um)(),(0,ut.B)(),(0,dt.tt)(),(0,bt.en)(),(0,dt.er)(),(0,bt.Q)(),(0,bt.G)(),(0,bt.At)(),(0,ut.yS)(),(0,ut.rm)(),(0,at.bE)({});var nn=(P=class extends at.ap{get disposed(){return!!this._disposed}constructor(e,t,i,o,s,r,n,a){super(t),this.groupView=e,this.configurationService=i,this.instantiationService=o,this.editorService=s,this.editorGroupService=r,this.treeViewsDragAndDropService=n,this.contextService=a,this.editorTransfer=ut.Bm.getInstance(),this.groupTransfer=ut.Bm.getInstance(),this.treeItemsTransfer=ut.Bm.getInstance(),this.cleanupOverlayScheduler=this._register(new at.Aw(()=>this.dispose(),300)),this.enableDropIntoEditor=sn(this.configurationService)&&this.isDropIntoActiveEditorEnabled(),this.create()}create(){let e=this.getOverlayOffsetHeight(),t=this.container=(0,at.px)("div",{id:on.OVERLAY_ID});t.style.top="".concat(e,"px"),this.groupView.element.appendChild(t),this.groupView.element.classList.add("dragged-over"),this._register((0,at.kj)(()=>{t.remove(),this.groupView.element.classList.remove("dragged-over")})),this.overlay=(0,at.px)(".editor-group-overlay-indicator"),t.appendChild(this.overlay),this.enableDropIntoEditor&&(this.dropIntoPromptElement=(0,at.Pn)((0,at.EM)(3315,"Hold __{0}__ to drop into editor",at.pM?"\u21e7":"Shift"),{}),this.dropIntoPromptElement.classList.add("editor-group-overlay-drop-into-prompt"),this.overlay.appendChild(this.dropIntoPromptElement)),this.registerListeners(t),this.updateStyles()}updateStyles(){let e=(0,at.UM)(this.overlay);e.style.backgroundColor=this.getColor(dt._t)||"";let t=this.getColor(at.ug);if(e.style.outlineColor=t||"",e.style.outlineOffset=t?"-2px":"",e.style.outlineStyle=t?"dashed":"",e.style.outlineWidth=t?"2px":"",this.dropIntoPromptElement){var i,o;this.dropIntoPromptElement.style.backgroundColor=null!==(i=this.getColor(dt.vt))&&void 0!==i?i:"",this.dropIntoPromptElement.style.color=null!==(o=this.getColor(dt.bt))&&void 0!==o?o:"";let e=this.getColor(dt.yt);e?(this.dropIntoPromptElement.style.borderWidth="1px",this.dropIntoPromptElement.style.borderStyle="solid",this.dropIntoPromptElement.style.borderColor=e):this.dropIntoPromptElement.style.borderWidth="0"}}registerListeners(e){this._register(new at.hx(e,{onDragOver:e=>{if(this.enableDropIntoEditor&&rn(e))return void this.dispose();let t=this.groupTransfer.hasData(ut.F.prototype),i=this.editorTransfer.hasData(ut.I.prototype);!i&&!t&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy");let o=!0;if(t)o=this.isCopyOperation(e);else if(i){let t=this.editorTransfer.getData(ut.I.prototype);Array.isArray(t)&&t.length>0&&(o=this.isCopyOperation(e,t[0].identifier))}if(!o){let e=this.findSourceGroupView();if(e===this.groupView&&(t||i&&e.count<2))return void this.hideOverlay()}let s=!!this.editorGroupService.partOptions.splitOnDragAndDrop;this.isToggleSplitOperation(e)&&(s=!s),this.positionOverlay(e.offsetX,e.offsetY,t,s),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:e=>this.dispose(),onDragEnd:e=>this.dispose(),onDrop:e=>{at.gx.stop(e,!0),this.dispose(),this.currentDropOperation&&this.handleDrop(e,this.currentDropOperation.splitDirection)}})),this._register((0,at.Sx)(e,at._x.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}isDropIntoActiveEditorEnabled(){var e;return!(null===(e=this.groupView.activeEditor)||void 0===e||!e.hasCapability(bt.zt.CanDropIntoEditor))}findSourceGroupView(){if(this.groupTransfer.hasData(ut.F.prototype)){let e=this.groupTransfer.getData(ut.F.prototype);if(Array.isArray(e)&&e.length>0)return this.editorGroupService.getGroup(e[0].identifier)}else if(this.editorTransfer.hasData(ut.I.prototype)){let e=this.editorTransfer.getData(ut.I.prototype);if(Array.isArray(e)&&e.length>0)return this.editorGroupService.getGroup(e[0].identifier.groupId)}}async handleDrop(e,t){let i=()=>{let e;return e="number"==typeof t?this.editorGroupService.addGroup(this.groupView,t):this.groupView,e};if(this.groupTransfer.hasData(ut.F.prototype)){let i=this.groupTransfer.getData(ut.F.prototype);if(Array.isArray(i)&&i.length>0){let o=this.editorGroupService.getGroup(i[0].identifier);if(o){if("number"!=typeof t&&o===this.groupView)return;let i;if("number"==typeof t)i=this.isCopyOperation(e)?this.editorGroupService.copyGroup(o,this.groupView,t):this.editorGroupService.moveGroup(o,this.groupView,t);else{let t;this.isCopyOperation(e)&&(t={mode:bt.Z.COPY_EDITORS}),this.editorGroupService.mergeGroup(o,this.groupView,t)}i&&this.editorGroupService.activateGroup(i)}this.groupTransfer.clearData(ut.F.prototype)}}else if(this.editorTransfer.hasData(ut.I.prototype)){let o=this.editorTransfer.getData(ut.I.prototype);if(Array.isArray(o)&&o.length>0){let s=o,r=o[0].identifier,n=this.editorGroupService.getGroup(r.groupId);if(n){let o,a=this.isCopyOperation(e,r);if(this.editorGroupService.partOptions.closeEmptyGroups&&1===n.count&&"number"==typeof t&&!a)o=this.editorGroupService.moveGroup(n,this.groupView,t);else{if(o=i(),n===o)return;let e=(0,dt.nt)(this.groupView,s.map(e=>e.identifier.editor));a?n.copyEditors(e,o):n.moveEditors(e,o)}o.focus()}this.editorTransfer.clearData(ut.I.prototype)}}else if(this.treeItemsTransfer.hasData(ut.tm.prototype)){let e=this.treeItemsTransfer.getData(ut.tm.prototype);if(Array.isArray(e)&&e.length>0){let t=[];for(let i of e){let e=await this.treeViewsDragAndDropService.removeDragOperationTransfer(i.identifier);if(e){let i=await(0,ut.R)(e);t.push(...i.map(e=>(0,rt.A)((0,rt.A)({},e),{},{options:(0,rt.A)((0,rt.A)({},e.options),{},{pinned:!0})})))}}t.length&&this.editorService.openEditors(t,i(),{validateTrust:!0})}this.treeItemsTransfer.clearData(ut.tm.prototype)}else this.instantiationService.createInstance(ut.L,{allowWorkspaceOpen:!at._M||(0,at.as)(this.contextService.getWorkspace())}).handleDrop(e,(0,at.$x)(this.groupView.element),()=>i(),e=>null===e||void 0===e?void 0:e.focus())}isCopyOperation(e,t){return(null===t||void 0===t||!t.editor.hasCapability(bt.zt.Singleton))&&(e.ctrlKey&&!at.pM||e.altKey&&at.pM)}isToggleSplitOperation(e){return e.altKey&&!at.pM||e.shiftKey&&at.pM}positionOverlay(e,t,i,o){let s,r,n="right"===this.editorGroupService.partOptions.openSideBySideDirection,a=this.groupView.element.clientWidth,d=this.groupView.element.clientHeight-this.getOverlayOffsetHeight();o?(s=i&&n?.3:.1,r=i?n?.1:.3:.1):(s=0,r=0);let l,c=a*s,h=d*r,u=a/3,g=d/3;switch(l=e>c&&e<a-c&&t>h&&t<d-h?void 0:n?e<u?bt.K.LEFT:e>2*u?bt.K.RIGHT:t<d/2?bt.K.UP:bt.K.DOWN:t<g?bt.K.UP:t>2*g?bt.K.DOWN:e<a/2?bt.K.LEFT:bt.K.RIGHT,l){case bt.K.UP:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case bt.K.DOWN:this.doPositionOverlay({top:"50%",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case bt.K.LEFT:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;case bt.K.RIGHT:this.doPositionOverlay({top:"0",left:"50%",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;default:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),this.toggleDropIntoPrompt(!0)}let p=(0,at.UM)(this.overlay);p.style.opacity="1",setTimeout(()=>p.classList.add("overlay-move-transition"),0),this.currentDropOperation={splitDirection:l}}doPositionOverlay(e){let[t,i]=(0,at.HM)(this.container,this.overlay),o=this.getOverlayOffsetHeight();t.style.height=o?"calc(100% - ".concat(o,"px)"):"100%",i.style.top=e.top,i.style.left=e.left,i.style.width=e.width,i.style.height=e.height}getOverlayOffsetHeight(){return this.groupView.isEmpty||"multiple"!==this.editorGroupService.partOptions.showTabs?0:this.groupView.titleHeight.offset}hideOverlay(){let e=(0,at.UM)(this.overlay);this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),e.style.opacity="0",e.classList.remove("overlay-move-transition"),this.currentDropOperation=void 0}toggleDropIntoPrompt(e){this.dropIntoPromptElement&&(this.dropIntoPromptElement.style.opacity=e?"1":"0")}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}},{_:on=P},{_:P.OVERLAY_ID="monaco-workbench-editor-drop-overlay"},P);nn=on=(0,at.Jb)([(0,at.Yb)(1,at.Yd),(0,at.Yb)(2,at.r_),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,bt.kt),(0,at.Yb)(5,bt.W),(0,at.Yb)(6,ut.vS),(0,at.Yb)(7,at.ja)],nn);var an=class extends at.ap{constructor(e,t,i,o,s,r){super(o),this.container=e,this.delegate=t,this.editorGroupService=i,this.configurationService=s,this.instantiationService=r,this.counter=0,this.editorTransfer=ut.Bm.getInstance(),this.groupTransfer=ut.Bm.getInstance(),this.registerListeners()}get overlay(){if(this._overlay&&!this._overlay.disposed)return this._overlay}registerListeners(){this._register((0,at.Sx)(this.container,at._x.DRAG_ENTER,e=>this.onDragEnter(e))),this._register((0,at.Sx)(this.container,at._x.DRAG_LEAVE,()=>this.onDragLeave()));for(let e of[this.container,(0,at.$x)(this.container)])this._register((0,at.Sx)(e,at._x.DRAG_END,()=>this.onDragEnd()))}onDragEnter(e){if(sn(this.configurationService)&&rn(e))return;if(this.counter++,!this.editorTransfer.hasData(ut.I.prototype)&&!this.groupTransfer.hasData(ut.F.prototype)&&e.dataTransfer){let t=at.jb.as(ut.zm.DragAndDropContribution).getAll(),i=Array.from(t).map(e=>e.dataFormatKey);if(!(0,ut.Vm)(e,at.oa.FILES,ut.Rm.FILES,at.oa.RESOURCES,ut.Rm.EDITORS,...i))return void(e.dataTransfer.dropEffect="none")}this.updateContainer(!0);let t=e.target;if(t&&(this.overlay&&!this.overlay.contains(t)&&this.disposeOverlay(),!this.overlay)){let e=this.findTargetGroupView(t);e&&(this._overlay=this.instantiationService.createInstance(nn,e))}}onDragLeave(){this.counter--,0===this.counter&&this.updateContainer(!1)}onDragEnd(){this.counter=0,this.updateContainer(!1),this.disposeOverlay()}findTargetGroupView(e){return this.editorGroupService.groups.find(t=>{var i,o;return(0,at.lS)(e,t.element)||(null===(i=(o=this.delegate).containsGroup)||void 0===i?void 0:i.call(o,t))})}updateContainer(e){this.container.classList.toggle("dragged-over",e)}dispose(){super.dispose(),this.disposeOverlay()}disposeOverlay(){this.overlay&&(this.overlay.dispose(),this._overlay=void 0)}};an=(0,at.Jb)([(0,at.Yb)(2,bt.W),(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,at.r_),(0,at.Yb)(5,at.rx)],an),(0,at.oS)(),(0,at.Xt)(),(0,at.sj)(),(0,at.wj)(),(0,at.tn)();var dn={targetWidth:900,leftMarginRatio:.1909,rightMarginRatio:.1909},ln={type:"distribute"};function cn(e){let t=(0,at.px)(".centered-layout-margin");return t.style.height="100%",e&&(t.style.backgroundColor=e.toString()),{element:t,layout:()=>{},minimumSize:60,maximumSize:1/0,onDidChange:at.tj.None}}var hn=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,rt.A)({},dn),o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.container=e,this.view=t,this.state=i,this.centeredLayoutFixedWidth=o,this.lastLayoutPosition={width:0,height:0,left:0,top:0},this.didLayout=!1,this.splitViewDisposables=new at.gj,this._boundarySashes={},this.container.appendChild(this.view.element),this.container.style.overflow="hidden"}get minimumWidth(){return this.splitView?this.splitView.minimumSize:this.view.minimumWidth}get maximumWidth(){return this.splitView?this.splitView.maximumSize:this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get onDidChange(){return this.view.onDidChange}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitView&&(this.splitView.orthogonalStartSash=e.top,this.splitView.orthogonalEndSash=e.bottom)}layout(e,t,i,o){this.lastLayoutPosition={width:e,height:t,top:i,left:o},this.splitView?(this.splitView.layout(e,this.lastLayoutPosition),(!this.didLayout||this.centeredLayoutFixedWidth)&&this.resizeSplitViews()):this.view.layout(e,t,i,o),this.didLayout=!0}resizeSplitViews(){if(this.splitView)if(this.centeredLayoutFixedWidth){let e=Math.min(this.lastLayoutPosition.width,this.state.targetWidth),t=(this.lastLayoutPosition.width-e)/2;this.splitView.resizeView(0,Math.floor(t)),this.splitView.resizeView(1,e),this.splitView.resizeView(2,Math.ceil(t))}else{let e=this.state.leftMarginRatio*this.lastLayoutPosition.width,t=this.state.rightMarginRatio*this.lastLayoutPosition.width,i=this.lastLayoutPosition.width-e-t;this.splitView.resizeView(0,e),this.splitView.resizeView(1,i),this.splitView.resizeView(2,t)}}setFixedWidth(e){this.centeredLayoutFixedWidth=e,this.splitView&&(this.updateState(),this.resizeSplitViews())}updateState(){this.splitView&&(this.state.targetWidth=this.splitView.getViewSize(1),this.state.leftMarginRatio=this.splitView.getViewSize(0)/this.lastLayoutPosition.width,this.state.rightMarginRatio=this.splitView.getViewSize(2)/this.lastLayoutPosition.width)}isActive(){return!!this.splitView}styles(e){this.style=e,this.splitView&&this.emptyViews&&(this.splitView.style(this.style),this.emptyViews[0].element.style.backgroundColor=this.style.background.toString(),this.emptyViews[1].element.style.backgroundColor=this.style.background.toString())}activate(e){var t,i;if(e!==this.isActive())if(e){this.view.element.remove(),this.splitView=new at.Yt(this.container,{inverseAltBehavior:!0,orientation:at.Zt.HORIZONTAL,styles:this.style}),this.splitView.orthogonalStartSash=this.boundarySashes.top,this.splitView.orthogonalEndSash=this.boundarySashes.bottom,this.splitViewDisposables.add(this.splitView.onDidSashChange(()=>{this.splitView&&this.updateState()})),this.splitViewDisposables.add(this.splitView.onDidSashReset(()=>{this.state=(0,rt.A)({},dn),this.resizeSplitViews()})),this.splitView.layout(this.lastLayoutPosition.width,this.lastLayoutPosition);let e=this.style?this.style.background:void 0;this.emptyViews=[cn(e),cn(e)],this.splitView.addView(this.emptyViews[0],ln,0),this.splitView.addView(function(e,t){return{element:e.element,get maximumSize(){return e.maximumWidth},get minimumSize(){return e.minimumWidth},onDidChange:at.tj.map(e.onDidChange,e=>e&&e.width),layout:(i,o,s)=>{var r,n;return e.layout(i,t(),null!==(r=null===s||void 0===s?void 0:s.top)&&void 0!==r?r:0,(null!==(n=null===s||void 0===s?void 0:s.left)&&void 0!==n?n:0)+o)}}}(this.view,()=>this.lastLayoutPosition.height),ln,1),this.splitView.addView(this.emptyViews[1],ln,2),this.resizeSplitViews()}else null!==(t=this.splitView)&&void 0!==t&&t.el.remove(),this.splitViewDisposables.clear(),null!==(i=this.splitView)&&void 0!==i&&i.dispose(),this.splitView=void 0,this.emptyViews=void 0,this.container.appendChild(this.view.element),this.view.layout(this.lastLayoutPosition.width,this.lastLayoutPosition.height,this.lastLayoutPosition.top,this.lastLayoutPosition.left)}isDefault(e){return this.centeredLayoutFixedWidth?e.targetWidth===dn.targetWidth:e.leftMarginRatio===dn.leftMarginRatio&&e.rightMarginRatio===dn.rightMarginRatio}dispose(){this.splitViewDisposables.dispose(),this.splitView&&(this.splitView=void this.splitView.dispose())}};(0,at.Xb)(),(0,at.Xd)(),(0,gt.pt)(),(0,at.oS)(),(0,at.sj)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,bt.Q)(),(0,at.ox)(),(0,bt.en)(),(0,dt.er)(),(0,at.AN)(),(0,dt.tt)(),(0,at.i_)(),(0,at.wj)(),(0,at.Vo)(),(0,at.Lo)(),(0,ut.ra)(),(0,at.kv)(),(0,at.aP)(),(0,pt.W)(),(0,pt.st)(),(0,at.GM)(),(0,ut.B)(),(0,at.Ww)(),(0,dt.q)(),(0,dt.z)(),(0,at.Pb)(),(0,at.au)(),(0,pt.tr)(),(0,at.SE)(),(0,at.Xt)(),(0,at.tn)();var un,gn=class{constructor(){this.element=(0,at.px)(".grid-view-container"),this._onDidChange=new at.ij,this.onDidChange=this._onDidChange.event}get minimumWidth(){return this.gridWidget?this.gridWidget.minimumWidth:0}get maximumWidth(){return this.gridWidget?this.gridWidget.maximumWidth:1/0}get minimumHeight(){return this.gridWidget?this.gridWidget.minimumHeight:0}get maximumHeight(){return this.gridWidget?this.gridWidget.maximumHeight:1/0}get gridWidget(){return this._gridWidget}set gridWidget(e){this.element.textContent="",e?(this.element.appendChild(e.element),this._onDidChange.input=e.onDidChange):this._onDidChange.input=at.tj.None,this._gridWidget=e}layout(e,t,i,o){var s;null===(s=this.gridWidget)||void 0===s||s.layout(e,t,i,o)}dispose(){this._onDidChange.dispose()}},pn=(F=class extends gt.ft{constructor(e,t,i,o,s,r,n,a,d,l,c){super(t,{hasTitle:!1},r,a,d),this.editorPartsView=e,this.groupsLabel=i,this.windowId=o,this.instantiationService=s,this.configurationService=n,this.hostService=l,this.contextKeyService=c,this._onDidFocus=this._register(new at.ej),this.onDidFocus=this._onDidFocus.event,this._onDidLayout=this._register(new at.ej),this.onDidLayout=this._onDidLayout.event,this._onDidChangeActiveGroup=this._register(new at.ej),this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidChangeGroupIndex=this._register(new at.ej),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLabel=this._register(new at.ej),this.onDidChangeGroupLabel=this._onDidChangeGroupLabel.event,this._onDidChangeGroupLocked=this._register(new at.ej),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidChangeGroupMaximized=this._register(new at.ej),this.onDidChangeGroupMaximized=this._onDidChangeGroupMaximized.event,this._onDidActivateGroup=this._register(new at.ej),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidAddGroup=this._register(new at.rj),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new at.rj),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new at.ej),this.onDidMoveGroup=this._onDidMoveGroup.event,this.onDidSetGridWidget=this._register(new at.ej),this._onDidChangeSizeConstraints=this._register(new at.ij),this.onDidChangeSizeConstraints=at.tj.any(this.onDidSetGridWidget.event,this._onDidChangeSizeConstraints.event),this._onDidScroll=this._register(new at.ij),this.onDidScroll=at.tj.any(this.onDidSetGridWidget.event,this._onDidScroll.event),this._onDidChangeEditorPartOptions=this._register(new at.ej),this.onDidChangeEditorPartOptions=this._onDidChangeEditorPartOptions.event,this._onWillDispose=this._register(new at.ej),this.onWillDispose=this._onWillDispose.event,this.workspaceMemento=this.getMemento(at.Ro.WORKSPACE,at.zo.USER),this.profileMemento=this.getMemento(at.Ro.PROFILE,at.zo.MACHINE),this.groupViews=new Map,this.mostRecentActiveGroups=[],this.container=(0,at.px)(".content"),this.gridWidgetDisposables=this._register(new at.gj),this.gridWidgetView=this._register(new gn),this.enforcedPartOptions=[],this.top=0,this.left=0,this.sideGroup={openEditor:(e,t)=>{let[i]=this.scopedInstantiationService.invokeFunction(i=>(0,Et.a)(i,{editor:e,options:t},-2));return i.openEditor(e,t)}},this._isReady=!1,this.whenReadyPromise=new at.xw,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new at.xw,this.whenRestored=this.whenRestoredPromise.p,this._willRestoreState=!1,this.priority=at.qt.High,this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.container)),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new at.iu([at.Nb,this.scopedContextKeyService]))),this._partOptions=(0,dt.$)(this.configurationService,this.themeService),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.themeService.onDidFileIconThemeChange(()=>this.handleChangedPartOptions())),this._register(this.onDidChangeMementoValue(at.Ro.WORKSPACE,this._store)(e=>this.onDidChangeMementoState(e)))}onConfigurationUpdated(e){(0,dt.et)(e)&&this.handleChangedPartOptions()}handleChangedPartOptions(){let e=this._partOptions,t=(0,dt.$)(this.configurationService,this.themeService);for(let i of this.enforcedPartOptions)Object.assign(t,i);this._partOptions=t,this._onDidChangeEditorPartOptions.fire({oldPartOptions:e,newPartOptions:t})}get partOptions(){return this._partOptions}enforcePartOptions(e){return this.enforcedPartOptions.push(e),this.handleChangedPartOptions(),(0,at.kj)(()=>{this.enforcedPartOptions.splice(this.enforcedPartOptions.indexOf(e),1),this.handleChangedPartOptions()})}get contentDimension(){return this._contentDimension}get activeGroup(){return this._activeGroup}get groups(){return Array.from(this.groupViews.values())}get count(){return this.groupViews.size}get orientation(){return this.gridWidget&&this.gridWidget.orientation===at.Zt.VERTICAL?bt.J.VERTICAL:bt.J.HORIZONTAL}get isReady(){return this._isReady}get hasRestorableState(){return!!this.workspaceMemento[un.EDITOR_PART_UI_STATE_STORAGE_KEY]}get willRestoreState(){return this._willRestoreState}getGroups(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt.X.CREATION_TIME){case bt.X.CREATION_TIME:return this.groups;case bt.X.MOST_RECENTLY_ACTIVE:return(0,at.wN)([...(0,at._N)(this.mostRecentActiveGroups.map(e=>this.getGroup(e))),...this.groups]);case bt.X.GRID_APPEARANCE:{let e=[];return this.gridWidget&&this.fillGridNodes(e,this.gridWidget.getViews()),e}}}fillGridNodes(e,t){Ht(t)?t.children.forEach(t=>this.fillGridNodes(e,t)):e.push(t.view)}hasGroup(e){return this.groupViews.has(e)}getGroup(e){return this.groupViews.get(e)}findGroup(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeGroup,i=arguments.length>2?arguments[2]:void 0;if("number"==typeof e.direction)return this.doFindGroupByDirection(e.direction,t,i);if("number"==typeof e.location)return this.doFindGroupByLocation(e.location,t,i);throw Error("invalid arguments")}doFindGroupByDirection(e,t,i){let o=this.assertGroupView(t),s=this.gridWidget.getNeighborViews(o,this.toGridViewDirection(e),i);return s.sort((e,t)=>this.mostRecentActiveGroups.indexOf(e.id)-this.mostRecentActiveGroups.indexOf(t.id)),s[0]}doFindGroupByLocation(e,t,i){let o=this.assertGroupView(t),s=this.getGroups(bt.X.GRID_APPEARANCE),r=s.indexOf(o);switch(e){case bt.q.FIRST:return s[0];case bt.q.LAST:return s[s.length-1];case bt.q.NEXT:{let e=s[r+1];return!e&&i&&(e=this.doFindGroupByLocation(bt.q.FIRST,t)),e}case bt.q.PREVIOUS:{let e=s[r-1];return!e&&i&&(e=this.doFindGroupByLocation(bt.q.LAST,t)),e}}}activateGroup(e,t){let i=this.assertGroupView(e);return this.doSetGroupActive(i),t||this.hostService.moveTop((0,at.$x)(this.element)),i}restoreGroup(e){let t=this.assertGroupView(e);return this.doRestoreGroup(t),t}getSize(e){let t=this.assertGroupView(e);return this.gridWidget.getViewSize(t)}setSize(e,t){let i=this.assertGroupView(e);this.gridWidget.resizeView(i,t)}arrangeGroups(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeGroup;if(this.count<2||!this.gridWidget)return;let i=this.assertGroupView(t);switch(e){case bt.Y.EVEN:this.gridWidget.distributeViewSizes();break;case bt.Y.MAXIMIZE:if(this.groups.length<2)return;this.gridWidget.maximizeView(i),i.focus();break;case bt.Y.EXPAND:this.gridWidget.expandView(i)}}toggleMaximizeGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeGroup;this.hasMaximizedGroup()?this.unmaximizeGroup():this.arrangeGroups(bt.Y.MAXIMIZE,e)}toggleExpandGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeGroup;this.isGroupExpanded(this.activeGroup)?this.arrangeGroups(bt.Y.EVEN):this.arrangeGroups(bt.Y.EXPAND,e)}unmaximizeGroup(){this.gridWidget.exitMaximizedView(),this._activeGroup.focus()}hasMaximizedGroup(){return this.gridWidget.hasMaximizedView()}isGroupMaximized(e){return this.gridWidget.isViewMaximized(e)}isGroupExpanded(e){return this.gridWidget.isViewExpanded(e)}setGroupOrientation(e){if(!this.gridWidget)return;let t=e===bt.J.HORIZONTAL?at.Zt.HORIZONTAL:at.Zt.VERTICAL;this.gridWidget.orientation!==t&&(this.gridWidget.orientation=t)}applyLayout(e){let t=this.shouldRestoreFocus(this.container),i=0;!function e(t){for(let o of t)Array.isArray(o.groups)?e(o.groups):i++}(e.groups);let o=this.getGroups(bt.X.GRID_APPEARANCE);if(i<o.length){let e=o[i-1];o.forEach((t,o)=>{o>=i&&this.mergeGroup(t,e)}),o=this.getGroups(bt.X.GRID_APPEARANCE)}let s=this.activeGroup,r=ai({orientation:this.toGridViewOrientation(e.orientation,this.isTwoDimensionalGrid()?this.gridWidget.orientation:Nt(this.gridWidget.orientation)),groups:e.groups});this.doApplyGridState(r,s.id,o),t&&this._activeGroup.focus()}getLayout(){let e=this.gridWidget.serialize();return{orientation:e.orientation===at.Zt.HORIZONTAL?bt.J.HORIZONTAL:bt.J.VERTICAL,groups:this.serializedNodeToGroupLayoutArgument(e.root).groups}}serializedNodeToGroupLayoutArgument(e){return"branch"===e.type?{size:e.size,groups:e.data.map(e=>this.serializedNodeToGroupLayoutArgument(e))}:{size:e.size}}shouldRestoreFocus(e){return!!e&&((0,at.zx)()===e.ownerDocument.body||(0,at.uS)(e))}isTwoDimensionalGrid(){let e=this.gridWidget.getViews();return!!Ht(e)&&e.children.some(e=>Ht(e))}addGroup(e,t,i){let o,s=this.assertGroupView(e);if(s.groupsView===this){let e=this.shouldRestoreFocus(s.element),r=this.groupViews.size>1&&this.isGroupExpanded(s);o=this.doCreateGroupView(i),this.gridWidget.addView(o,this.getSplitSizingStyle(),s,this.toGridViewDirection(t)),this.updateContainer(),this._onDidAddGroup.fire(o),this.notifyGroupIndexChange(),r&&this.arrangeGroups(bt.Y.EXPAND,o),e&&s.focus()}else o=s.groupsView.addGroup(s,t,i);return o}getSplitSizingStyle(){switch(this._partOptions.splitSizing){case"distribute":return Qt.Distribute;case"split":return Qt.Split;default:return Qt.Auto}}doCreateGroupView(e,t){let i;i=e instanceof tn?tn.createCopy(e,this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t):(0,ut.oa)(e)?tn.createFromSerialized(e,this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t):tn.createNew(this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t),this.groupViews.set(i.id,i);let o=new at.gj;return o.add(i.onDidFocus(()=>{this.doSetGroupActive(i),this._onDidFocus.fire()})),o.add(i.onDidModelChange(e=>{switch(e.kind){case bt.Wt.GROUP_LOCKED:this._onDidChangeGroupLocked.fire(i);break;case bt.Wt.GROUP_INDEX:this._onDidChangeGroupIndex.fire(i);break;case bt.Wt.GROUP_LABEL:this._onDidChangeGroupLabel.fire(i)}})),o.add(i.onDidActiveEditorChange(()=>{this.updateContainer()})),at.tj.once(i.onWillDispose)(()=>{(0,at.Sj)(o),this.groupViews.delete(i.id),this.doUpdateMostRecentActive(i)}),i}doSetGroupActive(e){if(this._activeGroup!==e){let t=this._activeGroup;this._activeGroup=e,this.doUpdateMostRecentActive(e,!0),t&&!t.disposed&&t.setActive(!1),e.setActive(!0),this.doRestoreGroup(e),this._onDidChangeActiveGroup.fire(e)}this._onDidActivateGroup.fire(e)}doRestoreGroup(e){if(this.gridWidget)try{this.hasMaximizedGroup()&&!this.isGroupMaximized(e)&&this.unmaximizeGroup();let t=this.gridWidget.getViewSize(e);(t.width===e.minimumWidth||t.height===e.minimumHeight)&&this.arrangeGroups(bt.Y.EXPAND,e)}catch(t){}}doUpdateMostRecentActive(e,t){let i=this.mostRecentActiveGroups.indexOf(e.id);-1!==i&&this.mostRecentActiveGroups.splice(i,1),t&&this.mostRecentActiveGroups.unshift(e.id)}toGridViewDirection(e){switch(e){case bt.K.UP:return Yt.Up;case bt.K.DOWN:return Yt.Down;case bt.K.LEFT:return Yt.Left;case bt.K.RIGHT:return Yt.Right}}toGridViewOrientation(e,t){return"number"==typeof e?e===bt.J.HORIZONTAL?at.Zt.HORIZONTAL:at.Zt.VERTICAL:t}removeGroup(e,t){let i=this.assertGroupView(e);1!==this.count&&(i.isEmpty?this.doRemoveEmptyGroup(i,t):this.doRemoveGroupWithEditors(i))}doRemoveGroupWithEditors(e){let t,i=this.getGroups(bt.X.MOST_RECENTLY_ACTIVE);t=this._activeGroup===e?i[1]:i[0],this.mergeGroup(e,t)}doRemoveEmptyGroup(e,t){let i=!t&&this.shouldRestoreFocus(this.container);if(this._activeGroup===e){let e=this.getGroups(bt.X.MOST_RECENTLY_ACTIVE)[1];this.doSetGroupActive(e)}this.gridWidget.removeView(e,this.getSplitSizingStyle()),e.dispose(),i&&this._activeGroup.focus(),this.notifyGroupIndexChange(),this.updateContainer(),this._onDidRemoveGroup.fire(e)}moveGroup(e,t,i){let o=this.assertGroupView(e),s=this.assertGroupView(t);if(o.id===s.id)throw Error("Cannot move group into its own");let r,n=this.shouldRestoreFocus(o.element);return o.groupsView===s.groupsView?(this.gridWidget.moveView(o,this.getSplitSizingStyle(),s,this.toGridViewDirection(i)),r=o):(r=s.groupsView.addGroup(s,i,o),o.closeAllEditors(),this.removeGroup(o,n)),n&&r.focus(),this._onDidMoveGroup.fire(r),this.notifyGroupIndexChange(),r}copyGroup(e,t,i){let o=this.assertGroupView(e),s=this.assertGroupView(t),r=this.shouldRestoreFocus(o.element),n=this.addGroup(s,i,o);return r&&n.focus(),n}mergeGroup(e,t,i){let o=this.assertGroupView(e),s=this.assertGroupView(t),r=[],n=i&&"number"==typeof i.index?i.index:s.count;for(let d of o.editors){let e,t=!o.isActive(d)||this._activeGroup!==o;s.contains(d)&&(s.isSticky(d)||null!==i&&void 0!==i&&i.preserveExistingIndex)||(e=n,n++),r.push({editor:d,options:{index:e,inactive:t,preserveFocus:t}})}let a=!0;return(null===i||void 0===i?void 0:i.mode)===bt.Z.COPY_EDITORS?o.copyEditors(r,s):a=o.moveEditors(r,s),o.isEmpty&&!o.disposed&&this.removeGroup(o,!0),a}mergeAllGroups(e,t){let i=this.assertGroupView(e),o=!0;for(let s of this.getGroups(bt.X.MOST_RECENTLY_ACTIVE))s!==i&&(this.mergeGroup(s,i,t)||(o=!1));return o}assertGroupView(e){let t;if(t="number"==typeof e?this.editorPartsView.getGroup(e):e,!t)throw Error("Invalid editor group provided!");return t}createEditorDropTarget(e,t){return(0,at.WM)((0,at._S)(e)),this.scopedInstantiationService.createInstance(an,e,t)}get minimumWidth(){return Math.min(this.centeredLayoutWidget.minimumWidth,this.layoutService.getMaximumEditorDimensions(this.layoutService.getContainer((0,at.$x)(this.container))).width)}get maximumWidth(){return this.centeredLayoutWidget.maximumWidth}get minimumHeight(){return Math.min(this.centeredLayoutWidget.minimumHeight,this.layoutService.getMaximumEditorDimensions(this.layoutService.getContainer((0,at.$x)(this.container))).height)}get maximumHeight(){return this.centeredLayoutWidget.maximumHeight}get snap(){return"center"===this.layoutService.getPanelAlignment()}get onDidChange(){return at.tj.any(this.centeredLayoutWidget.onDidChange,this.onDidSetGridWidget.event)}get gridSeparatorBorder(){return this.theme.getColor(dt.xt)||this.theme.getColor(at.dg)||at.Ev.transparent}updateStyles(){this.container.style.backgroundColor=this.getColor(at.yh)||"";let e={separatorBorder:this.gridSeparatorBorder,background:this.theme.getColor(dt.Dt)||at.Ev.transparent};this.gridWidget.style(e),this.centeredLayoutWidget.styles(e)}createContentArea(e,t){return this.element=e,this.windowId!==at.wE.vscodeWindowId&&this.container.classList.add("auxiliary"),e.appendChild(this.container),this._willRestoreState=!t||t.restorePreviousState,this.doCreateGridControl(),this.centeredLayoutWidget=this._register(new hn(this.container,this.gridWidgetView,this.profileMemento[un.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY],this._partOptions.centeredLayoutFixedWidth)),this._register(this.onDidChangeEditorPartOptions(e=>{var t;return this.centeredLayoutWidget.setFixedWidth(null!==(t=e.newPartOptions.centeredLayoutFixedWidth)&&void 0!==t&&t)})),this.setupDragAndDropSupport(e,this.container),this.handleContextKeys(),this.whenReadyPromise.complete(),this._isReady=!0,at.Dw.settled(this.groups.map(e=>e.whenRestored)).finally(()=>{this.whenRestoredPromise.complete()}),this.container}handleContextKeys(){pt.Sn.bindTo(this.scopedContextKeyService).set(this.windowId!==at.wE.vscodeWindowId);let e=pt._n.bindTo(this.scopedContextKeyService),t=pt.gn.bindTo(this.scopedContextKeyService),i=()=>{this.count>1?e.set(!0):e.reset(),this.hasMaximizedGroup()?t.set(!0):t.reset()};i(),this._register(this.onDidAddGroup(()=>i())),this._register(this.onDidRemoveGroup(()=>i())),this._register(this.onDidChangeGroupMaximized(()=>i()))}setupDragAndDropSupport(e,t){this._register(this.createEditorDropTarget(t,Object.create(null)));let i=(0,at.px)(".drop-block-overlay");e.appendChild(i),this._register((0,at.xx)(i,()=>i.classList.remove("visible"))),this._register(ut.P.INSTANCE.registerTarget(this.element,{onDragStart:e=>i.classList.add("visible"),onDragEnd:e=>i.classList.remove("visible")}));let o,s,r,n,a=e=>{this.layoutService.isVisible(pt.V.PANEL_PART)||e!==this.layoutService.getPanelPosition()?!this.layoutService.isVisible(pt.V.AUXILIARYBAR_PART)&&e===(this.layoutService.getSideBarPosition()===pt.H.RIGHT?pt.H.LEFT:pt.H.RIGHT)&&this.layoutService.setPartHidden(!1,pt.V.AUXILIARYBAR_PART):this.layoutService.setPartHidden(!1,pt.V.PANEL_PART)},d=()=>{o&&(o=void clearTimeout(o)),s&&(s=void clearTimeout(s))};this._register(ut.P.INSTANCE.registerTarget(i,{onDragOver:e=>{at.gx.stop(e.eventData,!0),e.eventData.dataTransfer&&(e.eventData.dataTransfer.dropEffect="none");let t,d,l=i.getBoundingClientRect();e.eventData.clientX<l.left+100&&(t=pt.H.LEFT),e.eventData.clientX>l.right-100&&(t=pt.H.RIGHT),e.eventData.clientY>l.bottom-100&&(d=pt.H.BOTTOM),e.eventData.clientY<l.top+100&&(d=pt.H.TOP),o&&t!==r&&(clearTimeout(o),o=void 0),s&&d!==n&&(clearTimeout(s),s=void 0),!o&&void 0!==t&&(r=t,o=setTimeout(()=>a(t),200)),!s&&void 0!==d&&(n=d,s=setTimeout(()=>a(d),200))},onDragLeave:()=>d(),onDragEnd:()=>d(),onDrop:()=>d()}))}centerLayout(e){this.centeredLayoutWidget.activate(e)}isLayoutCentered(){return!!this.centeredLayoutWidget&&this.centeredLayoutWidget.isActive()}doCreateGridControl(){let e=!1;if(this._willRestoreState&&(e=!this.doCreateGridControlWithPreviousState()),!this.gridWidget||e){let e=this.doCreateGroupView();this.doSetGridWidget(new ii(e)),this.doSetGroupActive(e)}this.updateContainer(),this.notifyGroupIndexChange()}doCreateGridControlWithPreviousState(){let e=this.loadState();if(null!==e&&void 0!==e&&e.serializedGrid)try{this.mostRecentActiveGroups=e.mostRecentActiveGroups,this.doCreateGridControlWithState(e.serializedGrid,e.activeGroup)}catch(t){return(0,at.sP)(Error("Error restoring editor grid widget: ".concat(t," (with state: ").concat(JSON.stringify(e),")"))),this.disposeGroups(),!1}return!0}doCreateGridControlWithState(e,t,i,o){let s;s=i?i.slice(0):[];let r=[],n=ii.deserialize(e,{fromJSON:e=>{let i;return i=s.length>0?s.shift():this.doCreateGroupView(e,o),r.push(i),i.id===t&&this.doSetGroupActive(i),i}},{styles:{separatorBorder:this.gridSeparatorBorder}});this._activeGroup||this.doSetGroupActive(r[0]),this.mostRecentActiveGroups.some(e=>!this.getGroup(e))&&(this.mostRecentActiveGroups=r.map(e=>e.id)),this.doSetGridWidget(n)}doSetGridWidget(e){let t={};this.gridWidget&&(t=this.gridWidget.boundarySashes,this.gridWidget.dispose()),this.gridWidget=e,this.gridWidget.boundarySashes=t,this.gridWidgetView.gridWidget=e,this._onDidChangeSizeConstraints.input=e.onDidChange,this._onDidScroll.input=e.onDidScroll,this.gridWidgetDisposables.clear(),this.gridWidgetDisposables.add(e.onDidChangeViewMaximized(e=>this._onDidChangeGroupMaximized.fire(e))),this.onDidSetGridWidget.fire(void 0)}updateContainer(){this.container.classList.toggle("empty",this.isEmpty)}notifyGroupIndexChange(){this.getGroups(bt.X.GRID_APPEARANCE).forEach((e,t)=>e.notifyIndexChanged(t))}notifyGroupsLabelChange(e){for(let t of this.groups)t.notifyLabelChanged(e)}get isEmpty(){return 1===this.count&&this._activeGroup.isEmpty}setBoundarySashes(e){this.gridWidget.boundarySashes=e,this.centeredLayoutWidget.boundarySashes=e}layout(e,t,i,o){this.top=i,this.left=o;let s=super.layoutContents(e,t).contentSize;this.doLayout(at.mx.lift(s),i,o)}doLayout(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.top,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.left;this._contentDimension=e,this.centeredLayoutWidget.layout(this._contentDimension.width,this._contentDimension.height,t,i),this._onDidLayout.fire(e)}saveState(){if(this.gridWidget&&(this.isEmpty?delete this.workspaceMemento[un.EDITOR_PART_UI_STATE_STORAGE_KEY]:this.workspaceMemento[un.EDITOR_PART_UI_STATE_STORAGE_KEY]=this.createState()),this.centeredLayoutWidget){let e=this.centeredLayoutWidget.state;this.centeredLayoutWidget.isDefault(e)?delete this.profileMemento[un.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]:this.profileMemento[un.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]=e}super.saveState()}loadState(){return this.workspaceMemento[un.EDITOR_PART_UI_STATE_STORAGE_KEY]}createState(){return{serializedGrid:this.gridWidget.serialize(),activeGroup:this._activeGroup.id,mostRecentActiveGroups:this.mostRecentActiveGroups}}applyState(e,t){return"empty"===e?this.doApplyEmptyState():this.doApplyState(e,t)}async doApplyState(e,t){let i=await this.doPrepareApplyState();this._onDidAddGroup.pause(),this._onDidRemoveGroup.pause(),this.disposeGroups(),this.mostRecentActiveGroups=e.mostRecentActiveGroups;try{this.doApplyGridState(e.serializedGrid,e.activeGroup,void 0,t)}finally{this._onDidRemoveGroup.resume(),this._onDidAddGroup.resume()}await this.activeGroup.openEditors(i.flatMap(e=>e.editors).filter(e=>this.editorPartsView.groups.every(t=>!t.contains(e))).map(e=>({editor:e,options:{pinned:!0,preserveFocus:!0,inactive:!0}})))}async doApplyEmptyState(){await this.doPrepareApplyState(),this.mergeAllGroups(this.activeGroup)}async doPrepareApplyState(){let e=this.getGroups(bt.X.MOST_RECENTLY_ACTIVE);for(let t of e)await t.closeAllEditors({excludeConfirming:!0});return e}doApplyGridState(e,t,i,o){this.doCreateGridControlWithState(e,t,i,o),this.doLayout(this._contentDimension),this.updateContainer();for(let s of this.getGroups(bt.X.GRID_APPEARANCE))(null===i||void 0===i?void 0:i.includes(s))||this._onDidAddGroup.fire(s);this.notifyGroupIndexChange()}onDidChangeMementoState(e){if(e.external&&e.scope===at.Ro.WORKSPACE){this.reloadMemento(e.scope);let t=this.loadState();t&&this.applyState(t)}}toJSON(){return{type:pt.V.EDITOR_PART}}disposeGroups(){for(let e of this.groups)e.dispose(),this._onDidRemoveGroup.fire(e);this.groupViews.clear(),this.mostRecentActiveGroups=[]}dispose(){var e;this._onWillDispose.fire(),this.disposeGroups(),null!==(e=this.gridWidget)&&void 0!==e&&e.dispose(),super.dispose()}},{_:un=F},{_:F.EDITOR_PART_UI_STATE_STORAGE_KEY="editorpart.state"},{_:F.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY="editorpart.centeredview"},F);pn=un=(0,at.Jb)([(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.Yd),(0,at.Yb)(6,at.r_),(0,at.Yb)(7,at.Io),(0,at.Yb)(8,pt.ot),(0,at.Yb)(9,dt.R),(0,at.Yb)(10,at.Nb)],pn);var bn=class extends pn{constructor(e,t,i,o,s,r,n,a){super(e,pt.V.EDITOR_PART,"",at.wE.vscodeWindowId,t,i,o,s,r,n,a)}};bn=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,at.Yd),(0,at.Yb)(3,at.r_),(0,at.Yb)(4,at.Io),(0,at.Yb)(5,pt.ot),(0,at.Yb)(6,dt.R),(0,at.Yb)(7,at.Nb)],bn),(0,at.Xb)(),(0,at.oE)(),(0,at.oS)(),(0,at.sj)(),(0,at.wj)(),(0,at.iM)(),(0,at.i_)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.ox)(),(0,at.au)(),(0,at.Lo)(),(0,at.Xd)(),(0,at.yi)(),(0,gt.St)(),(0,gt.Vn)(),(0,bt.Q)(),(0,bt.At)(),(0,dt.z)(),(0,pt.W)(),(0,pt.st)(),(0,bt.z)(),(0,ut.Tb)(),(0,gt.kn)(),(0,at.Tb)(),(0,at.TM)(),(0,at.pO)(),(0,pt.tr)(),(0,vt.c)();var mn,vn,Cn=(0,at.Ej)(new at.ej);(0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.toggleCompactAuxiliaryWindow",title:(0,at.DM)(2963,"Toggle Window Compact Mode"),category:vt.s.View,f1:!0,precondition:pt.Cn})}async run(){Cn.fire({windowId:(0,at.Bx)().vscodeWindowId,compact:"toggle"})}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.enableCompactAuxiliaryWindow",title:(0,at.EM)(2964,"Turn On Compact Mode"),icon:at.fO.screenFull,menu:{id:at.xb.LayoutControlMenu,when:at.Mk.and(pt.wn.toNegated(),pt.Sn),order:0}})}async run(){Cn.fire({windowId:(0,at.Bx)().vscodeWindowId,compact:!0})}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.disableCompactAuxiliaryWindow",title:(0,at.EM)(2965,"Turn Off Compact Mode"),icon:at.fO.screenNormal,menu:{id:at.xb.LayoutControlMenu,when:at.Mk.and(pt.wn,pt.Sn),order:0}})}async run(){Cn.fire({windowId:(0,at.Bx)().vscodeWindowId,compact:!1})}});var wn=(Y=class{constructor(e,t,i,o,s,r,n,a,d){this.editorPartsView=e,this.instantiationService=t,this.auxiliaryWindowService=i,this.lifecycleService=o,this.configurationService=s,this.statusbarService=r,this.titleService=n,this.editorService=a,this.layoutService=d}async create(e,t){let i=this,o=new at.gj,s=!(null===t||void 0===t||!t.compact);function r(e){b?(0,at.BS)(p.container):(0,at.aS)(p.container),e&&d.layout()}function n(e){h&&(g?(0,at.BS)(h.container):(0,at.aS)(h.container),e&&d.layout())}function a(e){var t;if(e===s)return;s=e,d.updateOptions({compact:s}),null!==(t=h)&&void 0!==t&&t.updateOptions({compact:s}),c.updateOptions({compact:s});let o=b;b=!s&&!1!==i.configurationService.getValue(mn.STATUS_BAR_VISIBILITY),o!==b&&r(!0)}let d=o.add(await this.auxiliaryWindowService.open(t)),l=(0,at.px)(".part.editor",{role:"main"});l.style.position="relative",d.container.appendChild(l);let c=o.add(this.instantiationService.createInstance(yn,d.window.vscodeWindowId,this.editorPartsView,null===t||void 0===t?void 0:t.state,e));c.updateOptions({compact:s}),o.add(this.editorPartsView.registerPart(c)),c.create(l);let h,u=o.add(c.scopedInstantiationService.createChild(new at.iu([bt.kt,this.editorService.createScoped(c,o)]))),g=!1;if(at.hM&&(0,at.gi)()){h=o.add(this.titleService.createAuxiliaryTitlebarPart(d.container,c,u)),h.updateOptions({compact:s}),g=(0,pt.X)(this.configurationService,d.window,void 0);let e=()=>{let e=g;g=(0,pt.X)(this.configurationService,d.window,void 0),e!==g&&n(!0)};o.add(h.onDidChange(()=>d.layout())),o.add(this.layoutService.onDidChangePartVisibility(()=>e())),o.add((0,at.gE)(t=>{t===d.window.vscodeWindowId&&e()})),n(!1)}else o.add(u.createInstance(gt.xt,d.window));let p=o.add(this.statusbarService.createAuxiliaryStatusbarPart(d.container,u)),b=!s&&!1!==this.configurationService.getValue(mn.STATUS_BAR_VISIBILITY);o.add(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(mn.STATUS_BAR_VISIBILITY)&&(b=!s&&!1!==this.configurationService.getValue(mn.STATUS_BAR_VISIBILITY),r(!0))})),r(!1);let m=o.add(at.tj.once(c.onWillClose)(()=>d.window.close()));return o.add(at.tj.once(d.onUnload)(()=>{o.isDisposed||(m.dispose(),c.close(),o.dispose())})),o.add(at.tj.once(this.lifecycleService.onDidShutdown)(()=>o.dispose())),o.add(d.onBeforeUnload(e=>{for(let t of c.groups)for(let i of t.editors){let o=i.canMove(t.id,this.editorPartsView.mainPart.activeGroup.id);if("string"==typeof o){t.openEditor(i),e.veto(o);break}}})),o.add(d.onWillLayout(e=>{var t,i,o;let s=null!==(t=null===(i=h)||void 0===i?void 0:i.height)&&void 0!==t?t:0;null===(o=h)||void 0===o||o.layout(e.width,s,0,0);let r=e.height-function(){let e=0;return b&&(e+=p.height),h&&g&&(e+=h.height),e}();c.layout(e.width,r,s,0),p.layout(e.width,p.height,e.height-p.height,0)})),d.layout(),o.add(Cn.event(e=>{if(e.windowId===d.window.vscodeWindowId){let t;t="boolean"==typeof e.compact?e.compact:!s,a(t)}})),o.add(c.onDidAddGroup(()=>{a(!1)})),o.add(c.activeGroup.onDidActiveEditorChange(()=>{c.activeGroup.count>1&&a(!1)})),{part:c,instantiationService:o.add(u.createChild(new at.iu([ut.wb,this.statusbarService.createScoped(p,o)]))),disposables:o}}},{_:mn=Y},{_:Y.STATUS_BAR_VISIBILITY="workbench.statusBar.visible"},Y);wn=mn=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,gt.Bn),(0,at.Yb)(3,bt.R),(0,at.Yb)(4,at.r_),(0,at.Yb)(5,ut.wb),(0,at.Yb)(6,gt.On),(0,at.Yb)(7,bt.kt),(0,at.Yb)(8,pt.ot)],wn);var yn=(Q=class extends pn{constructor(e,t,i,o,s,r,n,a,d,l,c){let h=vn.COUNTER++;super(t,"workbench.parts.auxiliaryEditor.".concat(h),o,e,s,r,n,a,d,l,c),this.state=i,this._onWillClose=this._register(new at.ej),this.onWillClose=this._onWillClose.event,this.optionsDisposable=this._register(new at.vj),this.isCompact=!1}updateOptions(e){this.isCompact=e.compact,e.compact?this.optionsDisposable.value||(this.optionsDisposable.value=this.enforcePartOptions({showTabs:"none",closeEmptyGroups:!0})):this.optionsDisposable.clear()}addGroup(e,t,i){return this.isCompact&&(e=this.editorPartsView.mainPart.activeGroup),super.addGroup(e,t,i)}removeGroup(e,t){let i=this.assertGroupView(e);1===this.count&&this.activeGroup===i?this.doRemoveLastGroup(t):super.removeGroup(e,t)}doRemoveLastGroup(e){let t=!e&&this.shouldRestoreFocus(this.container),i=this.editorPartsView.getGroups(bt.X.MOST_RECENTLY_ACTIVE)[1];i&&(i.groupsView.activateGroup(i),t&&i.focus()),this.doClose(!1)}loadState(){return this.state}saveState(){}close(){return this.doClose(!0)}doClose(e){let t=!0;if(e){for(let e of this.groups)e.closeAllEditors({excludeConfirming:!0});t=this.mergeGroupsToMainPart()}return this._onWillClose.fire(),t}mergeGroupsToMainPart(){if(!this.groups.some(e=>e.count>0))return!0;let e;for(let i of this.editorPartsView.mainPart.getGroups(bt.X.MOST_RECENTLY_ACTIVE))if(!i.isLocked){e=i;break}e||(e=this.editorPartsView.mainPart.addGroup(this.editorPartsView.mainPart.activeGroup,"right"===this.partOptions.openSideBySideDirection?bt.K.RIGHT:bt.K.DOWN));let t=this.mergeAllGroups(e,{preserveExistingIndex:!0});return e.focus(),t}},{_:vn=Q},{_:Q.COUNTER=1},Q);yn=vn=(0,at.Jb)([(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.Yd),(0,at.Yb)(6,at.r_),(0,at.Yb)(7,at.Io),(0,at.Yb)(8,pt.ot),(0,at.Yb)(9,dt.R),(0,at.Yb)(10,at.Nb)],yn),(0,at.Xb)(),(0,at.TM)(),(0,bt.Q)(),(0,at.ox)(),(0,at.sj)(),(0,at.wj)(),(0,at.Jp)(),(0,at.AN)(),(0,gt.pt)(),(0,at.Ww)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.Xd)(),(0,gt.Vn)(),(0,at.dp)(),(0,at.Pb)(),(0,at.oS)(),(0,at.au)(),(0,bt.At)(),(0,ut.Tb)(),(0,at.SE)();var fn,Sn,En=(X=class extends gt.dt{constructor(e,t,i,o,s){super("workbench.editorParts",i,t),this.instantiationService=e,this.storageService=t,this.auxiliaryWindowService=o,this.contextKeyService=s,this.mapPartToInstantiationService=new Map,this._onDidCreateAuxiliaryEditorPart=this._register(new at.ej),this.onDidCreateAuxiliaryEditorPart=this._onDidCreateAuxiliaryEditorPart.event,this.workspaceMemento=this.getMemento(at.Ro.WORKSPACE,at.zo.USER),this._isReady=!1,this.whenReadyPromise=new at.xw,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new at.xw,this.whenRestored=this.whenRestoredPromise.p,this._onDidActiveGroupChange=this._register(new at.ej),this.onDidChangeActiveGroup=this._onDidActiveGroupChange.event,this._onDidAddGroup=this._register(new at.ej),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new at.ej),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new at.ej),this.onDidMoveGroup=this._onDidMoveGroup.event,this._onDidActivateGroup=this._register(new at.ej),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidChangeGroupIndex=this._register(new at.ej),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLocked=this._register(new at.ej),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidChangeGroupMaximized=this._register(new at.ej),this.onDidChangeGroupMaximized=this._onDidChangeGroupMaximized.event,this.globalContextKeys=new Map,this.scopedContextKeys=new Map,this.contextKeyProviders=new Map,this.registeredContextKeys=new Map,this.contextKeyProviderDisposables=this._register(new at.hj),this.editorWorkingSets=(()=>{let e=this.storageService.get(fn.EDITOR_WORKING_SETS_STORAGE_KEY,at.Ro.WORKSPACE);return e?JSON.parse(e):[]})(),this.mainPart=this._register(this.createMainEditorPart()),this._register(this.registerPart(this.mainPart)),this.mostRecentActiveParts=[this.mainPart],this.restoreParts(),this.registerListeners()}registerListeners(){this._register(this.onDidChangeMementoValue(at.Ro.WORKSPACE,this._store)(e=>this.onDidChangeMementoState(e))),this.whenReady.then(()=>this.registerGroupsContextKeyListeners())}createMainEditorPart(){return this.instantiationService.createInstance(bn,this)}getScopedInstantiationService(e){var t;return e===this.mainPart&&(this.mapPartToInstantiationService.has(e.windowId)||this.instantiationService.invokeFunction(t=>{let i=t.get(bt.kt),o=t.get(ut.wb);this.mapPartToInstantiationService.set(e.windowId,this._register(this.mainPart.scopedInstantiationService.createChild(new at.iu([bt.kt,i.createScoped(this.mainPart,this._store)],[ut.wb,o.createScoped(o,this._store)]))))})),null!==(t=this.mapPartToInstantiationService.get(e.windowId))&&void 0!==t?t:this.instantiationService}async createAuxiliaryEditorPart(e){let{part:t,instantiationService:i,disposables:o}=await this.instantiationService.createInstance(wn,this).create(this.getGroupsLabel(this._parts.size),e);return this.mapPartToInstantiationService.set(t.windowId,i),o.add((0,at.kj)(()=>this.mapPartToInstantiationService.delete(t.windowId))),this._onDidAddGroup.fire(t.activeGroup),this._onDidCreateAuxiliaryEditorPart.fire(t),t}registerPart(e){let t=this._register(new at.gj);return t.add(super.registerPart(e)),this.registerEditorPartListeners(e,t),t}unregisterPart(e){super.unregisterPart(e),this.parts.forEach((e,t)=>{e!==this.mainPart&&e.notifyGroupsLabelChange(this.getGroupsLabel(t))})}registerEditorPartListeners(e,t){t.add(e.onDidFocus(()=>{this.doUpdateMostRecentActive(e,!0),this._parts.size>1&&this._onDidActiveGroupChange.fire(this.activeGroup)})),t.add((0,at.kj)(()=>{this.doUpdateMostRecentActive(e),e.windowId!==at.wE.vscodeWindowId&&this._onDidActiveGroupChange.fire(this.activeGroup)})),t.add(e.onDidChangeActiveGroup(e=>this._onDidActiveGroupChange.fire(e))),t.add(e.onDidAddGroup(e=>this._onDidAddGroup.fire(e))),t.add(e.onDidRemoveGroup(e=>this._onDidRemoveGroup.fire(e))),t.add(e.onDidMoveGroup(e=>this._onDidMoveGroup.fire(e))),t.add(e.onDidActivateGroup(e=>this._onDidActivateGroup.fire(e))),t.add(e.onDidChangeGroupMaximized(e=>this._onDidChangeGroupMaximized.fire(e))),t.add(e.onDidChangeGroupIndex(e=>this._onDidChangeGroupIndex.fire(e))),t.add(e.onDidChangeGroupLocked(e=>this._onDidChangeGroupLocked.fire(e)))}doUpdateMostRecentActive(e,t){let i=this.mostRecentActiveParts.indexOf(e);-1!==i&&this.mostRecentActiveParts.splice(i,1),t&&this.mostRecentActiveParts.unshift(e)}getGroupsLabel(e){return(0,at.EM)(3338,"Window {0}",e+1)}getPart(e){if(this._parts.size>1){if((0,at._S)(e)){let t=e;return this.getPartByDocument(t.ownerDocument)}{let t;t="number"==typeof e?e:e.id;for(let e of this._parts)if(e.hasGroup(t))return e}}return this.mainPart}get isReady(){return this._isReady}async restoreParts(){var e;if(await this.mainPart.whenReady,this.mainPart.willRestoreState){let e=this.loadState();e&&await this.restoreState(e)}null!==(e=this.mostRecentActiveParts.at(0))&&void 0!==e&&e.activeGroup.focus(),this._isReady=!0,this.whenReadyPromise.complete(),await Promise.allSettled(this.parts.map(e=>e.whenRestored)),this.whenRestoredPromise.complete()}loadState(){return this.workspaceMemento[fn.EDITOR_PARTS_UI_STATE_STORAGE_KEY]}saveState(){let e=this.createState();0===e.auxiliary.length?delete this.workspaceMemento[fn.EDITOR_PARTS_UI_STATE_STORAGE_KEY]:this.workspaceMemento[fn.EDITOR_PARTS_UI_STATE_STORAGE_KEY]=e}createState(){return{auxiliary:this.parts.filter(e=>e!==this.mainPart).map(e=>{let t=this.auxiliaryWindowService.getWindow(e.windowId);return(0,rt.A)({state:e.createState()},null===t||void 0===t?void 0:t.createState())}),mru:this.mostRecentActiveParts.map(e=>this.parts.indexOf(e))}}async restoreState(e){if(e.auxiliary.length){let t=[];for(let i of e.auxiliary)t.push(this.createAuxiliaryEditorPart(i));await Promise.allSettled(t),e.mru.length===this.parts.length?this.mostRecentActiveParts=e.mru.map(e=>this.parts[e]):this.mostRecentActiveParts=[...this.parts],await Promise.allSettled(this.parts.map(e=>e.whenReady))}}get hasRestorableState(){return this.parts.some(e=>e.hasRestorableState)}onDidChangeMementoState(e){if(e.external&&e.scope===at.Ro.WORKSPACE){this.reloadMemento(e.scope);let t=this.loadState();t&&this.applyState(t)}}async applyState(e){for(let t of this.parts)if(t!==this.mainPart){for(let e of t.getGroups(bt.X.MOST_RECENTLY_ACTIVE))await e.closeAllEditors({excludeConfirming:!0});if(!t.close())return!1}return"empty"!==e&&await this.restoreState(e),!0}saveWorkingSet(e){let t={id:(0,at.up)(),name:e,main:this.mainPart.createState(),auxiliary:this.createState()};return this.editorWorkingSets.push(t),this.saveWorkingSets(),{id:t.id,name:t.name}}getWorkingSets(){return this.editorWorkingSets.map(e=>({id:e.id,name:e.name}))}deleteWorkingSet(e){let t=this.indexOfWorkingSet(e);"number"==typeof t&&(this.editorWorkingSets.splice(t,1),this.saveWorkingSets())}async applyWorkingSet(e,t){var i;let o;if(o="empty"===e?"empty":this.editorWorkingSets[null!==(i=this.indexOfWorkingSet(e))&&void 0!==i?i:-1],!o||!await this.applyState("empty"===o?o:o.auxiliary))return!1;if(await this.mainPart.applyState("empty"===o?o:o.main,t),null===t||void 0===t||!t.preserveFocus){let e=this.mostRecentActiveParts.at(0);e&&(await e.whenReady,e.activeGroup.focus())}return!0}indexOfWorkingSet(e){for(let t=0;t<this.editorWorkingSets.length;t++)if(this.editorWorkingSets[t].id===e.id)return t}saveWorkingSets(){this.storageService.store(fn.EDITOR_WORKING_SETS_STORAGE_KEY,JSON.stringify(this.editorWorkingSets),at.Ro.WORKSPACE,at.zo.MACHINE)}get activeGroup(){return this.activePart.activeGroup}get sideGroup(){return this.activePart.sideGroup}get groups(){return this.getGroups()}get count(){return this.groups.length}getGroups(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt.X.CREATION_TIME;if(this._parts.size>1){let t;switch(e){case bt.X.GRID_APPEARANCE:case bt.X.CREATION_TIME:t=this.parts;break;case bt.X.MOST_RECENTLY_ACTIVE:t=(0,at.wN)([...this.mostRecentActiveParts,...this.parts])}return t.map(t=>t.getGroups(e)).flat()}return this.mainPart.getGroups(e)}getGroup(e){if(this._parts.size>1)for(let t of this._parts){let i=t.getGroup(e);if(i)return i}return this.mainPart.getGroup(e)}assertGroupView(e){let t;if(t="number"==typeof e?this.getGroup(e):e,!t)throw Error("Invalid editor group provided!");return t}activateGroup(e){return this.getPart(e).activateGroup(e)}getSize(e){return this.getPart(e).getSize(e)}setSize(e,t){this.getPart(e).setSize(e,t)}arrangeGroups(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activePart.activeGroup;this.getPart(t).arrangeGroups(e,t)}toggleMaximizeGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activePart.activeGroup;this.getPart(e).toggleMaximizeGroup(e)}toggleExpandGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activePart.activeGroup;this.getPart(e).toggleExpandGroup(e)}restoreGroup(e){return this.getPart(e).restoreGroup(e)}applyLayout(e){this.activePart.applyLayout(e)}getLayout(){return this.activePart.getLayout()}get orientation(){return this.activePart.orientation}setGroupOrientation(e){this.activePart.setGroupOrientation(e)}findGroup(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeGroup,i=arguments.length>2?arguments[2]:void 0,o=this.getPart(t);if(this._parts.size>1){let s=this.getGroups(bt.X.GRID_APPEARANCE);if(e.location===bt.q.FIRST||e.location===bt.q.LAST)return e.location===bt.q.FIRST?s[0]:s[s.length-1];let r=o.findGroup(e,t,!1);if(r)return r;if(e.location===bt.q.NEXT||e.location===bt.q.PREVIOUS){let o=this.assertGroupView(t),r=s.indexOf(o);if(e.location===bt.q.NEXT){let e=s[r+1];return!e&&i&&(e=s[0]),e}{let e=s[r-1];return!e&&i&&(e=s[s.length-1]),e}}}return o.findGroup(e,t,i)}addGroup(e,t){return this.getPart(e).addGroup(e,t)}removeGroup(e){this.getPart(e).removeGroup(e)}moveGroup(e,t,i){return this.getPart(e).moveGroup(e,t,i)}mergeGroup(e,t,i){return this.getPart(e).mergeGroup(e,t,i)}mergeAllGroups(e,t){return this.activePart.mergeAllGroups(e,t)}copyGroup(e,t,i){return this.getPart(e).copyGroup(e,t,i)}createEditorDropTarget(e,t){return this.getPart(e).createEditorDropTarget(e,t)}registerGroupsContextKeyListeners(){this._register(this.onDidChangeActiveGroup(()=>this.updateGlobalContextKeys())),this.groups.forEach(e=>this.registerGroupContextKeyProvidersListeners(e)),this._register(this.onDidAddGroup(e=>this.registerGroupContextKeyProvidersListeners(e))),this._register(this.onDidRemoveGroup(e=>{this.scopedContextKeys.delete(e.id),this.registeredContextKeys.delete(e.id),this.contextKeyProviderDisposables.deleteAndDispose(e.id)}))}updateGlobalContextKeys(){let e=this.scopedContextKeys.get(this.activeGroup.id);if(e)for(let[t,i]of this.globalContextKeys){let o=e.get(t);o?i.set(o.get()):i.reset()}}bind(e,t){let i=this.globalContextKeys.get(e.key);i||(i=e.bindTo(this.contextKeyService),this.globalContextKeys.set(e.key,i));let o=this.scopedContextKeys.get(t.id);o||(o=new Map,this.scopedContextKeys.set(t.id,o));let s=o.get(e.key);s||(s=e.bindTo(t.scopedContextKeyService),o.set(e.key,s));let r=this;return{get:()=>s.get(),set(e){r.activeGroup===t&&i.set(e),s.set(e)},reset(){r.activeGroup===t&&i.reset(),s.reset()}}}registerContextKeyProvider(e){var t;if(this.contextKeyProviders.has(e.contextKey.key)||this.globalContextKeys.has(e.contextKey.key))throw Error("A context key provider for key ".concat(e.contextKey.key," already exists."));this.contextKeyProviders.set(e.contextKey.key,e);let i=()=>{for(let t of this.groups)this.updateRegisteredContextKey(t,e)};i();let o=null===(t=e.onDidChange)||void 0===t?void 0:t.call(e,()=>i());return(0,at.kj)(()=>{null!==o&&void 0!==o&&o.dispose(),this.globalContextKeys.delete(e.contextKey.key),this.scopedContextKeys.forEach(t=>t.delete(e.contextKey.key)),this.contextKeyProviders.delete(e.contextKey.key),this.registeredContextKeys.forEach(t=>t.delete(e.contextKey.key))})}registerGroupContextKeyProvidersListeners(e){let t=e.onDidActiveEditorChange(()=>{for(let t of this.contextKeyProviders.values())this.updateRegisteredContextKey(e,t)});this.contextKeyProviderDisposables.set(e.id,t)}updateRegisteredContextKey(e,t){let i=this.registeredContextKeys.get(e.id);i||(i=new Map,this.registeredContextKeys.set(e.id,i));let o=i.get(t.contextKey.key);o||(o=this.bind(t.contextKey,e),i.set(t.contextKey.key,o)),o.set(t.getGroupContextKeyValue(e))}get partOptions(){return this.mainPart.partOptions}get onDidChangeEditorPartOptions(){return this.mainPart.onDidChangeEditorPartOptions}enforcePartOptions(e){return this.mainPart.enforcePartOptions(e)}},{_:fn=X},{_:X.EDITOR_PARTS_UI_STATE_STORAGE_KEY="editorparts.state"},{_:X.EDITOR_WORKING_SETS_STORAGE_KEY="editor.workingSets"},X);En=fn=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,at.Io),(0,at.Yb)(2,at.Yd),(0,at.Yb)(3,gt.Bn),(0,at.Yb)(4,at.Nb)],En),(0,at.vE)(),(0,at.Xb)(),(0,gt.ot)(),(0,at.TM)(),(0,at.Kb)(),(0,at.Ur)(),(0,pt.tr)(),(0,pt.W)(),(0,pt.st)(),(0,at.Lo)(),(0,at.Ol)(),(0,at.Dd)(),(0,at.ox)(),(0,gt.at)(),(0,at.Xd)(),(0,dt.er)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.Fd)(),(0,at.oS)(),(0,at.Pb)(),(0,at.GM)(),(0,pt.Nt)(),(0,ut.yb)(),(0,at.Tl)(),(0,at.Tb)(),(0,at.ni)(),(0,at.Rb)(),(0,at.ei)(),(0,at.rr)(),(0,at.i_)(),(0,at.bE)(gt.st);var kn=(H=class extends Wt{get preferredHeight(){return.4*this.layoutService.mainContainerDimension.height}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g){super(pt.V.PANEL_PART,{hasTitle:!0},Sn.activePanelSettingsKey,pt.ln.bindTo(l),pt.Fn.bindTo(l),"panel","panel",void 0,dt.Yt,e,t,i,o,s,r,n,a,d,l,c,u),this.commandService=h,this.configurationService=g,this.minimumWidth=300,this.maximumWidth=1/0,this.minimumHeight=77,this.maximumHeight=1/0,this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("workbench.panel.showLabels")&&this.updateCompositeBar(!0)}))}updateStyles(){super.updateStyles();let e=(0,at.UM)(this.getContainer());e.style.backgroundColor=this.getColor(dt.Ft)||"";let t=this.getColor(dt.It)||this.getColor(at.dg)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t,e.style.borderBottomColor=t;let i=this.getTitleArea();i&&(i.style.borderTopColor=this.getColor(dt.It)||this.getColor(at.dg)||"")}getCompositeBarOptions(){return{partContainerClass:"panel",pinnedViewContainersKey:"workbench.panel.pinnedPanels",placeholderViewContainersKey:"workbench.panel.placeholderPanels",viewContainersWorkspaceStateKey:"workbench.panel.viewContainersWorkspaceState",icon:!1===this.configurationService.getValue("workbench.panel.showLabels"),orientation:at.Hr.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.layoutService.getPanelPosition()!==pt.H.BOTTOM||this.layoutService.isPanelMaximized()?at.xl.BELOW:at.xl.ABOVE},fillExtraContextMenuActions:e=>this.fillExtraContextMenuActions(e),compositeSize:0,iconSize:16,compact:!0,overflowActionSize:44,colors:e=>({activeBackgroundColor:e.getColor(dt.Ft),inactiveBackgroundColor:e.getColor(dt.Ft),activeBorderBottomColor:e.getColor(dt.Nt),activeForegroundColor:e.getColor(dt.Pt),inactiveForegroundColor:e.getColor(dt.Rt),badgeBackground:e.getColor(dt.qt),badgeForeground:e.getColor(dt.Jt),dragAndDropBorder:e.getColor(dt.Lt)})}}fillExtraContextMenuActions(e){if(this.getCompositeBarPosition()===Mt.TITLE){let t=this.getViewsSubmenuAction();t&&(e.push(new at.Wb),e.push(t))}let t=this.menuService.getMenuActions(at.xb.PanelPositionMenu,this.contextKeyService,{shouldForwardArgs:!0}),i=this.menuService.getMenuActions(at.xb.PanelAlignmentMenu,this.contextKeyService,{shouldForwardArgs:!0}),o=(0,at.Zr)(t).secondary,s=(0,at.Zr)(i).secondary,r=this.configurationService.getValue("workbench.panel.showLabels"),n=(0,at.qb)({id:"workbench.action.panel.toggleShowLabels",label:r?(0,at.EM)(3542,"Show Icons"):(0,at.EM)(3543,"Show Labels"),run:()=>this.configurationService.updateValue("workbench.panel.showLabels",!r)});e.push(new at.Wb,new at.Gb("workbench.action.panel.position",(0,at.EM)(3544,"Panel Position"),o),new at.Gb("workbench.action.panel.align",(0,at.EM)(3545,"Align Panel"),s),n,(0,at.qb)({id:gt.it.ID,label:(0,at.EM)(3546,"Hide Panel"),run:()=>this.commandService.executeCommand(gt.it.ID)}))}layout(e,t,i,o){let s;switch(this.layoutService.getPanelPosition()){case pt.H.RIGHT:s=new at.mx(e-1,t);break;case pt.H.TOP:s=new at.mx(e,t-1);break;default:s=new at.mx(e,t)}super.layout(s.width,s.height,i,o)}shouldShowCompositeBar(){return!0}getCompositeBarPosition(){return Mt.TITLE}toJSON(){return{type:pt.V.PANEL_PART}}},{_:Sn=H},{_:H.activePanelSettingsKey="workbench.panelpart.activepanelid"},H);kn=Sn=(0,at.Jb)([(0,at.Yb)(0,at.Pd),(0,at.Yb)(1,at.Io),(0,at.Yb)(2,at.El),(0,at.Yb)(3,pt.ot),(0,at.Yb)(4,at.Ed),(0,at.Yb)(5,at.nr),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.Yd),(0,at.Yb)(8,ut.vb),(0,at.Yb)(9,at.Nb),(0,at.Yb)(10,pt.Mt),(0,at.Yb)(11,at.Lb),(0,at.Yb)(12,at.ti),(0,at.Yb)(13,at.r_)],kn);var _n,In={};(0,at.vE)(),(0,at.TM)(),(0,at.Tb)(),(0,pt.W)(),(0,pt.st)(),(0,at.QO)(),(0,at.Ab)(),(0,vt.c)(),(0,pt.kt)(),(0,ut.xf)(),(0,pt.tr)(),(0,at.bE)(In),(0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.closeSidebar",title:(0,at.DM)(3547,"Close Primary Side Bar"),category:vt.s.View,f1:!0,precondition:pt.Hn})}run(e){e.get(pt.ot).setPartHidden(!0,pt.V.SIDEBAR_PART)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.focusSideBar",title:(0,at.DM)(3548,"Focus into Primary Side Bar"),category:vt.s.View,f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,when:null,primary:at.JO.CtrlCmd|at.KO.Digit0}})}async run(e){var t;let i=e.get(pt.ot),o=e.get(pt.Ot);i.isVisible(pt.V.SIDEBAR_PART)||i.setPartHidden(!1,pt.V.SIDEBAR_PART),null===(t=o.getActivePaneComposite(ut.gf.Sidebar))||void 0===t||t.focus()}}),(0,at.vE)(),(0,at.Xb)(),(0,pt.W)(),(0,pt.st)(),(0,pt.tr)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.Ol)(),(0,at.Dd)(),(0,at.ox)(),(0,at.Xd)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,dt.er)(),(0,at.Fd)(),(0,at.Pb)(),(0,at.vl)(),(0,pt.Nt)(),(0,at.GM)(),(0,ut.yb)(),(0,gt.g)(),(0,at.Ur)(),(0,at.Tl)(),(0,at.i_)(),(0,at.Tb)(),(0,at.ni)(),(0,at.Kb)(),(0,gt.tt)(),(0,at.TM)(),(0,at.rr)(),(0,at.Xt)(),(0,at.bE)(In);var xn=(U=class extends Wt{get snap(){return!0}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u){super(pt.V.SIDEBAR_PART,{hasTitle:!0,borderWidth:()=>this.getColor(dt.Zt)||this.getColor(at.dg)?1:0},_n.activeViewletSettingsKey,pt.un.bindTo(l),pt.Wn.bindTo(l),"sideBar","viewlet",dt.sn,dt.on,e,t,i,o,s,r,n,a,d,l,c,u),this.configurationService=h,this.minimumWidth=170,this.maximumWidth=1/0,this.minimumHeight=0,this.maximumHeight=1/0,this.priority=at.qt.Low,this.activityBarPart=this._register(this.instantiationService.createInstance(gt.h,this)),this.rememberActivityBarVisiblePosition(),this._register(h.onDidChangeConfiguration(e=>{e.affectsConfiguration(pt.z.ACTIVITY_BAR_LOCATION)&&this.onDidChangeActivityBarLocation()})),this.registerActions()}onDidChangeActivityBarLocation(){var e;this.activityBarPart.hide(),this.updateCompositeBar();let t=null===(e=this.getActiveComposite())||void 0===e?void 0:e.getId();t&&this.onTitleAreaUpdate(t),this.shouldShowActivityBar()&&this.activityBarPart.show(),this.rememberActivityBarVisiblePosition()}updateStyles(){var e;super.updateStyles();let t=(0,at.UM)(this.getContainer());t.style.backgroundColor=this.getColor(dt.Xt)||"",t.style.color=this.getColor(dt.$t)||"";let i=this.getColor(dt.Zt)||this.getColor(at.dg),o=this.layoutService.getSideBarPosition()===pt.H.LEFT;t.style.borderRightWidth=i&&o?"1px":"",t.style.borderRightStyle=i&&o?"solid":"",t.style.borderRightColor=o&&i||"",t.style.borderLeftWidth=i&&!o?"1px":"",t.style.borderLeftStyle=i&&!o?"solid":"",t.style.borderLeftColor=o?"":i||"",t.style.outlineColor=null!==(e=this.getColor(dt.Qt))&&void 0!==e?e:""}layout(e,t,i,o){this.layoutService.isVisible(pt.V.SIDEBAR_PART)&&super.layout(e,t,i,o)}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===pt.H.LEFT?at.gl.LEFT:at.gl.RIGHT}createCompositeBar(){return this.instantiationService.createInstance(gt.m,this.getCompositeBarOptions(),this.partId,this,!1)}getCompositeBarOptions(){return{partContainerClass:"sidebar",pinnedViewContainersKey:gt.h.pinnedViewContainersKey,placeholderViewContainersKey:gt.h.placeholderViewContainersKey,viewContainersWorkspaceStateKey:gt.h.viewContainersWorkspaceStateKey,icon:!0,orientation:at.Hr.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===Mt.BOTTOM?at.xl.ABOVE:at.xl.BELOW},fillExtraContextMenuActions:e=>{if(this.getCompositeBarPosition()===Mt.TITLE){let t=this.getViewsSubmenuAction();t&&(e.push(new at.Wb),e.push(t))}},compositeSize:0,iconSize:16,overflowActionSize:30,colors:e=>({activeBackgroundColor:e.getColor(dt.Xt),inactiveBackgroundColor:e.getColor(dt.Xt),activeBorderBottomColor:e.getColor(dt.pt),activeForegroundColor:e.getColor(dt.ht),inactiveForegroundColor:e.getColor(dt.gt),badgeBackground:e.getColor(dt.st),badgeForeground:e.getColor(dt.ct),dragAndDropBorder:e.getColor(dt.mt)}),compact:!0}}shouldShowCompositeBar(){let e=this.configurationService.getValue(pt.z.ACTIVITY_BAR_LOCATION);return e===pt.I.TOP||e===pt.I.BOTTOM}shouldShowActivityBar(){return!this.shouldShowCompositeBar()&&this.configurationService.getValue(pt.z.ACTIVITY_BAR_LOCATION)!==pt.I.HIDDEN}getCompositeBarPosition(){switch(this.configurationService.getValue(pt.z.ACTIVITY_BAR_LOCATION)){case pt.I.TOP:return Mt.TOP;case pt.I.BOTTOM:return Mt.BOTTOM;case pt.I.HIDDEN:case pt.I.DEFAULT:default:return Mt.TITLE}}rememberActivityBarVisiblePosition(){let e=this.configurationService.getValue(pt.z.ACTIVITY_BAR_LOCATION);e!==pt.I.HIDDEN&&this.storageService.store(pt.z.ACTIVITY_BAR_LOCATION,e,at.Ro.PROFILE,at.zo.USER)}getRememberedActivityBarVisiblePosition(){switch(this.storageService.get(pt.z.ACTIVITY_BAR_LOCATION,at.Ro.PROFILE)){case pt.I.TOP:return pt.I.TOP;case pt.I.BOTTOM:return pt.I.BOTTOM;default:return pt.I.DEFAULT}}getPinnedPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPinnedPaneCompositeIds():this.activityBarPart.getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(){return this.shouldShowCompositeBar()?super.getVisiblePaneCompositeIds():this.activityBarPart.getVisiblePaneCompositeIds()}getPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPaneCompositeIds():this.activityBarPart.getPaneCompositeIds()}async focusActivityBar(){this.configurationService.getValue(pt.z.ACTIVITY_BAR_LOCATION)===pt.I.HIDDEN&&(await this.configurationService.updateValue(pt.z.ACTIVITY_BAR_LOCATION,this.getRememberedActivityBarVisiblePosition()),this.onDidChangeActivityBarLocation()),this.shouldShowCompositeBar()?this.focusCompositeBar():(this.layoutService.isVisible(pt.V.ACTIVITYBAR_PART)||this.layoutService.setPartHidden(!1,pt.V.ACTIVITYBAR_PART),this.activityBarPart.show(!0))}registerActions(){let e=this;this._register((0,at.Db)(class extends at.bb{constructor(){super({id:gt.Y,title:(0,at.DM)(3549,"Toggle Activity Bar Visibility")})}run(){let t=e.configurationService.getValue(pt.z.ACTIVITY_BAR_LOCATION)===pt.I.HIDDEN?e.getRememberedActivityBarVisiblePosition():pt.I.HIDDEN;return e.configurationService.updateValue(pt.z.ACTIVITY_BAR_LOCATION,t)}}))}toJSON(){return{type:pt.V.SIDEBAR_PART}}},{_:_n=U},{_:U.activeViewletSettingsKey="workbench.sidebar.activeviewletid"},U);xn=_n=(0,at.Jb)([(0,at.Yb)(0,at.Pd),(0,at.Yb)(1,at.Io),(0,at.Yb)(2,at.El),(0,at.Yb)(3,pt.ot),(0,at.Yb)(4,at.Ed),(0,at.Yb)(5,at.nr),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.Yd),(0,at.Yb)(8,ut.vb),(0,at.Yb)(9,at.Nb),(0,at.Yb)(10,pt.Mt),(0,at.Yb)(11,at.r_),(0,at.Yb)(12,at.ti)],xn),(0,at.Xb)(),(0,gt.Gn)(),(0,at.wj)(),(0,at.Jp)(),(0,ut.yb)(),(0,gt.w)(),(0,at.sj)(),(0,at.ox)();var An=class extends at.mj{constructor(e,t,i){super(),this.viewId=e,this.viewDescriptorService=t,this.activityService=i,this.activity=void 0,this.activityDisposable=at.mj.None,this._register(at.tj.filter(this.viewDescriptorService.onDidChangeContainer,t=>t.views.some(t=>t.id===e))(()=>this.update())),this._register(at.tj.filter(this.viewDescriptorService.onDidChangeLocation,t=>t.views.some(t=>t.id===e))(()=>this.update()))}setActivity(e){this.activity=e,this.update()}clearActivity(){this.activity=void 0,this.update()}update(){this.activityDisposable.dispose();let e=this.viewDescriptorService.getViewContainerByViewId(this.viewId);e&&this.activity&&(this.activityDisposable=this.activityService.showViewContainerActivity(e.id,this.activity))}dispose(){this.activityDisposable.dispose(),super.dispose()}};An=(0,at.Jb)([(0,at.Yb)(1,ut.vb),(0,at.Yb)(2,gt.Wn)],An);var Vn=class extends at.mj{constructor(e,t){super(),this.viewDescriptorService=e,this.instantiationService=t,this.viewActivities=new Map,this._onDidChangeActivity=this._register(new at.ej),this.onDidChangeActivity=this._onDidChangeActivity.event,this.viewContainerActivities=new Map,this.globalActivities=new Map}showViewContainerActivity(e,t){let i=this.viewDescriptorService.getViewContainerById(e);if(!i)return at.mj.None;let o=this.viewContainerActivities.get(e);return o||(o=[],this.viewContainerActivities.set(e,o)),o.push(t),this._onDidChangeActivity.fire(i),(0,at.kj)(()=>{o.splice(o.indexOf(t),1),0===o.length&&this.viewContainerActivities.delete(e),this._onDidChangeActivity.fire(i)})}getViewContainerActivities(e){var t;return this.viewDescriptorService.getViewContainerById(e)&&null!==(t=this.viewContainerActivities.get(e))&&void 0!==t?t:[]}showViewActivity(e,t){let i=this.viewActivities.get(e);i?i.id++:(i={id:1,activity:this.instantiationService.createInstance(An,e)},this.viewActivities.set(e,i));let o=i.id;i.activity.setActivity(t);let s=i;return(0,at.kj)(()=>{s.id===o&&(s.activity.dispose(),this.viewActivities.delete(e))})}showAccountsActivity(e){return this.showActivity(gt.S,e)}showGlobalActivity(e){return this.showActivity(gt.C,e)}getActivity(e){var t;return null!==(t=this.globalActivities.get(e))&&void 0!==t?t:[]}showActivity(e,t){let i=this.globalActivities.get(e);return i||(i=[],this.globalActivities.set(e,i)),i.push(t),this._onDidChangeActivity.fire(e),(0,at.kj)(()=>{i.splice(i.indexOf(t),1),0===i.length&&this.globalActivities.delete(e),this._onDidChangeActivity.fire(e)})}};Vn=(0,at.Jb)([(0,at.Yb)(0,ut.vb),(0,at.Yb)(1,at.rx)],Vn),(0,at.QO)(),(0,at.QT)();var Dn=class{static _readModifiers(e){e=e.toLowerCase().trim();let t,i=!1,o=!1,s=!1,r=!1;do{t=!1,/^ctrl(\+|\-)/.test(e)&&(i=!0,e=e.substr(5),t=!0),/^shift(\+|\-)/.test(e)&&(o=!0,e=e.substr(6),t=!0),/^alt(\+|\-)/.test(e)&&(s=!0,e=e.substr(4),t=!0),/^meta(\+|\-)/.test(e)&&(r=!0,e=e.substr(5),t=!0),/^win(\+|\-)/.test(e)&&(r=!0,e=e.substr(4),t=!0),/^cmd(\+|\-)/.test(e)&&(r=!0,e=e.substr(4),t=!0)}while(t);let n,a=e.indexOf(" ");return a>0?(n=e.substring(0,a),e=e.substring(a)):(n=e,e=""),{remains:e,ctrl:i,shift:o,alt:s,meta:r,key:n}}static parseChord(e){let t=this._readModifiers(e),i=t.key.match(/^\[([^\]]+)\]$/);if(i){let e=i[1],o=at.ZO.lowerCaseToEnum(e);return[new at.ZT(t.ctrl,t.shift,t.alt,t.meta,o),t.remains]}let o=at.qO.fromUserSettings(t.key);return[new at.YT(t.ctrl,t.shift,t.alt,t.meta,o),t.remains]}static parseKeybinding(e){if(!e)return null;let t,i=[];for(;e.length>0;)[t,e]=this.parseChord(e),i.push(t);return i.length>0?new at.XT(i):null}};(0,at.Xb)(),(0,at.TM)(),(0,at.rA)(),(0,at.dT)(),(0,pt.Tt)(),(0,at.Pk)(),(0,at.Tb)(),(0,at.wj)(),(0,at.Vb)(),(0,at.AN)(),(0,ut.m_)(),(0,pt.vt)(),(0,at.Mb)(),(0,at.Zp)(),(0,at.zO)(),(0,at.Vc)(),(0,at.Dd)();var Mn,Tn=[{key:"commandPalette",id:at.xb.CommandPalette,description:(0,at.EM)(12934,"The Command Palette"),supportsSubmenus:!1},{key:"touchBar",id:at.xb.TouchBarContext,description:(0,at.EM)(12935,"The touch bar (macOS only)"),supportsSubmenus:!1},{key:"editor/title",id:at.xb.EditorTitle,description:(0,at.EM)(12936,"The editor title menu")},{key:"editor/title/run",id:at.xb.EditorTitleRun,description:(0,at.EM)(12937,"Run submenu inside the editor title menu")},{key:"editor/context",id:at.xb.EditorContext,description:(0,at.EM)(12938,"The editor context menu")},{key:"editor/context/copy",id:at.xb.EditorContextCopy,description:(0,at.EM)(12939,"'Copy as' submenu in the editor context menu")},{key:"editor/context/share",id:at.xb.EditorContextShare,description:(0,at.EM)(12940,"'Share' submenu in the editor context menu"),proposed:"contribShareMenu"},{key:"explorer/context",id:at.xb.ExplorerContext,description:(0,at.EM)(12941,"The file explorer context menu")},{key:"explorer/context/share",id:at.xb.ExplorerContextShare,description:(0,at.EM)(12942,"'Share' submenu in the file explorer context menu"),proposed:"contribShareMenu"},{key:"editor/title/context",id:at.xb.EditorTitleContext,description:(0,at.EM)(12943,"The editor tabs context menu")},{key:"editor/title/context/share",id:at.xb.EditorTitleContextShare,description:(0,at.EM)(12944,"'Share' submenu inside the editor title context menu"),proposed:"contribShareMenu"},{key:"debug/callstack/context",id:at.xb.DebugCallStackContext,description:(0,at.EM)(12945,"The debug callstack view context menu")},{key:"debug/variables/context",id:at.xb.DebugVariablesContext,description:(0,at.EM)(12946,"The debug variables view context menu")},{key:"debug/watch/context",id:at.xb.DebugWatchContext,description:(0,at.EM)(12947,"The debug watch view context menu")},{key:"debug/toolBar",id:at.xb.DebugToolBar,description:(0,at.EM)(12948,"The debug toolbar menu")},{key:"debug/createConfiguration",id:at.xb.DebugCreateConfiguration,proposed:"contribDebugCreateConfiguration",description:(0,at.EM)(12949,"The debug create configuration menu")},{key:"notebook/variables/context",id:at.xb.NotebookVariablesContext,description:(0,at.EM)(12950,"The notebook variables view context menu")},{key:"menuBar/home",id:at.xb.MenubarHomeMenu,description:(0,at.EM)(12951,"The home indicator context menu (web only)"),proposed:"contribMenuBarHome",supportsSubmenus:!1},{key:"menuBar/edit/copy",id:at.xb.MenubarCopy,description:(0,at.EM)(12952,"'Copy as' submenu in the top level Edit menu")},{key:"scm/title",id:at.xb.SCMTitle,description:(0,at.EM)(12953,"The Source Control title menu")},{key:"scm/sourceControl",id:at.xb.SCMSourceControl,description:(0,at.EM)(12954,"The Source Control menu")},{key:"scm/sourceControl/title",id:at.xb.SCMSourceControlTitle,description:(0,at.EM)(12955,"The Source Control title menu"),proposed:"contribSourceControlTitleMenu"},{key:"scm/resourceState/context",id:at.xb.SCMResourceContext,description:(0,at.EM)(12956,"The Source Control resource state context menu")},{key:"scm/resourceFolder/context",id:at.xb.SCMResourceFolderContext,description:(0,at.EM)(12957,"The Source Control resource folder context menu")},{key:"scm/resourceGroup/context",id:at.xb.SCMResourceGroupContext,description:(0,at.EM)(12958,"The Source Control resource group context menu")},{key:"scm/change/title",id:at.xb.SCMChangeContext,description:(0,at.EM)(12959,"The Source Control inline change menu")},{key:"scm/inputBox",id:at.xb.SCMInputBox,description:(0,at.EM)(12960,"The Source Control input box menu"),proposed:"contribSourceControlInputBoxMenu"},{key:"scm/history/title",id:at.xb.SCMHistoryTitle,description:(0,at.EM)(12961,"The Source Control History title menu"),proposed:"contribSourceControlHistoryTitleMenu"},{key:"scm/historyItem/context",id:at.xb.SCMHistoryItemContext,description:(0,at.EM)(12962,"The Source Control history item context menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"scm/historyItem/hover",id:at.xb.SCMHistoryItemHover,description:(0,at.EM)(12963,"The Source Control history item hover menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"scm/historyItemRef/context",id:at.xb.SCMHistoryItemRefContext,description:(0,at.EM)(12964,"The Source Control history item reference context menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"statusBar/remoteIndicator",id:at.xb.StatusBarRemoteIndicatorMenu,description:(0,at.EM)(12965,"The remote indicator menu in the status bar"),supportsSubmenus:!1},{key:"terminal/context",id:at.xb.TerminalInstanceContext,description:(0,at.EM)(12966,"The terminal context menu")},{key:"terminal/title/context",id:at.xb.TerminalTabContext,description:(0,at.EM)(12967,"The terminal tabs context menu")},{key:"view/title",id:at.xb.ViewTitle,description:(0,at.EM)(12968,"The contributed view title menu")},{key:"viewContainer/title",id:at.xb.ViewContainerTitle,description:(0,at.EM)(12969,"The contributed view container title menu"),proposed:"contribViewContainerTitle"},{key:"view/item/context",id:at.xb.ViewItemContext,description:(0,at.EM)(12970,"The contributed view item context menu")},{key:"comments/comment/editorActions",id:at.xb.CommentEditorActions,description:(0,at.EM)(12971,"The contributed comment editor actions"),proposed:"contribCommentEditorActionsMenu"},{key:"comments/commentThread/title",id:at.xb.CommentThreadTitle,description:(0,at.EM)(12972,"The contributed comment thread title menu")},{key:"comments/commentThread/context",id:at.xb.CommentThreadActions,description:(0,at.EM)(12973,"The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/additionalActions",id:at.xb.CommentThreadAdditionalActions,description:(0,at.EM)(12973,"The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!0,proposed:"contribCommentThreadAdditionalMenu"},{key:"comments/commentThread/title/context",id:at.xb.CommentThreadTitleContext,description:(0,at.EM)(12974,"The contributed comment thread title's peek context menu, rendered as a right click menu on the comment thread's peek title."),proposed:"contribCommentPeekContext"},{key:"comments/comment/title",id:at.xb.CommentTitle,description:(0,at.EM)(12975,"The contributed comment title menu")},{key:"comments/comment/context",id:at.xb.CommentActions,description:(0,at.EM)(12976,"The contributed comment context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/comment/context",id:at.xb.CommentThreadCommentContext,description:(0,at.EM)(12977,"The contributed comment context menu, rendered as a right click menu on the an individual comment in the comment thread's peek view."),proposed:"contribCommentPeekContext"},{key:"commentsView/commentThread/context",id:at.xb.CommentsViewThreadActions,description:(0,at.EM)(12978,"The contributed comment thread context menu in the comments view"),proposed:"contribCommentsViewThreadMenus"},{key:"notebook/toolbar",id:at.xb.NotebookToolbar,description:(0,at.EM)(12979,"The contributed notebook toolbar menu")},{key:"notebook/kernelSource",id:at.xb.NotebookKernelSource,description:(0,at.EM)(12980,"The contributed notebook kernel sources menu"),proposed:"notebookKernelSource"},{key:"notebook/cell/title",id:at.xb.NotebookCellTitle,description:(0,at.EM)(12981,"The contributed notebook cell title menu")},{key:"notebook/cell/execute",id:at.xb.NotebookCellExecute,description:(0,at.EM)(12982,"The contributed notebook cell execution menu")},{key:"interactive/toolbar",id:at.xb.InteractiveToolbar,description:(0,at.EM)(12983,"The contributed interactive toolbar menu")},{key:"interactive/cell/title",id:at.xb.InteractiveCellTitle,description:(0,at.EM)(12984,"The contributed interactive cell title menu")},{key:"issue/reporter",id:at.xb.IssueReporter,description:(0,at.EM)(12985,"The contributed issue reporter menu")},{key:"testing/item/context",id:at.xb.TestItem,description:(0,at.EM)(12986,"The contributed test item menu")},{key:"testing/item/gutter",id:at.xb.TestItemGutter,description:(0,at.EM)(12987,"The menu for a gutter decoration for a test item")},{key:"testing/profiles/context",id:at.xb.TestProfilesContext,description:(0,at.EM)(12988,"The menu for configuring testing profiles.")},{key:"testing/item/result",id:at.xb.TestPeekElement,description:(0,at.EM)(12989,"The menu for an item in the Test Results view or peek.")},{key:"testing/message/context",id:at.xb.TestMessageContext,description:(0,at.EM)(12990,"A prominent button overlaying editor content where the message is displayed")},{key:"testing/message/content",id:at.xb.TestMessageContent,description:(0,at.EM)(12991,"Context menu for the message in the results tree")},{key:"extension/context",id:at.xb.ExtensionContext,description:(0,at.EM)(12992,"The extension context menu")},{key:"timeline/title",id:at.xb.TimelineTitle,description:(0,at.EM)(12993,"The Timeline view title menu")},{key:"timeline/item/context",id:at.xb.TimelineItemContext,description:(0,at.EM)(12994,"The Timeline view item context menu")},{key:"ports/item/context",id:at.xb.TunnelContext,description:(0,at.EM)(12995,"The Ports view item context menu")},{key:"ports/item/origin/inline",id:at.xb.TunnelOriginInline,description:(0,at.EM)(12996,"The Ports view item origin inline menu")},{key:"ports/item/port/inline",id:at.xb.TunnelPortInline,description:(0,at.EM)(12997,"The Ports view item port inline menu")},{key:"file/newFile",id:at.xb.NewFile,description:(0,at.EM)(12998,"The 'New File...' quick pick, shown on welcome page and File menu."),supportsSubmenus:!1},{key:"webview/context",id:at.xb.WebviewContext,description:(0,at.EM)(12999,"The webview context menu")},{key:"file/share",id:at.xb.MenubarShare,description:(0,at.EM)(13e3,"Share submenu shown in the top level File menu."),proposed:"contribShareMenu"},{key:"editor/inlineCompletions/actions",id:at.xb.InlineCompletionsActions,description:(0,at.EM)(13001,"The actions shown when hovering on an inline completion"),supportsSubmenus:!1,proposed:"inlineCompletionsAdditions"},{key:"editor/content",id:at.xb.EditorContent,description:(0,at.EM)(13002,"The prominent button in an editor, overlays its content"),proposed:"contribEditorContentMenu"},{key:"editor/lineNumber/context",id:at.xb.EditorLineNumberContext,description:(0,at.EM)(13003,"The contributed editor line number context menu")},{key:"mergeEditor/result/title",id:at.xb.MergeInputResultToolbar,description:(0,at.EM)(13004,"The result toolbar of the merge editor"),proposed:"contribMergeEditorMenus"},{key:"multiDiffEditor/resource/title",id:at.xb.MultiDiffEditorFileToolbar,description:(0,at.EM)(13005,"The resource toolbar in the multi diff editor"),proposed:"contribMultiDiffEditorMenus"},{key:"diffEditor/gutter/hunk",id:at.xb.DiffEditorHunkToolbar,description:(0,at.EM)(13006,"The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"},{key:"diffEditor/gutter/selection",id:at.xb.DiffEditorSelectionToolbar,description:(0,at.EM)(13006,"The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"},{key:"searchPanel/aiResults/commands",id:at.xb.SearchActionMenu,description:(0,at.EM)(13007,"The commands that will contribute to the menu rendered as buttons next to the AI search title")},{key:"editor/context/chat",id:at.xb.ChatTextEditorMenu,description:(0,at.EM)(13008,"The Chat submenu in the text editor context menu."),supportsSubmenus:!1,proposed:"chatParticipantPrivate"},{key:"chat/chatSessions",id:at.xb.ChatSessionsMenu,description:(0,at.EM)(13009,"The Chat Sessions menu."),supportsSubmenus:!1,proposed:"chatSessionsProvider"},{key:"chat/multiDiff/context",id:at.xb.ChatMultiDiffContext,description:(0,at.EM)(13010,"The Chat Multi-Diff context menu."),supportsSubmenus:!1,proposed:"chatSessionsProvider"}];!function(e){function t(e){return"string"==typeof e.command}function i(e,t){return"string"==typeof e.command?e.alt&&"string"!=typeof e.alt?(t.error((0,at.EM)(13012,"property `{0}` can be omitted or must be of type `string`","alt")),!1):e.when&&"string"!=typeof e.when?(t.error((0,at.EM)(13012,"property `{0}` can be omitted or must be of type `string`","when")),!1):!e.group||"string"==typeof e.group||(t.error((0,at.EM)(13012,"property `{0}` can be omitted or must be of type `string`","group")),!1):(t.error((0,at.EM)(13011,"property `{0}` is mandatory and must be of type `string`","command")),!1)}function o(e,t){return"string"==typeof e.submenu?e.when&&"string"!=typeof e.when?(t.error((0,at.EM)(13012,"property `{0}` can be omitted or must be of type `string`","when")),!1):!e.group||"string"==typeof e.group||(t.error((0,at.EM)(13012,"property `{0}` can be omitted or must be of type `string`","group")),!1):(t.error((0,at.EM)(13011,"property `{0}` is mandatory and must be of type `string`","submenu")),!1)}e.isMenuItem=t,e.isValidMenuItem=i,e.isValidSubmenuItem=o,e.isValidItems=function(e,s){if(!Array.isArray(e))return s.error((0,at.EM)(13013,"submenu items must be an array")),!1;for(let r of e)if(t(r)){if(!i(r,s))return!1}else if(!o(r,s))return!1;return!0},e.isValidSubmenu=function(e,t){return"object"==typeof e?"string"==typeof e.id?"string"==typeof e.label||(t.error((0,at.EM)(13011,"property `{0}` is mandatory and must be of type `string`","label")),!1):(t.error((0,at.EM)(13011,"property `{0}` is mandatory and must be of type `string`","id")),!1):(t.error((0,at.EM)(13014,"submenu items must be an object")),!1)};let s={type:"object",required:["command"],properties:{command:{description:(0,at.EM)(13015,"Identifier of the command to execute. The command must be declared in the 'commands'-section"),type:"string"},alt:{description:(0,at.EM)(13016,"Identifier of an alternative command to execute. The command must be declared in the 'commands'-section"),type:"string"},when:{description:(0,at.EM)(13017,"Condition which must be true to show this item"),type:"string"},group:{description:(0,at.EM)(13018,"Group into which this item belongs"),type:"string"}}},r={type:"object",required:["submenu"],properties:{submenu:{description:(0,at.EM)(13019,"Identifier of the submenu to display in this item."),type:"string"},when:{description:(0,at.EM)(13017,"Condition which must be true to show this item"),type:"string"},group:{description:(0,at.EM)(13018,"Group into which this item belongs"),type:"string"}}},n={type:"object",required:["id","label"],properties:{id:{description:(0,at.EM)(13020,"Identifier of the menu to display as a submenu."),type:"string"},label:{description:(0,at.EM)(13021,"The label of the menu item which leads to this submenu."),type:"string"},icon:{description:(0,at.EM)(13022,'(Optional) Icon which is used to represent the submenu in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like "\\$(zap)"'),anyOf:[{type:"string"},{type:"object",properties:{light:{description:(0,at.EM)(13023,"Icon path when a light theme is used"),type:"string"},dark:{description:(0,at.EM)(13024,"Icon path when a dark theme is used"),type:"string"}}}]}}};function a(e,t,i){return void 0===e?(t.error((0,at.EM)(13030,"property `{0}` is mandatory and must be of type `string` or `object`",i)),!1):"string"==typeof e&&(0,at.oA)(e)?(t.error((0,at.EM)(13011,"property `{0}` is mandatory and must be of type `string`",i)),!1):"string"==typeof e||!(0,at.oA)(e.original)&&!(0,at.oA)(e.value)||(t.error((0,at.EM)(13031,"properties `{0}` and `{1}` are mandatory and must be of type `string`","".concat(i,".value"),"".concat(i,".original"))),!1)}e.menusContribution={description:(0,at.EM)(13025,"Contributes menu items to the editor"),type:"object",properties:(0,at.kN)(Tn,e=>e.key,e=>({markdownDescription:e.proposed?(0,at.EM)(13026,'Proposed API, requires `enabledApiProposal: ["{0}"]` - {1}',e.proposed,e.description):e.description,type:"array",items:!1===e.supportsSubmenus?s:{oneOf:[s,r]}})),additionalProperties:{description:"Submenu",type:"array",items:{oneOf:[s,r]}}},e.submenusContribution={description:(0,at.EM)(13027,"Contributes submenu items to the editor"),type:"array",items:n},e.isValidCommand=function(e,t){return e?(0,at.oA)(e.command)?(t.error((0,at.EM)(13011,"property `{0}` is mandatory and must be of type `string`","command")),!1):!(!a(e.title,t,"title")||e.shortTitle&&!a(e.shortTitle,t,"shortTitle"))&&(e.enablement&&"string"!=typeof e.enablement?(t.error((0,at.EM)(13012,"property `{0}` can be omitted or must be of type `string`","precondition")),!1):!(e.category&&!a(e.category,t,"category")||!function(e,t){return void 0===e||"string"==typeof e||"string"==typeof e.dark&&"string"==typeof e.light||(t.error((0,at.EM)(13029,"property `icon` can be omitted or must be either a string or a literal like `{dark, light}`")),!1)}(e.icon,t))):(t.error((0,at.EM)(13028,"expected non-empty value.")),!1)};let d={type:"object",required:["command","title"],properties:{command:{description:(0,at.EM)(13032,"Identifier of the command to execute"),type:"string"},title:{description:(0,at.EM)(13033,"Title by which the command is represented in the UI"),type:"string"},shortTitle:{markdownDescription:(0,at.EM)(13034,"(Optional) Short title by which the command is represented in the UI. Menus pick either `title` or `shortTitle` depending on the context in which they show commands."),type:"string"},category:{description:(0,at.EM)(13035,"(Optional) Category string by which the command is grouped in the UI"),type:"string"},enablement:{description:(0,at.EM)(13036,"(Optional) Condition which must be true to enable the command in the UI (menu and keybindings). Does not prevent executing the command by other means, like the `executeCommand`-api."),type:"string"},icon:{description:(0,at.EM)(13037,'(Optional) Icon which is used to represent the command in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like "\\$(zap)"'),anyOf:[{type:"string"},{type:"object",properties:{light:{description:(0,at.EM)(13038,"Icon path when a light theme is used"),type:"string"},dark:{description:(0,at.EM)(13039,"Icon path when a dark theme is used"),type:"string"}}}]}}};e.commandsContribution={description:(0,at.EM)(13040,"Contributes commands to the command palette."),oneOf:[d,{type:"array",items:d}]}}(Mn||(Mn={}));var Rn=new at.gj,On=pt.wt.registerExtensionPoint({extensionPoint:"commands",jsonSchema:Mn.commandsContribution,activationEventsGenerator:(e,t)=>{for(let i of e)i.command&&t.push("onCommand:".concat(i.command))}});On.setHandler(e=>{function t(e,t){var i,o;if(!Mn.isValidCommand(e,t.collector))return;let s,{icon:r,enablement:n,category:a,title:d,shortTitle:l,command:c}=e;r&&(s="string"==typeof r?null!==(i=at.Bb.fromString(r))&&void 0!==i?i:{dark:(0,at.gT)(t.description.extensionLocation,r),light:(0,at.gT)(t.description.extensionLocation,r)}:{dark:(0,at.gT)(t.description.extensionLocation,r.dark),light:(0,at.gT)(t.description.extensionLocation,r.light)});let h=at.Cb.getCommand(c);h&&(h.source?t.collector.info((0,at.EM)(13041,"Command `{0}` already registered by {1} ({2})",e.command,h.source.title,h.source.id)):t.collector.info((0,at.EM)(13042,"Command `{0}` already registered",e.command))),Rn.add(at.Cb.addCommand({id:c,title:d,source:{id:t.description.identifier.value,title:null!==(o=t.description.displayName)&&void 0!==o?o:t.description.name},shortTitle:l,tooltip:d,category:a,precondition:at.Mk.deserialize(n),icon:s}))}Rn.clear();for(let i of e){let{value:e}=i;if(Array.isArray(e))for(let o of e)t(o,i);else t(e,i)}});var Wn=new Map,Ln=pt.wt.registerExtensionPoint({extensionPoint:"submenus",jsonSchema:Mn.submenusContribution});Ln.setHandler(e=>{Wn.clear();for(let t of e){let{value:e,collector:i}=t;for(let[,o]of Object.entries(e)){if(!Mn.isValidSubmenu(o,i))continue;if(!o.id){i.warn((0,at.EM)(13043,"`{0}` is not a valid submenu identifier",o.id));continue}if(Wn.has(o.id)){i.info((0,at.EM)(13044,"The `{0}` submenu was already previously registered.",o.id));continue}if(!o.label){i.warn((0,at.EM)(13045,"`{0}` is not a valid submenu label",o.label));continue}let e;o.icon&&(e="string"==typeof o.icon?at.Bb.fromString(o.icon)||{dark:(0,at.gT)(t.description.extensionLocation,o.icon)}:{dark:(0,at.gT)(t.description.extensionLocation,o.icon.dark),light:(0,at.gT)(t.description.extensionLocation,o.icon.light)});let s={id:at.xb.for("api:".concat(o.id)),label:o.label,icon:e};Wn.set(o.id,s)}}});var Jn=new Map(Tn.map(e=>[e.key,e])),Gn=new at.gj,Nn=new Map;pt.wt.registerExtensionPoint({extensionPoint:"menus",jsonSchema:Mn.menusContribution,deps:[Ln]}).setHandler(e=>{Gn.clear(),Nn.clear();for(let i of e){let{value:e,collector:o}=i;for(let s of Object.entries(e)){if(!Mn.isValidItems(s[1],o))continue;let e=Jn.get(s[0]);if(!e){let t=Wn.get(s[0]);t&&(e={key:s[0],id:t.id,description:""})}if(e){if(e.proposed&&!(0,ut.h_)(i.description,e.proposed)){o.error((0,at.EM)(13046,"{0} is a proposed menu identifier. It requires 'package.json#enabledApiProposals: [\"{1}\"]' and is only available when running out of dev or with the following command line switch: --enable-proposed-api {2}",s[0],e.proposed,i.description.identifier.value));continue}for(let i of s[1]){var t;let r;if(Mn.isMenuItem(i)){let e=at.Cb.getCommand(i.command),t=i.alt&&at.Cb.getCommand(i.alt)||void 0;if(!e){o.error((0,at.EM)(13047,"Menu item references a command `{0}` which is not defined in the 'commands' section.",i.command));continue}i.alt&&!t&&o.warn((0,at.EM)(13048,"Menu item references an alt-command `{0}` which is not defined in the 'commands' section.",i.alt)),i.command===i.alt&&o.info((0,at.EM)(13049,"Menu item references the same command as default and alt-command")),r={command:e,alt:t,group:void 0,order:void 0,when:void 0}}else{if(!1===e.supportsSubmenus){o.error((0,at.EM)(13050,"Menu item references a submenu for a menu which doesn't have submenu support."));continue}let t=Wn.get(i.submenu);if(!t){o.error((0,at.EM)(13051,"Menu item references a submenu `{0}` which is not defined in the 'submenus' section.",i.submenu));continue}let n=Nn.get(e.id.id);if(n||(n=new Set,Nn.set(e.id.id,n)),n.has(t.id.id)){o.warn((0,at.EM)(13052,"The `{0}` submenu was already contributed to the `{1}` menu.",i.submenu,s[0]));continue}n.add(t.id.id),r={submenu:t.id,icon:t.icon,title:t.label,group:void 0,order:void 0,when:void 0}}if(i.group){let e=i.group.lastIndexOf("@");e>0?(r.group=i.group.substr(0,e),r.order=Number(i.group.substr(e+1))||void 0):r.group=i.group}e.id!==at.xb.ViewContainerTitle||null!==(t=i.when)&&void 0!==t&&t.includes("viewContainer == workbench.view.debug")?(r.when=at.Mk.deserialize(i.when),Gn.add(at.Cb.appendMenuItem(e.id,r))):o.error((0,at.EM)(13053,"The {0} menu contribution must check {1} in its {2} clause.","`viewContainer/title`","`viewContainer == workbench.view.debug`",'"when"'))}}}}});var Kn=class extends at.mj{constructor(e){super(),this._keybindingService=e,this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.commands)}render(e){var t,i,o;let s=((null===(t=e.contributes)||void 0===t?void 0:t.commands)||[]).map(e=>({id:e.command,title:e.title,keybindings:[],menus:[]})),r=(0,at.kN)(s,e=>e.id),n=(null===(i=e.contributes)||void 0===i?void 0:i.menus)||{},a=(0,at.kN)(s,e=>e.id);if(n.commandPalette)for(let d of n.commandPalette)delete a[d.command];if(Object.keys(a).length)for(let d in n.commandPalette||(n.commandPalette=[]),a)n.commandPalette.push({command:d});for(let d in n)for(let e of n[d])if("false"!==e.when&&e.command){let t=r[e.command];t?t.menus.includes(d)||t.menus.push(d):(t={id:e.command,title:"",keybindings:[],menus:[d]},r[t.id]=t,s.push(t))}return(null!==(o=e.contributes)&&void 0!==o&&o.keybindings?Array.isArray(e.contributes.keybindings)?e.contributes.keybindings:[e.contributes.keybindings]:[]).forEach(e=>{let t=this.resolveKeybinding(e);if(!t)return;let i=r[e.command];i?i.keybindings.push(t):(i={id:e.command,title:"",keybindings:[t],menus:[]},r[i.id]=i,s.push(i))}),s.length?{data:{headers:[(0,at.EM)(13054,"ID"),(0,at.EM)(13055,"Title"),(0,at.EM)(13056,"Keyboard Shortcuts"),(0,at.EM)(13057,"Menu Contexts")],rows:s.sort((e,t)=>e.id.localeCompare(t.id)).map(e=>[(new at.Bc).appendMarkdown("`".concat(e.id,"`")),"string"==typeof e.title?e.title:e.title.value,e.keybindings,(new at.Bc).appendMarkdown("".concat(e.menus.sort((e,t)=>e.localeCompare(t)).map(e=>"`".concat(e,"`")).join("&nbsp;")))])},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}resolveKeybinding(e){let t;switch(at.BO){case"win32":t=e.win;break;case"linux":t=e.linux;break;case"darwin":t=e.mac}return this._keybindingService.resolveUserBinding(null!==t&&void 0!==t?t:e.key)[0]}};Kn=(0,at.Jb)([(0,at.Yb)(0,at.Ed)],Kn),at.jb.as(pt._t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"commands",label:(0,at.EM)(13058,"Commands"),access:{canToggle:!1},renderer:new at.Xp(Kn)}),(0,at.Pk)();var Zn=class{static writeKeybindingItem(e,t){if(!t.resolvedKeybinding)return;let i=JSON.stringify(t.resolvedKeybinding.getUserSettingsLabel());e.write('{ "key": '.concat(function(e,t){return e.length<t?e+Array(t-e.length).join(" "):e}(i+",",25),' "command": '));let o=t.when?JSON.stringify(t.when.serialize()):"",s=JSON.stringify(t.command);o.length>0?(e.write("".concat(s,",")),e.writeLine(),e.write('                                     "when": '.concat(o))):e.write("".concat(s)),t.commandArgs&&(e.write(","),e.writeLine(),e.write('                                     "args": '.concat(JSON.stringify(t.commandArgs)))),e.write(" }")}static readUserKeybindingItem(e){let t="key"in e&&"string"==typeof e.key?Dn.parseKeybinding(e.key):null,i="when"in e&&"string"==typeof e.when?at.Mk.deserialize(e.when):void 0;return{keybinding:t,command:"command"in e&&"string"==typeof e.command?e.command:null,commandArgs:"args"in e&&void 0!==e.args?e.args:void 0,when:i,_sourceKey:"key"in e&&"string"==typeof e.key?e.key:void 0}}};var Bn,Pn=class{constructor(){this._lines=[],this._currentLine=""}write(e){this._currentLine+=e}writeLine(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this._lines.push(this._currentLine+e),this._currentLine=""}toString(){return this.writeLine(),this._lines.join("\n")}};(0,at.Xb)(),(0,at.TM)(),(0,at.oE)(),(0,at.tE)(),(0,at.oS)(),(0,at.KT)(),(0,at.SE)(),(0,at.Ww)(),(0,at.sj)(),(0,at.go)(),(0,at.Za)(),(0,at.QT)(),(0,at.QO)(),(0,at.wj)(),(0,at.LM)(),(0,at.iM)(),(0,at.dT)(),(0,at.Li)(),(0,at.Tb)(),(0,at.Ib)(),(0,at.Rb)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.Qs)(),(0,at.ps)(),(0,at.Jp)(),(0,at.B_)(),(0,at.no)(),(0,at.ox)(),(0,at.xc)(),(0,at.Ab)(),(0,at.$a)(),(0,gt.ar)(),(0,at.gb)(),(0,at.Fd)(),(0,at.Mb)(),(0,at.yb)(),(0,at.Go)(),(0,at.AN)(),(0,pt.Nt)(),(0,pt.Tt)(),(0,dt.z)(),(0,ut.Sg)(),(0,gt.Pt)();var Fn={type:"object",default:{command:"",key:""},properties:{command:{description:(0,at.EM)(13453,"Identifier of the command to run when keybinding is triggered."),type:"string"},args:{description:(0,at.EM)(13454,"Arguments to pass to the command to execute.")},key:{description:(0,at.EM)(13455,"Key or key sequence (separate keys with plus-sign and sequences with space, e.g. Ctrl+O and Ctrl+L L for a chord)."),type:"string"},mac:{description:(0,at.EM)(13456,"Mac specific key or key sequence."),type:"string"},linux:{description:(0,at.EM)(13457,"Linux specific key or key sequence."),type:"string"},win:{description:(0,at.EM)(13458,"Windows specific key or key sequence."),type:"string"},when:{description:(0,at.EM)(13459,"Condition when the key is active."),type:"string"}}},Yn=pt.wt.registerExtensionPoint({extensionPoint:"keybindings",deps:[On],jsonSchema:{description:(0,at.EM)(13460,"Contributes keybindings."),oneOf:[Fn,{type:"array",items:Fn}]}}),Qn=[at.XO.NumpadDivide,at.XO.NumpadMultiply,at.XO.NumpadSubtract,at.XO.NumpadAdd,at.XO.Numpad1,at.XO.Numpad2,at.XO.Numpad3,at.XO.Numpad4,at.XO.Numpad5,at.XO.Numpad6,at.XO.Numpad7,at.XO.Numpad8,at.XO.Numpad9,at.XO.Numpad0,at.XO.NumpadDecimal],Xn=new Map;Xn.set(at.XO.Numpad1,at.KO.Digit1),Xn.set(at.XO.Numpad2,at.KO.Digit2),Xn.set(at.XO.Numpad3,at.KO.Digit3),Xn.set(at.XO.Numpad4,at.KO.Digit4),Xn.set(at.XO.Numpad5,at.KO.Digit5),Xn.set(at.XO.Numpad6,at.KO.Digit6),Xn.set(at.XO.Numpad7,at.KO.Digit7),Xn.set(at.XO.Numpad8,at.KO.Digit8),Xn.set(at.XO.Numpad9,at.KO.Digit9),Xn.set(at.XO.Numpad0,at.KO.Digit0);var Hn=Bn=class extends at.to{constructor(e,t,i,o,s,r,n,a,d,l,c){super(e,t,i,o,l),this.hostService=r,this.keyboardLayoutService=c,this._contributions=[],this.isComposingGlobalContextKey=e.createKey("isComposing",!1),this.kbsJsonSchema=new jn,this.updateKeybindingsJsonSchema(),this._keyboardMapper=this.keyboardLayoutService.getKeyboardMapper(),this._register(this.keyboardLayoutService.onDidChangeKeyboardLayout(()=>{this._keyboardMapper=this.keyboardLayoutService.getKeyboardMapper(),this.updateResolver()})),this._keybindingHoldMode=null,this._cachedResolver=null,this.userKeybindings=this._register(new Un(s,d,a,l)),this.userKeybindings.initialize().then(()=>{this.userKeybindings.keybindings.length&&this.updateResolver()}),this._register(this.userKeybindings.onDidChange(()=>{l.debug("User keybindings changed"),this.updateResolver()})),Yn.setHandler(e=>{let t=[];for(let i of e)this._handleKeybindingsExtensionPointUser(i.description.identifier,i.description.isBuiltin,i.value,i.collector,t);at.kb.setExtensionKeybindings(t),this.updateResolver()}),this.updateKeybindingsJsonSchema(),this._register(n.onDidRegisterExtensions(()=>this.updateKeybindingsJsonSchema())),this._register(at.tj.runAndSubscribe(at.ES,e=>{let{window:t,disposables:i}=e;return i.add(this._registerKeyListeners(t))},{window:at.wE,disposables:this._store})),this._register((0,at.gE)(e=>{if(e!==at.wE.vscodeWindowId)return;let t=navigator.keyboard;at.$T.keyboard!==at.eE.None&&((0,at.uE)(at.wE)?null===t||void 0===t||t.lock(["Escape"]):null===t||void 0===t||t.unlock(),this._cachedResolver=null,this._onDidUpdateKeybindings.fire())}))}dispose(){this._contributions.forEach(e=>{var t;return null===(t=e.listener)||void 0===t?void 0:t.dispose()}),this._contributions.length=0,super.dispose()}_registerKeyListeners(e){let t=new at.gj;return t.add((0,at.Sx)(e,at._x.KEY_DOWN,e=>{if(this._keybindingHoldMode)return;this.isComposingGlobalContextKey.set(e.isComposing);let t=new at.GT(e);this._log("/ Received  keydown event - ".concat((0,at.qT)(e))),this._log("| Converted keydown event - ".concat((0,at.JT)(t))),this._dispatch(t,t.target)&&t.preventDefault(),this.isComposingGlobalContextKey.set(!1)})),t.add((0,at.Sx)(e,at._x.KEY_UP,e=>{this._resetKeybindingHoldMode(),this.isComposingGlobalContextKey.set(e.isComposing);let t=new at.GT(e);this._singleModifierDispatch(t,t.target)&&t.preventDefault(),this.isComposingGlobalContextKey.set(!1)})),t}registerSchemaContribution(e){var t;let i=null===(t=e.onDidChange)||void 0===t?void 0:t.call(e,()=>this.updateKeybindingsJsonSchema()),o={listener:i,contribution:e};return this._contributions.push(o),this.updateKeybindingsJsonSchema(),(0,at.kj)(()=>{null!==i&&void 0!==i&&i.dispose(),(0,at.BN)(this._contributions,o),this.updateKeybindingsJsonSchema()})}updateKeybindingsJsonSchema(){this.kbsJsonSchema.updateSchema(this._contributions.flatMap(e=>e.contribution.getSchemaAdditions()))}_printKeybinding(e){return at.Xa.toLabel(at.eM,e.chords,e=>e instanceof at.YT?at.qO.toString(e.keyCode):at.ZO.toString(e.scanCode))||"[null]"}_printResolvedKeybinding(e){return e.getDispatchChords().map(e=>e||"[null]").join(" ")}_printResolvedKeybindings(e,t,i){let o="".concat(t.padStart(35," ")," => ");if(0!==i.length)for(let s of i)e.push("".concat(o).concat(this._printResolvedKeybinding(s).padStart(35," ")));else e.push("".concat(o).concat("[NO BINDING]".padStart(35," ")))}_dumpResolveKeybindingDebugInfo(){let e=new Set,t=[];t.push("Default Resolved Keybindings (unique only):");for(let o of at.kb.getDefaultKeybindings()){if(!o.keybinding)continue;let i=this._printKeybinding(o.keybinding);if(e.has(i))continue;e.add(i);let s=this._keyboardMapper.resolveKeybinding(o.keybinding);this._printResolvedKeybindings(t,i,s)}t.push("User Resolved Keybindings (unique only):");for(let o of this.userKeybindings.keybindings){var i;if(!o.keybinding)continue;let s=null!==(i=o._sourceKey)&&void 0!==i?i:"Impossible: missing source key, but has keybinding";if(e.has(s))continue;e.add(s);let r=this._keyboardMapper.resolveKeybinding(o.keybinding);this._printResolvedKeybindings(t,s,r)}return t.join("\n")}_dumpDebugInfo(){let e=JSON.stringify(this.keyboardLayoutService.getCurrentKeyboardLayout(),null,"\t"),t=this._keyboardMapper.dumpDebugInfo();return"Layout info:\n".concat(e,"\n\n").concat(this._dumpResolveKeybindingDebugInfo(),"\n\n").concat(t,"\n\nRaw mapping:\n").concat(JSON.stringify(this.keyboardLayoutService.getRawKeyboardMapping(),null,"\t"))}_dumpDebugInfoJSON(){let e={layout:this.keyboardLayoutService.getCurrentKeyboardLayout(),rawMapping:this.keyboardLayoutService.getRawKeyboardMapping()};return JSON.stringify(e,null,"\t")}enableKeybindingHoldMode(e){if(this._currentlyDispatchingCommandId!==e)return;this._keybindingHoldMode=new at.xw;let t=(0,at.US)((0,at.$x)(void 0)),i=t.onDidBlur(()=>this._resetKeybindingHoldMode());return this._keybindingHoldMode.p.finally(()=>{i.dispose(),t.dispose()}),this._log("+ Enabled hold-mode for ".concat(e,".")),this._keybindingHoldMode.p}_resetKeybindingHoldMode(){var e;this._keybindingHoldMode&&(this._keybindingHoldMode=(null!==(e=this._keybindingHoldMode)&&void 0!==e&&e.complete(),null))}customKeybindingsCount(){return this.userKeybindings.keybindings.length}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}getUserKeybindingItems(){return this._resolveUserKeybindingItems(this.userKeybindings.keybindings,!1)}_getResolver(){return this._cachedResolver||(this._cachedResolver=new at.yc(this._resolveKeybindingItems(at.kb.getDefaultKeybindings(),!0),this.getUserKeybindingItems(),e=>this._log(e))),this._cachedResolver}_documentHasFocus(){return this.hostService.hasFocus}_resolveKeybindingItems(e,t){let i=[],o=0;for(let s of e){let e=s.when||void 0,r=s.keybinding;if(r){if(this._assertBrowserConflicts(r))continue;let n=this._keyboardMapper.resolveKeybinding(r);for(let r=n.length-1;r>=0;r--){let a=n[r];i[o++]=new at.Qa(a,s.command,s.commandArgs,e,t,s.extensionId,s.isBuiltinExtension)}}else i[o++]=new at.Qa(void 0,s.command,s.commandArgs,e,t,s.extensionId,s.isBuiltinExtension)}return i}_resolveUserKeybindingItems(e,t){let i=[],o=0;for(let s of e){let e=s.when||void 0;if(s.keybinding){let r=this._keyboardMapper.resolveKeybinding(s.keybinding);for(let n of r)i[o++]=new at.Qa(n,s.command,s.commandArgs,e,t,null,!1)}else i[o++]=new at.Qa(void 0,s.command,s.commandArgs,e,t,null,!1)}return i}_assertBrowserConflicts(e){if(at.$T.keyboard===at.eE.Always||at.$T.keyboard===at.eE.FullScreen&&(0,at.uE)(at.wE))return!1;for(let t of e.chords){if(!t.metaKey&&!t.altKey&&!t.ctrlKey&&!t.shiftKey)continue;let e=at.JO.CtrlCmd|at.JO.Alt|at.JO.Shift,i=0;if(t.metaKey&&(i|=at.JO.CtrlCmd),t.shiftKey&&(i|=at.JO.Shift),t.altKey&&(i|=at.JO.Alt),t.ctrlKey&&at.eM===at.tM.Macintosh&&(i|=at.JO.WinCtrl),(i&e)===(at.JO.CtrlCmd|at.JO.Alt)&&(t instanceof at.ZT&&(t.scanCode===at.XO.ArrowLeft||t.scanCode===at.XO.ArrowRight)||t instanceof at.YT&&(t.keyCode===at.KO.LeftArrow||t.keyCode===at.KO.RightArrow))||(i&e)===at.JO.CtrlCmd&&(t instanceof at.ZT&&t.scanCode>=at.XO.Digit1&&t.scanCode<=at.XO.Digit0||t instanceof at.YT&&t.keyCode>=at.KO.Digit0&&t.keyCode<=at.KO.Digit9))return!0}return!1}resolveKeybinding(e){return this._keyboardMapper.resolveKeybinding(e)}resolveKeyboardEvent(e){return this.keyboardLayoutService.validateCurrentKeyboardMapping(e),this._keyboardMapper.resolveKeyboardEvent(e)}resolveUserBinding(e){let t=Dn.parseKeybinding(e);return t?this._keyboardMapper.resolveKeybinding(t):[]}_handleKeybindingsExtensionPointUser(e,t,i,o,s){if(Array.isArray(i))for(let r=0,n=i.length;r<n;r++)this._handleKeybinding(e,t,r+1,i[r],o,s);else this._handleKeybinding(e,t,1,i,o,s)}_handleKeybinding(e,t,i,o,s,r){let n=[];if(function(e,t){return e?"string"==typeof e.command?e.key&&"string"!=typeof e.key?(t.push((0,at.EM)(13452,"property `{0}` can be omitted or must be of type `string`","key")),!1):e.when&&"string"!=typeof e.when?(t.push((0,at.EM)(13452,"property `{0}` can be omitted or must be of type `string`","when")),!1):e.mac&&"string"!=typeof e.mac?(t.push((0,at.EM)(13452,"property `{0}` can be omitted or must be of type `string`","mac")),!1):e.linux&&"string"!=typeof e.linux?(t.push((0,at.EM)(13452,"property `{0}` can be omitted or must be of type `string`","linux")),!1):!e.win||"string"==typeof e.win||(t.push((0,at.EM)(13452,"property `{0}` can be omitted or must be of type `string`","win")),!1):(t.push((0,at.EM)(13451,"property `{0}` is mandatory and must be of type `string`","command")),!1):(t.push((0,at.EM)(13450,"expected non-empty value.")),!1)}(o,n)){let s=this._asCommandRule(e,t,i++,o);s&&r.push(s)}n.length>0&&s.error((0,at.EM)(13461,"Invalid `contributes.{0}`: {1}",Yn.name,n.join("\n")))}static bindToCurrentPlatform(e,t,i,o){if(at.eM===at.tM.Windows&&o){if(o)return o}else if(at.eM===at.tM.Macintosh){if(t)return t}else if(i)return i;return e}_asCommandRule(e,t,i,o){let s,{command:r,args:n,when:a,key:d,mac:l,linux:c,win:h}=o,u=Bn.bindToCurrentPlatform(d,l,c,h);if(!u)return;s=t?at.Ob.BuiltinExtension+i:at.Ob.ExternalExtension+i;let g,p=at.Cb.getCommand(r),b=p&&p.precondition;return a&&b?g=at.Mk.and(b,at.Mk.deserialize(a)):a?g=at.Mk.deserialize(a):b&&(g=b),{id:r,args:n,when:g,weight:s,keybinding:Dn.parseKeybinding(u),extensionId:e.value,isBuiltinExtension:t}}getDefaultKeybindingsContent(){let e=this._getResolver(),t=e.getDefaultKeybindings(),i=e.getDefaultBoundCommands();return Bn._getDefaultKeybindings(t)+"\n\n"+Bn._getAllCommandsAsComment(i)}static _getDefaultKeybindings(e){let t=new Pn;t.writeLine("[");let i=e.length-1;return e.forEach((e,o)=>{Zn.writeKeybindingItem(t,e),o===i?t.writeLine():t.writeLine(",")}),t.writeLine("]"),t.toString()}static _getAllCommandsAsComment(e){let t=(0,gt.Nt)(e).sort().join("\n// - ");return"// "+(0,at.EM)(13462,"Here are other available commands: ")+"\n// - "+t}mightProducePrintableCharacter(e){if(e.ctrlKey||e.metaKey||e.altKey)return!1;let t=at.ZO.toEnum(e.code);if(-1!==Qn.indexOf(t))return!!(e.keyCode===at.UO[t]||at.pM&&e.keyCode===Xn.get(t));if(-1!==at.UO[t])return!1;let i=this.keyboardLayoutService.getRawKeyboardMapping();if(!i)return!1;let o=i[e.code];return!(!o||!o.value||/\s/.test(o.value))}};Hn=Bn=(0,at.Jb)([(0,at.Yb)(0,at.Nb),(0,at.Yb)(1,at.Lb),(0,at.Yb)(2,at.vb),(0,at.Yb)(3,at.Pd),(0,at.Yb)(4,ut.xg),(0,at.Yb)(5,dt.R),(0,at.Yb)(6,pt.Mt),(0,at.Yb)(7,at.fs),(0,at.Yb)(8,at.Wo),(0,at.Yb)(9,at.mb),(0,at.Yb)(10,gt.ir)],Hn);var Un=class extends at.mj{get keybindings(){return this._keybindings}constructor(e,t,i,o){super(),this.userDataProfileService=e,this.uriIdentityService=t,this.fileService=i,this._rawKeybindings=[],this._keybindings=[],this.watchDisposables=this._register(new at.gj),this._onDidChange=this._register(new at.ej),this.onDidChange=this._onDidChange.event,this.watch(),this.reloadConfigurationScheduler=this._register(new at.Aw(()=>this.reload().then(e=>{e&&this._onDidChange.fire()}),50)),this._register(at.tj.filter(this.fileService.onDidFilesChange,e=>e.contains(this.userDataProfileService.currentProfile.keybindingsResource))(()=>{o.debug("Keybindings file changed"),this.reloadConfigurationScheduler.schedule()})),this._register(this.fileService.onDidRunOperation(e=>{e.operation===at.Es.WRITE&&e.resource.toString()===this.userDataProfileService.currentProfile.keybindingsResource.toString()&&(o.debug("Keybindings file written"),this.reloadConfigurationScheduler.schedule())})),this._register(e.onDidChangeCurrentProfile(e=>{this.uriIdentityService.extUri.isEqual(e.previous.keybindingsResource,e.profile.keybindingsResource)||e.join(this.whenCurrentProfileChanged())}))}async whenCurrentProfileChanged(){this.watch(),this.reloadConfigurationScheduler.schedule()}watch(){this.watchDisposables.clear(),this.watchDisposables.add(this.fileService.watch((0,at.oT)(this.userDataProfileService.currentProfile.keybindingsResource))),this.watchDisposables.add(this.fileService.watch(this.userDataProfileService.currentProfile.keybindingsResource))}async initialize(){await this.reload()}async reload(){let e=await this.readUserKeybindings();return!(0,at.FM)(this._rawKeybindings,e)&&(this._rawKeybindings=e,this._keybindings=this._rawKeybindings.map(e=>Zn.readUserKeybindingItem(e)),!0)}async readUserKeybindings(){try{let e=(0,at._o)((await this.fileService.readFile(this.userDataProfileService.currentProfile.keybindingsResource)).value.toString());return Array.isArray(e)?e.filter(e=>e&&"object"==typeof e):[]}catch(e){return[]}}},jn=(j=class e{constructor(){this.commandsSchemas=[],this.commandsEnum=[],this.removalCommandsEnum=[],this.commandsEnumDescriptions=[],this.schema={id:e.schemaId,type:"array",title:(0,at.EM)(13463,"Keybindings configuration"),allowTrailingCommas:!0,allowComments:!0,definitions:{editorGroupsSchema:{type:"array",items:{type:"object",properties:{groups:{$ref:"#/definitions/editorGroupsSchema",default:[{},{}]},size:{type:"number",default:.5}}}},commandNames:{type:"string",enum:this.commandsEnum,enumDescriptions:this.commandsEnumDescriptions,description:(0,at.EM)(13464,"Name of the command to execute")},commandType:{anyOf:[{$ref:"#/definitions/commandNames"},{type:"string",enum:this.removalCommandsEnum,enumDescriptions:this.commandsEnumDescriptions,description:(0,at.EM)(13465,"Name of the command to remove keyboard shortcut for")},{type:"string"}]},commandsSchemas:{allOf:this.commandsSchemas}},items:{required:["key"],type:"object",defaultSnippets:[{body:{key:"$1",command:"$2",when:"$3"}}],properties:{key:{type:"string",description:(0,at.EM)(13466,"Key or key sequence (separated by space)")},command:{anyOf:[{if:{type:"array"},then:{not:{type:"array"},errorMessage:(0,at.EM)(13467,"Incorrect type. Expected \"{0}\". The field 'command' does not support running multiple commands. Use command 'runCommands' to pass it multiple commands to run.","string")},else:{$ref:"#/definitions/commandType"}},{$ref:"#/definitions/commandType"}]},when:{type:"string",description:(0,at.EM)(13468,"Condition when the key is active.")},args:{description:(0,at.EM)(13469,"Arguments to pass to the command to execute.")}},$ref:"#/definitions/commandsSchemas"}},this.schemaRegistry=at.jb.as(at.z_.JSONContribution),this.schemaRegistry.registerSchema(e.schemaId,this.schema)}updateSchema(t){this.commandsSchemas.length=0,this.commandsEnum.length=0,this.removalCommandsEnum.length=0,this.commandsEnumDescriptions.length=0;let i=new Set,o=(e,t)=>{/^_/.test(e)||i.has(e)||(i.add(e),this.commandsEnum.push(e),this.commandsEnumDescriptions.push((0,at.zi)(t)?t.value:t),this.removalCommandsEnum.push("-".concat(e)))},s=at.Fb.getCommands();for(let[e,d]of s){var r,n;let t=d.metadata;if(o(e,null!==(r=null===t||void 0===t?void 0:t.description)&&void 0!==r?r:null===(n=at.Cb.getCommand(e))||void 0===n?void 0:n.title),!t||!t.args||1!==t.args.length||!t.args[0].schema)continue;let i=t.args[0].schema,s=void 0===t.args[0].isOptional?Array.isArray(i.required)&&i.required.length>0:!t.args[0].isOptional,a={if:{required:["command"],properties:{command:{const:e}}},then:{required:[].concat(s?["args"]:[]),properties:{args:i}}};this.commandsSchemas.push(a)}let a=at.Cb.getCommands();for(let e of a.keys())o(e);this.commandsSchemas.push(...t),this.schemaRegistry.notifySchemaChanged(e.schemaId)}},{_:j.schemaId="vscode://schemas/keybindings"},j);function zn(e,t){return!(!e||!t)&&!!(e.name&&t.name&&e.name===t.name||e.id&&t.id&&e.id===t.id||e.model&&t.model&&e.model===t.model&&e.layout===t.layout)}function qn(e){if(!e)return{label:"",description:""};if(e.name)return{label:e.text,description:""};if(e.id){let t=e;return t.localizedName?{label:t.localizedName,description:""}:/^com\.apple\.keylayout\./.test(t.id)?{label:t.id.replace(/^com\.apple\.keylayout\./,"").replace(/-/," "),description:""}:/^.*inputmethod\./.test(t.id)?{label:t.id.replace(/^.*inputmethod\./,"").replace(/[-\.]/," "),description:"Input Method (".concat(t.lang,")")}:{label:t.lang,description:""}}return{label:e.layout,description:""}}function $n(e){return e.name?e.name:e.id?e.id:e.layout}(0,at.QO)(),(0,at.iM)();var ea,ta=class e{constructor(e,t,i,o){this.layout=e,this.secondaryLayouts=t,this.mapping=function(e){let t=e,i={};for(let o in t){let e=t[o];if(e.length){let t=e[0],s=e[1],r=e[2],n=e[3],a=Number(e[4]);i[o]={value:t,vkey:6===e.length?e[5]:void 0,withShift:s,withAltGr:r,withShiftAltGr:n,valueIsDeadKey:(1&a)>0,withShiftIsDeadKey:(2&a)>0,withAltGrIsDeadKey:(4&a)>0,withShiftAltGrIsDeadKey:(8&a)>0}}else i[o]={value:"",valueIsDeadKey:!1,withShift:"",withShiftIsDeadKey:!1,withAltGr:"",withAltGrIsDeadKey:!1,withShiftAltGr:"",withShiftAltGrIsDeadKey:!1}}return i}(i),this.isUserKeyboardLayout=!!o,this.layout.isUserKeyboardLayout=!!o}static createKeyboardLayoutFromDebugInfo(t,i,o){let s=new e(t,[],{},!0);return s.mapping=i,s}update(e){this.layout=e.layout,this.secondaryLayouts=e.secondaryLayouts,this.mapping=e.mapping,this.isUserKeyboardLayout=e.isUserKeyboardLayout,this.layout.isUserKeyboardLayout=e.isUserKeyboardLayout}getScore(e){let t=0;for(let i in e){if(at.yM&&("Backslash"===i||"KeyQ"===i)||at.dM&&("Backspace"===i||"Escape"===i))continue;let o=this.mapping[i];void 0===o&&--t;let s=e[i];o&&s&&o.value!==s.value&&--t}return t}equal(e){return this.isUserKeyboardLayout===e.isUserKeyboardLayout&&$n(this.layout)===$n(e.layout)&&this.fuzzyEqual(e.mapping)}fuzzyEqual(e){for(let t in e){if(at.yM&&("Backslash"===t||"KeyQ"===t))continue;if(void 0===this.mapping[t])return!1;let i=this.mapping[t],o=e[t];if(i.value!==o.value)return!1}return!0}};(0,at.TM)(),(0,at.iM)(),(0,at.A_)(),(0,at.Mb)(),function(e){e[e.Code=0]="Code",e[e.KeyCode=1]="KeyCode"}(ea||(ea={}));var ia=at.jb.as(at.b_.Configuration),oa={id:"keyboard",order:15,type:"object",title:(0,at.EM)(1922,"Keyboard"),properties:{"keyboard.dispatch":{scope:at.y_.APPLICATION,type:"string",enum:["code","keyCode"],default:"code",markdownDescription:(0,at.EM)(1923,"Controls the dispatching logic for key presses to use either `code` (recommended) or `keyCode`."),included:at.eM===at.tM.Macintosh||at.eM===at.tM.Linux},"keyboard.mapAltGrToCtrlAlt":{scope:at.y_.APPLICATION,type:"boolean",default:!1,markdownDescription:(0,at.EM)(1924,"Controls if the AltGraph+ modifier should be treated as Ctrl+Alt+."),included:at.eM===at.tM.Windows}}};ia.registerConfiguration(oa);var sa=class{constructor(e){this._actual=e,this._cache=new Map}dumpDebugInfo(){return this._actual.dumpDebugInfo()}resolveKeyboardEvent(e){return this._actual.resolveKeyboardEvent(e)}resolveKeybinding(e){let t=e.getHashCode(),i=this._cache.get(t);if(!i){let i=this._actual.resolveKeybinding(e);return this._cache.set(t,i),i}return i}};(0,at.zA)(),(0,at.QO)(),(0,at.QT)(),(0,at.Za)(),(0,at.iM)(),(0,at.qa)(),(0,at.$a)();var ra=class extends at.Ka{constructor(e,t){super(at.tM.Windows,t),this._mapper=e}_getLabel(e){return e.isDuplicateModifierCase()?"":this._mapper.getUILabelForKeyCode(e.keyCode)}_getUSLabelForKeybinding(e){return e.isDuplicateModifierCase()?"":at.qO.toString(e.keyCode)}getUSLabel(){return at.Ya.toLabel(this._os,this._chords,e=>this._getUSLabelForKeybinding(e))}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":this._mapper.getAriaLabelForKeyCode(e.keyCode)}_getElectronAccelerator(e){return this._mapper.getElectronAcceleratorForKeyBinding(e)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";let t=this._mapper.getUserSettingsLabelForKeyCode(e.keyCode);return t&&t.toLowerCase()}_isWYSIWYG(e){return this.__isWYSIWYG(e.keyCode)}__isWYSIWYG(e){return e===at.KO.LeftArrow||e===at.KO.UpArrow||e===at.KO.RightArrow||e===at.KO.DownArrow||this._mapper.getAriaLabelForKeyCode(e)===this._mapper.getUserSettingsLabelForKeyCode(e)}_getChordDispatch(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=at.qO.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode!==at.KO.Ctrl||e.shiftKey||e.altKey||e.metaKey?e.keyCode!==at.KO.Shift||e.ctrlKey||e.altKey||e.metaKey?e.keyCode!==at.KO.Alt||e.ctrlKey||e.shiftKey||e.metaKey?e.keyCode!==at.KO.Meta||e.ctrlKey||e.shiftKey||e.altKey?null:"meta":"alt":"shift":"ctrl"}static getProducedCharCode(e,t){return t?e.ctrlKey&&e.shiftKey&&e.altKey?t.withShiftAltGr:e.ctrlKey&&e.altKey?t.withAltGr:e.shiftKey?t.withShift:t.value:null}static getProducedChar(e,t){let i=this.getProducedCharCode(e,t);return null===i||0===i.length?" --- ":"  "+i+"  "}},na=class{constructor(e,t,i){this._isUSStandard=e,this._mapAltGrToCtrlAlt=i,this._keyCodeToLabel=[],this._scanCodeToKeyCode=[],this._keyCodeToLabel=[],this._keyCodeExists=[],this._keyCodeToLabel[at.KO.Unknown]=at.qO.toString(at.KO.Unknown);for(let n=at.XO.None;n<at.XO.MAX_VALUE;n++){let e=at.UO[n];e!==at.KO.DependsOnKbLayout&&(this._scanCodeToKeyCode[n]=e,this._keyCodeToLabel[e]=at.qO.toString(e),this._keyCodeExists[e]=!0)}let o=[],s=!1;for(let n in this._codeInfo=[],t)if(t.hasOwnProperty(n)){let e=at.ZO.toEnum(n);if(e===at.XO.None)continue;let i=t[n],r=at.UO[e];if(r!==at.KO.DependsOnKbLayout){let t=at.YO[i.vkey]||at.KO.Unknown;if(t===at.KO.Unknown||r===t||e!==at.XO.NumpadComma)continue}let a=i.value,d=i.withShift,l=i.withAltGr,c=i.withShiftAltGr,h=at.YO[i.vkey]||at.KO.Unknown,u={scanCode:e,keyCode:h,value:a,withShift:d,withAltGr:l,withShiftAltGr:c};if(this._codeInfo[e]=u,this._scanCodeToKeyCode[e]=h,h===at.KO.Unknown)continue;if(this._keyCodeExists[h]=!0,0===a.length)this._keyCodeToLabel[h]=null;else if(a.length>1)this._keyCodeToLabel[h]=a;else{let e=a.charCodeAt(0);if(e>=at.RA.a&&e<=at.RA.z){let t=at.RA.A+(e-at.RA.a);o[t]=!0,s=!0,this._keyCodeToLabel[h]=String.fromCharCode(at.RA.A+(e-at.RA.a))}else e>=at.RA.A&&e<=at.RA.Z?(o[e]=!0,s=!0,this._keyCodeToLabel[h]=a):this._keyCodeToLabel[h]=a}}let r=(e,t)=>{o[e]||(this._keyCodeToLabel[t]=String.fromCharCode(e))};if(r(at.RA.A,at.KO.KeyA),r(at.RA.B,at.KO.KeyB),r(at.RA.C,at.KO.KeyC),r(at.RA.D,at.KO.KeyD),r(at.RA.E,at.KO.KeyE),r(at.RA.F,at.KO.KeyF),r(at.RA.G,at.KO.KeyG),r(at.RA.H,at.KO.KeyH),r(at.RA.I,at.KO.KeyI),r(at.RA.J,at.KO.KeyJ),r(at.RA.K,at.KO.KeyK),r(at.RA.L,at.KO.KeyL),r(at.RA.M,at.KO.KeyM),r(at.RA.N,at.KO.KeyN),r(at.RA.O,at.KO.KeyO),r(at.RA.P,at.KO.KeyP),r(at.RA.Q,at.KO.KeyQ),r(at.RA.R,at.KO.KeyR),r(at.RA.S,at.KO.KeyS),r(at.RA.T,at.KO.KeyT),r(at.RA.U,at.KO.KeyU),r(at.RA.V,at.KO.KeyV),r(at.RA.W,at.KO.KeyW),r(at.RA.X,at.KO.KeyX),r(at.RA.Y,at.KO.KeyY),r(at.RA.Z,at.KO.KeyZ),!s){let e=(e,t)=>{this._keyCodeToLabel[e]=String.fromCharCode(t)};e(at.KO.Semicolon,at.RA.Semicolon),e(at.KO.Equal,at.RA.Equals),e(at.KO.Comma,at.RA.Comma),e(at.KO.Minus,at.RA.Dash),e(at.KO.Period,at.RA.Period),e(at.KO.Slash,at.RA.Slash),e(at.KO.Backquote,at.RA.BackTick),e(at.KO.BracketLeft,at.RA.OpenSquareBracket),e(at.KO.Backslash,at.RA.Backslash),e(at.KO.BracketRight,at.RA.CloseSquareBracket),e(at.KO.Quote,at.RA.SingleQuote)}}dumpDebugInfo(){let e=[],t=[at.XO.ArrowUp,at.XO.Numpad0],i=0;e.push("-----------------------------------------------------------------------------------------------------------------------------------------");for(let o=at.XO.None;o<at.XO.MAX_VALUE;o++){if(at.UO[o]!==at.KO.DependsOnKbLayout&&-1===t.indexOf(o))continue;i%6==0&&(e.push("|       HW Code combination      |  Key  |    KeyCode combination    |          UI label         |        User settings       | WYSIWYG |"),e.push("-----------------------------------------------------------------------------------------------------------------------------------------")),i++;let s=this._codeInfo[o],r=at.ZO.toString(o);for(let t of[0,2,5,7]){let i=!!(1&t),n=!!(2&t),a=!!(4&t),d=new at.ZT(i,n,a,!1,o),l=this._resolveChord(d),c=l?at.qO.toString(l.keyCode):null,h=l?new ra(this,[l]):null,u="".concat(i?"Ctrl+":"").concat(n?"Shift+":"").concat(a?"Alt+":"").concat(r),g=h?h.getAriaLabel():null,p=g?g.replace(/Control\+/,"Ctrl+"):null,b=h?h.getUserSettingsLabel():null,m=ra.getProducedChar(d,s),v=c?"".concat(i?"Ctrl+":"").concat(n?"Shift+":"").concat(a?"Alt+":"").concat(c):null,C=h&&h.isWYSIWYG()?"       ":"   NO  ";e.push("| ".concat(this._leftPad(u,30)," | ").concat(m," | ").concat(this._leftPad(v,25)," | ").concat(this._leftPad(p,25)," |  ").concat(this._leftPad(b,25)," | ").concat(C," |"))}e.push("-----------------------------------------------------------------------------------------------------------------------------------------")}return e.join("\n")}_leftPad(e,t){for(null===e&&(e="null");e.length<t;)e=" "+e;return e}getUILabelForKeyCode(e){return this._getLabelForKeyCode(e)}getAriaLabelForKeyCode(e){return this._getLabelForKeyCode(e)}getUserSettingsLabelForKeyCode(e){return this._isUSStandard?at.qO.toUserSettingsUS(e):at.qO.toUserSettingsGeneral(e)}getElectronAcceleratorForKeyBinding(e){return at.qO.toElectronAccelerator(e.keyCode)}_getLabelForKeyCode(e){return this._keyCodeToLabel[e]||at.qO.toString(at.KO.Unknown)}resolveKeyboardEvent(e){let t=e.ctrlKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,i=e.altKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,o=new at.YT(t,e.shiftKey,i,e.metaKey,e.keyCode);return new ra(this,[o])}_resolveChord(e){if(!e)return null;if(e instanceof at.YT)return this._keyCodeExists[e.keyCode]?e:null;let t=this._scanCodeToKeyCode[e.scanCode]||at.KO.Unknown;return t!==at.KO.Unknown&&this._keyCodeExists[t]?new at.YT(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t):null}resolveKeybinding(e){let t=(0,at.eo)(e.chords.map(e=>this._resolveChord(e)));return t.length>0?[new ra(this,t)]:[]}};(0,at.zA)(),(0,at.QO)(),(0,at.QT)(),(0,at.iM)(),(0,at.qa)();var aa=[],da=class extends at.Ka{constructor(e,t,i){super(t,i),this._mapper=e}_getLabel(e){return this._mapper.getUILabelForScanCodeChord(e)}_getAriaLabel(e){return this._mapper.getAriaLabelForScanCodeChord(e)}_getElectronAccelerator(e){return this._mapper.getElectronAcceleratorLabelForScanCodeChord(e)}_getUserSettingsLabel(e){return this._mapper.getUserSettingsLabelForScanCodeChord(e)}_isWYSIWYG(e){if(!e||at.UO[e.scanCode]!==at.KO.DependsOnKbLayout)return!0;let t=this._mapper.getAriaLabelForScanCodeChord(e),i=this._mapper.getUserSettingsLabelForScanCodeChord(e);return!t&&!i||!(!t||!i)&&t.toLowerCase()===i.toLowerCase()}_getChordDispatch(e){return this._mapper.getDispatchStrForScanCodeChord(e)}_getSingleModifierChordDispatch(e){return e.scanCode!==at.XO.ControlLeft&&e.scanCode!==at.XO.ControlRight||e.shiftKey||e.altKey||e.metaKey?e.scanCode!==at.XO.AltLeft&&e.scanCode!==at.XO.AltRight||e.ctrlKey||e.shiftKey||e.metaKey?e.scanCode!==at.XO.ShiftLeft&&e.scanCode!==at.XO.ShiftRight||e.ctrlKey||e.altKey||e.metaKey?e.scanCode!==at.XO.MetaLeft&&e.scanCode!==at.XO.MetaRight||e.ctrlKey||e.shiftKey||e.altKey?null:"meta":"shift":"alt":"ctrl"}},la=class{constructor(e,t,i,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.scanCode=o}toString(){return"".concat(this.ctrlKey?"Ctrl+":"").concat(this.shiftKey?"Shift+":"").concat(this.altKey?"Alt+":"").concat(at.ZO.toString(this.scanCode))}equals(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.scanCode===e.scanCode}getProducedCharCode(e){return e?this.ctrlKey&&this.shiftKey&&this.altKey?e.withShiftAltGr:this.ctrlKey&&this.altKey?e.withAltGr:this.shiftKey?e.withShift:e.value:""}getProducedChar(e){let t=ua.getCharCode(this.getProducedCharCode(e));return 0===t?" --- ":t>=at.RA.U_Combining_Grave_Accent&&t<=at.RA.U_Combining_Latin_Small_Letter_X?"U+"+t.toString(16):"  "+String.fromCharCode(t)+"  "}},ca=class{constructor(e,t,i,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.keyCode=o}toString(){return"".concat(this.ctrlKey?"Ctrl+":"").concat(this.shiftKey?"Shift+":"").concat(this.altKey?"Alt+":"").concat(at.qO.toString(this.keyCode))}},ha=class{constructor(){this._scanCodeToKeyCode=[],this._keyCodeToScanCode=[],this._scanCodeToKeyCode=[],this._keyCodeToScanCode=[]}registrationComplete(){this._moveToEnd(at.XO.IntlHash),this._moveToEnd(at.XO.IntlBackslash)}_moveToEnd(e){for(let t=0;t<8;t++){let i=this._scanCodeToKeyCode[(e<<3)+t];if(i)for(let t=0,o=i.length;t<o;t++){let o=this._keyCodeToScanCode[i[t]];if(1!==o.length)for(let t=0,i=o.length;t<i;t++){let s=o[t];if(s>>>3===e){for(let e=t+1;e<i;e++)o[e-1]=o[e];o[i-1]=s}}}}}registerIfUnknown(e,t){if(t.keyCode===at.KO.Unknown)return;let i=this._encodeScanCodeCombo(e),o=this._encodeKeyCodeCombo(t),s=t.keyCode>=at.KO.Digit0&&t.keyCode<=at.KO.Digit9,r=t.keyCode>=at.KO.KeyA&&t.keyCode<=at.KO.KeyZ,n=this._scanCodeToKeyCode[i];if(s||r){if(n)for(let a=0,d=n.length;a<d;a++)if(n[a]===o)return}else if(n&&0!==n.length)return;this._scanCodeToKeyCode[i]=this._scanCodeToKeyCode[i]||[],this._scanCodeToKeyCode[i].unshift(o),this._keyCodeToScanCode[o]=this._keyCodeToScanCode[o]||[],this._keyCodeToScanCode[o].unshift(i)}lookupKeyCodeCombo(e){let t=this._encodeKeyCodeCombo(e),i=this._keyCodeToScanCode[t];if(!i||0===i.length)return[];let o=[];for(let s=0,r=i.length;s<r;s++){let e=i[s];o[s]=new la(!!(1&e),!!(2&e),!!(4&e),e>>>3)}return o}lookupScanCodeCombo(e){let t=this._encodeScanCodeCombo(e),i=this._scanCodeToKeyCode[t];if(!i||0===i.length)return[];let o=[];for(let s=0,r=i.length;s<r;s++){let e=i[s];o[s]=new ca(!!(1&e),!!(2&e),!!(4&e),e>>>3)}return o}guessStableKeyCode(e){if(e>=at.XO.Digit1&&e<=at.XO.Digit0)switch(e){case at.XO.Digit1:return at.KO.Digit1;case at.XO.Digit2:return at.KO.Digit2;case at.XO.Digit3:return at.KO.Digit3;case at.XO.Digit4:return at.KO.Digit4;case at.XO.Digit5:return at.KO.Digit5;case at.XO.Digit6:return at.KO.Digit6;case at.XO.Digit7:return at.KO.Digit7;case at.XO.Digit8:return at.KO.Digit8;case at.XO.Digit9:return at.KO.Digit9;case at.XO.Digit0:return at.KO.Digit0}let t=this.lookupScanCodeCombo(new la(!1,!1,!1,e)),i=this.lookupScanCodeCombo(new la(!1,!0,!1,e));if(1===t.length&&1===i.length){let e=t[0].shiftKey,o=t[0].keyCode,s=i[0].shiftKey;if(o===i[0].keyCode&&e!==s)return o}return at.KO.DependsOnKbLayout}_encodeScanCodeCombo(e){return this._encode(e.ctrlKey,e.shiftKey,e.altKey,e.scanCode)}_encodeKeyCodeCombo(e){return this._encode(e.ctrlKey,e.shiftKey,e.altKey,e.keyCode)}_encode(e,t,i,o){return((e?1:0)|(t?1:0)<<1|(i?1:0)<<2|o<<3)>>>0}},ua=class e{constructor(t,i,o,s){this._isUSStandard=t,this._mapAltGrToCtrlAlt=o,this._OS=s,this._scanCodeToLabel=[],this._scanCodeToDispatch=[],this._codeInfo=[],this._scanCodeKeyCodeMapper=new ha,this._scanCodeToLabel=[],this._scanCodeToDispatch=[];let r=(e,t,i,o,s,r,n,a)=>{this._scanCodeKeyCodeMapper.registerIfUnknown(new la(!!e,!!t,!!i,o),new ca(!!s,!!r,!!n,a))},n=(e,t,i,o,s)=>{for(let n=e;n<=1;n++)for(let e=t;e<=1;e++)for(let t=i;t<=1;t++)r(n,e,t,o,n,e,t,s)};for(let e=at.XO.None;e<at.XO.MAX_VALUE;e++)this._scanCodeToLabel[e]=null;for(let e=at.XO.None;e<at.XO.MAX_VALUE;e++)this._scanCodeToDispatch[e]=null;for(let e=at.XO.None;e<at.XO.MAX_VALUE;e++){let t=at.UO[e];t!==at.KO.DependsOnKbLayout&&(n(0,0,0,e,t),this._scanCodeToLabel[e]=at.qO.toString(t),t===at.KO.Unknown||t===at.KO.Ctrl||t===at.KO.Meta||t===at.KO.Alt||t===at.KO.Shift?this._scanCodeToDispatch[e]=null:this._scanCodeToDispatch[e]="[".concat(at.ZO.toString(e),"]"))}let a={};{let t=[];for(let s in i)if(i.hasOwnProperty(s)){let o=at.ZO.toEnum(s);if(o===at.XO.None||at.UO[o]!==at.KO.DependsOnKbLayout)continue;let r=i[s],n=e.getCharCode(r.value);if(n>=at.RA.a&&n<=at.RA.z){let e=at.RA.A+(n-at.RA.a);t[e]=!0}}let o=(e,i,o,s)=>{t[e]||(a[at.ZO.toString(i)]={value:o,withShift:s,withAltGr:"",withShiftAltGr:""})};o(at.RA.A,at.XO.KeyA,"a","A"),o(at.RA.B,at.XO.KeyB,"b","B"),o(at.RA.C,at.XO.KeyC,"c","C"),o(at.RA.D,at.XO.KeyD,"d","D"),o(at.RA.E,at.XO.KeyE,"e","E"),o(at.RA.F,at.XO.KeyF,"f","F"),o(at.RA.G,at.XO.KeyG,"g","G"),o(at.RA.H,at.XO.KeyH,"h","H"),o(at.RA.I,at.XO.KeyI,"i","I"),o(at.RA.J,at.XO.KeyJ,"j","J"),o(at.RA.K,at.XO.KeyK,"k","K"),o(at.RA.L,at.XO.KeyL,"l","L"),o(at.RA.M,at.XO.KeyM,"m","M"),o(at.RA.N,at.XO.KeyN,"n","N"),o(at.RA.O,at.XO.KeyO,"o","O"),o(at.RA.P,at.XO.KeyP,"p","P"),o(at.RA.Q,at.XO.KeyQ,"q","Q"),o(at.RA.R,at.XO.KeyR,"r","R"),o(at.RA.S,at.XO.KeyS,"s","S"),o(at.RA.T,at.XO.KeyT,"t","T"),o(at.RA.U,at.XO.KeyU,"u","U"),o(at.RA.V,at.XO.KeyV,"v","V"),o(at.RA.W,at.XO.KeyW,"w","W"),o(at.RA.X,at.XO.KeyX,"x","X"),o(at.RA.Y,at.XO.KeyY,"y","Y"),o(at.RA.Z,at.XO.KeyZ,"z","Z")}let d=[],l=0;for(let c in i)if(i.hasOwnProperty(c)){let t=at.ZO.toEnum(c);if(t===at.XO.None||at.UO[t]!==at.KO.DependsOnKbLayout)continue;this._codeInfo[t]=i[c];let o=a[c]||i[c],s=e.getCharCode(o.value),r={scanCode:t,value:s,withShift:e.getCharCode(o.withShift),withAltGr:e.getCharCode(o.withAltGr),withShiftAltGr:e.getCharCode(o.withShiftAltGr)};if(d[l++]=r,this._scanCodeToDispatch[t]="[".concat(at.ZO.toString(t),"]"),s>=at.RA.a&&s<=at.RA.z){let e=at.RA.A+(s-at.RA.a);this._scanCodeToLabel[t]=String.fromCharCode(e)}else s>=at.RA.A&&s<=at.RA.Z||s?this._scanCodeToLabel[t]=String.fromCharCode(s):this._scanCodeToLabel[t]=null}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=t.withShiftAltGr;if(o===t.withAltGr||o===t.withShift||o===t.value)continue;let s=e._charCodeToKb(o);if(!s)continue;let n=s.shiftKey,a=s.keyCode;r(1,1,1,i,0,n?1:0,0,a)}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=t.withAltGr;if(o===t.withShift||o===t.value)continue;let s=e._charCodeToKb(o);if(!s)continue;let n=s.shiftKey,a=s.keyCode;r(1,0,1,i,0,n?1:0,0,a)}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=t.withShift;if(o===t.value)continue;let s=e._charCodeToKb(o);if(!s)continue;let n=s.shiftKey,a=s.keyCode;n?(r(0,1,0,i,0,1,0,a),r(0,1,1,i,0,1,1,a),r(1,1,0,i,1,1,0,a),r(1,1,1,i,1,1,1,a)):(r(0,1,0,i,0,0,0,a),r(0,1,0,i,0,1,0,a),r(0,1,1,i,0,0,1,a),r(0,1,1,i,0,1,1,a),r(1,1,0,i,1,0,0,a),r(1,1,0,i,1,1,0,a),r(1,1,1,i,1,0,1,a),r(1,1,1,i,1,1,1,a))}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=e._charCodeToKb(t.value);if(!o)continue;let s=o.shiftKey,n=o.keyCode;s?(r(0,0,0,i,0,1,0,n),r(0,0,1,i,0,1,1,n),r(1,0,0,i,1,1,0,n),r(1,0,1,i,1,1,1,n)):(r(0,0,0,i,0,0,0,n),r(0,0,1,i,0,0,1,n),r(0,1,0,i,0,1,0,n),r(0,1,1,i,0,1,1,n),r(1,0,0,i,1,0,0,n),r(1,0,1,i,1,0,1,n),r(1,1,0,i,1,1,0,n),r(1,1,1,i,1,1,1,n))}n(0,0,0,at.XO.Digit1,at.KO.Digit1),n(0,0,0,at.XO.Digit2,at.KO.Digit2),n(0,0,0,at.XO.Digit3,at.KO.Digit3),n(0,0,0,at.XO.Digit4,at.KO.Digit4),n(0,0,0,at.XO.Digit5,at.KO.Digit5),n(0,0,0,at.XO.Digit6,at.KO.Digit6),n(0,0,0,at.XO.Digit7,at.KO.Digit7),n(0,0,0,at.XO.Digit8,at.KO.Digit8),n(0,0,0,at.XO.Digit9,at.KO.Digit9),n(0,0,0,at.XO.Digit0,at.KO.Digit0),this._scanCodeKeyCodeMapper.registrationComplete()}dumpDebugInfo(){let e=[],t=[at.XO.ArrowUp,at.XO.Numpad0],i=0;e.push("isUSStandard: ".concat(this._isUSStandard)),e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");for(let o=at.XO.None;o<at.XO.MAX_VALUE;o++){if(at.UO[o]!==at.KO.DependsOnKbLayout&&-1===t.indexOf(o))continue;i%4==0&&(e.push("|       HW Code combination      |  Key  |    KeyCode combination    | Pri |          UI label         |         User settings          |    Electron accelerator   |       Dispatching string       | WYSIWYG |"),e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------")),i++;let s=this._codeInfo[o];for(let t=0;t<8;t++){let i=new la(!!(1&t),!!(2&t),!!(4&t),o),r=this.resolveKeyboardEvent({_standardKeyboardEventBrand:!0,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,altKey:i.altKey,metaKey:!1,altGraphKey:!1,keyCode:at.KO.DependsOnKbLayout,code:at.ZO.toString(o)}),n=i.toString(),a=i.getProducedChar(s),d=r.getAriaLabel(),l=d?d.replace(/Control\+/,"Ctrl+"):null,c=r.getUserSettingsLabel(),h=r.getElectronAccelerator(),u=r.getDispatchChords()[0],g=r&&r.isWYSIWYG()?"       ":"   NO  ",p=this._scanCodeKeyCodeMapper.lookupScanCodeCombo(i);if(0===p.length)e.push("| ".concat(this._leftPad(n,30)," | ").concat(a," | ").concat(this._leftPad("",25)," | ").concat(this._leftPad("",3)," | ").concat(this._leftPad(l,25)," | ").concat(this._leftPad(c,30)," | ").concat(this._leftPad(h,25)," | ").concat(this._leftPad(u,30)," | ").concat(g," |"));else for(let t=0,o=p.length;t<o;t++){let o,s=p[t],r=this._scanCodeKeyCodeMapper.lookupKeyCodeCombo(s);if(1===r.length)o="";else{let e=-1;for(let t=0;t<r.length;t++)if(r[t].equals(i)){e=t+1;break}o=String(e)}let d=s.toString();0===t?e.push("| ".concat(this._leftPad(n,30)," | ").concat(a," | ").concat(this._leftPad(d,25)," | ").concat(this._leftPad(o,3)," | ").concat(this._leftPad(l,25)," | ").concat(this._leftPad(c,30)," | ").concat(this._leftPad(h,25)," | ").concat(this._leftPad(u,30)," | ").concat(g," |")):e.push("| ".concat(this._leftPad("",30)," |       | ").concat(this._leftPad(d,25)," | ").concat(this._leftPad(o,3)," | ").concat(this._leftPad("",25)," | ").concat(this._leftPad("",30)," | ").concat(this._leftPad("",25)," | ").concat(this._leftPad("",30)," |         |"))}}e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------")}return e.join("\n")}_leftPad(e,t){for(null===e&&(e="null");e.length<t;)e=" "+e;return e}keyCodeChordToScanCodeChord(e){if(e.keyCode===at.KO.Enter)return[new at.ZT(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,at.XO.Enter)];let t=this._scanCodeKeyCodeMapper.lookupKeyCodeCombo(new ca(e.ctrlKey,e.shiftKey,e.altKey,e.keyCode)),i=[];for(let o=0,s=t.length;o<s;o++){let s=t[o];i[o]=new at.ZT(s.ctrlKey,s.shiftKey,s.altKey,e.metaKey,s.scanCode)}return i}getUILabelForScanCodeChord(e){if(!e)return null;if(e.isDuplicateModifierCase())return"";if(this._OS===at.tM.Macintosh)switch(e.scanCode){case at.XO.ArrowLeft:return"\u2190";case at.XO.ArrowUp:return"\u2191";case at.XO.ArrowRight:return"\u2192";case at.XO.ArrowDown:return"\u2193"}return this._scanCodeToLabel[e.scanCode]}getAriaLabelForScanCodeChord(e){return e?e.isDuplicateModifierCase()?"":this._scanCodeToLabel[e.scanCode]:null}getDispatchStrForScanCodeChord(e){let t=this._scanCodeToDispatch[e.scanCode];if(!t)return null;let i="";return e.ctrlKey&&(i+="ctrl+"),e.shiftKey&&(i+="shift+"),e.altKey&&(i+="alt+"),e.metaKey&&(i+="meta+"),i+=t,i}getUserSettingsLabelForScanCodeChord(e){if(!e)return null;if(e.isDuplicateModifierCase())return"";let t=at.UO[e.scanCode];if(t!==at.KO.DependsOnKbLayout)return at.qO.toUserSettingsUS(t).toLowerCase();let i=this._scanCodeKeyCodeMapper.guessStableKeyCode(e.scanCode);if(i!==at.KO.DependsOnKbLayout){let t=this.keyCodeChordToScanCodeChord(new at.YT(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,i));for(let o=0,s=t.length;o<s;o++)if(t[o].scanCode===e.scanCode)return at.qO.toUserSettingsUS(i).toLowerCase()}return this._scanCodeToDispatch[e.scanCode]}getElectronAcceleratorLabelForScanCodeChord(e){if(!e)return null;let t=at.UO[e.scanCode];if(t!==at.KO.DependsOnKbLayout)return at.qO.toElectronAccelerator(t);let i=this._scanCodeKeyCodeMapper.guessStableKeyCode(e.scanCode);return(this._OS!==at.tM.Linux||this._isUSStandard||i!==at.KO.Semicolon&&i!==at.KO.Equal&&i!==at.KO.Comma&&i!==at.KO.Minus&&i!==at.KO.Period&&i!==at.KO.Slash&&i!==at.KO.Backquote&&i!==at.KO.BracketLeft&&i!==at.KO.Backslash&&i!==at.KO.BracketRight)&&i!==at.KO.DependsOnKbLayout?at.qO.toElectronAccelerator(i):null}_toResolvedKeybinding(e){if(0===e.length)return[];let t=[];return this._generateResolvedKeybindings(e,0,[],t),t}_generateResolvedKeybindings(e,t,i,o){let s=e[t],r=t===e.length-1;for(let n=0,a=s.length;n<a;n++){let a=[...i,s[n]];r?o.push(new da(this,this._OS,a)):this._generateResolvedKeybindings(e,t+1,a,o)}}resolveKeyboardEvent(e){let t=at.ZO.toEnum(e.code);t===at.XO.NumpadEnter&&(t=at.XO.Enter);let i=e.keyCode;if(i===at.KO.LeftArrow||i===at.KO.UpArrow||i===at.KO.RightArrow||i===at.KO.DownArrow||i===at.KO.Delete||i===at.KO.Insert||i===at.KO.Home||i===at.KO.End||i===at.KO.PageDown||i===at.KO.PageUp||i===at.KO.Backspace){let e=at.WO[i];e!==at.XO.DependsOnKbLayout&&(t=e)}else if((t===at.XO.Numpad1||t===at.XO.Numpad2||t===at.XO.Numpad3||t===at.XO.Numpad4||t===at.XO.Numpad5||t===at.XO.Numpad6||t===at.XO.Numpad7||t===at.XO.Numpad8||t===at.XO.Numpad9||t===at.XO.Numpad0||t===at.XO.NumpadDecimal)&&i>=0){let e=at.WO[i];e!==at.XO.DependsOnKbLayout&&(t=e)}let o=e.ctrlKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,s=e.altKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,r=new at.ZT(o,e.shiftKey,s,e.metaKey,t);return new da(this,this._OS,[r])}_resolveChord(e){return e?e instanceof at.ZT?[e]:this.keyCodeChordToScanCodeChord(e):[]}resolveKeybinding(e){let t=e.chords.map(e=>this._resolveChord(e));return this._toResolvedKeybinding(t)}static _redirectCharCode(e){switch(e){case at.RA.U_IDEOGRAPHIC_FULL_STOP:return at.RA.Period;case at.RA.U_LEFT_CORNER_BRACKET:return at.RA.OpenSquareBracket;case at.RA.U_RIGHT_CORNER_BRACKET:return at.RA.CloseSquareBracket;case at.RA.U_LEFT_BLACK_LENTICULAR_BRACKET:return at.RA.OpenSquareBracket;case at.RA.U_RIGHT_BLACK_LENTICULAR_BRACKET:return at.RA.CloseSquareBracket;case at.RA.U_FULLWIDTH_SEMICOLON:return at.RA.Semicolon;case at.RA.U_FULLWIDTH_COMMA:return at.RA.Comma}return e}static _charCodeToKb(e){return(e=this._redirectCharCode(e))<aa.length?aa[e]:null}static getCharCode(e){if(0===e.length)return 0;let t=e.charCodeAt(0);switch(t){case at.RA.U_Combining_Grave_Accent:return at.RA.U_GRAVE_ACCENT;case at.RA.U_Combining_Acute_Accent:return at.RA.U_ACUTE_ACCENT;case at.RA.U_Combining_Circumflex_Accent:return at.RA.U_CIRCUMFLEX;case at.RA.U_Combining_Tilde:return at.RA.U_SMALL_TILDE;case at.RA.U_Combining_Macron:return at.RA.U_MACRON;case at.RA.U_Combining_Overline:return at.RA.U_OVERLINE;case at.RA.U_Combining_Breve:return at.RA.U_BREVE;case at.RA.U_Combining_Dot_Above:return at.RA.U_DOT_ABOVE;case at.RA.U_Combining_Diaeresis:return at.RA.U_DIAERESIS;case at.RA.U_Combining_Ring_Above:return at.RA.U_RING_ABOVE;case at.RA.U_Combining_Double_Acute_Accent:return at.RA.U_DOUBLE_ACUTE_ACCENT}return t}};(function(){function e(e,t,i){for(let o=aa.length;o<e;o++)aa[o]=null;aa[e]={keyCode:t,shiftKey:i}}for(let t=at.RA.A;t<=at.RA.Z;t++)e(t,at.KO.KeyA+(t-at.RA.A),!0);for(let t=at.RA.a;t<=at.RA.z;t++)e(t,at.KO.KeyA+(t-at.RA.a),!1);e(at.RA.Semicolon,at.KO.Semicolon,!1),e(at.RA.Colon,at.KO.Semicolon,!0),e(at.RA.Equals,at.KO.Equal,!1),e(at.RA.Plus,at.KO.Equal,!0),e(at.RA.Comma,at.KO.Comma,!1),e(at.RA.LessThan,at.KO.Comma,!0),e(at.RA.Dash,at.KO.Minus,!1),e(at.RA.Underline,at.KO.Minus,!0),e(at.RA.Period,at.KO.Period,!1),e(at.RA.GreaterThan,at.KO.Period,!0),e(at.RA.Slash,at.KO.Slash,!1),e(at.RA.QuestionMark,at.KO.Slash,!0),e(at.RA.BackTick,at.KO.Backquote,!1),e(at.RA.Tilde,at.KO.Backquote,!0),e(at.RA.OpenSquareBracket,at.KO.BracketLeft,!1),e(at.RA.OpenCurlyBrace,at.KO.BracketLeft,!0),e(at.RA.Backslash,at.KO.Backslash,!1),e(at.RA.Pipe,at.KO.Backslash,!0),e(at.RA.CloseSquareBracket,at.KO.BracketRight,!1),e(at.RA.CloseCurlyBrace,at.KO.BracketRight,!0),e(at.RA.SingleQuote,at.KO.Quote,!1),e(at.RA.DoubleQuote,at.KO.Quote,!0)})(),(0,at.Xb)(),(0,at.TM)(),(0,at.sj)(),(0,at.wj)(),(0,at.Jp)(),(0,at.iM)(),(0,gt.Nn)(),(0,at.ps)(),(0,at.Ww)(),(0,at.go)(),(0,at.LM)(),(0,at.Il)(),(0,at.Mb)(),(0,at.A_)(),(0,at.i_)(),(0,at.Fd)(),(0,at.Rb)(),(0,at.Lo)(),(0,at.ox)();var ga=class extends at.mj{get activeKeymap(){return this._activeKeymapInfo}get keymapInfos(){return this._keymapInfos}get activeKeyboardLayout(){var e,t;return this._initialized&&null!==(e=null===(t=this._activeKeymapInfo)||void 0===t?void 0:t.layout)&&void 0!==e?e:null}get activeKeyMapping(){var e,t;return this._initialized&&null!==(e=null===(t=this._activeKeymapInfo)||void 0===t?void 0:t.mapping)&&void 0!==e?e:null}get keyboardLayouts(){return this._keymapInfos.map(e=>e.layout)}constructor(e){super(),this._configurationService=e,this._onDidChangeKeyboardMapper=new at.ej,this.onDidChangeKeyboardMapper=this._onDidChangeKeyboardMapper.event,this.keyboardLayoutMapAllowed=void 0!==navigator.keyboard,this._keyboardMapper=null,this._initialized=!1,this._keymapInfos=[],this._mru=[],this._activeKeymapInfo=null,navigator.keyboard&&navigator.keyboard.addEventListener&&navigator.keyboard.addEventListener("layoutchange",()=>{this._getBrowserKeyMapping().then(e=>{this.isKeyMappingActive(e)||this.setLayoutFromBrowserAPI()})}),this._register(this._configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("keyboard")&&(this._keyboardMapper=null,this._onDidChangeKeyboardMapper.fire())}))}registerKeyboardLayout(e){this._keymapInfos.push(e),this._mru=this._keymapInfos}removeKeyboardLayout(e){let t=this._mru.indexOf(e);this._mru.splice(t,1),t=this._keymapInfos.indexOf(e),this._keymapInfos.splice(t,1)}getMatchedKeymapInfo(e){if(!e)return null;let t=this.getUSStandardLayout();if(t){let i=t.getScore(e);if(0===i)return{result:t,score:0};let o=t;for(let t=0;t<this._mru.length;t++){let s=this._mru[t].getScore(e);if(s>i){if(0===s)return{result:this._mru[t],score:0};i=s,o=this._mru[t]}}return{result:o,score:i}}for(let i=0;i<this._mru.length;i++)if(this._mru[i].fuzzyEqual(e))return{result:this._mru[i],score:0};return null}getUSStandardLayout(){let e=this._mru.filter(e=>e.layout.isUSStandard);return e.length?e[0]:null}isKeyMappingActive(e){return this._activeKeymapInfo&&e&&this._activeKeymapInfo.fuzzyEqual(e)}setUSKeyboardLayout(){this._activeKeymapInfo=this.getUSStandardLayout()}setActiveKeyMapping(e){let t=!1,i=this.getMatchedKeymapInfo(e);if(i&&(this._activeKeymapInfo?e&&i.result.getScore(e)>this._activeKeymapInfo.getScore(e)&&(this._activeKeymapInfo=i.result,t=!0):(this._activeKeymapInfo=i.result,t=!0)),this._activeKeymapInfo||(this._activeKeymapInfo=this.getUSStandardLayout(),t=!0),!this._activeKeymapInfo||!t)return;let o=this._mru.indexOf(this._activeKeymapInfo);this._mru.splice(o,1),this._mru.unshift(this._activeKeymapInfo),this._setKeyboardData(this._activeKeymapInfo)}setActiveKeymapInfo(e){this._activeKeymapInfo=e;let t=this._mru.indexOf(this._activeKeymapInfo);0!==t&&(this._mru.splice(t,1),this._mru.unshift(this._activeKeymapInfo),this._setKeyboardData(this._activeKeymapInfo))}setLayoutFromBrowserAPI(){this._updateKeyboardLayoutAsync(this._initialized)}_updateKeyboardLayoutAsync(e,t){e&&this._getBrowserKeyMapping(t).then(e=>{this.isKeyMappingActive(e)||this.setActiveKeyMapping(e)})}getKeyboardMapper(){let e=function(e){let t=e.getValue("keyboard");return{dispatch:"keyCode"===(null===t||void 0===t?void 0:t.dispatch)?ea.KeyCode:ea.Code,mapAltGrToCtrlAlt:!(null===t||void 0===t||!t.mapAltGrToCtrlAlt)}}(this._configurationService);return e.dispatch!==ea.KeyCode&&this._initialized&&this._activeKeymapInfo?(this._keyboardMapper||(this._keyboardMapper=new sa(pa._createKeyboardMapper(this._activeKeymapInfo,e.mapAltGrToCtrlAlt))),this._keyboardMapper):new gt.Mn(e.mapAltGrToCtrlAlt,at.eM)}validateCurrentKeyboardMapping(e){this._initialized&&(this._validateCurrentKeyboardMapping(e)||this._updateKeyboardLayoutAsync(!0,e))}setKeyboardLayout(e){let t=this.keymapInfos.filter(t=>$n(t.layout)===e);t.length>0&&this.setActiveKeymapInfo(t[0])}_setKeyboardData(e){this._initialized=!0,this._keyboardMapper=null,this._onDidChangeKeyboardMapper.fire()}static _createKeyboardMapper(e,t){let i=e.mapping,o=!!e.layout.isUSStandard;return at.eM===at.tM.Windows?new na(o,i,t):0===Object.keys(i).length?new gt.Mn(t,at.eM):new ua(o,i,t,at.eM)}_validateCurrentKeyboardMapping(e){if(!this._initialized)return!0;let t=e,i=this._activeKeymapInfo;if(!i||"Dead"===t.browserEvent.key||t.browserEvent.isComposing)return!0;let o=i.mapping[t.code];if(!o)return!1;if(""===o.value)return(e.ctrlKey||e.metaKey)&&setTimeout(()=>{this._getBrowserKeyMapping().then(e=>{this.isKeyMappingActive(e)||this.setLayoutFromBrowserAPI()})},350),!0;let s=t.altKey&&t.shiftKey?o.withShiftAltGr:t.altKey?o.withAltGr:t.shiftKey?o.withShift:o.value,r=t.altKey&&t.shiftKey&&o.withShiftAltGrIsDeadKey||t.altKey&&o.withAltGrIsDeadKey||t.shiftKey&&o.withShiftIsDeadKey||o.valueIsDeadKey;return!(r&&"Dead"!==t.browserEvent.key||!r&&t.browserEvent.key!==s)}async _getBrowserKeyMapping(e){if(this.keyboardLayoutMapAllowed)try{return await navigator.keyboard.getLayoutMap().then(e=>{let t={};for(let i of e)t[i[0]]={value:i[1],withShift:"",withAltGr:"",withShiftAltGr:""};return t})}catch(t){this.keyboardLayoutMapAllowed=!1}if(e&&!e.shiftKey&&!e.altKey&&!e.metaKey&&!e.metaKey){let t={},i=e;return t[i.browserEvent.code]={value:i.browserEvent.key,withShift:"",withAltGr:"",withShiftAltGr:""},this.getMatchedKeymapInfo(t)?t:null}return null}},pa=class extends ga{constructor(e,t,o,s){super(e),function(e){switch(e){case"./keyboardLayouts/layout.contribution.darwin.js":return i.e(3125).then(i.bind(i,3125)).then(e=>{var t;return null!==(t=e.default)&&void 0!==t?t:e});case"./keyboardLayouts/layout.contribution.linux.js":return i.e(7541).then(i.bind(i,7541)).then(e=>{var t;return null!==(t=e.default)&&void 0!==t?t:e});case"./keyboardLayouts/layout.contribution.win.js":return i.e(3716).then(i.bind(i,3716)).then(e=>{var t;return null!==(t=e.default)&&void 0!==t?t:e});default:return new Promise(function(t,i){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,Error("Unknown variable dynamic import: "+e)))})}}("./keyboardLayouts/layout.contribution.".concat(at.yM?"win":at.pM?"darwin":"linux",".js")).then(e=>{let t=e.KeyboardLayoutContribution.INSTANCE.layoutInfos;this._keymapInfos.push(...t.map(e=>new ta(e.layout,e.secondaryLayouts,e.mapping,e.isUserKeyboardLayout))),this._mru=this._keymapInfos,this._initialized=!0,this.setLayoutFromBrowserAPI()})}},ba=class extends at.mj{get keyboardLayout(){return this._keyboardLayout}constructor(e,t){super(),this.keyboardLayoutResource=e,this.fileService=t,this._onDidChange=this._register(new at.ej),this.onDidChange=this._onDidChange.event,this._keyboardLayout=null,this.reloadConfigurationScheduler=this._register(new at.Aw(()=>this.reload().then(e=>{e&&this._onDidChange.fire()}),50)),this._register(at.tj.filter(this.fileService.onDidFilesChange,e=>e.contains(this.keyboardLayoutResource))(()=>this.reloadConfigurationScheduler.schedule()))}async initialize(){await this.reload()}async reload(){let e=this._keyboardLayout;try{let e=(0,at._o)((await this.fileService.readFile(this.keyboardLayoutResource)).value.toString());if("object"===(0,at.ho)(e)){let t=e.layout,i=e.rawMapping;this._keyboardLayout=ta.createKeyboardLayoutFromDebugInfo(t,i,!0)}else this._keyboardLayout=null}catch(t){this._keyboardLayout=null}return!e||!(0,at.FM)(e,this._keyboardLayout)}},ma=class extends at.mj{constructor(e,t,i,o,s,r){super(),this.configurationService=r,this._onDidChangeKeyboardLayout=new at.ej,this.onDidChangeKeyboardLayout=this._onDidChangeKeyboardLayout.event;let n=r.getValue("keyboard").layout;this._keyboardLayoutMode=null!==n&&void 0!==n?n:"autodetect",this._factory=new pa(r,i,o,s),this._register(this._factory.onDidChangeKeyboardMapper(()=>{this._onDidChangeKeyboardLayout.fire()})),n&&"autodetect"!==n&&this._factory.setKeyboardLayout(n),this._register(r.onDidChangeConfiguration(e=>{if(e.affectsConfiguration("keyboard.layout")){let e=r.getValue("keyboard").layout;this._keyboardLayoutMode=e,"autodetect"===e?this._factory.setLayoutFromBrowserAPI():this._factory.setKeyboardLayout(e)}})),this._userKeyboardLayout=new ba(e.keyboardLayoutResource,t),this._userKeyboardLayout.initialize().then(()=>{this._userKeyboardLayout.keyboardLayout&&(this._factory.registerKeyboardLayout(this._userKeyboardLayout.keyboardLayout),this.setUserKeyboardLayoutIfMatched())}),this._register(this._userKeyboardLayout.onDidChange(()=>{let e=this._factory.keymapInfos.filter(e=>e.isUserKeyboardLayout);e.length?this._userKeyboardLayout.keyboardLayout?e[0].update(this._userKeyboardLayout.keyboardLayout):this._factory.removeKeyboardLayout(e[0]):this._userKeyboardLayout.keyboardLayout&&this._factory.registerKeyboardLayout(this._userKeyboardLayout.keyboardLayout),this.setUserKeyboardLayoutIfMatched()}))}setUserKeyboardLayoutIfMatched(){let e=this.configurationService.getValue("keyboard").layout;e&&this._userKeyboardLayout.keyboardLayout&&$n(this._userKeyboardLayout.keyboardLayout.layout)===e&&this._factory.activeKeymap&&(this._userKeyboardLayout.keyboardLayout.equal(this._factory.activeKeymap)||this._factory.setActiveKeymapInfo(this._userKeyboardLayout.keyboardLayout))}getKeyboardMapper(){return this._factory.getKeyboardMapper()}getCurrentKeyboardLayout(){return this._factory.activeKeyboardLayout}getAllKeyboardLayouts(){return this._factory.keyboardLayouts}getRawKeyboardMapping(){return this._factory.activeKeyMapping}validateCurrentKeyboardMapping(e){"autodetect"===this._keyboardLayoutMode&&this._factory.validateCurrentKeyboardMapping(e)}};ma=(0,at.Jb)([(0,at.Yb)(0,at.Fl),(0,at.Yb)(1,at.fs),(0,at.Yb)(2,at.Pd),(0,at.Yb)(3,at.Io),(0,at.Yb)(4,at.Lb),(0,at.Yb)(5,at.r_)],ma);var va=at.jb.as(at.b_.Configuration),Ca={id:"keyboard",order:15,type:"object",title:(0,at.EM)(13470,"Keyboard"),properties:{"keyboard.layout":{type:"string",default:"autodetect",description:(0,at.EM)(13471,"Control the keyboard layout used in web.")}}};va.registerConfiguration(Ca),(0,at.Xb)(),(0,at.Ww)(),(0,at.sj)(),(0,at.wj)(),(0,at.Ib)(),(0,at.ox)(),(0,at.Jp)(),(0,at.gb)(),(0,pt.Nt)();var wa=class extends at.mj{constructor(e,t,i){super(),this._instantiationService=e,this._extensionService=t,this._logService=i,this._extensionHostIsReady=!1,this._onWillExecuteCommand=this._register(new at.ej),this.onWillExecuteCommand=this._onWillExecuteCommand.event,this._onDidExecuteCommand=new at.ej,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._extensionService.whenInstalledExtensionsRegistered().then(e=>this._extensionHostIsReady=e),this._starActivation=null}_activateStar(){return this._starActivation||(this._starActivation=(0,at.Jw)([this._extensionService.activateByEvent("*"),(0,at.$w)(3e4)])),(0,at.Kw)(this._starActivation)}async executeCommand(e){this._logService.trace("CommandService#executeCommand",e);let t="onCommand:".concat(e);for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return at.Fb.getCommand(e)?this._extensionService.activationEventIsDone(t)?this._tryExecuteCommand(e,o):this._extensionHostIsReady?(await this._extensionService.activateByEvent(t),this._tryExecuteCommand(e,o)):(this._extensionService.activateByEvent(t),this._tryExecuteCommand(e,o)):(await Promise.all([this._extensionService.activateByEvent(t),(0,at.Jw)([this._activateStar(),at.tj.toPromise(at.tj.filter(at.Fb.onDidRegisterCommand,t=>t===e))])]),this._tryExecuteCommand(e,o))}_tryExecuteCommand(e,t){let i=at.Fb.getCommand(e);if(!i)return Promise.reject(Error("command '".concat(e,"' not found")));try{this._onWillExecuteCommand.fire({commandId:e,args:t});let o=this._instantiationService.invokeFunction(i.handler,...t);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(o)}catch(e){return Promise.reject(e)}}dispose(){var e;super.dispose(),null===(e=this._starActivation)||void 0===e||e.cancel()}};wa=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,pt.Mt),(0,at.Yb)(2,at.mb)],wa),(0,at.TM)(),(0,at.Tb)(),(0,at.Dd)(),(0,vt.c)(),(0,at.Rb)(),(0,gt.gn)(),(0,at.wj)(),(0,at.Ul)(),(0,at.oS)(),(0,at.Wg)(),(0,at.sj)(),(0,at.Db)(class e extends at.bb{constructor(){super({id:"workbench.action.toggleKeybindingsLog",title:(0,at.DM)(8001,"Toggle Keyboard Shortcuts Troubleshooting"),category:vt.s.Developer,f1:!0})}run(t){if(t.get(at.Ed).toggleLogging()&&t.get(at.Lb).executeCommand(gt._n),e.disposable)return e.disposable.dispose(),void(e.disposable=void 0);let i=t.get(at.Hl),o=new at.gj,s=i.activeContainer,r=(0,at.Dx)(s,(0,at.px)(".focus-troubleshooting-marker"));o.add((0,at.kj)(()=>r.remove())),(0,at.Vg)(".focus-troubleshooting-marker","\n\t\t\tposition: fixed;\n\t\t\tpointer-events: none;\n\t\t\tz-index: 100000;\n\t\t\tbackground-color: rgba(255, 0, 0, 0.2);\n\t\t\tborder: 2px solid rgba(255, 0, 0, 0.8);\n\t\t\tborder-radius: 2px;\n\t\t\tdisplay: none;\n\t\t",(0,at.Hg)(void 0,void 0,o));let n=o.add(new at.ej);function a(e,t){t.add((0,at.Sx)(e,"keydown",e=>n.fire(e),!0))}for(let{window:e,disposables:d}of(0,at.nS)())a(e,d);o.add((0,at.ES)(e=>{let{window:t,disposables:i}=e;return a(t,i)})),o.add(i.onDidChangeActiveContainer(()=>{i.activeContainer.appendChild(r)})),o.add(n.event(e=>{let t=e.target;if(t){let e=(0,at.Gx)(t);r.style.top="".concat(e.top,"px"),r.style.left="".concat(e.left,"px"),r.style.width="".concat(e.width,"px"),r.style.height="".concat(e.height,"px"),r.style.display="block",setTimeout(()=>{r.style.display="none"},800)}})),e.disposable=o}}),(0,at.go)(),(0,at.bO)(),(0,at.vO)();var ya=class{static hasOpenBrace(e){for(;e.scan()!==at.fo.EOF;)if(e.getToken()===at.fo.OpenBraceToken)return!0;return!1}static offsetToPosition(e,t){let i=0,o=e.getEOL().length,s=e.getLineCount();for(let r=1;r<=s;r++){let s=i+(e.getLineLength(r)+o);if(s>t)return new at.yO(r,t-i+1);i=s}return new at.yO(s,e.getLineMaxColumn(s))}static insertSnippet(e,t){let i,o=e.getValueLengthInRange(new at._O(1,1,t.lineNumber,t.column));!function(e){e[e.INVALID=0]="INVALID",e[e.AFTER_OBJECT=1]="AFTER_OBJECT",e[e.BEFORE_OBJECT=2]="BEFORE_OBJECT"}(i||(i={}));let s=i.INVALID,r=-1,n=i.INVALID,a=(0,at.po)(e.getValue()),d=0,l=0,c=(e,t)=>{t!==i.INVALID&&1===d&&0===l?(s=t,r=e,n=t):s!==i.INVALID&&(s=i.INVALID,r=a.getTokenOffset())};for(;a.scan()!==at.fo.EOF;){let t=a.getPosition(),h=!1;switch(a.getToken()){case at.fo.OpenBracketToken:h=!0,d++,c(t,i.BEFORE_OBJECT);break;case at.fo.CloseBracketToken:h=!0,d--,c(t,i.INVALID);break;case at.fo.CommaToken:h=!0,c(t,i.BEFORE_OBJECT);break;case at.fo.OpenBraceToken:h=!0,l++,c(t,i.INVALID);break;case at.fo.CloseBraceToken:h=!0,l--,c(t,i.AFTER_OBJECT);break;case at.fo.Trivia:case at.fo.LineBreakTrivia:h=!0}if(t>=o&&(s!==i.INVALID||-1!==r)){let o,d;return s===i.INVALID?(o=r,d=n):(o=h?t:a.getTokenOffset(),d=s),d===i.AFTER_OBJECT?{position:this.offsetToPosition(e,o),prepend:",",append:""}:(a.setPosition(o),{position:this.offsetToPosition(e,o),prepend:"",append:this.hasOpenBrace(a)?",":""})}}let h=e.getLineCount();return{position:new at.yO(h,e.getLineMaxColumn(h)),prepend:"\n[",append:"]"}}};(0,at.pO)(),(0,at.TM)(),(0,at.G)();var fa=(0,at.K)("settings-folder-dropdown",at.fO.triangleDown,(0,at.EM)(9415,"Icon for the folder dropdown button in the split JSON Settings editor."));(0,at.K)("settings-more-action",at.fO.gear,(0,at.EM)(9416,"Icon for the 'more actions' action in the Settings UI.")),(0,at.K)("keybindings-record-keys",at.fO.recordKeys,(0,at.EM)(9417,"Icon for the 'record keys' action in the keybinding UI.")),(0,at.K)("keybindings-sort",at.fO.sortPrecedence,(0,at.EM)(9418,"Icon for the 'sort by precedence' toggle in the keybinding UI.")),(0,at.K)("keybindings-edit",at.fO.edit,(0,at.EM)(9419,"Icon for the edit action in the keybinding UI.")),(0,at.K)("keybindings-add",at.fO.add,(0,at.EM)(9420,"Icon for the add action in the keybinding UI.")),(0,at.K)("settings-edit",at.fO.edit,(0,at.EM)(9421,"Icon for the edit action in the Settings UI.")),(0,at.K)("settings-remove",at.fO.close,(0,at.EM)(9422,"Icon for the remove action in the Settings UI.")),(0,at.K)("settings-discard",at.fO.discard,(0,at.EM)(9423,"Icon for the discard action in the Settings UI.")),(0,at.K)("preferences-clear-input",at.fO.clearAll,(0,at.EM)(9424,"Icon for clear input in the Settings and keybinding UI.")),(0,at.K)("preferences-ai-results",at.fO.sparkle,(0,at.EM)(9425,"Icon for showing AI results in the Settings UI.")),(0,at.K)("preferences-filter",at.fO.filter,(0,at.EM)(9426,"Icon for the button that suggests filters for the Settings UI.")),(0,at.K)("preferences-open-settings",at.fO.goToFile,(0,at.EM)(9427,"Icon for open settings commands.")),(0,at.Xb)(),(0,at.oS)(),(0,at.KT)(),(0,at.Ur)(),(0,at.Ki)(),(0,at.ia)(),(0,at.Up)(),(0,at.Kb)(),(0,at.sj)(),(0,at.Vc)(),(0,at.QO)(),(0,at.wj)(),(0,at.ET)(),(0,at.dT)(),(0,at.Vb)(),(0,at.SO)(),(0,lt.o)(),(0,at.ev)(),(0,at.Cy)(),(0,at.TM)(),(0,at.U_)(),(0,at.Pb)(),(0,at.Ol)(),(0,ut.Nh)(),(0,ut.Tf)(),(0,at.rr)(),(0,at.ox)(),(0,at.Dd)(),(0,at.Ua)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.es)(),(0,at.Ma)(),(0,bt.k)();var Sa=class extends at.Gi{constructor(e,t,i,o){super(null,e),this.contextService=t,this.contextMenuService=i,this.hoverService=o,this._folderSettingCounts=new Map;let s=this.contextService.getWorkspace();this._folder=1===s.folders.length?s.folders[0]:null,this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.onWorkspaceFoldersChanged()))}get folder(){return this._folder}set folder(e){this._folder=e,this.update()}setCount(e,t){let i=this.contextService.getWorkspaceFolder(e);if(!i)throw Error("unknown folder");let o=i.uri;this._folderSettingCounts.set(o.toString(),t),this.update()}render(e){this.element=e,this.container=e,this.labelElement=(0,at.px)(".action-title"),this.detailsElement=(0,at.px)(".action-details"),this.dropDownElement=(0,at.px)(".dropdown-icon.hide"+at.Bb.asCSSSelector(fa)),this.anchorElement=(0,at.px)("a.action-label.folder-settings",{role:"button","aria-haspopup":"true",tabindex:"0"},this.labelElement,this.detailsElement,this.dropDownElement),this.anchorElementHover=this._register(this.hoverService.setupManagedHover((0,at.ra)("mouse"),this.anchorElement,"")),this._register((0,at.Sx)(this.anchorElement,at._x.MOUSE_DOWN,e=>at.gx.stop(e))),this._register((0,at.Sx)(this.anchorElement,at._x.CLICK,e=>this.onClick(e))),this._register((0,at.Sx)(this.container,at._x.KEY_UP,e=>this.onKeyUp(e))),(0,at.Dx)(this.container,this.anchorElement),this.update()}onKeyUp(e){switch(new at.GT(e).keyCode){case at.KO.Enter:case at.KO.Space:return void this.onClick(e)}}onClick(e){at.gx.stop(e,!0),!this.folder||this._action.checked?this.showMenu():this._action.run(this._folder)}updateEnabled(){this.update()}updateChecked(){this.update()}onWorkspaceFoldersChanged(){let e=this._folder,t=this.contextService.getWorkspace();e&&(this._folder=t.folders.filter(t=>(0,at.pT)(t.uri,e.uri))[0]||t.folders[0]),this._folder=this._folder?this._folder:1===t.folders.length?t.folders[0]:null,this.update(),this._action.checked&&this._action.run(this._folder)}update(){let e=0;this._folderSettingCounts.forEach(t=>e+=t);let t=this.contextService.getWorkspace();if(this._folder){this.labelElement.textContent=this._folder.name,this.anchorElementHover.update(this._folder.name);let i=this.labelWithCount(this._action.label,e);this.detailsElement.textContent=i,this.dropDownElement.classList.toggle("hide",1===t.folders.length||!this._action.checked)}else{let t=this.labelWithCount(this._action.label,e);this.labelElement.textContent=t,this.detailsElement.textContent="",this.anchorElementHover.update(this._action.label),this.dropDownElement.classList.remove("hide")}this.anchorElement.classList.toggle("checked",this._action.checked),this.container.classList.toggle("disabled",!this._action.enabled)}showMenu(){this.contextMenuService.showContextMenu({getAnchor:()=>this.container,getActions:()=>this.getDropdownMenuActions(),getActionViewItem:()=>{},onHide:()=>{this.anchorElement.blur()}})}getDropdownMenuActions(){let e=[],t=this.contextService.getWorkspace().folders;return this.contextService.getWorkbenchState()===at.Xo.WORKSPACE&&t.length>0&&e.push(...t.map((e,t)=>{let i=this._folderSettingCounts.get(e.uri.toString());return{id:"folderSettingsTarget"+t,label:this.labelWithCount(e.name,i),tooltip:this.labelWithCount(e.name,i),checked:!!this.folder&&(0,at.pT)(this.folder.uri,e.uri),enabled:!0,class:void 0,run:()=>this._action.run(e)}})),e}labelWithCount(e,t){return t&&(e+=" (".concat(t,")")),e}};Sa=(0,at.Jb)([(0,at.Yb)(1,at.ja),(0,at.Yb)(2,at.El),(0,at.Yb)(3,at.nr)],Sa);var Ea=class extends at.Hp{constructor(e,t,i,o,s,r,n){super(),this.contextService=i,this.instantiationService=o,this.environmentService=s,this.labelService=r,this.languageService=n,this._settingsTarget=null,this._onDidTargetChange=this._register(new at.ej),this.onDidTargetChange=this._onDidTargetChange.event,this.options=null!==t&&void 0!==t?t:{},this.create(e),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onWorkbenchStateChanged())),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.update()))}resetLabels(){let e=this.environmentService.remoteAuthority,t=e&&this.labelService.getHostLabel(at.TT.vscodeRemote,e);this.userLocalSettings.label=(0,at.EM)(9447,"User"),this.userRemoteSettings.label=(0,at.EM)(9448,"Remote")+(t?" [".concat(t,"]"):""),this.workspaceSettings.label=(0,at.EM)(9449,"Workspace"),this.folderSettingsAction.label=(0,at.EM)(9450,"Folder")}create(e){let t=(0,at.Dx)(e,(0,at.px)(".settings-tabs-widget"));this.settingsSwitcherBar=this._register(new at.Vr(t,{orientation:at.Hr.HORIZONTAL,focusOnlyEnabledItems:!0,ariaLabel:(0,at.EM)(9451,"Settings Switcher"),ariaRole:"tablist",actionViewItemProvider:(e,t)=>"folderSettings"===e.id?this.folderSettings:void 0})),this.userLocalSettings=this._register(new at.Hb("userSettings","",".settings-tab",!0,()=>this.updateTarget(at.V_.USER_LOCAL))),this.userLocalSettings.tooltip=(0,at.EM)(9447,"User"),this.userRemoteSettings=this._register(new at.Hb("userSettingsRemote","",".settings-tab",!0,()=>this.updateTarget(at.V_.USER_REMOTE)));let i=this.environmentService.remoteAuthority,o=i&&this.labelService.getHostLabel(at.TT.vscodeRemote,i);this.userRemoteSettings.tooltip=(0,at.EM)(9448,"Remote")+(o?" [".concat(o,"]"):""),this.workspaceSettings=this._register(new at.Hb("workspaceSettings","",".settings-tab",!1,()=>this.updateTarget(at.V_.WORKSPACE))),this.folderSettingsAction=this._register(new at.Hb("folderSettings","",".settings-tab",!1,async e=>{this.updateTarget((0,at.cs)(e)?e.uri:at.V_.USER_LOCAL)})),this.folderSettings=this._register(this.instantiationService.createInstance(Sa,this.folderSettingsAction)),this.resetLabels(),this.update(),this.settingsSwitcherBar.push([this.userLocalSettings,this.userRemoteSettings,this.workspaceSettings,this.folderSettingsAction])}get settingsTarget(){return this._settingsTarget}set settingsTarget(e){this._settingsTarget=e,this.userLocalSettings.checked=at.V_.USER_LOCAL===this.settingsTarget,this.userRemoteSettings.checked=at.V_.USER_REMOTE===this.settingsTarget,this.workspaceSettings.checked=at.V_.WORKSPACE===this.settingsTarget,this.settingsTarget instanceof at.xO?(this.folderSettings.action.checked=!0,this.folderSettings.folder=this.contextService.getWorkspaceFolder(this.settingsTarget)):this.folderSettings.action.checked=!1}setResultCount(e,t){if(e===at.V_.WORKSPACE){let e=(0,at.EM)(9449,"Workspace");t&&(e+=" (".concat(t,")")),this.workspaceSettings.label=e}else if(e===at.V_.USER_LOCAL){let e=(0,at.EM)(9447,"User");t&&(e+=" (".concat(t,")")),this.userLocalSettings.label=e}else e instanceof at.xO&&this.folderSettings.setCount(e,t)}updateLanguageFilterIndicators(e){if(this.resetLabels(),e){let t=this.languageService.getLanguageName(e);if(t){let e=" [".concat(t,"]");this.userLocalSettings.label+=e,this.userRemoteSettings.label+=e,this.workspaceSettings.label+=e,this.folderSettingsAction.label+=e}}}onWorkbenchStateChanged(){this.folderSettings.folder=null,this.update(),this.settingsTarget===at.V_.WORKSPACE&&this.contextService.getWorkbenchState()===at.Xo.WORKSPACE&&this.updateTarget(at.V_.USER_LOCAL)}updateTarget(e){return this.settingsTarget===e||e instanceof at.xO&&this.settingsTarget instanceof at.xO&&(0,at.pT)(this.settingsTarget,e)||(this.settingsTarget=e,this._onDidTargetChange.fire(this.settingsTarget)),Promise.resolve(void 0)}async update(){this.settingsSwitcherBar.domNode.classList.toggle("empty-workbench",this.contextService.getWorkbenchState()===at.Xo.EMPTY),this.userRemoteSettings.enabled=!(!this.options.enableRemoteSettings||!this.environmentService.remoteAuthority),this.workspaceSettings.enabled=this.contextService.getWorkbenchState()!==at.Xo.EMPTY,this.folderSettings.action.enabled=this.contextService.getWorkbenchState()===at.Xo.WORKSPACE&&this.contextService.getWorkspace().folders.length>0,this.workspaceSettings.tooltip=(0,at.EM)(9449,"Workspace")}};Ea=(0,at.Jb)([(0,at.Yb)(2,at.ja),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,bt.O),(0,at.Yb)(5,at.Ha),(0,at.Yb)(6,at.$_)],Ea);var ka,_a,Ia=class extends at.Hp{get onDidChange(){return this._onDidChange.event}get onFocus(){return this._onFocus.event}constructor(e,t,i,o,s,r){super(),this.options=t,this.contextViewService=i,this.instantiationService=o,this.contextKeyService=s,this.keybindingService=r,this._onDidChange=this._register(new at.ej),this._onFocus=this._register(new at.ej),this.create(e)}create(e){this.domNode=(0,at.Dx)(e,(0,at.px)("div.settings-header-widget")),this.createSearchContainer((0,at.Dx)(this.domNode,(0,at.px)("div.settings-search-container"))),this.controlsDiv=(0,at.Dx)(this.domNode,(0,at.px)("div.settings-search-controls")),this.options.showResultCount&&(this.countElement=(0,at.Dx)(this.controlsDiv,(0,at.px)(".settings-count-widget")),this.countElement.style.backgroundColor=(0,at.Eg)(at.og),this.countElement.style.color=(0,at.Eg)(at.sg),this.countElement.style.border="1px solid ".concat((0,at.Eg)(at.dg))),this.inputBox.inputElement.setAttribute("aria-live",this.options.ariaLive||"off"),this.options.ariaLabelledBy&&this.inputBox.inputElement.setAttribute("aria-labelledBy",this.options.ariaLabelledBy);let t=this._register((0,at.US)(this.inputBox.inputElement));this._register(t.onDidFocus(()=>this._onFocus.fire()));let i=this.options.focusKey;i&&(this._register(t.onDidFocus(()=>i.set(!0))),this._register(t.onDidBlur(()=>i.set(!1))))}createSearchContainer(e){this.searchContainer=e;let t=(0,at.Dx)(this.searchContainer,(0,at.px)("div.settings-search-input"));this.inputBox=this._register(this.createInputBox(t)),this._register(this.inputBox.onDidChange(e=>this._onDidChange.fire(e)))}createInputBox(e){return new ut.jh(e,this.contextViewService,(0,rt.A)((0,rt.A)({},this.options),{},{showHistoryHint:()=>(0,ut.Ef)(this.keybindingService)}),this.contextKeyService)}showMessage(e){this.countElement&&e!==this.countElement.textContent&&(this.countElement.textContent=e,this.inputBox.inputElement.setAttribute("aria-label",e),this.inputBox.inputElement.style.paddingRight=this.getControlsWidth()+"px")}layout(e){var t,i;e.width<400?(null!==(t=this.countElement)&&void 0!==t&&t.classList.add("hide"),this.inputBox.inputElement.style.paddingRight="0px"):(null!==(i=this.countElement)&&void 0!==i&&i.classList.remove("hide"),this.inputBox.inputElement.style.paddingRight=this.getControlsWidth()+"px")}getControlsWidth(){return(this.countElement?(0,at.Qx)(this.countElement):0)+20}focus(){this.inputBox.focus(),this.getValue()&&this.inputBox.select()}hasFocus(){return this.inputBox.hasFocus()}clear(){this.inputBox.value=""}getValue(){return this.inputBox.value}setValue(e){return this.inputBox.value=e}dispose(){var e;null!==(e=this.options.focusKey)&&void 0!==e&&e.set(!1),super.dispose()}};Ia=(0,at.Jb)([(0,at.Yb)(2,at.Dl),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,at.Nb),(0,at.Yb)(5,at.Ed)],Ia),(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.iM)(),(0,at.wj)(),(0,at.sj)(),(0,at.yn)(),(0,at.Up)(),(0,at.QO)(),(0,at.oS)(),(0,at.e_)(),(0,at.KT)(),(0,at.fx)(),(0,at.Dd)(),(0,at.Ol)(),(0,at.ox)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.iv)(),(0,at.Ww)(),(0,at.Pb)(),(0,at.Ii)(),(0,at.bE)({});var xa=class extends Ia{constructor(e,t,i,o,s,r){super(e,t,i,o,s,r),this.recordDisposables=this._register(new at.gj),this._onKeybinding=this._register(new at.ej),this.onKeybinding=this._onKeybinding.event,this._onEnter=this._register(new at.ej),this.onEnter=this._onEnter.event,this._onEscape=this._register(new at.ej),this.onEscape=this._onEscape.event,this._onBlur=this._register(new at.ej),this.onBlur=this._onBlur.event,this._register((0,at.kj)(()=>this.stopRecordingKeys())),this._chords=null,this._inputValue=""}clear(){this._chords=null,super.clear()}startRecordingKeys(){this.recordDisposables.add((0,at.Sx)(this.inputBox.inputElement,at._x.KEY_DOWN,e=>this._onKeyDown(new at.GT(e)))),this.recordDisposables.add((0,at.Sx)(this.inputBox.inputElement,at._x.BLUR,()=>this._onBlur.fire())),this.recordDisposables.add((0,at.Sx)(this.inputBox.inputElement,at._x.INPUT,()=>{this.setInputValue(this._inputValue)}))}stopRecordingKeys(){this._chords=null,this.recordDisposables.clear()}setInputValue(e){this._inputValue=e,this.inputBox.value=this._inputValue}_onKeyDown(e){e.preventDefault(),e.stopPropagation(),this.options.recordEnter||!e.equals(at.KO.Enter)?e.equals(at.KO.Escape)?this._onEscape.fire():this.printKeybinding(e):this._onEnter.fire()}printKeybinding(e){let t=this.keybindingService.resolveKeyboardEvent(e),i="code: ".concat(e.browserEvent.code,", keyCode: ").concat(e.browserEvent.keyCode,", key: ").concat(e.browserEvent.key," => UI: ").concat(t.getAriaLabel(),", user settings: ").concat(t.getUserSettingsLabel(),", dispatch: ").concat(t.getDispatchChords()[0]),o=this.options;this._chords||(this._chords=[]),this._chords.length>0&&null===this._chords[this._chords.length-1].getDispatchChords()[0]?this._chords[this._chords.length-1]=t:(2===this._chords.length&&(this._chords=[]),this._chords.push(t));let s=this._chords.map(e=>e.getUserSettingsLabel()||"").join(" ");this.setInputValue(o.quoteRecordedKeys?'"'.concat(s,'"'):s),this.inputBox.inputElement.title=i,this._onKeybinding.fire(this._chords)}};xa=(0,at.Jb)([(0,at.Yb)(2,at.Dl),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,at.Nb),(0,at.Yb)(5,at.Ed)],xa);var Aa=(z=class extends at.Hp{constructor(e,t){super(),this.instantiationService=t,this._keybindingDisposables=this._register(new at.gj),this._chords=null,this._isVisible=!1,this._onHide=this._register(new at.ej),this._onDidChange=this._register(new at.ej),this.onDidChange=this._onDidChange.event,this._onShowExistingKeybindings=this._register(new at.ej),this.onShowExistingKeybidings=this._onShowExistingKeybindings.event,this._domNode=(0,at.dx)((0,at.jx)("div")),this._domNode.setDisplay("none"),this._domNode.setClassName("defineKeybindingWidget"),this._domNode.setWidth(ka.WIDTH),this._domNode.setHeight(ka.HEIGHT);let i=(0,at.EM)(9317,"Press desired key combination and then press ENTER.");(0,at.Dx)(this._domNode.domNode,(0,at.px)(".message",void 0,i)),this._domNode.domNode.style.backgroundColor=(0,at.Eg)(at.Yh),this._domNode.domNode.style.color=(0,at.Eg)(at.Zh),this._domNode.domNode.style.boxShadow="0 2px 8px ".concat((0,at.Eg)(at.ag)),this._keybindingInputWidget=this._register(this.instantiationService.createInstance(xa,this._domNode.domNode,{ariaLabel:i,history:new Set([]),inputBoxStyles:at.ki})),this._keybindingInputWidget.startRecordingKeys(),this._register(this._keybindingInputWidget.onKeybinding(e=>this.onKeybinding(e))),this._register(this._keybindingInputWidget.onEnter(()=>this.hide())),this._register(this._keybindingInputWidget.onEscape(()=>this.clearOrHide())),this._register(this._keybindingInputWidget.onBlur(()=>this.onCancel())),this._outputNode=(0,at.Dx)(this._domNode.domNode,(0,at.px)(".output")),this._showExistingKeybindingsNode=(0,at.Dx)(this._domNode.domNode,(0,at.px)(".existing")),e&&(0,at.Dx)(e,this._domNode.domNode)}get domNode(){return this._domNode.domNode}define(){return this._keybindingInputWidget.clear(),at.Dw.withAsyncBody(async e=>{this._isVisible||(this._isVisible=!0,this._domNode.setDisplay("block"),this._chords=null,this._keybindingInputWidget.setInputValue(""),(0,at.Ox)(this._outputNode),(0,at.Ox)(this._showExistingKeybindingsNode),await(0,at.$w)(0),this._keybindingInputWidget.focus());let t=this._onHide.event(()=>{e(this.getUserSettingsLabel()),t.dispose()})})}layout(e){let t=Math.round((e.height-ka.HEIGHT)/2);this._domNode.setTop(t);let i=Math.round((e.width-ka.WIDTH)/2);this._domNode.setLeft(i)}printExisting(e){if(e>0){let t=(0,at.px)("span.existingText"),i=1===e?(0,at.EM)(9318,"1 existing command has this keybinding",e):(0,at.EM)(9319,"{0} existing commands have this keybinding",e);(0,at.Dx)(t,document.createTextNode(i)),(0,at.$g)(i),this._showExistingKeybindingsNode.appendChild(t),t.onmousedown=e=>{e.preventDefault()},t.onmouseup=e=>{e.preventDefault()},t.onclick=()=>{this._onShowExistingKeybindings.fire(this.getUserSettingsLabel())}}}onKeybinding(e){var t,i;if(this._keybindingDisposables.clear(),this._chords=e,(0,at.Ox)(this._outputNode),(0,at.Ox)(this._showExistingKeybindingsNode),this._keybindingDisposables.add(new at.vn(this._outputNode,at.eM,at.Ai)).set(null!==(t=null===(i=this._chords)||void 0===i?void 0:i[0])&&void 0!==t?t:void 0),this._chords)for(let s=1;s<this._chords.length;s++)this._outputNode.appendChild(document.createTextNode((0,at.EM)(9320,"chord to"))),this._keybindingDisposables.add(new at.vn(this._outputNode,at.eM,at.Ai)).set(this._chords[s]);let o=this.getUserSettingsLabel();o&&this._onDidChange.fire(o)}getUserSettingsLabel(){let e=null;return this._chords&&(e=this._chords.map(e=>e.getUserSettingsLabel()).join(" ")),e}onCancel(){this._chords=null,this.hide()}clearOrHide(){null===this._chords?this.hide():(this._chords=null,this._keybindingInputWidget.clear(),(0,at.Ox)(this._outputNode),(0,at.Ox)(this._showExistingKeybindingsNode))}hide(){this._domNode.setDisplay("none"),this._isVisible=!1,this._onHide.fire()}},{_:ka=z},{_:z.WIDTH=400},{_:z.HEIGHT=110},z);Aa=ka=(0,at.Jb)([(0,at.Yb)(1,at.rx)],Aa);var Va,Da,Ma=(q=class extends at.mj{constructor(e,t){super(),this._editor=e,this._widget=this._register(t.createInstance(Aa,null)),this._editor.addOverlayWidget(this)}getId(){return _a.ID}getDomNode(){return this._widget.domNode}getPosition(){return{preference:null}}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}start(){this._editor.hasModel()&&this._editor.revealPositionInCenterIfOutsideViewport(this._editor.getPosition(),at.rv.Smooth);let e=this._editor.getLayoutInfo();return this._widget.layout(new at.mx(e.width,e.height)),this._widget.define()}},{_:_a=q},{_:q.ID="editor.contrib.defineKeybindingWidget"},q);Ma=_a=(0,at.Jb)([(0,at.Yb)(1,at.rx)],Ma),(0,bt.en)(),function(e){e.Null="null",e.Enum="enum",e.String="string",e.MultilineString="multiline-string",e.Integer="integer",e.Number="number",e.Boolean="boolean",e.Array="array",e.Exclude="exclude",e.Include="include",e.Complex="complex",e.NullableInteger="nullable-integer",e.NullableNumber="nullable-number",e.Object="object",e.BooleanObject="boolean-object",e.LanguageTag="language-tag",e.ExtensionToggle="extension-toggle",e.ComplexObject="complex-object"}(Va||(Va={})),function(e){e[e.None=0]="None",e[e.LanguageTagSettingMatch=1]="LanguageTagSettingMatch",e[e.RemoteMatch=2]="RemoteMatch",e[e.NonContiguousQueryInSettingId=4]="NonContiguousQueryInSettingId",e[e.DescriptionOrValueMatch=8]="DescriptionOrValueMatch",e[e.NonContiguousWordsInSettingsLabel=16]="NonContiguousWordsInSettingsLabel",e[e.ContiguousWordsInSettingsLabel=32]="ContiguousWordsInSettingsLabel",e[e.ContiguousQueryInSettingId=64]="ContiguousQueryInSettingId",e[e.AllWordsInSettingsLabel=128]="AllWordsInSettingsLabel",e[e.ExactMatch=256]="ExactMatch"}(Da||(Da={})),Da.AllWordsInSettingsLabel,Da.ContiguousWordsInSettingsLabel,Da.NonContiguousWordsInSettingsLabel,Da.NonContiguousQueryInSettingId,Da.ContiguousQueryInSettingId;(0,at.Xb)(),(0,at.TM)(),(0,at.Ww)(),(0,at.Vc)(),(0,at.wj)(),(0,at.Dd)(),(0,at.ox)(),(0,at.vO)(),(0,at.ob)(),(0,ut.wh)(),(0,at.go)(),(0,at.sp)(),(0,at.Qf)(),(0,at.Cy)(),(0,at.GM)(),(0,at.dT)(),(0,ut.Sg)();var Ta,Ra=(0,at.EM)(9354,"You won't be able to produce this key combination under your current keyboard layout."),Oa=class extends at.mj{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._userDataProfileService=i,this._keybindingDecorationRenderer=this._register(new at.vj),this._defineWidget=this._register(this._instantiationService.createInstance(Ma,this._editor)),this._register(this._editor.onDidChangeModel(e=>this._update())),this._update()}_update(){this._keybindingDecorationRenderer.value=La(this._editor,this._userDataProfileService)?this._instantiationService.createInstance(Wa,this._editor):void 0}showDefineKeybindingWidget(){La(this._editor,this._userDataProfileService)&&this._defineWidget.start().then(e=>this._onAccepted(e))}_onAccepted(e){if(this._editor.focus(),e&&this._editor.hasModel()){var t;new RegExp(/\\/g).test(e)&&(e=e.slice(0,-1)+"\\\\");let i=["{",'\t"key": '+JSON.stringify(e)+",",'\t"command": "${1:commandId}",','\t"when": "${2:editorTextFocus}"',"}$0"].join("\n"),o=ya.insertSnippet(this._editor.getModel(),this._editor.getPosition());i=o.prepend+i+o.append,this._editor.setPosition(o.position),null===(t=ut.Ch.get(this._editor))||void 0===t||t.insert(i,{overwriteBefore:0,overwriteAfter:0})}}};Oa=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,ut.xg)],Oa);var Wa=Ta=class extends at.mj{constructor(e,t){super(),this._editor=e,this._keybindingService=t,this._dec=this._editor.createDecorationsCollection(),this._updateDecorations=this._register(new at.Aw(()=>this._updateDecorationsNow(),500));let i=(0,at.UM)(this._editor.getModel());this._register(i.onDidChangeContent(()=>this._updateDecorations.schedule())),this._register(this._keybindingService.onDidUpdateKeybindings(()=>this._updateDecorations.schedule())),this._register({dispose:()=>{this._dec.clear(),this._updateDecorations.cancel()}}),this._updateDecorations.schedule()}_updateDecorationsNow(){let e=(0,at.UM)(this._editor.getModel()),t=[],i=(0,at.vo)(e.getValue());if(i&&Array.isArray(i.children))for(let o=0,s=i.children.length;o<s;o++){let s=i.children[o],r=this._getDecorationForEntry(e,s);null!==r&&t.push(r)}this._dec.set(t)}_getDecorationForEntry(e,t){if(!Array.isArray(t.children))return null;for(let i=0,o=t.children.length;i<o;i++){let o=t.children[i];if("property"!==o.type||!Array.isArray(o.children)||2!==o.children.length||"key"!==o.children[0].value)continue;let s=o.children[1];if("string"!==s.type)continue;let r=this._keybindingService.resolveUserBinding(s.value);if(0===r.length)return this._createDecoration(!0,null,null,e,s);let n=r[0],a=null;if(n instanceof ra&&(a=n.getUSLabel()),!n.isWYSIWYG()){let t=n.getLabel();return"string"==typeof t&&s.value.toLowerCase()===t.toLowerCase()?null:this._createDecoration(!1,n.getLabel(),a,e,s)}if(/abnt_|oem_/.test(s.value))return this._createDecoration(!1,n.getLabel(),a,e,s);let d=n.getUserSettingsLabel();return"string"!=typeof d||Ta._userSettingsFuzzyEquals(s.value,d)?null:this._createDecoration(!1,n.getLabel(),a,e,s)}return null}static _userSettingsFuzzyEquals(e,t){if((e=e.trim().toLowerCase())===(t=t.trim().toLowerCase()))return!0;let i=Dn.parseKeybinding(e),o=Dn.parseKeybinding(t);return null===i&&null===o||!(!i||!o)&&i.equals(o)}_createDecoration(e,t,i,o,s){let r,n,a;e?(r=(new at.Bc).appendText(Ra),n="keybindingError",a=(0,at.lp)(at.$f)):(r=i&&t!==i?new at.Bc((0,at.EM)(9355,"**{0}** for your current keyboard layout (**{1}** for US standard).",t,i)):new at.Bc((0,at.EM)(9356,"**{0}** for your current keyboard layout.",t)),n="keybindingInfo",a=(0,at.lp)(at.ep));let d=o.getPositionAt(s.offset),l=o.getPositionAt(s.offset+s.length);return{range:new at._O(d.lineNumber,d.column,l.lineNumber,l.column),options:{description:"keybindings-widget",stickiness:at.Sy.NeverGrowsWhenTypingAtEdges,className:n,hoverMessage:r,overviewRuler:{color:a,position:at.vy.Right}}}}};function La(e,t){let i=e.getModel();return!!i&&(0,at.pT)(i.uri,t.currentProfile.keybindingsResource)}Wa=Ta=(0,at.Jb)([(0,at.Yb)(1,at.Ed)],Wa),(0,at.ub)("editor.contrib.defineKeybinding",Oa,at.$y.AfterFirstRender),(0,at.LM)(),(0,at.TM)(),(0,at.Tb)(),(0,at.Rb)(),(0,at.gb)(),(0,at.Fd)(),(0,at.Db)(class extends at.bb{constructor(){super({id:"runCommands",title:(0,at.DM)(5799,"Run Commands"),f1:!1,metadata:{description:(0,at.EM)(5800,"Run several commands"),args:[{name:"args",schema:{type:"object",required:["commands"],properties:{commands:{type:"array",description:(0,at.EM)(5801,"Commands to run"),items:{anyOf:[{$ref:"vscode://schemas/keybindings#/definitions/commandNames"},{type:"string"},{type:"object",required:["command"],properties:{command:{anyOf:[{$ref:"vscode://schemas/keybindings#/definitions/commandNames"},{type:"string"}]}},$ref:"vscode://schemas/keybindings#/definitions/commandsSchemas"}]}}}}}]}})}async run(e,t){let i=e.get(at.Pd);if(!this._isCommandArgs(t))return void i.error((0,at.EM)(5802,"'runCommands' has received an argument with incorrect type. Please, review the argument passed to the command."));if(0===t.commands.length)return void i.warn((0,at.EM)(5803,"'runCommands' has not received commands to run. Did you forget to pass commands in the 'runCommands' argument?"));let o=e.get(at.Lb),s=e.get(at.mb),r=0;try{for(;r<t.commands.length;++r){let e=t.commands[r];s.debug("runCommands: executing ".concat(r,"-th command: ").concat((0,at.BM)(e))),await this._runCommand(o,e),s.debug("runCommands: executed ".concat(r,"-th command"))}}catch(e){s.debug("runCommands: executing ".concat(r,"-th command resulted in an error: ").concat(e instanceof Error?e.message:(0,at.BM)(e))),i.error(e)}}_isCommandArgs(e){if(!e||"object"!=typeof e||!("commands"in e)||!Array.isArray(e.commands))return!1;for(let t of e.commands)if("string"!=typeof t&&("object"!=typeof t||"string"!=typeof t.command))return!1;return!0}_runCommand(e,t){let i,o;return"string"==typeof t?i=t:(i=t.command,o=t.args),void 0===o?e.executeCommand(i):Array.isArray(o)?e.executeCommand(i,...o):e.executeCommand(i,o)}}),(0,at.Xb)(),(0,at.Zp)(),(0,at.Dd)(),(0,at.iw)(),(0,dt.ir)(),(0,gt.ar)(),(0,at.ps)(),(0,at.Rb)(),(0,at.wj)(),(0,at.xc)(),(0,at.Pb)(),(0,at.Go)(),(0,at.yb)(),(0,at.Fd)(),(0,ut.Sg)(),(0,dt.z)(),(0,pt.Nt)(),(0,at.gb)(),(0,at.ET)(),(0,at.SO)(),(0,pt.a)(),(0,gt.bt)(),(0,gt.n)(),at.xO.from({scheme:at.TT.vscodeUserData,path:"/User/keybindings.json"});var Ja=class extends Hn{constructor(e,t,i,o,s,r,n,a,d,l,c,h){super(t,i,o,s,r,n,a,d,l,c,h),this.shouldUseGlobalKeybindings=e,this.keybindingProviders=[],this.authorizedContainers=[]}registerKeybindingProvider(e){this.keybindingProviders.push(e),this.updateResolver();let t=new at.gj;return t.add(e.onDidChangeKeybindings(()=>{this.updateResolver()})),t.add((0,at.kj)(()=>{let t=this.keybindingProviders.indexOf(e);t>=0&&(this.keybindingProviders.splice(t,1),this.updateResolver())})),t}_getResolver(){return super._getResolver()}registerContainer(e){let t=new at.gj;return t.add(super.registerContainer(e)),this.authorizedContainers.push(e),t.add((0,at.kj)(()=>{this.authorizedContainers=this.authorizedContainers.filter(t=>t!=e)})),t}_dispatch(e,t){return!(!this.shouldUseGlobalKeybindings()&&this.authorizedContainers.every(t=>!t.contains(e.target)))&&super._dispatch(e,t)}getUserKeybindingItems(){return[...super.getUserKeybindingItems(),...this.keybindingProviders.flatMap(e=>e.provideKeybindings())]}};function Ga(){let{shouldUseGlobalKeybindings:e=()=>!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,rt.A)((0,rt.A)({},(0,pt.r)()),{},{[at.Ed.toString()]:new at.Xp(Ja,[e],!1),[gt.ir.toString()]:new at.Xp(ma,[],!0),[at.Lb.toString()]:new at.Xp(wa,[],!0)})}function Na(e){return"".concat(e,".hidden")}Ja=(0,at.Jb)([(0,at.Yb)(1,at.Nb),(0,at.Yb)(2,at.Lb),(0,at.Yb)(3,at.vb),(0,at.Yb)(4,at.Pd),(0,at.Yb)(5,ut.xg),(0,at.Yb)(6,dt.R),(0,at.Yb)(7,pt.Mt),(0,at.Yb)(8,at.fs),(0,at.Yb)(9,at.Wo),(0,at.Yb)(10,at.mb),(0,at.Yb)(11,gt.ir)],Ja),(0,at.Xb)(),(0,ut.xf)(),(0,at.Pb)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.Mb)(),(0,at.wj)(),(0,at.sj)(),(0,at.ox)(),(0,at.SO)(),(0,at.AN)(),(0,at.GM)(),(0,at.dT)(),(0,at.Vb)(),(0,at.gb)(),(0,at.Hj)(),(0,at.AA)(),(0,gt.gn)();var Ka=class extends at.mj{constructor(e,t,i,o){super(),this.viewContainerName=t,this.storageService=i,this._onDidChangeStoredState=this._register(new at.ej),this.onDidChangeStoredState=this._onDidChangeStoredState.event,this.logger=new at.kA(()=>o.createLogger(ut.mf,{name:ut.hf,group:gt.vn})),this.globalViewsStateStorageId=Na(e),this.workspaceViewsStateStorageId=e,this._register(this.storageService.onDidChangeValue(at.Ro.PROFILE,this.globalViewsStateStorageId,this._store)(()=>this.onDidStorageChange())),this.state=this.initialize()}set(e,t){this.state.set(e,t)}get(e){return this.state.get(e)}updateState(e){this.updateWorkspaceState(e),this.updateGlobalState(e)}updateWorkspaceState(e){let t=this.getStoredWorkspaceState();for(let i of e){let e=this.get(i.id);e&&(t[i.id]={collapsed:!!e.collapsed,isHidden:!e.visibleWorkspace,size:e.size,order:i.workspace&&e?e.order:void 0})}Object.keys(t).length>0?this.storageService.store(this.workspaceViewsStateStorageId,JSON.stringify(t),at.Ro.WORKSPACE,at.zo.MACHINE):this.storageService.remove(this.workspaceViewsStateStorageId,at.Ro.WORKSPACE)}updateGlobalState(e){let t=this.getStoredGlobalState();for(let i of e){let e=this.get(i.id);t.set(i.id,{id:i.id,isHidden:!(!e||!i.canToggleVisibility)&&!e.visibleGlobal,order:!i.workspace&&e?e.order:void 0})}this.setStoredGlobalState(t)}onDidStorageChange(){if(this.globalViewsStatesValue!==this.getStoredGlobalViewsStatesValue()){this._globalViewsStatesValue=void 0;let e=this.getStoredGlobalState(),t=this.getStoredWorkspaceState(),i=[];for(let[o,s]of e){let e=this.get(o);if(e)e.visibleGlobal!==!s.isHidden&&(s.isHidden||this.logger.value.trace("View visibility state changed: ".concat(o," is now visible"),this.viewContainerName),i.push({id:o,visible:!s.isHidden}));else{let e=t[o];this.set(o,{active:!1,visibleGlobal:!s.isHidden,visibleWorkspace:(0,at.eN)(null===e||void 0===e?void 0:e.isHidden)?void 0:!(null!==e&&void 0!==e&&e.isHidden),collapsed:null===e||void 0===e?void 0:e.collapsed,order:null===e||void 0===e?void 0:e.order,size:null===e||void 0===e?void 0:e.size})}}if(i.length){this._onDidChangeStoredState.fire(i);for(let e of i){let t=this.get(e.id);t&&(t.visibleGlobal=e.visible)}}}}initialize(){let e=new Map,t=this.getStoredWorkspaceState();for(let n of Object.keys(t)){let i=t[n];e.set(n,{active:!1,visibleGlobal:void 0,visibleWorkspace:(0,at.eN)(i.isHidden)?void 0:!i.isHidden,collapsed:i.collapsed,order:i.order,size:i.size})}let i=this.storageService.get(this.globalViewsStateStorageId,at.Ro.WORKSPACE,"[]"),{state:o}=this.parseStoredGlobalState(i);if(o.size>0){for(let{id:t,isHidden:i}of o.values()){let o=e.get(t);o?(0,at.eN)(o.visibleWorkspace)&&(o.visibleWorkspace=!i):e.set(t,{active:!1,collapsed:void 0,visibleGlobal:void 0,visibleWorkspace:!i})}this.storageService.remove(this.globalViewsStateStorageId,at.Ro.WORKSPACE)}let{state:s,hasDuplicates:r}=this.parseStoredGlobalState(this.globalViewsStatesValue);r&&this.setStoredGlobalState(s);for(let{id:n,isHidden:a,order:d}of s.values()){let t=e.get(n);t?(t.visibleGlobal=!a,(0,at.eN)(d)||(t.order=d)):e.set(n,{active:!1,visibleGlobal:!a,order:d,collapsed:void 0,visibleWorkspace:void 0})}return e}getStoredWorkspaceState(){return JSON.parse(this.storageService.get(this.workspaceViewsStateStorageId,at.Ro.WORKSPACE,"{}"))}getStoredGlobalState(){return this.parseStoredGlobalState(this.globalViewsStatesValue).state}setStoredGlobalState(e){this.globalViewsStatesValue=JSON.stringify([...e.values()])}parseStoredGlobalState(e){let t=JSON.parse(e),i=!1;return{state:t.reduce((e,t)=>("string"==typeof t?(i||(i=e.has(t)),e.set(t,{id:t,isHidden:!0})):(i||(i=e.has(t.id)),e.set(t.id,t)),e),new Map),hasDuplicates:i}}get globalViewsStatesValue(){return this._globalViewsStatesValue||(this._globalViewsStatesValue=this.getStoredGlobalViewsStatesValue()),this._globalViewsStatesValue}set globalViewsStatesValue(e){this.globalViewsStatesValue!==e&&(this._globalViewsStatesValue=e,this.setStoredGlobalViewsStatesValue(e))}getStoredGlobalViewsStatesValue(){return this.storageService.get(this.globalViewsStateStorageId,at.Ro.PROFILE,"[]")}setStoredGlobalViewsStatesValue(e){this.storageService.store(this.globalViewsStateStorageId,e,at.Ro.PROFILE,at.zo.USER)}};Ka=(0,at.Jb)([(0,at.Yb)(2,at.Io),(0,at.Yb)(3,at.hb)],Ka);var Za,Ba=class extends at.mj{get title(){return this._title}get icon(){return this._icon}get keybindingId(){return this._keybindingId}get allViewDescriptors(){return this.viewDescriptorItems.map(e=>e.viewDescriptor)}get activeViewDescriptors(){return this.viewDescriptorItems.filter(e=>e.state.active).map(e=>e.viewDescriptor)}get visibleViewDescriptors(){return this.viewDescriptorItems.filter(e=>this.isViewDescriptorVisible(e)).map(e=>e.viewDescriptor)}constructor(e,t,i,o){super(),this.viewContainer=e,this.contextKeyService=i,this.contextKeys=new at.Mj,this.viewDescriptorItems=[],this._onDidChangeContainerInfo=this._register(new at.ej),this.onDidChangeContainerInfo=this._onDidChangeContainerInfo.event,this._onDidChangeAllViewDescriptors=this._register(new at.ej),this.onDidChangeAllViewDescriptors=this._onDidChangeAllViewDescriptors.event,this._onDidChangeActiveViewDescriptors=this._register(new at.ej),this.onDidChangeActiveViewDescriptors=this._onDidChangeActiveViewDescriptors.event,this._onDidAddVisibleViewDescriptors=this._register(new at.ej),this.onDidAddVisibleViewDescriptors=this._onDidAddVisibleViewDescriptors.event,this._onDidRemoveVisibleViewDescriptors=this._register(new at.ej),this.onDidRemoveVisibleViewDescriptors=this._onDidRemoveVisibleViewDescriptors.event,this._onDidMoveVisibleViewDescriptors=this._register(new at.ej),this.onDidMoveVisibleViewDescriptors=this._onDidMoveVisibleViewDescriptors.event,this.logger=new at.kA(()=>o.createLogger(ut.mf,{name:ut.hf,group:gt.vn})),this._register(at.tj.filter(i.onDidChangeContext,e=>e.affectsSome(this.contextKeys))(()=>this.onDidChangeContext())),this.viewDescriptorsState=this._register(t.createInstance(Ka,e.storageId||"".concat(e.id,".state"),"string"==typeof e.title?e.title:e.title.original)),this._register(this.viewDescriptorsState.onDidChangeStoredState(e=>this.updateVisibility(e))),this.updateContainerInfo()}updateContainerInfo(){var e,t,i,o,s,r;let n=this.viewContainer.alwaysUseContainerInfo||0===this.visibleViewDescriptors.length||this.visibleViewDescriptors.some(e=>at.jb.as(ut.uf.ViewsRegistry).getViewContainer(e.id)===this.viewContainer),a=n?"string"==typeof this.viewContainer.title?this.viewContainer.title:this.viewContainer.title.value:(null===(e=this.visibleViewDescriptors[0])||void 0===e?void 0:e.containerTitle)||(null===(t=this.visibleViewDescriptors[0])||void 0===t||null===(t=t.name)||void 0===t?void 0:t.value)||"",d=!1;this._title!==a&&(this._title=a,d=!0);let l=n?this.viewContainer.icon:(null===(i=this.visibleViewDescriptors[0])||void 0===i?void 0:i.containerIcon)||ut.bf,c=!1;this.isEqualIcon(l)||(this._icon=l,c=!0);let h=null!==(o=null===(s=this.viewContainer.openCommandActionDescriptor)||void 0===s?void 0:s.id)&&void 0!==o?o:null===(r=this.activeViewDescriptors.find(e=>e.openCommandActionDescriptor))||void 0===r||null===(r=r.openCommandActionDescriptor)||void 0===r?void 0:r.id,u=!1;this._keybindingId!==h&&(this._keybindingId=h,u=!0),(d||c||u)&&this._onDidChangeContainerInfo.fire({title:d,icon:c,keybindingId:u})}isEqualIcon(e){return at.xO.isUri(e)?at.xO.isUri(this._icon)&&(0,at.pT)(e,this._icon):at.Bb.isThemeIcon(e)?at.Bb.isThemeIcon(this._icon)&&at.Bb.isEqual(e,this._icon):e===this._icon}isVisible(e){let t=this.viewDescriptorItems.find(t=>t.viewDescriptor.id===e);if(!t)throw Error("Unknown view ".concat(e));return this.isViewDescriptorVisible(t)}setVisible(e,t){this.updateVisibility([{id:e,visible:t}])}updateVisibility(e){let t=(0,at._N)(e.filter(e=>{let{visible:t}=e;return!t}).map(e=>{let{id:t}=e;return this.findAndIgnoreIfNotFound(t)})),i=[];for(let{viewDescriptorItem:s,visibleIndex:r}of t)this.updateViewDescriptorItemVisibility(s,!1)&&i.push({viewDescriptor:s.viewDescriptor,index:r});i.length&&this.broadCastRemovedVisibleViewDescriptors(i);let o=[];for(let{id:s,visible:r}of e){if(!r)continue;let e=this.findAndIgnoreIfNotFound(s);if(!e)continue;let{viewDescriptorItem:t,visibleIndex:i}=e;this.updateViewDescriptorItemVisibility(t,!0)&&o.push({index:i,viewDescriptor:t.viewDescriptor,size:t.state.size,collapsed:!!t.state.collapsed})}o.length&&this.broadCastAddedVisibleViewDescriptors(o)}updateViewDescriptorItemVisibility(e,t){return!(!e.viewDescriptor.canToggleVisibility||this.isViewDescriptorVisibleWhenActive(e)===t)&&(e.viewDescriptor.workspace?e.state.visibleWorkspace=t:(e.state.visibleGlobal=t,t&&this.logger.value.trace("Showing view ".concat(e.viewDescriptor.id," in the container ").concat(this.viewContainer.id))),this.isViewDescriptorVisible(e)===t)}isCollapsed(e){return!!this.find(e).viewDescriptorItem.state.collapsed}setCollapsed(e,t){let{viewDescriptorItem:i}=this.find(e);i.state.collapsed!==t&&(i.state.collapsed=t),this.viewDescriptorsState.updateState(this.allViewDescriptors)}getSize(e){return this.find(e).viewDescriptorItem.state.size}setSizes(e){for(let{id:t,size:i}of e){let{viewDescriptorItem:e}=this.find(t);e.state.size!==i&&(e.state.size=i)}this.viewDescriptorsState.updateState(this.allViewDescriptors)}move(e,t){let i=this.viewDescriptorItems.findIndex(t=>t.viewDescriptor.id===e),o=this.viewDescriptorItems.findIndex(e=>e.viewDescriptor.id===t),s=this.viewDescriptorItems[i],r=this.viewDescriptorItems[o];(0,at.IN)(this.viewDescriptorItems,i,o);for(let n=0;n<this.viewDescriptorItems.length;n++)this.viewDescriptorItems[n].state.order=n;this.broadCastMovedViewDescriptors({index:i,viewDescriptor:s.viewDescriptor},{index:o,viewDescriptor:r.viewDescriptor})}add(e){let t=[];for(let s of e){let e=s.viewDescriptor;if(e.when)for(let t of e.when.keys())this.contextKeys.add(t);let i=this.viewDescriptorsState.get(e.id);if(i){if(e.workspace)i.visibleWorkspace=(0,at.tN)(s.visible)?(0,at.tN)(i.visibleWorkspace)?!e.hideByDefault:i.visibleWorkspace:s.visible;else{let t=i.visibleGlobal;i.visibleGlobal=(0,at.tN)(s.visible)?(0,at.tN)(i.visibleGlobal)?!e.hideByDefault:i.visibleGlobal:s.visible,i.visibleGlobal&&!t&&this.logger.value.trace("Added view ".concat(e.id," in the container ").concat(this.viewContainer.id," and showing it."),"".concat(t),"".concat(e.hideByDefault),"".concat(s.visible))}i.collapsed=(0,at.tN)(s.collapsed)?(0,at.tN)(i.collapsed)?!!e.collapsed:i.collapsed:s.collapsed}else i={active:!1,visibleGlobal:(0,at.tN)(s.visible)?!e.hideByDefault:s.visible,visibleWorkspace:(0,at.tN)(s.visible)?!e.hideByDefault:s.visible,collapsed:(0,at.tN)(s.collapsed)?!!e.collapsed:s.collapsed};this.viewDescriptorsState.set(e.id,i),i.active=this.contextKeyService.contextMatchesRules(e.when),t.push({viewDescriptor:e,state:i})}this.viewDescriptorItems.push(...t),this.viewDescriptorItems.sort(this.compareViewDescriptors.bind(this)),this._onDidChangeAllViewDescriptors.fire({added:t.map(e=>{let{viewDescriptor:t}=e;return t}),removed:[]});let i=[];for(let s of t)s.state.active&&i.push({viewDescriptorItem:s,visible:this.isViewDescriptorVisible(s)});i.length&&this._onDidChangeActiveViewDescriptors.fire({added:i.map(e=>{let{viewDescriptorItem:t}=e;return t.viewDescriptor}),removed:[]});let o=[];for(let{viewDescriptorItem:s,visible:r}of i)if(r&&this.isViewDescriptorVisible(s)){let{visibleIndex:e}=this.find(s.viewDescriptor.id);o.push({index:e,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}remove(e){let t=[],i=[],o=[],s=[];for(let r of e){if(r.when)for(let t of r.when.keys())this.contextKeys.delete(t);let e=this.viewDescriptorItems.findIndex(e=>e.viewDescriptor.id===r.id);if(-1!==e){t.push(r);let n=this.viewDescriptorItems[e];if(n.state.active&&o.push(n.viewDescriptor),this.isViewDescriptorVisible(n)){let{visibleIndex:e}=this.find(n.viewDescriptor.id);s.push({index:e,viewDescriptor:n.viewDescriptor})}i.push(n)}}i.forEach(e=>this.viewDescriptorItems.splice(this.viewDescriptorItems.indexOf(e),1)),this.broadCastRemovedVisibleViewDescriptors(s),o.length&&this._onDidChangeActiveViewDescriptors.fire({added:[],removed:o}),t.length&&this._onDidChangeAllViewDescriptors.fire({added:[],removed:t})}onDidChangeContext(){let e=[],t=[];for(let s of this.viewDescriptorItems){let i=s.state.active,o=this.contextKeyService.contextMatchesRules(s.viewDescriptor.when);i!==o&&(o?e.push({item:s,visibleWhenActive:this.isViewDescriptorVisibleWhenActive(s)}):t.push(s))}let i=[];for(let s of t)if(this.isViewDescriptorVisible(s)){let{visibleIndex:e}=this.find(s.viewDescriptor.id);i.push({index:e,viewDescriptor:s.viewDescriptor})}t.forEach(e=>e.state.active=!1),e.forEach(e=>{let{item:t}=e;return t.state.active=!0}),this.broadCastRemovedVisibleViewDescriptors(i),(e.length||t.length)&&this._onDidChangeActiveViewDescriptors.fire({added:e.map(e=>{let{item:t}=e;return t.viewDescriptor}),removed:t.map(e=>e.viewDescriptor)});let o=[];for(let{item:s,visibleWhenActive:r}of e)if(r&&this.isViewDescriptorVisible(s)){let{visibleIndex:e}=this.find(s.viewDescriptor.id);o.push({index:e,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}broadCastAddedVisibleViewDescriptors(e){e.length&&(this._onDidAddVisibleViewDescriptors.fire(e.sort((e,t)=>e.index-t.index)),this.updateState("Added views:".concat(e.map(e=>e.viewDescriptor.id).join(",")," in ").concat(this.viewContainer.id)))}broadCastRemovedVisibleViewDescriptors(e){e.length&&(this._onDidRemoveVisibleViewDescriptors.fire(e.sort((e,t)=>t.index-e.index)),this.updateState("Removed views:".concat(e.map(e=>e.viewDescriptor.id).join(",")," from ").concat(this.viewContainer.id)))}broadCastMovedViewDescriptors(e,t){this._onDidMoveVisibleViewDescriptors.fire({from:e,to:t}),this.updateState("Moved view ".concat(e.viewDescriptor.id," to ").concat(t.viewDescriptor.id," in ").concat(this.viewContainer.id))}updateState(e){this.logger.value.trace(e),this.viewDescriptorsState.updateState(this.allViewDescriptors),this.updateContainerInfo()}isViewDescriptorVisible(e){return!!e.state.active&&this.isViewDescriptorVisibleWhenActive(e)}isViewDescriptorVisibleWhenActive(e){return e.viewDescriptor.workspace?!!e.state.visibleWorkspace:!!e.state.visibleGlobal}find(e){let t=this.findAndIgnoreIfNotFound(e);if(t)return t;throw Error("view descriptor ".concat(e," not found"))}findAndIgnoreIfNotFound(e){for(let t=0,i=0;t<this.viewDescriptorItems.length;t++){let o=this.viewDescriptorItems[t];if(o.viewDescriptor.id===e)return{index:t,visibleIndex:i,viewDescriptorItem:o};this.isViewDescriptorVisible(o)&&i++}}compareViewDescriptors(e,t){return e.viewDescriptor.id===t.viewDescriptor.id?0:this.getViewOrder(e)-this.getViewOrder(t)||this.getGroupOrderResult(e.viewDescriptor,t.viewDescriptor)}getViewOrder(e){let t="number"==typeof e.state.order?e.state.order:e.viewDescriptor.order;return"number"==typeof t?t:Number.MAX_VALUE}getGroupOrderResult(e,t){return e.group&&t.group&&e.group!==t.group?e.group<t.group?-1:1:0}};function Pa(e){return"".concat(e,".state")}Ba=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,at.Nb),(0,at.Yb)(3,at.hb)],Ba),(0,at.Xb)(),(0,ut.xf)(),(0,at.ox)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.Vo)(),(0,at.Lo)(),(0,pt.Nt)(),(0,at.Mb)(),(0,at.wj)(),(0,ut.N)(),(0,at.Zp)(),(0,at.Jp)(),(0,at.sj)(),(0,at.yb)(),(0,at.dp)(),(0,at.Tb)(),(0,at.TM)(),(0,at.gb)(),(0,at.AA)(),(0,ut.vg)(),(0,gt.gn)();var Fa=($=class extends at.mj{get viewContainers(){return this.viewContainersRegistry.all}constructor(e,t,i,o,s,r){super(),this.instantiationService=e,this.contextKeyService=t,this.storageService=i,this.extensionService=o,this.telemetryService=s,this._onDidChangeContainer=this._register(new at.ej),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeLocation=this._register(new at.ej),this.onDidChangeLocation=this._onDidChangeLocation.event,this._onDidChangeContainerLocation=this._register(new at.ej),this.onDidChangeContainerLocation=this._onDidChangeContainerLocation.event,this.viewContainerModels=this._register(new at.hj),this.viewsVisibilityActionDisposables=this._register(new at.hj),this.canRegisterViewsVisibilityActions=!1,this._onDidChangeViewContainers=this._register(new at.ej),this.onDidChangeViewContainers=this._onDidChangeViewContainers.event,this.logger=new at.kA(()=>r.createLogger(ut.mf,{name:ut.hf,group:gt.vn})),this.activeViewContextKeys=new Map,this.movableViewContextKeys=new Map,this.defaultViewLocationContextKeys=new Map,this.defaultViewContainerLocationContextKeys=new Map,this.viewContainersRegistry=at.jb.as(ut.uf.ViewContainersRegistry),this.viewsRegistry=at.jb.as(ut.uf.ViewsRegistry),this.migrateToViewsCustomizationsStorage(),this.viewContainersCustomLocations=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),this.viewDescriptorsCustomLocations=new Map(Object.entries(this.viewCustomizations.viewLocations)),this.viewContainerBadgeEnablementStates=new Map(Object.entries(this.viewCustomizations.viewContainerBadgeEnablementStates)),this.viewContainers.forEach(e=>this.onDidRegisterViewContainer(e)),this._register(this.viewsRegistry.onViewsRegistered(e=>this.onDidRegisterViews(e))),this._register(this.viewsRegistry.onViewsDeregistered(e=>{let{views:t,viewContainer:i}=e;return this.onDidDeregisterViews(t,i)})),this._register(this.viewsRegistry.onDidChangeContainer(e=>{let{views:t,from:i,to:o}=e;return this.onDidChangeDefaultContainer(t,i,o)})),this._register(this.viewContainersRegistry.onDidRegister(e=>{let{viewContainer:t}=e;this.onDidRegisterViewContainer(t),this._onDidChangeViewContainers.fire({added:[{container:t,location:this.getViewContainerLocation(t)}],removed:[]})})),this._register(this.viewContainersRegistry.onDidDeregister(e=>{let{viewContainer:t,viewContainerLocation:i}=e;this.onDidDeregisterViewContainer(t),this._onDidChangeViewContainers.fire({removed:[{container:t,location:i}],added:[]})})),this._register(this.storageService.onDidChangeValue(at.Ro.PROFILE,Za.VIEWS_CUSTOMIZATIONS,this._store)(()=>this.onDidStorageChange())),this.extensionService.whenInstalledExtensionsRegistered().then(()=>this.whenExtensionsRegistered())}migrateToViewsCustomizationsStorage(){if(this.storageService.get(Za.VIEWS_CUSTOMIZATIONS,at.Ro.PROFILE))return;let e=this.storageService.get("views.cachedViewContainerLocations",at.Ro.PROFILE),t=this.storageService.get("views.cachedViewPositions",at.Ro.PROFILE);if(!e&&!t)return;let i=e?JSON.parse(e):[],o=t?JSON.parse(t):[],s={viewContainerLocations:i.reduce((e,t)=>{let[i,o]=t;return e[i]=o,e},{}),viewLocations:o.reduce((e,t)=>{let[i,{containerId:o}]=t;return e[i]=o,e},{}),viewContainerBadgeEnablementStates:{}};this.storageService.store(Za.VIEWS_CUSTOMIZATIONS,JSON.stringify(s),at.Ro.PROFILE,at.zo.USER),this.storageService.remove("views.cachedViewContainerLocations",at.Ro.PROFILE),this.storageService.remove("views.cachedViewPositions",at.Ro.PROFILE)}registerGroupedViews(e){for(let[t,i]of e.entries()){let e=this.viewContainersRegistry.get(t);if(!e||!this.viewContainerModels.has(e)){if(this.isGeneratedContainerId(t)){let e=this.viewContainersCustomLocations.get(t);void 0!==e&&this.registerGeneratedViewContainer(e,t)}continue}let o=i.filter(t=>0===this.getViewContainerModel(e).allViewDescriptors.filter(e=>e.id===t.id).length);this.addViews(e,o)}}deregisterGroupedViews(e){for(let[t,i]of e.entries()){let e=this.viewContainersRegistry.get(t);!e||!this.viewContainerModels.has(e)||this.removeViews(e,i)}}moveOrphanViewsToDefaultLocation(){for(let[e,t]of this.viewDescriptorsCustomLocations.entries()){if(this.viewContainersRegistry.get(t))continue;let i=this.viewsRegistry.getViewContainer(e),o=this.getViewDescriptorById(e);i&&o&&this.addViews(i,[o])}}whenExtensionsRegistered(){this.moveOrphanViewsToDefaultLocation();for(let e of[...this.viewContainersCustomLocations.keys()])this.cleanUpGeneratedViewContainer(e);this.saveViewCustomizations();for(let[e,t]of this.viewContainerModels)this.registerViewsVisibilityActions(e,t);this.canRegisterViewsVisibilityActions=!0}onDidRegisterViews(e){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(e=>{let{views:t,viewContainer:i}=e,o=this.regroupViews(i.id,t);this.registerGroupedViews(o),t.forEach(e=>this.getOrCreateMovableViewContextKey(e).set(!!e.canMoveView))})})}isGeneratedContainerId(e){return e.startsWith(Za.COMMON_CONTAINER_ID_PREFIX)}onDidDeregisterViews(e,t){let i=this.regroupViews(t.id,e);this.deregisterGroupedViews(i),this.contextKeyService.bufferChangeEvents(()=>{e.forEach(e=>this.getOrCreateMovableViewContextKey(e).set(!1))})}regroupViews(e,t){let i=new Map;for(let s of t){var o;let t=null!==(o=this.viewDescriptorsCustomLocations.get(s.id))&&void 0!==o?o:e,r=i.get(t);r||i.set(t,r=[]),r.push(s)}return i}getViewDescriptorById(e){return this.viewsRegistry.getView(e)}getViewLocationById(e){let t=this.getViewContainerByViewId(e);return null===t?null:this.getViewContainerLocation(t)}getViewContainerByViewId(e){var t;let i=this.viewDescriptorsCustomLocations.get(e);return i?null!==(t=this.viewContainersRegistry.get(i))&&void 0!==t?t:null:this.getDefaultContainerById(e)}getViewContainerLocation(e){var t;return null!==(t=this.viewContainersCustomLocations.get(e.id))&&void 0!==t?t:this.getDefaultViewContainerLocation(e)}getDefaultViewContainerLocation(e){return this.viewContainersRegistry.getViewContainerLocation(e)}getDefaultContainerById(e){var t;return null!==(t=this.viewsRegistry.getViewContainer(e))&&void 0!==t?t:null}getViewContainerModel(e){return this.getOrRegisterViewContainerModel(e)}getViewContainerById(e){return this.viewContainersRegistry.get(e)||null}getViewContainersByLocation(e){return this.viewContainers.filter(t=>this.getViewContainerLocation(t)===e)}getDefaultViewContainer(e){return this.viewContainersRegistry.getDefaultViewContainer(e)}moveViewContainerToLocation(e,t,i,o){this.logger.value.trace("moveViewContainerToLocation: viewContainer:".concat(e.id," location:").concat(t," reason:").concat(o)),this.moveViewContainerToLocationWithoutSaving(e,t,i),this.saveViewCustomizations()}getViewContainerBadgeEnablementState(e){var t;return null===(t=this.viewContainerBadgeEnablementStates.get(e))||void 0===t||t}setViewContainerBadgeEnablementState(e,t){this.viewContainerBadgeEnablementStates.set(e,t),this.saveViewCustomizations()}moveViewToLocation(e,t,i){this.logger.value.trace("moveViewToLocation: view:".concat(e.id," location:").concat(t," reason:").concat(i));let o=this.registerGeneratedViewContainer(t);this.moveViewsToContainer([e],o)}moveViewsToContainer(e,t,i,o){if(!e.length)return;this.logger.value.trace("moveViewsToContainer: views:".concat(e.map(e=>e.id).join(",")," viewContainer:").concat(t.id," reason:").concat(o));let s=this.getViewContainerByViewId(e[0].id),r=t;s&&r&&s!==r&&(this.moveViewsWithoutSaving(e,s,r,i),this.cleanUpGeneratedViewContainer(s.id),this.saveViewCustomizations(),this.reportMovedViews(e,s,r))}reset(){for(let e of this.viewContainers){let t=this.getViewContainerModel(e);for(let e of t.allViewDescriptors){let t=this.getDefaultContainerById(e.id),i=this.getViewContainerByViewId(e.id);i&&t&&i!==t&&this.moveViewsWithoutSaving([e],i,t)}let i=this.getDefaultViewContainerLocation(e),o=this.getViewContainerLocation(e);null!==i&&o!==i&&this.moveViewContainerToLocationWithoutSaving(e,i),this.cleanUpGeneratedViewContainer(e.id)}this.viewContainersCustomLocations.clear(),this.viewDescriptorsCustomLocations.clear(),this.saveViewCustomizations()}isViewContainerRemovedPermanently(e){return this.isGeneratedContainerId(e)&&!this.viewContainersCustomLocations.has(e)}onDidChangeDefaultContainer(e,t,i){let o=e.filter(e=>!this.viewDescriptorsCustomLocations.has(e.id)||!this.viewContainers.includes(t)&&this.viewDescriptorsCustomLocations.get(e.id)===t.id);o.length&&this.moveViewsWithoutSaving(o,t,i)}reportMovedViews(e,t,i){let o=e=>e.id.startsWith(Za.COMMON_CONTAINER_ID_PREFIX)?"custom":e.extensionId?"extension":e.id,s=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i),n=e.length,a=o(t),d=o(i),l=s===ut.gf.Panel?"panel":"sidebar",c=r===ut.gf.Panel?"panel":"sidebar";this.telemetryService.publicLog2("viewDescriptorService.moveViews",{viewCount:n,fromContainer:a,toContainer:d,fromLocation:l,toLocation:c})}moveViewsWithoutSaving(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ut.yf.Expand;this.removeViews(t,e),this.addViews(i,e,o);let s=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i);s!==r&&this._onDidChangeLocation.fire({views:e,from:s,to:r}),this._onDidChangeContainer.fire({views:e,from:t,to:i})}moveViewContainerToLocationWithoutSaving(e,t,i){let o=this.getViewContainerLocation(e),s=t;if(o!==s){let t=this.isGeneratedContainerId(e.id),r=s===this.getDefaultViewContainerLocation(e);t||!r?this.viewContainersCustomLocations.set(e.id,s):this.viewContainersCustomLocations.delete(e.id),this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t||r),e.requestedIndex=i,this._onDidChangeContainerLocation.fire({viewContainer:e,from:o,to:s});let n=this.getViewsByContainer(e);this._onDidChangeLocation.fire({views:n,from:o,to:s})}}cleanUpGeneratedViewContainer(e){var t;if(!this.isGeneratedContainerId(e))return;let i=this.getViewContainerById(e);i&&(null===(t=this.getViewContainerModel(i))||void 0===t?void 0:t.allViewDescriptors.length)||[...this.viewDescriptorsCustomLocations.values()].includes(e)||(i&&this.viewContainersRegistry.deregisterViewContainer(i),this.viewContainersCustomLocations.delete(e),this.viewContainerBadgeEnablementStates.delete(e),this.storageService.remove(Na((null===i||void 0===i?void 0:i.storageId)||Pa(e)),at.Ro.PROFILE))}registerGeneratedViewContainer(e,t){let i=t||this.generateContainerId(e),o=this.viewContainersRegistry.registerViewContainer({id:i,ctorDescriptor:new at.Xp(ut.A,[i,{mergeViewWithContainerWhenSingleView:!0}]),title:{value:(0,at.EM)(13942,"User View Container"),original:"User View Container"},icon:e===ut.gf.Sidebar?ut.bf:void 0,storageId:Pa(i),hideIfEmpty:!0},e,{doNotRegisterOpenCommand:!0});return this.viewContainersCustomLocations.get(o.id)!==e&&this.viewContainersCustomLocations.set(o.id,e),this.getOrCreateDefaultViewContainerLocationContextKey(o).set(!0),o}onDidStorageChange(){JSON.stringify(this.viewCustomizations)!==this.getStoredViewCustomizationsValue()&&this.onDidViewCustomizationsStorageChange()}onDidViewCustomizationsStorageChange(){this._viewCustomizations=void 0;let e=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),t=new Map(Object.entries(this.viewCustomizations.viewLocations)),i=[],o=[];for(let[s,r]of e.entries()){let e=this.getViewContainerById(s);e?r!==this.getViewContainerLocation(e)&&i.push([e,r]):this.isGeneratedContainerId(s)&&this.registerGeneratedViewContainer(r,s)}for(let s of this.viewContainers)if(!e.has(s.id)){let e=this.getViewContainerLocation(s),t=this.getDefaultViewContainerLocation(s);e!==t&&i.push([s,t])}for(let[s,r]of t.entries()){let e=this.getViewDescriptorById(s);if(e){let t=this.getViewContainerByViewId(s),i=this.viewContainersRegistry.get(r);t&&i&&i!==t&&o.push({views:[e],from:t,to:i})}}for(let s of this.viewContainers){let e=this.getViewContainerModel(s);for(let i of e.allViewDescriptors)if(!t.has(i.id)){let e=this.getViewContainerByViewId(i.id),t=this.getDefaultContainerById(i.id);e&&t&&e!==t&&o.push({views:[i],from:e,to:t})}}for(let[s,r]of i)this.moveViewContainerToLocationWithoutSaving(s,r);for(let{views:s,from:r,to:n}of o)this.moveViewsWithoutSaving(s,r,n,ut.yf.Default);this.viewContainersCustomLocations=e,this.viewDescriptorsCustomLocations=t}generateContainerId(e){return"".concat(Za.COMMON_CONTAINER_ID_PREFIX,".").concat((0,ut._f)(e),".").concat((0,at.up)())}saveViewCustomizations(){let e={viewContainerLocations:{},viewLocations:{},viewContainerBadgeEnablementStates:{}};for(let[i,o]of this.viewContainersCustomLocations){let t=this.getViewContainerById(i);t&&!this.isGeneratedContainerId(i)&&o===this.getDefaultViewContainerLocation(t)||(e.viewContainerLocations[i]=o)}for(let[i,o]of this.viewDescriptorsCustomLocations){var t;let s=this.getViewContainerById(o);s&&(null===(t=this.getDefaultContainerById(i))||void 0===t?void 0:t.id)===s.id||(e.viewLocations[i]=o)}for(let[i,o]of this.viewContainerBadgeEnablementStates)!1===o&&(e.viewContainerBadgeEnablementStates[i]=o);this.viewCustomizations=e}get viewCustomizations(){var e,t,i;return this._viewCustomizations||(this._viewCustomizations=JSON.parse(this.getStoredViewCustomizationsValue()),this._viewCustomizations.viewContainerLocations=null!==(e=this._viewCustomizations.viewContainerLocations)&&void 0!==e?e:{},this._viewCustomizations.viewLocations=null!==(t=this._viewCustomizations.viewLocations)&&void 0!==t?t:{},this._viewCustomizations.viewContainerBadgeEnablementStates=null!==(i=this._viewCustomizations.viewContainerBadgeEnablementStates)&&void 0!==i?i:{}),this._viewCustomizations}set viewCustomizations(e){let t=JSON.stringify(e);JSON.stringify(this.viewCustomizations)!==t&&(this._viewCustomizations=e,this.setStoredViewCustomizationsValue(t))}getStoredViewCustomizationsValue(){return this.storageService.get(Za.VIEWS_CUSTOMIZATIONS,at.Ro.PROFILE,"{}")}setStoredViewCustomizationsValue(e){this.storageService.store(Za.VIEWS_CUSTOMIZATIONS,e,at.Ro.PROFILE,at.zo.USER)}getViewsByContainer(e){let t=this.viewsRegistry.getViews(e).filter(t=>{var i;return(null!==(i=this.viewDescriptorsCustomLocations.get(t.id))&&void 0!==i?i:e.id)===e.id});for(let[i,o]of this.viewDescriptorsCustomLocations.entries()){if(o!==e.id||this.viewsRegistry.getViewContainer(i)===e)continue;let s=this.getViewDescriptorById(i);s&&t.push(s)}return t}onDidRegisterViewContainer(e){let t=!!this.isGeneratedContainerId(e.id)||this.getViewContainerLocation(e)===this.getDefaultViewContainerLocation(e);this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t),this.getOrRegisterViewContainerModel(e)}getOrRegisterViewContainerModel(e){var t;let i=null===(t=this.viewContainerModels.get(e))||void 0===t?void 0:t.viewContainerModel;if(!i){let t=new at.gj;i=t.add(this.instantiationService.createInstance(Ba,e)),this.onDidChangeActiveViews({added:i.activeViewDescriptors,removed:[]}),i.onDidChangeActiveViewDescriptors(e=>this.onDidChangeActiveViews(e),this,t),this.onDidChangeVisibleViews({added:[...i.visibleViewDescriptors],removed:[]}),i.onDidAddVisibleViewDescriptors(e=>this.onDidChangeVisibleViews({added:e.map(e=>{let{viewDescriptor:t}=e;return t}),removed:[]}),this,t),i.onDidRemoveVisibleViewDescriptors(e=>this.onDidChangeVisibleViews({added:[],removed:e.map(e=>{let{viewDescriptor:t}=e;return t})}),this,t),t.add((0,at.kj)(()=>this.viewsVisibilityActionDisposables.deleteAndDispose(e))),t.add(this.registerResetViewContainerAction(e));let o={viewContainerModel:i,disposables:t,dispose:()=>t.dispose()};this.viewContainerModels.set(e,o),this.onDidRegisterViews([{views:this.viewsRegistry.getViews(e),viewContainer:e}]);let s=this.getViewsByContainer(e).filter(t=>this.getDefaultContainerById(t.id)!==e);s.length&&(this.addViews(e,s),this.contextKeyService.bufferChangeEvents(()=>{s.forEach(e=>this.getOrCreateMovableViewContextKey(e).set(!!e.canMoveView))})),this.canRegisterViewsVisibilityActions&&this.registerViewsVisibilityActions(e,o)}return i}onDidDeregisterViewContainer(e){this.viewContainerModels.deleteAndDispose(e),this.viewsVisibilityActionDisposables.deleteAndDispose(e)}onDidChangeActiveViews(e){let{added:t,removed:i}=e;this.contextKeyService.bufferChangeEvents(()=>{t.forEach(e=>this.getOrCreateActiveViewContextKey(e).set(!0)),i.forEach(e=>this.getOrCreateActiveViewContextKey(e).set(!1))})}onDidChangeVisibleViews(e){let{added:t,removed:i}=e;this.contextKeyService.bufferChangeEvents(()=>{t.forEach(e=>this.getOrCreateVisibleViewContextKey(e).set(!0)),i.forEach(e=>this.getOrCreateVisibleViewContextKey(e).set(!1))})}registerViewsVisibilityActions(e,t){let{viewContainerModel:i,disposables:o}=t;this.viewsVisibilityActionDisposables.deleteAndDispose(e),this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(i)),o.add(at.tj.any(i.onDidChangeActiveViewDescriptors,i.onDidAddVisibleViewDescriptors,i.onDidRemoveVisibleViewDescriptors,i.onDidMoveVisibleViewDescriptors)(t=>{this.viewsVisibilityActionDisposables.deleteAndDispose(e),this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(i))}))}registerViewsVisibilityActionsForContainer(e){let t=new at.gj;return e.activeViewDescriptors.forEach((i,o)=>{i.remoteAuthority||(t.add((0,at.Db)(class extends ut.j{constructor(){super({id:"".concat(i.id,".toggleVisibility"),viewPaneContainerId:e.viewContainer.id,precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?at.Mk.true():at.Mk.false(),toggled:at.Mk.has("".concat(i.id,".visible")),title:i.name,metadata:{description:(0,at.DM)(13943,"Toggles the visibility of the {0} view if the view container it is located in is visible",i.name.value)},menu:[{id:ut.M,when:at.Mk.equals("viewContainer",e.viewContainer.id),order:o},{id:at.xb.ViewContainerTitleContext,when:at.Mk.equals("viewContainer",e.viewContainer.id),order:o,group:"1_toggleVisibility"},{id:at.xb.ViewTitleContext,when:at.Mk.or(...e.visibleViewDescriptors.map(e=>at.Mk.equals("view",e.id))),order:o,group:"2_toggleVisibility"}]})}async runInViewPaneContainer(e,t){t.toggleViewVisibility(i.id)}})),t.add((0,at.Db)(class extends ut.j{constructor(){super({id:"".concat(i.id,".removeView"),viewPaneContainerId:e.viewContainer.id,title:(0,at.EM)(13944,"Hide '{0}'",i.name.value),metadata:{description:(0,at.DM)(13945,"Hides the {0} view if it is visible and the view container it is located in is visible",i.name.value)},precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?at.Mk.true():at.Mk.false(),menu:[{id:at.xb.ViewTitleContext,when:at.Mk.and(at.Mk.equals("view",i.id),at.Mk.has("".concat(i.id,".visible"))),group:"1_hide",order:1}]})}async runInViewPaneContainer(e,t){var o;(null===(o=t.getView(i.id))||void 0===o?void 0:o.isVisible())&&t.toggleViewVisibility(i.id)}})))}),t}registerResetViewContainerAction(e){let t=this;return(0,at.Db)(class extends at.bb{constructor(){super({id:"".concat(e.id,".resetViewContainerLocation"),title:(0,at.DM)(13946,"Reset Location"),menu:[{id:at.xb.ViewContainerTitleContext,group:"1_viewActions",when:at.Mk.or(at.Mk.and(at.Mk.equals("viewContainer",e.id),at.Mk.equals("".concat(e.id,".defaultViewContainerLocation"),!1)))}]})}run(i){t.moveViewContainerToLocation(e,t.getDefaultViewContainerLocation(e),void 0,this.desc.id),i.get(ut._g).openViewContainer(e.id,!0)}})}addViews(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ut.yf.Default;this.contextKeyService.bufferChangeEvents(()=>{t.forEach(t=>{let i=this.getDefaultContainerById(t.id)===e;this.getOrCreateDefaultViewLocationContextKey(t).set(i),i?this.viewDescriptorsCustomLocations.delete(t.id):this.viewDescriptorsCustomLocations.set(t.id,e.id)})}),this.getViewContainerModel(e).add(t.map(e=>({viewDescriptor:e,collapsed:i===ut.yf.Default&&void 0,visible:i!==ut.yf.Default||void 0})))}removeViews(e,t){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(t=>{this.viewDescriptorsCustomLocations.get(t.id)===e.id&&this.viewDescriptorsCustomLocations.delete(t.id),this.getOrCreateDefaultViewLocationContextKey(t).set(!1)})}),this.getViewContainerModel(e).remove(t)}getOrCreateActiveViewContextKey(e){let t="".concat(e.id,".active"),i=this.activeViewContextKeys.get(t);return i||(i=new at.Nk(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateVisibleViewContextKey(e){let t="".concat(e.id,".visible"),i=this.activeViewContextKeys.get(t);return i||(i=new at.Nk(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateMovableViewContextKey(e){let t="".concat(e.id,".canMove"),i=this.movableViewContextKeys.get(t);return i||(i=new at.Nk(t,!1).bindTo(this.contextKeyService),this.movableViewContextKeys.set(t,i)),i}getOrCreateDefaultViewLocationContextKey(e){let t="".concat(e.id,".defaultViewLocation"),i=this.defaultViewLocationContextKeys.get(t);return i||(i=new at.Nk(t,!1).bindTo(this.contextKeyService),this.defaultViewLocationContextKeys.set(t,i)),i}getOrCreateDefaultViewContainerLocationContextKey(e){let t="".concat(e.id,".defaultViewContainerLocation"),i=this.defaultViewContainerLocationContextKeys.get(t);return i||(i=new at.Nk(t,!1).bindTo(this.contextKeyService),this.defaultViewContainerLocationContextKeys.set(t,i)),i}},{_:Za=$},{_:$.VIEWS_CUSTOMIZATIONS="views.customizations"},{_:$.COMMON_CONTAINER_ID_PREFIX="workbench.views.service"},$);Fa=Za=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,at.Nb),(0,at.Yb)(2,at.Io),(0,at.Yb)(3,pt.Mt),(0,at.Yb)(4,at.vb),(0,at.Yb)(5,at.hb)],Fa),(0,at.Xb)(),(0,at._a)(),(0,at.AN)(),(0,at.wj)(),(0,at.dT)(),(0,at.SO)(),(0,at.i_)(),(0,at.jr)(),(0,bt.en)(),(0,bt.G)(),(0,at.ET)(),(0,dt.a)(),(0,at.ox)(),(0,at.dc)(),(0,at.TM)(),(0,at.Bd)(),(0,at.Fd)(),(0,at.Jp)(),(0,at.Vo)(),(0,at.Lo)(),(0,pt.Nt)(),(0,at.gb)(),(0,bt.Ot)(),(0,at.sj)(),(0,at.Wd)();var Ya,Qa=(ee=class extends at.mj{constructor(e,t,i,o,s,r,n,a){super(),this.editorGroupService=e,this.instantiationService=t,this.configurationService=i,this.quickInputService=o,this.notificationService=s,this.storageService=r,this.extensionService=n,this.logService=a,this._onDidChangeEditorRegistrations=this._register(new at.rj),this.onDidChangeEditorRegistrations=this._onDidChangeEditorRegistrations.event,this._editors=new Map,this._flattenedEditors=new Map,this._shouldReFlattenEditors=!0,this.cache=new Set(JSON.parse(this.storageService.get(Ya.cacheStorageID,at.Ro.PROFILE,JSON.stringify([])))),this.storageService.remove(Ya.cacheStorageID,at.Ro.PROFILE),this._register(this.storageService.onWillSaveState(()=>{this.cacheEditors()})),this._register(this.extensionService.onDidRegisterExtensions(()=>{this.cache=void 0}))}resolveUntypedInputAndGroup(e,t){let i=e,o=this.instantiationService.invokeFunction(Et.a,i,t);if(o instanceof Promise)return o.then(e=>{let[t,o]=e;return[i,t,o]});{let[e,t]=o;return[i,e,t]}}async resolveEditor(e,t){var i,o,s,r;if(this._flattenedEditors=this._flattenEditorsMap(),(0,bt.pn)(e))return this.doResolveSideBySideEditor(e,t);let n,a=this.resolveUntypedInputAndGroup(e,t);if(n=a instanceof Promise?await a:a,!n)return dt.n.NONE;let[d,l,c]=n;c&&(d.options=(0,rt.A)((0,rt.A)({},d.options),{},{activation:c}));let h=bt.Ht.getCanonicalUri(d,{supportSideBySide:bt.Jt.PRIMARY});if(this.cache&&h&&this.resourceMatchesCache(h)&&await this.extensionService.whenInstalledExtensionsRegistered(),void 0===h)h=at.xO.from({scheme:at.TT.untitled});else if(void 0===h.scheme||null===h)return dt.n.NONE;if((null===(i=d.options)||void 0===i?void 0:i.override)===at.Or.PICK){let e=await this.doPickEditor(d);if(!e)return dt.n.ABORT;d.options=e}let{editor:u,conflictingDefault:g}=this.getEditor(h,null===(o=d.options)||void 0===o?void 0:o.override);if(!u&&(null!==(s=d.options)&&void 0!==s&&s.override||(0,bt.in)(e)))return dt.n.NONE;if(!u){let e=this.getEditor(h,bt.Ft.id);if(u=null===e||void 0===e?void 0:e.editor,g=null===e||void 0===e?void 0:e.conflictingDefault,!u)return dt.n.NONE}if((0,bt.ln)(d)&&void 0===(null===(r=d.options)||void 0===r?void 0:r.override)){let e=bt.Ht.getCanonicalUri(d,{supportSideBySide:bt.Jt.SECONDARY});e||(e=at.xO.from({scheme:at.TT.untitled}));let{editor:t}=this.getEditor(e,void 0);if(!t||u.editorInfo.id!==t.editorInfo.id){let{editor:e,conflictingDefault:t}=this.getEditor(h,bt.Ft.id);u=e,g=t}if(!u)return dt.n.NONE}if(d.options=(0,rt.A)({override:u.editorInfo.id},d.options),void 0===u.editorFactoryObject.createDiffEditorInput&&(0,bt.ln)(d))return dt.n.NONE;let p=await this.doResolveEditor(d,l,u);return g&&p&&await this.doHandleConflictingDefaults(h,u.editorInfo.label,d,p.editor,l),p?(p.editor.editorId!==u.editorInfo.id&&this.logService.warn("Editor ID Mismatch: ".concat(p.editor.editorId," !== ").concat(u.editorInfo.id,". This will cause bugs. Please ensure editorInput.editorId matches the registered id")),(0,rt.A)((0,rt.A)({},p),{},{group:l})):dt.n.ABORT}async doResolveSideBySideEditor(e,t){var i,o;let s=await this.resolveEditor(e.primary,t);if(!(0,bt.an)(s))return dt.n.NONE;let r=await this.resolveEditor(e.secondary,null!==(i=s.group)&&void 0!==i?i:t);return(0,bt.an)(r)?{group:null!==(o=s.group)&&void 0!==o?o:r.group,editor:this.instantiationService.createInstance(bt.Et,e.label,e.description,r.editor,s.editor),options:e.options}:dt.n.NONE}bufferChangeEvents(e){this._onDidChangeEditorRegistrations.pause();try{e()}finally{this._onDidChangeEditorRegistrations.resume()}}registerEditor(e,t,i,o){let s=this._editors.get(e);void 0===s&&(s=new Map,this._editors.set(e,s));let r=s.get(t.id);void 0===r&&(r=[]);let n=(0,at.jN)(r,{globPattern:e,editorInfo:t,options:i,editorFactoryObject:o});return s.set(t.id,r),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire(),(0,at.kj)(()=>{var e;n(),r&&0===r.length&&null!==(e=s)&&void 0!==e&&e.delete(t.id),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire()})}getAssociationsForResource(e){let t=this.getAllUserAssociations().filter(t=>t.filenamePattern&&(0,dt.i)(t.filenamePattern,e));t=t.sort((e,t)=>{var i,o,s,r;return(null!==(i=null===(o=t.filenamePattern)||void 0===o?void 0:o.length)&&void 0!==i?i:0)-(null!==(s=null===(r=e.filenamePattern)||void 0===r?void 0:r.length)&&void 0!==s?s:0)});let i=this._registeredEditors;return t.filter(e=>i.find(t=>t.editorInfo.id===e.viewType))}getAllUserAssociations(){var e,t,i;let o=this.configurationService.inspect("workbench.editorAssociations")||{},s=null!==(e=o.defaultValue)&&void 0!==e?e:{},r=null!==(t=o.workspaceValue)&&void 0!==t?t:{},n=null!==(i=o.userValue)&&void 0!==i?i:{},a=(0,rt.A)({},r);for(let[l,c]of Object.entries((0,rt.A)((0,rt.A)({},s),n)))void 0===a[l]&&(a[l]=c);let d=[];for(let[l,c]of Object.entries(a)){let e={filenamePattern:l,viewType:c};d.push(e)}return d}_flattenEditorsMap(){if(!this._shouldReFlattenEditors)return this._flattenedEditors;this._shouldReFlattenEditors=!1;let e=new Map;for(let[t,i]of this._editors){let o=[];for(let e of i.values()){let t;for(let i of e)t||(t={editorInfo:i.editorInfo,globPattern:i.globPattern,options:{},editorFactoryObject:{}}),t.options=(0,rt.A)((0,rt.A)({},t.options),i.options),t.editorFactoryObject=(0,rt.A)((0,rt.A)({},t.editorFactoryObject),i.editorFactoryObject);t&&o.push(t)}e.set(t,o)}return e}get _registeredEditors(){return Array.from(this._flattenedEditors.values()).flat()}updateUserAssociations(e,t){let i={viewType:t,filenamePattern:e},o=this.getAllUserAssociations(),s=Object.create(null);for(let r of[...o,i])r.filenamePattern&&(s[r.filenamePattern]=r.viewType);this.configurationService.updateValue(dt.r,s)}findMatchingEditors(e){let t=this.getAssociationsForResource(e),i=[];for(let[o,s]of this._flattenedEditors)for(let r of s)(t.find(e=>e.viewType===r.editorInfo.id)&&r.editorInfo.priority!==dt.t.exclusive||(0,dt.i)(o,e))&&i.push(r);return i.sort((e,t)=>(0,dt.o)(t.editorInfo.priority)===(0,dt.o)(e.editorInfo.priority)&&"string"==typeof t.globPattern&&"string"==typeof e.globPattern?t.globPattern.length-e.globPattern.length:(0,dt.o)(t.editorInfo.priority)-(0,dt.o)(e.editorInfo.priority))}getEditors(e){if(this._flattenedEditors=this._flattenEditorsMap(),at.xO.isUri(e)){let t=this.findMatchingEditors(e);return t.find(e=>e.editorInfo.priority===dt.t.exclusive)?[]:t.map(e=>e.editorInfo)}return(0,at.wN)(this._registeredEditors.map(e=>e.editorInfo),e=>e.id)}getEditor(e,t){var i,o;let s=(t,i)=>t.find(t=>t.options&&void 0!==t.options.canSupportResource?t.editorInfo.id===i&&t.options.canSupportResource(e):t.editorInfo.id===i);if(t&&t!==at.Or.EXCLUSIVE_ONLY){return{editor:s(this._registeredEditors,t),conflictingDefault:!1}}let r=this.findMatchingEditors(e),n=this.getAssociationsForResource(e),a=t===at.Or.EXCLUSIVE_ONLY?dt.t.exclusive:dt.t.builtin,d=r.filter(e=>(0,dt.o)(e.editorInfo.priority)>=(0,dt.o)(a)&&e.editorInfo.id!==bt.Ft.id);if(0===d.length)return{editor:n[0]&&a!==dt.t.exclusive?s(r,n[0].viewType):void 0,conflictingDefault:!1};let l=d[0].editorInfo.priority===dt.t.exclusive?d[0].editorInfo.id:(null===(i=n[0])||void 0===i?void 0:i.viewType)||(null===(o=d.find(t=>{var i;return!(null!==(i=t.options)&&void 0!==i&&i.canSupportResource)||t.options.canSupportResource(e)}))||void 0===o?void 0:o.editorInfo.id)||d[0].editorInfo.id,c=!1;return d=d.filter(e=>e.editorInfo.priority!==dt.t.exclusive).filter(t=>{var i;return!(null!==(i=t.options)&&void 0!==i&&i.canSupportResource)||t.options.canSupportResource(e)}),0===n.length&&d.length>1&&(c=!0),{editor:s(r,l),conflictingDefault:c}}async doResolveEditor(e,t,i){var o,s,r;let n=e.options,a=bt.Ht.getCanonicalUri(e,{supportSideBySide:bt.Jt.PRIMARY});if(n&&void 0===n.activation&&(n=(0,rt.A)((0,rt.A)({},n),{},{activation:n.preserveFocus?at.Er.RESTORE:void 0})),(0,bt.dn)(e)){var d;if(!i.editorFactoryObject.createMergeEditorInput)return;let o=await i.editorFactoryObject.createMergeEditorInput(e,t);return{editor:o.editor,options:null!==(d=o.options)&&void 0!==d?d:n}}if((0,bt.ln)(e)){var l;if(!i.editorFactoryObject.createDiffEditorInput)return;let o=await i.editorFactoryObject.createDiffEditorInput(e,t);return{editor:o.editor,options:null!==(l=o.options)&&void 0!==l?l:n}}if((0,bt.fn)(e)){var c;if(!i.editorFactoryObject.createMultiDiffEditorInput)return;let o=await i.editorFactoryObject.createMultiDiffEditorInput(e,t);return{editor:o.editor,options:null!==(c=o.options)&&void 0!==c?c:n}}if((0,bt.pn)(e))throw Error("Untyped side by side editor input not supported here.");if((0,bt.gn)(e)){var h;if(!i.editorFactoryObject.createUntitledEditorInput)return;let o=await i.editorFactoryObject.createUntitledEditorInput(e,t);return{editor:o.editor,options:null!==(h=o.options)&&void 0!==h?h:n}}if(void 0===a)throw Error("Undefined resource on non untitled editor input.");if("function"==typeof(null===(o=i.options)||void 0===o?void 0:o.singlePerResource)?i.options.singlePerResource():null===(s=i.options)||void 0===s?void 0:s.singlePerResource){let e=this.findExistingEditorsForResource(a,i.editorInfo.id);if(e.length){let i=await this.moveExistingEditorForResource(e,t);return i?{editor:i,options:n}:void 0}}if(!i.editorFactoryObject.createEditorInput)return;let u=await i.editorFactoryObject.createEditorInput(e,t);return n=null!==(r=u.options)&&void 0!==r?r:n,{editor:u.editor,options:n}}async moveExistingEditorForResource(e,t){let i=e[0];for(let{editor:o,group:s}of e)if(o!==i.editor&&!await s.closeEditor(o))return;if(t.id===i.group.id||i.group.moveEditor(i.editor,t))return i.editor}findExistingEditorsForResource(e,t){let i=[],o=(0,at.wN)([...this.editorGroupService.groups]);for(let s of o)for(let o of s.editors)(0,at.pT)(o.resource,e)&&o.editorId===t&&i.push({editor:o,group:s});return i}async doHandleConflictingDefaults(e,t,i,o,s){let r=this.findMatchingEditors(e),n=JSON.parse(this.storageService.get(Ya.conflictingDefaultsStorageID,at.Ro.PROFILE,"{}")),a="*".concat((0,at.uT)(e)),d=()=>{n[a]=[],r.forEach(e=>n[a].push(e.editorInfo.id)),this.storageService.store(Ya.conflictingDefaultsStorageID,JSON.stringify(n),at.Ro.PROFILE,at.zo.MACHINE)};if(n[a]&&n[a].find(e=>e===o.editorId))return;let l=this.notificationService.prompt(at.Ud.Warning,(0,at.EM)(13216,"There are multiple default editors available for the resource."),[{label:(0,at.EM)(13217,"Configure Default"),run:async()=>{var e;let t=await this.doPickEditor(i,!0);if(!t)return;i.options=t;let r=await this.resolveEditor(i,s);r===dt.n.ABORT||r===dt.n.NONE||s.replaceEditors([{editor:o,replacement:r.editor,options:null!==(e=r.options)&&void 0!==e?e:t}])}},{label:(0,at.EM)(13218,"Keep {0}",t),run:d}]).onDidClose(()=>{d(),l.dispose()})}mapEditorsToQuickPickEntry(e,t){var i,o,s;let r=this.editorGroupService.activeGroup.findEditors(e).at(0),n=e.scheme===at.TT.untitled?this._registeredEditors.filter(e=>e.editorInfo.priority!==dt.t.exclusive):this.findMatchingEditors(e);n=(0,at.wN)(n,e=>e.editorInfo.id);let a=null===(i=this.getAssociationsForResource(e)[0])||void 0===i?void 0:i.viewType;n=n.sort((e,t)=>e.editorInfo.id===bt.Ft.id?-1:t.editorInfo.id===bt.Ft.id?1:(0,dt.o)(t.editorInfo.priority)-(0,dt.o)(e.editorInfo.priority));let d=[],l=(0,at.EM)(13219,"Active"),c=(0,at.EM)(13220,"Default"),h=(0,at.EM)(13221,"Active and Default"),u=a;if(!u&&n.length>2&&(null===(o=n[1])||void 0===o?void 0:o.editorInfo.priority)!==dt.t.option&&(u=null===(s=n[1])||void 0===s?void 0:s.editorInfo.id),u||(u=bt.Ft.id),n.forEach(e=>{var t,i;let o=null!==(t=null===r||void 0===r?void 0:r.editorId)&&void 0!==t?t:bt.Ft.id,s=!!r&&e.editorInfo.id===o,n=e.editorInfo.id===u,a={id:e.editorInfo.id,label:e.editorInfo.label,description:s&&n?h:s?l:n?c:void 0,detail:null!==(i=e.editorInfo.detail)&&void 0!==i?i:e.editorInfo.priority};d.push(a)}),!t&&""!==(0,at.uT)(e)){d.push({type:"separator"});let t={id:Ya.configureDefaultID,label:(0,at.EM)(13222,"Configure default editor for '{0}'...","*".concat((0,at.uT)(e)))};d.push(t)}return d}async doPickEditor(e,t){var i;let o=bt.Ht.getOriginalUri(e,{supportSideBySide:bt.Jt.PRIMARY});void 0===o&&(o=at.xO.from({scheme:at.TT.untitled}));let s=this.mapEditorsToQuickPickEntry(o,t),r=new at.gj,n=r.add(this.quickInputService.createQuickPick({useSeparators:!0}));n.placeholder=t?(0,at.EM)(13223,"Select new default editor for '{0}'","*".concat((0,at.uT)(o))):(0,at.EM)(13224,"Select editor for '{0}'",(0,at.iT)(o)),n.canAcceptInBackground=!0,n.items=s;let a=n.items.find(e=>"item"===e.type);a&&(n.selectedItems=[a]);let d=await new Promise(e=>{r.add(n.onDidAccept(i=>{var s;let r;1===n.selectedItems.length&&(r={item:n.selectedItems[0],keyMods:n.keyMods,openInBackground:i.inBackground}),o&&t&&null!==(s=r)&&void 0!==s&&s.item.id&&this.updateUserAssociations("*".concat((0,at.uT)(o)),r.item.id),e(r)})),r.add(n.onDidHide(()=>{r.dispose(),e(void 0)})),r.add(n.onDidTriggerItemButton(t=>{e({item:t.item,openInBackground:!1}),o&&t.item&&t.item.id&&this.updateUserAssociations("*".concat((0,at.uT)(o)),t.item.id)})),n.show()});if(n.dispose(),d)return d.item.id===Ya.configureDefaultID?this.doPickEditor(e,!0):(0,rt.A)((0,rt.A)({},e.options),{},{override:d.item.id,preserveFocus:d.openInBackground||(null===(i=e.options)||void 0===i?void 0:i.preserveFocus)})}cacheEditors(){let e=new Set;for(let[i,o]of this._flattenedEditors)o.find(e=>e.editorInfo.priority!==dt.t.option&&e.editorInfo.id!==bt.Ft.id)&&((0,at.va)(i)?e.add("".concat(i.pattern)):e.add(i));let t=this.getAllUserAssociations();for(let i of t)i.filenamePattern&&e.add(i.filenamePattern);this.storageService.store(Ya.cacheStorageID,JSON.stringify(Array.from(e)),at.Ro.PROFILE,at.zo.MACHINE)}resourceMatchesCache(e){if(!this.cache)return!1;for(let t of this.cache)if((0,dt.i)(t,e))return!0;return!1}},{_:Ya=ee},{_:ee.configureDefaultID="promptOpenWith.configureDefault"},{_:ee.cacheStorageID="editorOverrideService.cache"},{_:ee.conflictingDefaultsStorageID="editorOverrideService.conflictingDefaults"},ee);Qa=Ya=(0,at.Jb)([(0,at.Yb)(0,bt.W),(0,at.Yb)(1,at.rx),(0,at.Yb)(2,at.r_),(0,at.Yb)(3,at.uc),(0,at.Yb)(4,at.Pd),(0,at.Yb)(5,at.Io),(0,at.Yb)(6,pt.Mt),(0,at.Yb)(7,at.mb)],Qa),(0,at.Xb)(),(0,at.SO)(),(0,at.ox)(),(0,pt.u)(),(0,at.i_)(),(0,at.sj)(),(0,at.Hj)(),(0,at.ET)(),(0,at.wj)(),(0,at.Jp)();var Xa,Ha=(te=class extends at.mj{constructor(e,t){super(),this.instantiationService=e,this.configurationService=t,this._onDidSave=this._register(new at.ej),this.onDidSave=this._onDidSave.event,this._onDidChangeDirty=this._register(new at.ej),this.onDidChangeDirty=this._onDidChangeDirty.event,this._onDidChangeEncoding=this._register(new at.ej),this.onDidChangeEncoding=this._onDidChangeEncoding.event,this._onDidCreate=this._register(new at.ej),this.onDidCreate=this._onDidCreate.event,this._onWillDispose=this._register(new at.ej),this.onWillDispose=this._onWillDispose.event,this._onDidChangeLabel=this._register(new at.ej),this.onDidChangeLabel=this._onDidChangeLabel.event,this.mapResourceToModel=new at.Lj}get(e){return this.mapResourceToModel.get(e)}getValue(e){var t;return null===(t=this.get(e))||void 0===t||null===(t=t.textEditorModel)||void 0===t?void 0:t.getValue()}async resolve(e){let t=this.doCreateOrGet(e);return await t.resolve(),t}create(e){return this.doCreateOrGet(e)}doCreateOrGet(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.create(null),t=this.massageOptions(e);return t.untitledResource&&this.mapResourceToModel.has(t.untitledResource)?this.mapResourceToModel.get(t.untitledResource):this.doCreate(t)}massageOptions(e){var t;let i=Object.create(null);if(e.associatedResource?(i.untitledResource=at.xO.from({scheme:at.TT.untitled,authority:e.associatedResource.authority,fragment:e.associatedResource.fragment,path:e.associatedResource.path,query:e.associatedResource.query}),i.associatedResource=e.associatedResource):(null===(t=e.untitledResource)||void 0===t?void 0:t.scheme)===at.TT.untitled&&(i.untitledResource=e.untitledResource),e.languageId)i.languageId=e.languageId;else if(!i.associatedResource){var o;let e=this.configurationService.getValue();(null===(o=e.files)||void 0===o?void 0:o.defaultLanguage)&&(i.languageId=e.files.defaultLanguage)}return i.encoding=e.encoding,i.initialValue=e.initialValue,i}doCreate(e){let t=e.untitledResource;if(!t){let e=1;do{t=at.xO.from({scheme:at.TT.untitled,path:"Untitled-".concat(e)}),e++}while(this.mapResourceToModel.has(t))}let i=this._register(this.instantiationService.createInstance(pt.l,t,!!e.associatedResource,e.initialValue,e.languageId,e.encoding));return this.registerModel(i),i}registerModel(e){let t=new at.gj;t.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),t.add(e.onDidChangeName(()=>this._onDidChangeLabel.fire(e))),t.add(e.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(e))),t.add(e.onWillDispose(()=>this._onWillDispose.fire(e))),at.tj.once(e.onWillDispose)(()=>{this.mapResourceToModel.delete(e.resource),t.dispose()}),this.mapResourceToModel.set(e.resource,e),this._onDidCreate.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e)}isUntitledWithAssociatedResource(e){return e.scheme===at.TT.untitled&&e.path.length>1&&!Xa.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(e.path)}canDispose(e){return!!e.isDisposed()||this.doCanDispose(e)}async doCanDispose(e){return!e.isDirty()||(await at.tj.toPromise(e.onDidChangeDirty),this.canDispose(e))}notifyDidSave(e,t){this._onDidSave.fire({source:e,target:t})}},{_:Xa=te},{_:te.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/},te);Ha=Xa=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,at.r_)],Ha),(0,at.Xb)(),(0,at.TM)(),(0,at.SO)(),(0,bt.en)(),(0,bt.At)(),(0,gt.s)(),(0,gt.Fn)(),(0,at.Qs)(),(0,at.ps)(),(0,at.Ma)(),(0,at.wj)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.sj)(),(0,at.i_)(),(0,bt.G)(),(0,ut.Ld)(),(0,at.ox)(),(0,pt.st)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.AN)(),(0,at.Jp)(),(0,at.oS)(),(0,ut.Pb)(),(0,at.ET)(),(0,at.aP)(),(0,bt.o)(),(0,bt.j)(),(0,at.Go)(),(0,bt.L)(),(0,bt.z)(),(0,at.Tp)(),(0,at.gb)(),(0,at.SE)();var Ua,ja,za=(ie=class extends at.mj{constructor(e,t,i,o,s,r,n,a,d,l,c){super(),this.editorService=e,this.editorGroupService=t,this.contextService=i,this.storageService=o,this.configurationService=s,this.fileService=r,this.workspacesService=n,this.instantiationService=a,this.layoutService=d,this.contextKeyService=l,this.logService=c,this.activeEditorListeners=this._register(new at.gj),this.lastActiveEditor=void 0,this._onDidChangeEditorNavigationStack=this._register(new at.ej),this.onDidChangeEditorNavigationStack=this._onDidChangeEditorNavigationStack.event,this.defaultScopedEditorNavigationStack=void 0,this.editorGroupScopedNavigationStacks=new Map,this.editorScopedNavigationStacks=new Map,this.editorNavigationScope=gt.o.DEFAULT,this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0,this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0,this.navigatingInRecentlyUsedEditorsStack=!1,this.navigatingInRecentlyUsedEditorsInGroupStack=!1,this.recentlyClosedEditors=[],this.ignoreEditorCloseEvent=!1,this.history=void 0,this.editorHistoryListeners=new Map,this.resourceExcludeMatcher=this._register(new at.yx(at.wE,()=>{let e=this._register(this.instantiationService.createInstance(bt.a,e=>(0,ut.Pd)(e?this.configurationService.getValue({resource:e}):this.configurationService.getValue())||Object.create(null),e=>e.affectsConfiguration("files.exclude")||e.affectsConfiguration("search.exclude")));return this._register(e.onExpressionChange(()=>this.removeExcludedFromHistory())),e})),this.editorHelper=this.instantiationService.createInstance(id),this.canNavigateBackContextKey=new at.Nk("canNavigateBack",!1,(0,at.EM)(13437,"Whether it is possible to navigate back in editor history")).bindTo(this.contextKeyService),this.canNavigateForwardContextKey=new at.Nk("canNavigateForward",!1,(0,at.EM)(13438,"Whether it is possible to navigate forward in editor history")).bindTo(this.contextKeyService),this.canNavigateBackInNavigationsContextKey=new at.Nk("canNavigateBackInNavigationLocations",!1,(0,at.EM)(13439,"Whether it is possible to navigate back in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInNavigationsContextKey=new at.Nk("canNavigateForwardInNavigationLocations",!1,(0,at.EM)(13440,"Whether it is possible to navigate forward in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateToLastNavigationLocationContextKey=new at.Nk("canNavigateToLastNavigationLocation",!1,(0,at.EM)(13441,"Whether it is possible to navigate to the last editor navigation location")).bindTo(this.contextKeyService),this.canNavigateBackInEditsContextKey=new at.Nk("canNavigateBackInEditLocations",!1,(0,at.EM)(13442,"Whether it is possible to navigate back in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInEditsContextKey=new at.Nk("canNavigateForwardInEditLocations",!1,(0,at.EM)(13443,"Whether it is possible to navigate forward in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateToLastEditLocationContextKey=new at.Nk("canNavigateToLastEditLocation",!1,(0,at.EM)(13444,"Whether it is possible to navigate to the last editor edit location")).bindTo(this.contextKeyService),this.canReopenClosedEditorContextKey=new at.Nk("canReopenClosedEditor",!1,(0,at.EM)(13445,"Whether it is possible to reopen the last closed editor")).bindTo(this.contextKeyService),this.registerListeners(),this.editorService.activeEditorPane&&this.onDidActiveEditorChange()}registerListeners(){this.registerMouseNavigationListener(),this._register(this.editorService.onDidActiveEditorChange(()=>this.onDidActiveEditorChange())),this._register(this.editorService.onDidOpenEditorFail(e=>this.remove(e.editor))),this._register(this.editorService.onDidCloseEditor(e=>this.onDidCloseEditor(e))),this._register(this.editorService.onDidMostRecentlyActiveEditorsChange(()=>this.handleEditorEventInRecentEditorsStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>this.onDidRemoveGroup(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidFilesChange(e))),this._register(this.storageService.onWillSaveState(()=>this.saveState())),this.registerEditorNavigationScopeChangeListener(),this._register(this.onDidChangeEditorNavigationStack(()=>this.updateContextKeys())),this._register(this.editorGroupService.onDidChangeActiveGroup(()=>this.updateContextKeys()))}onDidCloseEditor(e){this.handleEditorCloseEventInHistory(e),this.handleEditorCloseEventInReopen(e)}registerMouseNavigationListener(){let e=this._register(new at.gj),t=()=>{e.clear(),this.configurationService.getValue(Ua.MOUSE_NAVIGATION_SETTING)&&this._register(at.tj.runAndSubscribe(this.layoutService.onDidAddContainer,t=>{let{container:i,disposables:o}=t,s=o.add(new at.gj);s.add((0,at.Sx)(i,at._x.MOUSE_DOWN,e=>this.onMouseDownOrUp(e,!0))),s.add((0,at.Sx)(i,at._x.MOUSE_UP,e=>this.onMouseDownOrUp(e,!1))),e.add(s)},{container:this.layoutService.mainContainer,disposables:this._store}))};this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Ua.MOUSE_NAVIGATION_SETTING)&&t()})),t()}onMouseDownOrUp(e,t){switch(e.button){case 3:at.gx.stop(e),t&&this.goBack();break;case 4:at.gx.stop(e),t&&this.goForward()}}onDidRemoveGroup(e){this.handleEditorGroupRemoveInNavigationStacks(e)}onDidActiveEditorChange(){let e=this.editorGroupService.activeGroup,t=e.activeEditorPane;if(!this.lastActiveEditor||!this.editorHelper.matchesEditorIdentifier(this.lastActiveEditor,t)){if(this.lastActiveEditor=null!==t&&void 0!==t&&t.input?{editor:t.input,groupId:t.group.id}:void 0,this.activeEditorListeners.clear(),null!==t&&void 0!==t&&t.group.isTransient(t.input)){var i;this.logService.trace("[History]: ignoring transient editor change until becoming non-transient (editor: ".concat(null===(i=t.input)||void 0===i||null===(i=i.resource)||void 0===i?void 0:i.toString(),"})"));let o=e.onDidModelChange(i=>{i.kind===bt.Wt.EDITOR_TRANSIENT&&i.editor===t.input&&!t.group.isTransient(t.input)&&(o.dispose(),this.handleActiveEditorChange(e,t))});this.activeEditorListeners.add(o)}else this.handleActiveEditorChange(e,t);(0,bt.cn)(t)&&this.activeEditorListeners.add(t.onDidChangeSelection(i=>{var o;t.group.isTransient(t.input)?this.logService.trace("[History]: ignoring transient editor selection change (editor: ".concat(null===(o=t.input)||void 0===o||null===(o=o.resource)||void 0===o?void 0:o.toString(),"})")):this.handleActiveEditorSelectionChangeEvent(e,t,i)})),this.updateContextKeys()}}onDidFilesChange(e){e instanceof at.ws?e.gotDeleted()&&this.remove(e):e.isOperation(at.Es.DELETE)?this.remove(e):e.isOperation(at.Es.MOVE)&&e.target.isFile&&this.move(e)}handleActiveEditorChange(e,t){this.handleActiveEditorChangeInHistory(t),this.handleActiveEditorChangeInNavigationStacks(e,t)}handleActiveEditorSelectionChangeEvent(e,t,i){this.handleActiveEditorSelectionChangeInNavigationStacks(e,t,i)}move(e){this.moveInHistory(e),this.moveInEditorNavigationStacks(e)}remove(e){this.removeFromHistory(e),this.removeFromEditorNavigationStacks(e),this.removeFromRecentlyClosedEditors(e),this.removeFromRecentlyOpened(e)}removeFromRecentlyOpened(e){let t;(0,bt.rn)(e)?t=bt.Ht.getOriginalUri(e):e instanceof at.ws||(t=e.resource),t&&this.workspacesService.removeRecentlyOpened([t])}clear(){this.clearRecentlyOpened(),this.clearEditorNavigationStacks(),this.recentlyClosedEditors=[],this.updateContextKeys()}updateContextKeys(){this.contextKeyService.bufferChangeEvents(()=>{let e=this.getStack();this.canNavigateBackContextKey.set(e.canGoBack(gt.a.NONE)),this.canNavigateForwardContextKey.set(e.canGoForward(gt.a.NONE)),this.canNavigateBackInNavigationsContextKey.set(e.canGoBack(gt.a.NAVIGATION)),this.canNavigateForwardInNavigationsContextKey.set(e.canGoForward(gt.a.NAVIGATION)),this.canNavigateToLastNavigationLocationContextKey.set(e.canGoLast(gt.a.NAVIGATION)),this.canNavigateBackInEditsContextKey.set(e.canGoBack(gt.a.EDITS)),this.canNavigateForwardInEditsContextKey.set(e.canGoForward(gt.a.EDITS)),this.canNavigateToLastEditLocationContextKey.set(e.canGoLast(gt.a.EDITS)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)})}registerEditorNavigationScopeChangeListener(){let e=()=>{this.disposeEditorNavigationStacks();let e=this.configurationService.getValue(Ua.NAVIGATION_SCOPE_SETTING);this.editorNavigationScope="editorGroup"===e?gt.o.EDITOR_GROUP:"editor"===e?gt.o.EDITOR:gt.o.DEFAULT};this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Ua.NAVIGATION_SCOPE_SETTING)&&e()})),e()}getStack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editorGroupService.activeGroup,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.activeEditor;switch(this.editorNavigationScope){case gt.o.EDITOR:{var i;if(!t)return new ed;let o=this.editorScopedNavigationStacks.get(e.id);o||(o=new Map,this.editorScopedNavigationStacks.set(e.id,o));let s=null===(i=o.get(t))||void 0===i?void 0:i.stack;if(!s){let e=new at.gj;s=e.add(this.instantiationService.createInstance($a,gt.o.EDITOR)),e.add(s.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),o.set(t,{stack:s,disposable:e})}return s}case gt.o.EDITOR_GROUP:{var o;let t=null===(o=this.editorGroupScopedNavigationStacks.get(e.id))||void 0===o?void 0:o.stack;if(!t){let i=new at.gj;t=i.add(this.instantiationService.createInstance($a,gt.o.EDITOR_GROUP)),i.add(t.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),this.editorGroupScopedNavigationStacks.set(e.id,{stack:t,disposable:i})}return t}case gt.o.DEFAULT:return this.defaultScopedEditorNavigationStack||(this.defaultScopedEditorNavigationStack=this._register(this.instantiationService.createInstance($a,gt.o.DEFAULT)),this._register(this.defaultScopedEditorNavigationStack.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire()))),this.defaultScopedEditorNavigationStack}}goForward(e){return this.getStack().goForward(e)}goBack(e){return this.getStack().goBack(e)}goPrevious(e){return this.getStack().goPrevious(e)}goLast(e){return this.getStack().goLast(e)}handleActiveEditorChangeInNavigationStacks(e,t){this.getStack(e,null===t||void 0===t?void 0:t.input).handleActiveEditorChange(t)}handleActiveEditorSelectionChangeInNavigationStacks(e,t,i){this.getStack(e,t.input).handleActiveEditorSelectionChange(t,i)}handleEditorCloseEventInHistory(e){let t=this.editorScopedNavigationStacks.get(e.groupId);if(t){let i=t.get(e.editor);i&&(i.disposable.dispose(),t.delete(e.editor)),0===t.size&&this.editorScopedNavigationStacks.delete(e.groupId)}}handleEditorGroupRemoveInNavigationStacks(e){var t;null===(t=this.defaultScopedEditorNavigationStack)||void 0===t||t.remove(e.id);let i=this.editorGroupScopedNavigationStacks.get(e.id);i&&(i.disposable.dispose(),this.editorGroupScopedNavigationStacks.delete(e.id))}clearEditorNavigationStacks(){this.withEachEditorNavigationStack(e=>e.clear())}removeFromEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.remove(e))}moveInEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.move(e))}withEachEditorNavigationStack(e){this.defaultScopedEditorNavigationStack&&e(this.defaultScopedEditorNavigationStack);for(let[,t]of this.editorGroupScopedNavigationStacks)e(t.stack);for(let[,t]of this.editorScopedNavigationStacks)for(let[,i]of t)e(i.stack)}disposeEditorNavigationStacks(){var e;null!==(e=this.defaultScopedEditorNavigationStack)&&void 0!==e&&e.dispose(),this.defaultScopedEditorNavigationStack=void 0;for(let[,t]of this.editorGroupScopedNavigationStacks)t.disposable.dispose();this.editorGroupScopedNavigationStacks.clear();for(let[,t]of this.editorScopedNavigationStacks)for(let[,e]of t)e.disposable.dispose();this.editorScopedNavigationStacks.clear()}openNextRecentlyUsedEditor(e){let[t,i]=this.ensureRecentlyUsedStack(e=>e-1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}openPreviouslyUsedEditor(e){let[t,i]=this.ensureRecentlyUsedStack(e=>e+1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}async doNavigateInRecentlyUsedEditorsStack(e,t){if(e){var i;let o="number"!=typeof t||!this.editorGroupService.getGroup(t);o?this.navigatingInRecentlyUsedEditorsStack=!0:this.navigatingInRecentlyUsedEditorsInGroupStack=!0;let s=null!==(i=this.editorGroupService.getGroup(e.groupId))&&void 0!==i?i:this.editorGroupService.activeGroup;try{await s.openEditor(e.editor)}finally{o?this.navigatingInRecentlyUsedEditorsStack=!1:this.navigatingInRecentlyUsedEditorsInGroupStack=!1}}}ensureRecentlyUsedStack(e,t){let i,o,s="number"==typeof t?this.editorGroupService.getGroup(t):void 0;s?(i=this.recentlyUsedEditorsInGroupStack||s.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE).map(e=>({groupId:s.id,editor:e})),o=this.recentlyUsedEditorsInGroupStackIndex):(i=this.recentlyUsedEditorsStack||this.editorService.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE),o=this.recentlyUsedEditorsStackIndex);let r=e(o);return r<0?r=0:r>i.length-1&&(r=i.length-1),s?(this.recentlyUsedEditorsInGroupStack=i,this.recentlyUsedEditorsInGroupStackIndex=r):(this.recentlyUsedEditorsStack=i,this.recentlyUsedEditorsStackIndex=r),[i,r]}handleEditorEventInRecentEditorsStack(){this.navigatingInRecentlyUsedEditorsStack||(this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0),this.navigatingInRecentlyUsedEditorsInGroupStack||(this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0)}handleEditorCloseEventInReopen(e){if(this.ignoreEditorCloseEvent)return;let{editor:t,context:i}=e;if(i===bt.It.REPLACE||i===bt.It.MOVE)return;let o=t.toUntyped();if(!o)return;let s=[],r=bt.Ht.getOriginalUri(t,{supportSideBySide:bt.Jt.BOTH});at.xO.isUri(r)?s.push(r):r&&s.push(...(0,at._N)([r.primary,r.secondary])),this.removeFromRecentlyClosedEditors(t),this.recentlyClosedEditors.push({editorId:t.editorId,editor:o,resource:bt.Ht.getOriginalUri(t),associatedResources:s,index:e.index,sticky:e.sticky}),this.recentlyClosedEditors.length>Ua.MAX_RECENTLY_CLOSED_EDITORS&&this.recentlyClosedEditors.shift(),this.canReopenClosedEditorContextKey.set(!0)}async reopenLastClosedEditor(){let e,t=this.recentlyClosedEditors.pop();return t&&(e=this.doReopenLastClosedEditor(t)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0),e}async doReopenLastClosedEditor(e){let t,i={pinned:!0,sticky:e.sticky,index:e.index,ignoreError:!0};if((e.sticky&&!this.editorGroupService.activeGroup.isSticky(e.index)||!e.sticky&&this.editorGroupService.activeGroup.isSticky(e.index))&&(i.index=void 0),!this.editorGroupService.activeGroup.contains(e.editor)){this.ignoreEditorCloseEvent=!0;try{t=await this.editorService.openEditor((0,rt.A)((0,rt.A)({},e.editor),{},{options:(0,rt.A)((0,rt.A)({},e.editor.options),i)}))}finally{this.ignoreEditorCloseEvent=!1}}t||((0,at.BN)(this.recentlyClosedEditors,e),this.reopenLastClosedEditor())}removeFromRecentlyClosedEditors(e){this.recentlyClosedEditors=this.recentlyClosedEditors.filter(t=>!(!(0,bt.rn)(e)||t.editorId===e.editorId)||!(t.resource&&this.editorHelper.matchesFile(t.resource,e)||t.associatedResources.some(t=>this.editorHelper.matchesFile(t,e)))),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)}handleActiveEditorChangeInHistory(e){let t=null===e||void 0===e?void 0:e.input;!t||t.isDisposed()||!this.includeInHistory(t)||(this.removeFromHistory(t),this.addToHistory(t))}addToHistory(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.ensureHistoryLoaded(this.history);let i=this.editorHelper.preferResourceEditorInput(e);i&&(t?this.history.unshift(i):this.history.push(i),this.history.length>Ua.MAX_HISTORY_ITEMS&&this.editorHelper.clearOnEditorDispose(this.history.pop(),this.editorHistoryListeners),(0,bt.rn)(e)&&this.editorHelper.onEditorDispose(e,()=>this.updateHistoryOnEditorDispose(i),this.editorHistoryListeners))}updateHistoryOnEditorDispose(e){if((0,bt.rn)(e))if((0,bt.mn)(e)){let t=[],i=e.primary.matches(e.secondary)?[e.primary]:[e.primary,e.secondary];for(let e of i){let i=this.editorHelper.preferResourceEditorInput(e);(0,bt.un)(i)&&this.includeInHistory(i)&&t.push(i)}this.replaceInHistory(e,...t)}else this.removeFromHistory(e);else this.includeInHistory(e)||this.removeFromHistory(e)}includeInHistory(e){return!!(0,bt.rn)(e)||!this.resourceExcludeMatcher.value.matches(e.resource)}removeExcludedFromHistory(){this.ensureHistoryLoaded(this.history),this.history=this.history.filter(e=>{let t=this.includeInHistory(e);return t||this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t})}moveInHistory(e){e.isOperation(at.Es.MOVE)&&this.removeFromHistory(e)&&this.addToHistory({resource:e.target.resource})}removeFromHistory(e){let t=!1;return this.ensureHistoryLoaded(this.history),this.history=this.history.filter(i=>{let o=this.editorHelper.matchesEditor(e,i);return o&&(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t=!0),!o}),t}replaceInHistory(e){this.ensureHistoryLoaded(this.history);let t=!1,i=[];for(var o=arguments.length,s=new Array(o>1?o-1:0),r=1;r<o;r++)s[r-1]=arguments[r];for(let n of this.history)this.editorHelper.matchesEditor(e,n)?(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t||(i.push(...s),t=!0)):s.some(e=>this.editorHelper.matchesEditor(e,n))||i.push(n);t||i.push(...s),this.history=i}clearRecentlyOpened(){this.history=[];for(let[,e]of this.editorHistoryListeners)(0,at.Sj)(e);this.editorHistoryListeners.clear()}getHistory(){return this.ensureHistoryLoaded(this.history),this.history}ensureHistoryLoaded(e){this.history||(this.history=[],this.editorGroupService.isReady?this.loadHistory():(async()=>{await this.editorGroupService.whenReady,this.loadHistory()})())}loadHistory(){this.history=[];let e=this.loadHistoryFromStorage(),t=[...this.editorService.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE)].reverse(),i=new Set;for(let{editor:s}of t)if(this.includeInHistory(s)){if(s.resource){let e="".concat(s.resource.toString(),"/").concat(s.editorId);if(i.has(e))continue;i.add(e)}this.addToHistory(s)}for(let s of e){var o;let e="".concat(s.resource.toString(),"/").concat(null===(o=s.options)||void 0===o?void 0:o.override);!i.has(e)&&this.includeInHistory(s)&&(i.add(e),this.addToHistory(s,!1))}}loadHistoryFromStorage(){let e=[],t=this.storageService.get(Ua.HISTORY_STORAGE_KEY,at.Ro.WORKSPACE);if(t)try{let i=JSON.parse(t);for(let t of i)if(t.editor&&t.editor.resource)try{e.push((0,rt.A)((0,rt.A)({},t.editor),{},{resource:"string"==typeof t.editor.resource?at.xO.parse(t.editor.resource):at.xO.from(t.editor.resource)}))}catch(e){(0,at.sP)(e)}}catch(e){(0,at.sP)(e)}return e}saveState(){if(!this.history)return;let e=[];for(let t of this.history)(0,bt.rn)(t)||!(0,bt.un)(t)||e.push({editor:(0,rt.A)((0,rt.A)({},t),{},{resource:t.resource.toString()})});this.storageService.store(Ua.HISTORY_STORAGE_KEY,JSON.stringify(e),at.Ro.WORKSPACE,at.zo.MACHINE)}getLastActiveWorkspaceRoot(e,t){let i=this.contextService.getWorkspace().folders;if(0!==i.length){if(1===i.length){let o=i[0].uri;return e&&o.scheme!==e||t&&o.authority!==t?void 0:o}for(let i of this.getHistory()){if((0,bt.rn)(i)||e&&i.resource.scheme!==e||t&&i.resource.authority!==t)continue;let o=this.contextService.getWorkspaceFolder(i.resource);if(o)return o.uri}for(let o of i){let i=o.uri;if((!e||i.scheme===e)&&(!t||i.authority===t))return i}}}getLastActiveFile(e,t){for(let i of this.getHistory()){let o;if(o=(0,bt.rn)(i)?bt.Ht.getOriginalUri(i,{filterByScheme:e}):i.resource,o&&o.scheme===e&&(!t||o.authority===t))return o}}dispose(){super.dispose();for(let[,e]of this.editorGroupScopedNavigationStacks)e.disposable.dispose();for(let[,e]of this.editorScopedNavigationStacks)for(let[,t]of e)t.disposable.dispose();for(let[,e]of this.editorHistoryListeners)e.dispose()}},{_:Ua=ie},{_:ie.MOUSE_NAVIGATION_SETTING="workbench.editor.mouseBackForwardToNavigate"},{_:ie.NAVIGATION_SCOPE_SETTING="workbench.editor.navigationScope"},{_:ie.MAX_RECENTLY_CLOSED_EDITORS=20},{_:ie.MAX_HISTORY_ITEMS=200},{_:ie.HISTORY_STORAGE_KEY="history.entries"},ie);za=Ua=(0,at.Jb)([(0,at.Yb)(0,bt.kt),(0,at.Yb)(1,bt.W),(0,at.Yb)(2,at.ja),(0,at.Yb)(3,at.Io),(0,at.Yb)(4,at.r_),(0,at.Yb)(5,at.fs),(0,at.Yb)(6,ut.Nb),(0,at.Yb)(7,at.rx),(0,at.Yb)(8,pt.ot),(0,at.Yb)(9,at.Nb),(0,at.Yb)(10,at.mb)],za),(0,at.Yp)(gt.Pn,za,at.Kp.Eager);var qa=class{constructor(e,t,i){this.editorIdentifier=e,this.selection=t,this.reason=i}justifiesNewNavigationEntry(e){if(this.editorIdentifier.groupId!==e.editorIdentifier.groupId||!this.editorIdentifier.editor.matches(e.editorIdentifier.editor)||!this.selection||!e.selection)return!0;let t=this.selection.compare(e.selection);return t===bt.Vt.SIMILAR&&(e.reason===bt.Bt.NAVIGATION||e.reason===bt.Bt.JUMP)||t===bt.Vt.DIFFERENT}},$a=class extends at.mj{constructor(e,t){super(),this.scope=e,this.instantiationService=t,this.selectionsStack=this._register(this.instantiationService.createInstance(td,gt.a.NONE,this.scope)),this.editsStack=this._register(this.instantiationService.createInstance(td,gt.a.EDITS,this.scope)),this.navigationsStack=this._register(this.instantiationService.createInstance(td,gt.a.NAVIGATION,this.scope)),this.stacks=[this.selectionsStack,this.editsStack,this.navigationsStack],this.onDidChange=at.tj.any(this.selectionsStack.onDidChange,this.editsStack.onDidChange,this.navigationsStack.onDidChange)}canGoForward(e){return this.getStack(e).canGoForward()}goForward(e){return this.getStack(e).goForward()}canGoBack(e){return this.getStack(e).canGoBack()}goBack(e){return this.getStack(e).goBack()}goPrevious(e){return this.getStack(e).goPrevious()}canGoLast(e){return this.getStack(e).canGoLast()}goLast(e){return this.getStack(e).goLast()}getStack(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt.a.NONE){case gt.a.NONE:return this.selectionsStack;case gt.a.EDITS:return this.editsStack;case gt.a.NAVIGATION:return this.navigationsStack}}handleActiveEditorChange(e){this.selectionsStack.notifyNavigation(e)}handleActiveEditorSelectionChange(e,t){let i=this.selectionsStack.current;this.selectionsStack.notifyNavigation(e,t),t.reason===bt.Bt.EDIT?this.editsStack.notifyNavigation(e,t):(t.reason===bt.Bt.NAVIGATION||t.reason===bt.Bt.JUMP)&&!this.selectionsStack.isNavigating()&&(t.reason===bt.Bt.JUMP&&!this.navigationsStack.isNavigating()&&i&&this.navigationsStack.addOrReplace(i.groupId,i.editor,i.selection),this.navigationsStack.notifyNavigation(e,t))}clear(){for(let e of this.stacks)e.clear()}remove(e){for(let t of this.stacks)t.remove(e)}move(e){for(let t of this.stacks)t.move(e)}};$a=(0,at.Jb)([(0,at.Yb)(1,at.rx)],$a);var ed=class{constructor(){this.onDidChange=at.tj.None}canGoForward(){return!1}async goForward(){}canGoBack(){return!1}async goBack(){}async goPrevious(){}canGoLast(){return!1}async goLast(){}handleActiveEditorChange(){}handleActiveEditorSelectionChange(){}clear(){}remove(){}move(){}dispose(){}},td=(oe=class extends at.mj{get current(){return this.stack[this.index]}set current(e){e&&(this.stack[this.index]=e)}constructor(e,t,i,o,s,r){super(),this.filter=e,this.scope=t,this.editorService=o,this.editorGroupService=s,this.logService=r,this._onDidChange=this._register(new at.ej),this.onDidChange=this._onDidChange.event,this.mapEditorToDisposable=new Map,this.mapGroupToDisposable=new Map,this.stack=[],this.index=-1,this.previousIndex=-1,this.navigating=!1,this.currentSelectionState=void 0,this.editorHelper=i.createInstance(id),this.registerListeners()}registerListeners(){this._register(this.onDidChange(()=>this.traceStack())),this._register(this.logService.onDidChangeLogLevel(()=>this.traceStack()))}traceStack(){if(this.logService.getLevel()!==at.yp.Trace)return;let e=[];for(let s of this.stack){var t,i,o;"function"==typeof(null===(t=s.selection)||void 0===t?void 0:t.log)?e.push("- group: ".concat(s.groupId,", editor: ").concat(null===(i=s.editor.resource)||void 0===i?void 0:i.toString(),", selection: ").concat(s.selection.log())):e.push("- group: ".concat(s.groupId,", editor: ").concat(null===(o=s.editor.resource)||void 0===o?void 0:o.toString(),", selection: <none>"))}0===e.length?this.trace("index: ".concat(this.index,", navigating: ").concat(this.isNavigating(),": <empty>")):this.trace("index: ".concat(this.index,", navigating: ").concat(this.isNavigating(),"\n").concat(e.join("\n"),"\n\t\t\t"))}trace(e){var t;let i,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;if(this.logService.getLevel()===at.yp.Trace){switch(this.filter){case gt.a.NONE:i="global";break;case gt.a.EDITS:i="edits";break;case gt.a.NAVIGATION:i="navigation"}switch(this.scope){case gt.o.DEFAULT:o="default";break;case gt.o.EDITOR_GROUP:o="editorGroup";break;case gt.o.EDITOR:o="editor"}null===s?this.logService.trace("[History stack ".concat(i,"-").concat(o,"]: ").concat(e)):this.logService.trace("[History stack ".concat(i,"-").concat(o,"]: ").concat(e," (editor: ").concat(null===s||void 0===s||null===(t=s.resource)||void 0===t?void 0:t.toString(),", event: ").concat(this.traceEvent(r),")"))}}traceEvent(e){if(!e)return"<none>";switch(e.reason){case bt.Bt.EDIT:return"edit";case bt.Bt.NAVIGATION:return"navigation";case bt.Bt.JUMP:return"jump";case bt.Bt.PROGRAMMATIC:return"programmatic";case bt.Bt.USER:return"user"}}registerGroupListeners(e){if(!this.mapGroupToDisposable.has(e)){let t=this.editorGroupService.getGroup(e);t&&this.mapGroupToDisposable.set(e,t.onWillMoveEditor(e=>this.onWillMoveEditor(e)))}}onWillMoveEditor(e){if(this.trace("onWillMoveEditor()",e.editor),this.scope!==gt.o.EDITOR_GROUP)for(let t of this.stack)t.groupId===e.groupId&&this.editorHelper.matchesEditor(e.editor,t.editor)&&(t.groupId=e.target)}notifyNavigation(e,t){this.trace("notifyNavigation()",null===e||void 0===e?void 0:e.input,t);let i=(0,bt.cn)(e),o=(null===e||void 0===e?void 0:e.input)&&!e.input.isDisposed();this.navigating?(this.trace("notifyNavigation() ignoring (navigating)",null===e||void 0===e?void 0:e.input,t),i&&o?(this.trace("notifyNavigation() updating current selection state",null===e||void 0===e?void 0:e.input,t),this.currentSelectionState=new qa({groupId:e.group.id,editor:e.input},e.getSelection(),null===t||void 0===t?void 0:t.reason)):(this.trace("notifyNavigation() dropping current selection state",null===e||void 0===e?void 0:e.input,t),this.currentSelectionState=void 0)):(this.trace("notifyNavigation() not ignoring",null===e||void 0===e?void 0:e.input,t),i&&o?this.onSelectionAwareEditorNavigation(e.group.id,e.input,e.getSelection(),t):(this.currentSelectionState=void 0,o&&this.onNonSelectionAwareEditorNavigation(e.group.id,e.input)))}onSelectionAwareEditorNavigation(e,t,i,o){var s;if((null===(s=this.current)||void 0===s?void 0:s.groupId)===e&&!i&&this.editorHelper.matchesEditor(this.current.editor,t))return;this.trace("onSelectionAwareEditorNavigation()",t,o);let r=new qa({groupId:e,editor:t},i,null===o||void 0===o?void 0:o.reason);!this.currentSelectionState||this.currentSelectionState.justifiesNewNavigationEntry(r)?this.doAdd(e,t,r.selection):this.doReplace(e,t,r.selection),this.currentSelectionState=r}onNonSelectionAwareEditorNavigation(e,t){var i;(null===(i=this.current)||void 0===i?void 0:i.groupId)===e&&this.editorHelper.matchesEditor(this.current.editor,t)||(this.trace("onNonSelectionAwareEditorNavigation()",t),this.doAdd(e,t))}doAdd(e,t,i){this.navigating||this.addOrReplace(e,t,i)}doReplace(e,t,i){this.navigating||this.addOrReplace(e,t,i,!0)}addOrReplace(e,t,i,o){this.registerGroupListeners(e);let s=!1;this.current&&(o||this.shouldReplaceStackEntry(this.current,{groupId:e,editor:t,selection:i}))&&(s=!0);let r=this.editorHelper.preferResourceEditorInput(t);if(!r)return;s?this.trace("replace()",r):this.trace("add()",r);let n={groupId:e,editor:r,selection:i},a=[];if(s)this.current&&a.push(this.current),this.current=n;else{if(this.stack.length>this.index+1){for(let e=this.index+1;e<this.stack.length;e++)a.push(this.stack[e]);this.stack=this.stack.slice(0,this.index+1)}this.stack.splice(this.index+1,0,n),this.stack.length>ja.MAX_STACK_SIZE?(a.push(this.stack.shift()),this.previousIndex>=0&&this.previousIndex--):this.setIndex(this.index+1,!0)}for(let d of a)this.editorHelper.clearOnEditorDispose(d.editor,this.mapEditorToDisposable);(0,bt.rn)(r)&&this.editorHelper.onEditorDispose(r,()=>this.remove(r),this.mapEditorToDisposable),this._onDidChange.fire()}shouldReplaceStackEntry(e,t){return!(e.groupId!==t.groupId||!this.editorHelper.matchesEditor(e.editor,t.editor))&&(!e.selection||!!t.selection&&e.selection.compare(t.selection)===bt.Vt.IDENTICAL)}move(e){if(e.isOperation(at.Es.MOVE))for(let t of this.stack)this.editorHelper.matchesEditor(e,t.editor)&&(t.editor={resource:e.target.resource})}remove(e){var t;let i=this.stack.length;this.stack=this.stack.filter(t=>{let i="number"==typeof e?t.groupId===e:this.editorHelper.matchesEditor(e,t.editor);return i&&this.editorHelper.clearOnEditorDispose(t.editor,this.mapEditorToDisposable),!i}),i!==this.stack.length&&(this.flatten(),this.index=this.stack.length-1,this.previousIndex=-1,"number"==typeof e&&(null!==(t=this.mapGroupToDisposable.get(e))&&void 0!==t&&t.dispose(),this.mapGroupToDisposable.delete(e)),this._onDidChange.fire())}flatten(){let e,t=[];for(let i of this.stack)e&&this.shouldReplaceStackEntry(i,e)||(e=i,t.push(i));this.stack=t}clear(){this.index=-1,this.previousIndex=-1,this.stack.splice(0);for(let[,e]of this.mapEditorToDisposable)(0,at.Sj)(e);this.mapEditorToDisposable.clear();for(let[,e]of this.mapGroupToDisposable)(0,at.Sj)(e);this.mapGroupToDisposable.clear()}dispose(){super.dispose(),this.clear()}canGoForward(){return this.stack.length>this.index+1}async goForward(){if(!await this.maybeGoCurrent()&&this.canGoForward())return this.setIndex(this.index+1),this.navigate()}canGoBack(){return this.index>0}async goBack(){if(!await this.maybeGoCurrent()&&this.canGoBack())return this.setIndex(this.index-1),this.navigate()}async goPrevious(){if(!await this.maybeGoCurrent())return-1===this.previousIndex?this.goBack():(this.setIndex(this.previousIndex),this.navigate())}canGoLast(){return this.stack.length>0}async goLast(){if(this.canGoLast())return this.setIndex(this.stack.length-1),this.navigate()}async maybeGoCurrent(){return this.filter!==gt.a.NONE&&!this.isCurrentSelectionActive()&&(await this.navigate(),!0)}isCurrentSelectionActive(){var e;if(null===(e=this.current)||void 0===e||!e.selection)return!1;let t=this.editorService.activeEditorPane;if(!(0,bt.cn)(t)||t.group.id!==this.current.groupId||!t.input||!this.editorHelper.matchesEditor(t.input,this.current.editor))return!1;let i=t.getSelection();return!!i&&i.compare(this.current.selection)===bt.Vt.IDENTICAL}setIndex(e,t){this.previousIndex=this.index,this.index=e,t||this._onDidChange.fire()}async navigate(){this.navigating=!0;try{this.current&&await this.doNavigate(this.current)}finally{this.navigating=!1}}doNavigate(e){let t=Object.create(null);return e.selection&&(t=e.selection.restore(t)),(0,bt.rn)(e.editor)?this.editorService.openEditor(e.editor,t,e.groupId):this.editorService.openEditor((0,rt.A)((0,rt.A)({},e.editor),{},{options:(0,rt.A)((0,rt.A)({},e.editor.options),t)}),e.groupId)}isNavigating(){return this.navigating}},{_:ja=oe},{_:oe.MAX_STACK_SIZE=50},oe);td=ja=(0,at.Jb)([(0,at.Yb)(2,at.rx),(0,at.Yb)(3,bt.kt),(0,at.Yb)(4,bt.W),(0,at.Yb)(5,at.mb)],td);var id=class{constructor(e,t,i,o){this.uriIdentityService=e,this.lifecycleService=t,this.fileService=i,this.pathService=o}preferResourceEditorInput(e){let t=bt.Ht.getOriginalUri(e);if((null===t||void 0===t?void 0:t.scheme)===at.TT.file||(null===t||void 0===t?void 0:t.scheme)===at.TT.vscodeRemote||(null===t||void 0===t?void 0:t.scheme)===at.TT.vscodeUserData||(null===t||void 0===t?void 0:t.scheme)===this.pathService.defaultUriScheme){if((0,bt.rn)(e)){let t=e.toUntyped();if((0,bt.un)(t))return t}return e}return(0,bt.rn)(e)?e:void 0}matchesEditor(e,t){return e instanceof at.ws||e instanceof at.Os?!(0,bt.rn)(t)&&(e instanceof at.ws?e.contains(t.resource,at.Cs.DELETED):this.matchesFile(t.resource,e)):(0,bt.rn)(e)?(0,bt.rn)(t)?e.matches(t):this.matchesFile(t.resource,e):(0,bt.rn)(t)?this.matchesFile(e.resource,t):e&&t&&this.uriIdentityService.extUri.isEqual(e.resource,t.resource)}matchesFile(e,t){if(t instanceof at.ws)return t.contains(e,at.Cs.DELETED);if(t instanceof at.Os)return this.uriIdentityService.extUri.isEqualOrParent(e,t.resource);if((0,bt.rn)(t)){let i=t.resource;return!(!i||this.lifecycleService.phase>=bt.M.Restored&&!this.fileService.hasProvider(i))&&this.uriIdentityService.extUri.isEqual(i,e)}return this.uriIdentityService.extUri.isEqual(null===t||void 0===t?void 0:t.resource,e)}matchesEditorIdentifier(e,t){return!(null===t||void 0===t||!t.group||e.groupId!==t.group.id)&&(!!t.input&&e.editor.matches(t.input))}onEditorDispose(e,t,i){let o=at.tj.once(e.onWillDispose)(()=>t()),s=i.get(e);s||(s=new at.gj,i.set(e,s)),s.add(o)}clearOnEditorDispose(e,t){if(!(0,bt.rn)(e))return;let i=t.get(e);i&&((0,at.Sj)(i),t.delete(e))}};id=(0,at.Jb)([(0,at.Yb)(0,at.Wo),(0,at.Yb)(1,bt.R),(0,at.Yb)(2,at.fs),(0,at.Yb)(3,bt.A)],id);(0,at.AN)(),(0,at.TM)(),(0,at.Pk)(),(0,dt.a)();var od,sd=new at.Nk("activeCustomEditorId","",{type:"string",description:(0,at.EM)(5948,"The viewType of the currently active custom editor.")}),rd=new at.Nk("focusedCustomEditorIsEditable",!1);!function(e){e.default="default",e.builtin="builtin",e.option="option"}(od||(od={}));var nd=class{constructor(e){this.id=e.id,this.displayName=e.displayName,this.providerDisplayName=e.providerDisplayName,this.priority=e.priority,this.selector=e.selector}matches(e){return this.selector.some(t=>t.filenamePattern&&(0,dt.i)(t.filenamePattern,e))}},ad=class{constructor(e){this.allEditors=(0,at.wN)(e,e=>e.id)}get length(){return this.allEditors.length}get defaultEditor(){return this.allEditors.find(e=>{switch(e.priority){case dt.t.default:case dt.t.builtin:return this.allEditors.every(t=>t===e||function(e,t){return(0,dt.o)(e.priority)<(0,dt.o)(t.priority)}(t,e));default:return!1}})}get bestAvailableEditor(){return Array.from(this.allEditors).sort((e,t)=>(0,dt.o)(e.priority)-(0,dt.o)(t.priority))[0]}};(0,at.Gj)();var dd=class{constructor(){this._references=new Map}async getAllModels(e){let t="".concat(e.toString(),"@@@"),i=[];for(let[o,s]of this._references)o.startsWith(t)&&s.model&&i.push(await s.model);return i}async get(e,t){var i;let o=this.key(e,t);return null===(i=this._references.get(o))||void 0===i?void 0:i.model}tryRetain(e,t){let i=this.key(e,t),o=this._references.get(i);if(o)return o.counter++,o.model.then(e=>({object:e,dispose:(0,at.Wj)(()=>{--o.counter<=0&&(o.model.then(e=>e.dispose()),this._references.delete(i))})}))}add(e,t,i){let o=this.key(e,t);if(this._references.get(o))throw Error("Model already exists");return this._references.set(o,{viewType:t,model:i,counter:0}),this.tryRetain(e,t)}disposeAllModelsForView(e){for(let[t,i]of this._references)i.viewType===e&&(i.model.then(e=>e.dispose()),this._references.delete(t))}key(e,t){return"".concat(e.toString(),"@@@").concat(t)}};(0,at.AN)(),(0,at.wj)(),(0,at.TM)(),(0,at.Zp)(),(0,at.Mb)(),(0,pt.vt)(),(0,pt.Tt)(),(0,wt.n)();var ld=Object.freeze({viewType:"viewType",displayName:"displayName",selector:"selector",priority:"priority"}),cd={description:(0,at.EM)(5950,"Contributed custom editors."),type:"array",defaultSnippets:[{body:[{[ld.viewType]:"$1",[ld.displayName]:"$2",[ld.selector]:[{filenamePattern:"$3"}]}]}],items:{type:"object",required:[ld.viewType,ld.displayName,ld.selector],properties:{[ld.viewType]:{type:"string",markdownDescription:(0,at.EM)(5951,"Identifier for the custom editor. This must be unique across all custom editors, so we recommend including your extension id as part of `viewType`. The `viewType` is used when registering custom editors with `vscode.registerCustomEditorProvider` and in the `onCustomEditor:${id}` [activation event](https://code.visualstudio.com/api/references/activation-events).")},[ld.displayName]:{type:"string",description:(0,at.EM)(5952,"Human readable name of the custom editor. This is displayed to users when selecting which editor to use.")},[ld.selector]:{type:"array",description:(0,at.EM)(5953,"Set of globs that the custom editor is enabled for."),items:{type:"object",defaultSnippets:[{body:{filenamePattern:"$1"}}],properties:{filenamePattern:{type:"string",description:(0,at.EM)(5954,"Glob that the custom editor is enabled for.")}}}},[ld.priority]:{type:"string",markdownDeprecationMessage:(0,at.EM)(5955,"Controls if the custom editor is enabled automatically when the user opens a file. This may be overridden by users using the `workbench.editorAssociations` setting."),enum:[od.default,od.option],markdownEnumDescriptions:[(0,at.EM)(5956,"The editor is automatically used when the user opens a resource, provided that no other default custom editors are registered for that resource."),(0,at.EM)(5957,"The editor is not automatically used when the user opens a resource, but a user can switch to the editor using the `Reopen With` command.")],default:"default"}}}},hd=pt.wt.registerExtensionPoint({extensionPoint:"customEditors",deps:[wt.r],jsonSchema:cd,activationEventsGenerator:(e,t)=>{for(let i of e){let e=i[ld.viewType];e&&t.push("onCustomEditor:".concat(e))}}}),ud=class extends at.mj{constructor(){super(...arguments),this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.customEditors)}render(e){var t;let i=(null===(t=e.contributes)||void 0===t?void 0:t.customEditors)||[];return i.length?{data:{headers:[(0,at.EM)(5958,"View Type"),(0,at.EM)(5959,"Priority"),(0,at.EM)(5960,"Filename Pattern")],rows:i.map(e=>{var t;return[e.viewType,null!==(t=e.priority)&&void 0!==t?t:"",(0,at._N)(e.selector.map(e=>e.filenamePattern)).join(", ")]})},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}};at.jb.as(pt._t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"customEditors",label:(0,at.EM)(5961,"Custom Editors"),access:{canToggle:!1},renderer:new at.Xp(ud)}),(0,at.sj)(),(0,at.wj)(),(0,at.TM)(),(0,at.Vo)(),(0,dt.C)(),(0,dt.a)();var gd=(se=class e extends at.mj{constructor(t){super(),this._editors=new Map,this._onChange=this._register(new at.ej),this.onChange=this._onChange.event,this._memento=new dt.S(e.CUSTOM_EDITORS_STORAGE_ID,t);let i=this._memento.getMemento(at.Ro.PROFILE,at.zo.MACHINE);for(let o of i[e.CUSTOM_EDITORS_ENTRY_ID]||[])this.add(new nd(o));this._register(hd.setHandler(e=>{this.update(e)}))}update(t){this._editors.clear();for(let e of t)for(let t of e.value)this.add(new nd({id:t.viewType,displayName:t.displayName,providerDisplayName:e.description.isBuiltin?(0,at.EM)(5947,"Built-in"):e.description.displayName||e.description.identifier.value,selector:t.selector||[],priority:pd(t,e.description)}));this._memento.getMemento(at.Ro.PROFILE,at.zo.MACHINE)[e.CUSTOM_EDITORS_ENTRY_ID]=Array.from(this._editors.values()),this._memento.saveMemento(),this._onChange.fire()}[Symbol.iterator](){return this._editors.values()}get(e){return this._editors.get(e)}getContributedEditors(e){return Array.from(this._editors.values()).filter(t=>t.matches(e))}add(e){this._editors.has(e.id)?console.error("Custom editor with id '".concat(e.id,"' already registered")):this._editors.set(e.id,e)}},{_:se.CUSTOM_EDITORS_STORAGE_ID="customEditors"},{_:se.CUSTOM_EDITORS_ENTRY_ID="editors"},se);function pd(e,t){switch(e.priority){case dt.t.default:case dt.t.option:return e.priority;case dt.t.builtin:return t.isBuiltin?dt.t.builtin:dt.t.default;default:return dt.t.default}}(0,at.vE)(),(0,at.Xb)(),(0,at.AN)(),(0,at.sj)(),(0,at.wj)(),(0,at.ET)(),(0,at.dT)(),(0,at.GM)(),(0,at.SO)(),(0,at.ob)(),(0,at.Qs)(),(0,at.ps)(),(0,at.ox)(),(0,at.Mb)(),(0,at.Lo)(),(0,at.Go)(),(0,bt.en)(),(0,bt.it)(),(0,bt.G)(),(0,dt.a)(),(0,dt.V)(),(0,bt.At)(),(0,ut.Gi)(),(0,at.bE)({});var bd=class extends at.mj{constructor(e,t,i,o,s,r,n){super(),this.editorService=i,this.editorGroupService=o,this.instantiationService=s,this.uriIdentityService=r,this.editorResolverService=n,this._untitledCounter=0,this._editorResolverDisposables=this._register(new at.gj),this._editorCapabilities=new Map,this._onDidChangeEditorTypes=this._register(new at.ej),this.onDidChangeEditorTypes=this._onDidChangeEditorTypes.event,this._fileEditorFactory=at.jb.as(bt.Rt.EditorFactory).getFileEditorFactory(),this._models=new dd,this._contributedEditors=this._register(new gd(t)),this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this._register(this._contributedEditors.onChange(()=>{this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this._onDidChangeEditorTypes.fire()}));let a={contextKey:sd,getGroupContextKeyValue:e=>this.getActiveCustomEditorId(e),onDidChange:this.onDidChangeEditorTypes},d={contextKey:rd,getGroupContextKeyValue:e=>this.getCustomEditorIsEditable(e),onDidChange:this.onDidChangeEditorTypes};this._register(this.editorGroupService.registerContextKeyProvider(a)),this._register(this.editorGroupService.registerContextKeyProvider(d)),this._register(e.onDidRunOperation(e=>{e.isOperation(at.Es.MOVE)&&this.handleMovedFileInOpenedFileEditors(e.resource,this.uriIdentityService.asCanonicalUri(e.target.resource))})),this._register(at.ab.addImplementation(105,"custom-editor",()=>this.withActiveCustomEditor(e=>e.undo()))),this._register(at.rb.addImplementation(105,"custom-editor",()=>this.withActiveCustomEditor(e=>e.redo())))}getEditorTypes(){return[...this._contributedEditors]}withActiveCustomEditor(e){let t=this.editorService.activeEditor;return t instanceof ut.Wi&&(e(t)||!0)}registerContributionPoints(){this._editorResolverDisposables.clear();for(let e of this._contributedEditors)for(let t of e.selector)t.filenamePattern&&this._editorResolverDisposables.add(this.editorResolverService.registerEditor(t.filenamePattern,{id:e.id,label:e.displayName,detail:e.providerDisplayName,priority:e.priority},{singlePerResource:()=>{var t,i;return!(null!==(t=null===(i=this.getCustomEditorCapabilities(e.id))||void 0===i?void 0:i.supportsMultipleEditorsPerDocument)&&void 0!==t&&t)}},{createEditorInput:(t,i)=>{let{resource:o}=t;return{editor:ut.Wi.create(this.instantiationService,o,e.id,i.id)}},createUntitledEditorInput:(t,i)=>{let{resource:o}=t;return{editor:ut.Wi.create(this.instantiationService,null!==o&&void 0!==o?o:at.xO.from({scheme:at.TT.untitled,authority:"Untitled-".concat(this._untitledCounter++)}),e.id,i.id)}},createDiffEditorInput:(t,i)=>({editor:this.createDiffEditorInput(t,e.id,i)})}))}createDiffEditorInput(e,t,i){let o=ut.Wi.create(this.instantiationService,(0,at.UM)(e.modified.resource),t,i.id,{customClasses:"modified"}),s=ut.Wi.create(this.instantiationService,(0,at.UM)(e.original.resource),t,i.id,{customClasses:"original"});return this.instantiationService.createInstance(bt.nt,e.label,e.description,s,o,!0)}get models(){return this._models}getCustomEditor(e){return this._contributedEditors.get(e)}getContributedCustomEditors(e){return new ad(this._contributedEditors.getContributedEditors(e))}getUserConfiguredCustomEditors(e){return new ad((0,at._N)(this.editorResolverService.getAssociationsForResource(e).map(e=>this._contributedEditors.get(e.viewType))))}getAllCustomEditors(e){return new ad([...this.getUserConfiguredCustomEditors(e).allEditors,...this.getContributedCustomEditors(e).allEditors])}registerCustomEditorCapabilities(e,t){if(this._editorCapabilities.has(e))throw Error("Capabilities for ".concat(e," already set"));return this._editorCapabilities.set(e,t),(0,at.kj)(()=>{this._editorCapabilities.delete(e)})}getCustomEditorCapabilities(e){return this._editorCapabilities.get(e)}getActiveCustomEditorId(e){var t;let i=e.activeEditorPane;return null!==i&&void 0!==i&&null!==(t=i.input)&&void 0!==t&&t.resource&&(null===i||void 0===i?void 0:i.input)instanceof ut.Wi?i.input.viewType:""}getCustomEditorIsEditable(e){var t;let i=e.activeEditorPane;return!(null===i||void 0===i||null===(t=i.input)||void 0===t||!t.resource)&&(null===i||void 0===i?void 0:i.input)instanceof ut.Wi}async handleMovedFileInOpenedFileEditors(e,t){if((0,at.uT)(e).toLowerCase()===(0,at.uT)(t).toLowerCase())return;let i=this.getAllCustomEditors(t);if(!i.allEditors.some(e=>e.priority!==dt.t.option))return;let o=new Map;for(let s of this.editorGroupService.groups)for(let e of s.editors)if(this._fileEditorFactory.isFileEditor(e)&&!(e instanceof ut.Wi)&&(0,at.pT)(e.resource,t)){let t=o.get(s.id);t||(t=[],o.set(s.id,t)),t.push(e)}if(o.size)for(let[s,r]of o)this.editorService.replaceEditors(r.map(e=>{let o;if(i.defaultEditor){let e=i.defaultEditor.id;o=ut.Wi.create(this.instantiationService,t,e,s)}else o={resource:t,options:{override:bt.Ft.id}};return{editor:e,replacement:o,options:{preserveFocus:!0}}}),s)}};bd=(0,at.Jb)([(0,at.Yb)(0,at.fs),(0,at.Yb)(1,at.Io),(0,at.Yb)(2,bt.kt),(0,at.Yb)(3,bt.W),(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.Wo),(0,at.Yb)(6,dt.B)],bd),(0,at.Xb)(),(0,dt.Bi)(),(0,at.sj)(),(0,at.wj)(),(0,at.wk)(),(0,at.i_)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.mm)(),(0,yt.n)();var md,vd=class extends at.mj{constructor(e,t){super(),this._themeService=e,this._configurationService=t,this._cachedWebViewThemeData=void 0,this._onThemeDataChanged=this._register(new at.ej),this.onThemeDataChanged=this._onThemeDataChanged.event,this._register(this._themeService.onDidColorThemeChange(()=>{this._reset()}));let i=["editor.fontFamily","editor.fontWeight","editor.fontSize","editor.fontLigatures","accessibility.underlineLinks"];this._register(this._configurationService.onDidChangeConfiguration(e=>{i.some(t=>e.affectsConfiguration(t))&&this._reset()}))}getTheme(){return this._themeService.getColorTheme()}getWebviewThemeData(){if(!this._cachedWebViewThemeData){let e=this._configurationService.getValue("editor"),t=e.fontFamily||at.nk.fontFamily,i=e.fontWeight||at.nk.fontWeight,o=e.fontSize||at.nk.fontSize,s=(new at.ik).validate(e.fontLigatures),r=this._configurationService.getValue("accessibility.underlineLinks"),n=this._themeService.getColorTheme(),a=(0,at.Ag)().getColors().reduce((e,t)=>{let i=n.getColor(t.id);return i&&(e["vscode-"+t.id.replace(".","-")]=i.toString()),e},{});this._cachedWebViewThemeData={styles:(0,rt.A)((0,rt.A)({"vscode-font-family":dt.Ri,"vscode-font-weight":"normal","vscode-font-size":"13px","vscode-editor-font-family":t,"vscode-editor-font-weight":i,"vscode-editor-font-size":o+"px","text-link-decoration":r?"underline":"none"},a),{},{"vscode-editor-font-feature-settings":s}),activeTheme:md.fromTheme(n),themeLabel:n.label,themeId:n.settingsId}}return this._cachedWebViewThemeData}_reset(){this._cachedWebViewThemeData=void 0,this._onThemeDataChanged.fire()}};vd=(0,at.Jb)([(0,at.Yb)(0,yt.t),(0,at.Yb)(1,at.r_)],vd),function(e){e.light="vscode-light",e.dark="vscode-dark",e.highContrast="vscode-high-contrast",e.highContrastLight="vscode-high-contrast-light"}(md||(md={})),function(e){e.fromTheme=function(t){switch(t.type){case at.fm.LIGHT:return e.light;case at.fm.DARK:return e.dark;case at.fm.HIGH_CONTRAST_DARK:return e.highContrast;case at.fm.HIGH_CONTRAST_LIGHT:return e.highContrastLight}}}(md||(md={})),(0,at.ET)(),(0,at.SO)(),(0,ut.n_)();var Cd=class{constructor(e,t,i){this._getExtensionLocation=e,this._getMappings=t,this.tunnelService=i,this._tunnels=new Map}async getRedirect(e,t){let i=at.xO.parse(t),o=(0,ut.t_)(i);if(o)for(let s of this._getMappings())if(s.webviewPort===o.port){let t=this._getExtensionLocation();if(t&&t.scheme===at.TT.vscodeRemote){let t=e&&await this.getOrCreateTunnel(e,s.extensionHostPort);if(t)return t.tunnelLocalPort===s.webviewPort?void 0:encodeURI(i.with({authority:"127.0.0.1:".concat(t.tunnelLocalPort)}).toString(!0))}if(s.webviewPort!==s.extensionHostPort)return encodeURI(i.with({authority:"".concat(o.address,":").concat(s.extensionHostPort)}).toString(!0))}}async dispose(){for(let e of this._tunnels.values())await e.dispose();this._tunnels.clear()}async getOrCreateTunnel(e,t){let i,o=this._tunnels.get(t);return o||("string"==typeof await this.tunnelService.openTunnel({getAddress:async()=>e},void 0,t)&&(i=void 0),i&&this._tunnels.set(t,i),i)}};(0,at.X_)(),(0,at.DO)();var wd,yd=new Map([[".svg","image/svg+xml"],[".txt",at.J_.text],[".css","text/css"],[".js","application/javascript"],[".cjs","application/javascript"],[".mjs","application/javascript"],[".json","application/json"],[".html","text/html"],[".htm","text/html"],[".xhtml","application/xhtml+xml"],[".oft","font/otf"],[".xml","application/xml"],[".wasm","application/wasm"]]);async function fd(e,t,i,o,s){let r=function(e,t){for(let i of t)if(Sd(i,e))return Ed(e)}(e,t.roots);if(o.trace("Webview.loadLocalResource - trying to load resource. requestUri=".concat(e,", resourceToLoad=").concat(r)),!r)return o.trace("Webview.loadLocalResource - access denied. requestUri=".concat(e,", resourceToLoad=").concat(r)),wd.AccessDenied;let n=function(e){let t=(0,at.EO)(e.fsPath).toLowerCase();return yd.get(t)||(0,at.Y_)(e.fsPath)||at.J_.unknown}(e);try{let a=await i.readFileStream(r,{etag:t.ifNoneMatch},s);return o.trace("Webview.loadLocalResource - Loaded. requestUri=".concat(e,", resourceToLoad=").concat(r)),new wd.StreamSuccess(a.value,a.etag,a.mtime,n)}catch(t){var a;return t instanceof at.Ds&&t.fileOperationResult===at.ks.FILE_NOT_MODIFIED_SINCE?(o.trace("Webview.loadLocalResource - not modified. requestUri=".concat(e,", resourceToLoad=").concat(r)),new wd.NotModified(n,null===(a=t.options)||void 0===a?void 0:a.mtime)):(o.error("Webview.loadLocalResource - Error using fileReader. requestUri=".concat(e,", resourceToLoad=").concat(r)),wd.Failed)}}function Sd(e,t){if(e.scheme!==t.scheme)return!1;let i=(0,at.AO)(t.fsPath),o=(0,at.AO)(e.fsPath+(e.fsPath.endsWith(at.PO)?"":at.PO));return(0,at.IT)(e.fsPath)&&(0,at.IT)(t.fsPath)&&(o=o.toLowerCase(),i=i.toLowerCase()),i.startsWith(o)}function Ed(e){return e.scheme===at.TT.vscodeRemote?at.xO.from({scheme:at.TT.vscodeRemote,authority:e.authority,path:"/vscode-resource",query:JSON.stringify({requestResourcePath:e.path})}):e}(0,at.NT)(),(0,at.ET)(),(0,at.DO)(),(0,at.SO)(),(0,at.Qs)(),function(e){let t;!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed",e[e.AccessDenied=2]="AccessDenied",e[e.NotModified=3]="NotModified"}(t=e.Type||(e.Type={}));e.StreamSuccess=class{constructor(e,i,o,s){this.stream=e,this.etag=i,this.mtime=o,this.mimeType=s,this.type=t.Success}},e.Failed={type:t.Failed},e.AccessDenied={type:t.AccessDenied};e.NotModified=class{constructor(e,i){this.mimeType=e,this.mtime=i,this.type=t.NotModified}}}(wd||(wd={})),(0,at.vE)(),(0,at.TM)(),(0,at.oS)(),(0,at.Up)(),(0,at.Ww)(),(0,at.QO)(),(0,gt.sn)(),(0,gt.an)(),(0,ut.Nh)(),(0,at.G)(),(0,at.sp)(),(0,at.rA)(),(0,ut.Tf)(),(0,at.e_)(),(0,at.Ii)(),(0,at.tn)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.bE)({});var kd=(0,at.EM)(5687,"Find"),_d=(0,at.EM)(5688,"Find"),Id=(0,at.EM)(5689,"Previous Match"),xd=(0,at.EM)(5690,"Next Match"),Ad=(0,at.EM)(5691,"Close"),Vd=310,Dd=class extends at.Hp{constructor(e,t,i,o,s){var r;super(),this._keybindingService=s,this._isVisible=!1,this._foundMatch=!1,this._width=0,this.state=this._register(new gt.on),this._matchesLimit=null!==(r=e.matchesLimit)&&void 0!==r?r:2**53-1,this._findInput=this._register(new ut.Ah(null,t,{label:kd,placeholder:_d,validation:e=>{if(0===e.length||!this._findInput.getRegex())return null;try{return new RegExp(e),null}catch(e){return this._foundMatch=!1,this.updateButtons(this._foundMatch),{content:e.message}}},showCommonFindToggles:e.showCommonFindToggles,appendCaseSensitiveLabel:e.appendCaseSensitiveActionId?this._getKeybinding(e.appendCaseSensitiveActionId):void 0,appendRegexLabel:e.appendRegexActionId?this._getKeybinding(e.appendRegexActionId):void 0,appendWholeWordsLabel:e.appendWholeWordsActionId?this._getKeybinding(e.appendWholeWordsActionId):void 0,showHistoryHint:()=>(0,ut.Ef)(s),inputBoxStyles:at.ki,toggleStyles:at.Pi},i)),this._updateHistoryDelayer=this._register(new at.Sw(500)),this._register(this._findInput.onInput(async t=>{(!e.checkImeCompletionState||!this._findInput.isImeSessionInProgress)&&(this._foundMatch=this._onInputChanged(),e.showResultCount&&await this.updateResultCount(),this.updateButtons(this._foundMatch),this.focusFindBox(),this._delayedUpdateHistory())})),this._findInput.setRegex(!!this.state.isRegex),this._findInput.setCaseSensitive(!!this.state.matchCase),this._findInput.setWholeWords(!!this.state.wholeWord),this._register(this._findInput.onDidOptionChange(()=>{this.state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this.state.onFindReplaceStateChange(()=>{this._findInput.setRegex(this.state.isRegex),this._findInput.setWholeWords(this.state.wholeWord),this._findInput.setCaseSensitive(this.state.matchCase),this.findFirst()})),this.prevBtn=this._register(new gt.nn({label:Id+(e.previousMatchActionId?this._getKeybinding(e.previousMatchActionId):""),icon:gt.in,onTrigger:()=>{this.find(!0)}},o)),this.nextBtn=this._register(new gt.nn({label:xd+(e.nextMatchActionId?this._getKeybinding(e.nextMatchActionId):""),icon:gt.rn,onTrigger:()=>{this.find(!1)}},o));let n=this._register(new gt.nn({label:Ad+(e.closeWidgetActionId?this._getKeybinding(e.closeWidgetActionId):""),icon:at.Y,onTrigger:()=>{this.hide()}},o));this._innerDomNode=(0,at.jx)("div"),this._innerDomNode.classList.add("simple-find-part"),this._innerDomNode.appendChild(this._findInput.domNode),this._innerDomNode.appendChild(this.prevBtn.domNode),this._innerDomNode.appendChild(this.nextBtn.domNode),this._innerDomNode.appendChild(n.domNode),this._domNode=(0,at.jx)("div"),this._domNode.classList.add("simple-find-part-wrapper"),this._domNode.appendChild(this._innerDomNode),this.onkeyup(this._innerDomNode,e=>{if(e.equals(at.KO.Escape))return this.hide(),void e.preventDefault()}),this._focusTracker=this._register((0,at.US)(this._innerDomNode)),this._register(this._focusTracker.onDidFocus(this._onFocusTrackerFocus.bind(this))),this._register(this._focusTracker.onDidBlur(this._onFocusTrackerBlur.bind(this))),this._findInputFocusTracker=this._register((0,at.US)(this._findInput.domNode)),this._register(this._findInputFocusTracker.onDidFocus(this._onFindInputFocusTrackerFocus.bind(this))),this._register(this._findInputFocusTracker.onDidBlur(this._onFindInputFocusTrackerBlur.bind(this))),this._register((0,at.Sx)(this._innerDomNode,"click",e=>{e.stopPropagation()})),(null===e||void 0===e?void 0:e.showResultCount)&&(this._domNode.classList.add("result-count"),this._matchesCount=(0,at.jx)("div"),this._matchesCount.className="matchesCount",this._findInput.domNode.insertAdjacentElement("afterend",this._matchesCount),this._register(this._findInput.onDidChange(async()=>{await this.updateResultCount()})),this._register(this._findInput.onDidOptionChange(async()=>{this._foundMatch=this._onInputChanged(),await this.updateResultCount(),this.focusFindBox(),this._delayedUpdateHistory()})));let a=null===e||void 0===e?void 0:e.initialWidth;if(a&&(a=a<Vd?Vd:a,this._domNode.style.width="".concat(a,"px")),null!==e&&void 0!==e&&e.enableSash){let e=null!==a&&void 0!==a?a:Vd,t=e,i=this._register(new at.$t(this._innerDomNode,this,{orientation:at.Zt.VERTICAL,size:1}));this._register(i.onDidStart(()=>{t=parseFloat((0,at.Hx)(this._domNode).width)})),this._register(i.onDidChange(i=>{let o=t+i.startX-i.currentX;o<e||(this._domNode.style.width="".concat(o,"px"))})),this._register(i.onDidReset(t=>{parseFloat((0,at.Hx)(this._domNode).width)===e?this._domNode.style.width="100%":this._domNode.style.width="".concat(e,"px")}))}}getVerticalSashLeft(e){return 0}get inputValue(){return this._findInput.getValue()}get focusTracker(){return this._focusTracker}_getKeybinding(e){var t;let i=null===(t=this._keybindingService)||void 0===t?void 0:t.lookupKeybinding(e);return i?" (".concat(i.getLabel(),")"):""}dispose(){var e;super.dispose(),null===(e=this._domNode)||void 0===e||e.remove()}isVisible(){return this._isVisible}getDomNode(){return this._domNode}getFindInputDomNode(){return this._findInput.domNode}reveal(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this._findInput.setValue(e),this._isVisible?this._findInput.select():(this._isVisible=!0,this.updateResultCount(),this.layout(),setTimeout(()=>{this._innerDomNode.classList.toggle("suppress-transition",!t),this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false"),this._findInput.select(),t||setTimeout(()=>{this._innerDomNode.classList.remove("suppress-transition")},0)},0))}show(e){e&&!this._isVisible&&this._findInput.setValue(e),this._isVisible=!0,this.layout(),setTimeout(()=>{this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false")},0)}hide(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isVisible&&(this._innerDomNode.classList.toggle("suppress-transition",!e),this._innerDomNode.classList.remove("visible-transition"),this._innerDomNode.setAttribute("aria-hidden","true"),setTimeout(()=>{this._isVisible=!1,this.updateButtons(this._foundMatch),this._innerDomNode.classList.remove("visible","suppress-transition")},e?200:0))}layout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._width;if(this._width=e,this._isVisible&&this._matchesCount){let t=!1;411>=e&&(t=!0),this._innerDomNode.classList.toggle("reduced-find-widget",t)}}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this))}_updateHistory(){this._findInput.inputBox.addToHistory()}_getRegexValue(){return this._findInput.getRegex()}_getWholeWordValue(){return this._findInput.getWholeWords()}_getCaseSensitiveValue(){return this._findInput.getCaseSensitive()}updateButtons(e){let t=this.inputValue.length>0;this.prevBtn.setEnabled(this._isVisible&&t&&e),this.nextBtn.setEnabled(this._isVisible&&t&&e)}focusFindBox(){this.nextBtn.focus(),this._findInput.inputBox.focus()}async updateResultCount(){if(!this._matchesCount)return void this.updateButtons(this._foundMatch);let e=await this._getResultCount();this._matchesCount.textContent="";let t=this.inputValue.length>0&&0===(null===e||void 0===e?void 0:e.resultCount);this._matchesCount.classList.toggle("no-results",t);let i="";if(null!==e&&void 0!==e&&e.resultCount){let t=String(e.resultCount);e.resultCount>=this._matchesLimit&&(t+="+");let o=String(e.resultIndex+1);"0"===o&&(o="?"),i=(0,at.Xk)(gt.en,o,t)}else i=gt.tn;(0,at.n_)(this._announceSearchResults(i,this.inputValue)),this._matchesCount.appendChild(document.createTextNode(i)),this._foundMatch=!!e&&e.resultCount>0,this.updateButtons(this._foundMatch)}changeState(e){this.state.change(e,!1)}_announceSearchResults(e,t){return t?e===gt.tn?""===t?(0,at.EM)(5693,"{0} found",e):(0,at.EM)(5694,"{0} found for '{1}'",e,t):(0,at.EM)(5695,"{0} found for '{1}'",e,t):(0,at.EM)(5692,"Enter search input")}},Md=(0,at.Fg)("simpleFindWidget.sashBorder",{dark:"#454545",light:"#C8C8C8",hcDark:"#6FC3DF",hcLight:"#0F4A85"},(0,at.EM)(5696,"Border color of the sash border."));(0,at.cp)((e,t)=>{let i=e.getColor(Md);t.addRule(".monaco-workbench .simple-find-part .monaco-sash { background-color: ".concat(i,"; border-color: ").concat(i," }"))}),(0,at.Xb)(),(0,at.Pb)(),(0,at.Ol)(),(0,at.rr)(),(0,at.Dd)(),(0,ut.ct)();var Td,Rd=class extends Dd{async _getResultCount(e){}constructor(e,t,i,o,s){super({showCommonFindToggles:!1,checkImeCompletionState:e.checkImeCompletionState,enableSash:!0},t,i,o,s),this._delegate=e,this._findWidgetFocused=ut.it.bindTo(i),this._register(e.hasFindResult(e=>{this.updateButtons(e),this.focusFindBox()})),this._register(e.onDidStopFind(()=>{this.updateButtons(!1)}))}find(e){let t=this.inputValue;t&&this._delegate.find(t,e)}hide(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super.hide(e),this._delegate.stopFind(!0),this._delegate.focus()}_onInputChanged(){let e=this.inputValue;return e?this._delegate.updateFind(e):this._delegate.stopFind(!1),!1}_onFocusTrackerFocus(){this._findWidgetFocused.set(!0)}_onFocusTrackerBlur(){this._findWidgetFocused.reset()}_onFindInputFocusTrackerFocus(){}_onFindInputFocusTrackerBlur(){}findFirst(){}};Rd=(0,at.Jb)([(0,at.Yb)(1,at.Dl),(0,at.Yb)(2,at.Nb),(0,at.Yb)(3,at.nr),(0,at.Yb)(4,at.Ed)],Rd),(0,at.Xb)(),(0,at.oE)(),(0,at.oS)(),(0,at.UT)(),(0,at.Ww)(),(0,at.iw)(),(0,at.LA)(),(0,at.sj)(),(0,at.wj)(),(0,at.qS)(),(0,at.ET)(),(0,at.SO)(),(0,at.dp)(),(0,at.TM)(),(0,at.Xg)(),(0,at.Tb)(),(0,at.i_)(),(0,at.Ol)(),(0,at.ps)(),(0,at.ox)(),(0,at.gb)(),(0,at.Fd)(),(0,ut.dx)(),(0,ut.Hb)(),(0,bt.k)(),(0,St.r)(),(0,ut.ct)(),(0,at.sC)(),function(e){let t;!function(e){e[e.Initializing=0]="Initializing",e[e.Ready=1]="Ready"}(t=e.Type||(e.Type={}));e.Initializing=class{constructor(e){this.pendingMessages=e,this.type=t.Initializing}},e.Ready={type:t.Ready}}(Td||(Td={}));var Od=class extends at.mj{get window(){var e;return"number"==typeof this._windowId?null===(e=(0,at.eS)(this._windowId))||void 0===e?void 0:e.window:void 0}get platform(){return"browser"}get element(){return this._element}get isFocused(){return!(!this._focused||!this.window||this.window.document.activeElement&&this.window.document.activeElement!==this.element)}constructor(e,t,i,o,s,r,n,a,d,l,c,h){var u;super(),this.webviewThemeDataProvider=t,this._environmentService=r,this._fileService=n,this._logService=a,this._remoteAuthorityResolverService=d,this._tunnelService=l,this._accessibilityService=h,this.id=(0,at.up)(),this._windowId=void 0,this._expectedServiceWorkerVersion=4,this._state=new Td.Initializing([]),this._resourceLoadingCts=this._register(new at.FA),this._focusDelayer=this._register(new at.Fw(50)),this._onDidHtmlChange=this._register(new at.ej),this.onDidHtmlChange=this._onDidHtmlChange.event,this._messageHandlers=new Map,this.checkImeCompletionState=!0,this.intrinsicContentSize=(0,at.cC)("WebviewIntrinsicContentSize",void 0),this._disposed=!1,this._onMissingCsp=this._register(new at.ej),this.onMissingCsp=this._onMissingCsp.event,this._onDidClickLink=this._register(new at.ej),this.onDidClickLink=this._onDidClickLink.event,this._onMessage=this._register(new at.ej),this.onMessage=this._onMessage.event,this._onDidScroll=this._register(new at.ej),this.onDidScroll=this._onDidScroll.event,this._onDidWheel=this._register(new at.ej),this.onDidWheel=this._onDidWheel.event,this._onDidUpdateState=this._register(new at.ej),this.onDidUpdateState=this._onDidUpdateState.event,this._onDidFocus=this._register(new at.ej),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new at.ej),this.onDidBlur=this._onDidBlur.event,this._onFatalError=this._register(new at.ej),this.onFatalError=this._onFatalError.event,this._onDidDispose=this._register(new at.ej),this.onDidDispose=this._onDidDispose.event,this._hasAlertedAboutMissingCsp=!1,this._hasFindResult=this._register(new at.ej),this.hasFindResult=this._hasFindResult.event,this._onDidStopFind=this._register(new at.ej),this.onDidStopFind=this._onDidStopFind.event,this.providedViewType=e.providedViewType,this.origin=null!==(u=e.origin)&&void 0!==u?u:this.id,this._options=e.options,this.extension=e.extension,this._content={html:"",title:e.title,options:e.contentOptions,state:void 0},this._portMappingManager=this._register(new Cd(()=>{var e;return null===(e=this.extension)||void 0===e?void 0:e.location},()=>this._content.options.portMapping||[],this._tunnelService)),this._element=this._createElement(e.options,e.contentOptions),this._register(this.on("no-csp-found",()=>{this.handleNoCspFound()})),this._register(this.on("did-click-link",e=>{let{uri:t}=e;this._onDidClickLink.fire(t)})),this._register(this.on("onmessage",e=>{let{message:t,transfer:i}=e;this._onMessage.fire({message:t,transfer:i})})),this._register(this.on("did-scroll",e=>{let{scrollYPercentage:t}=e;this._onDidScroll.fire({scrollYPercentage:t})})),this._register(this.on("do-reload",()=>{this.reload()})),this._register(this.on("do-update-state",e=>{this.state=e,this._onDidUpdateState.fire(e)})),this._register(this.on("did-focus",()=>{this.handleFocusChange(!0)})),this._register(this.on("did-blur",()=>{this.handleFocusChange(!1)})),this._register(this.on("did-scroll-wheel",e=>{this._onDidWheel.fire(e)})),this._register(this.on("did-find",e=>{let{didFind:t}=e;this._hasFindResult.fire(t)})),this._register(this.on("fatal-error",e=>{s.error((0,at.EM)(12514,"Error loading webview: {0}",e.message)),this._onFatalError.fire({message:e.message})})),this._register(this.on("did-keydown",e=>{this.handleKeyEvent("keydown",e)})),this._register(this.on("did-keyup",e=>{this.handleKeyEvent("keyup",e)})),this._register(this.on("did-context-menu",e=>{if(!this.element||!this._contextKeyService)return;let t=this.element.getBoundingClientRect(),i=this._contextKeyService.createOverlay([...Object.entries(e.context),["webviewId",this.providedViewType]]);o.showContextMenu({menuId:at.xb.WebviewContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:i,getActionsContext:()=>(0,rt.A)((0,rt.A)({},e.context),{},{webview:this.providedViewType}),getAnchor:()=>({x:t.x+e.clientX,y:t.y+e.clientY})}),this._send("set-context-menu-visible",{visible:!0})})),this._register(this.on("load-resource",async e=>{try{let t=(0,St.n)(e.authority),i=at.xO.from({scheme:e.scheme,authority:t,path:decodeURIComponent(e.path),query:e.query?decodeURIComponent(e.query):e.query});this.loadResource(e.id,i,e.ifNoneMatch)}catch(t){this._send("did-load-resource",{id:e.id,status:404,path:e.path})}})),this._register(this.on("load-localhost",e=>{this.localLocalhost(e.id,e.origin)})),this._register(at.tj.runAndSubscribe(t.onThemeDataChanged,()=>this.style())),this._register(h.onDidChangeReducedMotion(()=>this.style())),this._register(h.onDidChangeScreenReaderOptimized(()=>this.style())),this._register(o.onDidHideContextMenu(()=>this._send("set-context-menu-visible",{visible:!1}))),this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._register(i.onDidChangeConfiguration(e=>{e.affectsConfiguration("window.confirmBeforeClose")&&(this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._send("set-confirm-before-close",this._confirmBeforeClose))})),this._register(this.on("drag-start",()=>{this._startBlockingIframeDragEvents()})),this._register(this.on("drag",e=>{this.handleDragEvent("drag",e)})),this._register(this.on("updated-intrinsic-content-size",e=>{this.intrinsicContentSize.set({width:e.width,height:e.height},void 0,void 0)})),e.options.enableFindWidget&&(this._webviewFindWidget=this._register(c.createInstance(Rd,this)))}dispose(){var e;if(this._disposed=!0,null!==(e=this.element)&&void 0!==e&&e.remove(),this._element=void 0,this._messagePort=void 0,this._state.type===Td.Type.Initializing){for(let e of this._state.pendingMessages)e.resolve(!1);this._state.pendingMessages=[]}this._onDidDispose.fire(),this._resourceLoadingCts.dispose(!0),super.dispose()}setContextKeyService(e){this._contextKeyService=e}postMessage(e,t){return this._send("message",{message:e,transfer:t})}async _send(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this._state.type===Td.Type.Initializing){let{promise:o,resolve:s}=(0,at.qw)();return this._state.pendingMessages.push({channel:e,data:t,transferable:i,resolve:s}),o}return this.doPostMessage(e,t,i)}_createElement(e,t){let i=(0,at.jx)("iframe");i.name=this.id,i.className="webview ".concat(e.customClasses||""),i.sandbox.add("allow-scripts","allow-same-origin","allow-forms","allow-pointer-lock","allow-downloads");let o=["cross-origin-isolated","autoplay"];return at.lE||o.push("clipboard-read","clipboard-write"),i.setAttribute("allow",o.join("; ")),i.style.border="none",i.style.width="100%",i.style.height="100%",i.focus=()=>{this._doFocus()},i}_initElement(e,t,i,o){var s;let r={id:this.id,parentId:o.vscodeWindowId.toString(),origin:this.origin,swVersion:String(this._expectedServiceWorkerVersion),extensionId:null!==(s=null===t||void 0===t?void 0:t.id.value)&&void 0!==s?s:"",platform:this.platform,"vscode-resource-base-authority":St.a,parentOrigin:o.origin};this._options.disableServiceWorker&&(r.disableServiceWorker="true"),this._environmentService.remoteAuthority&&(r.remoteAuthority=this._environmentService.remoteAuthority),i.purpose&&(r.purpose=i.purpose),r.serviceWorkerUri=at.CT.asBrowserUri("vs/workbench/contrib/webview/browser/pre/service-worker.js").toString(!0),r.fakeHtmlUri=at.CT.asBrowserUri("vs/workbench/contrib/webview/browser/pre/fake.html").toString(!0),at.ST.addSearchParam(r,!0,!0);let n=new URLSearchParams(r).toString();this.perfMark("init/set-src");let a=at.CT.asBrowserUri("vs/workbench/contrib/webview/browser/pre/index.html");this.element.setAttribute("src","".concat(a.toString(!0),"?").concat(n))}mountTo(e,t){if(this.element){this._windowId=t.vscodeWindowId,this._encodedWebviewOriginPromise=(0,at.WT)(t.origin,this.origin).then(e=>this._encodedWebviewOrigin=e),this._encodedWebviewOriginPromise.then(e=>{this._disposed||this._initElement(e,this.extension,this._options,t)}),this._registerMessageHandler(t),this._webviewFindWidget&&e.appendChild(this._webviewFindWidget.getDomNode());for(let t of[at._x.MOUSE_DOWN,at._x.MOUSE_MOVE,at._x.DROP])this._register((0,at.Sx)(e,t,()=>{this._stopBlockingIframeDragEvents()}));for(let i of[e,t])this._register((0,at.Sx)(i,at._x.DRAG_END,()=>{this._stopBlockingIframeDragEvents()}));e.id=this.id,this.perfMark("mounted"),e.appendChild(this.element)}}_registerMessageHandler(e){let t=this._register((0,at.Sx)(e,"message",e=>{var i;if(this._encodedWebviewOrigin&&(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.target)===this.id&&"webview-ready"===e.data.channel){var o;if(this._messagePort)return;this.perfMark("webview-ready"),this._logService.trace("Webview(".concat(this.id,"): webview ready")),this._messagePort=e.ports[0],this._messagePort.onmessage=e=>{let t=this._messageHandlers.get(e.data.channel);t?null===t||void 0===t||t.forEach(t=>t(e.data.data,e)):console.log("No handlers found for '".concat(e.data.channel,"'"))},null!==(o=this.element)&&void 0!==o&&o.classList.add("ready"),this._state.type===Td.Type.Initializing&&this._state.pendingMessages.forEach(e=>{let{channel:t,data:i,resolve:o}=e;return o(this.doPostMessage(t,i))}),this._state=Td.Ready,t.dispose()}}))}perfMark(e){performance.mark("webview/webviewElement/".concat(e),{detail:{id:this.id}})}_startBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="none")}_stopBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="auto")}webviewContentEndpoint(e){let t=this._environmentService.webviewExternalEndpoint;if(!t)throw Error("'webviewExternalEndpoint' has not been configured. Webviews will not work!");let i=t.replace("{{uuid}}",e);return"/"===i[i.length-1]?i.slice(0,i.length-1):i}doPostMessage(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return!(!this.element||!this._messagePort)&&(this._messagePort.postMessage({channel:e,args:t},i),!0)}on(e,t){let i=this._messageHandlers.get(e);return i||(i=new Set,this._messageHandlers.set(e,i)),i.add(t),(0,at.kj)(()=>{var i;null===(i=this._messageHandlers.get(e))||void 0===i||i.delete(t)})}handleNoCspFound(){var e;this._hasAlertedAboutMissingCsp||(this._hasAlertedAboutMissingCsp=!0,(null===(e=this.extension)||void 0===e?void 0:e.id)&&this._environmentService.isExtensionDevelopment&&this._onMissingCsp.fire(this.extension.id))}reload(){this.doUpdateContent(this._content)}reinitializeAfterDismount(){this._state=new Td.Initializing([]),this._messagePort=void 0,this.mountTo(this.element.parentElement,(0,at.$x)(this.element)),this.reload()}setHtml(e){this.doUpdateContent((0,rt.A)((0,rt.A)({},this._content),{},{html:e})),this._onDidHtmlChange.fire(e)}setTitle(e){this._content=(0,rt.A)((0,rt.A)({},this._content),{},{title:e}),this._send("set-title",e)}set contentOptions(e){this._logService.debug("Webview(".concat(this.id,"): will update content options")),(0,ut.st)(e,this._content.options)?this._logService.debug("Webview(".concat(this.id,"): skipping content options update")):this.doUpdateContent((0,rt.A)((0,rt.A)({},this._content),{},{options:e}))}set localResourcesRoot(e){this._content=(0,rt.A)((0,rt.A)({},this._content),{},{options:(0,rt.A)((0,rt.A)({},this._content.options),{},{localResourceRoots:e})})}set state(e){this._content=(0,rt.A)((0,rt.A)({},this._content),{},{state:e})}set initialScrollProgress(e){this._send("initial-scroll-position",e)}doUpdateContent(e){var t;this._logService.debug("Webview(".concat(this.id,"): will update content")),this._content=e;let i=!!this._content.options.allowScripts;this.perfMark("set-content"),this._send("content",{contents:this._content.html,title:this._content.title,options:{allowMultipleAPIAcquire:!!this._content.options.allowMultipleAPIAcquire,allowScripts:i,allowForms:null!==(t=this._content.options.allowForms)&&void 0!==t?t:i},state:this._content.state,cspSource:St.i,confirmBeforeClose:this._confirmBeforeClose})}style(){let{styles:e,activeTheme:t,themeLabel:i,themeId:o}=this.webviewThemeDataProvider.getWebviewThemeData();this._options.transformCssVariables&&(e=this._options.transformCssVariables(e));let s=this._accessibilityService.isMotionReduced(),r=this._accessibilityService.isScreenReaderOptimized();this._send("styles",{styles:e,activeTheme:t,themeId:o,themeLabel:i,reduceMotion:s,screenReader:r})}handleFocusChange(e){this._focused=e,e?this._onDidFocus.fire():this._onDidBlur.fire()}handleKeyEvent(e,t){var i;let o=new KeyboardEvent(e,t);Object.defineProperty(o,"target",{get:()=>this.element}),null===(i=this.window)||void 0===i||i.dispatchEvent(o)}handleDragEvent(e,t){var i;let o=new DragEvent(e,t);Object.defineProperty(o,"target",{get:()=>this.element}),null===(i=this.window)||void 0===i||i.dispatchEvent(o)}windowDidDragStart(){this._startBlockingIframeDragEvents()}windowDidDragEnd(){this._stopBlockingIframeDragEvents()}selectAll(){this.execCommand("selectAll")}copy(){this.execCommand("copy")}paste(){this.execCommand("paste")}cut(){this.execCommand("cut")}undo(){this.execCommand("undo")}redo(){this.execCommand("redo")}execCommand(e){this.element&&this._send("execCommand",e)}async loadResource(e,t,i){try{let o=await fd(t,{ifNoneMatch:i,roots:this._content.options.localResourceRoots||[]},this._fileService,this._logService,this._resourceLoadingCts.token);switch(o.type){case wd.Type.Success:{let i=await this.streamToBuffer(o.stream);return this._send("did-load-resource",{id:e,status:200,path:t.path,mime:o.mimeType,data:i,etag:o.etag,mtime:o.mtime},[i])}case wd.Type.NotModified:return this._send("did-load-resource",{id:e,status:304,path:t.path,mime:o.mimeType,mtime:o.mtime});case wd.Type.AccessDenied:return this._send("did-load-resource",{id:e,status:401,path:t.path})}}catch(o){}return this._send("did-load-resource",{id:e,status:404,path:t.path})}async streamToBuffer(e){return(await(0,at.sw)(e)).buffer.buffer}async localLocalhost(e,t){let i=this._environmentService.remoteAuthority,o=i?await this._remoteAuthorityResolverService.resolveAuthority(i):void 0,s=o?await this._portMappingManager.getRedirect(o.authority,t):void 0;return this._send("did-load-localhost",{id:e,origin:t,location:s})}focus(){this._doFocus(),this.handleFocusChange(!0)}_doFocus(){if(this.element){try{var e;null===(e=this.element.contentWindow)||void 0===e||e.focus()}catch(t){}this._focusDelayer.trigger(async()=>{var e,t,i;!this.isFocused||!this.element||(null===(e=this.window)||void 0===e?void 0:e.document.activeElement)&&this.window.document.activeElement!==this.element&&"BODY"!==(null===(t=this.window.document.activeElement)||void 0===t?void 0:t.tagName)||(null!==(i=this.window)&&void 0!==i&&null!==(i=i.document.body)&&void 0!==i&&i.focus(),this._send("focus",void 0))})}}find(e,t){this.element&&this._send("find",{value:e,previous:t})}updateFind(e){!e||!this.element||this._send("find",{value:e})}stopFind(e){this.element&&(this._send("find-stop",{clearSelection:!e}),this._onDidStopFind.fire())}showFind(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this._webviewFindWidget)||void 0===e||e.reveal(void 0,t)}hideFind(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this._webviewFindWidget)||void 0===e||e.hide(t)}runFindAction(e){var t;null===(t=this._webviewFindWidget)||void 0===t||t.find(e)}};Od=(0,at.Jb)([(0,at.Yb)(2,at.r_),(0,at.Yb)(3,at.El),(0,at.Yb)(4,at.Pd),(0,at.Yb)(5,bt.O),(0,at.Yb)(6,at.fs),(0,at.Yb)(7,at.mb),(0,at.Yb)(8,ut.ux),(0,at.Yb)(9,ut.Vb),(0,at.Yb)(10,at.rx),(0,at.Yb)(11,at.Yg)],Od),(0,at.Xb)(),(0,at.oS)(),(0,at.fx)(),(0,at.sj)(),(0,at.wj)(),(0,at.qS)(),(0,at.dp)(),(0,at.Pb)(),(0,pt.st)(),(0,ut.ct)(),(0,ut.lv)(),(0,at.sC)(),(0,at.bC)();var Wd=class extends at.mj{get window(){return(0,at.eS)(this._windowId,!0).window}constructor(e,t,i,o){var s;super(),this._layoutService=t,this._webviewService=i,this._baseContextKeyService=o,this._isFirstLoad=!0,this._firstLoadPendingMessages=new Set,this._webview=this._register(new at.vj),this._webviewEvents=this._register(new at.gj),this._html="",this._initialScrollProgress=0,this._state=void 0,this._owner=void 0,this._windowId=void 0,this._scopedContextKeyService=this._register(new at.vj),this._shouldShowFindWidgetOnRestore=!1,this._isDisposed=!1,this._onDidDispose=this._register(new at.ej),this.onDidDispose=this._onDidDispose.event,this._onDidFocus=this._register(new at.ej),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new at.ej),this.onDidBlur=this._onDidBlur.event,this._onDidClickLink=this._register(new at.ej),this.onDidClickLink=this._onDidClickLink.event,this._onDidScroll=this._register(new at.ej),this.onDidScroll=this._onDidScroll.event,this._onDidUpdateState=this._register(new at.ej),this.onDidUpdateState=this._onDidUpdateState.event,this._onMessage=this._register(new at.ej),this.onMessage=this._onMessage.event,this._onMissingCsp=this._register(new at.ej),this.onMissingCsp=this._onMissingCsp.event,this._onDidWheel=this._register(new at.ej),this.onDidWheel=this._onDidWheel.event,this._onFatalError=this._register(new at.ej),this.onFatalError=this._onFatalError.event,this.intrinsicContentSize=(0,at.cC)("WebviewIntrinsicContentSize",void 0),this.providedViewType=e.providedViewType,this.origin=null!==(s=e.origin)&&void 0!==s?s:(0,at.up)(),this._title=e.title,this._extension=e.extension,this._options=e.options,this._contentOptions=e.contentOptions}get isFocused(){var e;return!(null===(e=this._webview.value)||void 0===e||!e.isFocused)}dispose(){var e;this._isDisposed=!0,null!==(e=this._container)&&void 0!==e&&e.domNode.remove(),this._container=void 0;for(let t of this._firstLoadPendingMessages)t.resolve(!1);this._firstLoadPendingMessages.clear(),this._onDidDispose.fire(),super.dispose()}get container(){if(this._isDisposed)throw Error("OverlayWebview has been disposed");if(!this._container){let e=(0,at.jx)("div");e.style.position="absolute",e.style.overflow="hidden",this._container=new at.ux(e),this._container.setVisibility("hidden"),this._layoutService.getContainer(this.window).appendChild(e)}return this._container.domNode}claim(e,t,i){var o;if(this._isDisposed)return;let s=this._owner;if(this._windowId!==t.vscodeWindowId&&(this.release(s),this._webview.clear(),this._webviewEvents.clear(),null!==(o=this._container)&&void 0!==o&&o.domNode.remove(),this._container=void 0),this._owner=e,this._windowId=t.vscodeWindowId,this._show(t),s!==e){var r,n,a,d;let e=i||this._baseContextKeyService;this._scopedContextKeyService.clear(),this._scopedContextKeyService.value=e.createScoped(this.container);let t=null===(r=this._findWidgetVisible)||void 0===r?void 0:r.get();null!==(n=this._findWidgetVisible)&&void 0!==n&&n.reset(),this._findWidgetVisible=ut.at.bindTo(e),this._findWidgetVisible.set(!!t),null!==(a=this._findWidgetEnabled)&&void 0!==a&&a.reset(),this._findWidgetEnabled=ut.rt.bindTo(e),this._findWidgetEnabled.set(!!this.options.enableFindWidget),null===(d=this._webview.value)||void 0===d||d.setContextKeyService(this._scopedContextKeyService.value)}}release(e){var t;this._owner===e&&(this._scopedContextKeyService.clear(),this._owner=void 0,this._container&&this._container.setVisibility("hidden"),this._options.retainContextWhenHidden?(this._shouldShowFindWidgetOnRestore=!(null===(t=this._findWidgetVisible)||void 0===t||!t.get()),this.hideFind(!1)):(this._webview.clear(),this._webviewEvents.clear()))}layoutWebviewOverElement(e,t,i){if(!this._container||!this._container.domNode.parentElement)return;let o=this._layoutService.whenContainerStylesLoaded(this.window);o?o.then(()=>this.doLayoutWebviewOverElement(e,t,i)):this.doLayoutWebviewOverElement(e,t,i)}doLayoutWebviewOverElement(e,t,i){if(!this._container||!this._container.domNode.parentElement)return;let o=e.getBoundingClientRect(),s=this._container.domNode.parentElement.getBoundingClientRect(),r=(s.height-this._container.domNode.parentElement.clientHeight)/2,n=(s.width-this._container.domNode.parentElement.clientWidth)/2;if(this._container.setTop(o.top-s.top-r),this._container.setLeft(o.left-s.left-n),this._container.setWidth(t?t.width:o.width),this._container.setHeight(t?t.height:o.height),i){let{top:e,left:t,right:s,bottom:r}=function(e,t){let i=t.getBoundingClientRect();return{top:Math.max(i.top-e.top,0),right:Math.max(e.width-(e.right-i.right),0),bottom:Math.max(e.height-(e.bottom-i.bottom),0),left:Math.max(i.left-e.left,0)}}(o,i);this._container.domNode.style.clipPath="polygon(".concat(t,"px ").concat(e,"px, ").concat(s,"px ").concat(e,"px, ").concat(s,"px ").concat(r,"px, ").concat(t,"px ").concat(r,"px)")}}_show(e){var t;if(this._isDisposed)throw Error("OverlayWebview is disposed");if(!this._webview.value){var i;let t=this._webviewService.createWebviewElement({providedViewType:this.providedViewType,origin:this.origin,title:this._title,options:this._options,contentOptions:this._contentOptions,extension:this.extension});this._webview.value=t,t.state=this._state,this._scopedContextKeyService.value&&this._webview.value.setContextKeyService(this._scopedContextKeyService.value),this._html&&t.setHtml(this._html),this._options.tryRestoreScrollPosition&&(t.initialScrollProgress=this._initialScrollProgress),null!==(i=this._findWidgetEnabled)&&void 0!==i&&i.set(!!this.options.enableFindWidget),t.mountTo(this.container,e),this._webviewEvents.clear(),this._webviewEvents.add(t.onDidFocus(()=>{this._onDidFocus.fire()})),this._webviewEvents.add(t.onDidBlur(()=>{this._onDidBlur.fire()})),this._webviewEvents.add(t.onDidClickLink(e=>{this._onDidClickLink.fire(e)})),this._webviewEvents.add(t.onMessage(e=>{this._onMessage.fire(e)})),this._webviewEvents.add(t.onMissingCsp(e=>{this._onMissingCsp.fire(e)})),this._webviewEvents.add(t.onDidWheel(e=>{this._onDidWheel.fire(e)})),this._webviewEvents.add(t.onFatalError(e=>{this._onFatalError.fire(e)})),this._webviewEvents.add((0,at.hC)(e=>{this.intrinsicContentSize.set(e.readObservable(t.intrinsicContentSize),void 0,void 0)})),this._webviewEvents.add(t.onDidScroll(e=>{this._initialScrollProgress=e.scrollYPercentage,this._onDidScroll.fire(e)})),this._webviewEvents.add(t.onDidUpdateState(e=>{this._state=e,this._onDidUpdateState.fire(e)})),this._isFirstLoad&&this._firstLoadPendingMessages.forEach(async e=>{e.resolve(await t.postMessage(e.message,e.transfer))}),this._isFirstLoad=!1,this._firstLoadPendingMessages.clear()}this.options.retainContextWhenHidden&&this._shouldShowFindWidgetOnRestore&&(this.showFind(!1),this._shouldShowFindWidgetOnRestore=!1),null===(t=this._container)||void 0===t||t.setVisibility("visible")}setHtml(e){this._html=e,this._withWebview(t=>t.setHtml(e))}setTitle(e){this._title=e,this._withWebview(t=>t.setTitle(e))}get initialScrollProgress(){return this._initialScrollProgress}set initialScrollProgress(e){this._initialScrollProgress=e,this._withWebview(t=>t.initialScrollProgress=e)}get state(){return this._state}set state(e){this._state=e,this._withWebview(t=>t.state=e)}get extension(){return this._extension}set extension(e){this._extension=e,this._withWebview(t=>t.extension=e)}get options(){return this._options}set options(e){this._options=(0,rt.A)({customClasses:this._options.customClasses},e)}get contentOptions(){return this._contentOptions}set contentOptions(e){this._contentOptions=e,this._withWebview(t=>t.contentOptions=e)}set localResourcesRoot(e){this._withWebview(t=>t.localResourcesRoot=e)}async postMessage(e,t){if(this._webview.value)return this._webview.value.postMessage(e,t);if(this._isFirstLoad){let i,o=new Promise(e=>i=e);return this._firstLoadPendingMessages.add({message:e,transfer:t,resolve:i}),o}return!1}focus(){var e;null===(e=this._webview.value)||void 0===e||e.focus()}reload(){var e;null===(e=this._webview.value)||void 0===e||e.reload()}selectAll(){var e;null===(e=this._webview.value)||void 0===e||e.selectAll()}copy(){var e;null===(e=this._webview.value)||void 0===e||e.copy()}paste(){var e;null===(e=this._webview.value)||void 0===e||e.paste()}cut(){var e;null===(e=this._webview.value)||void 0===e||e.cut()}undo(){var e;null===(e=this._webview.value)||void 0===e||e.undo()}redo(){var e;null===(e=this._webview.value)||void 0===e||e.redo()}showFind(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._webview.value&&(this._webview.value.showFind(t),null===(e=this._findWidgetVisible)||void 0===e||e.set(!0))}hideFind(){var e,t;let i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null!==(e=this._findWidgetVisible)&&void 0!==e&&e.reset(),null===(t=this._webview.value)||void 0===t||t.hideFind(i)}runFindAction(e){var t;null===(t=this._webview.value)||void 0===t||t.runFindAction(e)}_withWebview(e){this._webview.value&&e(this._webview.value)}windowDidDragStart(){var e;null===(e=this._webview.value)||void 0===e||e.windowDidDragStart()}windowDidDragEnd(){var e;null===(e=this._webview.value)||void 0===e||e.windowDidDragEnd()}setContextKeyService(e){var t;null===(t=this._webview.value)||void 0===t||t.setContextKeyService(e)}};Wd=(0,at.Jb)([(0,at.Yb)(1,pt.ot),(0,at.Yb)(2,ut.cv),(0,at.Yb)(3,at.Nb)],Wd),(0,at.Xb)(),(0,at.sj)(),(0,at.wj)(),(0,at.ox)();var Ld=class extends at.mj{constructor(e){super(),this._instantiationService=e,this._webviews=new Set,this._onDidChangeActiveWebview=this._register(new at.ej),this.onDidChangeActiveWebview=this._onDidChangeActiveWebview.event,this._webviewThemeDataProvider=this._instantiationService.createInstance(vd)}get activeWebview(){return this._activeWebview}_updateActiveWebview(e){e!==this._activeWebview&&(this._activeWebview=e,this._onDidChangeActiveWebview.fire(e))}get webviews(){return this._webviews.values()}createWebviewElement(e){let t=this._instantiationService.createInstance(Od,e,this._webviewThemeDataProvider);return this.registerNewWebview(t),t}createWebviewOverlay(e){let t=this._instantiationService.createInstance(Wd,e);return this.registerNewWebview(t),t}registerNewWebview(e){this._webviews.add(e);let t=new at.gj;t.add(e.onDidFocus(()=>{this._updateActiveWebview(e)}));let i=()=>{this._activeWebview===e&&this._updateActiveWebview(void 0)};t.add(e.onDidBlur(i)),t.add(e.onDidDispose(()=>{i(),t.dispose(),this._webviews.delete(e)}))}};Ld=(0,at.Jb)([(0,at.Yb)(0,at.rx)],Ld),(0,at.Ww)(),(0,at.LA)(),(0,at.sj)(),(0,at.wj)();var Jd,Gd=class extends at.mj{constructor(){super(...arguments),this._resolvers=new Map,this._awaitingRevival=new Map,this._onNewResolverRegistered=this._register(new at.ej),this.onNewResolverRegistered=this._onNewResolverRegistered.event}register(e,t){if(this._resolvers.has(e))throw Error("View resolver already registered for ".concat(e));this._resolvers.set(e,t),this._onNewResolverRegistered.fire({viewType:e});let i=this._awaitingRevival.get(e);return i&&t.resolve(i.webview,at.PA.None).then(()=>{this._awaitingRevival.delete(e),i.resolve()}),(0,at.kj)(()=>{this._resolvers.delete(e)})}resolve(e,t,i){let o=this._resolvers.get(e);if(!o){if(this._awaitingRevival.has(e))throw Error("View already awaiting revival");let{promise:i,resolve:o}=(0,at.qw)();return this._awaitingRevival.set(e,{webview:t,resolve:o}),i}return o.resolve(t,i)}};(0,at.vE)(),(0,at.TM)(),(0,at.oS)(),(0,at.KT)(),(0,at.Ur)(),(0,at.Xn)(),(0,at.cr)(),(0,at.Mn)(),(0,at.Kb)(),(0,at.pO)(),(0,at.Vb)(),(0,at.QO)(),(0,bt.ot)(),(0,at.wj)(),(0,at.iM)(),(0,at.Hi)(),(0,at.bE)({}),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(Jd||(Jd={}));var Nd=class extends at.mj{constructor(e,t,i,o){if(super(),this.container=e,this.message=t,this.options=o,this.modalElement=this.container.appendChild((0,at.px)(".monaco-dialog-modal-block.dimmed")),this._register((0,at.Tx)(this.modalElement,at._x.CLICK,e=>{e.target===this.modalElement&&this.element.focus()})),this.shadowElement=this.modalElement.appendChild((0,at.px)(".dialog-shadow")),this.element=this.shadowElement.appendChild((0,at.px)(".monaco-dialog-box")),o.alignment===Jd.Vertical&&this.element.classList.add("align-vertical"),o.extraClasses&&this.element.classList.add(...o.extraClasses),this.element.setAttribute("role","dialog"),this.element.tabIndex=-1,(0,at.aS)(this.element),this.options.renderFooter){this.footerContainer=this.element.appendChild((0,at.px)(".dialog-footer-row"));let e=this.footerContainer.appendChild((0,at.px)("#monaco-dialog-footer.dialog-footer"));this.options.renderFooter(e);for(let t of this.footerContainer.querySelectorAll("a"))t.tabIndex=0}this.buttonStyles=o.buttonStyles,Array.isArray(i)&&i.length>0?this.buttons=i:this.options.disableDefaultAction?this.buttons=[]:this.buttons=[(0,at.EM)(3,"OK")],this.buttonsContainer=this.element.appendChild((0,at.px)(".dialog-buttons-row")).appendChild((0,at.px)(".dialog-buttons"));let s=this.element.appendChild((0,at.px)(".dialog-message-row"));if(this.iconElement=s.appendChild((0,at.px)("#monaco-dialog-icon.dialog-icon")),this.iconElement.setAttribute("aria-label",this.getIconAriaLabel()),this.messageContainer=s.appendChild((0,at.px)(".dialog-message-container")),this.options.detail||this.options.renderBody){this.messageContainer.appendChild((0,at.px)(".dialog-message")).appendChild((0,at.px)("#monaco-dialog-message-text.dialog-message-text")).innerText=this.message}if(this.messageDetailElement=this.messageContainer.appendChild((0,at.px)("#monaco-dialog-message-detail.dialog-message-detail")),this.options.detail||!this.options.renderBody?this.messageDetailElement.innerText=this.options.detail?this.options.detail:t:this.messageDetailElement.style.display="none",this.options.renderBody){let e=this.messageContainer.appendChild((0,at.px)("#monaco-dialog-message-body.dialog-message-body"));this.options.renderBody(e);for(let t of this.messageContainer.querySelectorAll("a"))t.tabIndex=0}if(this.options.inputs?this.inputs=this.options.inputs.map(e=>{var t;let i=this.messageContainer.appendChild((0,at.px)(".dialog-message-input")),s=this._register(new at.An(i,void 0,{placeholder:e.placeholder,type:null!==(t=e.type)&&void 0!==t?t:"text",inputBoxStyles:o.inputBoxStyles}));return e.value&&(s.value=e.value),s}):this.inputs=[],this.options.checkboxLabel){let e=this.messageContainer.appendChild((0,at.px)(".dialog-checkbox-row")),t=this.checkbox=this._register(new at.or(this.options.checkboxLabel,!!this.options.checkboxChecked,o.checkboxStyles));e.appendChild(t.domNode);let i=e.appendChild((0,at.px)(".dialog-checkbox-message"));i.innerText=this.options.checkboxLabel,this._register((0,at.Sx)(i,at._x.CLICK,()=>t.checked=!t.checked))}this.toolbarContainer=this.element.appendChild((0,at.px)(".dialog-toolbar-row")).appendChild((0,at.px)(".dialog-toolbar")),this.applyStyles()}getIconAriaLabel(){let e=(0,at.EM)(4,"Info");switch(this.options.type){case"error":e=(0,at.EM)(5,"Error");break;case"warning":e=(0,at.EM)(6,"Warning");break;case"pending":e=(0,at.EM)(7,"In Progress")}return e}updateMessage(e){this.messageDetailElement.innerText=e}async show(){return this.focusToReturn=(0,at.zx)(this.container.ownerDocument),new Promise(e=>{var t;(0,at.Ox)(this.buttonsContainer);let i=()=>{e({button:this.options.cancelId||0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0})};this._register((0,at.kj)(i));let o=this.buttonBar=this._register(new at.Kn(this.buttonsContainer,{alignment:(null===(t=this.options)||void 0===t?void 0:t.alignment)===Jd.Vertical?at.qn.Vertical:at.qn.Horizontal})),s=this.rearrangeButtons(this.buttons,this.options.cancelId),r=t=>{e({button:s[t].index,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(e=>e.value):void 0})};s.forEach((e,t)=>{var i,n,a;let d,l=0===s[t].index,c=null===(i=this.options.buttonOptions)||void 0===i?void 0:i[null===(n=s[t])||void 0===n?void 0:n.index];if(l&&null!==(a=this.options)&&void 0!==a&&a.primaryButtonDropdown){let e=(0,at.Ui)(this.options.primaryButtonDropdown.actions)?this.options.primaryButtonDropdown.actions.getActions():this.options.primaryButtonDropdown.actions;d=this._register(o.addButtonWithDropdown((0,rt.A)((0,rt.A)((0,rt.A)({},this.options.primaryButtonDropdown),this.buttonStyles),{},{dropdownLayer:2600,actions:e.map(e=>(0,at.qb)((0,rt.A)((0,rt.A)({},e),{},{run:async()=>{await e.run(),r(t)}})))})))}else d=null!==c&&void 0!==c&&c.sublabel?this._register(o.addButtonWithDescription((0,rt.A)({secondary:!l},this.buttonStyles))):this._register(o.addButton((0,rt.A)({secondary:!l},this.buttonStyles)));null!==c&&void 0!==c&&c.styleButton&&c.styleButton(d),d.label=(0,bt.st)(s[t].label,!0),d instanceof at.Jn&&null!==c&&void 0!==c&&c.sublabel&&(d.description=null===c||void 0===c?void 0:c.sublabel),this._register(d.onDidClick(e=>{e&&at.gx.stop(e),r(t)}))});let n=(0,at.$x)(this.container);this._register((0,at.Sx)(n,"keydown",t=>{let i=new at.GT(t);var o,r;if(i.equals(at.JO.Alt)&&i.preventDefault(),i.equals(at.KO.Enter))return void(this.inputs.some(e=>e.hasFocus())&&(at.gx.stop(t),e({button:null!==(o=null===(r=s.find(e=>e.index!==this.options.cancelId))||void 0===r?void 0:r.index)&&void 0!==o?o:0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(e=>e.value):void 0})));if(at.pM&&i.equals(at.JO.CtrlCmd|at.KO.KeyD)){at.gx.stop(t);let i=s.find(e=>1===e.index&&e.index!==this.options.cancelId);return void(i&&e({button:i.index,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(e=>e.value):void 0}))}if(i.equals(at.KO.Space))return;let n=!1;if(i.equals(at.KO.Tab)||i.equals(at.KO.RightArrow)||i.equals(at.JO.Shift|at.KO.Tab)||i.equals(at.KO.LeftArrow)){let e=[],t=-1;if(this.messageContainer){let i=this.messageContainer.querySelectorAll("a");for(let o of i)e.push(o),(0,at.cS)(o)&&(t=e.length-1)}for(let i of this.inputs)e.push(i),i.hasFocus()&&(t=e.length-1);if(this.checkbox&&(e.push(this.checkbox),this.checkbox.hasFocus()&&(t=e.length-1)),this.buttonBar)for(let i of this.buttonBar.buttons)i instanceof at.Yn?(e.push(i.primaryButton),i.primaryButton.hasFocus()&&(t=e.length-1),e.push(i.dropdownButton),i.dropdownButton.hasFocus()&&(t=e.length-1)):(e.push(i),i.hasFocus()&&(t=e.length-1));if(this.footerContainer){let i=this.footerContainer.querySelectorAll("a");for(let o of i)e.push(o),(0,at.cS)(o)&&(t=e.length-1)}if(i.equals(at.KO.Tab)||i.equals(at.KO.RightArrow))e[(t+1)%e.length].focus();else{-1===t&&(t=e.length);let i=t-1;-1===i&&(i=e.length-1),e[i].focus()}n=!0}n?at.gx.stop(t,!0):this.options.keyEventProcessor&&this.options.keyEventProcessor(i)},!0)),this._register((0,at.Sx)(n,"keyup",e=>{at.gx.stop(e,!0);let t=new at.GT(e);!this.options.disableCloseAction&&t.equals(at.KO.Escape)&&i()},!0)),this._register((0,at.Sx)(this.element,"focusout",e=>{e.relatedTarget&&this.element&&((0,at.lS)(e.relatedTarget,this.element)||(this.focusToReturn=e.relatedTarget,e.target&&(e.target.focus(),at.gx.stop(e,!0))))},!1));let a="codicon-modifier-spin";if(this.iconElement.classList.remove(...at.Bb.asClassNameArray(at.fO.dialogError),...at.Bb.asClassNameArray(at.fO.dialogWarning),...at.Bb.asClassNameArray(at.fO.dialogInfo),...at.Bb.asClassNameArray(at.fO.loading),a),this.options.icon)this.iconElement.classList.add(...at.Bb.asClassNameArray(this.options.icon));else switch(this.options.type){case"error":this.iconElement.classList.add(...at.Bb.asClassNameArray(at.fO.dialogError));break;case"warning":this.iconElement.classList.add(...at.Bb.asClassNameArray(at.fO.dialogWarning));break;case"pending":this.iconElement.classList.add(...at.Bb.asClassNameArray(at.fO.loading),a);break;case"none":this.iconElement.classList.add("no-codicon");break;default:this.iconElement.classList.add(...at.Bb.asClassNameArray(at.fO.dialogInfo))}if(!this.options.disableCloseAction&&!this.options.disableCloseButton){let t=this._register(new at.Vr(this.toolbarContainer,{})),i=this._register(new at.Hb("dialog.close",(0,at.EM)(8,"Close Dialog"),at.Bb.asClassName(at.fO.dialogClose),!0,async()=>{e({button:this.options.cancelId||0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0})}));t.push(i,{icon:!0,label:!1})}this.applyStyles(),this.element.setAttribute("aria-modal","true"),this.element.setAttribute("aria-labelledby","monaco-dialog-icon monaco-dialog-message-text"),this.element.setAttribute("aria-describedby","monaco-dialog-icon monaco-dialog-message-text monaco-dialog-message-detail monaco-dialog-message-body monaco-dialog-footer"),(0,at.BS)(this.element),this.inputs.length>0?(this.inputs[0].focus(),this.inputs[0].select()):s.forEach((e,t)=>{0===e.index&&o.buttons[t].focus()})})}applyStyles(){let e,t=this.options.dialogStyles,i=t.dialogForeground,o=t.dialogBackground,s=t.dialogShadow?"0 0px 8px ".concat(t.dialogShadow):"",r=t.dialogBorder?"1px solid ".concat(t.dialogBorder):"",n=t.textLinkForeground;if(this.shadowElement.style.boxShadow=s,this.element.style.color=null!==i&&void 0!==i?i:"",this.element.style.backgroundColor=null!==o&&void 0!==o?o:"",this.element.style.border=r,n)for(let l of[...this.messageContainer.getElementsByTagName("a"),...null!==(a=null===(d=this.footerContainer)||void 0===d?void 0:d.getElementsByTagName("a"))&&void 0!==a?a:[]]){var a,d;l.style.color=n}switch(this.options.type){case"none":break;case"error":e=t.errorIconForeground;break;case"warning":e=t.warningIconForeground;break;default:e=t.infoIconForeground}e&&(this.iconElement.style.color=e)}dispose(){super.dispose(),this.modalElement&&(this.modalElement=void this.modalElement.remove()),this.focusToReturn&&(0,at.lS)(this.focusToReturn,this.container.getRootNode())&&(this.focusToReturn.focus(),this.focusToReturn=void 0)}rearrangeButtons(e,t){let i=e.map((e,t)=>({label:e,index:t}));if(e.length<2||this.options.alignment===Jd.Vertical)return i;if(at.pM||at.dM){if("number"==typeof t&&i[t]){let e=i.splice(t,1)[0];i.splice(1,0,e)}i.reverse()}else if(at.yM&&"number"==typeof t&&i[t]){let e=i.splice(t,1)[0];i.push(e)}return i}};(0,at.oS)(),(0,at.Ay)(),(0,at.TM)(),(0,at.xc)(),(0,at.Ii)();var Kd=["workbench.action.quit","workbench.action.reloadWindow","copy","cut","editor.action.selectAll","editor.action.clipboardCopyAction","editor.action.clipboardCutAction","editor.action.clipboardPasteAction"];(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.wj)(),(0,pt.gt)(),(0,at.ox)(),(0,ut.kb)(),(0,ut.Tb)(),(0,at.Ww)(),(0,gt.ut)(),(0,gt.Gn)(),(0,at.Bd)(),(0,at.Fd)(),(0,at.Kb)(),(0,at.sj)(),(0,at.Jp)(),(0,at.Ul)(),(0,at.Dd)(),(0,at.ir)(),(0,ut.xf)(),(0,ut.yb)(),(0,ut.vg)(),(0,pt.kt)(),(0,at.qc)(),(0,ut.wg)(),(0,at.Wd)(),(0,at.bE)({});var Zd=class extends at.mj{constructor(e,t,i,o,s,r,n,a,d){super(),this.activityService=e,this.paneCompositeService=t,this.viewDescriptorService=i,this.viewsService=o,this.notificationService=s,this.statusbarService=r,this.layoutService=n,this.keybindingService=a,this.userActivityService=d,this.windowProgressStack=[],this.windowProgressStatusEntry=void 0}async withProgress(e,t,i){let{location:o}=e,s=async e=>{let i=this.userActivityService.markActive({extendOnly:!0,whenHeldFor:15e3});try{return await t(e)}finally{i.dispose()}},r=t=>{let i=this.viewDescriptorService.getViewContainerById(t);if(i){let o=this.viewDescriptorService.getViewContainerLocation(i);if(null!==o)return this.withPaneCompositeProgress(t,o,s,(0,rt.A)((0,rt.A)({},e),{},{location:t}))}if(null!==this.viewDescriptorService.getViewDescriptorById(t))return this.withViewProgress(t,s,(0,rt.A)((0,rt.A)({},e),{},{location:t}));throw Error("Bad progress location: ".concat(t))};if("string"==typeof o)return r(o);switch(o){case pt.mt.Notification:{let t=e.priority;return t!==at.Rd.URGENT&&(this.notificationService.getFilter()===at.zd.ERROR||(0,at.Vd)(e.source)&&this.notificationService.getFilter(e.source)===at.zd.ERROR)&&(t=at.Rd.SILENT),this.withNotificationProgress((0,rt.A)((0,rt.A)({},e),{},{location:o,priority:t}),s,i)}case pt.mt.Window:{let t=e.type;return e.command?this.withWindowProgress((0,rt.A)((0,rt.A)({},e),{},{location:o,type:t}),s):this.withNotificationProgress((0,rt.A)((0,rt.A)({delay:150},e),{},{priority:at.Rd.SILENT,location:pt.mt.Notification,type:t}),s,i)}case pt.mt.Explorer:return this.withPaneCompositeProgress("workbench.view.explorer",ut.gf.Sidebar,s,(0,rt.A)((0,rt.A)({},e),{},{location:o}));case pt.mt.Scm:return r("workbench.scm");case pt.mt.Extensions:return this.withPaneCompositeProgress("workbench.view.extensions",ut.gf.Sidebar,s,(0,rt.A)((0,rt.A)({},e),{},{location:o}));case pt.mt.Dialog:return this.withDialogProgress(e,s,i);default:throw Error("Bad progress location: ".concat(o))}}withWindowProgress(e,t){let i=[e,new pt.pt(()=>this.updateWindowProgress())],o=t(i[1]),s=setTimeout(()=>{s=void 0,this.windowProgressStack.unshift(i),this.updateWindowProgress(),Promise.all([(0,at.$w)(150),o]).finally(()=>{let e=this.windowProgressStack.indexOf(i);this.windowProgressStack.splice(e,1),this.updateWindowProgress()})},150);return o.finally(()=>clearTimeout(s))}updateWindowProgress(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<this.windowProgressStack.length){let e,i,[o,s]=this.windowProgressStack[t],r=o.title,n=s.value&&s.value.message,a=o.command,d=o.source&&"string"!=typeof o.source?o.source.label:o.source;if(r&&n)e=(0,at.EM)(13572,"{0}: {1}",r,n),i=d?(0,at.EM)(13573,"[{0}] {1}: {2}",d,r,n):e;else if(r)e=r,i=d?(0,at.EM)(13574,"[{0}]: {1}",d,r):e;else{if(!n)return void this.updateWindowProgress(t+1);e=n,i=d?(0,at.EM)(13574,"[{0}]: {1}",d,n):e}let l={name:(0,at.EM)(13575,"Progress Message"),text:e,showProgress:o.type||!0,ariaLabel:e,tooltip:(0,at.Xc)(i).trim(),command:a};this.windowProgressStatusEntry?this.windowProgressStatusEntry.update(l):this.windowProgressStatusEntry=this.statusbarService.addEntry(l,"status.progress",ut.Db.LEFT,-Number.MAX_VALUE)}else null!==(e=this.windowProgressStatusEntry)&&void 0!==e&&e.dispose(),this.windowProgressStatusEntry=void 0}withNotificationProgress(e,t,i){let o,s,r,n=new class extends at.mj{get step(){return this._step}get done(){return this._done}constructor(){super(),this._onDidReport=this._register(new at.ej),this.onDidReport=this._onDidReport.event,this._onWillDispose=this._register(new at.ej),this.onWillDispose=this._onWillDispose.event,this._step=void 0,this._done=!1,this.promise=t(this),this.promise.finally(()=>{this.dispose()})}report(e){this._step=e,this._onDidReport.fire(e)}cancel(e){null!==i&&void 0!==i&&i(e),this.dispose()}dispose(){this._done=!0,this._onWillDispose.fire(),super.dispose()}},a=()=>{let t=new at.xw;return this.withWindowProgress({location:pt.mt.Window,title:e.title?(0,at.ar)(e.title).toString():void 0,command:"notifications.showList",type:e.type},e=>{function i(t){t.message&&e.report({message:(0,at.ar)(t.message).toString()})}n.step&&i(n.step);let o=n.onDidReport(e=>i(e));return t.p.finally(()=>o.dispose()),at.tj.once(n.onWillDispose)(()=>t.complete()),t.p}),(0,at.kj)(()=>t.complete())},d=(t,i,o)=>{let s=new at.gj,r=e.primaryActions?Array.from(e.primaryActions):[],d=e.secondaryActions?Array.from(e.secondaryActions):[];if(e.buttons&&e.buttons.forEach((e,t)=>{let i=new class extends at.Hb{constructor(){super("progress.button.".concat(e),e,void 0,!0)}async run(){n.cancel(t)}};s.add(i),r.push(i)}),e.cancellable){let t=new class extends at.Hb{constructor(){super("progress.cancel","string"==typeof e.cancellable?e.cancellable:(0,at.EM)(13576,"Cancel"),void 0,!0)}async run(){n.cancel()}};s.add(t),r.push(t)}let l,c=this.notificationService.notify({severity:at.Ud.Info,message:(0,at.Xc)(t),source:e.source,actions:{primary:r,secondary:d},progress:"number"==typeof o&&o>=0?{total:100,worked:o}:{infinite:!0},priority:i}),h=e=>{(0,at.Sj)(l),!e&&!n.done&&(l=a())};return s.add(c.onDidChangeVisibility(h)),i===at.Rd.SILENT&&h(!1),at.tj.once(c.onDidClose)(()=>{s.dispose(),(0,at.Sj)(l)}),c},l=t=>{r=null!==t&&void 0!==t&&t.message&&e.title?"".concat(e.title,": ").concat(t.message):e.title||(null===t||void 0===t?void 0:t.message),!o&&r&&("number"==typeof e.delay&&e.delay>0?void 0===s&&(s=setTimeout(()=>o=d(r,e.priority,null===t||void 0===t?void 0:t.increment),e.delay)):o=d(r,e.priority,null===t||void 0===t?void 0:t.increment)),o&&(r&&o.updateMessage(r),"number"==typeof(null===t||void 0===t?void 0:t.increment)&&((e,t)=>{"number"==typeof t&&t>=0?(e.progress.total(100),e.progress.worked(t)):e.progress.infinite()})(o,t.increment))};l(n.step);let c=n.onDidReport(e=>l(e));return at.tj.once(n.onWillDispose)(()=>c.dispose()),(async()=>{try{"number"==typeof e.delay&&e.delay>0?await n.promise:await Promise.all([(0,at.$w)(800),n.promise])}finally{var t;clearTimeout(s),null===(t=o)||void 0===t||t.close()}})(),n.promise}withPaneCompositeProgress(e,t,i,o){let s=this.paneCompositeService.getProgressIndicator(e,t),r=s?this.withCompositeProgress(s,i,o):i({report:()=>{}});return t===ut.gf.Sidebar&&this.showOnActivityBar(e,o,r),r}withViewProgress(e,t,i){var o;let s=this.viewsService.getViewProgressIndicator(e),r=s?this.withCompositeProgress(s,t,i):t({report:()=>{}}),n=null===(o=this.viewDescriptorService.getViewContainerByViewId(e))||void 0===o?void 0:o.id;return void 0===n||this.showOnActivityBar(n,i,r),r}showOnActivityBar(e,t,i){let o,s=setTimeout(()=>{s=void 0;let t=this.activityService.showViewContainerActivity(e,{badge:new gt.lt(()=>"")}),i=Date.now();o={dispose(){let e=Date.now()-i;e<300?setTimeout(()=>t.dispose(),300-e):t.dispose()}}},t.delay||300);i.finally(()=>{clearTimeout(s),(0,at.Sj)(o)})}withCompositeProgress(e,t,i){let o;function s(t){var s,n;let a,d;return void 0!==t&&("number"==typeof t?a=t:"number"==typeof t.increment&&(a=null!==(s=t.total)&&void 0!==s?s:100,d=t.increment)),"number"==typeof a?(o||(o=e.show(a,i.delay),r.catch(()=>{}).finally(()=>{var e;return null===(e=o)||void 0===e?void 0:e.done()})),"number"==typeof d&&o.worked(d)):(null!==(n=o)&&void 0!==n&&n.done(),e.showWhile(r,i.delay)),o}let r=t({report:e=>{s(e)}});return s(i.total),r}withDialogProgress(e,t,i){var o;let s,r,n=new at.gj,a=!1,d=t=>{let o=e.buttons||[];return e.sticky||o.push(e.cancellable?"boolean"==typeof e.cancellable?(0,at.EM)(13576,"Cancel"):e.cancellable:(0,at.EM)(13577,"Dismiss")),s=new Nd(this.layoutService.activeContainer,t,o,function(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kd;return(0,rt.A)({keyEventProcessor:e=>{let s=t.softDispatch(e,i.activeContainer);s.kind===at.bc.KbFound&&s.commandId&&(o.includes(s.commandId)||at.gx.stop(e,!0))},buttonStyles:at.Ti,checkboxStyles:at.Ei,inputBoxStyles:at.ki,dialogStyles:at.Oi},e)}({type:"pending",detail:e.detail,cancelId:o.length-1,disableCloseAction:e.sticky,disableDefaultAction:e.sticky},this.keybindingService,this.layoutService)),n.add(s),s.show().then(e=>{a||null!==i&&void 0!==i&&i(e.button),(0,at.Sj)(s)}),s},l=null!==(o=e.delay)&&void 0!==o?o:0,c=n.add(new at.Aw(()=>{l=0,r&&!s?s=d(r):r&&s.updateMessage(r)},0)),h=function(e){r=e,c.isScheduled()||c.schedule(l)},u=t({report:e=>{h(e.message)}});return u.finally(()=>{a=!0,(0,at.Sj)(n)}),e.title&&h(e.title),u}};Zd=(0,at.Jb)([(0,at.Yb)(0,gt.Wn),(0,at.Yb)(1,pt.Ot),(0,at.Yb)(2,ut.vb),(0,at.Yb)(3,ut._g),(0,at.Yb)(4,at.Pd),(0,at.Yb)(5,ut.wb),(0,at.Yb)(6,at.Hl),(0,at.Yb)(7,at.Ed),(0,at.Yb)(8,ut.Cg)],Zd),(0,at.Xb)(),(0,at.sj)(),(0,at.GM)(),(0,at.Jp)(),(0,at.ox)(),(0,ut.xf)(),(0,at.wj)();var Bd=class extends at.mj{constructor(e){super(),this.paneCompositeParts=new Map;let t=e.createInstance(kn),i=e.createInstance(xn),o=e.createInstance(Lt);this.paneCompositeParts.set(ut.gf.Panel,t),this.paneCompositeParts.set(ut.gf.Sidebar,i),this.paneCompositeParts.set(ut.gf.AuxiliaryBar,o);let s=this._register(new at.gj);this.onDidPaneCompositeOpen=at.tj.any(...ut.vf.map(e=>at.tj.map(this.paneCompositeParts.get(e).onDidPaneCompositeOpen,t=>({composite:t,viewContainerLocation:e}),s))),this.onDidPaneCompositeClose=at.tj.any(...ut.vf.map(e=>at.tj.map(this.paneCompositeParts.get(e).onDidPaneCompositeClose,t=>({composite:t,viewContainerLocation:e}),s)))}openPaneComposite(e,t,i){return this.getPartByLocation(t).openPaneComposite(e,i)}getActivePaneComposite(e){return this.getPartByLocation(e).getActivePaneComposite()}getPaneComposite(e,t){return this.getPartByLocation(t).getPaneComposite(e)}getPaneComposites(e){return this.getPartByLocation(e).getPaneComposites()}getPinnedPaneCompositeIds(e){return this.getPartByLocation(e).getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(e){return this.getPartByLocation(e).getVisiblePaneCompositeIds()}getPaneCompositeIds(e){return this.getPartByLocation(e).getPaneCompositeIds()}getProgressIndicator(e,t){return this.getPartByLocation(t).getProgressIndicator(e)}hideActivePaneComposite(e){this.getPartByLocation(e).hideActivePaneComposite()}getLastActivePaneCompositeId(e){return this.getPartByLocation(e).getLastActivePaneCompositeId()}getPartByLocation(e){return(0,at.UM)(this.paneCompositeParts.get(e))}};Bd=(0,at.Jb)([(0,at.Yb)(0,at.rx)],Bd),(0,at.TM)();var Pd={open:(0,at.EM)(1926,"open"),close:(0,at.EM)(1927,"close"),find:(0,at.EM)(1928,"find")};(0,at.Xb)(),(0,at.oS)(),(0,at.SE)(),(0,at.AN)(),(0,at.iM)(),(0,at.Il)(),(0,at.ps)(),(0,ut.wd)(),(0,at.gb)(),(0,at.Mb)(),(0,bt.b)(),(0,bt.L)(),(0,bt.z)();var Fd=class{constructor(e,t,i,o){this.fileService=e,this.environmentService=t,this.lifecycleService=i,this.logService=o}async getLogs(){return(0,ut.Cd)(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(bt.M.Restored),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await at.jb.as(bt.v.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){let i=at.wE.document.querySelector(e);if(!i)return Promise.reject(Error("Element not found: ".concat(e)));let o=i;o.value=t;let s=new Event("input",{bubbles:!0,cancelable:!0});o.dispatchEvent(s)}async isActiveElement(e){if(at.wE.document.querySelector(e)!==at.wE.document.activeElement){let t=[],i=at.wE.document.activeElement;for(;i;){let e=i.tagName,o=i.id?"#".concat(i.id):"",s=(0,at._N)(i.className.split(/\s+/g).map(e=>e.trim())).map(e=>".".concat(e)).join("");t.unshift("".concat(e).concat(o).concat(s)),i=i.parentElement}throw Error("Active element not found. Current active element is '".concat(t.join(" > "),"'. Looking for ").concat(e))}return!0}async getElements(e,t){let i=at.wE.document.querySelectorAll(e),o=[];for(let s=0;s<i.length;s++){let e=i.item(s);o.push(this.serializeElement(e,t))}return o}serializeElement(e,t){let i=Object.create(null);for(let n=0;n<e.attributes.length;n++){let t=e.attributes.item(n);t&&(i[t.name]=t.value)}let o=[];if(t)for(let n=0;n<e.children.length;n++){let t=e.children.item(n);t&&o.push(this.serializeElement(t,!0))}let{left:s,top:r}=(0,at.Xx)(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:i,children:o,left:s,top:r}}async getElementXY(e,t,i){let o="number"==typeof t&&"number"==typeof i?{x:t,y:i}:void 0;return this._getElementXY(e,o)}async typeInEditor(e,t){let i=at.wE.document.querySelector(e);if(!i)throw Error("Editor not found: ".concat(e));if((0,at.gS)(i)){let o=i.editContext;if(!o)throw Error("Edit context not found: ".concat(e));let s=o.selectionStart,r=o.selectionEnd,n=new TextUpdateEvent("textupdate",{updateRangeStart:s,updateRangeEnd:r,text:t,selectionStart:s+t.length,selectionEnd:s+t.length,compositionStart:0,compositionEnd:0});o.dispatchEvent(n)}else if((0,at.yS)(i)){let e=i.selectionStart,o=e+t.length,s=i.value;i.value=s.substr(0,e)+t+s.substr(e),i.setSelectionRange(o,o);let r=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(r)}}async getEditorSelection(e){let t=at.wE.document.querySelector(e);if(!t)throw Error("Editor not found: ".concat(e));if((0,at.gS)(t)){let i=t.editContext;if(!i)throw Error("Edit context not found: ".concat(e));return{selectionStart:i.selectionStart,selectionEnd:i.selectionEnd}}if((0,at.yS)(t))return{selectionStart:t.selectionStart,selectionEnd:t.selectionEnd};throw Error("Unknown type of element: ".concat(e))}async getTerminalBuffer(e){let t=at.wE.document.querySelector(e);if(!t)throw Error("Terminal not found: ".concat(e));let i=t.xterm;if(!i)throw Error("Xterm not found: ".concat(e));let o=[];for(let s=0;s<i.buffer.active.length;s++)o.push(i.buffer.active.getLine(s).translateToString(!0));return o}async writeInTerminal(e,t){let i=at.wE.document.querySelector(e);if(!i)throw Error("Element not found: ".concat(e));let o=i.xterm;if(!o)throw Error("Xterm not found: ".concat(e));o.input(t)}getLocaleInfo(){return Promise.resolve({language:at.bM,locale:at.xM})}getLocalizedStrings(){return Promise.resolve({open:Pd.open,close:Pd.close,find:Pd.find})}async _getElementXY(e,t){let i=at.wE.document.querySelector(e);if(!i)return Promise.reject(Error("Element not found: ".concat(e)));let o,s,{left:r,top:n}=(0,at.Xx)(i),{width:a,height:d}=(0,at.Vx)(i);return t?(o=r+t.x,s=n+t.y):(o=r+a/2,s=n+d/2),o=Math.round(o),s=Math.round(s),{x:o,y:s}}};Fd=(0,at.Jb)([(0,at.Yb)(0,at.fs),(0,at.Yb)(1,at.Fl),(0,at.Yb)(2,bt.R),(0,at.Yb)(3,at.mb)],Fd),(0,at.Xb)(),(0,at.oE)(),(0,at.oS)(),(0,at.Pp)(),(0,at.Ww)(),(0,at.sj)(),(0,at.wj)(),(0,at.ET)(),(0,at.iM)(),(0,at.Wd)(),(0,at.SO)(),(0,at.TM)(),(0,at.Ib)(),(0,at.Vl)(),(0,at.ox)(),(0,at.Ua)(),(0,at.hl)(),(0,pt.Gt)(),(0,vt.n)(),(0,pt.st)(),(0,bt.L)(),(0,bt.z)(),(0,dt.z)(),(0,at.SE)(),(0,at.Gj)(),(0,at.i_)(),(0,bt.k)(),(0,at.Vc)();var Yd,Qd=(re=class extends at.mj{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{getWindowsCount:at.rS,getWindows:at.nS},i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;super(),this.hostService=i,this.environmentService=o,this.enableWindowFocusOnElementFocus(e),this.enableMultiWindowAwareTimeout(e,t),this.registerFullScreenListeners(e.vscodeWindowId)}enableWindowFocusOnElementFocus(e){let t=e.HTMLElement.prototype.focus,i=this;e.HTMLElement.prototype.focus=function(e){i.onElementFocus((0,at.$x)(this)),t.apply(this,[e])}}onElementFocus(e){let t=(0,at.Bx)();t!==e&&t.document.hasFocus()&&(e.focus(),!this.environmentService.extensionTestsLocationURI&&!e.document.hasFocus()&&this.hostService.focus(e))}enableMultiWindowAwareTimeout(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{getWindowsCount:at.rS,getWindows:at.nS};function i(e){return e===at.wE?window:e}let o=i(e).setTimeout;Object.defineProperty(i(e),"vscodeOriginalSetTimeout",{get:()=>o});let s=i(e).clearTimeout;Object.defineProperty(i(e),"vscodeOriginalClearTimeout",{get:()=>s}),i(e).setTimeout=function(s){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,a=new Array(n>2?n-2:0),d=2;d<n;d++)a[d-2]=arguments[d];if(1===t.getWindowsCount()||"string"==typeof s||0===r)return o.apply(this,[s,r,...a]);let l=new Set,c=Yd.TIMEOUT_HANDLES++;Yd.TIMEOUT_DISPOSABLES.set(c,l);let h=(0,at.Wj)(s,()=>{(0,at.Sj)(l),Yd.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:o,disposables:u}of t.getWindows()){if((0,at.CE)(o)&&"hidden"===o.document.visibilityState)continue;let t=!1,s=i(e).vscodeOriginalSetTimeout.apply(this,[function(){t||h(...arguments)},r,...a]),n=(0,at.kj)(()=>{t=!0,i(e).vscodeOriginalClearTimeout(s),l.delete(n)});u.add(n),l.add(n)}return c},i(e).clearTimeout=function(e){let t="number"==typeof e?Yd.TIMEOUT_DISPOSABLES.get(e):void 0;t?((0,at.Sj)(t),Yd.TIMEOUT_DISPOSABLES.delete(e)):s.apply(this,[e])}}registerFullScreenListeners(e){this._register(this.hostService.onDidChangeFullScreen(t=>{let{windowId:i,fullscreen:o}=t;if(i===e){let t=(0,at.eS)(e);t&&(0,at._E)(o,t.window)}}))}static async confirmOnShutdown(e,t){let i=e.get(at.zl),o=e.get(at.r_),s=t===bt.P.QUIT?at.pM?(0,at.EM)(3619,"Are you sure you want to quit?"):(0,at.EM)(3620,"Are you sure you want to exit?"):(0,at.EM)(3621,"Are you sure you want to close the window?"),r=t===bt.P.QUIT?at.pM?(0,at.EM)(3622,"&&Quit"):(0,at.EM)(3623,"&&Exit"):(0,at.EM)(3624,"&&Close Window"),n=await i.confirm({message:s,primaryButton:r,checkbox:{label:(0,at.EM)(3625,"Do not ask me again")}});return n.confirmed&&n.checkboxChecked&&await o.updateValue("window.confirmBeforeClose","never"),n.confirmed}},{_:Yd=re},{_:re.TIMEOUT_HANDLES=-(2**53-1)},{_:re.TIMEOUT_DISPOSABLES=new Map},re);Qd=Yd=(0,at.Jb)([(0,at.Yb)(2,dt.R),(0,at.Yb)(3,bt.O)],Qd);var Xd,Hd,Ud=class extends Qd{constructor(e,t,i,o,s,r,n,a,d){super(at.wE,void 0,d,r),this.openerService=e,this.lifecycleService=t,this.dialogService=i,this.labelService=o,this.productService=s,this.browserEnvironmentService=r,this.layoutService=n,this.instantiationService=a,this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let e=at.uM&&at.wE.visualViewport?at.wE.visualViewport:at.wE;this._register((0,at.Sx)(e,at._x.RESIZE,()=>{this.layoutService.layout(),at.uM&&at.wE.scrollTo(0,0)})),this._register((0,at.Sx)(this.layoutService.mainContainer,at._x.WHEEL,e=>e.preventDefault(),{passive:!1})),this._register((0,at.Sx)(this.layoutService.mainContainer,at._x.CONTEXT_MENU,e=>at.gx.stop(e,!0))),this._register((0,at.Sx)(this.layoutService.mainContainer,at._x.DROP,e=>at.gx.stop(e,!0)))}onWillShutdown(){at.tj.toPromise(at.tj.any(at.tj.once(new at.Np(at.wE.document.body,at._x.KEY_DOWN,!0).event),at.tj.once(new at.Np(at.wE.document.body,at._x.MOUSE_DOWN,!0).event))).then(async()=>{await(0,at.$w)(3e3),await this.dialogService.prompt({type:at.Ud.Error,message:(0,at.EM)(3626,"An unexpected error occurred that requires a reload of this page."),detail:(0,at.EM)(3627,"The workbench was unexpectedly disposed while running."),buttons:[{label:(0,at.EM)(3628,"&&Reload"),run:()=>at.wE.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&function(e){Object.assign(at.wE,{driver:e.createInstance(Fd)})}(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async e=>{var t;let i=!1;if(null!==(t=this.browserEnvironmentService.options)&&void 0!==t&&t.openerAllowedExternalUrlPrefixes)for(let o of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(e.startsWith(o)){i=!0;break}if((0,at.DT)(e,at.TT.http)||(0,at.DT)(e,at.TT.https))at.dE?(0,at.KS)(e,!i)||await this.dialogService.prompt({type:at.Ud.Warning,message:(0,at.EM)(3629,"The browser blocked opening a new tab or window. Press 'Retry' to try again."),custom:{markdownDetails:[{markdown:new at.Bc((0,at.EM)(3630,"Please allow pop-ups for this website in your [browser settings]({0}).","https://aka.ms/allow-vscode-popup"),!0)}]},buttons:[{label:(0,at.EM)(3631,"&&Retry"),run:()=>i?(0,at.GS)(e):(0,at.WS)(e)}],cancelButton:!0}):i?(0,at.GS)(e):(0,at.WS)(e);else{let t=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>at.wE.location.href=e)};t();let i=async()=>{let e,{downloadUrl:o}=this.productService,s=[{label:(0,at.EM)(3632,"&&Try Again"),run:()=>t()}];void 0===o?e=(0,at.EM)(3635,"We launched {0} on your computer.\n\nIf {1} did not launch, try again below.",this.productService.nameLong,this.productService.nameLong):(e=(0,at.EM)(3633,"We launched {0} on your computer.\n\nIf {1} did not launch, try again or install it below.",this.productService.nameLong,this.productService.nameLong),s.push({label:(0,at.EM)(3634,"&&Install"),run:async()=>{await this.openerService.open(at.xO.parse(o)),i()}})),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:at.Ud.Info,message:(0,at.EM)(3636,"All done. You can close this tab now."),detail:e,buttons:s,cancelButton:!0}))};(0,at.DT)(e,this.productService.urlProtocol)&&await i()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:at.TT.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){at.Fb.registerCommand("workbench.experimental.requestUsbDevice",async(e,t)=>async function(e){var t;let i=navigator.usb;if(!i)return;let o=await i.requestDevice({filters:null!==(t=null===e||void 0===e?void 0:e.filters)&&void 0!==t?t:[]});return o?{deviceClass:o.deviceClass,deviceProtocol:o.deviceProtocol,deviceSubclass:o.deviceSubclass,deviceVersionMajor:o.deviceVersionMajor,deviceVersionMinor:o.deviceVersionMinor,deviceVersionSubminor:o.deviceVersionSubminor,manufacturerName:o.manufacturerName,productId:o.productId,productName:o.productName,serialNumber:o.serialNumber,usbVersionMajor:o.usbVersionMajor,usbVersionMinor:o.usbVersionMinor,usbVersionSubminor:o.usbVersionSubminor,vendorId:o.vendorId}:void 0}(t)),at.Fb.registerCommand("workbench.experimental.requestSerialPort",async(e,t)=>async function(e){var t;let i=navigator.serial;if(!i)return;let o=await i.requestPort({filters:null!==(t=null===e||void 0===e?void 0:e.filters)&&void 0!==t?t:[]});if(!o)return;let s=o.getInfo();return{usbVendorId:s.usbVendorId,usbProductId:s.usbProductId}}(t)),at.Fb.registerCommand("workbench.experimental.requestHidDevice",async(e,t)=>async function(e){var t;let i=navigator.hid;if(!i)return;let o=await i.requestDevice({filters:null!==(t=null===e||void 0===e?void 0:e.filters)&&void 0!==t?t:[]});if(!o.length)return;let s=o[0];return{opened:s.opened,vendorId:s.vendorId,productId:s.productId,productName:s.productName,collections:s.collections}}(t))}};Ud=(0,at.Jb)([(0,at.Yb)(0,at.ml),(0,at.Yb)(1,bt.R),(0,at.Yb)(2,at.zl),(0,at.Yb)(3,at.Ha),(0,at.Yb)(4,pt.Wt),(0,at.Yb)(5,vt.t),(0,at.Yb)(6,pt.ot),(0,at.Yb)(7,at.rx),(0,at.Yb)(8,dt.R)],Ud),(0,at.Xb)(),(0,at.oE)(),(0,at.oS)(),(0,at.Wg)(),(0,at.SE)(),(0,at.AN)(),(0,at.Ww)(),(0,at.aP)(),(0,at.sj)(),(0,at.Vc)(),(0,at.wj)(),(0,at.cc)(),(0,at.iM)(),(0,at.Wd)(),(0,at.TM)(),(0,at.i_)(),(0,at.Vl)(),(0,at.Jp)(),(0,at.yb)(),(0,at.yi)(),(0,bt.k)(),(0,dt.z)(),(0,pt.st)(),(0,at.ox)(),function(e){e[e.Maximized=0]="Maximized",e[e.Normal=1]="Normal",e[e.Fullscreen=2]="Fullscreen"}(Hd||(Hd={}));var jd=new at.mx(at.ii.width,at.ii.height),zd=class extends Qd{constructor(e,t,i,o,s,r){super(e,void 0,s,r),this.window=e,this.container=t,this.configurationService=o,this._onWillLayout=this._register(new at.ej),this.onWillLayout=this._onWillLayout.event,this._onDidLayout=this._register(new at.ej),this.onDidLayout=this._onDidLayout.event,this._onBeforeUnload=this._register(new at.ej),this.onBeforeUnload=this._onBeforeUnload.event,this._onUnload=this._register(new at.ej),this.onUnload=this._onUnload.event,this._onWillDispose=this._register(new at.ej),this.onWillDispose=this._onWillDispose.event,this.compact=!1,this.whenStylesHaveLoaded=i.wait().then(()=>{}),this.registerListeners()}updateOptions(e){this.compact=e.compact}registerListeners(){this._register((0,at.Sx)(this.window,at._x.BEFORE_UNLOAD,e=>this.handleBeforeUnload(e))),this._register((0,at.Sx)(this.window,at._x.UNLOAD,()=>this.handleUnload())),this._register((0,at.Sx)(this.window,"unhandledrejection",e=>{(0,at.sP)(e.reason),e.preventDefault()})),this._register((0,at.Sx)(this.window,at._x.RESIZE,()=>this.layout())),this._register((0,at.Sx)(this.container,at._x.SCROLL,()=>this.container.scrollTop=0)),at._M?(this._register((0,at.Sx)(this.container,at._x.DROP,e=>at.gx.stop(e,!0))),this._register((0,at.Sx)(this.container,at._x.WHEEL,e=>e.preventDefault(),{passive:!1})),this._register((0,at.Sx)(this.container,at._x.CONTEXT_MENU,e=>at.gx.stop(e,!0)))):(this._register((0,at.Sx)(this.window.document.body,at._x.DRAG_OVER,e=>at.gx.stop(e))),this._register((0,at.Sx)(this.window.document.body,at._x.DROP,e=>at.gx.stop(e)))),this._register((0,at.Sx)(window,at._x.UNLOAD,()=>{var e;null===(e=this.window)||void 0===e||e.close()}))}handleBeforeUnload(e){let t;if(this._onBeforeUnload.fire({veto(e){e&&(t=e)}}),t)return void this.handleVetoBeforeClose(e,t);let i=this.configurationService.getValue("window.confirmBeforeClose");("always"===i||"keyboardOnly"===i&&at.vx.getInstance().isModifierPressed)&&this.confirmBeforeClose(e)}handleVetoBeforeClose(e,t){this.preventUnload(e)}preventUnload(e){e.preventDefault(),e.returnValue=(0,at.EM)(13085,"Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(e){this.preventUnload(e)}handleUnload(){this._onUnload.fire()}layout(){let e=(0,at.Vx)(this.window.document.body,jd,this.container);this._onWillLayout.fire(e),this._onDidLayout.fire(e)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:(0,at.aE)(this.window),compact:this.compact}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};zd=(0,at.Jb)([(0,at.Yb)(3,at.r_),(0,at.Yb)(4,dt.R),(0,at.Yb)(5,bt.O)],zd);var qd=(ne=class extends at.mj{constructor(e,t,i,o,s,r){super(),this.layoutService=e,this.dialogService=t,this.configurationService=i,this.telemetryService=o,this.hostService=s,this.environmentService=r,this._onDidOpenAuxiliaryWindow=this._register(new at.ej),this.onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event,this.windows=new Map}async open(e){var t;(0,at.lc)("code/auxiliaryWindow/willOpen");let i=await this.openWindow(e);if(!i)throw Error((0,at.EM)(13086,"Unable to open a new window."));(0,at.xE)(i,await this.resolveWindowId(i));let o=new at.gj,{container:s,stylesLoaded:r}=this.createContainer(i,o,e),n=this.createAuxiliaryWindow(i,s,r);n.updateOptions({compact:null!==(t=null===e||void 0===e?void 0:e.compact)&&void 0!==t&&t});let a=new at.gj;this.windows.set(i.vscodeWindowId,n),a.add((0,at.kj)(()=>this.windows.delete(i.vscodeWindowId)));let d=new at.gj;return at.tj.once(n.onWillDispose)(()=>{i.close(),o.dispose(),a.dispose(),d.dispose()}),a.add((0,at.AS)(i)),this._onDidOpenAuxiliaryWindow.fire({window:n,disposables:d}),(0,at.lc)("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!(null===e||void 0===e||!e.bounds)}),n}createAuxiliaryWindow(e,t,i){return new zd(e,t,i,this.configurationService,this.hostService,this.environmentService)}async openWindow(e){var t,i,o,s,r,n,a,d;let l=(0,at.Bx)(),c=l.screenX,h=l.screenY,u=l.outerWidth,g=l.outerHeight,p=at.ii,b=Math.max(null!==(t=null===e||void 0===e||null===(i=e.bounds)||void 0===i?void 0:i.width)&&void 0!==t?t:p.width,at.fi.WIDTH),m=Math.max(null!==(o=null===e||void 0===e||null===(s=e.bounds)||void 0===s?void 0:s.height)&&void 0!==o?o:p.height,at.fi.HEIGHT),v={x:null!==(r=null===e||void 0===e||null===(n=e.bounds)||void 0===n?void 0:n.x)&&void 0!==r?r:Math.max(c+u/2-b/2,0),y:null!==(a=null===e||void 0===e||null===(d=e.bounds)||void 0===d?void 0:d.y)&&void 0!==a?a:Math.max(h+g/2-m/2,0),width:b,height:m};(null===e||void 0===e||!e.bounds)&&v.x===c&&v.y===h&&(v=(0,rt.A)((0,rt.A)({},v),{},{x:v.x+30,y:v.y+30}));let C=(0,at._N)(["popup=yes","left=".concat(v.x),"top=".concat(v.y),"width=".concat(v.width),"height=".concat(v.height),null!==e&&void 0!==e&&e.nativeTitlebar?"window-native-titlebar=yes":void 0,null!==e&&void 0!==e&&e.disableFullscreen?"window-disable-fullscreen=yes":void 0,null!==e&&void 0!==e&&e.alwaysOnTop?"window-always-on-top=yes":void 0,(null===e||void 0===e?void 0:e.mode)===Hd.Maximized?"window-maximized=yes":void 0,(null===e||void 0===e?void 0:e.mode)===Hd.Fullscreen?"window-fullscreen=yes":void 0]),w=at.wE.open(at.lM?"":"about:blank",void 0,C.join(","));return!w&&at._M?(await this.dialogService.prompt({type:at.Ud.Warning,message:(0,at.EM)(13087,"The browser blocked opening a new window. Press 'Retry' to try again."),custom:{markdownDetails:[{markdown:new at.Bc((0,at.EM)(13088,"Please allow pop-ups for this website in your [browser settings]({0}).","https://aka.ms/allow-vscode-popup"),!0)}]},buttons:[{label:(0,at.EM)(13089,"&&Retry"),run:()=>this.openWindow(e)}],cancelButton:!0})).result:null===w||void 0===w?void 0:w.window}async resolveWindowId(e){return Xd.WINDOW_IDS++}createContainer(e,t,i){this.applyMeta(e);let{stylesLoaded:o}=this.applyCSS(e,t);return{stylesLoaded:o,container:this.applyHTML(e,t)}}applyMeta(e){for(let i of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let t=at.wE.document.querySelector(i);if(t){let o=(0,at.Px)(e.document.head);if((0,at.Ax)(t,o),'meta[http-equiv="Content-Security-Policy"]'===i){let e=o.getAttribute("content");e&&o.setAttribute("content",e.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let t=at.wE.document.querySelector('link[rel="icon"]');t&&(0,at.Ax)(t,(0,at.Nx)(e.document.head))}applyCSS(e,t){(0,at.lc)("code/auxiliaryWindow/willApplyCSS"),e.document.adoptedStyleSheets=[...e.document.adoptedStyleSheets,...(null!==at.Jg&&void 0!==at.Jg?at.Jg:at.wE.document).adoptedStyleSheets.map(t=>{let i=new e.CSSStyleSheet;for(let e of t.cssRules)i.insertRule(e.cssText);return i})];let i=new Map,o=new at.bw;o.wait().then(()=>(0,at.lc)("code/auxiliaryWindow/didLoadCSSStyles"));let s=t.add(new at.gj),r=0;function n(){0===--r&&(s.dispose(),o.open())}function a(t){if((0,at.Gg)(t))return;let o=e.document.head.appendChild(t.cloneNode(!0));"link"===t.tagName.toLowerCase()&&(r++,s.add((0,at.Sx)(o,"load",n)),s.add((0,at.Sx)(o,"error",n))),i.set(t,o)}r++;try{for(let e of at.wE.document.head.querySelectorAll('link[rel="stylesheet"], style'))a(e)}finally{n()}return t.add((0,at.Bg)(e)),t.add(at.zS.observe(at.wE.document.head,t,{childList:!0,subtree:!0})(e=>{for(let o of e)if("childList"===o.type&&"title"!==o.target.nodeName.toLowerCase()&&"script"!==o.target.nodeName.toLowerCase()&&"meta"!==o.target.nodeName.toLowerCase()){for(let e of o.addedNodes)if(!(0,at._S)(e)||"style"!==e.tagName.toLowerCase()&&"link"!==e.tagName.toLowerCase()){if(e.nodeType===Node.TEXT_NODE&&e.parentNode){let t=i.get(e.parentNode);t&&(t.textContent=e.textContent)}}else a(e);for(let e of o.removedNodes){var t;let o=i.get(e);o&&(null!==(t=o.parentNode)&&void 0!==t&&t.removeChild(o),i.delete(e))}}})),(0,at.lc)("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:o}}applyHTML(e,t){(0,at.lc)("code/auxiliaryWindow/willApplyHTML");let i=(0,at.px)("div",{role:"application"});return(0,at.OS)(i,0,0,0,0,"relative"),i.style.display="flex",i.style.height="100%",i.style.flexDirection="column",e.document.body.append(i),t.add((0,at.HS)(at.wE.document.documentElement,e.document.documentElement)),t.add((0,at.HS)(at.wE.document.body,e.document.body)),t.add((0,at.HS)(this.layoutService.mainContainer,i,["class"])),(0,at.lc)("code/auxiliaryWindow/didApplyHTML"),i}getWindow(e){return this.windows.get(e)}},{_:Xd=ne},{_:ne.WINDOW_IDS=(0,at.tS)(at.wE)+1},ne);qd=Xd=(0,at.Jb)([(0,at.Yb)(0,pt.ot),(0,at.Yb)(1,at.zl),(0,at.Yb)(2,at.r_),(0,at.Yb)(3,at.vb),(0,at.Yb)(4,dt.R),(0,at.Yb)(5,bt.O)],qd),(0,at.Xb)(),(0,pt.Nt)(),(0,at.Ol)(),(0,ut.yb)(),(0,at.yb)(),(0,at.Xd)(),(0,at.ox)(),(0,at.Lo)(),(0,at.Ma)(),(0,ut.N)(),(0,at.i_)(),(0,pt.st)(),(0,at.gb)();var $d=class extends ut.A{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u){super(e,{mergeViewWithContainerWhenSingleView:!1},n,i,o,d,s,l,a,r,c,h,u),this.constantViewDescriptors=new Map,this.allViews=new Map,this._register(t(e=>{this.filterValue=e,this.onFilterChanged(e)})),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>{this.updateAllViews(this.viewContainerModel.activeViewDescriptors)}))}updateAllViews(e){e.forEach(e=>{let t=this.getFilterOn(e);t&&(this.allViews.has(t)||this.allViews.set(t,new Map),this.allViews.get(t).set(e.id,e),this.filterValue&&!this.filterValue.includes(t)&&this.panes.find(t=>t.id===e.id)&&this.viewContainerModel.setVisible(e.id,!1))})}addConstantViewDescriptors(e){e.forEach(e=>this.constantViewDescriptors.set(e.id,e))}onFilterChanged(e){0===this.allViews.size&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),this.getViewsNotForTarget(e).forEach(e=>this.viewContainerModel.setVisible(e.id,!1)),this.getViewsForTarget(e).forEach(e=>this.viewContainerModel.setVisible(e.id,!0))}getViewsForTarget(e){let t=[];for(let i=0;i<e.length;i++)this.allViews.has(e[i])&&t.push(...Array.from(this.allViews.get(e[i]).values()));return t}getViewsNotForTarget(e){let t=this.allViews.keys(),i=t.next(),o=[];for(;!i.done;){let s=!1;e.forEach(e=>{i.value===e&&(s=!0)}),s||(o=o.concat(this.getViewsForTarget([i.value]))),i=t.next()}return o}onDidAddViewDescriptors(e){let t=super.onDidAddViewDescriptors(e);for(let i=0;i<e.length;i++)this.constantViewDescriptors.has(e[i].viewDescriptor.id)&&t[i].setExpanded(!1);return 0===this.allViews.size&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),t}openView(e,t){let i=super.openView(e,t);if(i){var o;let t=Array.from(this.allViews.entries()).find(t=>t[1].has(e));t&&(null===(o=this.filterValue)||void 0===o||!o.includes(t[0]))&&this.setFilter(t[1].get(e))}return i}};$d=(0,at.Jb)([(0,at.Yb)(2,at.r_),(0,at.Yb)(3,pt.ot),(0,at.Yb)(4,at.vb),(0,at.Yb)(5,at.Io),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.Yd),(0,at.Yb)(8,at.El),(0,at.Yb)(9,pt.Mt),(0,at.Yb)(10,at.ja),(0,at.Yb)(11,ut.vb),(0,at.Yb)(12,at.mb)],$d),(0,at.Xb)(),(0,at.wj)(),(0,ut.xf)(),(0,ut.yb)(),(0,pt.tr)(),(0,at.Mb)(),(0,at.Lo)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.sj)(),(0,at.GM)(),(0,at.Tb)(),(0,at.TM)(),(0,at.Ab)(),(0,at.Jp)(),(0,at.ox)(),(0,at.yb)(),(0,at.Xd)(),(0,at.Ol)(),(0,pt.Nt)(),(0,at.Ma)(),(0,pt.W)(),(0,pt.st)(),(0,at.SO)(),(0,vt.c)(),(0,bt.G)(),(0,pt.kt)(),(0,bt.At)(),(0,ut.vg)();var el=class extends at.mj{constructor(e,t,i,o,s){super(),this.viewDescriptorService=e,this.paneCompositeService=t,this.contextKeyService=i,this.layoutService=o,this.editorService=s,this._onDidChangeViewVisibility=this._register(new at.ej),this.onDidChangeViewVisibility=this._onDidChangeViewVisibility.event,this._onDidChangeViewContainerVisibility=this._register(new at.ej),this.onDidChangeViewContainerVisibility=this._onDidChangeViewContainerVisibility.event,this._onDidChangeFocusedView=this._register(new at.ej),this.onDidChangeFocusedView=this._onDidChangeFocusedView.event,this.viewContainerDisposables=this._register(new at.hj),this.viewDisposable=new Map,this.enabledViewContainersContextKeys=new Map,this.visibleViewContextKeys=new Map,this.viewPaneContainers=new Map,this._register((0,at.kj)(()=>{this.viewDisposable.forEach(e=>e.dispose()),this.viewDisposable.clear()})),this.viewDescriptorService.viewContainers.forEach(e=>this.onDidRegisterViewContainer(e,this.viewDescriptorService.getViewContainerLocation(e))),this._register(this.viewDescriptorService.onDidChangeViewContainers(e=>{let{added:t,removed:i}=e;return this.onDidChangeContainers(t,i)})),this._register(this.viewDescriptorService.onDidChangeContainerLocation(e=>{let{viewContainer:t,from:i,to:o}=e;return this.onDidChangeContainerLocation(t,i,o)})),this._register(this.paneCompositeService.onDidPaneCompositeOpen(e=>this._onDidChangeViewContainerVisibility.fire({id:e.composite.getId(),visible:!0,location:e.viewContainerLocation}))),this._register(this.paneCompositeService.onDidPaneCompositeClose(e=>this._onDidChangeViewContainerVisibility.fire({id:e.composite.getId(),visible:!1,location:e.viewContainerLocation}))),this.focusedViewContextKey=pt.yn.bindTo(i)}onViewsAdded(e){for(let t of e)this.onViewsVisibilityChanged(t,t.isBodyVisible())}onViewsVisibilityChanged(e,t){this.getOrCreateActiveViewContextKey(e).set(t),this._onDidChangeViewVisibility.fire({id:e.id,visible:t})}onViewsRemoved(e){for(let t of e)this.onViewsVisibilityChanged(t,!1)}getOrCreateActiveViewContextKey(e){let t=(0,pt.er)(e.id),i=this.visibleViewContextKeys.get(t);return i||(i=new at.Nk(t,!1).bindTo(this.contextKeyService),this.visibleViewContextKeys.set(t,i)),i}onDidChangeContainers(e,t){for(let{container:i,location:o}of t)this.onDidDeregisterViewContainer(i,o);for(let{container:i,location:o}of e)this.onDidRegisterViewContainer(i,o)}onDidRegisterViewContainer(e,t){this.registerPaneComposite(e,t);let i=new at.gj,o=this.viewDescriptorService.getViewContainerModel(e);this.onViewDescriptorsAdded(o.allViewDescriptors,e),i.add(o.onDidChangeAllViewDescriptors(t=>{let{added:i,removed:o}=t;this.onViewDescriptorsAdded(i,e),this.onViewDescriptorsRemoved(o)})),this.updateViewContainerEnablementContextKey(e),i.add(o.onDidChangeActiveViewDescriptors(()=>this.updateViewContainerEnablementContextKey(e))),i.add(this.registerOpenViewContainerAction(e)),this.viewContainerDisposables.set(e.id,i)}onDidDeregisterViewContainer(e,t){this.deregisterPaneComposite(e,t),this.viewContainerDisposables.deleteAndDispose(e.id)}onDidChangeContainerLocation(e,t,i){this.deregisterPaneComposite(e,t),this.registerPaneComposite(e,i),this.layoutService.isVisible(ol(i))&&1===this.viewDescriptorService.getViewContainersByLocation(i).filter(e=>this.isViewContainerActive(e.id)).length&&this.openViewContainer(e.id)}onViewDescriptorsAdded(e,t){if(null!==this.viewDescriptorService.getViewContainerLocation(t))for(let i of e){let e=new at.gj;e.add(this.registerOpenViewAction(i)),e.add(this.registerFocusViewAction(i,t.title)),e.add(this.registerResetViewLocationAction(i)),this.viewDisposable.set(i,e)}}onViewDescriptorsRemoved(e){for(let t of e){let e=this.viewDisposable.get(t);e&&(e.dispose(),this.viewDisposable.delete(t))}}updateViewContainerEnablementContextKey(e){let t=this.enabledViewContainersContextKeys.get(e.id);t||(t=this.contextKeyService.createKey(tl(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,t)),t.set(!(e.hideIfEmpty&&0===this.viewDescriptorService.getViewContainerModel(e).activeViewDescriptors.length))}async openComposite(e,t,i){return this.paneCompositeService.openPaneComposite(e,t,i)}getComposite(e,t){return this.paneCompositeService.getPaneComposite(e,t)}isViewContainerVisible(e){var t;let i=this.viewDescriptorService.getViewContainerById(e);if(!i)return!1;let o=this.viewDescriptorService.getViewContainerLocation(i);return null!==o&&(null===(t=this.paneCompositeService.getActivePaneComposite(o))||void 0===t?void 0:t.getId())===e}isViewContainerActive(e){let t=this.viewDescriptorService.getViewContainerById(e);return!!t&&(!t.hideIfEmpty||this.viewDescriptorService.getViewContainerModel(t).activeViewDescriptors.length>0)}getVisibleViewContainer(e){var t;let i=null===(t=this.paneCompositeService.getActivePaneComposite(e))||void 0===t?void 0:t.getId();return i?this.viewDescriptorService.getViewContainerById(i):null}getActiveViewPaneContainerWithId(e){let t=this.viewDescriptorService.getViewContainerById(e);return t?this.getActiveViewPaneContainer(t):null}async openViewContainer(e,t){let i=this.viewDescriptorService.getViewContainerById(e);if(i){let o=this.viewDescriptorService.getViewContainerLocation(i);if(null!==o)return await this.paneCompositeService.openPaneComposite(e,o,t)||null}return null}async closeViewContainer(e){let t=this.viewDescriptorService.getViewContainerById(e);if(t){let e=this.viewDescriptorService.getViewContainerLocation(t),i=null!==e&&this.paneCompositeService.getActivePaneComposite(e);if(null!==e)return i?this.layoutService.setPartHidden(!0,ol(e)):void 0}}isViewVisible(e){var t;return(null===(t=this.getActiveViewWithId(e))||void 0===t?void 0:t.isBodyVisible())||!1}getActiveViewWithId(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){let i=this.getActiveViewPaneContainer(t);if(i)return i.getView(e)}return null}getViewWithId(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){let i=this.viewPaneContainers.get(t.id);if(i)return i.getView(e)}return null}getFocusedView(){var e;let t=null!==(e=this.contextKeyService.getContextKeyValue(pt.yn.key))&&void 0!==e?e:"";return this.viewDescriptorService.getViewDescriptorById(t.toString())}getFocusedViewName(){var e,t,i,o;let s=null!==(e=this.editorService.activeTextEditorControl)&&void 0!==e&&e.hasTextFocus()?(0,at.EM)(13947,"Text Editor"):void 0;return null!==(t=null!==(i=null===(o=this.getFocusedView())||void 0===o||null===(o=o.name)||void 0===o?void 0:o.value)&&void 0!==i?i:s)&&void 0!==t?t:""}async openView(e,t){let i=this.viewDescriptorService.getViewContainerByViewId(e);if(!i||!this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.some(t=>t.id===e))return null;let o=this.viewDescriptorService.getViewContainerLocation(i),s=this.getComposite(i.id,o);if(s){let i=await this.openComposite(s.id,o);if(i&&i.openView)return i.openView(e,t)||null;t&&(null===i||void 0===i||i.focus())}return null}closeView(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){let i=this.getActiveViewPaneContainer(t);if(i){let o=i.getView(e);if(o)if(1===i.views.length){let i=this.viewDescriptorService.getViewContainerLocation(t);i===ut.gf.Sidebar?this.layoutService.setPartHidden(!0,pt.V.SIDEBAR_PART):(i===ut.gf.Panel||i===ut.gf.AuxiliaryBar)&&this.paneCompositeService.hideActivePaneComposite(i),this.focusedViewContextKey.get()===e&&this.focusedViewContextKey.reset()}else o.setExpanded(!1)}}}getActiveViewPaneContainer(e){let t=this.viewDescriptorService.getViewContainerLocation(e);if(null===t)return null;let i=this.paneCompositeService.getActivePaneComposite(t);return(null===i||void 0===i?void 0:i.getId())===e.id&&i.getViewPaneContainer()||null}getViewProgressIndicator(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(!t)return;let i=this.viewPaneContainers.get(t.id);if(!i)return;let o=i.getView(e);return o?i.isViewMergedWithContainer()?this.getViewContainerProgressIndicator(t):o.getProgressIndicator():void 0}getViewContainerProgressIndicator(e){let t=this.viewDescriptorService.getViewContainerLocation(e);if(null!==t)return this.paneCompositeService.getProgressIndicator(e.id,t)}registerOpenViewContainerAction(e){let t=new at.gj;if(e.openCommandActionDescriptor){var i,o;let{id:s,mnemonicTitle:r,keybindings:n,order:a}=null!==(i=e.openCommandActionDescriptor)&&void 0!==i?i:{id:e.id},d=null!==(o=e.openCommandActionDescriptor.title)&&void 0!==o?o:e.title,l=this;if(t.add((0,at.Db)(class extends at.bb{constructor(){super({id:s,get title(){let t=l.viewDescriptorService.getViewContainerLocation(e),i="string"==typeof d?d:d.value,o="string"==typeof d?d:d.original;return t===ut.gf.Sidebar?{value:(0,at.EM)(13948,"Show {0}",i),original:"Show ".concat(o)}:{value:(0,at.EM)(13949,"Toggle {0}",i),original:"Toggle ".concat(o)}},category:vt.s.View,precondition:at.Mk.has(tl(e.id)),keybinding:n?(0,rt.A)((0,rt.A)({},n),{},{weight:at.Ob.WorkbenchContrib}):void 0,f1:!0})}async run(t){let i=t.get(bt.W),o=t.get(ut.vb),s=t.get(pt.ot),r=t.get(ut._g),n=o.getViewContainerLocation(e);switch(n){case ut.gf.AuxiliaryBar:case ut.gf.Sidebar:{let t=n===ut.gf.Sidebar?pt.V.SIDEBAR_PART:pt.V.AUXILIARYBAR_PART;r.isViewContainerVisible(e.id)&&s.hasFocus(t)?i.activeGroup.focus():await r.openViewContainer(e.id,!0);break}case ut.gf.Panel:r.isViewContainerVisible(e.id)&&s.hasFocus(pt.V.PANEL_PART)?r.closeViewContainer(e.id):await r.openViewContainer(e.id,!0)}}})),r){let i=this.viewDescriptorService.getDefaultViewContainerLocation(e);t.add(at.Cb.appendMenuItem(at.xb.MenubarViewMenu,{command:{id:s,title:r},group:i===ut.gf.Sidebar?"3_sidebar":i===ut.gf.AuxiliaryBar?"4_auxbar":"5_panel",when:at.Mk.has(tl(e.id)),order:null!==a&&void 0!==a?a:Number.MAX_VALUE}))}}return t}registerOpenViewAction(e){var t,i,o,s,r;let n=new at.gj,a=null!==(t=null===(i=e.openCommandActionDescriptor)||void 0===i?void 0:i.title)&&void 0!==t?t:e.name,d=null!==(o=null===(s=e.openCommandActionDescriptor)||void 0===s?void 0:s.id)&&void 0!==o?o:"".concat(e.id,".open"),l=this;if(n.add((0,at.Db)(class extends at.bb{constructor(){var t;super({id:d,get title(){let t=l.viewDescriptorService.getViewLocationById(e.id),i="string"==typeof a?a:a.value,o="string"==typeof a?a:a.original;return t===ut.gf.Sidebar?{value:(0,at.EM)(13948,"Show {0}",i),original:"Show ".concat(o)}:{value:(0,at.EM)(13949,"Toggle {0}",i),original:"Toggle ".concat(o)}},category:vt.s.View,precondition:at.Mk.has("".concat(e.id,".active")),keybinding:null!==(t=e.openCommandActionDescriptor)&&void 0!==t&&t.keybindings?(0,rt.A)((0,rt.A)({},e.openCommandActionDescriptor.keybindings),{},{weight:at.Ob.WorkbenchContrib}):void 0,f1:!!e.openCommandActionDescriptor||void 0,metadata:{description:(0,at.EM)(13950,"Opens view {0}",e.name.value),args:[{name:"options",schema:{type:"object",properties:{preserveFocus:{type:"boolean",default:!1,description:(0,at.EM)(13951,"Whether to preserve the existing focus when opening the view.")}}}}]}})}async run(t,i){let o=t.get(bt.W),s=t.get(ut.vb),r=t.get(pt.ot),n=t.get(ut._g),a=t.get(at.Nb);if(pt.yn.getValue(a)!==e.id||null!==i&&void 0!==i&&i.preserveFocus)await n.openView(e.id,!(null!==i&&void 0!==i&&i.preserveFocus));else{let t=s.getViewLocationById(e.id);s.getViewLocationById(e.id)===ut.gf.Sidebar?o.activeGroup.focus():null!==t&&r.setPartHidden(!0,ol(t))}}})),null!==(r=e.openCommandActionDescriptor)&&void 0!==r&&r.mnemonicTitle){let t=this.viewDescriptorService.getDefaultContainerById(e.id);if(t){var c;let i=this.viewDescriptorService.getDefaultViewContainerLocation(t);n.add(at.Cb.appendMenuItem(at.xb.MenubarViewMenu,{command:{id:d,title:e.openCommandActionDescriptor.mnemonicTitle},group:i===ut.gf.Sidebar?"3_sidebar":i===ut.gf.AuxiliaryBar?"4_auxbar":"5_panel",when:at.Mk.has("".concat(e.id,".active")),order:null!==(c=e.openCommandActionDescriptor.order)&&void 0!==c?c:Number.MAX_VALUE}))}}return n}registerFocusViewAction(e,t){return(0,at.Db)(class extends at.bb{constructor(){var i,o,s,r,n;let a=(0,at.DM)(13952,"Focus on {0} View",e.name.value);super({id:e.focusCommand?e.focusCommand.id:"".concat(e.id,".focus"),title:a,category:t,menu:[{id:at.xb.CommandPalette,when:e.when}],keybinding:{when:at.Mk.has("".concat(e.id,".active")),weight:at.Ob.WorkbenchContrib,primary:null===(i=e.focusCommand)||void 0===i||null===(i=i.keybindings)||void 0===i?void 0:i.primary,secondary:null===(o=e.focusCommand)||void 0===o||null===(o=o.keybindings)||void 0===o?void 0:o.secondary,linux:null===(s=e.focusCommand)||void 0===s||null===(s=s.keybindings)||void 0===s?void 0:s.linux,mac:null===(r=e.focusCommand)||void 0===r||null===(r=r.keybindings)||void 0===r?void 0:r.mac,win:null===(n=e.focusCommand)||void 0===n||null===(n=n.keybindings)||void 0===n?void 0:n.win},metadata:{description:a.value,args:[{name:"focusOptions",description:"Focus Options",schema:{type:"object",properties:{preserveFocus:{type:"boolean",default:!1}}}}]}})}run(t,i){t.get(ut._g).openView(e.id,!(null!==i&&void 0!==i&&i.preserveFocus))}})}registerResetViewLocationAction(e){return(0,at.Db)(class extends at.bb{constructor(){super({id:"".concat(e.id,".resetViewLocation"),title:(0,at.DM)(13953,"Reset Location"),menu:[{id:at.xb.ViewTitleContext,when:at.Mk.or(at.Mk.and(at.Mk.equals("view",e.id),at.Mk.equals("".concat(e.id,".defaultViewLocation"),!1))),group:"1_hide",order:2}]})}run(t){let i=t.get(ut.vb),o=i.getDefaultContainerById(e.id),s=i.getViewContainerModel(o);if(o.hideIfEmpty&&0===s.visibleViewDescriptors.length){let e=i.getDefaultViewContainerLocation(o);i.moveViewContainerToLocation(o,e,void 0,this.desc.id)}i.moveViewsToContainer([e],o,void 0,this.desc.id),t.get(ut._g).openView(e.id,!0)}})}registerPaneComposite(e,t){let i=this,o=class extends kt{constructor(t,i,o,s,r,n,a){super(e.id,t,o,s,r,n,a,i)}createViewPaneContainer(o){let s=this._register(new at.gj),r=i.createViewPaneContainer(o,e,t,s,this.instantiationService);return r instanceof $d||s.add(at.tj.any(r.onDidAddViews,r.onDidRemoveViews,r.onTitleAreaUpdate)(()=>{this.updateTitleArea()})),r}};o=(0,at.Jb)([(0,at.Yb)(0,at.vb),(0,at.Yb)(1,at.ja),(0,at.Yb)(2,at.Io),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,at.Yd),(0,at.Yb)(5,at.El),(0,at.Yb)(6,pt.Mt)],o),at.jb.as(il(t)).registerPaneComposite(_t.create(o,e.id,"string"==typeof e.title?e.title:e.title.value,(0,at.QM)(e.icon)?e.icon:void 0,e.order,e.requestedIndex,e.icon instanceof at.xO?e.icon:void 0))}deregisterPaneComposite(e,t){at.jb.as(il(t)).deregisterPaneComposite(e.id)}createViewPaneContainer(e,t,i,o,s){let r=s.createInstance(t.ctorDescriptor.ctor,...t.ctorDescriptor.staticArguments||[]);return this.viewPaneContainers.set(r.getId(),r),o.add((0,at.kj)(()=>this.viewPaneContainers.delete(r.getId()))),o.add(r.onDidAddViews(e=>this.onViewsAdded(e))),o.add(r.onDidChangeViewVisibility(e=>this.onViewsVisibilityChanged(e,e.isBodyVisible()))),o.add(r.onDidRemoveViews(e=>this.onViewsRemoved(e))),o.add(r.onDidFocusView(e=>{this.focusedViewContextKey.get()!==e.id&&(this.focusedViewContextKey.set(e.id),this._onDidChangeFocusedView.fire())})),o.add(r.onDidBlurView(e=>{this.focusedViewContextKey.get()===e.id&&(this.focusedViewContextKey.reset(),this._onDidChangeFocusedView.fire())})),r}};function tl(e){return"viewContainer.".concat(e,".enabled")}function il(e){switch(e){case ut.gf.AuxiliaryBar:return At;case ut.gf.Panel:return xt;case ut.gf.Sidebar:default:return It}}function ol(e){switch(e){case ut.gf.AuxiliaryBar:return pt.V.AUXILIARYBAR_PART;case ut.gf.Panel:return pt.V.PANEL_PART;case ut.gf.Sidebar:default:return pt.V.SIDEBAR_PART}}el=(0,at.Jb)([(0,at.Yb)(0,ut.vb),(0,at.Yb)(1,pt.Ot),(0,at.Yb)(2,at.Nb),(0,at.Yb)(3,pt.ot),(0,at.Yb)(4,bt.kt)],el),(0,at.ox)(),(0,gt.f)(),(0,at.Jp)();var sl=class{constructor(){this.onWillInstantiateEditorPane=gt.u.onWillInstantiateEditorPane}didInstantiateEditorPane(e){return gt.u.didInstantiateEditorPane(e)}};(0,at.sj)(),(0,at.wj)(),(0,at.Jp)(),(0,at.Tb)(),(0,at.ox)();var rl=class{constructor(){this._providers=new Map,this._onDidChange=new at.ej,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}register(e,t,i,o){let s=this._makeKey(e,t);if(this._providers.has(s))throw Error("A provider for the command ".concat(t," and menu ").concat(e," is already registered."));this._providers.set(s,i);let r=null===o||void 0===o?void 0:o(()=>{this._onDidChange.fire(e)});return(0,at.kj)(()=>{null!==r&&void 0!==r&&r.dispose(),this._providers.delete(s)})}lookUp(e,t){return this._providers.get(this._makeKey(e,t))}_makeKey(e,t){return"".concat(e.id,"/").concat(t instanceof at.xb?t.id:t)}};(0,at.Xb)(),(0,at.Qs)(),(0,at.ps)(),(0,at.i_)(),(0,pt.bt)(),(0,at.Ju)(),(0,at._u)(),(0,at.ox)(),(0,at.gb)(),(0,at.LA)(),(0,bt.D)(),(0,at.ET)();var nl,al=class{constructor(){this.uris=[]}async perform(){return this}toString(){return"(noop)"}},dl=class{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="rename"}},ll=nl=class{constructor(e,t,i,o){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o}get uris(){return this._edits.flatMap(e=>[e.newUri,e.oldUri])}async perform(e){let t=[],i=[];for(let o of this._edits)void 0===o.options.overwrite&&o.options.ignoreIfExists&&await this._fileService.exists(o.newUri)||(t.push({file:{source:o.oldUri,target:o.newUri},overwrite:o.options.overwrite}),i.push(new dl(o.oldUri,o.newUri,o.options)));return 0===t.length?new al:(await this._workingCopyFileService.move(t,e,this._undoRedoInfo),new nl(i,{isUndoing:!0},this._workingCopyFileService,this._fileService))}toString(){return"(rename ".concat(this._edits.map(e=>"".concat(e.oldUri," to ").concat(e.newUri)).join(", "),")")}};ll=nl=(0,at.Jb)([(0,at.Yb)(2,pt.yt),(0,at.Yb)(3,at.fs)],ll);var cl=class{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="copy"}},hl=class{constructor(e,t,i,o,s){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._instaService=s}get uris(){return this._edits.flatMap(e=>[e.newUri,e.oldUri])}async perform(e){let t=[];for(let s of this._edits)void 0===s.options.overwrite&&s.options.ignoreIfExists&&await this._fileService.exists(s.newUri)||t.push({file:{source:s.oldUri,target:s.newUri},overwrite:s.options.overwrite});if(0===t.length)return new al;let i=await this._workingCopyFileService.copy(t,e,this._undoRedoInfo),o=[];for(let s=0;s<i.length;s++){let e=i[s],t=this._edits[s];o.push(new pl(e.resource,(0,rt.A)({recursive:!0,folder:this._edits[s].options.folder||e.isDirectory},t.options),!1))}return this._instaService.createInstance(bl,o,{isUndoing:!0})}toString(){return"(copy ".concat(this._edits.map(e=>"".concat(e.oldUri," to ").concat(e.newUri)).join(", "),")")}};hl=(0,at.Jb)([(0,at.Yb)(2,pt.yt),(0,at.Yb)(3,at.fs),(0,at.Yb)(4,at.rx)],hl);var ul=class{constructor(e,t,i){this.newUri=e,this.options=t,this.contents=i,this.type="create"}},gl=class{constructor(e,t,i,o,s,r){this._edits=e,this._undoRedoInfo=t,this._fileService=i,this._workingCopyFileService=o,this._instaService=s,this._textFileService=r}get uris(){return this._edits.map(e=>e.newUri)}async perform(e){let t=[],i=[],o=[];for(let s of this._edits)if(s.newUri.scheme!==at.TT.untitled&&(void 0!==s.options.overwrite||!s.options.ignoreIfExists||!await this._fileService.exists(s.newUri))){if(s.options.folder)t.push({resource:s.newUri});else{let e=void 0===s.contents?await this._textFileService.getEncodedReadable(s.newUri):s.contents;i.push({resource:s.newUri,contents:e,overwrite:s.options.overwrite})}o.push(new pl(s.newUri,s.options,!s.options.folder&&!s.contents))}return 0===t.length&&0===i.length?new al:(await this._workingCopyFileService.createFolder(t,e,this._undoRedoInfo),await this._workingCopyFileService.create(i,e,this._undoRedoInfo),this._instaService.createInstance(bl,o,{isUndoing:!0}))}toString(){return"(create ".concat(this._edits.map(e=>{var t;return e.options.folder?"folder ".concat(e.newUri):"file ".concat(e.newUri," with ").concat((null===(t=e.contents)||void 0===t?void 0:t.byteLength)||0," bytes")}).join(", "),")")}};gl=(0,at.Jb)([(0,at.Yb)(2,at.fs),(0,at.Yb)(3,pt.yt),(0,at.Yb)(4,at.rx),(0,at.Yb)(5,bt.E)],gl);var pl=class{constructor(e,t,i){this.oldUri=e,this.options=t,this.undoesCreate=i,this.type="delete"}},bl=class{constructor(e,t,i,o,s,r,n){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._configurationService=s,this._instaService=r,this._logService=n}get uris(){return this._edits.map(e=>e.oldUri)}async perform(e){let t=[],i=[];for(let r of this._edits){var o;let n;try{n=await this._fileService.resolve(r.oldUri,{resolveMetadata:!0})}catch(s){if(!r.options.ignoreIfNotExists)throw Error("".concat(r.oldUri," does not exist and can not be deleted"));continue}t.push({resource:r.oldUri,recursive:r.options.recursive,useTrash:!r.options.skipTrashBin&&this._fileService.hasCapability(r.oldUri,at.js.Trash)&&this._configurationService.getValue("files.enableTrash")});let a,d=!1;if(!r.undoesCreate&&!r.options.folder&&(d="number"==typeof r.options.maxSize&&n.size>r.options.maxSize,!d))try{a=await this._fileService.readFile(r.oldUri)}catch(e){this._logService.error(e)}d||i.push(new ul(r.oldUri,r.options,null===(o=a)||void 0===o?void 0:o.value))}return 0===t.length||(await this._workingCopyFileService.delete(t,e,this._undoRedoInfo),0===i.length)?new al:this._instaService.createInstance(gl,i,{isUndoing:!0})}toString(){return"(delete ".concat(this._edits.map(e=>e.oldUri).join(", "),")")}};bl=(0,at.Jb)([(0,at.Yb)(2,pt.yt),(0,at.Yb)(3,at.fs),(0,at.Yb)(4,at.r_),(0,at.Yb)(5,at.rx),(0,at.Yb)(6,at.mb)],bl);var ml=class{constructor(e,t,i,o){this.label=e,this.code=t,this.operations=i,this.confirmBeforeUndo=o,this.type=at.Ku.Workspace,this.resources=i.flatMap(e=>e.uris)}async undo(){await this._reverse()}async redo(){await this._reverse()}async _reverse(){for(let e=0;e<this.operations.length;e++){let t=await this.operations[e].perform(at.PA.None);this.operations[e]=t}}toString(){return this.operations.map(e=>String(e)).join(", ")}},vl=class{constructor(e,t,i,o,s,r,n,a,d,l){this._label=e,this._code=t,this._undoRedoGroup=i,this._undoRedoSource=o,this._confirmBeforeUndo=s,this._progress=r,this._token=n,this._edits=a,this._instaService=d,this._undoRedoService=l}async apply(){let e=[],t={undoRedoGroupId:this._undoRedoGroup.id},i=[];for(let h of this._edits){var o,s,r,n,a,d;!h.newResource||!h.oldResource||null!==(o=h.options)&&void 0!==o&&o.copy?h.newResource&&h.oldResource&&null!==(r=h.options)&&void 0!==r&&r.copy?i.push(new cl(h.newResource,h.oldResource,null!==(n=h.options)&&void 0!==n?n:{})):!h.newResource&&h.oldResource?i.push(new pl(h.oldResource,null!==(a=h.options)&&void 0!==a?a:{},!1)):h.newResource&&!h.oldResource&&i.push(new ul(h.newResource,null!==(d=h.options)&&void 0!==d?d:{},await h.options.contents)):i.push(new dl(h.newResource,h.oldResource,null!==(s=h.options)&&void 0!==s?s:{}))}if(0===i.length)return[];let l=[];l[0]=[i[0]];for(let h=1;h<i.length;h++){let e=i[h],t=l.at(-1);(null===t||void 0===t?void 0:t[0].type)===e.type?t.push(e):l.push([e])}for(let h of l){if(this._token.isCancellationRequested)break;let i;switch(h[0].type){case"rename":i=this._instaService.createInstance(ll,h,t);break;case"copy":i=this._instaService.createInstance(hl,h,t);break;case"delete":i=this._instaService.createInstance(bl,h,t);break;case"create":i=this._instaService.createInstance(gl,h,t)}if(i){let t=await i.perform(this._token);e.push(t)}this._progress.report(void 0)}let c=new ml(this._label,this._code,e,this._confirmBeforeUndo);return this._undoRedoService.pushElement(c,this._undoRedoGroup,this._undoRedoSource),c.resources}};vl=(0,at.Jb)([(0,at.Yb)(8,at.rx),(0,at.Yb)(9,at.gu)],vl),(0,at.Xb)(),(0,at.wj)(),(0,at.dO)(),(0,at.vO)(),(0,at.Qb)(),(0,at.Sr)(),(0,at._u)(),(0,at.Ru)(),(0,at.Hj)(),(0,at.ex)(),(0,at.ko)(),(0,ut.wh)(),(0,ut.Fh)();var Cl=class{constructor(e){this._modelReference=e,this.model=this._modelReference.object.textEditorModel,this._edits=[]}dispose(){this._modelReference.dispose()}isNoOp(){return!(this._edits.length>0||void 0!==this._newEol&&this._newEol!==this.model.getEndOfLineSequence())}addEdit(e){this._expectedModelVersionId=e.versionId;let t,{textEdit:i}=e;"number"==typeof i.eol&&(this._newEol=i.eol),!i.range&&!i.text||at._O.isEmpty(i.range)&&!i.text||(t=i.range?at._O.lift(i.range):this.model.getFullModelRange(),this._edits.push((0,rt.A)((0,rt.A)({},at.uO.replaceMove(t,i.text)),{},{insertAsSnippet:i.insertAsSnippet,keepWhitespace:i.keepWhitespace})))}validate(){return void 0===this._expectedModelVersionId||this.model.getVersionId()===this._expectedModelVersionId?{canApply:!0}:{canApply:!1,reason:this.model.uri}}getBeforeCursorState(){return null}apply(e){this._edits.length>0&&(this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((e,t)=>at._O.compareRangesUsingStarts(e.range,t.range)),this.model.pushEditOperations(null,this._edits,()=>null,void 0,e)),void 0!==this._newEol&&this.model.pushEOL(this._newEol)}_transformSnippetStringToInsertText(e){if(!e.insertAsSnippet||!e.text)return e;let t=ut.Ph.asInsertText(e.text);return(0,rt.A)((0,rt.A)({},e),{},{insertAsSnippet:!1,text:t})}},wl=class extends Cl{constructor(e,t){super(e),this._editor=t}getBeforeCursorState(){return this._canUseEditor()?this._editor.getSelections():null}apply(e){if(this._canUseEditor()){if(this._edits.length>0){let t=ut.Ch.get(this._editor);if(t&&this._edits.some(e=>e.insertAsSnippet)){let e=[];for(let t of this._edits)t.range&&null!==t.text&&e.push({range:at._O.lift(t.range),template:t.insertAsSnippet?t.text:ut.Ph.escape(t.text),keepWhitespace:t.keepWhitespace});t.apply(e,{undoStopBefore:!1,undoStopAfter:!1})}else this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((e,t)=>at._O.compareRangesUsingStarts(e.range,t.range)),this._editor.executeEdits(e,this._edits)}void 0!==this._newEol&&this._editor.hasModel()&&this._editor.getModel().pushEOL(this._newEol)}else super.apply()}_canUseEditor(){var e;return(null===(e=this._editor)||void 0===e||null===(e=e.getModel())||void 0===e?void 0:e.uri.toString())===this.model.uri.toString()}},yl=class{constructor(e,t,i,o,s,r,n,a,d,l,c,h){this._label=e,this._code=t,this._editor=i,this._undoRedoGroup=o,this._undoRedoSource=s,this._progress=r,this._token=n,this._editorWorker=d,this._modelService=l,this._textModelResolverService=c,this._undoRedoService=h,this._edits=new at.Lj;for(let u of a){let e=this._edits.get(u.resource);e||(e=[],this._edits.set(u.resource,e)),e.push(u)}}_validateBeforePrepare(){for(let e of this._edits.values())for(let t of e)if("number"==typeof t.versionId){let e=this._modelService.getModel(t.resource);if(e&&e.getVersionId()!==t.versionId)throw Error("".concat(e.uri.toString()," has changed in the meantime"))}}async _createEditsTasks(){let e=[],t=[];for(let[i,o]of this._edits){let s=this._textModelResolverService.createModelReference(i).then(async t=>{var i;let s,r=!1;if((null===(i=this._editor)||void 0===i||null===(i=i.getModel())||void 0===i?void 0:i.uri.toString())===t.object.textEditorModel.uri.toString()?(s=new wl(t,this._editor),r=!0):s=new Cl(t),e.push(s),!r)return void o.forEach(s.addEdit,s);let n=async(e,i)=>{let r=o.slice(e,i),n=await this._editorWorker.computeMoreMinimalEdits(t.object.textEditorModel.uri,r.map(e=>e.textEdit),!1);n?n.forEach(e=>s.addEdit(new at.Oo(t.object.textEditorModel.uri,e,void 0,void 0))):r.forEach(s.addEdit,s)},a=0,d=0;for(;d<o.length;d++)(o[d].textEdit.insertAsSnippet||o[d].metadata)&&(await n(a,d),s.addEdit(o[d]),a=d+1);await n(a,d)});t.push(s)}return await Promise.all(t),e}_validateTasks(e){for(let t of e){let e=t.validate();if(!e.canApply)return e}return{canApply:!0}}async apply(e){this._validateBeforePrepare();let t=await this._createEditsTasks();try{if(this._token.isCancellationRequested)return[];let i=[],o=this._validateTasks(t);if(!o.canApply)throw Error("".concat(o.reason.toString()," has changed in the meantime"));if(1===t.length){let o=t[0];if(!o.isNoOp()){let t=new at.Lu(this._label,this._code,o.model,o.getBeforeCursorState());this._undoRedoService.pushElement(t,this._undoRedoGroup,this._undoRedoSource),o.apply(e),t.close(),i.push(o.model.uri)}this._progress.report(void 0)}else{let e=new at.Iu(this._label,this._code,t.map(e=>new at.Lu(this._label,this._code,e.model,e.getBeforeCursorState())));this._undoRedoService.pushElement(e,this._undoRedoGroup,this._undoRedoSource);for(let o of t)o.apply(),this._progress.report(void 0),i.push(o.model.uri);e.close()}return i}finally{(0,at.Sj)(t)}}};yl=(0,at.Jb)([(0,at.Yb)(8,at.xr),(0,at.Yb)(9,at.$b),(0,at.Yb)(10,at.Zb),(0,at.Yb)(11,at.gu)],yl),(0,at.Xb)(),(0,at.GM)(),(0,at.ko)(),(0,at.Ju)(),(0,at._u)();var fl=class e extends at.Eo{static is(t){return t instanceof e||(0,at.ZM)(t)&&!(!t.undo||!t.redo)}static lift(t){return t instanceof e?t:new e(t.resource,t.undo,t.redo,t.metadata)}constructor(e,t,i,o){super(o),this.resource=e,this.undo=t,this.redo=i}},Sl=class{constructor(e,t,i,o,s,r){this._undoRedoGroup=e,this._undoRedoSource=t,this._progress=i,this._token=o,this._edits=s,this._undoRedoService=r}async apply(){let e=[];for(let i of this._edits){var t;if(this._token.isCancellationRequested)break;await i.redo(),this._undoRedoService.pushElement({type:at.Ku.Resource,resource:i.resource,label:(null===(t=i.metadata)||void 0===t?void 0:t.label)||"Custom Edit",code:"paste",undo:i.undo,redo:i.redo},this._undoRedoGroup,this._undoRedoSource),this._progress.report(void 0),e.push(i.resource)}return e}};Sl=(0,at.Jb)([(0,at.Yb)(5,at.gu)],Sl),(0,at.Xb)(),(0,at.LA)(),(0,at.wj)(),(0,at.fj)(),(0,at.Hj)(),(0,lt.o)(),(0,at.ko)(),(0,at.ox)(),(0,at.wk)(),(0,at.TM)(),(0,at.i_)(),(0,at.A_)(),(0,at.Vl)(),(0,at.Jp)(),(0,at.gb)(),(0,pt.gt)(),(0,at.Mb)(),(0,at.Ju)(),(0,ut.Wu)(),(0,bt.At)(),(0,bt.L)(),(0,bt.z)(),(0,bt.C)(),(0,at.iM)();var El=class{constructor(e,t,i,o,s,r,n,a,d,l,c){this._label=e,this._code=t,this._editor=i,this._progress=o,this._token=s,this._edits=r,this._undoRedoGroup=n,this._undoRedoSource=a,this._confirmBeforeUndo=d,this._instaService=l,this._logService=c}ariaMessage(){let e=new at.Lj,t=new at.Lj,i=0;for(let s of this._edits){var o;s instanceof at.Oo?(i+=1,t.set(s.resource,!0)):s instanceof at.Do&&e.set(null!==(o=s.oldResource)&&void 0!==o?o:s.newResource,!0)}return 0===this._edits.length?(0,at.EM)(4400,"Made no edits"):0===e.size?i>1&&t.size>1?(0,at.EM)(4401,"Made {0} text edits in {1} files",i,t.size):(0,at.EM)(4402,"Made {0} text edits in one file",i):(0,at.EM)(4403,"Made {0} text edits in {1} files, also created or deleted {2} files",i,t.size,e.size)}async perform(e){if(0===this._edits.length)return[];let t=[1];for(let n=1;n<this._edits.length;n++)Object.getPrototypeOf(this._edits[n-1])===Object.getPrototypeOf(this._edits[n])?t[t.length-1]++:t.push(1);let i=this._edits.length>1?0:void 0;this._progress.report({increment:i,total:100});let o={report:e=>this._progress.report({increment:100/this._edits.length})},s=[],r=0;for(let n of t){if(this._token.isCancellationRequested)break;let t=this._edits.slice(r,r+n);t[0]instanceof at.Do?s.push(await this._performFileEdits(t,this._undoRedoGroup,this._undoRedoSource,this._confirmBeforeUndo,o)):t[0]instanceof at.Oo?s.push(await this._performTextEdits(t,this._undoRedoGroup,this._undoRedoSource,o,e)):t[0]instanceof ut.Uu?s.push(await this._performCellEdits(t,this._undoRedoGroup,this._undoRedoSource,o)):t[0]instanceof fl?s.push(await this._performOpaqueEdits(t,this._undoRedoGroup,this._undoRedoSource,o)):console.log("UNKNOWN EDIT"),r+=n}return s.flat()}async _performFileEdits(e,t,i,o,s){return this._logService.debug("_performFileEdits",JSON.stringify(e)),await this._instaService.createInstance(vl,this._label||(0,at.EM)(4404,"Workspace Edit"),this._code||"undoredo.workspaceEdit",t,i,o,s,this._token,e).apply()}async _performTextEdits(e,t,i,o,s){return this._logService.debug("_performTextEdits",JSON.stringify(e)),await this._instaService.createInstance(yl,this._label||(0,at.EM)(4404,"Workspace Edit"),this._code||"undoredo.workspaceEdit",this._editor,t,i,o,this._token,e).apply(s)}async _performCellEdits(e,t,i,o){return this._logService.debug("_performCellEdits",JSON.stringify(e)),await this._instaService.createInstance(ut.Hu,t,i,o,this._token,e).apply()}async _performOpaqueEdits(e,t,i,o){return this._logService.debug("_performOpaqueEdits",JSON.stringify(e)),await this._instaService.createInstance(Sl,t,i,o,this._token,e).apply()}};El=(0,at.Jb)([(0,at.Yb)(9,at.rx),(0,at.Yb)(10,at.mb)],El);var kl=class{constructor(e,t,i,o,s,r,n){this._instaService=e,this._logService=t,this._editorService=i,this._lifecycleService=o,this._dialogService=s,this._workingCopyService=r,this._configService=n,this._activeUndoRedoGroups=new at.dj}setPreviewHandler(e){return this._previewHandler=e,(0,at.kj)(()=>{this._previewHandler===e&&(this._previewHandler=void 0)})}hasPreviewHandler(){return!!this._previewHandler}async apply(e,t){var i,o;let s=function(e){return e.map(e=>{if(at.Oo.is(e))return at.Oo.lift(e);if(at.Do.is(e))return at.Do.lift(e);if(ut.Uu.is(e))return ut.Uu.lift(e);if(fl.is(e))return fl.lift(e);throw Error("Unsupported edit")})}(Array.isArray(e)?e:e.edits);if(0===s.length)return{ariaSummary:(0,at.EM)(4405,"Made no edits"),isApplied:!1};this._previewHandler&&((null===t||void 0===t?void 0:t.showPreview)||s.some(e=>{var t;return null===(t=e.metadata)||void 0===t?void 0:t.needsConfirmation}))&&(s=await this._previewHandler(s,t));let r=null===t||void 0===t?void 0:t.editor;if(!r){let e=this._editorService.activeTextEditorControl;(0,lt.s)(e)?r=e:(0,lt.l)(e)&&(r=e.getModifiedEditor())}r&&r.getOption(at.sk.readOnly)&&(r=void 0);let n,a=()=>{};if("number"==typeof(null===t||void 0===t?void 0:t.undoRedoGroupId))for(let u of this._activeUndoRedoGroups)if(u.id===t.undoRedoGroupId){n=u;break}n||(n=new at.qu,a=this._activeUndoRedoGroups.push(n));let d,l=(null===t||void 0===t?void 0:t.quotableLabel)||(null===t||void 0===t?void 0:t.label),c=this._instaService.createInstance(El,l,null===t||void 0===t?void 0:t.code,r,null!==(i=null===t||void 0===t?void 0:t.progress)&&void 0!==i?i:pt.pt.None,null!==(o=null===t||void 0===t?void 0:t.token)&&void 0!==o?o:at.PA.None,s,n,null===t||void 0===t?void 0:t.undoRedoSource,!(null===t||void 0===t||!t.confirmBeforeUndo));try{d=this._lifecycleService.onBeforeShutdown(e=>e.veto(this._shouldVeto(l,e.reason),"veto.blukEditService"));let e=await c.perform(null===t||void 0===t?void 0:t.reason);return null!==t&&void 0!==t&&t.respectAutoSaveConfig&&!0===this._configService.getValue(_l)&&e.length>1&&await this._saveAll(e),{ariaSummary:c.ariaMessage(),isApplied:s.length>0}}catch(e){throw this._logService.error(e),e}finally{var h;null!==(h=d)&&void 0!==h&&h.dispose(),a()}}async _saveAll(e){let t=new at.Rj(e),i=this._workingCopyService.dirtyWorkingCopies.map(async e=>{t.has(e.resource)&&await e.save()}),o=await Promise.allSettled(i);for(let s of o)"rejected"===s.status&&this._logService.warn(s.reason)}async _shouldVeto(e,t){let i;switch(t){case bt.P.CLOSE:i=(0,at.EM)(4406,"Are you sure you want to close the window?");break;case bt.P.LOAD:i=(0,at.EM)(4407,"Are you sure you want to change the workspace?");break;case bt.P.RELOAD:i=(0,at.EM)(4408,"Are you sure you want to reload the window?");break;default:i=at.pM?(0,at.EM)(4409,"Are you sure you want to quit?"):(0,at.EM)(4410,"Are you sure you want to exit?")}return!(await this._dialogService.confirm({message:i,detail:(0,at.EM)(4411,"'{0}' is in progress.",e||(0,at.EM)(4412,"File operation"))})).confirmed}};kl=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,at.mb),(0,at.Yb)(2,bt.kt),(0,at.Yb)(3,bt.R),(0,at.Yb)(4,at.zl),(0,at.Yb)(5,bt.S),(0,at.Yb)(6,at.r_)],kl);var _l="files.refactoring.autoSave";at.jb.as(at.b_.Configuration).registerConfiguration({id:"files",properties:{[_l]:{description:(0,at.EM)(4413,"Controls if files that were part of a refactoring are saved automatically"),default:!0,type:"boolean"}}});(0,at.Xb)(),(0,at.ps)(),(0,at.ex)(),(0,at.Hj)(),(0,at.wj)(),(0,at.sj)(),(0,at.ko)(),(0,ut.Wu)(),(0,at.gb)();var Il=class{constructor(e,t,i,o){this._conflicts=new at.Lj,this._disposables=new at.gj,this._onDidConflict=new at.ej,this.onDidConflict=this._onDidConflict.event;let s=new at.Lj;for(let n of e)if(n instanceof at.Oo){if(s.set(n.resource,!0),"number"==typeof n.versionId){let e=i.getModel(n.resource);e&&e.getVersionId()!==n.versionId&&(this._conflicts.set(n.resource,!0),this._onDidConflict.fire(this))}}else n instanceof at.Do?n.newResource?s.set(n.newResource,!0):n.oldResource&&s.set(n.oldResource,!0):n instanceof ut.Uu?s.set(n.resource,!0):o.warn("UNKNOWN edit type",n);this._disposables.add(t.onDidFilesChange(e=>{for(let t of s.keys())if(!i.getModel(t)&&e.contains(t)){this._conflicts.set(t,!0),this._onDidConflict.fire(this);break}}));let r=e=>{s.has(e.uri)&&(this._conflicts.set(e.uri,!0),this._onDidConflict.fire(this))};for(let n of i.getModels())this._disposables.add(n.onDidChangeContent(()=>r(n)))}dispose(){this._disposables.dispose(),this._onDidConflict.dispose()}list(){return[...this._conflicts.keys()]}hasConflicts(){return this._conflicts.size>0}};Il=(0,at.Jb)([(0,at.Yb)(1,at.fs),(0,at.Yb)(2,at.$b),(0,at.Yb)(3,at.mb)],Il),(0,at.Xb)(),(0,at.Qb)(),(0,at.SO)(),(0,at.ev)(),(0,at.ex)(),(0,at.hu)(),(0,at.wj)(),(0,at.AN)(),(0,at.vO)(),(0,at.dO)(),(0,at.ox)(),(0,at.ps)(),(0,at.sj)(),(0,at.Hj)(),(0,at.TM)(),(0,at.dT)(),(0,at.ko)(),(0,at.pO)(),(0,at.dp)(),(0,ut.Fh)(),(0,at.tT)(),(0,at.ET)();var xl,Al,Vl,Dl=class{constructor(){this._states=new WeakMap,this._checkedCount=0,this._onDidChange=new at.ej,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}get checkedCount(){return this._checkedCount}isChecked(e){var t;return null!==(t=this._states.get(e))&&void 0!==t&&t}updateChecked(e,t){let i=this._states.get(e);i!==t&&(void 0===i?t&&(this._checkedCount+=1):t?this._checkedCount+=1:--this._checkedCount,this._states.set(e,t),this._onDidChange.fire(e))}},Ml=class{constructor(e,t){this.parent=e,this.textEdit=t}};!function(e){e[e.TextEdit=1]="TextEdit",e[e.Create=2]="Create",e[e.Delete=4]="Delete",e[e.Rename=8]="Rename"}(Vl||(Vl={}));var Tl=class{constructor(e,t){this.uri=e,this.parent=t,this.type=0,this.textEdits=[],this.originalEdits=new Map}addEdit(e,t,i){this.type|=t,this.originalEdits.set(e,i),i instanceof at.Oo?this.textEdits.push(new Ml(this,i)):t===Vl.Rename&&(this.newUri=i.newResource)}needsConfirmation(){for(let[,e]of this.originalEdits)if(!this.parent.checked.isChecked(e))return!0;return!1}},Rl=(ae=class e{static keyOf(e){return(null===e||void 0===e?void 0:e.label)||"<default>"}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e._defaultMetadata;this.metadata=t,this.operationByResource=new Map}get fileOperations(){return this.operationByResource.values()}},{_:ae._defaultMetadata=Object.freeze({label:(0,at.EM)(4430,"Other"),icon:at.fO.symbolFile,needsConfirmation:!1})},ae),Ol=xl=class{static async create(e,t){return await e.get(at.rx).createInstance(xl,t)._init()}constructor(e,t,i){this._bulkEdit=e,this._fileService=t,this.checked=new Dl,this.fileOperations=[],this.categories=[],this.conflicts=i.createInstance(Il,e)}dispose(){this.checked.dispose(),this.conflicts.dispose()}async _init(){let e=new Map,t=new Map,i=new at.Lj;for(let l=0;l<this._bulkEdit.length;l++){var o;let c,h,u=this._bulkEdit[l];if(this.checked.updateChecked(u,!(null!==(o=u.metadata)&&void 0!==o&&o.needsConfirmation)),u instanceof at.Oo)h=Vl.TextEdit,c=u.resource;else{if(!(u instanceof at.Do))continue;if(u.newResource&&u.oldResource){var s,r;if(h=Vl.Rename,c=u.oldResource,void 0===(null===(s=u.options)||void 0===s?void 0:s.overwrite)&&null!==(r=u.options)&&void 0!==r&&r.ignoreIfExists&&await this._fileService.exists(c))continue;i.set(u.newResource,c)}else if(u.oldResource){var n;if(h=Vl.Delete,c=u.oldResource,null!==(n=u.options)&&void 0!==n&&n.ignoreIfNotExists&&!await this._fileService.exists(c))continue}else{if(!u.newResource)continue;var a,d;if(h=Vl.Create,c=u.newResource,void 0===(null===(a=u.options)||void 0===a?void 0:a.overwrite)&&null!==(d=u.options)&&void 0!==d&&d.ignoreIfExists&&await this._fileService.exists(c))continue}}let g=(e,t)=>{let o=at.sT.getComparisonKey(e,!0),s=t.get(o);!s&&i.has(e)&&(e=i.get(e),o=at.sT.getComparisonKey(e,!0),s=t.get(o)),s||(s=new Tl(e,this),t.set(o,s)),s.addEdit(l,h,u)};g(c,e);let p=Rl.keyOf(u.metadata),b=t.get(p);b||(b=new Rl(u.metadata),t.set(p,b)),g(c,b.operationByResource)}e.forEach(e=>this.fileOperations.push(e)),t.forEach(e=>this.categories.push(e));for(let l of this.fileOperations)if(l.type!==Vl.TextEdit){let e=!0;for(let t of l.originalEdits.values())t instanceof at.Do&&e&&(e=this.checked.isChecked(t));if(!e)for(let t of l.originalEdits.values())this.checked.updateChecked(t,e)}return this.categories.sort((e,t)=>e.metadata.needsConfirmation===t.metadata.needsConfirmation?e.metadata.label.localeCompare(t.metadata.label):e.metadata.needsConfirmation?-1:1),this}getWorkspaceEdit(){let e=[],t=!0;for(let i=0;i<this._bulkEdit.length;i++){let o=this._bulkEdit[i];this.checked.isChecked(o)?e[i]=o:t=!1}return t?this._bulkEdit:((0,at.vN)(e),e)}async getFileEditOperation(e){let t=await e.options.contents;if(t)return at.uO.replaceMove(at._O.lift({startLineNumber:0,startColumn:0,endLineNumber:Number.MAX_VALUE,endColumn:0}),t.toString())}async getFileEdits(e){for(let t of this.fileOperations)if(t.uri.toString()===e.toString()){let e=[],i=!1;for(let o of t.originalEdits.values())o instanceof at.Do?e.push(this.getFileEditOperation(o)):o instanceof at.Oo?this.checked.isChecked(o)&&e.push(Promise.resolve(at.uO.replaceMove(at._O.lift(o.textEdit.range),o.textEdit.insertAsSnippet?ut.Ph.asInsertText(o.textEdit.text):o.textEdit.text))):this.checked.isChecked(o)||(i=!0);return i?[]:(await Promise.all(e)).filter(e=>void 0!==e).sort((e,t)=>at._O.compareRangesUsingStarts(e.range,t.range))}return[]}getUriOfEdit(e){for(let t of this.fileOperations)for(let i of t.originalEdits.values())if(i===e)return t.uri;throw Error("invalid edit")}};Ol=xl=(0,at.Jb)([(0,at.Yb)(1,at.fs),(0,at.Yb)(2,at.rx)],Ol);var Wl=(de=class{static fromPreviewUri(e){return at.xO.parse(e.query)}constructor(e,t,i,o){this._operations=e,this._languageService=t,this._modelService=i,this._textModelResolverService=o,this._disposables=new at.gj,this._modelPreviewEdits=new Map,this._instanceId=(0,at.up)(),this._disposables.add(this._textModelResolverService.registerTextModelContentProvider(Al.Schema,this)),this._ready=this._init()}dispose(){this._disposables.dispose()}asPreviewUri(e){let t=e.scheme===at.TT.untitled?"/".concat(e.path):e.path;return at.xO.from({scheme:Al.Schema,authority:this._instanceId,path:t,query:e.toString()})}async _init(){for(let e of this._operations.fileOperations)await this._applyTextEditsToPreviewModel(e.uri);this._disposables.add(at.tj.debounce(this._operations.checked.onDidChange,(e,t)=>t,at.eT)(e=>{let t=this._operations.getUriOfEdit(e);this._applyTextEditsToPreviewModel(t)}))}async _applyTextEditsToPreviewModel(e){let t=await this._getOrCreatePreviewModel(e),i=this._modelPreviewEdits.get(t.id);i&&t.applyEdits(i);let o=await this._operations.getFileEdits(e),s=t.applyEdits(o,!0);this._modelPreviewEdits.set(t.id,s)}async _getOrCreatePreviewModel(e){let t=this.asPreviewUri(e),i=this._modelService.getModel(t);if(!i){try{let o=await this._textModelResolverService.createModelReference(e),s=o.object.textEditorModel;i=this._modelService.createModel((0,at.fu)(s.createSnapshot()),this._languageService.createById(s.getLanguageId()),t),o.dispose()}catch(o){i=this._modelService.createModel("",this._languageService.createByFilepathOrFirstLine(t),t)}queueMicrotask(async()=>{this._disposables.add(await this._textModelResolverService.createModelReference(i.uri))})}return i}async provideTextContent(e){return e.toString()===Al.emptyPreview.toString()?this._modelService.createModel("",null,e):(await this._ready,this._modelService.getModel(e))}},{_:Al=de},{_:de.Schema="vscode-bulkeditpreview-editor"},{_:de.emptyPreview=at.xO.from({scheme:de.Schema,fragment:"empty"})},de);Wl=Al=(0,at.Jb)([(0,at.Yb)(1,at.$_),(0,at.Yb)(2,at.$b),(0,at.Yb)(3,at.Zb)],Wl),(0,at.Xb)(),(0,at.Qb)(),(0,at.rl)(),(0,at.wn)(),(0,at.vO)(),(0,at.oS)(),(0,at.wj)(),(0,at.hu)(),(0,at.Qs)(),(0,at.TM)(),(0,at.Ua)(),(0,at.Sn)(),(0,at.dT)(),(0,at.Xd)(),(0,at.Vb)(),(0,at.rA)(),(0,at.SO)(),(0,at.ko)(),(0,at.v_)(),(0,ut.Fh)(),(0,at.ox)(),(0,at.eu)();var Ll,Jl,Gl,Nl=class{constructor(e,t){this.parent=e,this.category=t}isChecked(){let e=this.parent,t=!0;for(let i of this.category.fileOperations)for(let o of i.originalEdits.values())t&&(t=e.checked.isChecked(o));return t}setChecked(e){let t=this.parent;for(let i of this.category.fileOperations)for(let o of i.originalEdits.values())t.checked.updateChecked(o,e)}},Kl=class{constructor(e,t){this.parent=e,this.edit=t}isChecked(){let e=this.parent instanceof Nl?this.parent.parent:this.parent,t=!0;this.edit.type===Vl.TextEdit&&(t=!this.edit.textEdits.every(t=>!e.checked.isChecked(t.textEdit)));for(let i of this.edit.originalEdits.values())i instanceof at.Do&&t&&(t=e.checked.isChecked(i));if(this.parent instanceof Nl&&this.edit.type===Vl.TextEdit)for(let i of e.categories)for(let o of i.fileOperations)if(o.uri.toString()===this.edit.uri.toString())for(let i of o.originalEdits.values())i instanceof at.Do&&t&&(t=e.checked.isChecked(i));return t}setChecked(e){let t=this.parent instanceof Nl?this.parent.parent:this.parent;for(let i of this.edit.originalEdits.values())t.checked.updateChecked(i,e);if(this.parent instanceof Nl&&this.edit.type!==Vl.TextEdit)for(let i of t.categories)for(let o of i.fileOperations)if(o.uri.toString()===this.edit.uri.toString())for(let i of o.originalEdits.values())t.checked.updateChecked(i,e)}isDisabled(){if(this.parent instanceof Nl&&this.edit.type===Vl.TextEdit){let e=this.parent.parent,t=!0;for(let i of e.categories)for(let o of i.fileOperations)if(o.uri.toString()===this.edit.uri.toString())for(let i of o.originalEdits.values())i instanceof at.Do&&t&&(t=e.checked.isChecked(i));return!t}return!1}},Zl=class{constructor(e,t,i,o,s,r,n){this.parent=e,this.idx=t,this.edit=i,this.prefix=o,this.selecting=s,this.inserting=r,this.suffix=n}isChecked(){let e=this.parent.parent;return e instanceof Nl&&(e=e.parent),e.checked.isChecked(this.edit.textEdit)}setChecked(e){let t=this.parent.parent;if(t instanceof Nl&&(t=t.parent),t.checked.updateChecked(this.edit.textEdit,e),e)for(let i of this.parent.edit.originalEdits.values())i instanceof at.Do&&t.checked.updateChecked(i,e)}isDisabled(){return this.parent.isDisabled()}},Bl=class{constructor(e,t){this._textModelService=e,this._instantiationService=t,this.groupByFile=!0}hasChildren(e){return e instanceof Kl?e.edit.textEdits.length>0:!(e instanceof Zl)}async getChildren(e){if(e instanceof Ol)return this.groupByFile?e.fileOperations.map(t=>new Kl(e,t)):e.categories.map(t=>new Nl(e,t));if(e instanceof Nl)return Array.from(e.category.fileOperations,t=>new Kl(e,t));if(e instanceof Kl&&e.edit.textEdits.length>0){let i,o;try{let t=await this._textModelService.createModelReference(e.edit.uri);i=t.object.textEditorModel,o=t}catch(t){i=this._instantiationService.createInstance(at.uu,"",at.__,at.uu.DEFAULT_CREATION_OPTIONS,null),o=i}let s=e.edit.textEdits.map((t,o)=>{let s=i.validateRange(t.textEdit.textEdit.range),r=i.tokenization.getLineTokens(s.startLineNumber),n=23;for(let e=r.findTokenIndexAtOffset(s.startColumn-1)-1;n<50&&e>=0;e--)n=s.startColumn-r.getStartOffset(e);let a=i.tokenization.getLineTokens(s.endLineNumber),d=0;for(let e=a.findTokenIndexAtOffset(s.endColumn-1);d<50&&e<a.getCount();e++)d+=a.getEndOffset(e)-a.getStartOffset(e);return new Zl(e,o,t,i.getValueInRange(new at._O(s.startLineNumber,s.startColumn-n,s.startLineNumber,s.startColumn)),i.getValueInRange(s),t.textEdit.textEdit.insertAsSnippet?ut.Ph.asInsertText(t.textEdit.textEdit.text):t.textEdit.textEdit.text,i.getValueInRange(new at._O(s.endLineNumber,s.endColumn,s.endLineNumber,s.endColumn+d)))});return o.dispose(),s}return[]}};Bl=(0,at.Jb)([(0,at.Yb)(0,at.Zb),(0,at.Yb)(1,at.rx)],Bl);var Pl=class{compare(e,t){return e instanceof Kl&&t instanceof Kl?Fl(e.edit,t.edit):e instanceof Zl&&t instanceof Zl?at._O.compareRangesUsingStarts(e.edit.textEdit.textEdit.range,t.edit.textEdit.textEdit.range):0}};function Fl(e,t){return(0,at.Bk)(e.uri.toString(),t.uri.toString())}var Yl=class{constructor(e){this._labelService=e}getWidgetAriaLabel(){return(0,at.EM)(4431,"Bulk Edit")}getRole(e){return"checkbox"}getAriaLabel(e){if(e instanceof Kl){if(e.edit.textEdits.length>0)return e.edit.type&Vl.Rename&&e.edit.newUri?(0,at.EM)(4432,"Renaming {0} to {1}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0})):e.edit.type&Vl.Create?(0,at.EM)(4433,"Creating {0}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0})):e.edit.type&Vl.Delete?(0,at.EM)(4434,"Deleting {0}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0})):(0,at.EM)(4435,"{0}, making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0}));if(e.edit.type&Vl.Rename&&e.edit.newUri)return(0,at.EM)(4436,"Renaming {0} to {1}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0}));if(e.edit.type&Vl.Create)return(0,at.EM)(4437,"Creating {0}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}));if(e.edit.type&Vl.Delete)return(0,at.EM)(4438,"Deleting {0}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}))}if(e instanceof Zl){if(e.selecting.length>0&&e.inserting.length>0)return(0,at.EM)(4439,"line {0}, replacing {1} with {2}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting,e.inserting);if(e.selecting.length>0&&0===e.inserting.length)return(0,at.EM)(4440,"line {0}, removing {1}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting);if(0===e.selecting.length&&e.inserting.length>0)return(0,at.EM)(4441,"line {0}, inserting {1}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting)}return null}};Yl=(0,at.Jb)([(0,at.Yb)(0,at.Ha)],Yl);var Ql=class{getId(e){return e instanceof Kl?e.edit.uri+(e.parent instanceof Nl?JSON.stringify(e.parent.category.metadata):""):e instanceof Zl?e.parent.edit.uri.toString()+e.idx:JSON.stringify(e.category.metadata)}},Xl=class{constructor(e){e.classList.add("category"),this.icon=(0,at.jx)("div"),e.appendChild(this.icon),this.label=new at.xn(e)}},Hl=(le=class{constructor(e){this._themeService=e,this.templateId=Ll.id}renderTemplate(e){return new Xl(e)}renderElement(e,t,i){i.icon.style.setProperty("--background-dark",null),i.icon.style.setProperty("--background-light",null),i.icon.style.color="";let{metadata:o}=e.element.category;if(at.Bb.isThemeIcon(o.iconPath)){var s,r;let e=at.Bb.asClassName(o.iconPath);i.icon.className=e?"theme-icon ".concat(e):"",i.icon.style.color=o.iconPath.color&&null!==(s=null===(r=this._themeService.getColorTheme().getColor(o.iconPath.color.id))||void 0===r?void 0:r.toString())&&void 0!==s?s:""}else at.xO.isUri(o.iconPath)?(i.icon.className="uri-icon",i.icon.style.setProperty("--background-dark",(0,at.Yl)(o.iconPath)),i.icon.style.setProperty("--background-light",(0,at.Yl)(o.iconPath))):o.iconPath&&(i.icon.className="uri-icon",i.icon.style.setProperty("--background-dark",(0,at.Yl)(o.iconPath.dark)),i.icon.style.setProperty("--background-light",(0,at.Yl)(o.iconPath.light)));i.label.setLabel(o.label,o.description,{descriptionMatches:(0,at.el)(e.filterData)})}disposeTemplate(e){e.label.dispose()}},{_:Ll=le},{_:le.id="CategoryElementRenderer"},le);Hl=Ll=(0,at.Jb)([(0,at.Yb)(0,at.Yd)],Hl);var Ul=class{constructor(e,t,i){this._labelService=i,this._disposables=new at.gj,this._localDisposables=new at.gj,this._checkbox=(0,at.jx)("input"),this._checkbox.className="edit-checkbox",this._checkbox.type="checkbox",this._checkbox.setAttribute("role","checkbox"),e.appendChild(this._checkbox),this._label=t.create(e,{supportHighlights:!0}),this._details=(0,at.jx)("span"),this._details.className="details",e.appendChild(this._details)}dispose(){this._localDisposables.dispose(),this._disposables.dispose(),this._label.dispose()}set(e,t){if(this._localDisposables.clear(),this._checkbox.checked=e.isChecked(),this._checkbox.disabled=e.isDisabled(),this._localDisposables.add((0,at.Sx)(this._checkbox,"change",()=>{e.setChecked(this._checkbox.checked)})),e.edit.type&Vl.Rename&&e.edit.newUri)this._label.setResource({resource:e.edit.uri,name:(0,at.EM)(4442,"{0} \u2192 {1}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0}))},{fileDecorations:{colors:!0,badges:!1}}),this._details.innerText=(0,at.EM)(4443,"(renaming)");else{let i={matches:(0,at.el)(t),fileKind:at.Ts.FILE,fileDecorations:{colors:!0,badges:!1},extraClasses:[]};e.edit.type&Vl.Create?this._details.innerText=(0,at.EM)(4444,"(creating)"):e.edit.type&Vl.Delete?(this._details.innerText=(0,at.EM)(4445,"(deleting)"),i.extraClasses.push("delete")):this._details.innerText="",this._label.setFile(e.edit.uri,i)}}};Ul=(0,at.Jb)([(0,at.Yb)(2,at.Ha)],Ul);var jl=(ce=class{constructor(e,t){this._resourceLabels=e,this._labelService=t,this.templateId=Jl.id}renderTemplate(e){return new Ul(e,this._resourceLabels,this._labelService)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}},{_:Jl=ce},{_:ce.id="FileElementRenderer"},ce);jl=Jl=(0,at.Jb)([(0,at.Yb)(1,at.Ha)],jl);var zl=class{constructor(e,t){this._themeService=t,this._disposables=new at.gj,this._localDisposables=new at.gj,e.classList.add("textedit"),this._checkbox=(0,at.jx)("input"),this._checkbox.className="edit-checkbox",this._checkbox.type="checkbox",this._checkbox.setAttribute("role","checkbox"),e.appendChild(this._checkbox),this._icon=(0,at.jx)("div"),e.appendChild(this._icon),this._label=this._disposables.add(new at.Cn(e))}dispose(){this._localDisposables.dispose(),this._disposables.dispose()}set(e){this._localDisposables.clear(),this._localDisposables.add((0,at.Sx)(this._checkbox,"change",t=>{e.setChecked(this._checkbox.checked),t.preventDefault()})),e.parent.isChecked(),this._checkbox.checked=e.isChecked(),this._checkbox.disabled=e.isDisabled();let t="";t+=e.prefix,t+=e.selecting,t+=e.inserting,t+=e.suffix;let i,o={start:e.prefix.length,end:e.prefix.length+e.selecting.length,extraClasses:["remove"]},s={start:o.end,end:o.end+e.inserting.length,extraClasses:["insert"]},{metadata:r}=e.edit.textEdit;r&&r.description?i=(0,at.EM)(4446,"{0} - {1}",r.label,r.description):r&&(i=r.label);let n=null===r||void 0===r?void 0:r.iconPath;if(n)if(this._icon.style.display="block",this._icon.style.setProperty("--background-dark",null),this._icon.style.setProperty("--background-light",null),at.Bb.isThemeIcon(n)){var a,d;let e=at.Bb.asClassName(n);this._icon.className=e?"theme-icon ".concat(e):"",this._icon.style.color=n.color&&null!==(a=null===(d=this._themeService.getColorTheme().getColor(n.color.id))||void 0===d?void 0:d.toString())&&void 0!==a?a:""}else at.xO.isUri(n)?(this._icon.className="uri-icon",this._icon.style.setProperty("--background-dark",(0,at.Yl)(n)),this._icon.style.setProperty("--background-light",(0,at.Yl)(n))):(this._icon.className="uri-icon",this._icon.style.setProperty("--background-dark",(0,at.Yl)(n.dark)),this._icon.style.setProperty("--background-light",(0,at.Yl)(n.light)));else this._icon.style.display="none";this._label.set(t,[o,s],i,!0),this._icon.title=i||""}};zl=(0,at.Jb)([(0,at.Yb)(1,at.Yd)],zl);var ql=(he=class{constructor(e){this._themeService=e,this.templateId=Gl.id}renderTemplate(e){return new zl(e,this._themeService)}renderElement(e,t,i){let{element:o}=e;i.set(o)}disposeTemplate(e){}},{_:Gl=he},{_:he.id="TextEditElementRenderer"},he);ql=Gl=(0,at.Jb)([(0,at.Yb)(0,at.Yd)],ql);var $l,ec,tc=class{getHeight(){return 23}getTemplateId(e){return e instanceof Kl?jl.id:e instanceof Zl?ql.id:Hl.id}},ic=class{getKeyboardNavigationLabel(e){return e instanceof Kl?(0,at.iT)(e.edit.uri):e instanceof Nl?e.category.metadata.label:void 0}};(0,at.vE)(),(0,at.Xb)(),(0,at.Xn)(),(0,at.NA)(),(0,at.wj)(),(0,at.SO)(),(0,at.Qb)(),(0,at.TM)(),(0,at.Tb)(),(0,at.i_)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.Ol)(),(0,at.Vl)(),(0,at.rr)(),(0,at.ox)(),(0,at.Dd)(),(0,at.Ua)(),(0,at.Ct)(),(0,at.hl)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.Ii)(),(0,at.Xd)(),(0,ut.tt)(),(0,ut.q)(),(0,ut.yb)(),(0,dt.q)(),(0,bt.At)(),(0,at.oS)(),(0,at.bE)({}),function(e){e.Data="data",e.Message="message"}(ec||(ec={}));var oc,sc=(ue=class extends ut.W{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b){super((0,rt.A)((0,rt.A)({},e),{},{titleMenuId:at.xb.BulkEditTitle}),c,h,u,d,l,t,g,p,b),this._instaService=t,this._editorService=i,this._labelService=o,this._textModelService=s,this._dialogService=r,this._contextMenuService=n,this._storageService=a,this._treeViewStates=new Map,this._disposables=new at.gj,this._sessionDisposables=new at.gj,this._computeResourceDiffEditorInputs=new at.MA(async e=>{let t=new at.jA(async e=>{let t=e.uri,i=this._currentProvider.asPreviewUri(t);if(e.type&Vl.Delete)return{original:{resource:at.xO.revive(i)},modified:{resource:void 0},goToFileResource:e.uri};{let e;try{(await this._textModelService.createModelReference(t)).dispose(),e=t}catch(o){e=Wl.emptyPreview}return{original:{resource:at.xO.revive(e)},modified:{resource:at.xO.revive(i)},goToFileResource:e}}}),i=e.slice().sort(Fl),o=[];for(let s of i)o.push(await t.get(s));return{resources:o,getResourceDiffEditorInputIdOfOperation:async e=>{let i=await t.get(e);return{original:i.original.resource,modified:i.modified.resource}}}}),this.element.classList.add("bulk-edit-panel","show-file-icons"),this._ctxHasCategories=$l.ctxHasCategories.bindTo(d),this._ctxGroupByFile=$l.ctxGroupByFile.bindTo(d),this._ctxHasCheckedChanges=$l.ctxHasCheckedChanges.bindTo(d)}dispose(){this._tree.dispose(),this._disposables.dispose(),super.dispose()}renderBody(e){super.renderBody(e);let t=this._instaService.createInstance(ut.et,{onDidChangeVisibility:this.onDidChangeBodyVisibility});this._disposables.add(t);let i=(0,at.jx)("div");i.className="content",e.appendChild(i);let o=(0,at.jx)("div");i.appendChild(o),this._treeDataSource=this._instaService.createInstance(Bl),this._treeDataSource.groupByFile=this._storageService.getBoolean($l._memGroupByFile,at.Ro.PROFILE,!0),this._ctxGroupByFile.set(this._treeDataSource.groupByFile),this._tree=this._instaService.createInstance(at.it,this.id,o,new tc,[this._instaService.createInstance(ql),this._instaService.createInstance(jl,t),this._instaService.createInstance(Hl)],this._treeDataSource,{accessibilityProvider:this._instaService.createInstance(Yl),identityProvider:new Ql,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,keyboardNavigationLabelProvider:new ic,sorter:new Pl,selectionNavigation:!0}),this._disposables.add(this._tree.onContextMenu(this._onContextMenu,this)),this._disposables.add(this._tree.onDidOpen(e=>this._openElementInMultiDiffEditor(e)));let s=(0,at.jx)("div");s.className="buttons",i.appendChild(s);let r=new at.Kn(s);this._disposables.add(r);let n=r.addButton((0,rt.A)({supportIcons:!0},at.Ti));n.label=(0,at.EM)(4425,"Apply"),n.onDidClick(()=>this.accept(),this,this._disposables);let a=r.addButton((0,rt.A)((0,rt.A)({},at.Ti),{},{secondary:!0}));a.label=(0,at.EM)(4426,"Discard"),a.onDidClick(()=>this.discard(),this,this._disposables),this._message=(0,at.jx)("span"),this._message.className="message",this._message.innerText=(0,at.EM)(4427,"Invoke a code action, like rename, to see a preview of its changes here."),e.appendChild(this._message),this._setState(ec.Message)}layoutBody(e,t){super.layoutBody(e,t);let i=e-50;this._tree.getHTMLElement().parentElement.style.height="".concat(i,"px"),this._tree.layout(i,t)}_setState(e){this.element.dataset.state=e}async setInput(e,t){this._setState(ec.Data),this._sessionDisposables.clear(),this._treeViewStates.clear(),this._currentResolve&&(this._currentResolve=void this._currentResolve(void 0));let i=await this._instaService.invokeFunction(Ol.create,e);this._currentProvider=this._instaService.createInstance(Wl,i),this._sessionDisposables.add(this._currentProvider),this._sessionDisposables.add(i);let o=i.categories.length>1;return this._ctxHasCategories.set(o),this._treeDataSource.groupByFile=!o||this._treeDataSource.groupByFile,this._ctxHasCheckedChanges.set(i.checked.checkedCount>0),this._currentInput=i,new Promise(e=>{t.onCancellationRequested(()=>e(void 0)),this._currentResolve=e,this._setTreeInput(i),this._sessionDisposables.add(i.checked.onDidChange(()=>{this._tree.updateChildren(),this._ctxHasCheckedChanges.set(i.checked.checkedCount>0)}))})}hasInput(){return!!this._currentInput}async _setTreeInput(e){let t=this._treeViewStates.get(this._treeDataSource.groupByFile);if(await this._tree.setInput(e,t),this._tree.domFocus(),t)return;let i=[...this._tree.getNode(e).children].slice(0,10);for(;i.length>0;){let{element:e}=i.shift();e instanceof Kl&&await this._tree.expand(e,!0),e instanceof Nl&&(await this._tree.expand(e,!0),i.push(...this._tree.getNode(e).children))}}accept(){var e;let t,i=null===(e=this._currentInput)||void 0===e?void 0:e.conflicts.list();i&&0!==i.length?(t=1===i.length?(0,at.EM)(4428,"Cannot apply refactoring because '{0}' has changed in the meantime.",this._labelService.getUriLabel(i[0],{relative:!0})):(0,at.EM)(4429,"Cannot apply refactoring because {0} other files have changed in the meantime.",i.length),this._dialogService.warn(t).finally(()=>this._done(!1))):this._done(!0)}discard(){this._done(!1)}_done(e){var t,i;null!==(t=this._currentResolve)&&void 0!==t&&t.call(this,e?null===(i=this._currentInput)||void 0===i?void 0:i.getWorkspaceEdit():void 0),this._currentInput=void 0,this._setState(ec.Message),this._sessionDisposables.clear()}toggleChecked(){let[e]=this._tree.getFocus();((e instanceof Kl||e instanceof Zl)&&!e.isDisabled()||e instanceof Nl)&&e.setChecked(!e.isChecked())}groupByFile(){this._treeDataSource.groupByFile||this.toggleGrouping()}groupByType(){this._treeDataSource.groupByFile&&this.toggleGrouping()}toggleGrouping(){let e=this._tree.getInput();if(e){let t=this._tree.getViewState();this._treeViewStates.set(this._treeDataSource.groupByFile,t),this._treeDataSource.groupByFile=!this._treeDataSource.groupByFile,this._setTreeInput(e),this._storageService.store($l._memGroupByFile,this._treeDataSource.groupByFile,at.Ro.PROFILE,at.zo.USER),this._ctxGroupByFile.set(this._treeDataSource.groupByFile)}}async _openElementInMultiDiffEditor(e){var t,i;let o,s,r=null===(t=this._currentInput)||void 0===t?void 0:t.fileOperations;if(!r)return;if(e.element instanceof Zl)s=e.element.parent,o=e.element.edit.textEdit.textEdit.range;else{if(!(e.element instanceof Kl))return;s=e.element,o=null===(i=e.element.edit.textEdits[0])||void 0===i?void 0:i.textEdit.textEdit.range}let n=await this._computeResourceDiffEditorInputs.get(r),a=await n.getResourceDiffEditorInputIdOfOperation(s.edit),d=(0,rt.A)((0,rt.A)({},e.editorOptions),{},{viewState:{revealData:{resource:a,range:o}}}),l=at.xO.from({scheme:$l.Schema}),c="Refactor Preview";this._editorService.openEditor({multiDiffSource:l,label:c,options:d,isTransient:!0,description:c,resources:n.resources},e.sideBySide?-2:-1)}_onContextMenu(e){this._contextMenuService.showContextMenu({menuId:at.xb.BulkEditContext,contextKeyService:this.contextKeyService,getAnchor:()=>e.anchor})}},{_:$l=ue},{_:ue.ID="refactorPreview"},{_:ue.Schema="vscode-bulkeditpreview-multieditor"},{_:ue.ctxHasCategories=new at.Nk("refactorPreview.hasCategories",!1)},{_:ue.ctxGroupByFile=new at.Nk("refactorPreview.groupByFile",!0)},{_:ue.ctxHasCheckedChanges=new at.Nk("refactorPreview.hasCheckedChanges",!0)},{_:ue._memGroupByFile="".concat(ue.ID,".groupByFile")},ue);async function rc(e){let t=await e.openView(sc.ID,!0);if(t instanceof sc)return t}sc=$l=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,bt.kt),(0,at.Yb)(3,at.Ha),(0,at.Yb)(4,at.Zb),(0,at.Yb)(5,at.zl),(0,at.Yb)(6,at.El),(0,at.Yb)(7,at.Io),(0,at.Yb)(8,at.Nb),(0,at.Yb)(9,ut.vb),(0,at.Yb)(10,at.Ed),(0,at.Yb)(11,at.El),(0,at.Yb)(12,at.r_),(0,at.Yb)(13,at.ml),(0,at.Yb)(14,at.Yd),(0,at.Yb)(15,at.nr)],sc),(0,at.Xb)(),(0,at.Mb)(),(0,bt.b)(),(0,at.To)(),(0,ut.xf)(),(0,ut.vg)(),(0,pt.tr)(),(0,at.TM)(),(0,ut.N)(),(0,at.Pk)(),(0,at.Pb)(),(0,bt.G)(),(0,at.Ab)(),(0,at.QO)(),(0,at.Ct)(),(0,at.Zp)(),(0,at.Tb)(),(0,bt.en)(),(0,at.LA)(),(0,at.Vl)(),(0,at.Wd)(),(0,at.pO)(),(0,at.G)(),(0,pt.kt)();var nc=class{constructor(e,t){var i;this._paneCompositeService=e,this._editorGroupsService=t,this._activePanel=null===(i=e.getActivePaneComposite(ut.gf.Panel))||void 0===i?void 0:i.getId()}async restore(e,t){if(e&&("string"==typeof this._activePanel?await this._paneCompositeService.openPaneComposite(this._activePanel,ut.gf.Panel):this._paneCompositeService.hideActivePaneComposite(ut.gf.Panel)),t)for(let o of this._editorGroupsService.groups){let e=[];for(let t of o.editors){var i;(null===(i=bt.Ht.getCanonicalUri(t,{supportSideBySide:bt.Jt.PRIMARY}))||void 0===i?void 0:i.scheme)===sc.Schema&&e.push(t)}e.length&&o.closeEditors(e,{preserveFocus:!0})}}};nc=(0,at.Jb)([(0,at.Yb)(0,pt.Ot),(0,at.Yb)(1,bt.W)],nc);var ac=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new at.FA;this.uxState=e,this.cts=t}},dc=(ge=class{constructor(e,t,i,o,s,r){this._paneCompositeService=e,this._viewsService=t,this._editorGroupsService=i,this._dialogService=o,s.setPreviewHandler(e=>this._previewEdit(e)),this._ctxEnabled=oc.ctxEnabled.bindTo(r)}async _previewEdit(e){var t,i;this._ctxEnabled.set(!0);let o,s=null!==(t=null===(i=this._activeSession)||void 0===i?void 0:i.uxState)&&void 0!==t?t:new nc(this._paneCompositeService,this._editorGroupsService),r=await rc(this._viewsService);if(!r)return this._ctxEnabled.set(!1),e;if(r.hasInput()){let{confirmed:e}=await this._dialogService.confirm({type:at.Ud.Info,message:(0,at.EM)(4414,"Another refactoring is being previewed."),detail:(0,at.EM)(4415,"Press 'Continue' to discard the previous refactoring and continue with the current refactoring."),primaryButton:(0,at.EM)(4416,"&&Continue")});if(!e)return[]}this._activeSession?(await this._activeSession.uxState.restore(!1,!0),this._activeSession.cts.dispose(!0),o=new ac(s)):o=new ac(s),this._activeSession=o;try{var n;return null!==(n=await r.setInput(e,o.cts.token))&&void 0!==n?n:[]}finally{this._activeSession===o&&(await this._activeSession.uxState.restore(!0,!0),this._activeSession.cts.dispose(),this._ctxEnabled.set(!1),this._activeSession=void 0)}}},{_:oc=ge},{_:ge.ID="workbench.contrib.bulkEditPreview"},{_:ge.ctxEnabled=new at.Nk("refactorPreview.enabled",!1)},ge);dc=oc=(0,at.Jb)([(0,at.Yb)(0,pt.Ot),(0,at.Yb)(1,ut._g),(0,at.Yb)(2,bt.W),(0,at.Yb)(3,at.zl),(0,at.Yb)(4,at.wo),(0,at.Yb)(5,at.Nb)],dc),(0,at.Db)(class extends at.bb{constructor(){super({id:"refactorPreview.apply",title:(0,at.DM)(4417,"Apply Refactoring"),category:(0,at.DM)(4418,"Refactor Preview"),icon:at.fO.check,precondition:at.Mk.and(dc.ctxEnabled,sc.ctxHasCheckedChanges),menu:[{id:at.xb.BulkEditContext,order:1}],keybinding:{weight:at.Ob.EditorContrib-10,when:at.Mk.and(dc.ctxEnabled,pt.yn.isEqualTo(sc.ID)),primary:at.JO.CtrlCmd+at.KO.Enter}})}async run(e){var t;null===(t=await rc(e.get(ut._g)))||void 0===t||t.accept()}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"refactorPreview.discard",title:(0,at.DM)(4419,"Discard Refactoring"),category:(0,at.DM)(4418,"Refactor Preview"),icon:at.fO.clearAll,precondition:dc.ctxEnabled,menu:[{id:at.xb.BulkEditContext,order:2}]})}async run(e){var t;null===(t=await rc(e.get(ut._g)))||void 0===t||t.discard()}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"refactorPreview.toggleCheckedState",title:(0,at.DM)(4420,"Toggle Change"),category:(0,at.DM)(4418,"Refactor Preview"),precondition:dc.ctxEnabled,keybinding:{weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.Space},menu:{id:at.xb.BulkEditContext,group:"navigation"}})}async run(e){var t;null===(t=await rc(e.get(ut._g)))||void 0===t||t.toggleChecked()}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"refactorPreview.groupByFile",title:(0,at.DM)(4421,"Group Changes By File"),category:(0,at.DM)(4418,"Refactor Preview"),icon:at.fO.ungroupByRefType,precondition:at.Mk.and(sc.ctxHasCategories,sc.ctxGroupByFile.negate(),dc.ctxEnabled),menu:[{id:at.xb.BulkEditTitle,when:at.Mk.and(sc.ctxHasCategories,sc.ctxGroupByFile.negate()),group:"navigation",order:3}]})}async run(e){var t;null===(t=await rc(e.get(ut._g)))||void 0===t||t.groupByFile()}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"refactorPreview.groupByType",title:(0,at.DM)(4422,"Group Changes By Type"),category:(0,at.DM)(4418,"Refactor Preview"),icon:at.fO.groupByRefType,precondition:at.Mk.and(sc.ctxHasCategories,sc.ctxGroupByFile,dc.ctxEnabled),menu:[{id:at.xb.BulkEditTitle,when:at.Mk.and(sc.ctxHasCategories,sc.ctxGroupByFile),group:"navigation",order:3}]})}async run(e){var t;null===(t=await rc(e.get(ut._g)))||void 0===t||t.groupByType()}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"refactorPreview.toggleGrouping",title:(0,at.DM)(4422,"Group Changes By Type"),category:(0,at.DM)(4418,"Refactor Preview"),icon:at.fO.listTree,toggled:sc.ctxGroupByFile.negate(),precondition:at.Mk.and(sc.ctxHasCategories,dc.ctxEnabled),menu:[{id:at.xb.BulkEditContext,order:3}]})}async run(e){var t;null===(t=await rc(e.get(ut._g)))||void 0===t||t.toggleGrouping()}}),(0,bt.x)(dc.ID,dc,bt.y.BlockRestore);var lc=(0,at.K)("refactor-preview-view-icon",at.fO.lightbulb,(0,at.EM)(4423,"View icon of the refactor preview view.")),cc=at.jb.as(ut.uf.ViewContainersRegistry).registerViewContainer({id:sc.ID,title:(0,at.DM)(4424,"Refactor Preview"),hideIfEmpty:!0,ctorDescriptor:new at.Xp(ut.A,[sc.ID,{mergeViewWithContainerWhenSingleView:!0}]),icon:lc,storageId:sc.ID},ut.gf.Panel);at.jb.as(ut.uf.ViewsRegistry).registerViews([{id:sc.ID,name:(0,at.DM)(4424,"Refactor Preview"),when:dc.ctxEnabled,ctorDescriptor:new at.Xp(sc),containerIcon:lc}],cc),(0,at.r)(),(0,at.Zp)(),(0,at.To)();(0,ut.At)(),(0,at.LA)(),(0,at.rl)(),(0,at.Sn)(),(0,at.eO)(),(0,at.rA)(),(0,at.vO)(),(0,at.TM)(),(0,at.Vb)(),(0,at.oS)();var hc,uc,gc=class{constructor(e,t,i,o){this.item=e,this.locations=t,this.model=i,this.parent=o}static compare(e,t){let i=(0,at.Bk)(e.item.uri.toString(),t.item.uri.toString());return 0===i&&(i=at._O.compareRangesUsingStarts(e.item.range,t.item.range)),i}},pc=class{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof ut.Ot)return e.roots.map(t=>new gc(t,void 0,e,void 0));let{model:t,item:i}=e;return this.getDirection()===ut.Dt.CallsFrom?(await t.resolveOutgoingCalls(i,at.PA.None)).map(o=>new gc(o.to,o.fromRanges.map(e=>({range:e,uri:i.uri})),t,e)):(await t.resolveIncomingCalls(i,at.PA.None)).map(i=>new gc(i.from,i.fromRanges.map(e=>({range:e,uri:i.from.uri})),t,e))}},bc=class{compare(e,t){return gc.compare(e,t)}},mc=class{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}},vc=class{constructor(e,t){this.icon=e,this.label=t}},Cc=(pe=class e{constructor(){this.templateId=e.id}renderTemplate(e){e.classList.add("callhierarchy-element");let t=(0,at.jx)("div");return e.appendChild(t),new vc(t,new at.xn(e,{supportHighlights:!0}))}renderElement(e,t,i){var o;let{element:s,filterData:r}=e,n=null===(o=s.item.tags)||void 0===o?void 0:o.includes(at.JD.Deprecated);i.icon.className="",i.icon.classList.add("inline",...at.Bb.asClassNameArray(at.qD.toIcon(s.item.kind))),i.label.setLabel(s.item.name,s.item.detail,{labelEscapeNewLines:!0,matches:(0,at.el)(r),strikethrough:n})}disposeTemplate(e){e.label.dispose()}},{_:pe.id="CallRenderer"},pe),wc=class{getHeight(e){return 22}getTemplateId(e){return Cc.id}},yc=class{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return(0,at.EM)(4464,"Call Hierarchy")}getAriaLabel(e){return this.getDirection()===ut.Dt.CallsFrom?(0,at.EM)(4465,"calls from {0}",e.item.name):(0,at.EM)(4466,"callers of {0}",e.item.name)}};(0,at.vE)(),(0,at.Xb)(),(0,at.ox)(),(0,ut.At)(),(0,at.Ct)(),(0,at.TM)(),(0,at.iv)(),(0,at.vO)(),(0,at.Xt)(),(0,at.oS)(),(0,at.sj)(),(0,bt.At)(),(0,dt.sr)(),(0,at.Qb)(),(0,at.wj)(),(0,at.Cy)(),(0,at.sp)(),(0,at.Xd)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.kv)(),(0,at._n)(),(0,at.Tb)(),(0,at.ni)(),(0,at.Pb)(),(0,at.ei)(),(0,ut.nS)(),(0,ut.Qx)(),(0,at.tn)(),(0,at.bE)({}),function(e){e.Loading="loading",e.Message="message",e.Data="data"}(uc||(uc={}));var fc=class{static store(e,t){t.store("callHierarchyPeekLayout",JSON.stringify(e),at.Ro.PROFILE,at.zo.MACHINE)}static retrieve(e){let t=e.get("callHierarchyPeekLayout",at.Ro.PROFILE,"{}"),i={ratio:.7,height:17};try{return(0,rt.A)((0,rt.A)({},i),JSON.parse(t))}catch(o){return i}}constructor(e,t){this.ratio=e,this.height=t}},Sc=class extends at.it{},Ec=(be=class extends ut.tS{constructor(e,t,i,o,s,r,n,a,d,l,c){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},c),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=r,this._textModelService=n,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=c,this._treeViewStates=new Map,this._previewDisposable=new at.gj,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){fc.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){let t=e.getColor(ut.rS)||at.Ev.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(ut.oS)||at.Ev.transparent,primaryHeadingColor:e.getColor(ut.sS),secondaryHeadingColor:e.getColor(ut.cS)})}_fillHead(e){super._fillHead(e,!0);let t=this._menuService.createMenu(hc.TitleMenu,this._contextKeyService),i=()=>{let e=(0,at.Qr)(t.getActions());this._actionbarWidget.clear(),this._actionbarWidget.push(e,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=fc.retrieve(this._storageService),this._dim=new at.mx(0,0),this._parent=e,e.classList.add("call-hierarchy");let t=(0,at.jx)("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;let i=(0,at.jx)("div");i.classList.add("results"),e.appendChild(i),this._splitView=new at.Yt(i,{orientation:at.Zt.HORIZONTAL});let o=(0,at.jx)("div");o.classList.add("editor"),i.appendChild(o),this._editor=this._instantiationService.createInstance(dt.ar,o,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor);let s=(0,at.jx)("div");s.classList.add("tree"),i.appendChild(s);let r={sorter:new bc,accessibilityProvider:new yc(()=>this._direction),identityProvider:new mc(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ut.aS}};this._tree=this._instantiationService.createInstance(Sc,"CallHierarchyPeek",s,new wc,[this._instantiationService.createInstance(Cc)],this._instantiationService.createInstance(pc,()=>this._direction),r),this._splitView.addView({onDidChange:at.tj.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:e})}},at.Jt.Distribute),this._splitView.addView({onDidChange:at.tj.None,element:s,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._tree.layout(this._dim.height,e)}},at.Jt.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(e=>{let{event:t,target:i}=e;if(2!==t.detail)return;let[o]=this._tree.getFocus();o&&(this.dispose(),this._editorService.openEditor({resource:o.item.uri,options:{selection:i.range}}))})),this._disposables.add(this._tree.onMouseDblClick(e=>{e.target!==at.hn.Twistie&&e.element&&(this.dispose(),this._editorService.openEditor({resource:e.element.item.uri,options:{selection:e.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(e=>{let[t]=e.elements;t&&(0,at.xS)(e.browserEvent)&&(this.dispose(),this._editorService.openEditor({resource:t.item.uri,options:{selection:t.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){let[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();let t,i={description:"call-hierarchy-decoration",stickiness:at.Sy.NeverGrowsWhenTypingAtEdges,className:"call-decoration",overviewRuler:{color:(0,at.lp)(ut.iS),position:at.vy.Center}};t=this._direction===ut.Dt.CallsFrom?e.parent?e.parent.item.uri:e.model.root.uri:e.item.uri;let o=await this._textModelService.createModelReference(t);this._editor.setModel(o.object.textEditorModel);let s,r=[],n=e.locations;n||(n=[{uri:e.item.uri,range:e.item.selectionRange}]);for(let d of n)d.uri.toString()===t.toString()&&(r.push({range:d.range,options:i}),s=s?at._O.plusRange(d.range,s):d.range);if(s){this._editor.revealRangeInCenter(s,at.rv.Immediate);let e=this._editor.createDecorationsCollection(r);this._previewDisposable.add((0,at.kj)(()=>e.clear()))}this._previewDisposable.add(o);let a=this._direction===ut.Dt.CallsFrom?(0,at.EM)(4459,"Calls from '{0}'",e.model.root.name):(0,at.EM)(4460,"Callers of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state=uc.Loading,this.setTitle((0,at.EM)(4461,"Loading...")),this._show()}showMessage(e){this._parent.dataset.state=uc.Message,this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();let t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);let i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),0===i.children.length?this.showMessage(this._direction===ut.Dt.CallsFrom?(0,at.EM)(4462,"No calls from '{0}'",e.root.name):(0,at.EM)(4463,"No callers of '{0}'",e.root.name)):(this._parent.dataset.state=uc.Data,(!t||0===this._tree.getFocus().length)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){let t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,at.rv.Smooth),super.show(at._O.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new at.mx(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}},{_:hc=be},{_:be.TitleMenu=new at.xb("callhierarchy/title")},be);Ec=hc=(0,at.Jb)([(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,ut.Zx),(0,at.Yb)(5,bt.kt),(0,at.Yb)(6,at.Zb),(0,at.Yb)(7,at.Io),(0,at.Yb)(8,at.ti),(0,at.Yb)(9,at.Nb),(0,at.Yb)(10,at.rx)],Ec),(0,at.Xb)(),(0,at.TM)(),(0,ut.At)(),(0,at.LA)(),(0,at.ox)(),(0,at.sj)(),(0,at.ob)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.wj)(),(0,at.Ab)(),(0,at.QO)(),(0,at.Gp)(),(0,ut.nS)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.nx)(),(0,at.vO)(),(0,at.Tb)(),(0,at.pO)(),(0,at.G)(),(0,at.aP)();var kc,_c=new at.Nk("editorHasCallHierarchyProvider",!1,(0,at.EM)(4447,"Whether a call hierarchy provider is available")),Ic=new at.Nk("callHierarchyVisible",!1,(0,at.EM)(4448,"Whether call hierarchy peek is currently showing")),xc=new at.Nk("callHierarchyDirection",void 0,{type:"string",description:(0,at.EM)(4449,"Whether call hierarchy shows incoming or outgoing calls")});var Ac=(me=class{static get(e){return e.getContribution(kc.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._dispoables=new at.gj,this._sessionDisposables=new at.gj,this._ctxIsVisible=Ic.bindTo(this._contextKeyService),this._ctxHasProvider=_c.bindTo(this._contextKeyService),this._ctxDirection=xc.bindTo(this._contextKeyService),this._dispoables.add(at.tj.any(e.onDidChangeModel,e.onDidChangeModelLanguage,ut.kt.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&ut.kt.has(e.getModel()))})),this._dispoables.add(this._sessionDisposables)}dispose(){this._ctxHasProvider.reset(),this._ctxIsVisible.reset(),this._dispoables.dispose()}async startCallHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;let e=this._editor.getModel(),t=this._editor.getPosition();if(!ut.kt.has(e))return;let i=new at.FA,o=ut.Ot.create(e,t,i.token),s=function(e){return e===ut.Dt.CallsFrom||e===ut.Dt.CallsTo?e:ut.Dt.CallsTo}(this._storageService.get(kc._StorageDirection,at.Ro.PROFILE,ut.Dt.CallsTo));this._showCallHierarchyWidget(t,s,o,i)}async startCallHierarchyFromCallHierarchy(){var e;if(!this._widget)return;let t=this._widget.getModel(),i=this._widget.getFocused();if(!i||!t)return;let o=await this._editorService.openCodeEditor({resource:i.item.uri},this._editor);if(!o)return;let s=t.fork(i.item);this._sessionDisposables.clear(),null===(e=kc.get(o))||void 0===e||e._showCallHierarchyWidget(at._O.lift(s.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(s),new at.FA)}_showCallHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),at.tj.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endCallHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(Ec,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endCallHierarchy(),this._storageService.store(kc._StorageDirection,this._widget.direction,at.Ro.PROFILE,at.zo.USER)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(e=>{o.token.isCancellationRequested||(e?(this._sessionDisposables.add(e),this._widget.showModel(e)):this._widget.showMessage((0,at.EM)(4450,"No results")))}).catch(e=>{(0,at.oP)(e)?this.endCallHierarchy():this._widget.showMessage((0,at.EM)(4451,"Failed to show call hierarchy"))})}showOutgoingCalls(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(ut.Dt.CallsFrom),this._ctxDirection.set(ut.Dt.CallsFrom)}showIncomingCalls(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(ut.Dt.CallsTo),this._ctxDirection.set(ut.Dt.CallsTo)}endCallHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}},{_:kc=me},{_:me.Id="callHierarchy"},{_:me._StorageDirection="callHierarchy/defaultDirection"},me);Ac=kc=(0,at.Jb)([(0,at.Yb)(1,at.Nb),(0,at.Yb)(2,at.Io),(0,at.Yb)(3,at.tx),(0,at.Yb)(4,at.rx)],Ac),(0,at.ub)(Ac.Id,Ac,at.$y.Eager),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.showCallHierarchy",title:(0,at.DM)(4452,"Peek Call Hierarchy"),menu:{id:at.xb.EditorContextPeek,group:"navigation",order:1e3,when:at.Mk.and(_c,ut.$x.notInPeekEditor,at.Wp.isInEmbeddedEditor.toNegated())},keybinding:{when:at.Wp.editorTextFocus,weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift+at.JO.Alt+at.KO.KeyH},precondition:at.Mk.and(_c,ut.$x.notInPeekEditor),f1:!0})}async runEditorCommand(e,t){var i;return null===(i=Ac.get(t))||void 0===i?void 0:i.startCallHierarchyFromEditor()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.showIncomingCalls",title:(0,at.DM)(4453,"Show Incoming Calls"),icon:(0,at.K)("callhierarchy-incoming",at.fO.callIncoming,(0,at.EM)(4454,"Icon for incoming calls in the call hierarchy view.")),precondition:at.Mk.and(Ic,xc.isEqualTo(ut.Dt.CallsFrom)),keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift+at.JO.Alt+at.KO.KeyH},menu:{id:Ec.TitleMenu,when:xc.isEqualTo(ut.Dt.CallsFrom),order:1}})}runEditorCommand(e,t){var i;return null===(i=Ac.get(t))||void 0===i?void 0:i.showIncomingCalls()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.showOutgoingCalls",title:(0,at.DM)(4455,"Show Outgoing Calls"),icon:(0,at.K)("callhierarchy-outgoing",at.fO.callOutgoing,(0,at.EM)(4456,"Icon for outgoing calls in the call hierarchy view.")),precondition:at.Mk.and(Ic,xc.isEqualTo(ut.Dt.CallsTo)),keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift+at.JO.Alt+at.KO.KeyH},menu:{id:Ec.TitleMenu,when:xc.isEqualTo(ut.Dt.CallsTo),order:1}})}runEditorCommand(e,t){var i;return null===(i=Ac.get(t))||void 0===i?void 0:i.showOutgoingCalls()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.refocusCallHierarchy",title:(0,at.DM)(4457,"Refocus Call Hierarchy"),precondition:Ic,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift+at.KO.Enter}})}async runEditorCommand(e,t){var i;return null===(i=Ac.get(t))||void 0===i?void 0:i.startCallHierarchyFromCallHierarchy()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.closeCallHierarchy",title:(0,at.EM)(4458,"Close"),icon:at.fO.close,precondition:Ic,keybinding:{weight:at.Ob.WorkbenchContrib+10,primary:at.KO.Escape,when:at.Mk.not("config.editor.stablePeek")},menu:{id:Ec.TitleMenu,order:1e3}})}runEditorCommand(e,t){var i;return null===(i=Ac.get(t))||void 0===i?void 0:i.endCallHierarchy()}});(0,ut.Et)(),(0,at.LA)(),(0,at.rl)(),(0,at.Sn)(),(0,at.eO)(),(0,at.rA)(),(0,at.vO)(),(0,at.TM)(),(0,at.Vb)(),(0,at.oS)();var Vc,Dc,Mc=class{constructor(e,t,i){this.item=e,this.model=t,this.parent=i}static compare(e,t){let i=(0,at.Bk)(e.item.uri.toString(),t.item.uri.toString());return 0===i&&(i=at._O.compareRangesUsingStarts(e.item.range,t.item.range)),i}},Tc=class{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof ut.wt)return e.roots.map(t=>new Mc(t,e,void 0));let{model:t,item:i}=e;return this.getDirection()===ut.Ct.Supertypes?(await t.provideSupertypes(i,at.PA.None)).map(i=>new Mc(i,t,e)):(await t.provideSubtypes(i,at.PA.None)).map(i=>new Mc(i,t,e))}},Rc=class{compare(e,t){return Mc.compare(e,t)}},Oc=class{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}},Wc=class{constructor(e,t){this.icon=e,this.label=t}},Lc=(ve=class e{constructor(){this.templateId=e.id}renderTemplate(e){e.classList.add("typehierarchy-element");let t=(0,at.jx)("div");return e.appendChild(t),new Wc(t,new at.xn(e,{supportHighlights:!0}))}renderElement(e,t,i){var o;let{element:s,filterData:r}=e,n=null===(o=s.item.tags)||void 0===o?void 0:o.includes(at.JD.Deprecated);i.icon.classList.add("inline",...at.Bb.asClassNameArray(at.qD.toIcon(s.item.kind))),i.label.setLabel(s.item.name,s.item.detail,{labelEscapeNewLines:!0,matches:(0,at.el)(r),strikethrough:n})}disposeTemplate(e){e.label.dispose()}},{_:ve.id="TypeRenderer"},ve),Jc=class{getHeight(e){return 22}getTemplateId(e){return Lc.id}},Gc=class{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return(0,at.EM)(12212,"Type Hierarchy")}getAriaLabel(e){return this.getDirection()===ut.Ct.Supertypes?(0,at.EM)(12213,"supertypes of {0}",e.item.name):(0,at.EM)(12214,"subtypes of {0}",e.item.name)}};(0,at.vE)(),(0,at.Xb)(),(0,at.oS)(),(0,at.Xt)(),(0,at._n)(),(0,at.kv)(),(0,at.sj)(),(0,at.wj)(),(0,dt.sr)(),(0,at.vO)(),(0,at.iv)(),(0,at.Cy)(),(0,at.Qb)(),(0,at.TM)(),(0,at.ei)(),(0,at.Tb)(),(0,at.ni)(),(0,at.Pb)(),(0,at.ox)(),(0,at.Ct)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.sp)(),(0,at.Xd)(),(0,ut.Et)(),(0,bt.At)(),(0,ut.nS)(),(0,ut.Qx)(),(0,at.tn)(),(0,at.bE)({}),function(e){e.Loading="loading",e.Message="message",e.Data="data"}(Dc||(Dc={}));var Nc=class{static store(e,t){t.store("typeHierarchyPeekLayout",JSON.stringify(e),at.Ro.PROFILE,at.zo.MACHINE)}static retrieve(e){let t=e.get("typeHierarchyPeekLayout",at.Ro.PROFILE,"{}"),i={ratio:.7,height:17};try{return(0,rt.A)((0,rt.A)({},i),JSON.parse(t))}catch(o){return i}}constructor(e,t){this.ratio=e,this.height=t}},Kc=class extends at.it{},Zc=(Ce=class extends ut.tS{constructor(e,t,i,o,s,r,n,a,d,l,c){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},c),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=r,this._textModelService=n,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=c,this._treeViewStates=new Map,this._previewDisposable=new at.gj,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){Nc.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){let t=e.getColor(ut.rS)||at.Ev.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(ut.oS)||at.Ev.transparent,primaryHeadingColor:e.getColor(ut.sS),secondaryHeadingColor:e.getColor(ut.cS)})}_fillHead(e){super._fillHead(e,!0);let t=this._menuService.createMenu(Vc.TitleMenu,this._contextKeyService),i=()=>{let e=(0,at.Qr)(t.getActions());this._actionbarWidget.clear(),this._actionbarWidget.push(e,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=Nc.retrieve(this._storageService),this._dim=new at.mx(0,0),this._parent=e,e.classList.add("type-hierarchy");let t=(0,at.jx)("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;let i=(0,at.jx)("div");i.classList.add("results"),e.appendChild(i),this._splitView=new at.Yt(i,{orientation:at.Zt.HORIZONTAL});let o=(0,at.jx)("div");o.classList.add("editor"),i.appendChild(o),this._editor=this._instantiationService.createInstance(dt.ar,o,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor);let s=(0,at.jx)("div");s.classList.add("tree"),i.appendChild(s);let r={sorter:new Rc,accessibilityProvider:new Gc(()=>this._direction),identityProvider:new Oc(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ut.aS}};this._tree=this._instantiationService.createInstance(Kc,"TypeHierarchyPeek",s,new Jc,[this._instantiationService.createInstance(Lc)],this._instantiationService.createInstance(Tc,()=>this._direction),r),this._splitView.addView({onDidChange:at.tj.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:e})}},at.Jt.Distribute),this._splitView.addView({onDidChange:at.tj.None,element:s,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._tree.layout(this._dim.height,e)}},at.Jt.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(e=>{let{event:t,target:i}=e;if(2!==t.detail)return;let[o]=this._tree.getFocus();o&&(this.dispose(),this._editorService.openEditor({resource:o.item.uri,options:{selection:i.range}}))})),this._disposables.add(this._tree.onMouseDblClick(e=>{e.target!==at.hn.Twistie&&e.element&&(this.dispose(),this._editorService.openEditor({resource:e.element.item.uri,options:{selection:e.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(e=>{let[t]=e.elements;t&&(0,at.xS)(e.browserEvent)&&(this.dispose(),this._editorService.openEditor({resource:t.item.uri,options:{selection:t.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){let[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();let t,i={description:"type-hierarchy-decoration",stickiness:at.Sy.NeverGrowsWhenTypingAtEdges,className:"type-decoration",overviewRuler:{color:(0,at.lp)(ut.iS),position:at.vy.Center}};t=this._direction===ut.Ct.Supertypes?e.parent?e.parent.item.uri:e.model.root.uri:e.item.uri;let o=await this._textModelService.createModelReference(t);this._editor.setModel(o.object.textEditorModel);let s,r=[],n={uri:e.item.uri,range:e.item.selectionRange};if(n.uri.toString()===t.toString()&&(r.push({range:n.range,options:i}),s=s?at._O.plusRange(n.range,s):n.range),s){this._editor.revealRangeInCenter(s,at.rv.Immediate);let e=this._editor.createDecorationsCollection(r);this._previewDisposable.add((0,at.kj)(()=>e.clear()))}this._previewDisposable.add(o);let a=this._direction===ut.Ct.Supertypes?(0,at.EM)(12207,"Supertypes of '{0}'",e.model.root.name):(0,at.EM)(12208,"Subtypes of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state=Dc.Loading,this.setTitle((0,at.EM)(12209,"Loading...")),this._show()}showMessage(e){this._parent.dataset.state=Dc.Message,this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();let t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);let i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),0===i.children.length?this.showMessage(this._direction===ut.Ct.Supertypes?(0,at.EM)(12210,"No supertypes of '{0}'",e.root.name):(0,at.EM)(12211,"No subtypes of '{0}'",e.root.name)):(this._parent.dataset.state=Dc.Data,(!t||0===this._tree.getFocus().length)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){let t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,at.rv.Smooth),super.show(at._O.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new at.mx(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}},{_:Vc=Ce},{_:Ce.TitleMenu=new at.xb("typehierarchy/title")},Ce);Zc=Vc=(0,at.Jb)([(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,ut.Zx),(0,at.Yb)(5,bt.kt),(0,at.Yb)(6,at.Zb),(0,at.Yb)(7,at.Io),(0,at.Yb)(8,at.ti),(0,at.Yb)(9,at.Nb),(0,at.Yb)(10,at.rx)],Zc),(0,at.Xb)(),(0,at.LA)(),(0,at.pO)(),(0,at.aP)(),(0,at.sj)(),(0,at.QO)(),(0,at.wj)(),(0,at.ob)(),(0,at.nx)(),(0,at.vO)(),(0,ut.nS)(),(0,at.TM)(),(0,at.Tb)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.ox)(),(0,at.Ab)(),(0,at.Vo)(),(0,at.Lo)(),(0,ut.Et)();var Bc,Pc=new at.Nk("editorHasTypeHierarchyProvider",!1,(0,at.EM)(12197,"Whether a type hierarchy provider is available")),Fc=new at.Nk("typeHierarchyVisible",!1,(0,at.EM)(12198,"Whether type hierarchy peek is currently showing")),Yc=new at.Nk("typeHierarchyDirection",void 0,{type:"string",description:(0,at.EM)(12199,"whether type hierarchy shows super types or subtypes")});var Qc=(we=class{static get(e){return e.getContribution(Bc.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._disposables=new at.gj,this._sessionDisposables=new at.gj,this._ctxHasProvider=Pc.bindTo(this._contextKeyService),this._ctxIsVisible=Fc.bindTo(this._contextKeyService),this._ctxDirection=Yc.bindTo(this._contextKeyService),this._disposables.add(at.tj.any(e.onDidChangeModel,e.onDidChangeModelLanguage,ut.Tt.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&ut.Tt.has(e.getModel()))})),this._disposables.add(this._sessionDisposables)}dispose(){this._disposables.dispose()}async startTypeHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;let e=this._editor.getModel(),t=this._editor.getPosition();if(!ut.Tt.has(e))return;let i=new at.FA,o=ut.wt.create(e,t,i.token),s=function(e){return e===ut.Ct.Subtypes||e===ut.Ct.Supertypes?e:ut.Ct.Subtypes}(this._storageService.get(Bc._storageDirectionKey,at.Ro.PROFILE,ut.Ct.Subtypes));this._showTypeHierarchyWidget(t,s,o,i)}_showTypeHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),at.tj.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endTypeHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(Zc,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endTypeHierarchy(),this._storageService.store(Bc._storageDirectionKey,this._widget.direction,at.Ro.PROFILE,at.zo.USER)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(e=>{o.token.isCancellationRequested||(e?(this._sessionDisposables.add(e),this._widget.showModel(e)):this._widget.showMessage((0,at.EM)(12200,"No results")))}).catch(e=>{(0,at.oP)(e)?this.endTypeHierarchy():this._widget.showMessage((0,at.EM)(12201,"Failed to show type hierarchy"))})}async startTypeHierarchyFromTypeHierarchy(){var e;if(!this._widget)return;let t=this._widget.getModel(),i=this._widget.getFocused();if(!i||!t)return;let o=await this._editorService.openCodeEditor({resource:i.item.uri},this._editor);if(!o)return;let s=t.fork(i.item);this._sessionDisposables.clear(),null===(e=Bc.get(o))||void 0===e||e._showTypeHierarchyWidget(at._O.lift(s.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(s),new at.FA)}showSupertypes(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(ut.Ct.Supertypes),this._ctxDirection.set(ut.Ct.Supertypes)}showSubtypes(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(ut.Ct.Subtypes),this._ctxDirection.set(ut.Ct.Subtypes)}endTypeHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}},{_:Bc=we},{_:we.Id="typeHierarchy"},{_:we._storageDirectionKey="typeHierarchy/defaultDirection"},we);function Xc(e){let t=null===e||void 0===e?void 0:e.getHTMLElement();t&&!(0,at.cS)(t)&&(null===e||void 0===e||e.domFocus())}async function Hc(e,t){if(!e)return;await async function(e,t){if(!at.dt.getValue(e.contextKeyService))return t(e);let i=e.getFocus(),o=e.getSelection();await t(e);let s=e.getFocus();if(o.length>1||!(0,at.TN)(i,o)||(0,at.TN)(i,s))return;let r=new KeyboardEvent("keydown");e.setSelection(s,r)}(e,t);let i=e.getFocus();i.length&&e.reveal(i[0]),e.setAnchor(i[0]),Xc(e)}function Uc(e,t){if(e instanceof at.Xi||e instanceof at.in||e instanceof at.Gt){let i=e,o=i.getFocus()?i.getFocus()[0]:void 0,s=i.getSelection();s&&"number"==typeof o&&s.indexOf(o)>=0?i.setSelection(s.filter(e=>e!==t)):"number"==typeof o&&i.setSelection(s.concat(o))}else if(e instanceof at.Ut||e instanceof at.zt||e instanceof at.Vt){let i=e,o=i.getFocus()?i.getFocus()[0]:void 0;if(t===o)return;let s=i.getSelection(),r=new KeyboardEvent("keydown",{shiftKey:!0});s&&s.indexOf(o)>=0?i.setSelection(s.filter(e=>e!==t),r):i.setSelection(s.concat(o),r)}}function jc(e,t){let i=e.getStickyScrollFocus();if(0===i.length)throw Error("StickyScroll has no focus");if(i.length>1)throw Error("StickyScroll can only have a single focused item");e.reveal(i[0]),e.getHTMLElement().focus(),e.setFocus(i),null===t||void 0===t||t(i[0])}function zc(e,t){let i=e.get(at.wt).lastFocusedList,o=(0,at.St)("keydown",t);if(i instanceof at.Xi||i instanceof at.in||i instanceof at.Gt){let e=i;e.setAnchor(e.getFocus()[0]),e.setSelection(e.getFocus(),o)}else if(i instanceof at.Ut||i instanceof at.zt||i instanceof at.Vt){let e=i,t=e.getFocus();if(t.length>0){let i=!0;(!0===e.expandOnlyOnTwistieClick||"boolean"!=typeof e.expandOnlyOnTwistieClick&&e.expandOnlyOnTwistieClick(t[0]))&&(i=!1),i&&e.toggleCollapsed(t[0])}e.setAnchor(t[0]),e.setSelection(t,o)}}Qc=Bc=(0,at.Jb)([(0,at.Yb)(1,at.Nb),(0,at.Yb)(2,at.Io),(0,at.Yb)(3,at.tx),(0,at.Yb)(4,at.rx)],Qc),(0,at.ub)(Qc.Id,Qc,at.$y.Eager),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.showTypeHierarchy",title:(0,at.DM)(12202,"Peek Type Hierarchy"),menu:{id:at.xb.EditorContextPeek,group:"navigation",order:1e3,when:at.Mk.and(Pc,ut.$x.notInPeekEditor)},precondition:at.Mk.and(Pc,ut.$x.notInPeekEditor),f1:!0})}async runEditorCommand(e,t){var i;return null===(i=Qc.get(t))||void 0===i?void 0:i.startTypeHierarchyFromEditor()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.showSupertypes",title:(0,at.DM)(12203,"Show Supertypes"),icon:at.fO.typeHierarchySuper,precondition:at.Mk.and(Fc,Yc.isEqualTo(ut.Ct.Subtypes)),keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift+at.JO.Alt+at.KO.KeyH},menu:{id:Zc.TitleMenu,when:Yc.isEqualTo(ut.Ct.Subtypes),order:1}})}runEditorCommand(e,t){var i;return null===(i=Qc.get(t))||void 0===i?void 0:i.showSupertypes()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.showSubtypes",title:(0,at.DM)(12204,"Show Subtypes"),icon:at.fO.typeHierarchySub,precondition:at.Mk.and(Fc,Yc.isEqualTo(ut.Ct.Supertypes)),keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift+at.JO.Alt+at.KO.KeyH},menu:{id:Zc.TitleMenu,when:Yc.isEqualTo(ut.Ct.Supertypes),order:1}})}runEditorCommand(e,t){var i;return null===(i=Qc.get(t))||void 0===i?void 0:i.showSubtypes()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.refocusTypeHierarchy",title:(0,at.DM)(12205,"Refocus Type Hierarchy"),precondition:Fc,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift+at.KO.Enter}})}async runEditorCommand(e,t){var i;return null===(i=Qc.get(t))||void 0===i?void 0:i.startTypeHierarchyFromTypeHierarchy()}}),(0,at.Db)(class extends at.Zy{constructor(){super({id:"editor.closeTypeHierarchy",title:(0,at.EM)(12206,"Close"),icon:at.fO.close,precondition:Fc,keybinding:{weight:at.Ob.WorkbenchContrib+10,primary:at.KO.Escape,when:at.Mk.not("config.editor.stablePeek")},menu:{id:Zc.TitleMenu,order:1e3}})}runEditorCommand(e,t){var i;return null===(i=Qc.get(t))||void 0===i?void 0:i.endTypeHierarchy()}}),(0,at.QO)(),(0,at.Ab)(),(0,at.Zi)(),(0,at.Ct)(),(0,at.Tt)(),(0,at.an)(),(0,at.AN)(),(0,at.Pk)(),(0,at.Wt)(),(0,at.Ht)(),(0,at.Bt)(),(0,at.Ib)(),(0,at.Kt)(),(0,at.pn)(),(0,at.oS)(),(0,at.Tb)(),(0,at.i_)(),(0,at.TM)(),(0,at.rr)(),at.kb.registerCommandAndKeybindingRule({id:"list.focusDown",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.DownArrow,mac:{primary:at.KO.DownArrow,secondary:[at.JO.WinCtrl|at.KO.KeyN]},handler:(e,t)=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown");await e.focusNext("number"==typeof t?t:1,!1,i)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusUp",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.UpArrow,mac:{primary:at.KO.UpArrow,secondary:[at.JO.WinCtrl|at.KO.KeyP]},handler:(e,t)=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown");await e.focusPrevious("number"==typeof t?t:1,!1,i)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusAnyDown",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.JO.Alt|at.KO.DownArrow,mac:{primary:at.JO.Alt|at.KO.DownArrow,secondary:[at.JO.WinCtrl|at.JO.Alt|at.KO.KeyN]},handler:(e,t)=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown",{altKey:!0});await e.focusNext("number"==typeof t?t:1,!1,i)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusAnyUp",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.JO.Alt|at.KO.UpArrow,mac:{primary:at.JO.Alt|at.KO.UpArrow,secondary:[at.JO.WinCtrl|at.JO.Alt|at.KO.KeyP]},handler:(e,t)=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown",{altKey:!0});await e.focusPrevious("number"==typeof t?t:1,!1,i)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusPageDown",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.PageDown,handler:e=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusNextPage(t)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusPageUp",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.PageUp,handler:e=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusPreviousPage(t)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusFirst",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.Home,handler:e=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusFirst(t)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusLast",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.End,handler:e=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusLast(t)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusAnyFirst",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.JO.Alt|at.KO.Home,handler:e=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown",{altKey:!0});await e.focusFirst(t)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusAnyLast",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.JO.Alt|at.KO.End,handler:e=>{Hc(e.get(at.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown",{altKey:!0});await e.focusLast(t)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.expandSelectionDown",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,at.pt),primary:at.JO.Shift|at.KO.DownArrow,handler:(e,t)=>{let i=e.get(at.wt).lastFocusedList;if(!i)return;let o=i.getFocus()?i.getFocus()[0]:void 0,s=new KeyboardEvent("keydown");i.focusNext("number"==typeof t?t:1,!1,s),Uc(i,o);let r=i.getFocus();r.length&&i.reveal(r[0]),Xc(i)}}),at.kb.registerCommandAndKeybindingRule({id:"list.expandSelectionUp",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,at.pt),primary:at.JO.Shift|at.KO.UpArrow,handler:(e,t)=>{let i=e.get(at.wt).lastFocusedList;if(!i)return;let o=i.getFocus()?i.getFocus()[0]:void 0,s=new KeyboardEvent("keydown");i.focusPrevious("number"==typeof t?t:1,!1,s),Uc(i,o);let r=i.getFocus();r.length&&i.reveal(r[0]),Xc(i)}}),at.kb.registerCommandAndKeybindingRule({id:"list.collapse",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,at.Mk.or(at.gt,at.yt)),primary:at.KO.LeftArrow,mac:{primary:at.KO.LeftArrow,secondary:[at.JO.CtrlCmd|at.KO.UpArrow]},handler:e=>{let t=e.get(at.wt).lastFocusedList;if(!t||!(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt))return;let i=t,o=i.getFocus();if(0===o.length)return;let s=o[0];if(!i.collapse(s)){let e=i.getParentElement(s);e&&Hc(t,t=>{let i=new KeyboardEvent("keydown");t.setFocus([e],i)})}}}),at.kb.registerCommandAndKeybindingRule({id:"list.stickyScroll.collapse",weight:at.Ob.WorkbenchContrib+50,when:at.xt,primary:at.KO.LeftArrow,mac:{primary:at.KO.LeftArrow,secondary:[at.JO.CtrlCmd|at.KO.UpArrow]},handler:e=>{let t=e.get(at.wt).lastFocusedList;!t||!(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt)||jc(t,e=>t.collapse(e))}}),at.kb.registerCommandAndKeybindingRule({id:"list.collapseAll",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.JO.CtrlCmd|at.KO.LeftArrow,mac:{primary:at.JO.CtrlCmd|at.KO.LeftArrow,secondary:[at.JO.CtrlCmd|at.JO.Shift|at.KO.UpArrow]},handler:e=>{let t=e.get(at.wt).lastFocusedList;t&&!(t instanceof at.Xi||t instanceof at.in||t instanceof at.Gt)&&t.collapseAll()}}),at.kb.registerCommandAndKeybindingRule({id:"list.collapseAllToFocus",weight:at.Ob.WorkbenchContrib,when:at.st,handler:e=>{let t=e.get(at.wt).lastFocusedList,i=(0,at.St)("keydown",!0);if(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt){let e=t,o=e.getFocus();o.length>0&&e.collapse(o[0],!0),e.setSelection(o,i),e.setAnchor(o[0])}}}),at.kb.registerCommandAndKeybindingRule({id:"list.focusParent",weight:at.Ob.WorkbenchContrib,when:at.st,handler:e=>{let t=e.get(at.wt).lastFocusedList;if(!t||!(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt))return;let i=t,o=i.getFocus();if(0===o.length)return;let s=o[0],r=i.getParentElement(s);r&&Hc(t,e=>{let t=new KeyboardEvent("keydown");e.setFocus([r],t)})}}),at.kb.registerCommandAndKeybindingRule({id:"list.expand",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,at.Mk.or(at._t,at.vt)),primary:at.KO.RightArrow,handler:e=>{let t=e.get(at.wt).lastFocusedList;if(t)if(t instanceof at.Ut||t instanceof at.zt){let e=t.getFocus();if(0===e.length)return;let i=e[0];if(!t.expand(i)){let e=t.getFirstElementChild(i);e&&t.getNode(e).visible&&Hc(t,t=>{let i=new KeyboardEvent("keydown");t.setFocus([e],i)})}}else if(t instanceof at.Vt){let e=t.getFocus();if(0===e.length)return;let i=e[0];t.expand(i).then(e=>{if(i&&!e){let e=t.getFirstElementChild(i);e&&t.getNode(e).visible&&Hc(t,t=>{let i=new KeyboardEvent("keydown");t.setFocus([e],i)})}})}}}),at.kb.registerCommandAndKeybindingRule({id:"list.select",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.Enter,mac:{primary:at.KO.Enter,secondary:[at.JO.CtrlCmd|at.KO.DownArrow]},handler:e=>{zc(e,!1)}}),at.kb.registerCommandAndKeybindingRule({id:"list.stickyScrollselect",weight:at.Ob.WorkbenchContrib+50,when:at.xt,primary:at.KO.Enter,mac:{primary:at.KO.Enter,secondary:[at.JO.CtrlCmd|at.KO.DownArrow]},handler:e=>{let t=e.get(at.wt).lastFocusedList;!t||!(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt)||jc(t,e=>t.setSelection([e]))}}),at.kb.registerCommandAndKeybindingRule({id:"list.selectAndPreserveFocus",weight:at.Ob.WorkbenchContrib,when:at.st,handler:e=>{zc(e,!0)}}),at.kb.registerCommandAndKeybindingRule({id:"list.selectAll",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,at.pt),primary:at.JO.CtrlCmd|at.KO.KeyA,handler:e=>{let t=e.get(at.wt).lastFocusedList;if(t instanceof at.Xi||t instanceof at.in||t instanceof at.Gt){let e=t,i=new KeyboardEvent("keydown");e.setSelection((0,at.zN)(e.length),i)}else if(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt){let e,i,o=t,s=o.getFocus(),r=o.getSelection();s.length>0&&(0===r.length||!r.includes(s[0]))&&(e=s[0]),!e&&r.length>0&&(e=r[0]),i=e?o.getParentElement(e):void 0;let n=[],a=e=>{for(let t of e.children)t.visible&&(n.push(t.element),t.collapsed||a(t))};a(o.getNode(i)),i&&r.length===n.length&&n.unshift(i);let d=new KeyboardEvent("keydown");o.setSelection(n,d)}}}),at.kb.registerCommandAndKeybindingRule({id:"list.toggleSelection",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.Enter,handler:e=>{let t=e.get(at.wt).lastFocusedList;if(!t)return;let i=t.getFocus();if(0===i.length)return;let o=t.getSelection(),s=o.indexOf(i[0]);s>-1?t.setSelection([...o.slice(0,s),...o.slice(s+1)]):t.setSelection([...o,i[0]])}}),at.kb.registerCommandAndKeybindingRule({id:"list.showHover",weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.KeyI),when:at.st,handler:async function(e){var t;let i=e.get(at.wt).lastFocusedList;if(!i)return;let o=i.getFocus();if(!o||0===o.length)return;let s=null===(t=i.getHTMLElement().querySelector(".monaco-scrollable-element"))||void 0===t||null===(t=t.querySelector(".monaco-list-rows"))||void 0===t?void 0:t.querySelector(".focused");if(!s)return;let r=function(e){if(e.matches('[custom-hover="true"]'))return e;let t=e.querySelector('[custom-hover="true"]:not([tabindex]):not(.action-item)');if(t)return t}(s);r&&e.get(at.nr).showManagedHover(r)}}),at.kb.registerCommandAndKeybindingRule({id:"list.toggleExpand",weight:at.Ob.WorkbenchContrib,when:at.st,primary:at.KO.Space,handler:e=>{let t=e.get(at.wt).lastFocusedList;if(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt){let e=t,i=e.getFocus();if(!e.options.disableExpandOnSpacebar&&i.length>0&&e.isCollapsible(i[0]))return void e.toggleCollapsed(i[0])}zc(e,!0)}}),at.kb.registerCommandAndKeybindingRule({id:"list.stickyScrolltoggleExpand",weight:at.Ob.WorkbenchContrib+50,when:at.xt,primary:at.KO.Space,handler:e=>{let t=e.get(at.wt).lastFocusedList;!t||!(t instanceof at.Ut||t instanceof at.zt||t instanceof at.Vt)||jc(t)}}),at.kb.registerCommandAndKeybindingRule({id:"list.clear",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,at.ct),primary:at.KO.Escape,handler:e=>{let t=e.get(at.wt).lastFocusedList;if(!t)return;let i=t.getSelection(),o=new KeyboardEvent("keydown");if(i.length>1)if(at.dt.getValue(t.contextKeyService)){let e=t.getFocus();t.setSelection([e[0]],o)}else t.setSelection([],o);else t.setSelection([],o),t.setFocus([],o);t.setAnchor(void 0)}}),at.Fb.registerCommand({id:"list.triggerTypeNavigation",handler:e=>{var t;null===(t=e.get(at.wt).lastFocusedList)||void 0===t||t.triggerTypeNavigation()}}),at.Fb.registerCommand({id:"list.toggleFindMode",handler:e=>{let t=e.get(at.wt).lastFocusedList;if(t instanceof at.un||t instanceof at.Vt){let e=t;e.findMode=e.findMode===at.fn.Filter?at.fn.Highlight:at.fn.Filter}}}),at.Fb.registerCommand({id:"list.toggleFindMatchType",handler:e=>{let t=e.get(at.wt).lastFocusedList;if(t instanceof at.un||t instanceof at.Vt){let e=t;e.findMatchType=e.findMatchType===at.dn.Contiguous?at.dn.Fuzzy:at.dn.Contiguous}}}),at.Fb.registerCommandAlias("list.toggleKeyboardNavigation","list.triggerTypeNavigation"),at.Fb.registerCommandAlias("list.toggleFilterOnType","list.toggleFindMode"),at.kb.registerCommandAndKeybindingRule({id:"list.find",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.rt,at.ft),primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.KeyF,secondary:[at.KO.F3],handler:e=>{let t=e.get(at.wt).lastFocusedList;t instanceof at.Xi||t instanceof at.in||t instanceof at.Gt||(t instanceof at.un||t instanceof at.Vt)&&t.openFind()}}),at.kb.registerCommandAndKeybindingRule({id:"list.closeFind",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.rt,at.bt),primary:at.KO.Escape,handler:e=>{let t=e.get(at.wt).lastFocusedList;(t instanceof at.un||t instanceof at.Vt)&&t.closeFind()}}),at.kb.registerCommandAndKeybindingRule({id:"list.scrollUp",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,null===at.ut||void 0===at.ut?void 0:at.ut.negate()),primary:at.JO.CtrlCmd|at.KO.UpArrow,handler:e=>{let t=e.get(at.wt).lastFocusedList;t&&(t.scrollTop-=10)}}),at.kb.registerCommandAndKeybindingRule({id:"list.scrollDown",weight:at.Ob.WorkbenchContrib,when:at.Mk.and(at.st,null===at.lt||void 0===at.lt?void 0:at.lt.negate()),primary:at.JO.CtrlCmd|at.KO.DownArrow,handler:e=>{let t=e.get(at.wt).lastFocusedList;t&&(t.scrollTop+=10)}}),at.kb.registerCommandAndKeybindingRule({id:"list.scrollLeft",weight:at.Ob.WorkbenchContrib,when:at.st,handler:e=>{let t=e.get(at.wt).lastFocusedList;t&&(t.scrollLeft-=10)}}),at.kb.registerCommandAndKeybindingRule({id:"list.scrollRight",weight:at.Ob.WorkbenchContrib,when:at.st,handler:e=>{let t=e.get(at.wt).lastFocusedList;t&&(t.scrollLeft+=10)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"tree.toggleStickyScroll",title:(0,rt.A)((0,rt.A)({},(0,at.DM)(2821,"Toggle Tree Sticky Scroll")),{},{mnemonicTitle:(0,at.EM)(2822,"&&Toggle Tree Sticky Scroll")}),category:"View",metadata:{description:(0,at.EM)(2823,"Toggles Sticky Scroll widget at the top of tree structures such as the File Explorer and Debug variables View.")},f1:!0})}run(e){let t=e.get(at.r_),i=!t.getValue("workbench.tree.enableStickyScroll");t.updateValue("workbench.tree.enableStickyScroll",i)}});(0,at.Kb)(),(0,at.TM)();var qc=class extends at.Hb{constructor(e,t){super("vs.tree.collapse",(0,at.EM)(42,"Collapse All"),"collapse-all",t),this.viewer=e}async run(){this.viewer.collapseAll(),this.viewer.setSelection([]),this.viewer.setFocus([])}};(0,at.oS)(),(0,at.cr)(),(0,at.pO)(),(0,at.sj)(),(0,at.wj)(),(0,at.TM)(),(0,at.Ii)();var $c,eh=class extends at.mj{constructor(){super(...arguments),this._onDidChangeCheckboxState=this._register(new at.ej),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event}setCheckboxState(e){this._onDidChangeCheckboxState.fire([e])}},th=(ye=class e extends at.mj{constructor(e,t,i,o){super(),this.checkboxStateHandler=t,this.hoverDelegate=i,this.hoverService=o,this.checkboxContainer=e}render(e){e.checkbox&&(this.toggle?(this.toggle.checked=e.checkbox.isChecked,this.toggle.setIcon(this.toggle.checked?at.fO.check:void 0)):this.createCheckbox(e))}createCheckbox(t){t.checkbox&&(this.toggle=new at.sr((0,rt.A)({isChecked:t.checkbox.isChecked,title:"",icon:t.checkbox.isChecked?at.fO.check:void 0},at.Pi)),this.setHover(t.checkbox),this.setAccessibilityInformation(t.checkbox),this.toggle.domNode.classList.add(e.checkboxClass),this.toggle.domNode.tabIndex=1,(0,at.Dx)(this.checkboxContainer,this.toggle.domNode),this.registerListener(t))}registerListener(e){this.toggle&&(this._register({dispose:()=>this.removeCheckbox()}),this._register(this.toggle),this._register(this.toggle.onChange(()=>{this.setCheckbox(e)})))}setHover(e){this.toggle&&(this.hover?this.hover.update(e.tooltip):this.hover=this._register(this.hoverService.setupManagedHover(this.hoverDelegate,this.toggle.domNode,this.checkboxHoverContent(e))))}setCheckbox(e){this.toggle&&e.checkbox&&(e.checkbox.isChecked=this.toggle.checked,this.toggle.setIcon(this.toggle.checked?at.fO.check:void 0),this.setHover(e.checkbox),this.setAccessibilityInformation(e.checkbox),this.checkboxStateHandler.setCheckboxState(e))}checkboxHoverContent(e){return e.tooltip?e.tooltip:e.isChecked?(0,at.EM)(3598,"Checked"):(0,at.EM)(3599,"Unchecked")}setAccessibilityInformation(e){this.toggle&&e.accessibilityInformation&&(this.toggle.domNode.ariaLabel=e.accessibilityInformation.label,e.accessibilityInformation.role&&(this.toggle.domNode.role=e.accessibilityInformation.role))}removeCheckbox(){let e=this.checkboxContainer.children;for(let t of e)t.remove()}},{_:ye.checkboxClass="custom-view-tree-node-item-checkbox"},ye);(0,at.vE)(),(0,at.Xb)(),(0,at.ca)(),(0,at.oS)(),(0,at.eu)(),(0,at.Tc)(),(0,at.Ur)(),(0,at.Ki)(),(0,at._n)(),(0,at.Kb)(),(0,at.Ww)(),(0,at.LA)(),(0,at.pO)(),(0,at.aP)(),(0,at.sj)(),(0,at.rl)(),(0,at.Vc)(),(0,at.wj)(),(0,at.X_)(),(0,at.ET)(),(0,at.dT)(),(0,at.rA)(),(0,at.GM)(),(0,at.SO)(),(0,at.dp)(),(0,ut.qm)(),(0,at.TM)(),(0,at.ei)(),(0,at.Tb)(),(0,at.ni)(),(0,at.Ib)(),(0,at.Rb)(),(0,at.i_)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.Ol)(),(0,at.Qs)(),(0,at.ox)(),(0,at.Dd)(),(0,at.Ua)(),(0,at.Ct)(),(0,at.gb)(),(0,at.Fd)(),(0,at.hl)(),(0,at.Va)(),(0,at.Mb)(),(0,at.yb)(),(0,at.mm)(),(0,at.sp)(),(0,at.Xd)(),(0,at.Vb)(),(0,ut.B)(),(0,ut.tt)(),(0,ut.q)(),(0,ut.xf)(),(0,ut.yb)(),(0,gt.ut)(),(0,gt.Gn)(),(0,pt.Nt)(),(0,at.er)(),(0,at.rr)(),(0,ut.Um)(),(0,ut.Im)(),(0,at.iM)(),(0,ut.Qb)(),(0,ut.yS)(),(0,ut.rm)(),(0,at.Cc)(),(0,at.ir)(),(0,at.Xn)(),(0,at.Ii)(),(0,gt.qn)(),(0,at.bE)({});var ih=class extends ut.W{constructor(e,t,i,o,s,r,n,a,d,l,c,h){super((0,rt.A)((0,rt.A)({},e),{},{titleMenuId:at.xb.ViewTitle,donotForwardArgs:!1}),t,i,o,s,r,n,a,d,c,h);let{treeView:u}=at.jb.as(ut.uf.ViewsRegistry).getView(e.id);this.treeView=u,this._register(this.treeView.onDidChangeActions(()=>this.updateActions(),this)),this._register(this.treeView.onDidChangeTitle(e=>this.updateTitle(e))),this._register(this.treeView.onDidChangeDescription(e=>this.updateTitleDescription(e))),this._register((0,at.kj)(()=>{this._container&&this.treeView.container&&this._container===this.treeView.container&&this.treeView.setVisibility(!1)})),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.treeView.onDidChangeWelcomeState(()=>this._onDidChangeViewWelcomeState.fire())),e.title!==this.treeView.title&&this.updateTitle(this.treeView.title),e.titleDescription!==this.treeView.description&&this.updateTitleDescription(this.treeView.description),this._actionRunner=this._register(new vh(l,()=>this.treeView.getSelection())),this.updateTreeVisibility()}focus(){super.focus(),this.treeView.focus()}renderBody(e){this._container=e,super.renderBody(e),this.renderTreeView(e)}shouldShowWelcome(){return(void 0===this.treeView.dataProvider||!!this.treeView.dataProvider.isTreeEmpty)&&(void 0===this.treeView.message||""===this.treeView.message)}layoutBody(e,t){super.layoutBody(e,t),this.layoutTreeView(e,t)}getOptimalWidth(){return this.treeView.getOptimalWidth()}renderTreeView(e){this.treeView.show(e)}layoutTreeView(e,t){this.treeView.layout(e,t)}updateTreeVisibility(){this.treeView.setVisibility(this.isBodyVisible())}getActionRunner(){return this._actionRunner}getActionsContext(){return{$treeViewId:this.id,$focusedTreeItem:!0,$selectedTreeItems:!0}}};ih=(0,at.Jb)([(0,at.Yb)(1,at.Ed),(0,at.Yb)(2,at.El),(0,at.Yb)(3,at.r_),(0,at.Yb)(4,at.Nb),(0,at.Yb)(5,ut.vb),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.ml),(0,at.Yb)(8,at.Yd),(0,at.Yb)(9,at.Pd),(0,at.Yb)(10,at.nr),(0,at.Yb)(11,gt.Kn)],ih);var oh=class{constructor(){this.label={label:"root"},this.handle="0",this.parentHandle=void 0,this.collapsibleState=ut.pf.Expanded,this.children=void 0}};function sh(e){let t=at.Fb.getCommand(e);if(t){let e=at.Cb.getCommand(t.id);return e&&e.precondition}}function rh(e,t){let i=sh(e.originalId?e.originalId:e.id);return!i||t.contextMatchesRules(i)}function nh(e){return!!e&&"string"!=typeof e&&!!e.element&&!!e.disposables}var ah=(0,at.EM)(3600,"There is no data provider registered that can provide view data."),dh=new at.Nk("customTreeView",!1),lh=class extends at.it{},ch=class extends at.mj{get onDidExpandItem(){return this._onDidExpandItem.event}get onDidCollapseItem(){return this._onDidCollapseItem.event}get onDidChangeSelectionAndFocus(){return this._onDidChangeSelectionAndFocus.event}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}get onDidChangeActions(){return this._onDidChangeActions.event}get onDidChangeWelcomeState(){return this._onDidChangeWelcomeState.event}get onDidChangeTitle(){return this._onDidChangeTitle.event}get onDidChangeDescription(){return this._onDidChangeDescription.event}get onDidChangeCheckboxState(){return this._onDidChangeCheckboxState.event}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b){super(),this.id=e,this._title=t,this.themeService=i,this.instantiationService=o,this.commandService=s,this.configurationService=r,this.progressService=n,this.contextMenuService=a,this.keybindingService=d,this.notificationService=l,this.viewDescriptorService=c,this.hoverService=h,this.contextKeyService=u,this.activityService=g,this.logService=p,this.openerService=b,this.isVisible=!1,this._hasIconForParentNode=!1,this._hasIconForLeafNode=!1,this.focused=!1,this._canSelectMany=!1,this._manuallyManageCheckboxes=!1,this.elementsToRefresh=[],this.lastSelection=[],this._onDidExpandItem=this._register(new at.ej),this._onDidCollapseItem=this._register(new at.ej),this._onDidChangeSelectionAndFocus=this._register(new at.ej),this._onDidChangeVisibility=this._register(new at.ej),this._onDidChangeActions=this._register(new at.ej),this._onDidChangeWelcomeState=this._register(new at.ej),this._onDidChangeTitle=this._register(new at.ej),this._onDidChangeDescription=this._register(new at.ej),this._onDidChangeCheckboxState=this._register(new at.ej),this._onDidCompleteRefresh=this._register(new at.ej),this._isInitialized=!1,this._activity=this._register(new at.vj),this.activated=!1,this.treeDisposables=this._register(new at.gj),this._height=0,this._width=0,this.refreshing=!1,this.root=new oh,this.lastActive=this.root}initialize(){this._isInitialized||(this._isInitialized=!0,this.contextKeyService.bufferChangeEvents(()=>{this.initializeShowCollapseAllAction(),this.initializeCollapseAllToggle(),this.initializeShowRefreshAction()}),this.treeViewDnd=this.instantiationService.createInstance(yh,this.id),this._dragAndDropController&&(this.treeViewDnd.controller=this._dragAndDropController),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorer.decorations")&&this.doRefresh([this.root])})),this._register(this.viewDescriptorService.onDidChangeLocation(e=>{var t;let{views:i,from:o,to:s}=e;i.some(e=>e.id===this.id)&&(null===(t=this.tree)||void 0===t||t.updateOptions({overrideStyles:(0,ut.K)(this.viewLocation).listOverrideStyles}))})),this.registerActions(),this.create())}get viewContainer(){return this.viewDescriptorService.getViewContainerByViewId(this.id)}get viewLocation(){return this.viewDescriptorService.getViewLocationById(this.id)}get dragAndDropController(){return this._dragAndDropController}set dragAndDropController(e){this._dragAndDropController=e,this.treeViewDnd&&(this.treeViewDnd.controller=e)}get dataProvider(){return this._dataProvider}set dataProvider(e){if(e){this.visible&&this.activate();let t=this;this._dataProvider=new class{constructor(){this._isEmpty=!0,this._onDidChangeEmpty=new at.ej,this.onDidChangeEmpty=this._onDidChangeEmpty.event}get isTreeEmpty(){return this._isEmpty}async getChildren(e){var t;return null===(t=await this.getChildrenBatch(e?[e]:void 0))||void 0===t?void 0:t[0]}updateEmptyState(e,t){if(1===e.length&&e[0]instanceof oh){let e=this._isEmpty;this._isEmpty=0===t.length||0===t[0].length,e!==this._isEmpty&&this._onDidChangeEmpty.fire()}}findCheckboxesUpdated(e,i){if(0===i.length)return[];let o=[];for(let n=0;n<e.length;n++){let a=e[n],d=i[n];for(let e of d){var s,r;e.parent=a,!t.manuallyManageCheckboxes&&!0===(null===a||void 0===a||null===(s=a.checkbox)||void 0===s?void 0:s.isChecked)&&!1===(null===(r=e.checkbox)||void 0===r?void 0:r.isChecked)&&(e.checkbox.isChecked=!0,o.push(e))}}return o}async getChildrenBatch(i){let o,s=[];if(i&&i.every(e=>!!e.children))o=i.map(e=>e.children);else{null!==i&&void 0!==i||(i=[t.root]);let r=await(1===i.length&&i[0]instanceof oh?gh(e,void 0):gh(e,i));for(let e=0;e<i.length;e++){i[e].children=r?r[e]:void 0}o=null!==r&&void 0!==r?r:[],s=this.findCheckboxesUpdated(i,o)}return this.updateEmptyState(i,o),s.length>0&&t._onDidChangeCheckboxState.fire(s),o}},this._dataProvider.onDidChangeEmpty&&this._register(this._dataProvider.onDidChangeEmpty(()=>{this.updateCollapseAllToggle(),this._onDidChangeWelcomeState.fire()})),this.updateMessage(),this.refresh()}else this._dataProvider=void 0,this.treeDisposables.clear(),this.activated=!1,this.updateMessage();this._onDidChangeWelcomeState.fire()}get message(){return this._message}set message(e){this._message=e,this.updateMessage(),this._onDidChangeWelcomeState.fire()}get title(){return this._title}set title(e){this._title=e,this.tree&&(this.tree.ariaLabel=this._title),this._onDidChangeTitle.fire(this._title)}get description(){return this._description}set description(e){this._description=e,this._onDidChangeDescription.fire(this._description)}get badge(){return this._badge}set badge(e){var t,i;if((null===(t=this._badge)||void 0===t?void 0:t.value)!==(null===e||void 0===e?void 0:e.value)||(null===(i=this._badge)||void 0===i?void 0:i.tooltip)!==(null===e||void 0===e?void 0:e.tooltip))if(this._badge=e,e){let t={badge:new gt.ct(e.value,()=>e.tooltip),priority:50};this._activity.value=this.activityService.showViewActivity(this.id,t)}else this._activity.clear()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){var t;let i=this._canSelectMany;this._canSelectMany=e,this._canSelectMany!==i&&(null===(t=this.tree)||void 0===t||t.updateOptions({multipleSelectionSupport:this.canSelectMany}))}get manuallyManageCheckboxes(){return this._manuallyManageCheckboxes}set manuallyManageCheckboxes(e){this._manuallyManageCheckboxes=e}get hasIconForParentNode(){return this._hasIconForParentNode}get hasIconForLeafNode(){return this._hasIconForLeafNode}get visible(){return this.isVisible}initializeShowCollapseAllAction(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.collapseAllContext||(this.collapseAllContext=(this.collapseAllContextKey=new at.Nk("treeView.".concat(this.id,".enableCollapseAll"),e,(0,at.EM)(3601,"Whether the tree view with id {0} enables collapse all.",this.id)),this.collapseAllContextKey.bindTo(this.contextKeyService))),!0}get showCollapseAllAction(){var e;return this.initializeShowCollapseAllAction(),!(null===(e=this.collapseAllContext)||void 0===e||!e.get())}set showCollapseAllAction(e){var t;this.initializeShowCollapseAllAction(e),null===(t=this.collapseAllContext)||void 0===t||t.set(e)}initializeShowRefreshAction(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.refreshContext||(this.refreshContext=(this.refreshContextKey=new at.Nk("treeView.".concat(this.id,".enableRefresh"),e,(0,at.EM)(3602,"Whether the tree view with id {0} enables refresh.",this.id)),this.refreshContextKey.bindTo(this.contextKeyService)))}get showRefreshAction(){var e;return this.initializeShowRefreshAction(),!(null===(e=this.refreshContext)||void 0===e||!e.get())}set showRefreshAction(e){var t;this.initializeShowRefreshAction(e),null===(t=this.refreshContext)||void 0===t||t.set(e)}registerActions(){let e=this;this._register((0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.actions.treeView.".concat(e.id,".refresh"),title:(0,at.EM)(3603,"Refresh"),menu:{id:at.xb.ViewTitle,when:at.Mk.and(at.Mk.equals("view",e.id),e.refreshContextKey),group:"navigation",order:2**53-1-1},icon:at.fO.refresh})}async run(){return e.refresh()}})),this._register((0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.actions.treeView.".concat(e.id,".collapseAll"),title:(0,at.EM)(3604,"Collapse All"),menu:{id:at.xb.ViewTitle,when:at.Mk.and(at.Mk.equals("view",e.id),e.collapseAllContextKey),group:"navigation",order:2**53-1},precondition:e.collapseAllToggleContextKey,icon:at.fO.collapseAll})}async run(){if(e.tree)return new qc(e.tree,!0).run()}}))}setVisibility(e){this.initialize(),e=!!e,this.isVisible!==e&&(this.isVisible=e,this.tree&&(this.isVisible?(0,at.BS)(this.tree.getHTMLElement()):(0,at.aS)(this.tree.getHTMLElement()),this.isVisible&&this.elementsToRefresh.length&&this.dataProvider&&(this.doRefresh(this.elementsToRefresh),this.elementsToRefresh=[])),(0,at.wM)(()=>{this.dataProvider&&this._onDidChangeVisibility.fire(this.isVisible)}),this.visible&&this.activate())}focus(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.tree&&this.root.children&&this.root.children.length>0){let i=null!==t&&void 0!==t?t:this.tree.getSelection()[0];i&&e&&this.tree.reveal(i,.5),this.tree.domFocus()}else this.tree&&this.treeContainer&&!this.treeContainer.classList.contains("hide")?this.tree.domFocus():this.domNode.focus()}show(e){this._container=e,(0,at.Dx)(e,this.domNode)}create(){this.domNode=(0,at.px)(".tree-explorer-viewlet-tree-view"),this.messageElement=(0,at.Dx)(this.domNode,(0,at.px)(".message")),this.updateMessage(),this.treeContainer=(0,at.Dx)(this.domNode,(0,at.px)(".customview-tree")),this.treeContainer.classList.add("file-icon-themable-tree","show-file-icons");let e=this._register((0,at.US)(this.domNode));this._register(e.onDidFocus(()=>this.focused=!0)),this._register(e.onDidBlur(()=>this.focused=!1))}createTree(){this.treeDisposables.clear();let e=at.Jr.bind(void 0,this.instantiationService),t=this.treeDisposables.add(this.instantiationService.createInstance(Ch,this.id));this.treeLabels=this.treeDisposables.add(this.instantiationService.createInstance(ut.et,this));let i=this.instantiationService.createInstance(ph,this,e=>this.progressService.withProgress({location:this.id},()=>e)),o=this.treeDisposables.add(new mh(this.themeService)),s=this.treeDisposables.add(new eh),r=this.treeDisposables.add(this.instantiationService.createInstance(bh,this.id,t,this.treeLabels,e,o,s,()=>this.manuallyManageCheckboxes));this.treeDisposables.add(r.onDidChangeCheckboxState(e=>this._onDidChangeCheckboxState.fire(e)));let n=this._title;this.tree=this.treeDisposables.add(this.instantiationService.createInstance(lh,this.id,this.treeContainer,new uh,[r],i,{identityProvider:new hh,accessibilityProvider:{getAriaLabel(e){if(e.accessibilityInformation)return e.accessibilityInformation.label;if((0,at.QM)(e.tooltip))return e.tooltip;{if(e.resourceUri&&!e.label)return null;let t="";return e.label&&(t+=e.label.label+" "),e.description&&(t+=e.description),t}},getRole(e){var t,i;return null!==(t=null===(i=e.accessibilityInformation)||void 0===i?void 0:i.role)&&void 0!==t?t:"treeitem"},getWidgetAriaLabel:()=>n},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.label?e.label.label:e.resourceUri?(0,at.iT)(at.xO.revive(e.resourceUri)):void 0},expandOnlyOnTwistieClick:e=>!!e.command||!!e.checkbox||"doubleClick"===this.configurationService.getValue("workbench.tree.expandMode"),collapseByDefault:e=>e.collapsibleState!==ut.pf.Expanded,multipleSelectionSupport:this.canSelectMany,dnd:this.treeViewDnd,overrideStyles:(0,ut.K)(this.viewLocation).listOverrideStyles})),this.treeDisposables.add(r.onDidChangeMenuContext(e=>e.forEach(e=>{var t;return null===(t=this.tree)||void 0===t?void 0:t.rerender(e)}))),this.treeDisposables.add(this.tree),t.setContextKeyService(this.tree.contextKeyService),o.tree=this.tree;let a=this.treeDisposables.add(new vh(this.notificationService,()=>this.tree.getSelection()));r.actionRunner=a,this.tree.contextKeyService.createKey(this.id,!0),dh.bindTo(this.tree.contextKeyService).set(!0),this.treeDisposables.add(this.tree.onContextMenu(e=>this.onContextMenu(t,e,a))),this.treeDisposables.add(this.tree.onDidChangeSelection(e=>{var t,i;this.lastSelection=e.elements,this.lastActive=null!==(t=null===(i=this.tree)||void 0===i?void 0:i.getFocus()[0])&&void 0!==t?t:this.lastActive,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive})})),this.treeDisposables.add(this.tree.onDidChangeFocus(e=>{var t,i;e.elements.length&&e.elements[0]!==this.lastActive&&(this.lastActive=e.elements[0],this.lastSelection=null!==(t=null===(i=this.tree)||void 0===i?void 0:i.getSelection())&&void 0!==t?t:this.lastSelection,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive}))})),this.treeDisposables.add(this.tree.onDidChangeCollapseState(e=>{if(!e.node.element)return;let t=Array.isArray(e.node.element.element)?e.node.element.element[0]:e.node.element.element;e.node.collapsed?this._onDidCollapseItem.fire(t):this._onDidExpandItem.fire(t)})),this.tree.setInput(this.root).then(()=>this.updateContentAreas()),this.treeDisposables.add(this.tree.onDidOpen(async e=>{if(!e.browserEvent||e.browserEvent.target&&e.browserEvent.target.classList.contains(th.checkboxClass))return;let t=this.tree.getSelection(),i=await this.resolveCommand(1===t.length?t[0]:void 0);if(i&&rh(i,this.contextKeyService)){let t=i.arguments||[];("_workbench.open"===i.id||"_workbench.diff"===i.id)&&(t=[...t,e]);try{await this.commandService.executeCommand(i.id,...t)}catch(e){this.notificationService.error(e)}}})),this.treeDisposables.add(t.onDidChange(e=>{var t,i;(null===(t=this.tree)||void 0===t?void 0:t.hasNode(e))&&(null===(i=this.tree)||void 0===i||i.rerender(e))}))}async resolveCommand(e){let t=null===e||void 0===e?void 0:e.command;return e&&!t&&e instanceof ut.ff&&e.hasResolve&&(await e.resolve(at.PA.None),t=e.command),t}onContextMenu(e,t,i){this.hoverService.hideHover();let o=t.element;if(null===o)return;let s=t.browserEvent;s.preventDefault(),s.stopPropagation(),this.tree.setFocus([o]);let r=this.canSelectMany?this.getSelection():[];r.find(e=>e.handle===o.handle)||(r=[o]);let n=e.getResourceContextActions(r);n.length&&this.contextMenuService.showContextMenu({getAnchor:()=>t.anchor,getActions:()=>n,getActionViewItem:e=>{let t=this.keybindingService.lookupKeybinding(e.id);if(t)return new at.Wi(e,e,{label:!0,keybinding:t.getLabel()})},onHide:e=>{e&&this.tree.domFocus()},getActionsContext:()=>({$treeViewId:this.id,$treeItemHandle:o.handle}),actionRunner:i})}updateMessage(){this._message?this.showMessage(this._message):this.dataProvider?this.hideMessage():this.showMessage(ah),this.updateContentAreas()}processMessage(e,t){let i=e.value.split("\n"),o=[],s=!1;for(let n of i){let i=(0,at.ar)(n);if(1===i.nodes.length&&"string"!=typeof i.nodes[0]){let e=i.nodes[0],r=(0,at.jx)("div");r.classList.add("button-container");let n=new at.Gn(r,(0,rt.A)({title:e.title,secondary:s,supportIcons:!0},at.Ti));n.label=e.label,n.onDidClick(t=>{this.openerService.open(e.href,{allowCommands:!0})},null,t);let a=at.xO.parse(e.href);if(a.scheme===at.TT.command){let e=sh(a.path);e&&(n.enabled=this.contextKeyService.contextMatchesRules(e),t.add(this.contextKeyService.onDidChangeContext(t=>{t.affectsSome(new Set(e.keys()))&&(n.enabled=this.contextKeyService.contextMatchesRules(e))})))}t.add(n),s=!0,o.push(r)}else{s=!1;let i=this.markdownRenderer.render(new at.Bc(n,{isTrusted:e.isTrusted,supportThemeIcons:e.supportThemeIcons,supportHtml:e.supportHtml}));o.push(i.element),t.add(i)}}let r=(0,at.jx)("div");r.classList.add("rendered-message");for(let n of o)(0,at._S)(n)?r.appendChild(n):r.appendChild(n.element);return r}showMessage(e){if(nh(this._messageValue)&&this._messageValue.disposables.dispose(),(0,at.Uc)(e)&&!this.markdownRenderer&&(this.markdownRenderer=this.instantiationService.createInstance(at.Sc,{})),(0,at.Uc)(e)){let t=new at.gj;this._messageValue={element:this.processMessage(e,t),disposables:t}}else this._messageValue=e;this.messageElement&&(this.messageElement.classList.remove("hide"),this.resetMessageElement(),"string"!=typeof this._messageValue||(0,at.oA)(this._messageValue)?nh(this._messageValue)&&this.messageElement.appendChild(this._messageValue.element):this.messageElement.textContent=this._messageValue,this.layout(this._height,this._width))}hideMessage(){var e;this.resetMessageElement(),null!==(e=this.messageElement)&&void 0!==e&&e.classList.add("hide"),this.layout(this._height,this._width)}resetMessageElement(){this.messageElement&&(0,at.Ox)(this.messageElement)}layout(e,t){if(e&&t&&this.messageElement&&this.treeContainer){var i;this._height=e,this._width=t;let o=e-(0,at.Zx)(this.messageElement);this.treeContainer.style.height=o+"px",null===(i=this.tree)||void 0===i||i.layout(o,t)}}getOptimalWidth(){if(this.tree){let e=this.tree.getHTMLElement();return(0,at.qx)(e,[].slice.call(e.querySelectorAll(".outline-item-label > a")))}return 0}updateCheckboxes(e){return fh(e)}async refresh(e,t){if(this.dataProvider&&this.tree){this.refreshing&&await at.tj.toPromise(this._onDidCompleteRefresh.event),e||(e=[this.root],this.elementsToRefresh=[]);for(let t of e)t.children=void 0;if(this.isVisible){let i=this.updateCheckboxes(null!==t&&void 0!==t?t:[]);return this.doRefresh(e.concat(i))}if(this.elementsToRefresh.length){let t=new Set;this.elementsToRefresh.forEach(e=>t.add(e.handle));for(let i of e)t.has(i.handle)||this.elementsToRefresh.push(i)}else this.elementsToRefresh.push(...e)}}async expand(e){let t=this.tree;if(t)try{e=Array.isArray(e)?e:[e];for(let i of e)await t.expand(i,!1)}catch(i){}}isCollapsed(e){var t;return!(null===(t=this.tree)||void 0===t||!t.isCollapsed(e))}setSelection(e){var t;null===(t=this.tree)||void 0===t||t.setSelection(e)}getSelection(){var e,t;return null!==(e=null===(t=this.tree)||void 0===t?void 0:t.getSelection())&&void 0!==e?e:[]}setFocus(e){this.tree&&(e?(this.focus(!0,e),this.tree.setFocus([e])):0===this.tree.getFocus().length&&this.tree.setFocus([]))}async reveal(e){if(this.tree)return this.tree.reveal(e)}async doRefresh(e){let t=this.tree;if(t&&this.visible){this.refreshing=!0;let i=t.getSelection();try{await Promise.all(e.map(e=>t.updateChildren(e,!0,!0)))}catch(e){this.logService.error(e)}let o=t.getSelection();(i.length!==o.length||i.some((e,t)=>e.handle!==o[t].handle))&&(this.lastSelection=o,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive})),this.refreshing=!1,this._onDidCompleteRefresh.fire(),this.updateContentAreas(),this.focused&&this.focus(!1),this.updateCollapseAllToggle()}}initializeCollapseAllToggle(){this.collapseAllToggleContext||(this.collapseAllToggleContext=(this.collapseAllToggleContextKey=new at.Nk("treeView.".concat(this.id,".toggleCollapseAll"),!1,(0,at.EM)(3605,"Whether collapse all is toggled for the tree view with id {0}.",this.id)),this.collapseAllToggleContextKey.bindTo(this.contextKeyService)))}updateCollapseAllToggle(){var e;this.showCollapseAllAction&&(this.initializeCollapseAllToggle(),null===(e=this.collapseAllToggleContext)||void 0===e||e.set(!!this.root.children&&this.root.children.length>0&&this.root.children.some(e=>e.collapsibleState!==ut.pf.None)))}updateContentAreas(){let e=!this.root.children||0===this.root.children.length;this._messageValue&&e&&!this.refreshing&&this.treeContainer?(this.dragAndDropController||this.treeContainer.classList.add("hide"),this.domNode.setAttribute("tabindex","0")):this.treeContainer&&(this.treeContainer.classList.remove("hide"),this.domNode===(0,at.zx)()&&this.focus(),this.domNode.removeAttribute("tabindex"))}get container(){return this._container}};ch=(0,at.Jb)([(0,at.Yb)(2,at.Yd),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,at.Lb),(0,at.Yb)(5,at.r_),(0,at.Yb)(6,at.Ba),(0,at.Yb)(7,at.El),(0,at.Yb)(8,at.Ed),(0,at.Yb)(9,at.Pd),(0,at.Yb)(10,ut.vb),(0,at.Yb)(11,at.nr),(0,at.Yb)(12,at.Nb),(0,at.Yb)(13,gt.Wn),(0,at.Yb)(14,at.mb),(0,at.Yb)(15,at.ml)],ch);var hh=class{getId(e){return e.handle}},uh=class{getHeight(e){return bh.ITEM_HEIGHT}getTemplateId(e){return bh.TREE_TEMPLATE_ID}};async function gh(e,t){return e.getChildrenBatch?e.getChildrenBatch(t):t?Promise.all(t.map(t=>e.getChildren(t).then(e=>null!==e&&void 0!==e?e:[]))):[await e.getChildren()].filter(e=>void 0!==e)}var ph=class{constructor(e,t){this.treeView=e,this.withProgress=t}hasChildren(e){return!!this.treeView.dataProvider&&e.collapsibleState!==ut.pf.None}async getChildren(e){let t=this.treeView.dataProvider;if(!t)return[];void 0===this.batch?(this.batch=[e],this.batchPromise=void 0):this.batch.push(e);let i=this.batch.length-1;return new Promise((e,o)=>{setTimeout(async()=>{let s=this.batch;this.batch=void 0,this.batchPromise||(this.batchPromise=this.withProgress(gh(t,s)));try{let t=await this.batchPromise;e(t&&i<t.length?t[i]:[])}catch(e){e.message.startsWith("Bad progress location:")||o(e)}},0)})}},bh=(fe=class extends at.mj{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u){super(),this.treeViewId=e,this.menus=t,this.labels=i,this.actionViewItemProvider=o,this.aligner=s,this.checkboxStateHandler=r,this.manuallyManageCheckboxes=n,this.themeService=a,this.configurationService=d,this.labelService=l,this.contextKeyService=c,this.hoverService=h,this._onDidChangeCheckboxState=this._register(new at.ej),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeMenuContext=this._register(new at.ej),this.onDidChangeMenuContext=this._onDidChangeMenuContext.event,this._hasCheckbox=!1,this._renderedElements=new Map,this._hoverDelegate=this._register(u.createInstance(at.$n,"mouse",void 0,{})),this._register(this.themeService.onDidFileIconThemeChange(()=>this.rerender())),this._register(this.themeService.onDidColorThemeChange(()=>this.rerender())),this._register(r.onDidChangeCheckboxState(e=>{this.updateCheckboxes(e)})),this._register(this.contextKeyService.onDidChangeContext(e=>this.onDidChangeContext(e)))}get templateId(){return $c.TREE_TEMPLATE_ID}set actionRunner(e){this._actionRunner=e}renderTemplate(e){e.classList.add("custom-view-tree-node-item");let t=(0,at.Dx)(e,(0,at.px)("")),i=this.labels.create(e,{supportHighlights:!0,hoverDelegate:this._hoverDelegate});return{resourceLabel:i,icon:(0,at.kS)(i.element,(0,at.px)(".custom-view-tree-node-item-icon")),checkboxContainer:t,actionBar:new at.Vr((0,at.Dx)(i.element,(0,at.px)(".actions")),{actionViewItemProvider:this.actionViewItemProvider}),container:e}}getHover(e,t,i){return i instanceof ut.ff&&i.hasResolve?{markdown:"string"==typeof i.tooltip?i.tooltip:e=>new Promise(t=>{i.resolve(e).then(()=>t(i.tooltip))}),markdownNotSupportedFallback:t?void 0:null!==e&&void 0!==e?e:""}:t&&!i.tooltip?void 0:void 0===i.tooltip?e:(0,at.QM)(i.tooltip)?""===i.tooltip?void 0:i.tooltip:{markdown:i.tooltip,markdownNotSupportedFallback:t?void 0:(0,at.Ec)(i.tooltip)}}renderElement(e,t,i){var o;let s=e.element,r=s.resourceUri?at.xO.revive(s.resourceUri):null,n=s.label?s.label:r?{label:(0,at.iT)(r)}:void 0,a=(0,at.QM)(s.description)?s.description:r&&!0===s.description?this.labelService.getUriLabel((0,at.oT)(r),{relative:!0}):void 0,d=n?n.label:void 0,l=n&&n.highlights&&d?n.highlights.map(e=>{let[t,i]=e;if(t<0&&(t=d.length+t),i<0&&(i=d.length+i),t>=d.length||i>d.length)return{start:0,end:0};if(t>i){let e=t;t=i,i=e}return{start:t,end:i}}):void 0,c=this.themeService.getColorTheme().type===at.fm.LIGHT?s.icon:s.iconDark,h=c?at.xO.revive(c):void 0,u=this.getHover(d,r,s);i.actionBar.clear(),i.icon.style.color="";let g=!0;if(s.command&&(g=rh(s.command,this.contextKeyService)),this.renderCheckbox(s,i),r){let t=this.configurationService.getValue("explorer.decorations"),o=r||at.xO.parse("missing:_icon_resource");i.resourceLabel.setResource({name:d,description:a,resource:o},{fileKind:this.getFileKind(s),title:u,hideIcon:this.shouldHideResourceLabelIcon(h,s.themeIcon),fileDecorations:t,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:l||(0,at.el)(e.filterData),strikethrough:null===n||void 0===n?void 0:n.strikethrough,disabledCommand:!g,labelEscapeNewLines:!0,forceLabel:!!s.label})}else i.resourceLabel.setResource({name:d,description:a},{title:u,hideIcon:!0,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:l||(0,at.el)(e.filterData),strikethrough:null===n||void 0===n?void 0:n.strikethrough,disabledCommand:!g,labelEscapeNewLines:!0});if(h)i.icon.className="custom-view-tree-node-item-icon",i.icon.style.backgroundImage=(0,at.Yl)(h);else{var p,b;let e;this.shouldShowThemeIcon(!!r,s.themeIcon)&&(e=at.Bb.asClassName(s.themeIcon),s.themeIcon.color&&(i.icon.style.color=null!==(p=null===(b=this.themeService.getColorTheme().getColor(s.themeIcon.color.id))||void 0===b?void 0:b.toString())&&void 0!==p?p:"")),i.icon.className=e?"custom-view-tree-node-item-icon ".concat(e):"",i.icon.style.backgroundImage=""}g||(i.icon.className=i.icon.className+" disabled",i.container.parentElement&&(i.container.parentElement.className=i.container.parentElement.className+" disabled")),i.actionBar.context={$treeViewId:this.treeViewId,$treeItemHandle:s.handle};let m=this.menus.getResourceActions([s]);i.actionBar.push(m,{icon:!0,label:!1}),this._actionRunner&&(i.actionBar.actionRunner=this._actionRunner),this.setAlignment(i.container,s);let v=null!==(o=this._renderedElements.get(e.element.handle))&&void 0!==o?o:[];this._renderedElements.set(e.element.handle,[...v,{original:e,rendered:i}])}rerender(){let e=new Set(this._renderedElements.keys());for(let i of e){var t;let e=null!==(t=this._renderedElements.get(i))&&void 0!==t?t:[];for(let t of e)this.disposeElement(t.original,0,t.rendered),this.renderElement(t.original,0,t.rendered)}}renderCheckbox(e,t){e.checkbox?(this._hasCheckbox||(this._hasCheckbox=!0,this.rerender()),t.checkbox||(t.checkbox=new th(t.checkboxContainer,this.checkboxStateHandler,this._hoverDelegate,this.hoverService)),t.checkbox.render(e)):t.checkbox&&(t.checkbox=void t.checkbox.dispose())}setAlignment(e,t){e.parentElement.classList.toggle("align-icon-with-twisty",!this._hasCheckbox&&this.aligner.alignIconWithTwisty(t))}shouldHideResourceLabelIcon(e,t){return!!e||!!t&&!this.isFileKindThemeIcon(t)}shouldShowThemeIcon(e,t){return!!t&&!(e&&this.isFileKindThemeIcon(t))}isFolderThemeIcon(e){return(null===e||void 0===e?void 0:e.id)===at.ip.id}isFileKindThemeIcon(e){return!!e&&(e.id===at.rp.id||this.isFolderThemeIcon(e))}getFileKind(e){if(e.themeIcon)switch(e.themeIcon.id){case at.rp.id:return at.Ts.FILE;case at.ip.id:return at.Ts.FOLDER}return e.collapsibleState===ut.pf.Collapsed||e.collapsibleState===ut.pf.Expanded?at.Ts.FOLDER:at.Ts.FILE}onDidChangeContext(e){let t=e.affectsSome(this.menus.getEntireMenuContexts()),i=[];for(let[o,s]of this._renderedElements)for(let r of s)(t||e.affectsSome(this.menus.getElementOverlayContexts(r.original.element)))&&i.push(r.original.element);i.length&&this._onDidChangeMenuContext.fire(i)}updateCheckboxes(e){let t=[];t=this.manuallyManageCheckboxes()?e:fh(e),t.forEach(e=>{let t=this._renderedElements.get(e.handle);t&&t.forEach(t=>{var i;return null===(i=t.rendered.checkbox)||void 0===i?void 0:i.render(e)})}),this._onDidChangeCheckboxState.fire(t)}disposeElement(e,t,i){var o,s;let r=null!==(o=this._renderedElements.get(e.element.handle))&&void 0!==o?o:[],n=r.findIndex(e=>i===e.rendered);1===r.length?this._renderedElements.delete(e.element.handle):r.length>0&&r.splice(n,1),null!==(s=i.checkbox)&&void 0!==s&&s.dispose(),i.checkbox=void 0}disposeTemplate(e){e.resourceLabel.dispose(),e.actionBar.dispose()}},{_:$c=fe},{_:fe.ITEM_HEIGHT=22},{_:fe.TREE_TEMPLATE_ID="treeExplorer"},fe);bh=$c=(0,at.Jb)([(0,at.Yb)(7,at.Yd),(0,at.Yb)(8,at.r_),(0,at.Yb)(9,at.Ha),(0,at.Yb)(10,at.Nb),(0,at.Yb)(11,at.nr),(0,at.Yb)(12,at.rx)],bh);var mh=class extends at.mj{constructor(e){super(),this.themeService=e}set tree(e){this._tree=e}alignIconWithTwisty(e){if(e.collapsibleState!==ut.pf.None||!this.hasIcon(e))return!1;if(this._tree){let t=this._tree.getParentElement(e)||this._tree.getInput();return this.hasIcon(t)?!!t.children&&t.children.some(e=>e.collapsibleState!==ut.pf.None&&!this.hasIcon(e)):!!t.children&&t.children.every(e=>e.collapsibleState===ut.pf.None||!this.hasIcon(e))}return!1}hasIcon(e){if(this.themeService.getColorTheme().type===at.fm.LIGHT?e.icon:e.iconDark)return!0;if(e.resourceUri||e.themeIcon){let t=this.themeService.getFileIconTheme();return(e.themeIcon?e.themeIcon.id===at.ip.id:e.collapsibleState!==ut.pf.None)?t.hasFileIcons&&t.hasFolderIcons:t.hasFileIcons}return!1}},vh=class extends at.Ub{constructor(e,t){super(),this.getSelectedResources=t,this._register(this.onDidRun(t=>{t.error&&!(0,at.oP)(t.error)&&e.error((0,at.EM)(3606,"Error running command {1}: {0}. This is likely caused by the extension that contributes {1}.",t.error.message,t.action.id))}))}async runAction(e,t){let i,o=this.getSelectedResources(),s=!1;o.length>1&&(i=o.map(e=>((e.handle===t.$treeItemHandle||t.$selectedTreeItems)&&(s=!0),{$treeViewId:t.$treeViewId,$treeItemHandle:e.handle}))),!s&&i&&(i=void 0),await e.run(t,i)}},Ch=class{constructor(e,t){this.id=e,this.menuService=t,this._onDidChange=new at.ej,this.onDidChange=this._onDidChange.event}getResourceActions(e){return this.getActions(this.getMenuId(),e).primary}getResourceContextActions(e){return this.getActions(this.getMenuId(),e).secondary}setContextKeyService(e){this.contextKeyService=e}filterNonUniversalActions(e,t){let i=new Set(t.map(e=>e.id));for(let o of e){let e=o.keys();for(let t of e)i.has(t)||o.delete(t)}}buildMenu(e){let t=[];for(let i of e)i.size>0&&(t.length&&t.push(new at.Wb),t.push(...i.values()));return t}createGroups(e){let t=[],i=new Map;for(let o of e)o instanceof at.Wb?(t.push(i),i=new Map):i.set(o.id,o);return t.push(i),t}getElementOverlayContexts(e){return new Map([["view",this.id],["viewItem",e.contextValue]])}getEntireMenuContexts(){return this.menuService.getMenuContexts(this.getMenuId())}getMenuId(){return at.xb.ViewItemContext}getActions(e,t){if(!this.contextKeyService)return{primary:[],secondary:[]};let i=[],o=[];for(let s=0;s<t.length;s++){let r=t[s],n=this.contextKeyService.createOverlay(this.getElementOverlayContexts(r)),a=(0,at.Zr)(this.menuService.getMenuActions(e,n,{shouldForwardArgs:!0}),"inline");0===s?(i=this.createGroups(a.primary),o=this.createGroups(a.secondary)):(this.filterNonUniversalActions(i,a.primary),this.filterNonUniversalActions(o,a.secondary))}return{primary:this.buildMenu(i),secondary:this.buildMenu(o)}}dispose(){this.contextKeyService=void 0}};Ch=(0,at.Jb)([(0,at.Yb)(1,at.ti)],Ch);var wh=class extends ch{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C){super(e,t,o,s,r,n,a,d,l,c,h,g,u,b,v,C),this.extensionId=i,this.extensionService=p,this.telemetryService=m}activate(){this.activated||(this.activated=(this.telemetryService.publicLog2("Extension:ViewActivate",{extensionId:new ut.Yb(this.extensionId),id:this.id}),this.createTree(),this.progressService.withProgress({location:this.id},()=>this.extensionService.activateByEvent("onView:".concat(this.id))).then(()=>(0,at.$w)(2e3)).then(()=>{this.updateMessage()}),!0))}};wh=(0,at.Jb)([(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.Lb),(0,at.Yb)(6,at.r_),(0,at.Yb)(7,at.Ba),(0,at.Yb)(8,at.El),(0,at.Yb)(9,at.Ed),(0,at.Yb)(10,at.Pd),(0,at.Yb)(11,ut.vb),(0,at.Yb)(12,at.Nb),(0,at.Yb)(13,at.nr),(0,at.Yb)(14,pt.Mt),(0,at.Yb)(15,gt.Wn),(0,at.Yb)(16,at.vb),(0,at.Yb)(17,at.mb),(0,at.Yb)(18,at.ml)],wh);var yh=class{constructor(e,t,i,o,s){this.treeId=e,this.labelService=t,this.instantiationService=i,this.treeViewsDragAndDropService=o,this.logService=s,this.treeItemsTransfer=ut.Bm.getInstance(),this.treeMimeType="application/vnd.code.tree.".concat(e.toLowerCase())}set controller(e){this.dndController=e}handleDragAndLog(e,t,i,o){return e.handleDrag(t,i,o).then(t=>{if(t){let i=[];for(let o of t)o[0]!==this.treeMimeType&&e.dragMimeTypes.findIndex(e=>e===o[0])<0&&i.push(o[0]);i.length&&this.logService.warn("Drag and drop controller for tree ".concat(this.treeId," adds the following data transfer types but does not declare them in dragMimeTypes: ").concat(i.join(", ")))}return t})}addExtensionProvidedTransferTypes(e,t){var i;if(!e.dataTransfer||!this.dndController)return;let o=(0,at.up)();this.dragCancellationToken=new at.FA,this.treeViewsDragAndDropService.addDragOperationTransfer(o,this.handleDragAndLog(this.dndController,t,o,this.dragCancellationToken.token)),this.treeItemsTransfer.setData([new ut.tm(o)],ut.tm.prototype),e.dataTransfer.clearData(at.J_.text),this.dndController.dragMimeTypes.find(e=>e===at.J_.uriList)&&null!==(i=e.dataTransfer)&&void 0!==i&&i.setData(at.oa.RESOURCES,""),this.dndController.dragMimeTypes.forEach(t=>{var i;null===(i=e.dataTransfer)||void 0===i||i.setData(t,"")})}addResourceInfoToTransfer(e,t){if(t.length&&e.dataTransfer){this.instantiationService.invokeFunction(i=>(0,ut.z)(i,t,e));let i=t.filter(e=>e.scheme===at.TT.file).map(e=>e.fsPath);i.length&&e.dataTransfer.setData(ut.Rm.FILES,JSON.stringify(i))}}onDragStart(e,t){if(t.dataTransfer){let i=e.getData(),o=[],s={id:this.treeId,itemHandles:[]};i.forEach(e=>{s.itemHandles.push(e.handle),e.resourceUri&&o.push(at.xO.revive(e.resourceUri))}),this.addResourceInfoToTransfer(t,o),this.addExtensionProvidedTransferTypes(t,s.itemHandles),t.dataTransfer.setData(this.treeMimeType,JSON.stringify(s))}}debugLog(e){e.size?this.logService.debug("TreeView dragged mime types: ".concat(Array.from(e).join(", "))):this.logService.debug("TreeView dragged with no supported mime types.")}onDragOver(e,t,i,o,s){let r=(0,ut.Lm)(s.dataTransfer),n=new Set(Array.from(r,e=>e[0]));if(s.dataTransfer)for(let d of s.dataTransfer.items)if("file"===d.kind||d.type===at.oa.RESOURCES.toLowerCase()){n.add(at.J_.uriList);break}this.debugLog(n);let a=this.dndController;return!(!a||!s.dataTransfer||0===a.dropMimeTypes.length)&&(!!Array.from(n).some((e,t)=>e===this.treeMimeType||a.dropMimeTypes.indexOf(e)>=0)&&{accept:!0,bubble:at.mn.Down,autoExpand:!0})}getDragURI(e){return this.dndController?e.resourceUri?at.xO.revive(e.resourceUri).toString():e.handle:null}getDragLabel(e){if(!this.dndController)return;if(e.length>1)return String(e.length);let t=e[0];return t.label?t.label.label:t.resourceUri?this.labelService.getUriLabel(at.xO.revive(t.resourceUri)):void 0}async drop(e,t,i,o,s){var r,n;let a,d,l=this.dndController;if(!s.dataTransfer||!l)return;this.treeItemsTransfer.hasData(ut.tm.prototype)&&(d=this.treeItemsTransfer.getData(ut.tm.prototype)[0].identifier);let c=(0,ut.Lm)(s.dataTransfer,!0),h=new ut.Km;for(let[p,b]of c)if((p===this.treeMimeType||l.dropMimeTypes.includes(p)||b.asFile()&&l.dropMimeTypes.includes(at.oa.FILES.toLowerCase()))&&(h.append(p,b),p===this.treeMimeType))try{a=JSON.parse(await b.asString())}catch(g){}let u=await this.treeViewsDragAndDropService.removeDragOperationTransfer(d);if(u)for(let[p,b]of u)h.append(p,b);return l.handleDrop(h,t,at.PA.None,d,null===(r=a)||void 0===r?void 0:r.id,null===(n=a)||void 0===n?void 0:n.itemHandles)}onDragEnd(e){var t,i;"none"===(null===(t=e.dataTransfer)||void 0===t?void 0:t.dropEffect)&&(null===(i=this.dragCancellationToken)||void 0===i||i.cancel())}dispose(){}};function fh(e){let t=[];for(let i of e)if(void 0!==i.checkbox){let e=i=>{for(let s of null!==(o=i.children)&&void 0!==o?o:[]){var o;void 0!==s.checkbox&&void 0!==i.checkbox&&s.checkbox.isChecked!==i.checkbox.isChecked&&(s.checkbox.isChecked=i.checkbox.isChecked,t.push(s),e(s))}};e(i);let o=new Set,s=e=>{if(e.parent&&void 0!==e.parent.checkbox&&e.parent.children){if(o.has(e.parent))return;o.add(e.parent);let i=!1,r=!1;for(let t of e.parent.children){if(i&&r)break;void 0!==t.checkbox&&(t.checkbox.isChecked?r=!0:i=!0)}r&&!i&&!0!==e.parent.checkbox.isChecked?(e.parent.checkbox.isChecked=!0,t.push(e.parent),s(e.parent)):i&&!1!==e.parent.checkbox.isChecked&&(e.parent.checkbox.isChecked=!1,t.push(e.parent),s(e.parent))}};s(i)}return e.concat(t)}yh=(0,at.Jb)([(0,at.Yb)(1,at.Ha),(0,at.Yb)(2,at.rx),(0,at.Yb)(3,ut.vS),(0,at.Yb)(4,at.mb)],yh);(0,at.TM)(),(0,at.pO)(),(0,at.G)(),(0,at.K)("remote-explorer-get-started",at.fO.star,(0,at.EM)(9740,"Getting started icon in the remote explorer view.")),(0,at.K)("remote-explorer-documentation",at.fO.book,(0,at.EM)(9741,"Documentation icon in the remote explorer view.")),(0,at.K)("remote-explorer-feedback",at.fO.twitter,(0,at.EM)(9742,"Feedback icon in the remote explorer view.")),(0,at.K)("remote-explorer-review-issues",at.fO.issues,(0,at.EM)(9743,"Review issue icon in the remote explorer view.")),(0,at.K)("remote-explorer-report-issues",at.fO.comment,(0,at.EM)(9744,"Report issue icon in the remote explorer view.")),(0,at.K)("remote-explorer-view-icon",at.fO.remoteExplorer,(0,at.EM)(9745,"View icon of the remote explorer view."));var Sh=(0,at.K)("ports-view-icon",at.fO.plug,(0,at.EM)(9746,"View icon of the remote ports view."));(0,at.K)("ports-view-icon",at.fO.plug,(0,at.EM)(9747,"Icon representing a remote port."));var Eh,kh=(0,at.K)("private-ports-view-icon",at.fO.lock,(0,at.EM)(9748,"Icon representing a private remote port.")),_h=(0,at.K)("ports-forward-icon",at.fO.plus,(0,at.EM)(9749,"Icon for the forward action.")),Ih=(0,at.K)("ports-stop-forward-icon",at.fO.x,(0,at.EM)(9750,"Icon for the stop forwarding action.")),xh=(0,at.K)("ports-open-browser-icon",at.fO.globe,(0,at.EM)(9751,"Icon for the open browser action.")),Ah=(0,at.K)("ports-open-preview-icon",at.fO.openPreview,(0,at.EM)(9752,"Icon for the open preview action.")),Vh=(0,at.K)("ports-copy-address-icon",at.fO.clippy,(0,at.EM)(9753,"Icon for the copy local address action.")),Dh=(0,at.K)("ports-label-icon",at.fO.tag,(0,at.EM)(9754,"Icon for the label port action.")),Mh=(0,at.K)("ports-forwarded-without-process-icon",at.fO.circleOutline,(0,at.EM)(9755,"Icon for forwarded ports that don't have a running process.")),Th=(0,at.K)("ports-forwarded-with-process-icon",at.fO.circleFilled,(0,at.EM)(9756,"Icon for forwarded ports that do have a running process."));(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.oS)(),(0,ut.yb)(),(0,ut.vg)(),(0,at.Dd)(),(0,at.Ol)(),(0,at.Pk)(),(0,at.Pb)(),(0,at.U_)(),(0,at.i_)(),(0,at.ox)(),(0,at.hl)(),(0,at.dc)(),(0,at.Ib)(),(0,at.Rb)(),(0,at.sj)(),(0,bt.k)(),(0,at.wj)(),(0,at.Ur)(),(0,at.Sn)(),(0,at.Kb)(),(0,at.Tb)(),(0,at.ni)(),(0,at.ei)(),(0,ut.Hg)(),(0,ut.Ag)(),(0,at.S)(),(0,at.Bd)(),(0,at.Fd)(),(0,at.Mn)(),(0,at.Gj)(),(0,at.QO)(),(0,at.Xd)(),(0,at.Vb)(),(0,ut.q)(),(0,at.SO)(),(0,ut.n_)(),(0,ut.Hb)(),(0,at.Zp)(),(0,at.Ab)(),(0,at.Ki)(),(0,ut.jy)(),(0,at.LA)(),(0,at.iM)(),(0,at.Ct)(),(0,at.Xn)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.Vc)(),(0,dt.er)(),(0,at.pO)(),(0,at.Ii)(),(0,ut.Yg)(),(0,at.ia)(),(0,at.rr)(),(0,at.Wd)(),(0,at.bE)({});var Rh=new at.Nk("openPreviewEnabled",!1),Oh=class{constructor(e){this.remoteExplorerService=e,this.headerRowHeight=22}getHeight(e){return e.tunnelType!==ut.Vg.Add||this.remoteExplorerService.getEditableData(void 0)?22:30}},Wh=class{constructor(e,t){this.remoteExplorerService=e,this.tunnelService=t,this._candidates=new Map,this.input={label:(0,at.EM)(9786,"Add Port"),icon:void 0,tunnelType:ut.Vg.Add,hasRunningProcess:!1,remoteHost:"",remotePort:0,processDescription:"",tooltipPostfix:"",iconTooltip:"",portTooltip:"",processTooltip:"",originTooltip:"",privacyTooltip:"",source:{source:ut.Kg.User,description:""},protocol:ut.e_.Http,privacy:{id:ut.$g.Private,themeIcon:kh.id,label:(0,at.EM)(9787,"Private")},strip:()=>{}},this.model=e.tunnelModel,this.onForwardedPortsChanged=at.tj.any(this.model.onForwardPort,this.model.onClosePort,this.model.onPortName,this.model.onCandidatesChanged)}get all(){let e=[];return this._candidates=new Map,this.model.candidates.forEach(e=>{this._candidates.set((0,ut.Xg)(e.host,e.port),e)}),(this.model.forwarded.size>0||this.remoteExplorerService.getEditableData(void 0))&&e.push(...this.forwarded),this.model.detected.size>0&&e.push(...this.detected),e.push(this.input),e}addProcessInfoFromCandidate(e){let t=(0,ut.Xg)(e.remoteHost,e.remotePort);this._candidates.has(t)&&(e.processDescription=this._candidates.get(t).detail)}get forwarded(){return Array.from(this.model.forwarded.values()).map(e=>{let t=Fh.createFromTunnel(this.remoteExplorerService,this.tunnelService,e);return this.addProcessInfoFromCandidate(t),t}).sort((e,t)=>e.remotePort===t.remotePort?e.remoteHost<t.remoteHost?-1:1:e.remotePort<t.remotePort?-1:1)}get detected(){return Array.from(this.model.detected.values()).map(e=>{let t=Fh.createFromTunnel(this.remoteExplorerService,this.tunnelService,e,ut.Vg.Detected,!1);return this.addProcessInfoFromCandidate(t),t})}isEmpty(){return 0===this.detected.length&&(0===this.forwarded.length||1===this.forwarded.length&&this.forwarded[0].tunnelType===ut.Vg.Add&&!this.remoteExplorerService.getEditableData(void 0))}};function Lh(e){return{label:"",tunnel:e,editId:ut.Bg.None,tooltip:""}}Wh=(0,at.Jb)([(0,at.Yb)(0,ut.kg),(0,at.Yb)(1,ut.Vb)],Wh);var Jh=class{constructor(){this.label="",this.tooltip="",this.weight=1,this.minimumWidth=40,this.maximumWidth=40,this.templateId="actionbar"}project(e){if(e.tunnelType===ut.Vg.Add)return Lh(e);let t=e.processDescription?Th:Mh,i="";return e instanceof Fh&&(i="".concat(e.iconTooltip," ").concat(e.tooltipPostfix)),{label:"",icon:t,tunnel:e,editId:ut.Bg.None,tooltip:i}}},Gh=class{constructor(){this.label=(0,at.EM)(9788,"Port"),this.tooltip=(0,at.EM)(9789,"The label and remote port number of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){let t=e.tunnelType===ut.Vg.Add,i=e.label,o="";return o=e instanceof Fh&&!t?"".concat(e.portTooltip," ").concat(e.tooltipPostfix):i,{label:i,tunnel:e,menuId:at.xb.TunnelPortInline,editId:e.tunnelType===ut.Vg.Add?ut.Bg.New:ut.Bg.Label,tooltip:o}}},Nh=class e{constructor(){this.label=(0,at.EM)(9790,"Forwarded Address"),this.tooltip=(0,at.EM)(9791,"The address that the forwarded port is available at."),this.weight=1,this.templateId="actionbar"}project(t){var i;if(t.tunnelType===ut.Vg.Add)return Lh(t);let o=null!==(i=t.localAddress)&&void 0!==i?i:"",s=o;return t instanceof Fh&&(s=t.tooltipPostfix),{label:o,menuId:at.xb.TunnelLocalAddressInline,tunnel:t,editId:ut.Bg.LocalPort,tooltip:s,markdownTooltip:o?e.getHoverText(o):void 0}}static getHoverText(e){return function(t){let i="";i="ctrlCmd"===t.getValue("editor").multiCursorModifier?at.pM?(0,at.EM)(9792,"option + click"):(0,at.EM)(9793,"alt + click"):at.pM?(0,at.EM)(9794,"cmd + click"):(0,at.EM)(9795,"ctrl + click");let o=new at.Bc("",!0),s=e.startsWith("http")?e:"http://".concat(e);return o.appendLink(s,"Follow link").appendMarkdown(" (".concat(i,")"))}}},Kh=class{constructor(){this.label=(0,at.EM)(9796,"Running Process"),this.tooltip=(0,at.EM)(9797,"The command line of the process that is using the port."),this.weight=2,this.templateId="actionbar"}project(e){var t;return e.tunnelType===ut.Vg.Add?Lh(e):{label:null!==(t=e.processDescription)&&void 0!==t?t:"",tunnel:e,editId:ut.Bg.None,tooltip:e instanceof Fh?e.processTooltip:""}}},Zh=class{constructor(){this.label=(0,at.EM)(9798,"Origin"),this.tooltip=(0,at.EM)(9799,"The source that a forwarded port originates from. Can be an extension, user forwarded, statically forwarded, or automatically forwarded."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===ut.Vg.Add)return Lh(e);let t=e.source.description,i="".concat(e instanceof Fh?e.originTooltip:"",". ").concat(e instanceof Fh?e.tooltipPostfix:"");return{label:t,menuId:at.xb.TunnelOriginInline,tunnel:e,editId:ut.Bg.None,tooltip:i}}},Bh=class{constructor(){this.label=(0,at.EM)(9800,"Visibility"),this.tooltip=(0,at.EM)(9801,"The availability of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){var t;if(e.tunnelType===ut.Vg.Add)return Lh(e);let i=null===(t=e.privacy)||void 0===t?void 0:t.label,o="";return e instanceof Fh&&(o="".concat(e.privacy.label," ").concat(e.tooltipPostfix)),{label:i,tunnel:e,icon:{id:e.privacy.themeIcon},editId:ut.Bg.None,tooltip:o}}},Ph=class extends at.mj{constructor(e,t,i,o,s,r,n){super(),this.instantiationService=e,this.contextKeyService=t,this.menuService=i,this.contextViewService=o,this.remoteExplorerService=s,this.commandService=r,this.configurationService=n,this.templateId="actionbar",this._hoverDelegate=(0,at.ra)("mouse")}set actionRunner(e){this._actionRunner=e}renderTemplate(e){let t=(0,at.Dx)(e,(0,at.px)(".ports-view-actionbar-cell")),i=(0,at.Dx)(t,(0,at.px)(".ports-view-actionbar-cell-icon"));return{label:new at.xn(t,{supportHighlights:!0,hoverDelegate:this._hoverDelegate}),icon:i,actionBar:new at.Vr((0,at.Dx)(t,(0,at.px)(".actions")),{actionViewItemProvider:at.Jr.bind(void 0,this.instantiationService),hoverDelegate:this._hoverDelegate}),container:t,elementDisposable:at.mj.None}}renderElement(e,t,i){let o;i.actionBar.clear(),i.icon.className="ports-view-actionbar-cell-icon",i.icon.style.display="none",i.label.setLabel(""),i.label.element.style.display="none",i.container.style.height="22px",i.button&&(i.button.element.style.display="none",i.button.dispose()),i.container.style.paddingLeft="0px",i.elementDisposable.dispose(),e.editId===ut.Bg.New&&(o=this.remoteExplorerService.getEditableData(void 0))?this.renderInputBox(i.container,o):(o=this.remoteExplorerService.getEditableData(e.tunnel,e.editId),o?this.renderInputBox(i.container,o):e.tunnel.tunnelType===ut.Vg.Add&&e.menuId===at.xb.TunnelPortInline?this.renderButton(e,i):this.renderActionBarItem(e,i))}renderButton(e,t){t.container.style.paddingLeft="7px",t.container.style.height="28px",t.button=this._register(new at.Gn(t.container,at.Ti)),t.button.label=e.label,t.button.element.title=e.tooltip,this._register(t.button.onDidClick(()=>{this.commandService.executeCommand(au.INLINE_ID)}))}tunnelContext(e){let t;return e instanceof Fh&&(t=e.strip()),t||(t={tunnelType:e.tunnelType,remoteHost:e.remoteHost,remotePort:e.remotePort,localAddress:e.localAddress,protocol:e.protocol,localUri:e.localUri,localPort:e.localPort,name:e.name,closeable:e.closeable,source:e.source,privacy:e.privacy,processDescription:e.processDescription,label:e.label}),t}renderActionBarItem(e,t){t.label.element.style.display="flex",t.label.setLabel(e.label,void 0,{title:e.markdownTooltip?{markdown:e.markdownTooltip(this.configurationService),markdownNotSupportedFallback:e.tooltip}:e.tooltip,extraClasses:e.menuId===at.xb.TunnelLocalAddressInline?["ports-view-actionbar-cell-localaddress"]:void 0}),t.actionBar.context=this.tunnelContext(e.tunnel),t.container.style.paddingLeft="10px";let i=[["view",ut.zg],[Yh.key,e.tunnel.tunnelType],[Qh.key,e.tunnel.closeable],[Xh.key,e.tunnel.privacy.id],[Uh.key,e.tunnel.protocol]],o=this.contextKeyService.createOverlay(i),s=new at.gj;if(t.elementDisposable=s,e.menuId){let i=(0,at.Qr)(s.add(this.menuService.createMenu(e.menuId,o)).getActions({shouldForwardArgs:!0}));if(i){let e=i.filter(e=>e.id.toLowerCase().indexOf("label")>=0);e.length>1&&(e.sort((e,t)=>e.label.length-t.label.length),e.pop(),i=i.filter(t=>e.indexOf(t)<0)),t.actionBar.push(i,{icon:!0,label:!1}),this._actionRunner&&(t.actionBar.actionRunner=this._actionRunner)}}e.icon&&(t.icon.className="ports-view-actionbar-cell-icon ".concat(at.Bb.asClassName(e.icon)),t.icon.title=e.tooltip,t.icon.style.display="inline")}renderInputBox(e,t){this.inputDone&&(this.inputDone=void this.inputDone(!1,!1)),e.style.paddingLeft="5px";let i=t.startingValue||"",o=new at.An(e,this.contextViewService,{ariaLabel:(0,at.EM)(9802,"Press Enter to confirm or Escape to cancel."),validationOptions:{validation:e=>{let i=t.validationMessage(e);return i?{content:i.content,formatContent:!0,type:i.severity===at.Ud.Error?at.jn.ERROR:at.jn.INFO}:null}},placeholder:t.placeholder||"",inputBoxStyles:at.ki});o.value=i,o.focus(),o.select({start:0,end:t.startingValue?t.startingValue.length:0});let s=(0,at.Wj)(async(e,i)=>{(0,at.Sj)(r),this.inputDone&&(this.inputDone=void 0),o.element.style.display="none";let s=o.value;if(i)return t.onFinish(s,e)});this.inputDone=s;let r=[o,(0,at.Tx)(o.inputElement,at._x.KEY_DOWN,async e=>e.equals(at.KO.Enter)?(e.stopPropagation(),o.validate()===at.jn.ERROR?s(!1,!0):s(!0,!0)):e.equals(at.KO.Escape)?(e.preventDefault(),e.stopPropagation(),s(!1,!0)):void 0),(0,at.Sx)(o.inputElement,at._x.BLUR,()=>s(o.validate()!==at.jn.ERROR,!0))];return(0,at.kj)(()=>{s(!1,!1)})}disposeElement(e,t,i){i.elementDisposable.dispose()}disposeTemplate(e){var t;e.label.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose(),null===(t=e.button)||void 0===t||t.dispose()}};Ph=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,at.Nb),(0,at.Yb)(2,at.ti),(0,at.Yb)(3,at.Dl),(0,at.Yb)(4,ut.kg),(0,at.Yb)(5,at.Lb),(0,at.Yb)(6,at.r_)],Ph);var Fh=class e{static createFromTunnel(t,i,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ut.Vg.Forwarded,r=arguments.length>4?arguments[4]:void 0;return new e(s,o.remoteHost,o.remotePort,o.source,!!o.hasRunningProcess,o.protocol,o.localUri,o.localAddress,o.localPort,void 0===r?o.closeable:r,o.name,o.runningProcess,o.pid,o.privacy,t,i)}strip(){return new e(this.tunnelType,this.remoteHost,this.remotePort,this.source,this.hasRunningProcess,this.protocol,this.localUri,this.localAddress,this.localPort,this.closeable,this.name,this.runningProcess,this.pid,this._privacy)}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b){this.tunnelType=e,this.remoteHost=t,this.remotePort=i,this.source=o,this.hasRunningProcess=s,this.protocol=r,this.localUri=n,this.localAddress=a,this.localPort=d,this.closeable=l,this.name=c,this.runningProcess=h,this.pid=u,this._privacy=g,this.remoteExplorerService=p,this.tunnelService=b}get label(){if(this.tunnelType===ut.Vg.Add&&this.name)return this.name;let e=(0,ut.i_)(this.remoteHost)||(0,ut.r_)(this.remoteHost)?"".concat(this.remotePort):"".concat(this.remoteHost,":").concat(this.remotePort);return this.name?"".concat(this.name," (").concat(e,")"):e}set processDescription(e){this.runningProcess=e}get processDescription(){var e;let t="";return this.runningProcess?(t=this.pid&&null!==(e=this.remoteExplorerService)&&void 0!==e&&e.namedProcesses.has(this.pid)?this.remoteExplorerService.namedProcesses.get(this.pid):this.runningProcess.replace(/\0/g," ").trim(),this.pid&&(t+=" (".concat(this.pid,")"))):this.hasRunningProcess&&(t=(0,at.EM)(9803,"Process information unavailable")),t}get tooltipPostfix(){let e;return e=this.localAddress?(0,at.EM)(9804,"Remote port {0}:{1} forwarded to local address {2}. ",this.remoteHost,this.remotePort,this.localAddress):(0,at.EM)(9805,"Remote port {0}:{1} not forwarded. ",this.remoteHost,this.remotePort),e}get iconTooltip(){return this.tunnelType===ut.Vg.Add?this.label:"".concat(this.processDescription?(0,at.EM)(9806,"Port has running process."):(0,at.EM)(9807,"No running process."))}get portTooltip(){return this.tunnelType===ut.Vg.Add?"":"".concat(this.name?(0,at.EM)(9808,"Port labeled {0}. ",this.name):"")}get processTooltip(){var e;return null!==(e=this.processDescription)&&void 0!==e?e:""}get originTooltip(){return this.source.description}get privacy(){var e,t,i;return null!==(e=this.tunnelService)&&void 0!==e&&e.privacyOptions?null!==(t=null===(i=this.tunnelService)||void 0===i?void 0:i.privacyOptions.find(e=>e.id===this._privacy))&&void 0!==t?t:{id:"",themeIcon:at.fO.question.id,label:(0,at.EM)(9809,"Unknown")}:{id:ut.$g.Private,themeIcon:kh.id,label:(0,at.EM)(9787,"Private")}}},Yh=new at.Nk("tunnelType",ut.Vg.Add,!0),Qh=new at.Nk("tunnelCloseable",!1,!0),Xh=new at.Nk("tunnelPrivacy",void 0,!0),Hh=new at.Nk("tunnelPrivacyEnabled",!1,!0),Uh=new at.Nk("tunnelProtocol",ut.e_.Http,!0),jh=new at.Nk("tunnelViewFocus",!1,(0,at.EM)(9810,"Whether the Ports view has focus.")),zh="tunnelViewSelection",qh=new at.Nk(zh,void 0,!0),$h="tunnelViewMultiSelection",eu=new at.Nk($h,void 0,!0),tu=new at.Nk("portChangable",!1,!0),iu=new at.Nk("protocolChangable",!0,!0),ou=(Se=class extends ut.W{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super(t,i,o,r,s,a,n,d,u,p),this.viewModel=e,this.quickInputService=l,this.commandService=c,this.menuService=h,this.remoteExplorerService=g,this.tunnelService=b,this.contextViewService=m,this.tableDisposables=this._register(new at.gj),this.isEditing=!1,this.titleActions=[],this.lastFocus=[],this.height=0,this.width=0,this.tunnelTypeContext=Yh.bindTo(s),this.tunnelCloseableContext=Qh.bindTo(s),this.tunnelPrivacyContext=Xh.bindTo(s),this.tunnelPrivacyEnabledContext=Hh.bindTo(s),this.tunnelPrivacyEnabledContext.set(b.canChangePrivacy),this.protocolChangableContextKey=iu.bindTo(s),this.protocolChangableContextKey.set(b.canChangeProtocol),this.tunnelProtocolContext=Uh.bindTo(s),this.tunnelViewFocusContext=jh.bindTo(s),this.tunnelViewSelectionContext=qh.bindTo(s),this.tunnelViewMultiSelectionContext=eu.bindTo(s),this.portChangableContextKey=tu.bindTo(s);let v=this.contextKeyService.createOverlay([["view",Eh.ID]]),C=this._register(this.menuService.createMenu(at.xb.TunnelTitle,v)),w=()=>{this.titleActions=(0,at.Qr)(C.getActions()),this.updateActions()};this._register(C.onDidChange(w)),w(),this._register((0,at.kj)(()=>{this.titleActions=[]})),this.registerPrivacyActions(),this._register(at.tj.once(this.tunnelService.onAddedTunnelProvider)(()=>{var e;let t=!1;!1===this.tunnelPrivacyEnabledContext.get()&&(this.tunnelPrivacyEnabledContext.set(b.canChangePrivacy),t=!0),!0===this.protocolChangableContextKey.get()&&(this.protocolChangableContextKey.set(b.canChangeProtocol),t=!0),t&&(w(),this.registerPrivacyActions(),this.createTable(),null===(e=this.table)||void 0===e||e.layout(this.height,this.width))}))}registerPrivacyActions(){for(let e of this.tunnelService.privacyOptions){let t="remote.tunnel.privacy".concat(e.id);at.Fb.registerCommand(t,pu.handler(e.id)),at.Cb.appendMenuItem(at.xb.TunnelPrivacy,{order:0,command:{id:t,title:e.label,toggled:Xh.isEqualTo(e.id)}})}}get portCount(){return this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size}createTable(){if(!this.panelContainer)return;this.tableDisposables.clear(),(0,at.Ox)(this.panelContainer);let e=(0,at.Dx)(this.panelContainer,(0,at.px)(".customview-tree"));e.classList.add("ports-view"),e.classList.add("file-icon-themable-tree","show-file-icons");let t=new Ph(this.instantiationService,this.contextKeyService,this.menuService,this.contextViewService,this.remoteExplorerService,this.commandService,this.configurationService),i=[new Jh,new Gh,new Nh,new Kh];this.tunnelService.canChangePrivacy&&i.push(new Bh),i.push(new Zh),this.table=this.instantiationService.createInstance(at.ht,"RemoteTunnels",e,new Oh(this.remoteExplorerService),i,[t],{keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.label},multipleSelectionSupport:!0,accessibilityProvider:{getAriaLabel:e=>e instanceof Fh?"".concat(e.tooltipPostfix," ").concat(e.portTooltip," ").concat(e.iconTooltip," ").concat(e.processTooltip," ").concat(e.originTooltip," ").concat(this.tunnelService.canChangePrivacy?e.privacy.label:""):e.label,getWidgetAriaLabel:()=>(0,at.EM)(9812,"Tunnel View")},openOnSingleClick:!0});let o=this.tableDisposables.add(new at.Ub);t.actionRunner=o,this.tableDisposables.add(this.table),this.tableDisposables.add(this.table.onContextMenu(e=>this.onContextMenu(e,o))),this.tableDisposables.add(this.table.onMouseDblClick(e=>this.onMouseDblClick(e))),this.tableDisposables.add(this.table.onDidChangeFocus(e=>this.onFocusChanged(e))),this.tableDisposables.add(this.table.onDidChangeSelection(e=>this.onSelectionChanged(e))),this.tableDisposables.add(this.table.onDidFocus(()=>this.tunnelViewFocusContext.set(!0))),this.tableDisposables.add(this.table.onDidBlur(()=>this.tunnelViewFocusContext.set(!1)));let s=()=>{var e;return null===(e=this.table)||void 0===e?void 0:e.splice(0,1/0,this.viewModel.all)};s();let r=this.portCount;this.tableDisposables.add(at.tj.debounce(this.viewModel.onForwardedPortsChanged,(e,t)=>t,50)(()=>{let e=this.portCount;(0===r||0===e)&&r!==e&&this._onDidChangeViewWelcomeState.fire(),r=e,s()})),this.tableDisposables.add(this.table.onMouseClick(e=>{if(this.hasOpenLinkModifier(e.browserEvent)&&this.table){let t=this.table.getSelectedElements();(0===t.length||1===t.length&&t[0]===e.element)&&this.commandService.executeCommand(lu.ID,e.element)}})),this.tableDisposables.add(this.table.onDidOpen(e=>{var t;!e.element||e.element.tunnelType!==ut.Vg.Forwarded||"dblclick"===(null===(t=e.browserEvent)||void 0===t?void 0:t.type)&&this.commandService.executeCommand(su.ID)})),this.tableDisposables.add(this.remoteExplorerService.onDidChangeEditable(t=>{var i,o;this.isEditing=!!this.remoteExplorerService.getEditableData(null===t||void 0===t?void 0:t.tunnel,null===t||void 0===t?void 0:t.editId),this._onDidChangeViewWelcomeState.fire(),this.isEditing||e.classList.remove("highlight"),s(),this.isEditing?(e.classList.add("highlight"),t||null===(i=this.table)||void 0===i||i.reveal(this.table.indexOf(this.viewModel.input))):(t&&t.tunnel.tunnelType!==ut.Vg.Add&&null!==(o=this.table)&&void 0!==o&&o.setFocus(this.lastFocus),this.focus())}))}renderBody(e){super.renderBody(e),this.panelContainer=(0,at.Dx)(e,(0,at.px)(".tree-explorer-viewlet-tree-view")),this.createTable()}shouldShowWelcome(){return this.viewModel.isEmpty()&&!this.isEditing}focus(){var e;super.focus(),null===(e=this.table)||void 0===e||e.domFocus()}onFocusChanged(e){e.indexes.length>0&&e.elements.length>0&&(this.lastFocus=[...e.indexes]);let t=e.elements,i=t&&t.length?t[0]:void 0;i?(this.tunnelViewSelectionContext.set((0,ut.Xg)(i.remoteHost,i.remotePort)),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set((i.protocol,ut.e_.Https,ut.e_.Https)),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.reset(),this.tunnelViewSelectionContext.reset(),this.tunnelCloseableContext.reset(),this.tunnelPrivacyContext.reset(),this.tunnelProtocolContext.reset(),this.portChangableContextKey.reset())}hasOpenLinkModifier(e){let t=!1;return t="ctrlCmd"===this.configurationService.getValue("editor").multiCursorModifier?e.altKey:at.pM?e.metaKey:e.ctrlKey,t}onSelectionChanged(e){let t=e.elements;t.length>1?this.tunnelViewMultiSelectionContext.set(t.map(e=>(0,ut.Xg)(e.remoteHost,e.remotePort))):this.tunnelViewMultiSelectionContext.set(void 0)}onContextMenu(e,t){var i,o;if(void 0!==e.element&&!(e.element instanceof Fh))return;e.browserEvent.preventDefault(),e.browserEvent.stopPropagation();let s=e.element;s?(null!==(i=this.table)&&void 0!==i&&i.setFocus([this.table.indexOf(s)]),this.tunnelTypeContext.set(s.tunnelType),this.tunnelCloseableContext.set(!!s.closeable),this.tunnelPrivacyContext.set(s.privacy.id),this.tunnelProtocolContext.set(s.protocol),this.portChangableContextKey.set(!!s.localPort)):(this.tunnelTypeContext.set(ut.Vg.Add),this.tunnelCloseableContext.set(!1),this.tunnelPrivacyContext.set(void 0),this.tunnelProtocolContext.set(void 0),this.portChangableContextKey.set(!1)),this.contextMenuService.showContextMenu({menuId:at.xb.TunnelContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:null===(o=this.table)||void 0===o?void 0:o.contextKeyService,getAnchor:()=>e.anchor,getActionViewItem:e=>{let t=this.keybindingService.lookupKeybinding(e.id);if(t)return new at.Wi(e,e,{label:!0,keybinding:t.getLabel()})},onHide:e=>{var t;e&&(null===(t=this.table)||void 0===t||t.domFocus())},getActionsContext:()=>null===s||void 0===s?void 0:s.strip(),actionRunner:t})}onMouseDblClick(e){e.element||this.commandService.executeCommand(au.INLINE_ID)}layoutBody(e,t){var i;this.height=e,this.width=t,super.layoutBody(e,t),null===(i=this.table)||void 0===i||i.layout(e,t)}},{_:Eh=Se},{_:Se.ID=ut.zg},{_:Se.TITLE=(0,at.DM)(9811,"Ports")},Se);ou=Eh=(0,at.Jb)([(0,at.Yb)(2,at.Ed),(0,at.Yb)(3,at.El),(0,at.Yb)(4,at.Nb),(0,at.Yb)(5,at.r_),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,ut.vb),(0,at.Yb)(8,at.ml),(0,at.Yb)(9,at.uc),(0,at.Yb)(10,at.Lb),(0,at.Yb)(11,at.ti),(0,at.Yb)(12,at.Yd),(0,at.Yb)(13,ut.kg),(0,at.Yb)(14,at.nr),(0,at.Yb)(15,ut.Vb),(0,at.Yb)(16,at.Dl)],ou);var su,ru=class{constructor(e,t){this.id=ou.ID,this.name=ou.TITLE,this.canToggleVisibility=!0,this.hideByDefault=!1,this.group="details@0",this.order=-500,this.canMoveView=!0,this.containerIcon=Sh,this.ctorDescriptor=new at.Xp(ou,[e]),this.remoteAuthority=t.remoteAuthority?t.remoteAuthority.split("+")[0]:void 0}};function nu(e){return e&&e.tunnelType&&e.remoteHost&&e.source}!function(e){e.ID="remote.tunnel.label",e.LABEL=(0,at.EM)(9813,"Set Port Label"),e.COMMAND_ID_KEYWORD="label",e.handler=function(){return async(e,t)=>{let i,o=e.get(ut.kg);if(nu(t))i=t;else{let t=e.get(at.Nb).getContextKeyValue(zh),s=t?o.tunnelModel.forwarded.get(t):void 0;if(s){let t=e.get(ut.Vb);i=Fh.createFromTunnel(o,t,s)}}if(i){let e=i;return new Promise(t=>{let i=e.name?e.name:"".concat(e.remotePort);o.setEditable(e,ut.Bg.Label,{onFinish:async(s,r)=>{s=s.trim(),o.setEditable(e,ut.Bg.Label,null);let n=r&&s!==i;n&&await o.tunnelModel.name(e.remoteHost,e.remotePort,s),t(n?{port:e.remotePort,label:s}:void 0)},validationMessage:()=>null,placeholder:(0,at.EM)(9814,"Port label"),startingValue:i})})}}}}(su||(su={}));var au,du,lu,cu,hu,uu,gu,pu,bu,mu=(0,at.EM)(9815,"Forwarded port should be a number or a host:port."),vu=65536,Cu=(0,at.EM)(9816,"Port number must be \u2265 0 and < {0}.",vu),wu=(0,at.EM)(9817,"May Require Sudo"),yu=(0,at.EM)(9818,"Port is already forwarded");function fu(e,t,i){let o=e.map(e=>{let o=Fh.createFromTunnel(t,i,e);return{label:o.label,description:o.processDescription,tunnel:o}});return 0===o.length&&o.push({label:(0,at.EM)(9824,"No ports currently forwarded. Try running the {0} command",au.LABEL.value)}),o}!function(e){e.INLINE_ID="remote.tunnel.forwardInline",e.COMMANDPALETTE_ID="remote.tunnel.forwardCommandPalette",e.LABEL=(0,at.DM)(9819,"Forward a Port"),e.TREEITEM_LABEL=(0,at.EM)(9820,"Forward Port");let t=(0,at.EM)(9821,"Port number or address (eg. 3000 or 10.10.10.10:2000).");function i(e,t,i,o){let s=(0,ut.Qg)(i);return s?s.port>=vu?{content:Cu,severity:at.Ud.Error}:o&&t.isPortPrivileged(s.port)?{content:wu,severity:at.Ud.Info}:(0,ut.Zg)(e.tunnelModel.forwarded,s.host,s.port)?{content:yu,severity:at.Ud.Error}:null:{content:mu,severity:at.Ud.Error}}function o(e,t,i,o){t?"string"==typeof t&&e.warn((0,at.EM)(9823,"Unable to forward {0}:{1}. {2}",i,o,t)):e.warn((0,at.EM)(9822,"Unable to forward {0}:{1}. The host may not be available or that remote port may already be forwarded",i,o))}e.inlineHandler=function(){return async(e,s)=>{let r=e.get(ut.kg),n=e.get(at.Pd),a=e.get(ut.Vb);r.setEditable(void 0,ut.Bg.New,{onFinish:async(e,t)=>{let i;r.setEditable(void 0,ut.Bg.New,null),t&&(i=(0,ut.Qg)(e))&&r.forward({remote:{host:i.host,port:i.port},elevateIfNeeded:!0}).then(e=>o(n,e,i.host,i.port))},validationMessage:e=>i(r,a,e,a.canElevate),placeholder:t})}},e.commandPaletteHandler=function(){return async(e,s)=>{let r=e.get(ut.kg),n=e.get(at.Pd),a=e.get(ut._g),d=e.get(at.uc),l=e.get(ut.Vb);await a.openView(ou.ID,!0);let c,h=await d.input({prompt:t,validateInput:e=>Promise.resolve(i(r,l,e,l.canElevate))});h&&(c=(0,ut.Qg)(h))&&r.forward({remote:{host:c.host,port:c.port},elevateIfNeeded:!0}).then(e=>o(n,e,c.host,c.port))}}}(au||(au={})),function(e){e.INLINE_ID="remote.tunnel.closeInline",e.COMMANDPALETTE_ID="remote.tunnel.closeCommandPalette",e.LABEL=(0,at.DM)(9825,"Stop Forwarding Port"),e.inlineHandler=function(){return async(e,t)=>{let i=e.get(at.Nb),o=e.get(ut.kg),s=[],r=i.getContextKeyValue($h);if(r)r.forEach(e=>{var t;let i=o.tunnelModel.forwarded.get(e);i&&(null===(t=s)||void 0===t||t.push(i))});else if(nu(t))s=[t];else{let e=i.getContextKeyValue(zh),t=e?o.tunnelModel.forwarded.get(e):void 0;t&&(s=[t])}if(s&&0!==s.length)return Promise.all(s.map(e=>o.close({host:e.remoteHost,port:e.remotePort},ut.Gg.User)))}},e.commandPaletteHandler=function(){return async e=>{let t=e.get(at.uc),i=e.get(ut.kg),o=e.get(ut.Vb),s=e.get(at.Lb),r=fu(Array.from(i.tunnelModel.forwarded.values()).filter(e=>e.closeable),i,o),n=await t.pick(r,{placeHolder:(0,at.EM)(9826,"Choose a port to stop forwarding")});n&&n.tunnel?await i.close({host:n.tunnel.remoteHost,port:n.tunnel.remotePort},ut.Gg.User):n&&await s.executeCommand(au.COMMANDPALETTE_ID)}}}(du||(du={})),function(e){function t(e,t,i){let o=e.forwarded.get(i)||e.detected.get(i);return o?t.open(o.localUri,{allowContributedOpeners:!1}):Promise.resolve()}e.ID="remote.tunnel.open",e.LABEL=(0,at.EM)(9827,"Open in Browser"),e.handler=function(){return async(e,i)=>{let o;if(nu(i)?o=(0,ut.Xg)(i.remoteHost,i.remotePort):i.tunnelRemoteHost&&i.tunnelRemotePort&&(o=(0,ut.Xg)(i.tunnelRemoteHost,i.tunnelRemotePort)),o){return t(e.get(ut.kg).tunnelModel,e.get(at.ml),o)}}},e.run=t}(lu||(lu={})),function(e){async function t(e,t,i,o){let s=e.forwarded.get(o)||e.detected.get(o);if(s){let e=s.remoteHost.includes(":")?"[".concat(s.remoteHost,"]"):s.remoteHost,o=at.xO.parse("http://".concat(e,":").concat(s.remotePort)),r=await i.getOpener(s.localUri,{sourceUri:o},at.PA.None);return r?r.openExternalUri(s.localUri,{sourceUri:o},at.PA.None):t.open(s.localUri)}return Promise.resolve()}e.ID="remote.tunnel.openPreview",e.LABEL=(0,at.EM)(9828,"Preview in Editor"),e.handler=function(){return async(e,i)=>{let o;if(nu(i)?o=(0,ut.Xg)(i.remoteHost,i.remotePort):i.tunnelRemoteHost&&i.tunnelRemotePort&&(o=(0,ut.Xg)(i.tunnelRemoteHost,i.tunnelRemotePort)),o){return t(e.get(ut.kg).tunnelModel,e.get(at.ml),e.get(ut.Ay),o)}}},e.run=t}(cu||(cu={})),function(e){e.ID="remote.tunnel.openCommandPalette",e.LABEL=(0,at.EM)(9829,"Open Port in Browser"),e.handler=function(){return async(e,t)=>{let i=e.get(ut.kg),o=e.get(ut.Vb),s=i.tunnelModel,r=e.get(at.uc),n=e.get(at.ml),a=e.get(at.Lb),d=[...s.forwarded,...s.detected].map(e=>{let t=Fh.createFromTunnel(i,o,e[1]);return{label:t.label,description:t.processDescription,tunnel:t}});0===d.length?d.push({label:(0,at.EM)(9830,"No ports currently forwarded. Open the Ports view to get started.")}):d.push({label:(0,at.EM)(9831,"Open the Ports view...")});let l=await r.pick(d,{placeHolder:(0,at.EM)(9832,"Choose the port to open")});return l&&l.tunnel?lu.run(s,n,(0,ut.Xg)(l.tunnel.remoteHost,l.tunnel.remotePort)):l?a.executeCommand("".concat(ut.zg,".focus")):void 0}}}(hu||(hu={})),function(e){async function t(e,t,i){let o=e.tunnelModel.address(i.remoteHost,i.remotePort);o&&await t.writeText(o.toString())}e.INLINE_ID="remote.tunnel.copyAddressInline",e.COMMANDPALETTE_ID="remote.tunnel.copyAddressCommandPalette",e.INLINE_LABEL=(0,at.EM)(9833,"Copy Local Address"),e.COMMANDPALETTE_LABEL=(0,at.EM)(9834,"Copy Forwarded Port Address"),e.inlineHandler=function(){return async(e,i)=>{let o,s=e.get(ut.kg);if(nu(i))o=i;else{let t=e.get(at.Nb).getContextKeyValue(zh);o=t?s.tunnelModel.forwarded.get(t):void 0}if(o)return t(s,e.get(at.x),o)}},e.commandPaletteHandler=function(){return async(e,i)=>{let o=e.get(at.uc),s=e.get(ut.kg),r=e.get(ut.Vb),n=e.get(at.Lb),a=e.get(at.x),d=Array.from(s.tunnelModel.forwarded.values()).concat(Array.from(s.tunnelModel.detected.values())),l=await o.pick(fu(d,s,r),{placeHolder:(0,at.EM)(9835,"Choose a forwarded port")});l&&l.tunnel?await t(s,a,l.tunnel):l&&await n.executeCommand(au.COMMANDPALETTE_ID)}}}(uu||(uu={})),function(e){e.ID="remote.tunnel.changeLocalPort",e.LABEL=(0,at.EM)(9836,"Change Local Address Port"),e.handler=function(){return async(e,t)=>{let i,o=e.get(ut.kg),s=e.get(at.Pd),r=e.get(ut.Vb);if(nu(t))i=t;else{let t=e.get(at.Nb).getContextKeyValue(zh),s=t?o.tunnelModel.forwarded.get(t):void 0;if(s){let t=e.get(ut.Vb);i=Fh.createFromTunnel(o,t,s)}}if(i){let e=i;o.setEditable(e,ut.Bg.LocalPort,{onFinish:async(t,i)=>{if(o.setEditable(e,ut.Bg.LocalPort,null),i){var r;await o.close({host:e.remoteHost,port:e.remotePort},ut.Gg.Other);let i=Number(t),n=await o.forward({remote:{host:e.remoteHost,port:e.remotePort},local:i,name:e.name,elevateIfNeeded:!0,source:e.source});n&&"string"!=typeof n&&n.tunnelLocalPort!==i&&s.warn((0,at.EM)(9838,"The local port {0} is not available. Port number {1} has been used instead",t,null!==(r=n.tunnelLocalPort)&&void 0!==r?r:n.localAddress))}},validationMessage:e=>function(e,t,i){return t.match(/^[0-9]+$/)?Number(t)>=vu?{content:Cu,severity:at.Ud.Error}:i&&e.isPortPrivileged(Number(t))?{content:wu,severity:at.Ud.Info}:null:{content:(0,at.EM)(9837,"Local port should be a number."),severity:at.Ud.Error}}(r,e,r.canElevate),placeholder:(0,at.EM)(9839,"New local port")})}}}}(gu||(gu={})),function(e){e.handler=function(e){return async(t,i)=>{if(nu(i)){let o=t.get(ut.kg);return await o.close({host:i.remoteHost,port:i.remotePort},ut.Gg.Other),o.forward({remote:{host:i.remoteHost,port:i.remotePort},local:i.localPort,name:i.name,elevateIfNeeded:!0,privacy:e,source:i.source})}}}}(pu||(pu={})),function(e){async function t(e,t,i,o){if(nu(e)){let s={protocol:t},r=o.remoteAuthority?at.V_.USER_REMOTE:at.V_.USER_LOCAL;return i.tunnelModel.configPortsAttributes.addAttributes(e.remotePort,s,r)}}e.ID_HTTP="remote.tunnel.setProtocolHttp",e.ID_HTTPS="remote.tunnel.setProtocolHttps",e.LABEL_HTTP=(0,at.EM)(9840,"HTTP"),e.LABEL_HTTPS=(0,at.EM)(9841,"HTTPS"),e.handlerHttp=function(){return async(e,i)=>t(i,ut.e_.Http,e.get(ut.kg),e.get(bt.O))},e.handlerHttps=function(){return async(e,i)=>t(i,ut.e_.Https,e.get(ut.kg),e.get(bt.O))}}(bu||(bu={}));var Su=Yh.isEqualTo(ut.Vg.Forwarded),Eu=at.Mk.or(Su,Yh.isEqualTo(ut.Vg.Detected)),ku=eu.isEqualTo(void 0);at.kb.registerCommandAndKeybindingRule({id:su.ID,weight:at.Ob.WorkbenchContrib+10,when:at.Mk.and(jh,Su,ku),primary:at.KO.F2,mac:{primary:at.KO.Enter},handler:su.handler()}),at.Fb.registerCommand(au.INLINE_ID,au.inlineHandler()),at.Fb.registerCommand(au.COMMANDPALETTE_ID,au.commandPaletteHandler()),at.kb.registerCommandAndKeybindingRule({id:du.INLINE_ID,weight:at.Ob.WorkbenchContrib+10,when:at.Mk.and(Qh,jh),primary:at.KO.Delete,mac:{primary:at.JO.CtrlCmd|at.KO.Backspace,secondary:[at.KO.Delete]},handler:du.inlineHandler()}),at.Fb.registerCommand(du.COMMANDPALETTE_ID,du.commandPaletteHandler()),at.Fb.registerCommand(lu.ID,lu.handler()),at.Fb.registerCommand(cu.ID,cu.handler()),at.Fb.registerCommand(hu.ID,hu.handler()),at.kb.registerCommandAndKeybindingRule({id:uu.INLINE_ID,weight:at.Ob.WorkbenchContrib+10,when:at.Mk.and(jh,Eu,ku),primary:at.JO.CtrlCmd|at.KO.KeyC,handler:uu.inlineHandler()}),at.Fb.registerCommand(uu.COMMANDPALETTE_ID,uu.commandPaletteHandler()),at.Fb.registerCommand(gu.ID,gu.handler()),at.Fb.registerCommand(bu.ID_HTTP,bu.handlerHttp()),at.Fb.registerCommand(bu.ID_HTTPS,bu.handlerHttps()),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:du.COMMANDPALETTE_ID,title:du.LABEL},when:ut.Jg}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:au.COMMANDPALETTE_ID,title:au.LABEL},when:ut.Jg}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:uu.COMMANDPALETTE_ID,title:uu.COMMANDPALETTE_LABEL},when:ut.Jg}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:hu.ID,title:hu.LABEL},when:ut.Jg}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"._open",order:0,command:{id:lu.ID,title:lu.LABEL},when:at.Mk.and(Eu,ku)}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"._open",order:1,command:{id:cu.ID,title:cu.LABEL},when:at.Mk.and(Eu,ku)}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"0_manage",order:1,command:{id:su.ID,title:su.LABEL,icon:Dh},when:at.Mk.and(Su,ku)}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"2_localaddress",order:0,command:{id:uu.INLINE_ID,title:uu.INLINE_LABEL},when:at.Mk.and(Eu,ku)}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"2_localaddress",order:1,command:{id:gu.ID,title:gu.LABEL},when:at.Mk.and(Su,tu,ku)}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"2_localaddress",order:2,submenu:at.xb.TunnelPrivacy,title:(0,at.EM)(9842,"Port Visibility"),when:at.Mk.and(Su,Hh)}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"2_localaddress",order:3,submenu:at.xb.TunnelProtocol,title:(0,at.EM)(9843,"Change Port Protocol"),when:at.Mk.and(Su,ku,iu)}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"3_forward",order:0,command:{id:du.INLINE_ID,title:du.LABEL},when:Qh}),at.Cb.appendMenuItem(at.xb.TunnelContext,{group:"3_forward",order:1,command:{id:au.INLINE_ID,title:au.LABEL}}),at.Cb.appendMenuItem(at.xb.TunnelProtocol,{order:0,command:{id:bu.ID_HTTP,title:bu.LABEL_HTTP,toggled:Uh.isEqualTo(ut.e_.Http)}}),at.Cb.appendMenuItem(at.xb.TunnelProtocol,{order:1,command:{id:bu.ID_HTTPS,title:bu.LABEL_HTTPS,toggled:Uh.isEqualTo(ut.e_.Https)}}),at.Cb.appendMenuItem(at.xb.TunnelPortInline,{group:"0_manage",order:0,command:{id:au.INLINE_ID,title:au.TREEITEM_LABEL,icon:_h},when:Yh.isEqualTo(ut.Vg.Candidate)}),at.Cb.appendMenuItem(at.xb.TunnelPortInline,{group:"0_manage",order:4,command:{id:su.ID,title:su.LABEL,icon:Dh},when:Su}),at.Cb.appendMenuItem(at.xb.TunnelPortInline,{group:"0_manage",order:5,command:{id:du.INLINE_ID,title:du.LABEL,icon:Ih},when:Qh}),at.Cb.appendMenuItem(at.xb.TunnelLocalAddressInline,{order:-1,command:{id:uu.INLINE_ID,title:uu.INLINE_LABEL,icon:Vh},when:Eu}),at.Cb.appendMenuItem(at.xb.TunnelLocalAddressInline,{order:0,command:{id:lu.ID,title:lu.LABEL,icon:xh},when:Eu}),at.Cb.appendMenuItem(at.xb.TunnelLocalAddressInline,{order:1,command:{id:cu.ID,title:cu.LABEL,icon:Ah},when:Eu}),(0,at.Fg)("ports.iconRunningProcessForeground",dt.xn,(0,at.EM)(9844,"The color of the icon for a port that has an associated running process.")),(0,at.sj)(),(0,at.wj)(),(0,at.rA)();var _u=(Ee=class e extends at.mj{constructor(e,t){super(),this._onDidMatchLocalUrl=new at.ej,this.onDidMatchLocalUrl=this._onDidMatchLocalUrl.event,this.listeners=new Map,this.replPositions=new Map,e.instances.forEach(e=>{this.registerTerminalInstance(e)}),this._register(e.onDidCreateInstance(e=>{this.registerTerminalInstance(e)})),this._register(e.onDidDisposeInstance(e=>{var t;null!==(t=this.listeners.get(e))&&void 0!==t&&t.dispose(),this.listeners.delete(e)})),this._register(t.onDidNewSession(e=>{(!e.parentSession||e.parentSession&&e.hasSeparateRepl())&&this.listeners.set(e.getId(),e.onDidChangeReplElements(()=>{this.processNewReplElements(e)}))})),this._register(t.onDidEndSession(e=>{var t;let{session:i}=e;this.listeners.has(i.getId())&&(null!==(t=this.listeners.get(i.getId()))&&void 0!==t&&t.dispose(),this.listeners.delete(i.getId()))}))}registerTerminalInstance(t){e.excludeTerminals.includes(t.title)||this.listeners.set(t,t.onData(e=>{this.processData(e)}))}processNewReplElements(e){let t=this.replPositions.get(e.getId()),i=e.getReplElements();if(this.replPositions.set(e.getId(),{position:i.length-1,tail:i[i.length-1]}),!t&&i.length>0)i.forEach(e=>this.processData(e.toString()));else if(t&&i.length-1!==t.position)for(let o=i.length-1;o>=0;o--){let e=i[o];if(e===t.tail)break;this.processData(e.toString())}}dispose(){super.dispose();let e=this.listeners.values();for(let t of e)t.dispose()}processData(t){let i=(t=(0,at.bA)(t)).match(e.localUrlRegex)||[];if(i&&i.length>0)i.forEach(i=>{let o;try{o=new URL(i)}catch(s){}if(o){let s=i.match(e.extractPortRegex),r=parseFloat(o.port?o.port:s?s[2]:"NaN");if(!isNaN(r)&&Number.isInteger(r)&&r>0&&r<=65535){let e=o.hostname;if("0.0.0.0"!==e&&"127.0.0.1"!==e&&(e="localhost"),9229!==r&&t.startsWith("Debugger listening on"))return;this._onDidMatchLocalUrl.fire({port:r,host:e})}}});else{let i=t.match(e.localPythonServerRegex);i&&3===i.length&&this._onDidMatchLocalUrl.fire({host:i[1],port:Number(i[2])})}}},{_:Ee.localUrlRegex=/\b\w{0,20}(?::\/\/)?(?:localhost|127\.0\.0\.1|0\.0\.0\.0|:\d{2,5})[\w\-\.\~:\/\?\#[\]\@!\$&\(\)\*\+\,\;\=]*/gim},{_:Ee.extractPortRegex=/(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d{1,5})/},{_:Ee.localPythonServerRegex=/HTTP\son\s(127\.0\.0\.1|0\.0\.0\.0)\sport\s(\d+)/},{_:Ee.excludeTerminals=["Dev Containers"]},Ee);(0,at.Xb)(),(0,at.TM)(),(0,at.wj)(),(0,ut.xf)(),(0,ut.Hg)(),(0,ut.Ag)(),(0,ut.Yg)(),(0,at.Pb)(),(0,bt.k)(),(0,at.Mb)(),(0,ut.kb)(),(0,ut.Tb)(),(0,at.Wd)(),(0,at.U_)(),(0,at.Fd)(),(0,at.hl)(),(0,ut.Iv)(),(0,ut.Fy)(),(0,dt.L)(),(0,at.iM)(),(0,ut.n_)(),(0,ut.Hb)(),(0,at.Zp)(),(0,ut.N)(),(0,gt.ut)(),(0,gt.Gn)(),(0,at.sj)(),(0,ut.jy)(),(0,dt.z)(),(0,at.A_)(),(0,at.gb)(),(0,at.Kb)(),(0,Ct.i)(),(0,at.Vo)(),(0,at.Lo)();var Iu="workbench.view.remote",xu=class extends at.mj{constructor(e,t,i,o,s,r){super(),this.contextKeyService=e,this.environmentService=t,this.remoteExplorerService=i,this.tunnelService=o,this.activityService=s,this.statusbarService=r,this.contextKeyListener=this._register(new at.vj),this.activityBadge=this._register(new at.vj),this.hasPortsInSession=!1,this._register(at.jb.as(ut.uf.ViewsRegistry).registerViewWelcomeContent(ut.zg,{content:this.environmentService.remoteAuthority?(0,at.EM)(9724,"No forwarded ports. Forward a port to access your running services locally.\n[Forward a Port]({0})","command:".concat(au.INLINE_ID)):(0,at.EM)(9725,"No forwarded ports. Forward a port to access your locally running services over the internet.\n[Forward a Port]({0})","command:".concat(au.INLINE_ID))})),this.enableBadgeAndStatusBar(),this.enableForwardedPortsFeatures(),this.environmentService.remoteAuthority||this._register(at.tj.once(this.tunnelService.onTunnelOpened)(()=>{this.hasPortsInSession=!0}))}async getViewContainer(){return at.jb.as(ut.uf.ViewContainersRegistry).registerViewContainer({id:ut.Rg,title:(0,at.DM)(9726,"Ports"),icon:Sh,ctorDescriptor:new at.Xp(ut.A,[ut.Rg,{mergeViewWithContainerWhenSingleView:!0}]),storageId:ut.Rg,hideIfEmpty:!0,order:5},ut.gf.Panel)}async enableForwardedPortsFeatures(){this.contextKeyListener.clear();let e=!!ut.qg.getValue(this.contextKeyService),t=!!ut.Jg.getValue(this.contextKeyService);if(e||t){t||this.contextKeyService.createKey(ut.Jg.key,!0);let i=await this.getViewContainer(),o=new ru(new Wh(this.remoteExplorerService,this.tunnelService),this.environmentService),s=at.jb.as(ut.uf.ViewsRegistry);i&&(this.remoteExplorerService.enablePortsFeatures(!e),s.registerViews([o],i))}else this.contextKeyListener.value=this.contextKeyService.onDidChangeContext(e=>{e.affectsSome(new Set([...ut.qg.keys(),...ut.Jg.keys()]))&&this.enableForwardedPortsFeatures()})}enableBadgeAndStatusBar(){let e=at.jb.as(ut.uf.ViewsRegistry).onViewsRegistered(t=>{t.find(e=>e.views.find(e=>"~remote.forwardedPorts"===e.id))&&(this._register(at.tj.debounce(this.remoteExplorerService.tunnelModel.onForwardPort,(e,t)=>t,50)(()=>{this.updateActivityBadge(),this.updateStatusBar()})),this._register(at.tj.debounce(this.remoteExplorerService.tunnelModel.onClosePort,(e,t)=>t,50)(()=>{this.updateActivityBadge(),this.updateStatusBar()})),this.updateActivityBadge(),this.updateStatusBar(),e.dispose())})}async updateActivityBadge(){this.remoteExplorerService.tunnelModel.forwarded.size>0?this.activityBadge.value=this.activityService.showViewActivity(ut.zg,{badge:new gt.ct(this.remoteExplorerService.tunnelModel.forwarded.size,e=>1===e?(0,at.EM)(9727,"1 forwarded port"):(0,at.EM)(9728,"{0} forwarded ports",e))}):this.activityBadge.clear()}updateStatusBar(){!this.environmentService.remoteAuthority&&!this.hasPortsInSession||(this.entryAccessor?this.entryAccessor.update(this.entry):this._register(this.entryAccessor=this.statusbarService.addEntry(this.entry,"status.forwardedPorts",ut.Db.LEFT,40)))}get entry(){let e,t=this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size,i="".concat(t);if(0===t)e=(0,at.EM)(9729,"No Ports Forwarded");else{let t=Array.from(this.remoteExplorerService.tunnelModel.forwarded.values());t.push(...Array.from(this.remoteExplorerService.tunnelModel.detected.values())),e=(0,at.EM)(9730,"Forwarded Ports: {0}",t.map(e=>e.remotePort).join(", "))}return{name:(0,at.EM)(9731,"Forwarded Ports"),text:"$(radio-tower) ".concat(i),ariaLabel:e,tooltip:e,command:"".concat(ut.zg,".focus")}}};xu=(0,at.Jb)([(0,at.Yb)(0,at.Nb),(0,at.Yb)(1,bt.O),(0,at.Yb)(2,ut.kg),(0,at.Yb)(3,ut.Vb),(0,at.Yb)(4,gt.Wn),(0,at.Yb)(5,ut.wb)],xu);var Au=class{constructor(e,t){this.remoteExplorerService=e,this.logService=t,this.remoteExplorerService.tunnelModel.environmentTunnelsSet?this.restore():at.tj.once(this.remoteExplorerService.tunnelModel.onEnvironmentTunnelsSet)(async()=>{await this.restore()})}async restore(){return this.logService.trace("ForwardedPorts: Doing first restore."),this.remoteExplorerService.restore()}};Au=(0,at.Jb)([(0,at.Yb)(0,ut.kg),(0,at.Yb)(1,at.mb)],Au);var Vu=class extends at.mj{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p){super(),this.terminalService=e,this.notificationService=t,this.openerService=i,this.externalOpenerService=o,this.remoteExplorerService=s,this.contextKeyService=n,this.configurationService=a,this.debugService=d,this.tunnelService=c,this.hostService=h,this.logService=u,this.storageService=g,this.preferencesService=p,r.remoteAuthority&&(a.whenRemoteConfigurationLoaded().then(()=>l.getEnvironment()).then(e=>{this.setup(e),this._register(a.onDidChangeConfiguration(t=>{t.affectsConfiguration("remote.autoForwardPortsSource")?this.setup(e):t.affectsConfiguration("remote.autoForwardPortsFallback")&&!this.portListener&&this.listenForPorts()}))}),this.storageService.getBoolean("processPortForwardingFallback",at.Ro.WORKSPACE,!0)||this.configurationService.updateValue(ut.jg,0,at.V_.WORKSPACE))}getPortAutoFallbackNumber(){var e;let t=this.configurationService.inspect(ut.jg);if(void 0!==t.value&&(0===t.value||t.value!==t.defaultValue))return t.value;let i=this.configurationService.inspect(ut.Ng);return"process"===i.applicationValue||"process"===i.userValue||"process"===i.userLocalValue||"process"===i.userRemoteValue||"process"===i.workspaceFolderValue||"process"===i.workspaceValue?0:null!==(e=t.value)&&void 0!==e?e:20}listenForPorts(){var e;let t=this.getPortAutoFallbackNumber();var i;0!==t?this.procForwarder&&!this.portListener&&"process"===this.configurationService.getValue("remote.autoForwardPortsSource")?this.portListener=this._register(this.remoteExplorerService.tunnelModel.onForwardPort(async()=>{var e;(t=this.getPortAutoFallbackNumber(),0!==t)?Array.from(this.remoteExplorerService.tunnelModel.forwarded.values()).filter(e=>e.source.source===ut.Kg.Auto).length>t&&(await this.configurationService.updateValue(ut.Ng,ut.Pg),this.notificationService.notify({message:(0,at.EM)(9732,"Over 20 ports have been automatically forwarded. The `process` based automatic port forwarding has been switched to `hybrid` in settings. Some ports may no longer be detected."),severity:at.Ud.Warning,actions:{primary:[new at.Hb("switchBack",(0,at.EM)(9733,"Undo"),void 0,!0,async()=>{var e;await this.configurationService.updateValue(ut.Ng,ut.Ig),await this.configurationService.updateValue(ut.jg,0,at.V_.WORKSPACE),null!==(e=this.portListener)&&void 0!==e&&e.dispose(),this.portListener=void 0}),new at.Hb("showPortSourceSetting",(0,at.EM)(9734,"Show Setting"),void 0,!0,async()=>{await this.preferencesService.openSettings({query:"remote.autoForwardPortsSource"})})]}})):null===(e=this.portListener)||void 0===e||e.dispose()})):(null!==(e=this.portListener)&&void 0!==e&&e.dispose(),this.portListener=void 0):null===(i=this.portListener)||void 0===i||i.dispose()}setup(e){var t,i,o,s;let r=null===(t=this.procForwarder)||void 0===t?void 0:t.forwarded,n=this.outputForwarder||this.procForwarder;if(null!==(i=this.procForwarder)&&void 0!==i&&i.dispose(),this.procForwarder=void 0,null!==(o=this.outputForwarder)&&void 0!==o&&o.dispose(),this.outputForwarder=void 0,(null===e||void 0===e?void 0:e.os)!==at.tM.Linux)"output"!==(null===(s=this.configurationService.inspect("remote.autoForwardPortsSource").default)||void 0===s?void 0:s.value)&&at.jb.as(at.b_.Configuration).registerDefaultConfigurations([{overrides:{"remote.autoForwardPortsSource":ut.Fg}}]),this.outputForwarder=this._register(new Wu(this.terminalService,this.notificationService,this.openerService,this.externalOpenerService,this.remoteExplorerService,this.configurationService,this.debugService,this.tunnelService,this.hostService,this.logService,this.contextKeyService,()=>!1));else{let e=()=>this.configurationService.getValue(ut.Ng)===ut.Ig;e()?this.procForwarder=this._register(new Lu(!1,r,!n,this.configurationService,this.remoteExplorerService,this.notificationService,this.openerService,this.externalOpenerService,this.tunnelService,this.hostService,this.logService,this.contextKeyService)):"hybrid"===this.configurationService.getValue("remote.autoForwardPortsSource")&&(this.procForwarder=this._register(new Lu(!0,r,!n,this.configurationService,this.remoteExplorerService,this.notificationService,this.openerService,this.externalOpenerService,this.tunnelService,this.hostService,this.logService,this.contextKeyService))),this.outputForwarder=this._register(new Wu(this.terminalService,this.notificationService,this.openerService,this.externalOpenerService,this.remoteExplorerService,this.configurationService,this.debugService,this.tunnelService,this.hostService,this.logService,this.contextKeyService,e))}this.listenForPorts()}};Vu=(0,at.Jb)([(0,at.Yb)(0,ut.Fv),(0,at.Yb)(1,at.Pd),(0,at.Yb)(2,at.ml),(0,at.Yb)(3,ut.Ay),(0,at.Yb)(4,ut.kg),(0,at.Yb)(5,bt.O),(0,at.Yb)(6,at.Nb),(0,at.Yb)(7,St.o),(0,at.Yb)(8,ut.Py),(0,at.Yb)(9,dt.I),(0,at.Yb)(10,ut.Vb),(0,at.Yb)(11,dt.R),(0,at.Yb)(12,at.mb),(0,at.Yb)(13,at.Io),(0,at.Yb)(14,Ct.r)],Vu);var Du,Mu,Tu,Ru,Ou=(ke=class e extends at.mj{constructor(e,t,i,o,s,r,n,a){super(),this.notificationService=e,this.remoteExplorerService=t,this.openerService=i,this.externalOpenerService=o,this.tunnelService=s,this.hostService=r,this.logService=n,this.contextKeyService=a,this.alreadyOpenedOnce=new Set,this.lastNotifyTime=new Date,this.lastNotifyTime.setFullYear(this.lastNotifyTime.getFullYear()-1)}async doAction(t){var i;this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Starting action for ".concat(null===(i=t[0])||void 0===i?void 0:i.tunnelRemotePort)),this.doActionTunnels=t;let o=await this.portNumberHeuristicDelay();if(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Heuristic chose ".concat(null===o||void 0===o?void 0:o.tunnelRemotePort)),o){var s;let t=null===(s=await this.remoteExplorerService.tunnelModel.getAttributes([{port:o.tunnelRemotePort,host:o.tunnelRemoteHost}]))||void 0===s||null===(s=s.get(o.tunnelRemotePort))||void 0===s?void 0:s.onAutoForward;switch(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) onAutoForward action is ".concat(t)),t){case ut.Wg.OpenBrowserOnce:if(this.alreadyOpenedOnce.has(o.localAddress))break;this.alreadyOpenedOnce.add(o.localAddress);case ut.Wg.OpenBrowser:{let e=(0,ut.Xg)(o.tunnelRemoteHost,o.tunnelRemotePort);await lu.run(this.remoteExplorerService.tunnelModel,this.openerService,e);break}case ut.Wg.OpenPreview:{let e=(0,ut.Xg)(o.tunnelRemoteHost,o.tunnelRemotePort);await cu.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,e);break}case ut.Wg.Silent:break;default:{let t=(new Date).getTime()-this.lastNotifyTime.getTime();this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) time elapsed since last notification ".concat(t," ms")),t>e.NOTIFY_COOL_DOWN&&await this.showNotification(o)}}}}hide(e){var t;this.doActionTunnels&&(this.doActionTunnels=this.doActionTunnels.filter(t=>!e.includes(t.tunnelRemotePort))),this.lastShownPort&&e.indexOf(this.lastShownPort)>=0&&(null===(t=this.lastNotification)||void 0===t||t.close())}async portNumberHeuristicDelay(){if(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Starting heuristic delay"),!this.doActionTunnels||0===this.doActionTunnels.length)return;this.doActionTunnels=this.doActionTunnels.sort((e,t)=>e.tunnelRemotePort-t.tunnelRemotePort);let e=this.doActionTunnels.shift();return e.tunnelRemotePort%1e3==0?(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because % 1000: ".concat(e.tunnelRemotePort)),this.newerTunnel=e,e):e.tunnelRemotePort<1e4&&9229!==e.tunnelRemotePort?(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because < 10000: ".concat(e.tunnelRemotePort)),this.newerTunnel=e,e):(this.logService.trace('ForwardedPorts: (OnAutoForwardedAction) Waiting for "better" tunnel than '.concat(e.tunnelRemotePort)),this.newerTunnel=void 0,new Promise(t=>{setTimeout(()=>{var i;this.newerTunnel?t(void 0):null!==(i=this.doActionTunnels)&&void 0!==i&&i.includes(e)?t(e):t(void 0)},3e3)}))}async basicMessage(e){var t;let i=null===(t=await this.remoteExplorerService.tunnelModel.getAttributes([{host:e.tunnelRemoteHost,port:e.tunnelRemotePort}],!1))||void 0===t||null===(t=t.get(e.tunnelRemotePort))||void 0===t?void 0:t.label;return(0,at.EM)(9735,"Your application{0} running on port {1} is available.  ",i?" (".concat(i,")"):"",e.tunnelRemotePort)}linkMessage(){return(0,at.EM)(9736,"[See all forwarded ports]({0})","command:".concat(ou.ID,".focus"))}async showNotification(e){var t;if(!await this.hostService.hadLastFocus())return;null===(t=this.lastNotification)||void 0===t||t.close();let i=await this.basicMessage(e),o=[this.openBrowserChoice(e)];(!at._M||Rh.getValue(this.contextKeyService))&&o.push(this.openPreviewChoice(e)),e.tunnelLocalPort!==e.tunnelRemotePort&&this.tunnelService.canElevate&&this.tunnelService.isPortPrivileged(e.tunnelRemotePort)&&(i+=(0,at.EM)(9737,"You'll need to run as superuser to use port {0} locally.  ",e.tunnelRemotePort),o.unshift(this.elevateChoice(e))),e.privacy===ut.$g.Private&&at._M&&this.tunnelService.canChangePrivacy&&o.push(this.makePublicChoice(e)),i+=this.linkMessage(),this.lastNotification=this.notificationService.prompt(at.Ud.Info,i,o,{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastShownPort=e.tunnelRemotePort,this.lastNotifyTime=new Date,this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0})}makePublicChoice(e){return{label:(0,at.EM)(9738,"Make Public"),run:async()=>{let t=(0,ut.Zg)(this.remoteExplorerService.tunnelModel.forwarded,e.tunnelRemoteHost,e.tunnelRemotePort);return await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},ut.Gg.Other),this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelLocalPort,name:null===t||void 0===t?void 0:t.name,elevateIfNeeded:!0,privacy:ut.$g.Public,source:null===t||void 0===t?void 0:t.source})}}}openBrowserChoice(e){let t=(0,ut.Xg)(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:lu.LABEL,run:()=>lu.run(this.remoteExplorerService.tunnelModel,this.openerService,t)}}openPreviewChoice(e){let t=(0,ut.Xg)(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:cu.LABEL,run:()=>cu.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,t)}}elevateChoice(e){return{label:(0,at.EM)(9739,"Use Port {0} as Sudo...",e.tunnelRemotePort),run:async()=>{var t;await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},ut.Gg.Other);let i=await this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelRemotePort,elevateIfNeeded:!0,source:ut.Ug});!i||"string"==typeof i||(null!==(t=this.lastNotification)&&void 0!==t&&t.close(),this.lastShownPort=i.tunnelRemotePort,this.lastNotification=this.notificationService.prompt(at.Ud.Info,await this.basicMessage(i)+this.linkMessage(),[this.openBrowserChoice(i),this.openPreviewChoice(e)],{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0}))}}}},{_:ke.NOTIFY_COOL_DOWN=5e3},ke),Wu=class extends at.mj{constructor(e,t,i,o,s,r,n,a,d,l,c,h){super(),this.terminalService=e,this.notificationService=t,this.openerService=i,this.externalOpenerService=o,this.remoteExplorerService=s,this.configurationService=r,this.debugService=n,this.tunnelService=a,this.hostService=d,this.logService=l,this.contextKeyService=c,this.privilegedOnly=h,this.notifier=new Ou(t,s,i,o,a,d,l,c),this._register(r.onDidChangeConfiguration(e=>{e.affectsConfiguration("remote.autoForwardPorts")&&this.tryStartStopUrlFinder()})),this.portsFeatures=this._register(this.remoteExplorerService.onEnabledPortsFeatures(()=>{this.tryStartStopUrlFinder()})),this.tryStartStopUrlFinder(),"hybrid"===r.getValue("remote.autoForwardPortsSource")&&this._register(this.tunnelService.onTunnelClosed(e=>this.notifier.hide([e.port])))}tryStartStopUrlFinder(){this.configurationService.getValue("remote.autoForwardPorts")?this.startUrlFinder():this.stopUrlFinder()}startUrlFinder(){var e;!this.urlFinder&&this.remoteExplorerService.portsFeaturesEnabled!==ut.Lg.AdditionalFeatures||(null!==(e=this.portsFeatures)&&void 0!==e&&e.dispose(),this.urlFinder=this._register(new _u(this.terminalService,this.debugService)),this._register(this.urlFinder.onDidMatchLocalUrl(async e=>{var t;if((0,ut.Zg)(this.remoteExplorerService.tunnelModel.detected,e.host,e.port))return;let i=null===(t=await this.remoteExplorerService.tunnelModel.getAttributes([e]))||void 0===t?void 0:t.get(e.port);if((null===i||void 0===i?void 0:i.onAutoForward)===ut.Wg.Ignore||this.privilegedOnly()&&!this.tunnelService.isPortPrivileged(e.port))return;let o=await this.remoteExplorerService.forward({remote:e,source:ut.Ug},null!==i&&void 0!==i?i:null);o&&"string"!=typeof o&&this.notifier.doAction([o])})))}stopUrlFinder(){this.urlFinder&&(this.urlFinder=void this.urlFinder.dispose())}},Lu=class extends at.mj{constructor(e,t,i,o,s,r,n,a,d,l,c,h){super(),this.unforwardOnly=e,this.alreadyAutoForwarded=t,this.needsInitialCandidates=i,this.configurationService=o,this.remoteExplorerService=s,this.notificationService=r,this.openerService=n,this.externalOpenerService=a,this.tunnelService=d,this.hostService=l,this.logService=c,this.contextKeyService=h,this.autoForwarded=new Set,this.notifiedOnly=new Set,this.initialCandidates=new Set,this.notifier=new Ou(r,s,n,a,d,l,c,h),null!==t&&void 0!==t&&t.forEach(e=>this.autoForwarded.add(e)),this.initialize()}get forwarded(){return this.autoForwarded}async initialize(){this.remoteExplorerService.tunnelModel.environmentTunnelsSet||await new Promise(e=>this.remoteExplorerService.tunnelModel.onEnvironmentTunnelsSet(()=>e())),this._register(this.configurationService.onDidChangeConfiguration(async e=>{e.affectsConfiguration("remote.autoForwardPorts")&&await this.startStopCandidateListener()})),this.portsFeatures=this._register(this.remoteExplorerService.onEnabledPortsFeatures(async()=>{await this.startStopCandidateListener()})),this.startStopCandidateListener()}async startStopCandidateListener(){this.configurationService.getValue("remote.autoForwardPorts")?await this.startCandidateListener():this.stopCandidateListener()}stopCandidateListener(){this.candidateListener&&(this.candidateListener=void this.candidateListener.dispose())}async startCandidateListener(){var e;this.candidateListener||this.remoteExplorerService.portsFeaturesEnabled!==ut.Lg.AdditionalFeatures||(null!==(e=this.portsFeatures)&&void 0!==e&&e.dispose(),await this.setInitialCandidates(),this.configurationService.getValue("remote.autoForwardPorts")&&(this.candidateListener=this._register(this.remoteExplorerService.tunnelModel.onCandidatesChanged(this.handleCandidateUpdate,this))))}async setInitialCandidates(){if(!this.needsInitialCandidates)return void this.logService.debug("ForwardedPorts: (ProcForwarding) Not setting initial candidates");let e=this.remoteExplorerService.tunnelModel.candidatesOrUndefined;e||(await new Promise(e=>this.remoteExplorerService.tunnelModel.onCandidatesChanged(()=>e())),e=this.remoteExplorerService.tunnelModel.candidates);for(let t of e)this.initialCandidates.add((0,ut.Xg)(t.host,t.port));this.logService.debug("ForwardedPorts: (ProcForwarding) Initial candidates set to ".concat(e.map(e=>e.port).join(", ")))}async forwardCandidates(){let e,t=[];this.logService.trace("ForwardedPorts: (ProcForwarding) Attempting to forward ".concat(this.remoteExplorerService.tunnelModel.candidates.length," candidates"));for(let o of this.remoteExplorerService.tunnelModel.candidates){var i;if(!o.detail){this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," missing detail"));continue}e||(e=await this.remoteExplorerService.tunnelModel.getAttributes(this.remoteExplorerService.tunnelModel.candidates));let s=null===(i=e)||void 0===i?void 0:i.get(o.port),r=(0,ut.Xg)(o.host,o.port);if(this.initialCandidates.has(r)&&void 0===(null===s||void 0===s?void 0:s.onAutoForward)||this.notifiedOnly.has(r)||this.autoForwarded.has(r))continue;let n=(0,ut.Zg)(this.remoteExplorerService.tunnelModel.forwarded,o.host,o.port);if((0,ut.Zg)(this.remoteExplorerService.tunnelModel.detected,o.host,o.port))continue;if((null===s||void 0===s?void 0:s.onAutoForward)===ut.Wg.Ignore){this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," is ignored"));continue}let a=await this.remoteExplorerService.forward({remote:o,source:ut.Ug},null!==s&&void 0!==s?s:null);!n&&a?(this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," has been forwarded")),this.autoForwarded.add(r)):a&&(this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," has been notified")),this.notifiedOnly.add(r)),a&&"string"!=typeof a&&t.push(a)}if(this.logService.trace("ForwardedPorts: (ProcForwarding) Forwarded ".concat(t.length," candidates")),0!==t.length)return t}async handleCandidateUpdate(e){let t,i=[];if(this.unforwardOnly){t=new Map;for(let e of this.remoteExplorerService.tunnelModel.forwarded.entries())e[1].source.source===ut.Kg.Auto&&t.set(e[0],e[1])}else t=new Map(this.autoForwarded.entries());for(let s of e){let e=s[0],o=s[1],r=(0,ut.Zg)(t,o.host,o.port);r?("string"==typeof r?this.autoForwarded.delete(e):o={host:r.remoteHost,port:r.remotePort},await this.remoteExplorerService.close(o,ut.Gg.AutoForwardEnd),i.push(o.port)):this.notifiedOnly.has(e)?(this.notifiedOnly.delete(e),i.push(o.port)):this.initialCandidates.has(e)&&this.initialCandidates.delete(e)}if(this.unforwardOnly)return;i.length>0&&await this.notifier.hide(i);let o=await this.forwardCandidates();o&&await this.notifier.doAction(o)}},Ju="workbench.view.scm";!function(e){e.List="list",e.Tree="tree"}(Du||(Du={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information"}(Mu||(Mu={})),function(e){e[e.HistoryPrevious=0]="HistoryPrevious",e[e.HistoryNext=1]="HistoryNext"}(Tu||(Tu={})),function(e){e.DiscoveryTime="discoveryTime",e.Name="name",e.Path="path"}(Ru||(Ru={})),(0,at.Xb)(),(0,at.oS)(),(0,at.LA)(),(0,at.sj)(),(0,at.wj)(),(0,at.Tb)(),(0,at.i_)(),(0,at.Pb)(),(0,at.Ol)(),(0,at.ox)(),(0,at.Dd)(),(0,at.hl)(),(0,at.Va)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.Xd)(),(0,ut.q)(),(0,dt.C)(),(0,ut.yb)(),(0,ut.vg)(),(0,ut.ct)(),(0,ut.lv)(),(0,ut.$i)(),(0,ut.av)(),(0,gt.ut)(),(0,gt.Gn)(),(0,pt.Nt)(),(0,at.rr)();var Gu,Nu="webviewState",Ku=(_e=class extends ut.W{static getOriginStore(e){var t;return null!==(t=this._originStore)&&void 0!==t||(this._originStore=new ut.nt("webviewViews.origins",e)),this._originStore}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super((0,rt.A)((0,rt.A)({},e),{},{titleMenuId:at.xb.ViewTitle,showActions:ut.G.WhenExpanded}),r,o,t,i,l,s,n,d,a),this.activityService=c,this.extensionService=h,this.progressService=u,this.storageService=g,this.viewService=p,this.webviewService=b,this.webviewViewService=m,this._webview=this._register(new at.vj),this._webviewDisposables=this._register(new at.gj),this._activated=!1,this.activity=this._register(new at.vj),this._onDidChangeVisibility=this._register(new at.ej),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDispose=this._register(new at.ej),this.onDispose=this._onDispose.event,this.extensionId=e.fromExtensionId,this.defaultTitle=this.title,this.memento=new dt.S("webviewView.".concat(this.id),g),this.viewState=this.memento.getMemento(at.Ro.WORKSPACE,at.zo.MACHINE),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.webviewViewService.onNewResolverRegistered(e=>{e.viewType===this.id&&this.updateTreeVisibility()})),this.updateTreeVisibility()}dispose(){this._onDispose.fire(),clearTimeout(this._repositionTimeout),super.dispose()}focus(){var e;super.focus(),null===(e=this._webview.value)||void 0===e||e.focus()}renderBody(e){super.renderBody(e),this._container=e,this._rootContainer=void 0,this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{setTimeout(()=>{this.layoutWebview()},0)}),this._register((0,at.kj)(()=>{this._resizeObserver.disconnect()})),this._resizeObserver.observe(e))}saveState(){this._webview.value&&(this.viewState[Nu]=this._webview.value.state),this.memento.saveMemento(),super.saveState()}layoutBody(e,t){super.layoutBody(e,t),this.layoutWebview(new at.mx(t,e))}updateTreeVisibility(){var e,t;this.isBodyVisible()?(this.activate(),null===(e=this._webview.value)||void 0===e||e.claim(this,(0,at.$x)(this.element),void 0)):null===(t=this._webview.value)||void 0===t||t.release(this)}activate(){if(this._activated)return;this._activated=!0;let e=this.extensionId?Gu.getOriginStore(this.storageService).getOrigin(this.id,this.extensionId):void 0,t=this.webviewService.createWebviewOverlay({origin:e,providedViewType:this.id,title:this.title,options:{purpose:ut.ot.WebviewView},contentOptions:{},extension:this.extensionId?{id:this.extensionId}:void 0});t.state=this.viewState[Nu],this._webview.value=t,this._container&&this.layoutWebview(),this._webviewDisposables.add((0,at.kj)(()=>{var e;null===(e=this._webview.value)||void 0===e||e.release(this)})),this._webviewDisposables.add(t.onDidUpdateState(()=>{this.viewState[Nu]=t.state}));for(let o of[at._x.DRAG,at._x.DRAG_END,at._x.DRAG_ENTER,at._x.DRAG_LEAVE,at._x.DRAG_START])this._webviewDisposables.add((0,at.Sx)(this._webview.value.container,o,e=>{e.preventDefault(),e.stopImmediatePropagation(),this.dropTargetElement.dispatchEvent(new DragEvent(e.type,e))}));this._webviewDisposables.add(new ut.Qi((0,at.$x)(this.element),()=>this._webview.value));let i=this._webviewDisposables.add(new at.FA);this.withProgress(async()=>{await this.extensionService.activateByEvent("onView:".concat(this.id));let e=this,o={webview:t,onDidChangeVisibility:this.onDidChangeBodyVisibility,onDispose:this.onDispose,get title(){return e.setTitle},set title(t){e.updateTitle(t)},get description(){return e.titleDescription},set description(t){e.updateTitleDescription(t)},get badge(){return e.badge},set badge(t){e.updateBadge(t)},dispose:()=>{this._activated=!1,this._webview.clear(),this._webviewDisposables.clear()},show:e=>{this.viewService.openView(this.id,!e)}};await this.webviewViewService.resolve(this.id,o,i.token)})}updateTitle(e){this.setTitle=e,super.updateTitle("string"==typeof e?e:this.defaultTitle)}updateBadge(e){var t,i;if(((null===(t=this.badge)||void 0===t?void 0:t.value)!==(null===e||void 0===e?void 0:e.value)||(null===(i=this.badge)||void 0===i?void 0:i.tooltip)!==(null===e||void 0===e?void 0:e.tooltip))&&(this.badge=e,e)){let t={badge:new gt.ct(e.value,()=>e.tooltip),priority:150};this.activity.value=this.activityService.showViewActivity(this.id,t)}}async withProgress(e){return this.progressService.withProgress({location:this.id,delay:500},e)}onDidScrollRoot(){this.layoutWebview()}doLayoutWebview(e){let t=this._webview.value;!this._container||!t||((!this._rootContainer||!this._rootContainer.isConnected)&&(this._rootContainer=this.findRootContainer(this._container)),t.layoutWebviewOverElement(this._container,e,this._rootContainer))}layoutWebview(e){this.doLayoutWebview(e),clearTimeout(this._repositionTimeout),this._repositionTimeout=setTimeout(()=>this.doLayoutWebview(e),200)}findRootContainer(e){var t;return null!==(t=(0,at.Lx)(e,"monaco-scrollable-element"))&&void 0!==t?t:void 0}},{_:Gu=_e},_e);Ku=Gu=(0,at.Jb)([(0,at.Yb)(1,at.r_),(0,at.Yb)(2,at.Nb),(0,at.Yb)(3,at.El),(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.Ed),(0,at.Yb)(6,at.ml),(0,at.Yb)(7,at.nr),(0,at.Yb)(8,at.Yd),(0,at.Yb)(9,ut.vb),(0,at.Yb)(10,gt.Wn),(0,at.Yb)(11,pt.Mt),(0,at.Yb)(12,at.Ba),(0,at.Yb)(13,at.Io),(0,at.Yb)(14,ut._g),(0,at.Yb)(15,ut.cv),(0,at.Yb)(16,ut.iv)],Ku),(0,at.Xb)(),(0,at.dT)(),(0,at.rA)(),(0,at.TM)(),(0,at.Pk)(),(0,pt.pr)(),(0,at.Zp)(),(0,at.ox)(),(0,at.Mb)(),(0,at.Vb)(),(0,ut.N)(),(0,bt.b)(),(0,ut.xf)(),(0,ut.lf)(),(0,ut.m_)(),(0,pt.Tt)(),(0,at.gb)(),(0,pt.vt)(),(0,at.wj)(),(0,at.Vc)();var Zu,Bu,Pu={type:"object",properties:{id:{description:(0,at.EM)(2525,"Unique id used to identify the container in which views can be contributed using 'views' contribution point"),type:"string",pattern:"^[a-zA-Z0-9_-]+$"},title:{description:(0,at.EM)(2526,"Human readable string used to render the container"),type:"string"},icon:{description:(0,at.EM)(2527,"Path to the container icon. Icons are 24x24 centered on a 50x40 block and have a fill color of 'rgb(215, 218, 224)' or '#d7dae0'. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"}},required:["id","title","icon"]},Fu={description:(0,at.EM)(2528,"Contributes views containers to the editor"),type:"object",properties:{activitybar:{description:(0,at.EM)(2529,"Contribute views containers to Activity Bar"),type:"array",items:Pu},panel:{description:(0,at.EM)(2530,"Contribute views containers to Panel"),type:"array",items:Pu},secondarySidebar:{description:(0,at.EM)(2531,"Contribute views containers to Secondary Side Bar"),type:"array",items:Pu}},additionalProperties:!1};!function(e){e.Tree="tree",e.Webview="webview"}(Zu||(Zu={})),function(e){e.Visible="visible",e.Hidden="hidden",e.Collapsed="collapsed"}(Bu||(Bu={}));var Yu={type:"object",required:["id","name","icon"],defaultSnippets:[{body:{id:"${1:id}",name:"${2:name}",icon:"${3:icon}"}}],properties:{type:{markdownDescription:(0,at.EM)(2532,"Type of the view. This can either be `tree` for a tree view based view or `webview` for a webview based view. The default is `tree`."),type:"string",enum:["tree","webview"],markdownEnumDescriptions:[(0,at.EM)(2533,"The view is backed by a `TreeView` created by `createTreeView`."),(0,at.EM)(2534,"The view is backed by a `WebviewView` registered by `registerWebviewViewProvider`.")]},id:{markdownDescription:(0,at.EM)(2535,"Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:(0,at.EM)(2536,"The human-readable name of the view. Will be shown"),type:"string"},when:{description:(0,at.EM)(2537,"Condition which must be true to show this view"),type:"string"},icon:{description:(0,at.EM)(2538,"Path to the view icon. View icons are displayed when the name of the view cannot be shown. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"},contextualTitle:{description:(0,at.EM)(2539,"Human-readable context for when the view is moved out of its original location. By default, the view's container name will be used."),type:"string"},visibility:{description:(0,at.EM)(2540,"Initial state of the view when the extension is first installed. Once the user has changed the view state by collapsing, moving, or hiding the view, the initial state will not be used again."),type:"string",enum:["visible","hidden","collapsed"],default:"visible",enumDescriptions:[(0,at.EM)(2541,"The default initial state for the view. In most containers the view will be expanded, however; some built-in containers (explorer, scm, and debug) show all contributed views collapsed regardless of the `visibility`."),(0,at.EM)(2542,"The view will not be shown in the view container, but will be discoverable through the views menu and other view entry points and can be un-hidden by the user."),(0,at.EM)(2543,"The view will show in the view container, but will be collapsed.")]},initialSize:{type:"number",description:(0,at.EM)(2544,"The initial size of the view. The size will behave like the css 'flex' property, and will set the initial size when the view is first shown. In the side bar, this is the height of the view. This value is only respected when the same extension owns both the view and the view container.")},accessibilityHelpContent:{type:"string",markdownDescription:(0,at.EM)(2545,"When the accessibility help dialog is invoked in this view, this content will be presented to the user as a markdown string. Keybindings will be resolved when provided in the format of <keybinding:commandId>. If there is no keybinding, that will be indicated and this command will be included in a quickpick for easy configuration.")}}},Qu={type:"object",required:["id","name"],properties:{id:{description:(0,at.EM)(2535,"Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:(0,at.EM)(2536,"The human-readable name of the view. Will be shown"),type:"string"},when:{description:(0,at.EM)(2537,"Condition which must be true to show this view"),type:"string"},group:{description:(0,at.EM)(2546,"Nested group in the viewlet"),type:"string"},remoteName:{description:(0,at.EM)(2547,"The name of the remote type associated with this view"),type:["string","array"],items:{type:"string"}}}},Xu={description:(0,at.EM)(2548,"Contributes views to the editor"),type:"object",properties:{explorer:{description:(0,at.EM)(2549,"Contributes views to Explorer container in the Activity bar"),type:"array",items:Yu,default:[]},debug:{description:(0,at.EM)(2550,"Contributes views to Debug container in the Activity bar"),type:"array",items:Yu,default:[]},scm:{description:(0,at.EM)(2551,"Contributes views to SCM container in the Activity bar"),type:"array",items:Yu,default:[]},test:{description:(0,at.EM)(2552,"Contributes views to Test container in the Activity bar"),type:"array",items:Yu,default:[]},remote:{description:(0,at.EM)(2553,"Contributes views to Remote container in the Activity bar. To contribute to this container, enableProposedApi needs to be turned on"),type:"array",items:Qu,default:[]}},additionalProperties:{description:(0,at.EM)(2554,"Contributes views to contributed views container"),type:"array",items:Yu,default:[]}},Hu=pt.wt.registerExtensionPoint({extensionPoint:"viewsContainers",jsonSchema:Fu}),Uu=pt.wt.registerExtensionPoint({extensionPoint:"views",deps:[Hu],jsonSchema:Xu,activationEventsGenerator:(e,t)=>{for(let i of e)for(let e of Object.values(i))for(let i of e)i.id&&t.push("onView:".concat(i.id))}}),ju=(Ie=class{constructor(e,t){this.instantiationService=e,this.logService=t,this.viewContainersRegistry=at.jb.as(ut.uf.ViewContainersRegistry),this.viewsRegistry=at.jb.as(ut.uf.ViewsRegistry),this.handleAndRegisterCustomViewContainers(),this.handleAndRegisterCustomViews()}handleAndRegisterCustomViewContainers(){Hu.setHandler((e,t)=>{let{added:i,removed:o}=t;o.length&&this.removeCustomViewContainers(o),i.length&&this.addCustomViewContainers(i,this.viewContainersRegistry.all)})}addCustomViewContainers(e,t){let i=at.jb.as(ut.uf.ViewContainersRegistry),o=7+i.all.filter(e=>!!e.extensionId&&i.getViewContainerLocation(e)===ut.gf.Sidebar).length,s=5+i.all.filter(e=>!!e.extensionId&&i.getViewContainerLocation(e)===ut.gf.Panel).length+1,r=100+i.all.filter(e=>!!e.extensionId&&i.getViewContainerLocation(e)===ut.gf.AuxiliaryBar).length+1;for(let{value:n,collector:a,description:d}of e)Object.entries(n).forEach(e=>{let[i,n]=e;if(this.isValidViewsContainer(n,a))switch(i){case"activitybar":o=this.registerCustomViewContainers(n,d,o,t,ut.gf.Sidebar);break;case"panel":s=this.registerCustomViewContainers(n,d,s,t,ut.gf.Panel);break;case"secondarySidebar":(0,ut.p_)(d,"contribSecondarySidebar"),r=this.registerCustomViewContainers(n,d,r,t,ut.gf.AuxiliaryBar)}})}removeCustomViewContainers(e){let t=at.jb.as(ut.uf.ViewContainersRegistry),i=e.reduce((e,t)=>(e.add(t.description.identifier),e),new pt.cr);for(let o of t.all)if(o.extensionId&&i.has(o.extensionId)){let e=this.viewsRegistry.getViews(o);e.length&&this.viewsRegistry.moveViews(e,this.getDefaultViewContainer()),this.deregisterCustomViewContainer(o)}}isValidViewsContainer(e,t){if(!Array.isArray(e))return t.error((0,at.EM)(2555,"views containers must be an array")),!1;for(let i of e){if("string"!=typeof i.id&&(0,at.oA)(i.id)||!/^[a-z0-9_-]+$/i.test(i.id))return t.error((0,at.EM)(2556,"property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if("string"!=typeof i.title)return t.error((0,at.EM)(2557,"property `{0}` is mandatory and must be of type `string`","title")),!1;if("string"!=typeof i.icon)return t.error((0,at.EM)(2557,"property `{0}` is mandatory and must be of type `string`","icon")),!1;if((0,at.oA)(i.title))return t.warn((0,at.EM)(2558,"property `{0}` is mandatory and must be of type `string` with non-empty value","title")),!0}return!0}registerCustomViewContainers(e,t,i,o,s){return e.forEach(e=>{let r=at.Bb.fromString(e.icon)||(0,at.gT)(t.extensionLocation,e.icon),n="workbench.view.extension.".concat(e.id),a=e.title||n,d=this.registerCustomViewContainer(n,a,r,i++,t.identifier,s);if(o.length){let t=[];for(let i of o)d!==i&&t.push(...this.viewsRegistry.getViews(i).filter(t=>t.originalContainerId===e.id));t.length&&this.viewsRegistry.moveViews(t,d)}}),i}registerCustomViewContainer(e,t,i,o,s,r){let n=this.viewContainersRegistry.get(e);return n||(n=this.viewContainersRegistry.registerViewContainer({id:e,title:{value:t,original:t},extensionId:s,ctorDescriptor:new at.Xp(ut.A,[e,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,order:o,icon:i},r)),n}deregisterCustomViewContainer(e){this.viewContainersRegistry.deregisterViewContainer(e),at.jb.as(It).deregisterPaneComposite(e.id)}handleAndRegisterCustomViews(){Uu.setHandler((e,t)=>{let{added:i,removed:o}=t;o.length&&this.removeViews(o),i.length&&this.addViews(i)})}addViews(e){let t=new Set,i=[];for(let o of e){let{value:e,collector:s}=o;Object.entries(e).forEach(e=>{let[r,n]=e;if(!this.isValidViewDescriptors(n,s))return;if("remote"===r&&!(0,ut.h_)(o.description,"contribViewsRemote"))return void s.warn((0,at.EM)(2559,"View container '{0}' requires 'enabledApiProposals: [\"contribViewsRemote\"]' to be added to 'Remote'.",r));let a=this.getViewContainer(r);a||s.warn((0,at.EM)(2560,"View container '{0}' does not exist and all views registered to it will be added to 'Explorer'.",r));let d=a||this.getDefaultViewContainer(),l=[];for(let i=0;i<n.length;i++){var c;let e=n[i];if(t.has(e.id)){s.error((0,at.EM)(2561,"Cannot register multiple views with same id `{0}`",e.id));continue}if(null!==this.viewsRegistry.getView(e.id)){s.error((0,at.EM)(2562,"A view with id `{0}` is already registered.",e.id));continue}let h,u=pt.or.equals(o.description.identifier,d.extensionId)?i+1:d.viewOrderDelegate?d.viewOrderDelegate.getOrder(e.group):void 0;"string"==typeof e.icon&&(h=at.Bb.fromString(e.icon)||(0,at.gT)(o.description.extensionLocation,e.icon));let g,p,b=this.convertInitialVisibility(e.visibility),m=this.getViewType(e.type);if(!m){s.error((0,at.EM)(2563,"Unknown view type `{0}`.",e.type));continue}"number"==typeof e.initialSize&&((null===(c=d.extensionId)||void 0===c?void 0:c.value)===o.description.identifier.value?g=e.initialSize:this.logService.warn("".concat(o.description.identifier.value," tried to set the view size of ").concat(e.id," but it was ignored because the view container does not belong to it."))),(0,ut.h_)(o.description,"contribAccessibilityHelpContent")&&e.accessibilityHelpContent&&(p=new at.Bc(e.accessibilityHelpContent));let v={type:m,ctorDescriptor:m===Zu.Tree?new at.Xp(ih):new at.Xp(Ku),id:e.id,name:{value:e.name,original:e.name},when:at.Mk.deserialize(e.when),containerIcon:h||(null===a||void 0===a?void 0:a.icon),containerTitle:e.contextualTitle||a&&("string"==typeof a.title?a.title:a.title.value),canToggleVisibility:!0,canMoveView:(null===a||void 0===a?void 0:a.id)!==Iu,treeView:m===Zu.Tree?this.instantiationService.createInstance(wh,e.id,e.name,o.description.identifier.value):void 0,collapsed:this.showCollapsed(d)||b===Bu.Collapsed,order:u,extensionId:o.description.identifier,originalContainerId:r,group:e.group,remoteAuthority:e.remoteName||e.remoteAuthority,virtualWorkspace:e.virtualWorkspace,hideByDefault:b===Bu.Hidden,workspace:"workbench.view.remote"===(null===a||void 0===a?void 0:a.id)||void 0,weight:g,accessibilityHelpContent:p};t.add(v.id),l.push(v)}i.push({viewContainer:d,views:l})})}this.viewsRegistry.registerViews2(i)}getViewType(e){return e===Zu.Webview?Zu.Webview:e&&e!==Zu.Tree?void 0:Zu.Tree}getDefaultViewContainer(){return this.viewContainersRegistry.get(ft.c)}removeViews(e){let t=e.reduce((e,t)=>(e.add(t.description.identifier),e),new pt.cr);for(let i of this.viewContainersRegistry.all){let e=this.viewsRegistry.getViews(i).filter(e=>e.extensionId&&t.has(e.extensionId));if(e.length){this.viewsRegistry.deregisterViews(e,i);for(let t of e){let e=t;e.treeView&&e.treeView.dispose()}}}}convertInitialVisibility(e){if(Object.values(Bu).includes(e))return e}isValidViewDescriptors(e,t){if(!Array.isArray(e))return t.error((0,at.EM)(2564,"views must be an array")),!1;for(let i of e){if("string"!=typeof i.id)return t.error((0,at.EM)(2557,"property `{0}` is mandatory and must be of type `string`","id")),!1;if("string"!=typeof i.name)return t.error((0,at.EM)(2557,"property `{0}` is mandatory and must be of type `string`","name")),!1;if(i.when&&"string"!=typeof i.when)return t.error((0,at.EM)(2565,"property `{0}` can be omitted or must be of type `string`","when")),!1;if(i.icon&&"string"!=typeof i.icon)return t.error((0,at.EM)(2565,"property `{0}` can be omitted or must be of type `string`","icon")),!1;if(i.contextualTitle&&"string"!=typeof i.contextualTitle)return t.error((0,at.EM)(2565,"property `{0}` can be omitted or must be of type `string`","contextualTitle")),!1;if(i.visibility&&!this.convertInitialVisibility(i.visibility))return t.error((0,at.EM)(2566,"property `{0}` can be omitted or must be one of {1}","visibility",Object.values(Bu).join(", "))),!1}return!0}getViewContainer(e){switch(e){case"explorer":return this.viewContainersRegistry.get(ft.c);case"debug":return this.viewContainersRegistry.get(ut.cf);case"scm":return this.viewContainersRegistry.get(Ju);case"remote":return this.viewContainersRegistry.get(Iu);default:return this.viewContainersRegistry.get("workbench.view.extension.".concat(e))}}showCollapsed(e){switch(e.id){case ft.c:case Ju:case ut.cf:return!0}return!1}},{_:Ie.ID="workbench.contrib.viewsExtensionHandler"},Ie);ju=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,at.mb)],ju);var zu=class extends at.mj{constructor(){super(...arguments),this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.viewsContainers)}render(e){var t;let i=(null===(t=e.contributes)||void 0===t?void 0:t.viewsContainers)||{},o=Object.keys(i).reduce((e,t)=>{let o=i[t];return e.push(...o.map(e=>(0,rt.A)((0,rt.A)({},e),{},{location:t}))),e},[]);return o.length?{data:{headers:[(0,at.EM)(2567,"ID"),(0,at.EM)(2568,"Title"),(0,at.EM)(2569,"Where")],rows:o.sort((e,t)=>e.id.localeCompare(t.id)).map(e=>[e.id,e.title,e.location])},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}},qu=class extends at.mj{constructor(){super(...arguments),this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.views)}render(e){var t;let i=(null===(t=e.contributes)||void 0===t?void 0:t.views)||{},o=Object.keys(i).reduce((e,t)=>{let o=i[t];return e.push(...o.map(e=>(0,rt.A)((0,rt.A)({},e),{},{location:t}))),e},[]);return o.length?{data:{headers:[(0,at.EM)(2570,"ID"),(0,at.EM)(2571,"Name"),(0,at.EM)(2569,"Where")],rows:o.sort((e,t)=>e.id.localeCompare(t.id)).map(e=>[e.id,e.name,e.location])},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}};at.jb.as(pt._t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"viewsContainers",label:(0,at.EM)(2572,"View Containers"),access:{canToggle:!1},renderer:new at.Xp(zu)}),at.jb.as(pt._t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"views",label:(0,at.EM)(2573,"Views"),access:{canToggle:!1},renderer:new at.Xp(qu)}),(0,bt.x)(ju.ID,ju,bt.y.BlockStartup),(0,at.TM)(),(0,at.GM)(),(0,ht.h)(),(0,at.Pb)(),(0,at.dT)(),(0,dt.xi)(),(0,at.iv)();var $u=class extends yo{constructor(){super(...arguments),this.editorControl=void 0}get scopedContextKeyService(){var e;return null===(e=this.editorControl)||void 0===e?void 0:e.invokeWithinContext(e=>e.get(at.Nb))}getTitle(){return this.input?this.input.getName():(0,at.EM)(3418,"Text Editor")}createEditorControl(e,t){this.editorControl=this._register(this.instantiationService.createInstance(dt.bi,e,t,this.getCodeEditorWidgetOptions()))}getCodeEditorWidgetOptions(){return Object.create(null)}updateEditorControlOptions(e){var t;null===(t=this.editorControl)||void 0===t||t.updateOptions(e)}getMainControl(){return this.editorControl}getControl(){return this.editorControl}computeEditorViewState(e){var t;if(!this.editorControl)return;let i=this.editorControl.getModel();if(!i)return;let o=i.uri;return o&&(0,at.pT)(o,e)&&null!==(t=this.editorControl.saveViewState())&&void 0!==t?t:void 0}setOptions(e){super.setOptions(e),e&&(0,ht.m)(e,(0,at.UM)(this.editorControl),at.rv.Smooth)}focus(){var e;super.focus(),null===(e=this.editorControl)||void 0===e||e.focus()}hasFocus(){var e;return(null===(e=this.editorControl)||void 0===e?void 0:e.hasTextFocus())||super.hasFocus()}setEditorVisible(e){var t,i;super.setEditorVisible(e),e?null===(t=this.editorControl)||void 0===t||t.onVisible():null===(i=this.editorControl)||void 0===i||i.onHide()}layout(e){var t;null===(t=this.editorControl)||void 0===t||t.layout(e)}};(0,at.Xb)(),(0,at.GM)(),(0,bt.en)(),(0,ht.h)(),(0,dt._)(),(0,bt.yt)(),(0,at.yb)(),(0,at.Lo)(),(0,at.pv)(),(0,at.ox)(),(0,at.Xd)(),(0,at.iv)(),(0,bt.G)(),(0,bt.At)(),(0,at.ex)(),(0,at.ev)(),(0,at.v_)(),(0,at.wk)(),(0,at.Cy)(),(0,at.ps)();var eg,tg=class extends $u{constructor(e,t,i,o,s,r,n,a,d,l){super(e,t,i,o,s,r,n,d,a,l)}async setInput(e,t,i,o){await super.setInput(e,t,i,o);let s=await e.resolve();if(o.isCancellationRequested)return;if(!(s instanceof bt.vt))throw Error("Unable to open file as text");let r=(0,at.UM)(this.editorControl),n=s.textEditorModel;if(r.setModel(n),!(0,bt.hn)(null===t||void 0===t?void 0:t.viewState)){let o=this.loadEditorViewState(e,i);o&&(null!==t&&void 0!==t&&t.selection&&(o.cursorState=[]),r.restoreViewState(o))}t&&(0,ht.m)(t,r,at.rv.Immediate),r.updateOptions(this.getReadonlyConfiguration(s.isReadonly()))}revealLastLine(){let e=this.editorControl;if(!e)return;let t=e.getModel();if(t){let i=t.getLineCount();e.revealPosition({lineNumber:i,column:t.getLineMaxColumn(i)},at.rv.Smooth)}}clearInput(){var e;super.clearInput(),null===(e=this.editorControl)||void 0===e||e.setModel(null)}tracksEditorViewState(e){return e instanceof Et.l||e instanceof dt.g}};tg=(0,at.Jb)([(0,at.Yb)(2,at.vb),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,at.Io),(0,at.Yb)(5,at.dv),(0,at.Yb)(6,at.Yd),(0,at.Yb)(7,bt.W),(0,at.Yb)(8,bt.kt),(0,at.Yb)(9,at.fs)],tg);var ig=(xe=class extends tg{constructor(e,t,i,o,s,r,n,a,d,l,c){super(eg.ID,e,t,i,o,s,r,a,n,c),this.modelService=d,this.languageService=l}createEditorControl(e,t){super.createEditorControl(e,t);let i=this.editorControl;i&&this._register(i.onDidPaste(e=>this.onDidEditorPaste(e,i)))}onDidEditorPaste(e,t){if(this.input instanceof Et.l&&this.input.hasLanguageSetExplicitly||1!==e.range.startLineNumber||1!==e.range.startColumn||t.getOption(at.sk.readOnly))return;let i,o=t.getModel();if(o&&o.getLineCount()===e.range.endLineNumber&&o.getLineMaxColumn(e.range.endLineNumber)===e.range.endColumn&&"plaintext"===o.getLanguageId()){if(e.languageId)i={id:e.languageId,source:"event"};else{var s;let e=null!==(s=this.languageService.guessLanguageIdByFilepathOrFirstLine(o.uri,o.getLineContent(1).substr(0,at._y.FIRST_LINE_DETECTION_LENGTH_LIMIT)))&&void 0!==s?s:void 0;e&&(i={id:e,source:"guess"})}if(i&&"plaintext"!==i.id){this.input instanceof Et.l&&"event"===i.source?this.input.setLanguageId(i.id):o.setLanguage(this.languageService.createById(i.id));let e=this.modelService.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget);o.detectIndentation(e.insertSpaces,e.tabSize)}}}},{_:eg=xe},{_:xe.ID="workbench.editors.textResourceEditor"},xe);ig=eg=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.rx),(0,at.Yb)(3,at.Io),(0,at.Yb)(4,at.dv),(0,at.Yb)(5,at.Yd),(0,at.Yb)(6,bt.kt),(0,at.Yb)(7,bt.W),(0,at.Yb)(8,at.$b),(0,at.Yb)(9,at.$_),(0,at.Yb)(10,at.fs)],ig),(0,at.Xb)(),(0,at.TM)(),(0,at.sj)(),(0,at.Lo)(),(0,at.Qs)();var og=class extends ui{constructor(e,t,i,o,s,r){super(e,t,o,s,r),this.callbacks=i,this._onDidChangeMetadata=this._register(new at.ej),this.onDidChangeMetadata=this._onDidChangeMetadata.event,this._onDidOpenInPlace=this._register(new at.ej),this.onDidOpenInPlace=this._onDidOpenInPlace.event}getTitle(){return this.input?this.input.getName():(0,at.EM)(2967,"Binary Viewer")}async getContents(e,t){let i=await e.resolve();if(!(i instanceof Et.r))throw Error("Unable to open file as binary");let o=i.getSize();return this.handleMetadataChanged("number"==typeof o?at.hs.formatSize(o):""),{icon:"$(warning)",label:(0,at.EM)(2968,"The file is not displayed in the text editor because it is either binary or uses an unsupported text encoding."),actions:[{label:(0,at.EM)(2969,"Open Anyway"),run:async()=>{await this.callbacks.openInternal(e,t),this._onDidOpenInPlace.fire()}}]}}handleMetadataChanged(e){this.metadata=e,this._onDidChangeMetadata.fire()}getMetadata(){return this.metadata}};og=(0,at.Jb)([(0,at.Yb)(5,at.Io)],og),(0,at.Xb)(),(0,at.TM)(),(0,bt.en)(),(0,at.yb)(),(0,at.Xd)(),(0,at.ox)(),(0,at.Lo)(),(0,at.i_)(),(0,at.pv)(),(0,bt.G)(),(0,bt.At)();var sg=(Ae=class extends Et.o{constructor(e,t,i,o,s,r,n,a,d){super(e,t,i,o,s,r,n,a,d)}getMetadata(){let e=this.getPrimaryEditorPane(),t=this.getSecondaryEditorPane();if(e instanceof og&&t instanceof og)return(0,at.EM)(2966,"{0} \u2194 {1}",t.getMetadata(),e.getMetadata())}},{_:Ae.ID=bt.Nt},Ae);sg=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.rx),(0,at.Yb)(3,at.Yd),(0,at.Yb)(4,at.Io),(0,at.Yb)(5,at.r_),(0,at.Yb)(6,at.dv),(0,at.Yb)(7,bt.kt),(0,at.Yb)(8,bt.W)],sg);var rg;(0,at.vE)(),(0,at.Xb)(),(0,at.TM)(),(0,at.oS)(),(0,at.rA)(),(0,at.dT)(),(0,at.GM)(),(0,at.SO)(),(0,at.Kb)(),(0,at.iM)(),(0,bt.en)(),(0,at.wj)(),(0,at.Cy)(),(0,gt.Ht)(),(0,gt.Yt)(),(0,bt.At)(),(0,at.Qs)(),(0,at.ps)(),(0,at.ox)(),(0,at.ev)(),(0,at.vO)(),(0,at.gO)(),(0,at.Ib)(),(0,at.Rb)(),(0,vt.v)(),(0,bt.h)(),(0,bt.D)(),(0,pt.p)(),(0,at.wk)(),(0,at.pv)(),(0,at.U_)(),(0,at.i_)(),(0,at.LM)(),(0,lt.o)(),(0,at.ET)(),(0,Ct.i)(),(0,at.dc)(),(0,vt.o)(),(0,at.Ww)(),(0,at.sj)(),(0,ut.kb)(),(0,ut.Tb)(),(0,at.br)(),(0,at.gr)(),(0,at.yb)(),(0,bt.Ot)(),(0,bt.Ct)(),(0,bt.xt)(),(0,at.Pk)(),(0,at.Tb)(),(0,at.Ab)(),(0,at.QO)(),(0,dt.Ra)(),(0,bt.G)(),(0,dt.Ia)(),(0,at.Vl)(),(0,at.bE)({});var ng=class{constructor(e,t){this.primary=e,this.secondary=t}getEncoding(){return this.primary.getEncoding()}async setEncoding(e,t){await at.Dw.settled([this.primary,this.secondary].map(i=>i.setEncoding(e,t)))}},ag=class{constructor(e,t){this.primary=e,this.secondary=t}setLanguageId(e,t){[this.primary,this.secondary].forEach(i=>i.setLanguageId(e,t))}};function dg(e){if(e instanceof Et.l)return e;if(e instanceof bt.Et){let t=dg(e.primary),i=dg(e.secondary);return t&&i?new ng(t,i):t}let t=e;return(0,at.VM)(t.setEncoding,t.getEncoding)?t:null}function lg(e){if(e instanceof Et.l)return e;if(e instanceof bt.Et){let t=lg(e.primary),i=lg(e.secondary);return t&&i?new ag(t,i):t}let t=e;return"function"==typeof t.setLanguageId?t:null}var cg=class{constructor(){this.indentation=!1,this.selectionStatus=!1,this.languageId=!1,this.languageStatus=!1,this.encoding=!1,this.EOL=!1,this.tabFocusMode=!1,this.inputMode=!1,this.columnSelectionMode=!1,this.metadata=!1}combine(e){this.indentation=this.indentation||e.indentation,this.selectionStatus=this.selectionStatus||e.selectionStatus,this.languageId=this.languageId||e.languageId,this.languageStatus=this.languageStatus||e.languageStatus,this.encoding=this.encoding||e.encoding,this.EOL=this.EOL||e.EOL,this.tabFocusMode=this.tabFocusMode||e.tabFocusMode,this.inputMode=this.inputMode||e.inputMode,this.columnSelectionMode=this.columnSelectionMode||e.columnSelectionMode,this.metadata=this.metadata||e.metadata}hasChanges(){return this.indentation||this.selectionStatus||this.languageId||this.languageStatus||this.encoding||this.EOL||this.tabFocusMode||this.inputMode||this.columnSelectionMode||this.metadata}},hg=class{get selectionStatus(){return this._selectionStatus}get languageId(){return this._languageId}get encoding(){return this._encoding}get EOL(){return this._EOL}get indentation(){return this._indentation}get tabFocusMode(){return this._tabFocusMode}get inputMode(){return this._inputMode}get columnSelectionMode(){return this._columnSelectionMode}get metadata(){return this._metadata}update(e){let t=new cg;switch(e.type){case"selectionStatus":this._selectionStatus!==e.selectionStatus&&(this._selectionStatus=e.selectionStatus,t.selectionStatus=!0);break;case"indentation":this._indentation!==e.indentation&&(this._indentation=e.indentation,t.indentation=!0);break;case"languageId":this._languageId!==e.languageId&&(this._languageId=e.languageId,t.languageId=!0);break;case"encoding":this._encoding!==e.encoding&&(this._encoding=e.encoding,t.encoding=!0);break;case"EOL":this._EOL!==e.EOL&&(this._EOL=e.EOL,t.EOL=!0);break;case"tabFocusMode":this._tabFocusMode!==e.tabFocusMode&&(this._tabFocusMode=e.tabFocusMode,t.tabFocusMode=!0);break;case"inputMode":this._inputMode!==e.inputMode&&(this._inputMode=e.inputMode,t.inputMode=!0);break;case"columnSelectionMode":this._columnSelectionMode!==e.columnSelectionMode&&(this._columnSelectionMode=e.columnSelectionMode,t.columnSelectionMode=!0);break;case"metadata":this._metadata!==e.metadata&&(this._metadata=e.metadata,t.metadata=!0)}return t}},ug=class extends at.mj{constructor(e){super(),this.configurationService=e,this._onDidChange=this._register(new at.ej),this.onDidChange=this._onDidChange.event,this.registerListeners();let t=!0===e.getValue("editor.tabFocusMode");dt.La.setTabFocusMode(t)}registerListeners(){this._register(dt.La.onDidChangeTabFocus(e=>this._onDidChange.fire(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>{if(e.affectsConfiguration("editor.tabFocusMode")){let e=!0===this.configurationService.getValue("editor.tabFocusMode");dt.La.setTabFocusMode(e),this._onDidChange.fire(e)}}))}};ug=(0,at.Jb)([(0,at.Yb)(0,at.r_)],ug);var gg=class extends at.mj{constructor(){super(),this._onDidChange=this._register(new at.ej),this.onDidChange=this._onDidChange.event,dt.Fa.setInputMode("insert"),this._register(dt.Fa.onDidChangeInputMode(e=>this._onDidChange.fire(e)))}},pg=(0,at.EM)(3354,"Ln {0}, Col {1} ({2} selected)"),bg=(0,at.EM)(3355,"Ln {0}, Col {1}"),mg=(0,at.EM)(3356,"{0} selections ({1} characters selected)"),vg=(0,at.EM)(3357,"{0} selections"),Cg=(0,at.EM)(3358,"LF"),wg=(0,at.EM)(3359,"CRLF"),yg=class extends at.mj{constructor(e,t,i,o,s,r,n,a){super(),this.targetWindowId=e,this.editorService=t,this.quickInputService=i,this.languageService=o,this.textFileService=s,this.statusbarService=r,this.configurationService=a,this.tabFocusModeElement=this._register(new at.vj),this.inputModeElement=this._register(new at.vj),this.columnSelectionModeElement=this._register(new at.vj),this.indentationElement=this._register(new at.vj),this.selectionElement=this._register(new at.vj),this.encodingElement=this._register(new at.vj),this.eolElement=this._register(new at.vj),this.languageElement=this._register(new at.vj),this.metadataElement=this._register(new at.vj),this.state=new hg,this.toRender=void 0,this.activeEditorListeners=this._register(new at.gj),this.delayedRender=this._register(new at.vj),this.currentMarkerStatus=this._register(n.createInstance(Sg)),this.tabFocusMode=this._register(n.createInstance(ug)),this.inputMode=this._register(n.createInstance(gg)),this.registerCommands(),this.registerListeners()}registerListeners(){this._register(this.editorService.onDidActiveEditorChange(()=>this.updateStatusBar())),this._register(this.textFileService.untitled.onDidChangeEncoding(e=>this.onResourceEncodingChange(e.resource))),this._register(this.textFileService.files.onDidChangeEncoding(e=>this.onResourceEncodingChange(e.resource))),this._register(at.tj.runAndSubscribe(this.tabFocusMode.onDidChange,e=>{void 0===e?this.onTabFocusModeChange(this.configurationService.getValue("editor.tabFocusMode")):this.onTabFocusModeChange(e)})),this._register(at.tj.runAndSubscribe(this.inputMode.onDidChange,e=>this.onInputModeChange(null!==e&&void 0!==e?e:"insert")))}registerCommands(){this._register(at.Fb.registerCommand({id:"changeEditorIndentation".concat(this.targetWindowId),handler:()=>this.showIndentationPicker()}))}async showIndentationPicker(){var e,t;let i=(0,lt.i)(this.editorService.activeTextEditorControl);if(!i)return this.quickInputService.pick([{label:(0,at.EM)(3360,"No text editor active at this time")}]);if(null!==(e=this.editorService.activeEditor)&&void 0!==e&&e.isReadonly())return this.quickInputService.pick([{label:(0,at.EM)(3361,"The active code editor is read-only.")}]);let o=[(0,at.UM)(i.getAction(gt.Gt.ID)),(0,at.UM)(i.getAction(gt.Kt.ID)),(0,at.UM)(i.getAction(gt.Ut.ID)),(0,at.UM)(i.getAction(gt.Wt.ID)),(0,at.UM)(i.getAction(gt.qt.ID)),(0,at.UM)(i.getAction(gt.Jt.ID)),(0,at.UM)(i.getAction(gt.Vt.ID))].map(e=>({id:e.id,label:e.label,detail:at.$j.isDefaultVariant()||e.label===e.alias?void 0:e.alias,run:()=>{i.focus(),e.run()}}));return o.splice(3,0,{type:"separator",label:(0,at.EM)(3362,"convert file")}),o.unshift({type:"separator",label:(0,at.EM)(3363,"change view")}),null===(t=await this.quickInputService.pick(o,{placeHolder:(0,at.EM)(3364,"Select Action"),matchOnDetail:!0}))||void 0===t?void 0:t.run()}updateTabFocusModeElement(e){if(e){if(!this.tabFocusModeElement.value){let e=(0,at.EM)(3365,"Tab Moves Focus");this.tabFocusModeElement.value=this.statusbarService.addEntry({name:(0,at.EM)(3366,"Accessibility Mode"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3367,"Disable Accessibility Mode"),command:"editor.action.toggleTabFocusMode",kind:"prominent"},"status.editor.tabFocusMode",ut.Db.RIGHT,100.7)}}else this.tabFocusModeElement.clear()}updateInputModeElement(e){if("overtype"===e){if(!this.inputModeElement.value){let e=(0,at.EM)(3368,"OVR"),t=(0,at.EM)(3369,"Enable Insert Mode");this.inputModeElement.value=this.statusbarService.addEntry({name:t,text:e,ariaLabel:e,tooltip:t,command:"editor.action.toggleOvertypeInsertMode",kind:"prominent"},"status.editor.inputMode",ut.Db.RIGHT,100.6)}}else this.inputModeElement.clear()}updateColumnSelectionModeElement(e){if(e){if(!this.columnSelectionModeElement.value){let e=(0,at.EM)(3370,"Column Selection");this.columnSelectionModeElement.value=this.statusbarService.addEntry({name:(0,at.EM)(3371,"Column Selection Mode"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3372,"Disable Column Selection Mode"),command:"editor.action.toggleColumnSelection",kind:"prominent"},"status.editor.columnSelectionMode",ut.Db.RIGHT,100.8)}}else this.columnSelectionModeElement.clear()}updateSelectionElement(e){var t;if(!e)return void this.selectionElement.clear();if((null===(t=(0,lt.i)(this.editorService.activeTextEditorControl))||void 0===t||null===(t=t.getModel())||void 0===t||null===(t=t.uri)||void 0===t?void 0:t.scheme)===at.TT.vscodeNotebookCell)return void this.selectionElement.clear();let i={name:(0,at.EM)(3373,"Editor Selection"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3374,"Go to Line/Column"),command:"workbench.action.gotoLine"};this.updateElement(this.selectionElement,i,"status.editor.selection",ut.Db.RIGHT,100.5)}updateIndentationElement(e){var t;if(!e)return void this.indentationElement.clear();if((null===(t=(0,lt.i)(this.editorService.activeTextEditorControl))||void 0===t||null===(t=t.getModel())||void 0===t||null===(t=t.uri)||void 0===t?void 0:t.scheme)===at.TT.vscodeNotebookCell)return void this.indentationElement.clear();let i={name:(0,at.EM)(3375,"Editor Indentation"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3376,"Select Indentation"),command:"changeEditorIndentation".concat(this.targetWindowId)};this.updateElement(this.indentationElement,i,"status.editor.indentation",ut.Db.RIGHT,100.4)}updateEncodingElement(e){if(!e)return void this.encodingElement.clear();let t={name:(0,at.EM)(3377,"Editor Encoding"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3378,"Select Encoding"),command:"workbench.action.editor.changeEncoding"};this.updateElement(this.encodingElement,t,"status.editor.encoding",ut.Db.RIGHT,100.3)}updateEOLElement(e){if(!e)return void this.eolElement.clear();let t={name:(0,at.EM)(3379,"Editor End of Line"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3380,"Select End of Line Sequence"),command:"workbench.action.editor.changeEOL"};this.updateElement(this.eolElement,t,"status.editor.eol",ut.Db.RIGHT,100.2)}updateLanguageIdElement(e){if(!e)return void this.languageElement.clear();let t={name:(0,at.EM)(3381,"Editor Language"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3382,"Select Language Mode"),command:"workbench.action.editor.changeLanguageMode"};this.updateElement(this.languageElement,t,"status.editor.mode",ut.Db.RIGHT,100.1)}updateMetadataElement(e){if(!e)return void this.metadataElement.clear();let t={name:(0,at.EM)(3383,"File Information"),text:e,ariaLabel:e,tooltip:(0,at.EM)(3384,"File Information")};this.updateElement(this.metadataElement,t,"status.editor.info",ut.Db.RIGHT,100)}updateElement(e,t,i,o,s){e.value?e.value.update(t):e.value=this.statusbarService.addEntry(t,i,o,s)}updateState(e){let t=this.state.update(e);t.hasChanges()&&(this.toRender?this.toRender.combine(t):(this.toRender=t,this.delayedRender.value=(0,at.NS)((0,at.eS)(this.targetWindowId,!0).window,()=>{this.delayedRender.clear();let e=this.toRender;this.toRender=void 0,e&&this.doRenderNow()})))}doRenderNow(){this.updateTabFocusModeElement(!!this.state.tabFocusMode),this.updateInputModeElement(this.state.inputMode),this.updateColumnSelectionModeElement(!!this.state.columnSelectionMode),this.updateIndentationElement(this.state.indentation),this.updateSelectionElement(this.state.selectionStatus),this.updateEncodingElement(this.state.encoding),this.updateEOLElement(this.state.EOL?"\r\n"===this.state.EOL?wg:Cg:void 0),this.updateLanguageIdElement(this.state.languageId),this.updateMetadataElement(this.state.metadata)}getSelectionLabel(e){if(e&&e.selections){if(1===e.selections.length)return e.charactersSelected?(0,at.Xk)(pg,e.selections[0].positionLineNumber,e.selections[0].positionColumn,e.charactersSelected):(0,at.Xk)(bg,e.selections[0].positionLineNumber,e.selections[0].positionColumn);if(e.charactersSelected)return(0,at.Xk)(mg,e.selections.length,e.charactersSelected);if(e.selections.length>0)return(0,at.Xk)(vg,e.selections.length)}}updateStatusBar(){var e;let t=this.editorService.activeEditor,i=this.editorService.activeEditorPane,o=i&&null!==(e=(0,lt.i)(i.getControl()))&&void 0!==e?e:void 0;if(this.onColumnSelectionModeChange(o),this.onSelectionChange(o),this.onLanguageChange(o,t),this.onEOLChange(o),this.onEncodingChange(i,o),this.onIndentationChange(o),this.onMetadataChange(i),this.currentMarkerStatus.update(o),this.activeEditorListeners.clear(),i&&this.activeEditorListeners.add(i.onDidChangeControl(()=>{this.updateStatusBar()})),o)this.activeEditorListeners.add(o.onDidChangeConfiguration(e=>{e.hasChanged(at.sk.columnSelection)&&this.onColumnSelectionModeChange(o)})),this.activeEditorListeners.add(at.tj.defer(o.onDidChangeCursorPosition)(()=>{this.onSelectionChange(o),this.currentMarkerStatus.update(o)})),this.activeEditorListeners.add(o.onDidChangeModelLanguage(()=>{this.onLanguageChange(o,t)})),this.activeEditorListeners.add(at.tj.accumulate(o.onDidChangeModelContent)(e=>{this.onEOLChange(o),this.currentMarkerStatus.update(o);let t=o.getSelections();if(t)for(let i of e)for(let e of i.changes)if(t.some(t=>at._O.areIntersecting(t,e.range))){this.onSelectionChange(o);break}})),this.activeEditorListeners.add(o.onDidChangeModelOptions(()=>{this.onIndentationChange(o)}));else if(i instanceof og||i instanceof sg){let e=[];if(i instanceof sg){let t=i.getPrimaryEditorPane();t instanceof og&&e.push(t);let o=i.getSecondaryEditorPane();o instanceof og&&e.push(o)}else e.push(i);for(let t of e)this.activeEditorListeners.add(t.onDidChangeMetadata(()=>{this.onMetadataChange(i)})),this.activeEditorListeners.add(t.onDidOpenInPlace(()=>{this.updateStatusBar()}))}}onLanguageChange(e,t){let i={type:"languageId",languageId:void 0};if(e&&t&&lg(t)){let t=e.getModel();if(t){var o;let e=t.getLanguageId();i.languageId=null!==(o=this.languageService.getLanguageName(e))&&void 0!==o?o:void 0}}this.updateState(i)}onIndentationChange(e){let t={type:"indentation",indentation:void 0};if(e){let i=e.getModel();if(i){let e=i.getOptions();t.indentation=e.insertSpaces?e.tabSize===e.indentSize?(0,at.EM)(3385,"Spaces: {0}",e.indentSize):(0,at.EM)(3386,"Spaces: {0} (Tab Size: {1})",e.indentSize,e.tabSize):(0,at.EM)(3387,"Tab Size: {0}",e.tabSize)}}this.updateState(t)}onMetadataChange(e){let t={type:"metadata",metadata:void 0};(e instanceof og||e instanceof sg)&&(t.metadata=e.getMetadata()),this.updateState(t)}onColumnSelectionModeChange(e){let t={type:"columnSelectionMode",columnSelectionMode:!1};null!==e&&void 0!==e&&e.getOption(at.sk.columnSelection)&&(t.columnSelectionMode=!0),this.updateState(t)}onSelectionChange(e){let t=Object.create(null);if(e){t.selections=e.getSelections()||[],t.charactersSelected=0;let i=e.getModel();if(i)for(let e of t.selections)"number"!=typeof t.charactersSelected&&(t.charactersSelected=0),t.charactersSelected+=i.getCharacterCountInRange(e);if(1===t.selections.length){let i=e.getPosition(),o=new at.mO(t.selections[0].selectionStartLineNumber,t.selections[0].selectionStartColumn,t.selections[0].positionLineNumber,i?e.getStatusbarColumn(i):t.selections[0].positionColumn);t.selections[0]=o}}this.updateState({type:"selectionStatus",selectionStatus:this.getSelectionLabel(t)})}onEOLChange(e){let t={type:"EOL",EOL:void 0};if(e&&!e.getOption(at.sk.readOnly)){let i=e.getModel();i&&(t.EOL=i.getEOL())}this.updateState(t)}onEncodingChange(e,t){if(e&&!this.isActiveEditor(e))return;let i={type:"encoding",encoding:void 0};if(e&&null!==t&&void 0!==t&&t.hasModel()){let t=e.input?dg(e.input):null;if(t){let e=t.getEncoding(),o="string"==typeof e?pt.d[e]:void 0;i.encoding=o?o.labelShort:e}}this.updateState(i)}onResourceEncodingChange(e){let t=this.editorService.activeEditorPane;if(t){let o=bt.Ht.getCanonicalUri(t.input,{supportSideBySide:bt.Jt.PRIMARY});if(o&&(0,at.pT)(o,e)){var i;let e=null!==(i=(0,lt.i)(t.getControl()))&&void 0!==i?i:void 0;return this.onEncodingChange(t,e)}}}onTabFocusModeChange(e){let t={type:"tabFocusMode",tabFocusMode:e};this.updateState(t)}onInputModeChange(e){let t={type:"inputMode",inputMode:e};this.updateState(t)}isActiveEditor(e){let t=this.editorService.activeEditorPane;return!!t&&t===e}};yg=(0,at.Jb)([(0,at.Yb)(1,bt.kt),(0,at.Yb)(2,at.uc),(0,at.Yb)(3,at.$_),(0,at.Yb)(4,bt.E),(0,at.Yb)(5,ut.wb),(0,at.Yb)(6,at.rx),(0,at.Yb)(7,at.r_)],yg);var fg=(Ve=class extends at.mj{constructor(e){super(),this.editorGroupService=e;for(let t of e.parts)this.createEditorStatus(t);this._register(e.onDidCreateAuxiliaryEditorPart(e=>this.createEditorStatus(e)))}createEditorStatus(e){let t=new at.gj;at.tj.once(e.onWillDispose)(()=>t.dispose());let i=this.editorGroupService.getScopedInstantiationService(e);t.add(i.createInstance(yg,e.windowId))}},{_:Ve.ID="workbench.contrib.editorStatus"},Ve);fg=(0,at.Jb)([(0,at.Yb)(0,bt.W)],fg);var Sg=class extends at.mj{constructor(e,t,i){super(),this.statusbarService=e,this.markerService=t,this.configurationService=i,this.editor=void 0,this.markers=[],this.currentMarker=null,this.statusBarEntryAccessor=this._register(new at.vj),this._register(t.onMarkerChanged(e=>this.onMarkerChanged(e))),this._register(at.tj.filter(i.onDidChangeConfiguration,e=>e.affectsConfiguration("problems.showCurrentInStatus"))(()=>this.updateStatus()))}update(e){this.editor=e,this.updateMarkers(),this.updateStatus()}updateStatus(){let e=this.currentMarker;if(this.currentMarker=this.getMarker(),this.hasToUpdateStatus(e,this.currentMarker))if(this.currentMarker){let e=(0,at.CA)(this.currentMarker.message)[0],t="".concat(this.getType(this.currentMarker)," ").concat(e);this.statusBarEntryAccessor.value?this.statusBarEntryAccessor.value.update({name:(0,at.EM)(3388,"Current Problem"),text:t,ariaLabel:t}):this.statusBarEntryAccessor.value=this.statusbarService.addEntry({name:(0,at.EM)(3388,"Current Problem"),text:t,ariaLabel:t},"statusbar.currentProblem",ut.Db.LEFT)}else this.statusBarEntryAccessor.clear()}hasToUpdateStatus(e,t){return!t||!e||at._r.makeKey(e)!==at._r.makeKey(t)}getType(e){switch(e.severity){case at.vr.Error:return"$(error)";case at.vr.Warning:return"$(warning)";case at.vr.Info:return"$(info)"}return""}getMarker(){if(!this.configurationService.getValue("problems.showCurrentInStatus")||!this.editor||!this.editor.getModel())return null;let e=this.editor.getPosition();return e&&this.markers.find(t=>at._O.containsPosition(t,e))||null}onMarkerChanged(e){if(!this.editor)return;let t=this.editor.getModel();t&&(t&&!e.some(e=>(0,at.pT)(t.uri,e))||this.updateMarkers())}updateMarkers(){if(!this.editor)return;let e=this.editor.getModel();e&&(e?(this.markers=this.markerService.read({resource:e.uri,severities:at.vr.Error|at.vr.Warning|at.vr.Info}),this.markers.sort(this.compareMarker)):this.markers=[],this.updateStatus())}compareMarker(e,t){let i=(0,at.Bk)(e.resource.toString(),t.resource.toString());return 0===i&&(i=at.vr.compare(e.severity,t.severity)),0===i&&(i=at._O.compareRangesUsingStarts(e,t)),i}};Sg=(0,at.Jb)([(0,at.Yb)(0,ut.wb),(0,at.Yb)(1,at.hr),(0,at.Yb)(2,at.r_)],Sg);var Eg=(De=class extends at.Hb{constructor(e,t,i){super(rg.ID,(0,at.EM)(3389,"Search Marketplace Extensions for '{0}'...",e)),this.fileExtension=e,this.commandService=t,this.enabled=i.isEnabled()}async run(){await this.commandService.executeCommand("workbench.extensions.action.showExtensionsForLanguage",this.fileExtension)}},{_:rg=De},{_:De.ID="workbench.action.showLanguageExtensions"},De);Eg=rg=(0,at.Jb)([(0,at.Yb)(1,at.Lb),(0,at.Yb)(2,vt.m)],Eg);var kg=(Me=class e extends at.bb{constructor(){super({id:e.ID,title:(0,at.DM)(3390,"Change Language Mode"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.KeyM)},precondition:at.Mk.not("notebookEditorFocused"),metadata:{description:(0,at.EM)(3391,"Change the language mode of the active text editor."),args:[{name:(0,at.EM)(3392,"The name of the language mode to change to."),constraint:e=>"string"==typeof e}]}})}async run(t,i){var o,s;let r=t.get(at.uc),n=t.get(bt.kt),a=t.get(at.$_),d=t.get(bt.bt),l=t.get(bt.E),c=t.get(Ct.r),h=t.get(at.rx),u=t.get(at.r_),g=t.get(at.vb),p=(0,lt.i)(n.activeTextEditorControl);if(!p)return void await r.pick([{label:(0,at.EM)(3360,"No text editor active at this time")}]);let b,m,v=p.getModel(),C=bt.Ht.getOriginalUri(n.activeEditor,{supportSideBySide:bt.Jt.PRIMARY});v&&(m=v.getLanguageId(),b=null!==(o=a.getLanguageName(m))&&void 0!==o?o:void 0);let w=!!C;(null===C||void 0===C?void 0:C.scheme)===at.TT.untitled&&(null===(s=l.untitled.get(C))||void 0===s||!s.hasAssociatedFilePath)&&(w=!1);let y,f,S,E=a.getSortedRegisteredLanguageNames().map(e=>{let t,{languageName:i,languageId:o}=e,s=a.getExtensions(o).join(" ");return t=b===i?(0,at.EM)(3393,"({0}) - Configured Language",o):(0,at.EM)(3394,"({0})",o),{label:i,meta:s,iconClasses:(0,vt.a)(o),description:t}});if(E.unshift({type:"separator",label:(0,at.EM)(3395,"languages (identifier)")}),w&&C){let e=(0,at.uT)(C)||(0,at.iT)(C);S=h.createInstance(Eg,e),S.enabled&&E.unshift(S),f={label:(0,at.EM)(3396,"Configure '{0}' language based settings...",b)},E.unshift(f),y={label:(0,at.EM)(3397,"Configure File Association for '{0}'...",e)},E.unshift(y)}let k={label:(0,at.EM)(3398,"Auto Detect")};E.unshift(k);let _="string"==typeof i?{label:i}:await r.pick(E,{placeHolder:(0,at.EM)(3399,"Select Language Mode"),matchOnDescription:!0});if(!_)return;if(_===S)return void S.run();if(_===y)return void(C&&this.configureFileAssociation(C,a,r,u));if(_===f)return void c.openUserSettings({jsonEditor:!0,revealSetting:{key:"[".concat(null!==m&&void 0!==m?m:null,"]"),edit:!0}});let I=n.activeEditor;if(I){let t=lg(I);if(t){let i,o;if(_===k){if(v){let e=bt.Ht.getOriginalUri(I,{supportSideBySide:bt.Jt.PRIMARY});if(e){var x;let t=null!==(x=a.guessLanguageIdByFilepathOrFirstLine(e,v.getLineContent(1)))&&void 0!==x?x:void 0;(!t||"unknown"===t)&&(o=await d.detectLanguage(e),t=o),t&&(i=a.createById(t))}}}else{let e=a.getLanguageIdByLanguageName(_.label);i=a.createById(e),C&&d.detectLanguage(C).then(e=>{let t=a.getLanguageIdByLanguageName(_.label)||"unknown";if(e===m&&m!==t){var i;let e=u.getValue("workbench.editor.preferHistoryBasedLanguageDetection")?"history":"classic";g.publicLog2(bt.St,{currentLanguageId:null!==b&&void 0!==b?b:"unknown",nextLanguageId:_.label,lineCount:null!==(i=null===v||void 0===v?void 0:v.getLineCount())&&void 0!==i?i:-1,modelPreference:e})}})}if(void 0!==i&&(t.setLanguageId(i.languageId,e.ID),(null===C||void 0===C?void 0:C.scheme)===at.TT.untitled)){let e=u.getValue("workbench.editor.preferHistoryBasedLanguageDetection")?"history":"classic";g.publicLog2("setUntitledDocumentLanguage",{to:i.languageId,from:null!==m&&void 0!==m?m:"none",modelPreference:e})}}p.focus()}}configureFileAssociation(e,t,i,o){let s=(0,at.uT)(e),r=(0,at.iT)(e),n=t.guessLanguageIdByFilepathOrFirstLine(at.xO.file(r)),a=t.getSortedRegisteredLanguageNames().map(e=>{let{languageName:t,languageId:i}=e;return{id:i,label:t,iconClasses:(0,vt.a)(i),description:i===n?(0,at.EM)(3400,"Current Association"):void 0}});setTimeout(async()=>{let e=await i.pick(a,{placeHolder:(0,at.EM)(3401,"Select Language Mode to Associate with '{0}'",s||r)});if(e){let t,i=o.inspect(at._s);t=s&&"."!==r[0]?"*".concat(s):r;let n=at.V_.USER;i.workspaceValue&&i.workspaceValue[t]&&(n=at.V_.WORKSPACE);let a=(0,at.MM)(n===at.V_.WORKSPACE?i.workspaceValue:i.userValue)||Object.create(null);a[t]=e.id,o.updateValue(at._s,a,n)}},50)}},{_:Me.ID="workbench.action.editor.changeLanguageMode"},Me),_g=class extends at.bb{constructor(){super({id:"workbench.action.editor.changeEOL",title:(0,at.DM)(3402,"Change End of Line Sequence"),f1:!0})}async run(e){var t,i;let o=e.get(bt.kt),s=e.get(at.uc),r=(0,lt.i)(o.activeTextEditorControl);if(!r)return void await s.pick([{label:(0,at.EM)(3360,"No text editor active at this time")}]);if(null!==(t=o.activeEditor)&&void 0!==t&&t.isReadonly())return void await s.pick([{label:(0,at.EM)(3361,"The active code editor is read-only.")}]);let n=r.getModel(),a=[{label:Cg,eol:at.dy.LF},{label:wg,eol:at.dy.CRLF}],d="\n"===(null===(i=n)||void 0===i?void 0:i.getEOL())?0:1,l=await s.pick(a,{placeHolder:(0,at.EM)(3403,"Select End of Line Sequence"),activeItem:a[d]});if(l){var c;let e=(0,lt.i)(o.activeTextEditorControl);(null===e||void 0===e?void 0:e.hasModel())&&(null===(c=o.activeEditor)||void 0===c||!c.isReadonly())&&(n=e.getModel(),n.pushStackElement(),n.pushEOL(l.eol),n.pushStackElement())}r.focus()}},Ig=class extends at.bb{constructor(){super({id:"workbench.action.editor.changeEncoding",title:(0,at.DM)(3404,"Change File Encoding"),f1:!0})}async run(e){let t=e.get(bt.kt),i=e.get(at.uc),o=e.get(at.fs),s=e.get(bt.E),r=e.get(at.dv),n=e.get(at.zl),a=(0,lt.i)(t.activeTextEditorControl);if(!a)return void await i.pick([{label:(0,at.EM)(3360,"No text editor active at this time")}]);let d=t.activeEditorPane;if(!d)return void await i.pick([{label:(0,at.EM)(3360,"No text editor active at this time")}]);let l=dg(d.input);if(!l)return void await i.pick([{label:(0,at.EM)(3405,"No file active at this time")}]);let c,h={label:(0,at.EM)(3406,"Save with Encoding")},u={label:(0,at.EM)(3407,"Reopen with Encoding")};if(!at.$j.isDefaultVariant()){let e="Save with Encoding";e!==h.label&&(h.detail=e);let t="Reopen with Encoding";t!==u.label&&(u.detail=t)}if(c=l instanceof Et.l?h:d.input.isReadonly()?u:await i.pick([u,h],{placeHolder:(0,at.EM)(3364,"Select Action"),matchOnDetail:!0}),!c)return;await(0,at.$w)(50);let g,p=bt.Ht.getOriginalUri(d.input,{supportSideBySide:bt.Jt.PRIMARY});if(!p||!o.hasProvider(p)&&p.scheme!==at.TT.untitled)return;o.hasProvider(p)&&(g=(await s.readStream(p,{autoGuessEncoding:!0,candidateGuessEncodings:r.getValue(p,"files.candidateGuessEncodings")})).encoding);let b,m,v=c===u,C=r.getValue(p,"files.encoding"),w=Object.keys(pt.d).sort((e,t)=>e===C?-1:t===C?1:pt.d[e].order-pt.d[t].order).filter(e=>(e!==g||g===C)&&(!v||!pt.d[e].encodeOnly)).map((e,t)=>(e===l.getEncoding()?b=t:pt.d[e].alias===l.getEncoding()&&(m=t),{id:e,label:pt.d[e].labelLong,description:e})),y=w.slice();g&&C!==g&&pt.d[g]&&(w.unshift({type:"separator"}),w.unshift({id:g,label:pt.d[g].labelLong,description:(0,at.EM)(3408,"Guessed from content")}));let f=await i.pick(w,{placeHolder:v?(0,at.EM)(3409,"Select File Encoding to Reopen File"):(0,at.EM)(3410,"Select File Encoding to Save with"),activeItem:y["number"==typeof b?b:"number"==typeof m?m:-1]});if(!f||!t.activeEditorPane)return;let S=dg(t.activeEditorPane.input);if(void 0!==f.id&&S){if(v&&t.activeEditorPane.input.isDirty()){let{confirmed:e}=await n.confirm({message:(0,at.EM)(3411,"Do you want to revert the active text editor and reopen with a different encoding?"),detail:(0,at.EM)(3412,"This will discard any unsaved changes."),primaryButton:(0,at.EM)(3413,"Discard Changes and Reopen")});if(!e)return;await t.activeEditorPane.input.revert(t.activeEditorPane.group.id)}await S.setEncoding(f.id,v?bt.u.Decode:bt.u.Encode)}a.focus()}};(0,at.Xb)(),(0,at.ET)(),(0,at.wj)(),(0,at.SO)(),(0,ht.d)(),(0,at.dT)(),(0,at.v_)(),(0,bt.k)(),(0,bt.V)(),(0,bt.j)(),(0,bt.l)(),(0,ut.gg)(),(0,bt.T)();var xg=class{constructor(e,t,i){this.filesConfigurationService=e,this.environmentService=t,this.pathService=i}canSerialize(e){return this.filesConfigurationService.isHotExitEnabled&&!e.isDisposed()}serialize(e){if(!this.canSerialize(e))return;let t=e,i=t.resource;t.hasAssociatedFilePath&&(i=(0,at.xT)(i,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme));let o,s=t.getLanguageId();"plaintext"===s?t.hasLanguageSetExplicitly&&(o=s):o=s;let r={resourceJSON:i.toJSON(),modeId:o,encoding:t.getEncoding()};return JSON.stringify(r)}deserialize(e,t){return e.invokeFunction(e=>{let i=JSON.parse(t),o=at.xO.revive(i.resourceJSON),s=i.modeId,r=i.encoding;return e.get(ht.u).createTextEditor({resource:o,languageId:s,encoding:r,forceUntitled:!0})})}};xg=(0,at.Jb)([(0,at.Yb)(0,bt.B),(0,at.Yb)(1,bt.O),(0,at.Yb)(2,bt.A)],xg);var Ag=(Te=class extends at.mj{constructor(e,t,i,o,s){super(),this.environmentService=t,this.pathService=i,this.textEditorService=o,this.untitledTextEditorService=s,this._register(e.registerHandler(this))}handles(e){return e.resource.scheme===at.TT.untitled&&""===e.typeId}isOpen(e,t){return!!this.handles(e)&&(t instanceof Et.l&&(0,at.pT)(e.resource,t.resource))}createEditor(e){let t;return t=this.untitledTextEditorService.isUntitledWithAssociatedResource(e.resource)?(0,at.xT)(e.resource,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme):e.resource,this.textEditorService.createTextEditor({resource:t,forceUntitled:!0})}},{_:Te.ID="workbench.contrib.untitledTextEditorWorkingCopyEditorHandler"},Te);Ag=(0,at.Jb)([(0,at.Yb)(0,ut.hg),(0,at.Yb)(1,bt.O),(0,at.Yb)(2,bt.A),(0,at.Yb)(3,ht.u),(0,at.Yb)(4,bt.w)],Ag),(0,at.Xb)(),(0,at.TM)(),(0,at.Mb)(),(0,at.wj)(),(0,at.A_)(),(0,dt.O)(),(0,dt.a)(),(0,dt.V)(),(0,pt.Nt)(),(0,at.AN)(),(0,at.sj)(),(0,bt.k)(),(0,at.Qs)();var Vg,Dg=(Re=class extends at.mj{constructor(e,t,i){super(),this.editorResolverService=e,this.environmentService=i,this.configurationRegistry=at.jb.as(at.b_.Configuration),(async()=>{await t.whenInstalledExtensionsRegistered(),this.updateDynamicEditorConfigurations(),this.registerListeners()})()}registerListeners(){this._register(at.tj.debounce(this.editorResolverService.onDidChangeEditorRegistrations,(e,t)=>t)(()=>this.updateDynamicEditorConfigurations()))}updateDynamicEditorConfigurations(){let e=[...this.editorResolverService.getEditors(),...Vg.AUTO_LOCK_EXTRA_EDITORS].filter(e=>!Vg.AUTO_LOCK_REMOVE_EDITORS.has(e.id)),t=this.editorResolverService.getEditors().filter(e=>e.priority!==dt.t.exclusive).map(e=>e.id),i=Object.create(null);for(let d of e)i[d.id]={type:"boolean",default:Vg.AUTO_LOCK_DEFAULT_ENABLED.has(d.id),description:d.label};let o=Object.create(null);for(let d of e)o[d.id]=Vg.AUTO_LOCK_DEFAULT_ENABLED.has(d.id);let s=this.autoLockConfigurationNode;this.autoLockConfigurationNode=(0,rt.A)((0,rt.A)({},dt.j),{},{properties:{"workbench.editor.autoLockGroups":{type:"object",description:(0,at.EM)(3311,"If an editor matching one of the listed types is opened as the first in an editor group and more than one group is open, the group is automatically locked. Locked groups will only be used for opening editors when explicitly chosen by a user gesture (for example drag and drop), but not by default. Consequently, the active editor in a locked group is less likely to be replaced accidentally with a different editor."),properties:i,default:o,additionalProperties:!1}}});let r=this.defaultBinaryEditorConfigurationNode;this.defaultBinaryEditorConfigurationNode=(0,rt.A)((0,rt.A)({},dt.j),{},{properties:{"workbench.editor.defaultBinaryEditor":{type:"string",default:"",enum:[...t,""],description:(0,at.EM)(3312,"The default editor for files detected as binary. If undefined, the user will be presented with a picker.")}}});let n=this.editorAssociationsConfigurationNode;this.editorAssociationsConfigurationNode=(0,rt.A)((0,rt.A)({},dt.j),{},{properties:{"workbench.editorAssociations":{type:"object",markdownDescription:(0,at.EM)(3313,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),patternProperties:{".*":{type:"string",enum:t}}}}});let a=this.editorLargeFileConfirmationConfigurationNode;this.editorLargeFileConfirmationConfigurationNode=(0,rt.A)((0,rt.A)({},dt.j),{},{properties:{"workbench.editorLargeFileConfirmation":{type:"number",default:(0,at.Vs)(this.environmentService.remoteAuthority)/at.hs.MB,minimum:1,scope:at.y_.RESOURCE,markdownDescription:(0,at.EM)(3314,"Controls the minimum size of a file in MB before asking for confirmation when opening in the editor. Note that this setting may not apply to all editor types and environments.")}}}),this.configurationRegistry.updateConfigurations({add:[this.autoLockConfigurationNode,this.defaultBinaryEditorConfigurationNode,this.editorAssociationsConfigurationNode,this.editorLargeFileConfirmationConfigurationNode],remove:(0,at._N)([s,r,n,a])})}},{_:Vg=Re},{_:Re.ID="workbench.contrib.dynamicEditorConfigurations"},{_:Re.AUTO_LOCK_DEFAULT_ENABLED=new Set(["terminalEditor","mainThreadWebview-simpleBrowser.view","mainThreadWebview-browserPreview","workbench.editor.chatSession","workbench.editor.processExplorer"])},{_:Re.AUTO_LOCK_EXTRA_EDITORS=[{id:"workbench.input.interactive",label:(0,at.EM)(3307,"Interactive Window"),priority:dt.t.builtin},{id:"mainThreadWebview-markdown.preview",label:(0,at.EM)(3308,"Markdown Preview"),priority:dt.t.builtin},{id:"mainThreadWebview-simpleBrowser.view",label:(0,at.EM)(3309,"Simple Browser"),priority:dt.t.builtin},{id:"mainThreadWebview-browserPreview",label:(0,at.EM)(3310,"Live Preview"),priority:dt.t.builtin}]},{_:Re.AUTO_LOCK_REMOVE_EDITORS=new Set(["vscode-interactive-input","interactive","vscode.markdown.preview.editor"])},Re);Dg=Vg=(0,at.Jb)([(0,at.Yb)(0,dt.B),(0,at.Yb)(1,pt.Mt),(0,at.Yb)(2,bt.O)],Dg),(0,at.Mb)(),(0,at.TM)(),(0,gt.f)(),(0,bt.en)(),(0,pt.tr)(),(0,bt.Ot)(),(0,bt.it)(),(0,dt._)(),(0,vt.c)(),(0,at.Tb)(),(0,at.Zp)(),(0,at.QO)(),(0,gt.Bt)(),(0,at.Ab)(),(0,at.Pk)(),(0,at.iM)(),(0,at.ob)(),(0,gt.wn)(),(0,bt.b)(),(0,at.mr)(),(0,at.ET)(),(0,at.pO)(),(0,at.G)(),(0,gt.tt)(),(0,at.Gp)(),(0,dt.Bi)(),(0,at.bo)(),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(ig,ig.ID,(0,at.EM)(3028,"Text Editor")),[new at.Xp(Et.l),new at.Xp(dt.g)]),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(Eo,Eo.ID,(0,at.EM)(3029,"Text Diff Editor")),[new at.Xp(bt.nt)]),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(sg,sg.ID,(0,at.EM)(3030,"Binary Diff Editor")),[new at.Xp(bt.nt)]),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(Et.o,Et.o.ID,(0,at.EM)(3031,"Side by Side Editor")),[new at.Xp(bt.Et)]),at.jb.as(bt.Rt.EditorFactory).registerEditorSerializer(Et.l.ID,xg),at.jb.as(bt.Rt.EditorFactory).registerEditorSerializer(bt.Et.ID,bt.Dt),at.jb.as(bt.Rt.EditorFactory).registerEditorSerializer(bt.nt.ID,bt.rt),(0,bt.x)(fg.ID,fg,bt.y.BlockRestore),(0,bt.x)(Ag.ID,Ag,bt.y.BlockRestore),(0,bt.x)(Dg.ID,Dg,bt.y.BlockRestore),(0,at.ub)(gt.Cn.ID,gt.Cn,at.$y.AfterFirstRender);var Mg=at.jb.as(at.pr.Quickaccess),Tg="inEditorsPicker",Rg=at.Mk.and(gt.zt,at.Mk.has(Tg));Mg.registerQuickAccessProvider({ctor:mo,prefix:mo.PREFIX,contextKey:Tg,placeholder:(0,at.EM)(3032,"Type the name of an editor to open it."),helpEntries:[{description:(0,at.EM)(3033,"Show Editors in Active Group by Most Recently Used"),commandId:vr.ID}]}),Mg.registerQuickAccessProvider({ctor:vo,prefix:vo.PREFIX,contextKey:Tg,placeholder:(0,at.EM)(3032,"Type the name of an editor to open it."),helpEntries:[{description:(0,at.EM)(3034,"Show All Opened Editors By Appearance"),commandId:Cr.ID}]}),Mg.registerQuickAccessProvider({ctor:Co,prefix:Co.PREFIX,contextKey:Tg,placeholder:(0,at.EM)(3032,"Type the name of an editor to open it."),helpEntries:[{description:(0,at.EM)(3035,"Show All Opened Editors By Most Recently Used"),commandId:wr.ID}]}),(0,at.Db)(kg),(0,at.Db)(_g),(0,at.Db)(Ig),(0,at.Db)(sr),(0,at.Db)(rr),(0,at.Db)(class extends or{constructor(){super({id:"workbench.action.nextEditor",title:(0,at.DM)(3206,"Open Next Editor"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.KO.PageDown,mac:{primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.RightArrow,secondary:[at.JO.CtrlCmd|at.JO.Shift|at.KO.BracketRight]}},category:vt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(bt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;if(o+1<i.length)return{editor:i[o+1],groupId:t.id};let s=new Set,r=e.activeGroup;for(;r&&!s.has(r.id);)if(r=e.findGroup({location:bt.q.NEXT},r,!0),r){s.add(r.id);let e=r.getEditors(bt.Ut.SEQUENTIAL);if(e.length>0)return{editor:e[0],groupId:r.id}}}}),(0,at.Db)(class extends or{constructor(){super({id:"workbench.action.previousEditor",title:(0,at.DM)(3207,"Open Previous Editor"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.KO.PageUp,mac:{primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.LeftArrow,secondary:[at.JO.CtrlCmd|at.JO.Shift|at.KO.BracketLeft]}},category:vt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(bt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;if(o>0)return{editor:i[o-1],groupId:t.id};let s=new Set,r=e.activeGroup;for(;r&&!s.has(r.id);)if(r=e.findGroup({location:bt.q.PREVIOUS},r,!0),r){s.add(r.id);let e=r.getEditors(bt.Ut.SEQUENTIAL);if(e.length>0)return{editor:e[e.length-1],groupId:r.id}}}}),(0,at.Db)(class extends or{constructor(){super({id:"workbench.action.nextEditorInGroup",title:(0,at.DM)(3208,"Open Next Editor in Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.PageDown),mac:{primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.JO.Alt|at.KO.RightArrow)}},category:vt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(bt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;return{editor:o+1<i.length?i[o+1]:i[0],groupId:t.id}}}),(0,at.Db)(class extends or{constructor(){super({id:"workbench.action.previousEditorInGroup",title:(0,at.DM)(3209,"Open Previous Editor in Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.PageUp),mac:{primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.JO.Alt|at.KO.LeftArrow)}},category:vt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(bt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;return{editor:o>0?i[o-1]:i[i.length-1],groupId:t.id}}}),(0,at.Db)(class extends or{constructor(){super({id:"workbench.action.firstEditorInGroup",title:(0,at.DM)(3210,"Open First Editor in Group"),f1:!0,category:vt.s.View})}navigate(e){let t=e.activeGroup;return{editor:t.getEditors(bt.Ut.SEQUENTIAL)[0],groupId:t.id}}}),(0,at.Db)(class extends or{constructor(){super({id:"workbench.action.lastEditorInGroup",title:(0,at.DM)(3211,"Open Last Editor in Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Alt|at.KO.Digit0,secondary:[at.JO.CtrlCmd|at.KO.Digit9],mac:{primary:at.JO.WinCtrl|at.KO.Digit0,secondary:[at.JO.CtrlCmd|at.KO.Digit9]}},category:vt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(bt.Ut.SEQUENTIAL);return{editor:i[i.length-1],groupId:t.id}}}),(0,at.Db)(Sr),(0,at.Db)(Er),(0,at.Db)(kr),(0,at.Db)(_r),(0,at.Db)(br),(0,at.Db)(mr),(0,at.Db)(Cr),(0,at.Db)(wr),(0,at.Db)(vr),(0,at.Db)(Ys),(0,at.Db)(class extends Fs{constructor(){super({id:"workbench.action.closeAllGroups",title:(0,at.DM)(3188,"Close All Editor Groups"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.JO.Shift|at.KO.KeyW)},category:vt.s.View})}get excludeSticky(){return!1}async doCloseAll(e){await super.doCloseAll(e);for(let t of this.groupsToClose(e))e.removeGroup(t)}}),(0,at.Db)(Ps),(0,at.Db)(Qs),(0,at.Db)(Xs),(0,at.Db)(Bs),(0,at.Db)(Ms),(0,at.Db)(class extends Ds{constructor(){super({id:"workbench.action.splitEditorOrthogonal",title:(0,at.DM)(3164,"Split Editor Orthogonal"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.Backslash)},category:vt.s.View})}getDirection(e){return(0,bt.tt)(e)===bt.K.RIGHT?bt.K.DOWN:bt.K.RIGHT}}),(0,at.Db)(class extends Vs{constructor(){super({id:os,title:(0,at.DM)(3165,"Split Editor Left"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.Backslash)},category:vt.s.View},os)}}),(0,at.Db)(class extends Vs{constructor(){super({id:ss,title:(0,at.DM)(3166,"Split Editor Right"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.Backslash)},category:vt.s.View},ss)}}),(0,at.Db)(Ts),(0,at.Db)(Rs),(0,at.Db)(Os),(0,at.Db)(Ws),(0,at.Db)(Ls),(0,at.Db)($s),(0,at.Db)(er),(0,at.Db)(tr),(0,at.Db)(ir),(0,at.Db)(zs),(0,at.Db)(qs),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.moveEditorLeftInGroup",title:(0,at.DM)(3245,"Move Editor Left"),keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.PageUp,mac:{primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.JO.Shift|at.KO.LeftArrow)}},f1:!0,category:vt.s.View},Bo,{to:"left"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.moveEditorRightInGroup",title:(0,at.DM)(3246,"Move Editor Right"),keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.PageDown,mac:{primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.JO.Shift|at.KO.RightArrow)}},f1:!0,category:vt.s.View},Bo,{to:"right"})}}),(0,at.Db)(class extends Us{constructor(){super({id:"workbench.action.moveActiveEditorGroupLeft",title:(0,at.DM)(3191,"Move Editor Group Left"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.LeftArrow)},category:vt.s.View},bt.K.LEFT)}}),(0,at.Db)(class extends Us{constructor(){super({id:"workbench.action.moveActiveEditorGroupRight",title:(0,at.DM)(3192,"Move Editor Group Right"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.RightArrow)},category:vt.s.View},bt.K.RIGHT)}}),(0,at.Db)(class extends Us{constructor(){super({id:"workbench.action.moveActiveEditorGroupUp",title:(0,at.DM)(3193,"Move Editor Group Up"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.UpArrow)},category:vt.s.View},bt.K.UP)}}),(0,at.Db)(class extends Us{constructor(){super({id:"workbench.action.moveActiveEditorGroupDown",title:(0,at.DM)(3194,"Move Editor Group Down"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.DownArrow)},category:vt.s.View},bt.K.DOWN)}}),(0,at.Db)(class extends js{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupLeft",title:(0,at.DM)(3195,"Duplicate Editor Group Left"),f1:!0,category:vt.s.View},bt.K.LEFT)}}),(0,at.Db)(class extends js{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupRight",title:(0,at.DM)(3196,"Duplicate Editor Group Right"),f1:!0,category:vt.s.View},bt.K.RIGHT)}}),(0,at.Db)(class extends js{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupUp",title:(0,at.DM)(3197,"Duplicate Editor Group Up"),f1:!0,category:vt.s.View},bt.K.UP)}}),(0,at.Db)(class extends js{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupDown",title:(0,at.DM)(3198,"Duplicate Editor Group Down"),f1:!0,category:vt.s.View},bt.K.DOWN)}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.moveEditorToPreviousGroup",title:(0,at.DM)(3247,"Move Editor into Previous Group"),keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.LeftArrow,mac:{primary:at.JO.CtrlCmd|at.JO.WinCtrl|at.KO.LeftArrow}},f1:!0,category:vt.s.View},Bo,{to:"previous",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.moveEditorToNextGroup",title:(0,at.DM)(3248,"Move Editor into Next Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.RightArrow,mac:{primary:at.JO.CtrlCmd|at.JO.WinCtrl|at.KO.RightArrow}},category:vt.s.View},Bo,{to:"next",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.moveEditorToFirstGroup",title:(0,at.DM)(3253,"Move Editor into First Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift|at.JO.Alt|at.KO.Digit1,mac:{primary:at.JO.CtrlCmd|at.JO.WinCtrl|at.KO.Digit1}},category:vt.s.View},Bo,{to:"first",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.moveEditorToLastGroup",title:(0,at.DM)(3254,"Move Editor into Last Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.Shift|at.JO.Alt|at.KO.Digit9,mac:{primary:at.JO.CtrlCmd|at.JO.WinCtrl|at.KO.Digit9}},category:vt.s.View},Bo,{to:"last",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:as,title:(0,at.DM)(3251,"Move Editor into Left Group"),f1:!0,category:vt.s.View},Bo,{to:"left",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:ds,title:(0,at.DM)(3252,"Move Editor into Right Group"),f1:!0,category:vt.s.View},Bo,{to:"right",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:rs,title:(0,at.DM)(3249,"Move Editor into Group Above"),f1:!0,category:vt.s.View},Bo,{to:"up",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:ns,title:(0,at.DM)(3250,"Move Editor into Group Below"),f1:!0,category:vt.s.View},Bo,{to:"down",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.splitEditorToPreviousGroup",title:(0,at.DM)(3255,"Split Editor into Previous Group"),f1:!0,category:vt.s.View},Po,{to:"previous",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.splitEditorToNextGroup",title:(0,at.DM)(3256,"Split Editor into Next Group"),f1:!0,category:vt.s.View},Po,{to:"next",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.splitEditorToFirstGroup",title:(0,at.DM)(3261,"Split Editor into First Group"),f1:!0,category:vt.s.View},Po,{to:"first",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.splitEditorToLastGroup",title:(0,at.DM)(3262,"Split Editor into Last Group"),f1:!0,category:vt.s.View},Po,{to:"last",by:"group"})}}),(0,at.Db)(Ar),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.splitEditorToRightGroup",title:(0,at.DM)(3260,"Split Editor into Right Group"),f1:!0,category:vt.s.View},Po,{to:"right",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.splitEditorToAboveGroup",title:(0,at.DM)(3257,"Split Editor into Group Above"),f1:!0,category:vt.s.View},Po,{to:"up",by:"group"})}}),(0,at.Db)(class extends Vs{constructor(){super({id:"workbench.action.splitEditorToBelowGroup",title:(0,at.DM)(3258,"Split Editor into Group Below"),f1:!0,category:vt.s.View},Po,{to:"down",by:"group"})}}),(0,at.Db)(Js),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusFirstEditorGroup",title:(0,at.DM)(3173,"Focus First Editor Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.KO.Digit1},category:vt.s.View},{location:bt.q.FIRST})}}),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusLastEditorGroup",title:(0,at.DM)(3174,"Focus Last Editor Group"),f1:!0,category:vt.s.View},{location:bt.q.LAST})}}),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusPreviousGroup",title:(0,at.DM)(3176,"Focus Previous Editor Group"),f1:!0,category:vt.s.View},{location:bt.q.PREVIOUS})}}),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusNextGroup",title:(0,at.DM)(3175,"Focus Next Editor Group"),f1:!0,category:vt.s.View},{location:bt.q.NEXT})}}),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusLeftGroup",title:(0,at.DM)(3177,"Focus Left Editor Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.LeftArrow)},category:vt.s.View},{direction:bt.K.LEFT})}}),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusRightGroup",title:(0,at.DM)(3178,"Focus Right Editor Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.RightArrow)},category:vt.s.View},{direction:bt.K.RIGHT})}}),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusAboveGroup",title:(0,at.DM)(3179,"Focus Editor Group Above"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.UpArrow)},category:vt.s.View},{direction:bt.K.UP})}}),(0,at.Db)(class extends Gs{constructor(){super({id:"workbench.action.focusBelowGroup",title:(0,at.DM)(3180,"Focus Editor Group Below"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.KO.DownArrow)},category:vt.s.View},{direction:bt.K.DOWN})}}),(0,at.Db)(class extends Jr{constructor(){super({id:"workbench.action.newGroupLeft",title:(0,at.DM)(3271,"New Editor Group to the Left"),f1:!0,category:vt.s.View},bt.K.LEFT)}}),(0,at.Db)(class extends Jr{constructor(){super({id:"workbench.action.newGroupRight",title:(0,at.DM)(3272,"New Editor Group to the Right"),f1:!0,category:vt.s.View},bt.K.RIGHT)}}),(0,at.Db)(class extends Jr{constructor(){super({id:"workbench.action.newGroupAbove",title:(0,at.DM)(3273,"New Editor Group Above"),f1:!0,category:vt.s.View},bt.K.UP)}}),(0,at.Db)(class extends Jr{constructor(){super({id:"workbench.action.newGroupBelow",title:(0,at.DM)(3274,"New Editor Group Below"),f1:!0,category:vt.s.View},bt.K.DOWN)}}),(0,at.Db)(nr),(0,at.Db)(ar),(0,at.Db)(dr),(0,at.Db)(lr),(0,at.Db)(cr),(0,at.Db)(hr),(0,at.Db)(ur),(0,at.Db)(gr),(0,at.Db)(pr),(0,at.Db)(xr),(0,at.Db)(Ir),(0,at.Db)(Vr),(0,at.Db)(Dr),(0,at.Db)(Mr),(0,at.Db)(Tr),(0,at.Db)(Rr),(0,at.Db)(Or),(0,at.Db)(Lr),(0,at.Db)(Wr),(0,at.Db)(Gr),(0,at.Db)(Nr),(0,at.Db)(class extends yr{constructor(){super({id:"workbench.action.quickOpenPreviousRecentlyUsedEditor",title:(0,at.DM)(3233,"Quick Open Previous Recently Used Editor"),f1:!0,category:vt.s.View},Co.PREFIX,void 0)}}),(0,at.Db)(class extends yr{constructor(){super({id:"workbench.action.quickOpenLeastRecentlyUsedEditor",title:(0,at.DM)(3234,"Quick Open Least Recently Used Editor"),f1:!0,category:vt.s.View},Co.PREFIX,void 0)}}),(0,at.Db)(class extends yr{constructor(){super({id:"workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup",title:(0,at.DM)(3235,"Quick Open Previous Recently Used Editor in Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.KO.Tab,mac:{primary:at.JO.WinCtrl|at.KO.Tab}},precondition:pt.rn.toNegated(),category:vt.s.View},mo.PREFIX,void 0)}}),(0,at.Db)(class extends yr{constructor(){super({id:"workbench.action.quickOpenLeastRecentlyUsedEditorInGroup",title:(0,at.DM)(3236,"Quick Open Least Recently Used Editor in Group"),f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.Tab,mac:{primary:at.JO.WinCtrl|at.JO.Shift|at.KO.Tab}},precondition:pt.rn.toNegated(),category:vt.s.View},mo.PREFIX,at.lr.LAST)}}),(0,at.Db)(fr),(0,at.Db)(class extends Kr{constructor(){super(ms,(0,rt.A)((0,rt.A)({},(0,at.DM)(3277,"Move Editor into New Window")),{},{mnemonicTitle:(0,at.EM)(3278,"&&Move Editor into New Window")}),void 0,!0)}}),(0,at.Db)(class extends Kr{constructor(){super(vs,(0,rt.A)((0,rt.A)({},(0,at.DM)(3279,"Copy Editor into New Window")),{},{mnemonicTitle:(0,at.EM)(3280,"&&Copy Editor into New Window")}),{primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.KeyO),weight:at.Ob.WorkbenchContrib},!1)}}),(0,at.Db)(class extends Zr{constructor(){super(Cs,(0,rt.A)((0,rt.A)({},(0,at.DM)(3281,"Move Editor Group into New Window")),{},{mnemonicTitle:(0,at.EM)(3282,"&&Move Editor Group into New Window")}),!0)}}),(0,at.Db)(class extends Zr{constructor(){super(ws,(0,rt.A)((0,rt.A)({},(0,at.DM)(3283,"Copy Editor Group into New Window")),{},{mnemonicTitle:(0,at.EM)(3284,"&&Copy Editor Group into New Window")}),!1)}}),(0,at.Db)(Br),(0,at.Db)(Pr);var Og="workbench.action.quickOpenNavigateNextInEditorPicker";at.kb.registerCommandAndKeybindingRule({id:Og,weight:at.Ob.WorkbenchContrib+50,handler:(0,gt.Rt)(Og,!0),when:Rg,primary:at.JO.CtrlCmd|at.KO.Tab,mac:{primary:at.JO.WinCtrl|at.KO.Tab}});var Wg="workbench.action.quickOpenNavigatePreviousInEditorPicker";function Lg(e,t,i,o,s,r){let n={command:{id:e.id,title:e.title,icon:e.icon,toggled:e.toggled,precondition:s},group:"navigation",when:t,order:i};o&&(n.alt={id:o.id,title:o.title,icon:o.icon}),at.Cb.appendMenuItem(at.xb.EditorTitle,n),r&&at.Cb.appendMenuItem(at.xb.CompactWindowEditorTitle,n)}at.kb.registerCommandAndKeybindingRule({id:Wg,weight:at.Ob.WorkbenchContrib+50,handler:(0,gt.Rt)(Wg,!1),when:Rg,primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.Tab,mac:{primary:at.JO.WinCtrl|at.JO.Shift|at.KO.Tab}}),_s(),function(){function e(e,t){!t||"object"!=typeof t||e.get(bt.W).applyLayout(t)}at.Fb.registerCommand(Fo,(t,i)=>{e(t,i)}),at.Fb.registerCommand({id:"vscode.setEditorLayout",handler:(t,i)=>e(t,i),metadata:{description:"Set the editor layout. Editor layout is represented as a tree of groups in which the first group is the root group of the layout.\n\t\t\t\t\tThe orientation of the first group is 0 (horizontal) by default unless specified otherwise. The other orientations are 1 (vertical).\n\t\t\t\t\tThe orientation of subsequent groups is the opposite of the orientation of the group that contains it.\n\t\t\t\t\tHere are some examples: A layout representing 1 row and 2 columns: { orientation: 0, groups: [{}, {}] }.\n\t\t\t\t\tA layout representing 3 rows and 1 column: { orientation: 1, groups: [{}, {}, {}] }.\n\t\t\t\t\tA layout representing 3 rows and 1 column in which the second row has 2 columns: { orientation: 1, groups: [{}, { groups: [{}, {}] }, {}] }\n\t\t\t\t\t",args:[{name:"args",schema:{type:"object",required:["groups"],properties:{orientation:{type:"number",default:0,description:"The orientation of the root group in the layout. 0 for horizontal, 1 for vertical.",enum:[0,1],enumDescriptions:[(0,at.EM)(3295,"Horizontal"),(0,at.EM)(3296,"Vertical")]},groups:{$ref:"#/definitions/editorGroupsSchema",default:[{},{}]}}}}]}}),at.Fb.registerCommand({id:"vscode.getEditorLayout",handler:e=>e.get(bt.W).getLayout(),metadata:{description:"Get Editor Layout",args:[],returns:"An editor layout object, in the same format as vscode.setEditorLayout"}})}(),function(){function e(e,t){let i=e.get(bt.kt),o=t.length>0&&t[0]instanceof at.xO?t[0]:void 0;for(let s of[i.activeEditorPane,...i.visibleEditorPanes])if(s instanceof Eo&&(!o||s.input instanceof bt.nt&&(0,at.pT)(s.input.primary.resource,o)))return s}function t(t,i,o){var s;let r=e(t,i);r&&(null===(s=r.getControl())||void 0===s||s.goToDiff(o?"next":"previous"))}let i;function o(t,s,r){var n,a,d;let l=e(t,s);if(l)switch(r){case i.Original:null===(n=l.getControl())||void 0===n||n.getOriginalEditor().focus();break;case i.Modified:null===(a=l.getControl())||void 0===a||a.getModifiedEditor().focus();break;case i.Toggle:return null!==(d=l.getControl())&&void 0!==d&&d.getModifiedEditor().hasWidgetFocus()?o(t,s,i.Original):o(t,s,i.Modified)}}function s(t,i){var o;let s=t.get(at.dv),r=null===(o=e(t,i))||void 0===o||null===(o=o.getControl())||void 0===o||null===(o=o.getModifiedEditor())||void 0===o?void 0:o.getModel();if(!r)return;let n="diffEditor.renderSideBySide",a=s.getValue(r.uri,n);s.updateValue(r.uri,n,!a)}function r(t,i){var o;let s=t.get(at.dv),r=null===(o=e(t,i))||void 0===o||null===(o=o.getControl())||void 0===o||null===(o=o.getModifiedEditor())||void 0===o?void 0:o.getModel();if(!r)return;let n="diffEditor.ignoreTrimWhitespace",a=s.getValue(r.uri,n);s.updateValue(r.uri,n,!a)}async function n(t,i){let o=t.get(bt.kt),s=e(t,i),r=null===s||void 0===s?void 0:s.group,n=null===s||void 0===s?void 0:s.input;if(!s||void 0===r||!(n instanceof bt.nt)||!n.modified.resource)return;let a=n.toUntyped({preserveViewState:r.id,preserveResource:!0});if(a){if(n.modified.isModified()&&0===o.findEditors({resource:n.modified.resource,typeId:n.modified.typeId,editorId:n.modified.editorId}).length){let e=(0,rt.A)({},a.modified);e.options||(e.options={}),e.options.pinned=!0,e.options.inactive=!0,await o.openEditor(e,r)}await o.replaceEditors([{editor:n,replacement:(0,rt.A)((0,rt.A)({},a),{},{original:a.modified,modified:a.original,options:(0,rt.A)((0,rt.A)({},a.options),{},{pinned:!0})})}],r)}}at.kb.registerCommandAndKeybindingRule({id:Do,weight:at.Ob.WorkbenchContrib,when:at.Wp.inDiffEditor,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.Shift|at.KO.KeyO),handler:async e=>{let t,i=e.get(bt.kt),o=e.get(bt.W),s=i.activeEditor,r=i.activeTextEditorControl;if((0,lt.l)(r)&&s instanceof bt.nt)return t=r.getOriginalEditor().hasTextFocus()?s.original:s.modified,o.activeGroup.openEditor(t)}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Do,title:(0,at.DM)(3022,"Open Active Diff Side")}}),at.kb.registerCommandAndKeybindingRule({id:_o,weight:at.Ob.WorkbenchContrib,when:pt.Yn,primary:at.JO.Alt|at.KO.F5,handler:function(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t(e,o,!0)}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:_o,title:(0,at.DM)(3023,"Go to Next Change")}}),at.kb.registerCommandAndKeybindingRule({id:Io,weight:at.Ob.WorkbenchContrib,when:pt.Yn,primary:at.JO.Alt|at.JO.Shift|at.KO.F5,handler:function(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t(e,o,!1)}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Io,title:(0,at.DM)(3024,"Go to Previous Change")}}),function(e){e[e.Original=0]="Original",e[e.Modified=1]="Modified",e[e.Toggle=2]="Toggle"}(i||(i={})),at.kb.registerCommandAndKeybindingRule({id:ko,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return s(e,i)}}),at.kb.registerCommandAndKeybindingRule({id:xo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return o(e,s,i.Modified)}}),at.kb.registerCommandAndKeybindingRule({id:Ao,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return o(e,s,i.Original)}}),at.kb.registerCommandAndKeybindingRule({id:Vo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return o(e,s,i.Toggle)}}),at.kb.registerCommandAndKeybindingRule({id:Mo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return r(e,i)}}),at.kb.registerCommandAndKeybindingRule({id:To,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return n(e,i)}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:ko,title:(0,at.DM)(3025,"Toggle Inline View"),category:(0,at.EM)(3026,"Compare")},when:pt.Jn}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:To,title:(0,at.DM)(3027,"Swap Left and Right Editor Side"),category:(0,at.EM)(3026,"Compare")},when:at.Mk.and(pt.Jn,pt.Yt)})}(),function(){function e(e,t,i){return e?[(0,rt.A)((0,rt.A)({},e.editorOptions),null!==t&&void 0!==t?t:Object.create(null)),e.sideBySide?-2:i]:[t,i]}at.Fb.registerCommand({id:"vscode.open",handler:(e,t)=>{e.get(at.Lb).executeCommand(fs,t)},metadata:{description:"Opens the provided resource in the editor.",args:[{name:"Uri"}]}}),at.Fb.registerCommand(fs,async function(t,i,o,s,r){let n=t.get(bt.kt),a=t.get(bt.W),d=t.get(at.ml),l=t.get(bt.A),c=t.get(at.r_),h=t.get(bt.w),u="string"==typeof i?i:at.xO.from(i,!0),[g,p]=null!==o&&void 0!==o?o:[];if(p||"number"==typeof g||(0,at.DT)(u,at.TT.untitled)){let t,[i,o]=e(r,p,g),d=at.xO.isUri(u)?u:at.xO.parse(u);t=h.isUntitledWithAssociatedResource(d)?{resource:d.with({scheme:l.defaultUriScheme}),forceUntitled:!0,options:i,label:s}:{resource:d,options:i,label:s},await n.openEditor(t,(0,ut.sa)(a,c,o))}else{if((0,at.DT)(u,at.TT.command))return;await d.open(u,{openToSide:null===r||void 0===r?void 0:r.sideBySide,editorOptions:null===r||void 0===r?void 0:r.editorOptions})}}),at.Fb.registerCommand({id:"vscode.diff",handler:(e,t,i,o)=>{e.get(at.Lb).executeCommand(Ss,t,i,o)},metadata:{description:"Opens the provided resources in the diff editor to compare their contents.",args:[{name:"left",description:"Left-hand side resource of the diff editor"},{name:"right",description:"Right-hand side resource of the diff editor"},{name:"title",description:"Human readable title for the diff editor"}]}}),at.Fb.registerCommand(Ss,async function(t,i,o,s,r,n){let a,d,l=t.get(bt.kt),c=t.get(bt.W),h=t.get(at.r_),[u,g]=null!==r&&void 0!==r?r:[],[p,b]=e(n,g,u);"string"==typeof s?a=s:s&&(a=s.label,d=s.description),await l.openEditor({original:{resource:at.xO.from(i,!0)},modified:{resource:at.xO.from(o,!0)},label:a,description:d,options:p},(0,ut.sa)(c,h,b))}),at.Fb.registerCommand("_workbench.openWith",async(e,t,i,o)=>{let s=e.get(bt.kt),r=e.get(bt.W),n=e.get(at.r_),[a,d]=null!==o&&void 0!==o?o:[];await s.openEditor({resource:at.xO.from(t,!0),options:(0,rt.A)((0,rt.A)({pinned:!0},d),{},{override:i})},(0,ut.sa)(r,n,a))}),at.Fb.registerCommand({id:"vscode.changes",handler:(e,t,i)=>{e.get(at.Lb).executeCommand("_workbench.changes",t,i)},metadata:{description:"Opens a list of resources in the changes editor to compare their contents.",args:[{name:"title",description:"Human readable title for the diff editor"},{name:"resources",description:"List of resources to open in the changes editor"}]}}),at.Fb.registerCommand("_workbench.changes",async(e,t,i)=>{let o=e.get(bt.kt),s=[];for(let[r,n,a]of i)s.push({resource:at.xO.revive(r),original:{resource:at.xO.revive(n)},modified:{resource:at.xO.revive(a)}});await o.openEditor({resources:s,label:t})}),at.Fb.registerCommand("_workbench.openMultiDiffEditor",async(e,t)=>{var i,o,s;let r=e.get(bt.kt),n=null===(i=t.resources)||void 0===i?void 0:i.map(e=>({original:{resource:at.xO.revive(e.originalUri)},modified:{resource:at.xO.revive(e.modifiedUri)}})),a=null!==(o=t.reveal)&&void 0!==o&&o.modifiedUri?at.xO.revive(t.reveal.modifiedUri):void 0,d=a&&n?n.find(e=>(0,at.pT)(e.modified.resource,a)):void 0;t.reveal&&!d&&console.error("Reveal resource not found");let l={viewState:d?{revealData:{resource:{original:d.original.resource,modified:d.modified.resource},range:null===(s=t.reveal)||void 0===s?void 0:s.range}}:void 0};await r.openEditor({multiDiffSource:t.multiDiffSourceUri?at.xO.revive(t.multiDiffSourceUri):void 0,resources:n,label:t.title,options:l})})}(),function(){let e=(e,t)=>{let i=e.get(bt.kt),o=i.activeEditorPane;if(o){let e=o.group.getEditorByIndex(t);e&&i.openEditor(e)}};at.Fb.registerCommand({id:bs,handler:e});for(let i=0;i<9;i++){let o=i,s=i+1;at.kb.registerCommandAndKeybindingRule({id:bs+s,weight:at.Ob.WorkbenchContrib,when:void 0,primary:at.JO.Alt|t(s),mac:{primary:at.JO.WinCtrl|t(s)},handler:t=>e(t,o)})}function t(e){switch(e){case 0:return at.KO.Digit0;case 1:return at.KO.Digit1;case 2:return at.KO.Digit2;case 3:return at.KO.Digit3;case 4:return at.KO.Digit4;case 5:return at.KO.Digit5;case 6:return at.KO.Digit6;case 7:return at.KO.Digit7;case 8:return at.KO.Digit8;case 9:return at.KO.Digit9}throw Error("invalid index")}}(),function(){function e(e,t){let i,o=e.get(bt.W),s=e.get(bt.kt);for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(i=!t&&!n.length&&("keyboard"===o.partOptions.preventPinnedEditorClose||"keyboardAndMouse"===o.partOptions.preventPinnedEditorClose),i){let e=o.activeGroup,t=e.activeEditor;if(t&&e.isSticky(t)){var d;let t=e.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE,{excludeSticky:!0})[0];if(t)return e.openEditor(t);let i=s.getEditors(bt.Ut.MOST_RECENTLY_ACTIVE,{excludeSticky:!0})[0];if(i)return Promise.resolve(null===(d=o.getGroup(i.groupId))||void 0===d?void 0:d.openEditor(i.editor))}}let l=(0,Et.t)(n,e.get(bt.kt),e.get(bt.W),e.get(at.wt)),c=l.preserveFocus;return Promise.all(l.groupedEditors.map(async e=>{let{group:t,editors:o}=e,s=o.filter(e=>!i||!t.isSticky(e));await t.closeEditors(s,{preserveFocus:c})}))}async function t(e,t){for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];let r=e.get(bt.kt),n=e.get(dt.B),a=e.get(at.vb),d=(0,Et.t)(o,r,e.get(bt.W),e.get(at.wt)),l=new Map;for(let{group:m,editors:v}of d.groupedEditors)for(let e of v){var c,h,u,g,p,b;let i=e.toUntyped();if(!i)return;i.options=(0,rt.A)((0,rt.A)({},null===(c=r.activeEditorPane)||void 0===c?void 0:c.options),{},{override:t});let o=await n.resolveEditor(i,m);if(!(0,bt.an)(o))return;let s=l.get(m);s||(s=[],l.set(m,s)),s.push({editor:e,replacement:o.editor,forceReplaceDirty:(null===(h=e.resource)||void 0===h?void 0:h.scheme)===at.TT.untitled,options:o.options}),a.publicLog2("workbenchEditorReopen",{scheme:null!==(u=null===(g=e.resource)||void 0===g?void 0:g.scheme)&&void 0!==u?u:"",ext:e.resource?(0,at.uT)(e.resource):"",from:null!==(p=e.editorId)&&void 0!==p?p:"",to:null!==(b=o.editor.editorId)&&void 0!==b?b:""})}for(let[m,v]of l)await m.replaceEditors(v),await m.openEditor(v[0].replacement)}at.kb.registerCommandAndKeybindingRule({id:Go,weight:at.Ob.WorkbenchContrib,when:void 0,primary:at.JO.CtrlCmd|at.KO.KeyW,win:{primary:at.JO.CtrlCmd|at.KO.F4,secondary:[at.JO.CtrlCmd|at.KO.KeyW]},handler:function(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return e(t,!1,...o)}}),at.Fb.registerCommand(No,function(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return e(t,!0,...o)}),at.kb.registerCommandAndKeybindingRule({id:Wo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.KeyW),handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,Et.t)(i,e.get(bt.kt),e.get(bt.W),e.get(at.wt));return Promise.all(s.groupedEditors.map(async e=>{let{group:t}=e;await t.closeAllEditors({excludeSticky:!0})}))}}),at.kb.registerCommandAndKeybindingRule({id:Ko,weight:at.Ob.WorkbenchContrib,when:at.Mk.and(pt.rn,pt.kn),primary:at.JO.CtrlCmd|at.KO.KeyW,win:{primary:at.JO.CtrlCmd|at.KO.F4,secondary:[at.JO.CtrlCmd|at.KO.KeyW]},handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(bt.W),r=(0,Et.t)(i,e.get(bt.kt),s,e.get(at.wt));r.groupedEditors.length&&s.removeGroup(r.groupedEditors[0].group)}}),at.kb.registerCommandAndKeybindingRule({id:Oo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.KeyU),handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,Et.t)(i,e.get(bt.kt),e.get(bt.W),e.get(at.wt));return Promise.all(s.groupedEditors.map(async e=>{let{group:t}=e;await t.closeEditors({savedOnly:!0,excludeSticky:!0},{preserveFocus:s.preserveFocus})}))}}),at.kb.registerCommandAndKeybindingRule({id:Zo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,mac:{primary:at.JO.CtrlCmd|at.JO.Alt|at.KO.KeyT},handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,Et.t)(i,e.get(bt.kt),e.get(bt.W),e.get(at.wt));return Promise.all(s.groupedEditors.map(async e=>{let{group:t,editors:i}=e,o=t.getEditors(bt.Ut.SEQUENTIAL,{excludeSticky:!0}).filter(e=>!i.includes(e));for(let s of i)s&&t.pinEditor(s);await t.closeEditors(o,{preserveFocus:s.preserveFocus})}))}}),at.kb.registerCommandAndKeybindingRule({id:Jo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,Et.t)(i,e.get(bt.kt),e.get(bt.W),e.get(at.wt));if(s.groupedEditors.length){let{group:e,editors:t}=s.groupedEditors[0];e.activeEditor&&e.pinEditor(e.activeEditor),await e.closeEditors({direction:bt.Pt.RIGHT,except:t[0],excludeSticky:!0},{preserveFocus:s.preserveFocus})}}}),at.kb.registerCommandAndKeybindingRule({id:zo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t(e,at.Or.PICK,...o)}}),at.kb.registerCommandAndKeybindingRule({id:"reopenActiveEditorWith",weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e,i){for(var o=arguments.length,s=new Array(o>2?o-2:0),r=2;r<o;r++)s[r-2]=arguments[r];return t(e,null!==i&&void 0!==i?i:at.Or.PICK,...s)}}),at.Fb.registerCommand(Lo,async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(bt.W),r=(0,Et.t)(i,e.get(bt.kt),s,e.get(at.wt));if(r.groupedEditors.length){let{group:e}=r.groupedEditors[0];await e.closeAllEditors(),0===e.count&&s.getGroup(e.id)&&s.removeGroup(e)}})}(),function(){function e(e,t){for(var i,o=arguments.length,s=new Array(o>2?o-2:0),r=2;r<o;r++)s[r-2]=arguments[r];let n=null===(i=(0,Et.t)(s,e.get(bt.kt),e.get(bt.W),e.get(at.wt)).groupedEditors[0])||void 0===i?void 0:i.group;null===n||void 0===n||n.lock(null!==t&&void 0!==t?t:!n.isLocked)}at.kb.registerCommandAndKeybindingRule({id:Yo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.KO.Enter),handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,Et.t)(i,e.get(bt.kt),e.get(bt.W),e.get(at.wt));for(let{group:r,editors:n}of s.groupedEditors)for(let e of n)r.pinEditor(e)}}),at.Fb.registerCommand({id:Qo,handler:e=>{let t=e.get(at.r_),i=!0!==t.getValue("workbench.editor.enablePreview");t.updateValue("workbench.editor.enablePreview",i)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:Xo,title:(0,at.DM)(3304,"Toggle Editor Group Lock"),category:vt.s.View,f1:!0})}async run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];e(t,void 0,...o)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:Ho,title:(0,at.DM)(3305,"Lock Editor Group"),category:vt.s.View,precondition:pt.in.toNegated(),f1:!0})}async run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];e(t,!0,...o)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:Uo,title:(0,at.DM)(3306,"Unlock Editor Group"),precondition:pt.in,category:vt.s.View,f1:!0})}async run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];e(t,!1,...o)}}),at.kb.registerCommandAndKeybindingRule({id:qo,weight:at.Ob.WorkbenchContrib,when:pt.cn.toNegated(),primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.Shift|at.KO.Enter),handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,Et.t)(i,e.get(bt.kt),e.get(bt.W),e.get(at.wt));for(let{group:r,editors:n}of s.groupedEditors)for(let e of n)r.stickEditor(e)}}),at.kb.registerCommandAndKeybindingRule({id:$o,weight:at.Ob.WorkbenchContrib,when:pt.cn,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.Shift|at.KO.Enter),handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,Et.t)(i,e.get(bt.kt),e.get(bt.W),e.get(at.wt));for(let{group:r,editors:n}of s.groupedEditors)for(let e of n)r.unstickEditor(e)}}),at.kb.registerCommandAndKeybindingRule({id:jo,weight:at.Ob.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];let r=e.get(bt.W),n=e.get(at.uc),a=null===(t=(0,Et.t)(o,e.get(bt.kt),r,e.get(at.wt)).groupedEditors[0])||void 0===t?void 0:t.group;return a&&r.activateGroup(a),n.quickAccess.show(mo.PREFIX)}})}(),function(){async function e(e,t){let i=e.get(at.rx);if(!t.groupedEditors.length)return;let{group:o,editors:s}=t.groupedEditors[0],r=s[0];r&&await o.replaceEditors([{editor:r,replacement:i.createInstance(bt.Et,void 0,void 0,r,r),forceReplaceDirty:!0}])}async function t(e){if(!e.groupedEditors.length)return;let{group:t,editors:i}=e.groupedEditors[0],o=i[0];if(!o||!(o instanceof bt.Et))return;let s,r=t.activeEditorPane;if(r instanceof Et.o&&t.activeEditor===o)for(let n of[r.getPrimaryEditorPane(),r.getSecondaryEditorPane()])if(null!==n&&void 0!==n&&n.hasFocus()){s={viewState:n.getViewState()};break}await t.replaceEditors([{editor:o,replacement:o.primary,options:s}])}(0,at.Db)(class extends at.bb{constructor(){super({id:cs,title:(0,at.DM)(3297,"Split Editor in Group"),category:vt.s.View,precondition:pt.Qt,f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,when:pt.Qt,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.JO.Shift|at.KO.Backslash)}})}run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return e(t,(0,Et.t)(o,t.get(bt.kt),t.get(bt.W),t.get(at.wt)))}}),(0,at.Db)(class extends at.bb{constructor(){super({id:hs,title:(0,at.DM)(3298,"Join Editor in Group"),category:vt.s.View,precondition:pt.Un,f1:!0,keybinding:{weight:at.Ob.WorkbenchContrib,when:pt.Un,primary:(0,at.GO)(at.JO.CtrlCmd|at.KO.KeyK,at.JO.CtrlCmd|at.JO.Shift|at.KO.Backslash)}})}run(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t((0,Et.t)(o,e.get(bt.kt),e.get(bt.W),e.get(at.wt)))}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.toggleSplitEditorInGroup",title:(0,at.DM)(3299,"Toggle Split Editor in Group"),category:vt.s.View,precondition:at.Mk.or(pt.Qt,pt.Un),f1:!0})}async run(i){for(var o=arguments.length,s=new Array(o>1?o-1:0),r=1;r<o;r++)s[r-1]=arguments[r];let n=(0,Et.t)(s,i.get(bt.kt),i.get(bt.W),i.get(at.wt));if(!n.groupedEditors.length)return;let{editors:a}=n.groupedEditors[0];a[0]instanceof bt.Et?await t(n):a[0]&&await e(i,n)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:us,title:(0,at.DM)(3300,"Toggle Layout of Split Editor in Group"),category:vt.s.View,precondition:pt.Un,f1:!0})}async run(e){let t,i=e.get(at.r_);return t="horizontal"===i.getValue(Et.o.SIDE_BY_SIDE_LAYOUT_SETTING)?"vertical":"horizontal",i.updateValue(Et.o.SIDE_BY_SIDE_LAYOUT_SETTING,t)}})}(),(0,at.Db)(class extends at.bb{constructor(){super({id:gs,title:(0,at.DM)(3301,"Focus First Side in Active Editor"),category:vt.s.View,precondition:at.Mk.or(pt.Un,pt.Jn),f1:!0})}async run(e){var t;let i=e.get(bt.kt),o=e.get(at.Lb),s=i.activeEditorPane;s instanceof Et.o?null===(t=s.getSecondaryEditorPane())||void 0===t||t.focus():s instanceof Eo&&await o.executeCommand(Ao)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:ps,title:(0,at.DM)(3302,"Focus Second Side in Active Editor"),category:vt.s.View,precondition:at.Mk.or(pt.Un,pt.Jn),f1:!0})}async run(e){var t;let i=e.get(bt.kt),o=e.get(at.Lb),s=i.activeEditorPane;s instanceof Et.o?null===(t=s.getPrimaryEditorPane())||void 0===t||t.focus():s instanceof Eo&&await o.executeCommand(xo)}}),(0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.focusOtherSideEditor",title:(0,at.DM)(3303,"Focus Other Side in Active Editor"),category:vt.s.View,precondition:at.Mk.or(pt.Un,pt.Jn),f1:!0})}async run(e){var t,i,o;let s=e.get(bt.kt),r=e.get(at.Lb),n=s.activeEditorPane;n instanceof Et.o?null!==(t=n.getPrimaryEditorPane())&&void 0!==t&&t.hasFocus()?null===(i=n.getSecondaryEditorPane())||void 0===i||i.focus():null===(o=n.getPrimaryEditorPane())||void 0===o||o.focus():n instanceof Eo&&await r.executeCommand(Vo)}}),function(){for(let i=1;i<8;i++)at.kb.registerCommandAndKeybindingRule({id:e(i),weight:at.Ob.WorkbenchContrib,when:void 0,primary:at.JO.CtrlCmd|t(i),handler:e=>{let t=e.get(bt.W),o=e.get(at.r_);if(i>t.count)return;let s=t.getGroups(bt.X.GRID_APPEARANCE);if(s[i])return s[i].focus();let r=(0,bt.tt)(o),n=t.findGroup({location:bt.q.LAST});n&&t.addGroup(n,r).focus()}});function e(e){switch(e){case 1:return"workbench.action.focusSecondEditorGroup";case 2:return"workbench.action.focusThirdEditorGroup";case 3:return"workbench.action.focusFourthEditorGroup";case 4:return"workbench.action.focusFifthEditorGroup";case 5:return"workbench.action.focusSixthEditorGroup";case 6:return"workbench.action.focusSeventhEditorGroup";case 7:return"workbench.action.focusEighthEditorGroup"}throw Error("Invalid index")}function t(e){switch(e){case 1:return at.KO.Digit2;case 2:return at.KO.Digit3;case 3:return at.KO.Digit4;case 4:return at.KO.Digit5;case 5:return at.KO.Digit6;case 6:return at.KO.Digit7;case 7:return at.KO.Digit8}throw Error("Invalid index")}}(),[{id:ts,direction:bt.K.UP},{id:is,direction:bt.K.DOWN},{id:os,direction:bt.K.LEFT},{id:ss,direction:bt.K.RIGHT}].forEach(e=>{let{id:t,direction:i}=e;at.Fb.registerCommand(t,function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),s=1;s<t;s++)o[s-1]=arguments[s];let r=(0,Et.t)(o,e.get(bt.kt),e.get(bt.W),e.get(at.wt));Is(e.get(bt.W),i,r)})}),function(){let e=[{id:"workbench.action.focusLeftGroupWithoutWrap",direction:bt.K.LEFT},{id:"workbench.action.focusRightGroupWithoutWrap",direction:bt.K.RIGHT},{id:"workbench.action.focusAboveGroupWithoutWrap",direction:bt.K.UP},{id:"workbench.action.focusBelowGroupWithoutWrap",direction:bt.K.DOWN}];for(let t of e)at.Fb.registerCommand(t.id,async e=>{var i;let o=e.get(bt.W);(null!==(i=o.findGroup({direction:t.direction},o.activeGroup,!1))&&void 0!==i?i:o.activeGroup).focus()})}(),at.pM&&(at.Cb.appendMenuItem(at.xb.TouchBarContext,{command:{id:rr.ID,title:rr.LABEL,icon:{dark:at.CT.asFileUri("vs/workbench/browser/parts/editor/media/back-tb.png")}},group:"navigation",order:0}),at.Cb.appendMenuItem(at.xb.TouchBarContext,{command:{id:sr.ID,title:sr.LABEL,icon:{dark:at.CT.asFileUri("vs/workbench/browser/parts/editor/media/forward-tb.png")}},group:"navigation",order:1})),at.Cb.appendMenuItem(at.xb.EmptyEditorGroup,{command:{id:Ho,title:(0,at.EM)(3036,"Lock Group"),icon:at.fO.unlock},group:"navigation",order:10,when:at.Mk.and(pt.Sn,pt.in.toNegated())}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroup,{command:{id:Uo,title:(0,at.EM)(3037,"Unlock Group"),icon:at.fO.lock,toggled:at.Mk.true()},group:"navigation",order:10,when:pt.in}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroup,{command:{id:Ko,title:(0,at.EM)(3038,"Close Group"),icon:at.fO.close},group:"navigation",order:20,when:at.Mk.or(pt.Sn,pt._n)}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroupContext,{command:{id:ts,title:(0,at.EM)(3039,"Split Up")},group:"2_split",order:10}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroupContext,{command:{id:is,title:(0,at.EM)(3040,"Split Down")},group:"2_split",order:20}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroupContext,{command:{id:os,title:(0,at.EM)(3041,"Split Left")},group:"2_split",order:30}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroupContext,{command:{id:ss,title:(0,at.EM)(3042,"Split Right")},group:"2_split",order:40}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroupContext,{command:{id:ys,title:(0,at.EM)(3043,"New Window")},group:"3_window",order:10}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroupContext,{command:{id:Xo,title:(0,at.EM)(3044,"Lock Group"),toggled:pt.in},group:"4_lock",order:10,when:pt.Sn.toNegated()}),at.Cb.appendMenuItem(at.xb.EmptyEditorGroupContext,{command:{id:Ko,title:(0,at.EM)(3045,"Close")},group:"5_close",order:10,when:pt.kn}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{command:{id:ts,title:(0,at.EM)(3039,"Split Up")},group:"2_split",order:10}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{command:{id:is,title:(0,at.EM)(3040,"Split Down")},group:"2_split",order:20}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{command:{id:os,title:(0,at.EM)(3041,"Split Left")},group:"2_split",order:30}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{command:{id:ss,title:(0,at.EM)(3042,"Split Right")},group:"2_split",order:40}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{command:{id:Cs,title:(0,at.EM)(3046,"Move into New Window")},group:"3_window",order:10}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{command:{id:ws,title:(0,at.EM)(3047,"Copy into New Window")},group:"3_window",order:20}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{submenu:at.xb.EditorTabsBarShowTabsSubmenu,title:(0,at.EM)(3048,"Tab Bar"),group:"4_config",order:10,when:pt.xn.negate()}),at.Cb.appendMenuItem(at.xb.EditorTabsBarShowTabsSubmenu,{command:{id:gt.q.ID,title:(0,at.EM)(3049,"Multiple Tabs"),toggled:at.Mk.equals("config.workbench.editor.showTabs","multiple")},group:"1_config",order:10}),at.Cb.appendMenuItem(at.xb.EditorTabsBarShowTabsSubmenu,{command:{id:gt.J.ID,title:(0,at.EM)(3050,"Single Tab"),toggled:at.Mk.equals("config.workbench.editor.showTabs","single")},group:"1_config",order:20}),at.Cb.appendMenuItem(at.xb.EditorTabsBarShowTabsSubmenu,{command:{id:gt.K.ID,title:(0,at.EM)(3051,"Hidden"),toggled:at.Mk.equals("config.workbench.editor.showTabs","none")},group:"1_config",order:30}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{submenu:at.xb.EditorTabsBarShowTabsZenModeSubmenu,title:(0,at.EM)(3048,"Tab Bar"),group:"4_config",order:10,when:pt.xn}),at.Cb.appendMenuItem(at.xb.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:gt.$.ID,title:(0,at.EM)(3049,"Multiple Tabs"),toggled:at.Mk.equals("config.zenMode.showTabs","multiple")},group:"1_config",order:10}),at.Cb.appendMenuItem(at.xb.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:gt.et.ID,title:(0,at.EM)(3050,"Single Tab"),toggled:at.Mk.equals("config.zenMode.showTabs","single")},group:"1_config",order:20}),at.Cb.appendMenuItem(at.xb.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:gt.Q.ID,title:(0,at.EM)(3051,"Hidden"),toggled:at.Mk.equals("config.zenMode.showTabs","none")},group:"1_config",order:30}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{submenu:at.xb.EditorActionsPositionSubmenu,title:(0,at.EM)(3052,"Editor Actions Position"),group:"4_config",order:20}),at.Cb.appendMenuItem(at.xb.EditorActionsPositionSubmenu,{command:{id:gt.U.ID,title:(0,at.EM)(3048,"Tab Bar"),toggled:at.Mk.equals("config.workbench.editor.editorActionsLocation","default")},group:"1_config",order:10,when:at.Mk.equals("config.workbench.editor.showTabs","none").negate()}),at.Cb.appendMenuItem(at.xb.EditorActionsPositionSubmenu,{command:{id:gt.W.ID,title:(0,at.EM)(3053,"Title Bar"),toggled:at.Mk.or(at.Mk.equals("config.workbench.editor.editorActionsLocation","titleBar"),at.Mk.and(at.Mk.equals("config.workbench.editor.showTabs","none"),at.Mk.equals("config.workbench.editor.editorActionsLocation","default")))},group:"1_config",order:20}),at.Cb.appendMenuItem(at.xb.EditorActionsPositionSubmenu,{command:{id:gt.G.ID,title:(0,at.EM)(3054,"Hidden"),toggled:at.Mk.equals("config.workbench.editor.editorActionsLocation","hidden")},group:"1_config",order:30}),at.Cb.appendMenuItem(at.xb.EditorTabsBarContext,{command:{id:gt.H.ID,title:(0,at.EM)(3055,"Configure Tabs")},group:"9_configure",order:10}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:Go,title:(0,at.EM)(3045,"Close")},group:"1_close",order:10}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:Zo,title:(0,at.EM)(3056,"Close Others"),precondition:pt.hn.notEqualsTo("1")},group:"1_close",order:20}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:Jo,title:(0,at.EM)(3057,"Close to the Right"),precondition:at.Mk.and(pt.an.toNegated(),pt.An.negate())},group:"1_close",order:30,when:pt.vn}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:Oo,title:(0,at.EM)(3058,"Close Saved")},group:"1_close",order:40}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:Wo,title:(0,at.EM)(3059,"Close All")},group:"1_close",order:50}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:zo,title:(0,at.EM)(3060,"Reopen Editor With...")},group:"1_open",order:10,when:pt.Xt}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:Yo,title:(0,at.EM)(3061,"Keep Open"),precondition:pt.on.toNegated()},group:"3_preview",order:10,when:at.Mk.has("config.workbench.editor.enablePreview")}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:qo,title:(0,at.EM)(3062,"Pin")},group:"3_preview",order:20,when:pt.cn.toNegated()}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:$o,title:(0,at.EM)(3063,"Unpin")},group:"3_preview",order:20,when:pt.cn}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:es,title:(0,at.EM)(3042,"Split Right")},group:"5_split",order:10,when:pt.Gn.negate()}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:es,title:(0,at.EM)(3040,"Split Down")},group:"5_split",order:10,when:pt.Gn}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{submenu:at.xb.EditorSplitMoveSubmenu,title:(0,at.EM)(3064,"Split & Move"),group:"5_split",order:15}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:ms,title:(0,at.EM)(3065,"Move into New Window")},group:"7_new_window",order:10}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{command:{id:vs,title:(0,at.EM)(3066,"Copy into New Window")},group:"7_new_window",order:20}),at.Cb.appendMenuItem(at.xb.EditorTitleContext,{submenu:at.xb.EditorTitleContextShare,title:(0,at.EM)(3067,"Share"),group:"11_share",order:-1,when:pt.An.negate()}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:ts,title:(0,at.EM)(3039,"Split Up")},group:"1_split",order:10}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:is,title:(0,at.EM)(3040,"Split Down")},group:"1_split",order:20}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:os,title:(0,at.EM)(3041,"Split Left")},group:"1_split",order:30}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:ss,title:(0,at.EM)(3042,"Split Right")},group:"1_split",order:40}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:rs,title:(0,at.EM)(3068,"Move Above")},group:"2_move",order:10}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:ns,title:(0,at.EM)(3069,"Move Below")},group:"2_move",order:20}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:as,title:(0,at.EM)(3070,"Move Left")},group:"2_move",order:30}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:ds,title:(0,at.EM)(3071,"Move Right")},group:"2_move",order:40}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:cs,title:(0,at.EM)(3072,"Split in Group"),precondition:pt.An.negate()},group:"3_split_in_group",order:10,when:pt.Qt}),at.Cb.appendMenuItem(at.xb.EditorSplitMoveSubmenu,{command:{id:hs,title:(0,at.EM)(3073,"Join in Group"),precondition:pt.An.negate()},group:"3_split_in_group",order:10,when:pt.Un}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:ko,title:(0,at.EM)(3074,"Inline View"),toggled:at.Mk.equals("config.diffEditor.renderSideBySide",!1)},group:"1_diff",order:10,when:at.Mk.has("isInDiffEditor")}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:jo,title:(0,at.EM)(3075,"Show Opened Editors")},group:"3_open",order:10}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:Wo,title:(0,at.EM)(3059,"Close All")},group:"5_close",order:10}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:Oo,title:(0,at.EM)(3058,"Close Saved")},group:"5_close",order:20}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:Qo,title:(0,at.EM)(3076,"Enable Preview Editors"),toggled:at.Mk.has("config.workbench.editor.enablePreview")},group:"7_settings",order:10}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:ls,title:(0,at.EM)(3077,"Maximize Group")},group:"8_group_operations",order:5,when:at.Mk.and(pt.gn.negate(),pt._n)}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:ls,title:(0,at.EM)(3078,"Unmaximize Group")},group:"8_group_operations",order:5,when:pt.gn}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:Xo,title:(0,at.EM)(3079,"Lock Group"),toggled:pt.in},group:"8_group_operations",order:10,when:pt.Sn.toNegated()}),at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:gt.V.ID,title:(0,at.EM)(3080,"Configure Editors")},group:"9_configure",order:10});var Jg=1e5,Gg=1e6;Lg({id:es,title:(0,at.EM)(3081,"Split Editor Right"),icon:at.fO.splitHorizontal},pt.Gn.negate(),Jg,{id:is,title:(0,at.EM)(3082,"Split Editor Down"),icon:at.fO.splitVertical}),Lg({id:es,title:(0,at.EM)(3082,"Split Editor Down"),icon:at.fO.splitVertical},pt.Gn,Jg,{id:ss,title:(0,at.EM)(3081,"Split Editor Right"),icon:at.fO.splitHorizontal}),Lg({id:us,title:(0,at.EM)(3083,"Toggle Layout"),icon:at.fO.editorLayout},pt.Un,99999),Lg({id:Go,title:(0,at.EM)(3045,"Close"),icon:at.fO.close},at.Mk.and(pt.vn.toNegated(),pt.tn.toNegated(),pt.cn.toNegated()),Gg,{id:Wo,title:(0,at.EM)(3059,"Close All"),icon:at.fO.closeAll}),Lg({id:Go,title:(0,at.EM)(3045,"Close"),icon:at.fO.closeDirty},at.Mk.and(pt.vn.toNegated(),pt.tn,pt.cn.toNegated()),Gg,{id:Wo,title:(0,at.EM)(3059,"Close All"),icon:at.fO.closeAll}),Lg({id:$o,title:(0,at.EM)(3063,"Unpin"),icon:at.fO.pinned},at.Mk.and(pt.vn.toNegated(),pt.tn.toNegated(),pt.cn),Gg,{id:Go,title:(0,at.EM)(3045,"Close"),icon:at.fO.close}),Lg({id:$o,title:(0,at.EM)(3063,"Unpin"),icon:at.fO.pinnedDirty},at.Mk.and(pt.vn.toNegated(),pt.tn,pt.cn),Gg,{id:Go,title:(0,at.EM)(3045,"Close"),icon:at.fO.close}),Lg({id:Ho,title:(0,at.EM)(3084,"Lock Group"),icon:at.fO.unlock},at.Mk.and(pt.Sn,pt.in.toNegated()),999999),Lg({id:Uo,title:(0,at.EM)(3085,"Unlock Group"),icon:at.fO.lock,toggled:at.Mk.true()},pt.in,999999);var Ng=(0,at.K)("diff-editor-previous-change",at.fO.arrowUp,(0,at.EM)(3086,"Icon for the previous change action in the diff editor."));Lg({id:Io,title:(0,at.EM)(3087,"Previous Change"),icon:Ng},pt.Jn,10,void 0,at.Wp.hasChanges,!0);var Kg=(0,at.K)("diff-editor-next-change",at.fO.arrowDown,(0,at.EM)(3088,"Icon for the next change action in the diff editor."));Lg({id:_o,title:(0,at.EM)(3089,"Next Change"),icon:Kg},pt.Jn,11,void 0,at.Wp.hasChanges,!0),Lg({id:To,title:(0,at.EM)(3090,"Swap Left and Right Side"),icon:at.fO.arrowSwap},at.Mk.and(pt.Jn,pt.Yt),15,void 0,void 0);var Zg=(0,at.K)("diff-editor-toggle-whitespace",at.fO.whitespace,(0,at.EM)(3091,"Icon for the toggle whitespace action in the diff editor."));at.Cb.appendMenuItem(at.xb.EditorTitle,{command:{id:Mo,title:(0,at.EM)(3092,"Show Leading/Trailing Whitespace Differences"),icon:Zg,precondition:pt.Jn,toggled:at.Mk.equals("config.diffEditor.ignoreTrimWhitespace",!1)},group:"navigation",when:pt.Jn,order:20}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Yo,title:(0,at.DM)(3093,"Keep Editor"),category:vt.s.View},when:at.Mk.has("config.workbench.editor.enablePreview")}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:qo,title:(0,at.DM)(3094,"Pin Editor"),category:vt.s.View}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:$o,title:(0,at.DM)(3095,"Unpin Editor"),category:vt.s.View}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Go,title:(0,at.DM)(3096,"Close Editor"),category:vt.s.View}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:No,title:(0,at.DM)(3097,"Close Pinned Editor"),category:vt.s.View}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Wo,title:(0,at.DM)(3098,"Close All Editors in Group"),category:vt.s.View}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Oo,title:(0,at.DM)(3099,"Close Saved Editors in Group"),category:vt.s.View}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Zo,title:(0,at.DM)(3100,"Close Other Editors in Group"),category:vt.s.View}}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Jo,title:(0,at.DM)(3101,"Close Editors to the Right in Group"),category:vt.s.View},when:pt.an.toNegated()}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:Lo,title:(0,at.DM)(3102,"Close Editor Group"),category:vt.s.View},when:pt.kn}),at.Cb.appendMenuItem(at.xb.CommandPalette,{command:{id:zo,title:(0,at.DM)(3060,"Reopen Editor With..."),category:vt.s.View},when:pt.Xt}),at.Cb.appendMenuItem(at.xb.MenubarRecentMenu,{group:"1_editor",command:{id:br.ID,title:(0,at.EM)(3103,"&&Reopen Closed Editor"),precondition:at.Mk.has("canReopenClosedEditor")},order:1}),at.Cb.appendMenuItem(at.xb.MenubarRecentMenu,{group:"z_clear",command:{id:mr.ID,title:(0,at.EM)(3104,"&&Clear Recently Opened...")},order:1}),at.Cb.appendMenuItem(at.xb.MenubarFileMenu,{title:(0,at.EM)(3105,"Share"),submenu:at.xb.MenubarShare,group:"45_share",order:1}),at.Cb.appendMenuItem(at.xb.MenubarViewMenu,{group:"2_appearance",title:(0,at.EM)(3106,"Editor &&Layout"),submenu:at.xb.MenubarLayoutMenu,order:2}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"1_split",command:{id:ts,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3107,"Split Up")),{},{mnemonicTitle:(0,at.EM)(3108,"Split &&Up")})},order:1}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"1_split",command:{id:is,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3109,"Split Down")),{},{mnemonicTitle:(0,at.EM)(3110,"Split &&Down")})},order:2}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"1_split",command:{id:os,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3111,"Split Left")),{},{mnemonicTitle:(0,at.EM)(3112,"Split &&Left")})},order:3}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"1_split",command:{id:ss,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3113,"Split Right")),{},{mnemonicTitle:(0,at.EM)(3114,"Split &&Right")})},order:4}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"2_split_in_group",command:{id:cs,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3115,"Split in Group")),{},{mnemonicTitle:(0,at.EM)(3116,"Split in &&Group")})},when:pt.Qt,order:1}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"2_split_in_group",command:{id:hs,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3117,"Join in Group")),{},{mnemonicTitle:(0,at.EM)(3118,"Join in &&Group")})},when:pt.Un,order:1}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"3_new_window",command:{id:ms,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3119,"Move Editor into New Window")),{},{mnemonicTitle:(0,at.EM)(3120,"&&Move Editor into New Window")})},order:1}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"3_new_window",command:{id:vs,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3121,"Copy Editor into New Window")),{},{mnemonicTitle:(0,at.EM)(3122,"&&Copy Editor into New Window")})},order:2}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Vr.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3123,"Single")),{},{mnemonicTitle:(0,at.EM)(3124,"&&Single")})},order:1}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Dr.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3125,"Two Columns")),{},{mnemonicTitle:(0,at.EM)(3126,"&&Two Columns")})},order:3}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Mr.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3127,"Three Columns")),{},{mnemonicTitle:(0,at.EM)(3128,"T&&hree Columns")})},order:4}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Tr.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3129,"Two Rows")),{},{mnemonicTitle:(0,at.EM)(3130,"T&&wo Rows")})},order:5}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Rr.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3131,"Three Rows")),{},{mnemonicTitle:(0,at.EM)(3132,"Three &&Rows")})},order:6}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Or.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3133,"Grid (2x2)")),{},{mnemonicTitle:(0,at.EM)(3134,"&&Grid (2x2)")})},order:7}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Lr.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3135,"Two Rows Right")),{},{mnemonicTitle:(0,at.EM)(3136,"Two R&&ows Right")})},order:8}),at.Cb.appendMenuItem(at.xb.MenubarLayoutMenu,{group:"4_layouts",command:{id:Wr.ID,title:(0,rt.A)((0,rt.A)({},(0,at.DM)(3137,"Two Columns Bottom")),{},{mnemonicTitle:(0,at.EM)(3138,"Two &&Columns Bottom")})},order:9}),at.Cb.appendMenuItem(at.xb.MenubarGoMenu,{group:"1_history_nav",command:{id:"workbench.action.navigateToLastEditLocation",title:(0,at.EM)(3139,"&&Last Edit Location"),precondition:at.Mk.has("canNavigateToLastEditLocation")},order:3}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"1_sideBySide",command:{id:gs,title:(0,at.EM)(3140,"&&First Side in Editor")},when:at.Mk.or(pt.Un,pt.Jn),order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"1_sideBySide",command:{id:ps,title:(0,at.EM)(3141,"&&Second Side in Editor")},when:at.Mk.or(pt.Un,pt.Jn),order:2}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"2_any",command:{id:"workbench.action.nextEditor",title:(0,at.EM)(3142,"&&Next Editor")},order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"2_any",command:{id:"workbench.action.previousEditor",title:(0,at.EM)(3143,"&&Previous Editor")},order:2}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"3_any_used",command:{id:"workbench.action.openNextRecentlyUsedEditor",title:(0,at.EM)(3144,"&&Next Used Editor")},order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"3_any_used",command:{id:"workbench.action.openPreviousRecentlyUsedEditor",title:(0,at.EM)(3145,"&&Previous Used Editor")},order:2}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"4_group",command:{id:"workbench.action.nextEditorInGroup",title:(0,at.EM)(3146,"&&Next Editor in Group")},order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"4_group",command:{id:"workbench.action.previousEditorInGroup",title:(0,at.EM)(3147,"&&Previous Editor in Group")},order:2}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"5_group_used",command:{id:"workbench.action.openNextRecentlyUsedEditorInGroup",title:(0,at.EM)(3148,"&&Next Used Editor in Group")},order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchEditorMenu,{group:"5_group_used",command:{id:"workbench.action.openPreviousRecentlyUsedEditorInGroup",title:(0,at.EM)(3149,"&&Previous Used Editor in Group")},order:2}),at.Cb.appendMenuItem(at.xb.MenubarGoMenu,{group:"2_editor_nav",title:(0,at.EM)(3150,"Switch &&Editor"),submenu:at.xb.MenubarSwitchEditorMenu,order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFirstEditorGroup",title:(0,at.EM)(3151,"Group &&1")},order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusSecondEditorGroup",title:(0,at.EM)(3152,"Group &&2")},order:2}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusThirdEditorGroup",title:(0,at.EM)(3153,"Group &&3"),precondition:pt.kn},order:3}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFourthEditorGroup",title:(0,at.EM)(3154,"Group &&4"),precondition:pt.kn},order:4}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFifthEditorGroup",title:(0,at.EM)(3155,"Group &&5"),precondition:pt.kn},order:5}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"2_next_prev",command:{id:"workbench.action.focusNextGroup",title:(0,at.EM)(3156,"&&Next Group"),precondition:pt.kn},order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"2_next_prev",command:{id:"workbench.action.focusPreviousGroup",title:(0,at.EM)(3157,"&&Previous Group"),precondition:pt.kn},order:2}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusLeftGroup",title:(0,at.EM)(3158,"Group &&Left"),precondition:pt.kn},order:1}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusRightGroup",title:(0,at.EM)(3159,"Group &&Right"),precondition:pt.kn},order:2}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusAboveGroup",title:(0,at.EM)(3160,"Group &&Above"),precondition:pt.kn},order:3}),at.Cb.appendMenuItem(at.xb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusBelowGroup",title:(0,at.EM)(3161,"Group &&Below"),precondition:pt.kn},order:4}),at.Cb.appendMenuItem(at.xb.MenubarGoMenu,{group:"2_editor_nav",title:(0,at.EM)(3162,"Switch &&Group"),submenu:at.xb.MenubarSwitchGroupMenu,order:2}),(0,at.xo)(dt.zi),(0,at.Xb)(),(0,at.SO)(),(0,pt.pr)(),(0,ut.Zi)(),(0,ut.sv)();var Bg=(Oe=class{constructor(e){this._webviewWorkbenchService=e}canSerialize(e){return this._webviewWorkbenchService.shouldPersist(e)}serialize(e){if(!this.canSerialize(e))return;let t=this.toJson(e);try{return JSON.stringify(t)}catch(i){return}}deserialize(e,t){let i=this.fromJson(JSON.parse(t));return this._webviewWorkbenchService.openRevivedWebview({webviewInitInfo:{providedViewType:i.providedId,origin:i.origin,title:i.title,options:i.webviewOptions,contentOptions:i.contentOptions,extension:i.extension},viewType:i.viewType,title:i.title,iconPath:i.iconPath,state:i.state,group:i.group})}fromJson(e){return(0,rt.A)((0,rt.A)({},e),{},{extension:Pg(e.extensionId,e.extensionLocation),iconPath:Fg(e.iconPath),state:Qg(e.state),webviewOptions:e.options,contentOptions:Xg(e.options)})}toJson(e){var t,i;return{origin:e.webview.origin,viewType:e.viewType,providedId:e.providedId,title:e.getName(),options:(0,rt.A)((0,rt.A)({},e.webview.options),e.webview.contentOptions),extensionLocation:null===(t=e.extension)||void 0===t?void 0:t.location,extensionId:null===(i=e.extension)||void 0===i?void 0:i.id.value,state:e.webview.state,iconPath:e.iconPath?{light:e.iconPath.light,dark:e.iconPath.dark}:void 0,group:e.group}}},{_:Oe.ID=ut.Xi.typeId},Oe);function Pg(e,t){if(!e)return;let i=Yg(t);return i?{id:new pt.or(e),location:i}:void 0}function Fg(e){if(!e)return;let t=Yg(e.light),i=Yg(e.dark);return t&&i?{light:t,dark:i}:void 0}function Yg(e){if(e)try{return"string"==typeof e?at.xO.parse(e):at.xO.from(e)}catch(t){return}}function Qg(e){return"string"==typeof e?e:void 0}function Xg(e){var t;return(0,rt.A)((0,rt.A)({},e),{},{localResourceRoots:null===(t=e.localResourceRoots)||void 0===t?void 0:t.map(e=>Yg(e))})}Bg=(0,at.Jb)([(0,at.Yb)(0,ut.ov)],Bg),(0,at.Xb)(),(0,at.wj)(),(0,at.ET)(),(0,at.dT)(),(0,at.SO)(),(0,at.ox)(),(0,ut.Gi)(),(0,ut.Ly)(),(0,ut.Ku)(),(0,ut.ct)(),(0,ut.lv)(),(0,ut.sv)(),(0,pt.St)(),(0,ut.gg)();var Hg=(We=class extends Bg{constructor(e,t,i){super(e),this._instantiationService=t,this._webviewService=i}serialize(e){let t=e.isDirty(),i=(0,rt.A)((0,rt.A)({},this.toJson(e)),{},{editorResource:e.resource.toJSON(),dirty:t,backupId:t?e.backupId:void 0});try{return JSON.stringify(i)}catch(o){return}}fromJson(e){return(0,rt.A)((0,rt.A)({},super.fromJson(e)),{},{editorResource:at.xO.from(e.editorResource),dirty:e.dirty})}deserialize(e,t){let i=this.fromJson(JSON.parse(t)),o=Ug(this._webviewService,i),s=this._instantiationService.createInstance(ut.Wi,{resource:i.editorResource,viewType:i.viewType},o,{startsDirty:i.dirty,backupId:i.backupId});return"number"==typeof i.group&&s.updateGroup(i.group),s}},{_:We.ID=ut.Wi.typeId},We);function Ug(e,t){let i=e.createWebviewOverlay({providedViewType:t.viewType,origin:t.origin,title:void 0,options:{purpose:ut.ot.CustomEditor,enableFindWidget:t.webviewOptions.enableFindWidget,retainContextWhenHidden:t.webviewOptions.retainContextWhenHidden},contentOptions:t.contentOptions,extension:t.extension});return i.state=t.state,i}Hg=(0,at.Jb)([(0,at.Yb)(0,ut.ov),(0,at.Yb)(1,at.rx),(0,at.Yb)(2,ut.cv)],Hg);var jg=(Le=class extends at.mj{constructor(e,t,i,o,s){super(),this._instantiationService=e,this._workingCopyBackupService=i,this._webviewService=o,this._register(t.registerHandler(this))}handles(e){return e.resource.scheme===at.TT.vscodeCustomEditor}isOpen(e,t){if(!this.handles(e))return!1;if("jupyter-notebook-ipynb"===e.resource.authority&&t instanceof ut.Gu)try{let i=JSON.parse(e.resource.query);return(0,at.pT)(at.xO.from(i),t.resource)}catch(i){return!1}if(!(t instanceof ut.Wi)||e.resource.authority!==t.viewType.replace(/[^a-z0-9\-_]/gi,"-").toLowerCase())return!1;try{let i=JSON.parse(e.resource.query);return(0,at.pT)(at.xO.from(i),t.resource)}catch(o){return!1}}async createEditor(e){var t,i;let o=await this._workingCopyBackupService.resolve(e);if(null===o||void 0===o||!o.meta)throw Error("No backup found for custom editor: ".concat(e.resource));let s=o.meta,r=Pg(null===(t=s.extension)||void 0===t?void 0:t.id,null===(i=s.extension)||void 0===i?void 0:i.location),n=Ug(this._webviewService,{viewType:s.viewType,origin:s.webview.origin,webviewOptions:s.webview.options,contentOptions:Xg(s.webview.options),state:s.webview.state,extension:r}),a=this._instantiationService.createInstance(ut.Wi,{resource:at.xO.revive(s.editorResource),viewType:s.viewType},n,{backupId:s.backupId});return a.updateGroup(0),a}},{_:Le.ID="workbench.contrib.complexCustomWorkingCopyEditorHandler"},Le);jg=(0,at.Jb)([(0,at.Yb)(0,at.rx),(0,at.Yb)(1,ut.hg),(0,at.Yb)(2,pt.xt),(0,at.Yb)(3,ut.cv),(0,at.Yb)(4,ut.Iy)],jg),(0,at.Zp)(),(0,at.Jp)(),(0,at.Mb)(),(0,gt.f)(),(0,bt.b)(),(0,bt.en)(),(0,at.ox)(),(0,ut.Yi)(),(0,ut.Gi)(),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(ut.Ji,ut.Ji.ID,"Webview Editor"),[new at.Xp(ut.Wi)]),at.jb.as(bt.Rt.EditorFactory).registerEditorSerializer(Hg.ID,Hg),(0,bt.x)(jg.ID,jg,bt.y.BlockStartup),(0,at.QO)(),(0,at.Gp)(),(0,at.TM)(),(0,at.Tb)(),(0,at.Pk)(),(0,at.Ab)(),(0,vt.c)(),(0,ut.ct)(),(0,ut.lv)(),(0,ut.Yi)(),(0,ut.Zi)(),(0,bt.At)();var zg=at.Mk.and(at.Mk.equals("activeEditor",ut.Ji.ID),at.Wp.focus.toNegated()),qg=(Je=class e extends at.bb{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:at.Mk.and(zg,ut.rt),primary:at.JO.CtrlCmd|at.KO.KeyF,weight:at.Ob.EditorContrib}})}run(e){var t;null===(t=op(e))||void 0===t||t.showFind()}},{_:Je.ID="editor.action.webvieweditor.showFind"},{_:Je.LABEL=(0,at.EM)(12515,"Show find")},Je),$g=(Ge=class e extends at.bb{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:at.Mk.and(zg,ut.at),primary:at.KO.Escape,weight:at.Ob.EditorContrib}})}run(e){var t;null===(t=op(e))||void 0===t||t.hideFind()}},{_:Ge.ID="editor.action.webvieweditor.hideFind"},{_:Ge.LABEL=(0,at.EM)(12516,"Stop find")},Ge),ep=(Ne=class e extends at.bb{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:at.Mk.and(zg,ut.it),primary:at.KO.Enter,weight:at.Ob.EditorContrib}})}run(e){var t;null===(t=op(e))||void 0===t||t.runFindAction(!1)}},{_:Ne.ID="editor.action.webvieweditor.findNext"},{_:Ne.LABEL=(0,at.EM)(12517,"Find next")},Ne),tp=(Ke=class e extends at.bb{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:at.Mk.and(zg,ut.it),primary:at.JO.Shift|at.KO.Enter,weight:at.Ob.EditorContrib}})}run(e){var t;null===(t=op(e))||void 0===t||t.runFindAction(!0)}},{_:Ke.ID="editor.action.webvieweditor.findPrevious"},{_:Ke.LABEL=(0,at.EM)(12518,"Find previous")},Ke),ip=(Ze=class e extends at.bb{constructor(){super({id:e.ID,title:e.LABEL,category:vt.s.Developer,menu:[{id:at.xb.CommandPalette}]})}async run(e){let t=e.get(ut.cv);for(let i of t.webviews)i.reload()}},{_:Ze.ID="workbench.action.webview.reloadWebviewAction"},{_:Ze.LABEL=(0,at.DM)(12519,"Reload Webviews")},Ze);function op(e){let t=e.get(bt.kt).activeEditor;return t instanceof ut.Xi?t.webview:void 0}(0,at.Xb)(),(0,at.wj)(),(0,at.TM)(),(0,at.Tb)(),(0,at.Zp)(),(0,at.Jp)(),(0,at.Mb)(),(0,gt.f)(),(0,bt.b)(),(0,bt.en)(),(0,bt.G)(),(0,ut.Yi)(),(0,ut.Zi)(),(0,ut.qi)(),(0,at.ox)(),(0,bt.At)(),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(ut.Ji,ut.Ji.ID,(0,at.EM)(12521,"webview editor")),[new at.Xp(ut.Xi)]);var sp=(Be=class extends at.mj{constructor(e,t){super(),this.editorGroupService=t,this._register(e.onWillOpenEditor(e=>{let i=t.getGroup(e.groupId);i&&this.onEditorOpening(e.editor,i)}))}onEditorOpening(e,t){if(!(e instanceof ut.Xi)||e.typeId!==ut.Xi.typeId||t.contains(e))return;let i,o=this.editorGroupService.groups;for(let s of o)if(s.contains(e)){i=s;break}i&&i.closeEditor(e)}},{_:Be.ID="workbench.contrib.webviewPanel"},Be);sp=(0,at.Jb)([(0,at.Yb)(0,bt.kt),(0,at.Yb)(1,bt.W)],sp),(0,bt.x)(sp.ID,sp,bt.y.BlockStartup),at.jb.as(bt.Rt.EditorFactory).registerEditorSerializer(Bg.ID,Bg),(0,at.Db)(qg),(0,at.Db)($g),(0,at.Db)(ep),(0,at.Db)(tp),(0,at.Db)(ip),(0,at.Xb)(),(0,at.jj)(),(0,at.wj)(),(0,at.fj)(),(0,at.iM)(),(0,at.SO)(),(0,at.eO)(),(0,at.TM)(),(0,at.i_)(),(0,at.gb)(),(0,at.hl)(),(0,at.dc)(),(0,ut.ft)(),(0,gt.Tt)(),(0,Ct.i)();var rp=class extends at.mj{constructor(e,t,i,o,s){super(),this.configurationService=t,this.logService=i,this.preferencesService=o,this.quickInputService=s,this._providers=new at.dj,this._register(e.registerExternalOpener(this))}registerExternalOpenerProvider(e){return{dispose:this._providers.push(e)}}async getOpeners(e,t,i,o){let s=await this.getAllOpenersForUri(e);if(0===s.size)return[];if(i.preferredOpenerId){if("default"===i.preferredOpenerId)return[];let e=s.get(i.preferredOpenerId);if(e)return[e]}let r=this.getConfiguredOpenerForUri(s,e);if(r)return"default"===r?[]:[r];let n=[];if(await Promise.all(Array.from(s.values()).map(async e=>{let t;try{t=await e.canOpen(i.sourceUri,o)}catch(e){return void this.logService.error(e)}switch(t){case at.MD.Option:case at.MD.Default:case at.MD.Preferred:n.push({opener:e,priority:t})}})),0===n.length)return[];let a=n.filter(e=>e.priority===at.MD.Preferred).at(0);return a?[a.opener]:!t&&n.every(e=>e.priority===at.MD.Option)?[]:n.map(e=>e.opener)}async openExternal(e,t,i){let o="string"==typeof e?at.xO.parse(e):e,s=await this.getOpeners(o,!1,t,i);return 0!==s.length&&(1===s.length?s[0].openExternalUri(o,t,i):this.showOpenerPrompt(s,o,t,i))}async getOpener(e,t,i){let o=await this.getOpeners(e,!0,t,i);if(o.length>=1)return o[0]}async getAllOpenersForUri(e){let t=new Map;return await Promise.all(at.Aj.map(this._providers,async i=>{var o,s=!1,r=!1;try{for(var n,a=(0,nt.A)(i.getOpeners(e));s=!(n=await a.next()).done;s=!1){let e=n.value;t.set(e.id,e)}}catch(d){r=!0,o=d}finally{try{s&&null!=a.return&&await a.return()}finally{if(r)throw o}}})),t}getConfiguredOpenerForUri(e,t){let i=this.configurationService.getValue("workbench.externalUriOpeners")||{};for(let[o,s]of Object.entries(i))if((0,gt.Et)(t,o)){if("default"===s)return"default";let t=e.get(s);if(t)return t}}async showOpenerPrompt(e,t,i,o){let s=e.map(e=>({label:e.label,opener:e}));s.push({label:at._M?(0,at.EM)(7385,"Open in new browser window"):(0,at.EM)(7386,"Open in default browser"),opener:void 0},{type:"separator"},{label:(0,at.EM)(7387,"Configure default opener..."),opener:"configureDefault"});let r=await this.quickInputService.pick(s,{placeHolder:(0,at.EM)(7388,"How would you like to open: {0}",t.toString())});return!r||void 0!==r.opener&&("configureDefault"===r.opener?(await this.preferencesService.openUserSettings({jsonEditor:!0,revealSetting:{key:ut.dt,edit:!0}}),!0):r.opener.openExternalUri(t,i,o))}};rp=(0,at.Jb)([(0,at.Yb)(0,at.ml),(0,at.Yb)(1,at.r_),(0,at.Yb)(2,at.mb),(0,at.Yb)(3,Ct.r),(0,at.Yb)(4,at.uc)],rp),(0,at.A_)(),(0,at.Jp)(),(0,at.Mb)(),(0,ut.ft)(),(0,at.ox)(),at.jb.as(at.b_.Configuration).registerConfiguration(ut.ut);var np;(0,at.vE)(),(0,at.Xb)(),(0,at.oS)(),(0,at.Oc)(),(0,at.wj)(),(0,at.Wd)(),(0,lt.o)(),(0,at.TM)(),(0,at.Vb)(),(0,bt.At)(),(0,mt.n)(),(0,ut.kb)(),(0,ut.Tb)(),(0,at.ir)(),(0,ut.Af)(),(0,at.hl)(),(0,at.Vc)(),(0,at.Ur)(),(0,at.Kb)(),(0,at.pO)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.AN)(),(0,at.SO)(),(0,at.Tb)(),(0,vt.c)(),(0,bt.G)(),(0,at.er)(),(0,at.rr)(),(0,at.sj)(),(0,at.rA)(),(0,at.bE)({});var ap=class{constructor(e,t){this.combined=e,this.dedicated=t}isEqual(e){return(0,at.TN)(this.combined,e.combined)&&(0,at.TN)(this.dedicated,e.dedicated)}},dp=class{constructor(e,t){this._storageService=e,this._key=t}get value(){return this._storageService.getNumber(this._key,at.Ro.PROFILE,0)}increment(){let e=this.value+1;return this._storageService.store(this._key,e,at.Ro.PROFILE,at.zo.MACHINE),e}};dp=(0,at.Jb)([(0,at.Yb)(0,at.Io)],dp);var lp=(Pe=class extends at.mj{constructor(e){super(),this.editorGroupService=e;for(let t of e.parts)this.createLanguageStatus(t);this._register(e.onDidCreateAuxiliaryEditorPart(e=>this.createLanguageStatus(e)))}createLanguageStatus(e){let t=new at.gj;at.tj.once(e.onWillDispose)(()=>t.dispose());let i=this.editorGroupService.getScopedInstantiationService(e);t.add(i.createInstance(cp))}},{_:Pe.Id="status.languageStatus"},Pe);lp=(0,at.Jb)([(0,at.Yb)(0,bt.W)],lp);var cp=(Fe=class{constructor(e,t,i,o,s,r){this._languageStatusService=e,this._statusBarService=t,this._editorService=i,this._hoverService=o,this._openerService=s,this._storageService=r,this._disposables=new at.gj,this._dedicated=new Set,this._dedicatedEntries=new Map,this._renderDisposables=new at.gj,this._combinedEntryTooltip=(0,at.jx)("div"),r.onDidChangeValue(at.Ro.PROFILE,np._keyDedicatedItems,this._disposables)(this._handleStorageChange,this,this._disposables),this._restoreState(),this._interactionCounter=new dp(r,"languageStatus.interactCount"),e.onDidChange(this._update,this,this._disposables),i.onDidActiveEditorChange(this._update,this,this._disposables),this._update(),t.onDidChangeEntryVisibility(e=>{!e.visible&&this._dedicated.has(e.id)&&(this._dedicated.delete(e.id),this._update(),this._storeState())},void 0,this._disposables)}dispose(){var e;this._disposables.dispose(),null!==(e=this._combinedEntry)&&void 0!==e&&e.dispose(),(0,at.Sj)(this._dedicatedEntries.values()),this._renderDisposables.dispose()}_handleStorageChange(){this._restoreState(),this._update()}_restoreState(){let e=this._storageService.get(np._keyDedicatedItems,at.Ro.PROFILE,"[]");try{let t=JSON.parse(e);this._dedicated=new Set(t)}catch(t){this._dedicated.clear()}}_storeState(){if(0===this._dedicated.size)this._storageService.remove(np._keyDedicatedItems,at.Ro.PROFILE);else{let e=JSON.stringify(Array.from(this._dedicated.keys()));this._storageService.store(np._keyDedicatedItems,e,at.Ro.PROFILE,at.zo.USER)}}_createViewModel(e){if(null===e||void 0===e||!e.hasModel())return new ap([],[]);let t=this._languageStatusService.getLanguageStatus(e.getModel()),i=[],o=[];for(let s of t)this._dedicated.has(s.id)&&o.push(s),i.push(s);return new ap(i,o)}_update(){var e,t;let i=(0,lt.i)(this._editorService.activeTextEditorControl),o=this._createViewModel(i);if(null!==(e=this._model)&&void 0!==e&&e.isEqual(o))return;if(this._renderDisposables.clear(),this._model=o,null!==i&&void 0!==i&&i.onDidChangeModelLanguage(this._update,this,this._renderDisposables),0===o.combined.length)null!==(t=this._combinedEntry)&&void 0!==t&&t.dispose(),this._combinedEntry=void 0;else{let[e]=o.combined,t=e.severity>=at.Ud.Warning,s=np._severityToComboCodicon(e.severity),r=!1,n=[];for(let i of o.combined){let e=o.dedicated.includes(i);this._renderStatus(this._combinedEntryTooltip,i,t,e,this._renderDisposables),n.push(np._accessibilityInformation(i).label),r||(r=!e&&i.busy)}let a={name:(0,at.EM)(8007,"Editor Language Status"),ariaLabel:(0,at.EM)(8008,"Editor Language Status: {0}",n.join(", next: ")),tooltip:this._combinedEntryTooltip,command:ut.Eb,text:r?"$(loading~spin)":s};this._combinedEntry?this._combinedEntry.update(a):this._combinedEntry=this._statusBarService.addEntry(a,np._id,ut.Db.RIGHT,{location:{id:"status.editor.mode",priority:100.1},alignment:ut.Db.LEFT,compact:!0});let d=this._interactionCounter.value>=3,l=(0,at.$x)(null===i||void 0===i?void 0:i.getContainerDomNode()),c=l.document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus A>SPAN.codicon"),h=l.document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus");if((0,at._S)(c)&&h){let e="wiggle",i="flash";r?(c.classList.remove(e),h.classList.remove(i)):(c.classList.toggle(e,t||!d),this._renderDisposables.add((0,at.Sx)(c,"animationend",t=>c.classList.remove(e))),h.classList.toggle(i,t),this._renderDisposables.add((0,at.Sx)(h,"animationend",e=>h.classList.remove(i))))}if(!d){let e=l.document.querySelector(".monaco-workbench .context-view");if((0,at._S)(e)){let t=new MutationObserver(()=>{l.document.contains(this._combinedEntryTooltip)&&(this._interactionCounter.increment(),t.disconnect())});t.observe(e,{childList:!0,subtree:!0}),this._renderDisposables.add((0,at.kj)(()=>t.disconnect()))}}}let s=new Map;for(let r of o.dedicated){let e=np._asStatusbarEntry(r),t=this._dedicatedEntries.get(r.id);t?(t.update(e),this._dedicatedEntries.delete(r.id)):t=this._statusBarService.addEntry(e,r.id,ut.Db.RIGHT,{location:{id:"status.editor.mode",priority:100.1},alignment:ut.Db.RIGHT}),s.set(r.id,t)}(0,at.Sj)(this._dedicatedEntries.values()),this._dedicatedEntries=s}_renderStatus(e,t,i,o,s){let r=(0,at.jx)("div");r.classList.add("hover-language-status"),e.appendChild(r),s.add((0,at.kj)(()=>r.remove()));let n=(0,at.jx)("div");n.classList.add("severity","sev".concat(t.severity)),n.classList.toggle("show",i),(0,at.Dx)(n,...(0,at.Ac)(np._severityToSingleCodicon(t.severity))),r.appendChild(n);let a=(0,at.jx)("div");a.classList.add("element"),r.appendChild(a);let d=(0,at.jx)("div");d.classList.add("left"),a.appendChild(d),(0,at.Dx)(d,...(0,at.Ac)(up("string"==typeof t.label?t.label:t.label.value,t.busy))),this._renderTextPlus(d,t.detail,s);let l=(0,at.jx)("div");l.classList.add("right"),a.appendChild(l);let{command:c}=t;c&&s.add(new ut.kf(l,{label:c.title,title:c.tooltip,href:at.xO.from({scheme:"command",path:c.id,query:c.arguments&&JSON.stringify(c.arguments)}).toString()},{hoverDelegate:at.tr},this._hoverService,this._openerService));let h,u=new at.Vr(l,{hoverDelegate:at.tr}),g=o?(0,at.EM)(8009,"Remove from Status Bar"):(0,at.EM)(8010,"Add to Status Bar");return u.setAriaLabel(g),s.add(u),h=o?new at.Hb("unpin",g,at.Bb.asClassName(at.fO.pinned),!0,()=>{this._dedicated.delete(t.id),this._statusBarService.updateEntryVisibility(t.id,!1),this._update(),this._storeState()}):new at.Hb("pin",g,at.Bb.asClassName(at.fO.pin),!0,()=>{this._dedicated.add(t.id),this._statusBarService.updateEntryVisibility(t.id,!0),this._update(),this._storeState()}),u.push(h,{icon:!0,label:!1}),s.add(h),r}static _severityToComboCodicon(e){switch(e){case at.Ud.Error:return"$(bracket-error)";case at.Ud.Warning:return"$(bracket-dot)";default:return"$(bracket)"}}static _severityToSingleCodicon(e){switch(e){case at.Ud.Error:return"$(error)";case at.Ud.Warning:return"$(info)";default:return"$(check)"}}_renderTextPlus(e,t,i){let o=!1;for(let s of(0,at.ar)(t).nodes)o||((0,at.Dx)(e,(0,at.px)("span.separator")),o=!0),"string"==typeof s?(0,at.Dx)(e,...(0,at.Ac)(s)):i.add(new ut.kf(e,s,void 0,this._hoverService,this._openerService))}static _accessibilityInformation(e){if(e.accessibilityInfo)return e.accessibilityInfo;let t="string"==typeof e.label?e.label:e.label.value;return e.detail?{label:(0,at.EM)(8011,"{0}, {1}",t,e.detail)}:{label:(0,at.EM)(8012,"{0}",t)}}static _asStatusbarEntry(e){var t,i;let o;e.severity===at.Ud.Warning?o="warning":e.severity===at.Ud.Error&&(o="error");let s="string"==typeof e.label?e.label:e.label.shortValue;return{name:(0,at.EM)(8013,"{0} (Language Status)",e.name),text:up(s,e.busy),ariaLabel:np._accessibilityInformation(e).label,role:null===(t=e.accessibilityInfo)||void 0===t?void 0:t.role,tooltip:(null===(i=e.command)||void 0===i?void 0:i.tooltip)||new at.Bc(e.detail,{isTrusted:!0,supportThemeIcons:!0}),kind:o,command:e.command}}},{_:np=Fe},{_:Fe._id="status.languageStatus"},{_:Fe._keyDedicatedItems="languageStatus.dedicated"},Fe);cp=np=(0,at.Jb)([(0,at.Yb)(0,mt.t),(0,at.Yb)(1,ut.wb),(0,at.Yb)(2,bt.kt),(0,at.Yb)(3,at.nr),(0,at.Yb)(4,at.ml),(0,at.Yb)(5,at.Io)],cp);var hp=class extends at.bb{constructor(){super({id:"editor.inlayHints.Reset",title:(0,at.DM)(8014,"Reset Language Status Interaction Counter"),category:vt.s.View,f1:!0})}run(e){e.get(at.Io).remove("languageStatus.interactCount",at.Ro.PROFILE)}};function up(e,t){return(0,at.fA)([""!==e&&e,t&&"$(loading~spin)"],"\xa0\xa0")}(0,bt.b)(),(0,at.Tb)(),(0,bt.x)(lp.Id,lp,bt.y.AfterRestored),(0,at.Db)(hp);(0,at.TM)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.Fg)("mergeEditor.change.background","#9bb95533",(0,at.EM)(8621,"The background color for changes.")),(0,at.Fg)("mergeEditor.change.word.background",{dark:"#9ccc2c33",light:"#9ccc2c66",hcDark:"#9ccc2c33",hcLight:"#9ccc2c66"},(0,at.EM)(8622,"The background color for word changes.")),(0,at.Fg)("mergeEditor.changeBase.background",{dark:"#4B1818FF",light:"#FFCCCCFF",hcDark:"#4B1818FF",hcLight:"#FFCCCCFF"},(0,at.EM)(8623,"The background color for changes in base.")),(0,at.Fg)("mergeEditor.changeBase.word.background",{dark:"#6F1313FF",light:"#FFA3A3FF",hcDark:"#6F1313FF",hcLight:"#FFA3A3FF"},(0,at.EM)(8624,"The background color for word changes in base.")),(0,at.Fg)("mergeEditor.conflict.unhandledUnfocused.border",{dark:"#ffa6007a",light:"#ffa600FF",hcDark:"#ffa6007a",hcLight:"#ffa6007a"},(0,at.EM)(8625,"The border color of unhandled unfocused conflicts.")),(0,at.Fg)("mergeEditor.conflict.unhandledFocused.border","#ffa600",(0,at.EM)(8626,"The border color of unhandled focused conflicts.")),(0,at.Fg)("mergeEditor.conflict.handledUnfocused.border","#86868649",(0,at.EM)(8627,"The border color of handled unfocused conflicts.")),(0,at.Fg)("mergeEditor.conflict.handledFocused.border","#c1c1c1cc",(0,at.EM)(8628,"The border color of handled focused conflicts."));var gp=(0,at.Fg)("mergeEditor.conflict.handled.minimapOverViewRuler","#adaca8ee",(0,at.EM)(8629,"The foreground color for changes in input 1.")),pp=(0,at.Fg)("mergeEditor.conflict.unhandled.minimapOverViewRuler","#fcba03FF",(0,at.EM)(8630,"The foreground color for changes in input 1."));(0,at.Fg)("mergeEditor.conflictingLines.background","#ffea0047",(0,at.EM)(8631,'The background of the "Conflicting Lines" text.'));(0,at.Fg)("mergeEditor.conflict.input1.background",(0,at.Ig)(at.$h,.4),(0,at.EM)(8632,"The background color of decorations in input 1.")),(0,at.Fg)("mergeEditor.conflict.input2.background",(0,at.Ig)(at.eg,.4),(0,at.EM)(8633,"The background color of decorations in input 2.")),(0,at.oS)(),(0,at.wj)(),(0,at.qS)(),(0,ut.Ui)(),(0,at.rC)(),(0,dt.Lr)(),(0,at.tC)(),(0,at.bC)(),(0,at.fC)();var bp=class extends at.mj{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=(0,at.iC)(this,this._editor.onDidScrollChange,e=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(e=>0===e),this.modelAttached=(0,at.iC)(this,this._editor.onDidChangeModel,e=>this._editor.hasModel()),this.editorOnDidChangeViewZones=(0,dt.Rr)("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=(0,dt.Rr)("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=(0,at.nC)("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";let o=this._domNode.appendChild((0,at.iS)("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{(0,at.mC)(e=>{this.domNodeSizeChanged.trigger(e)})});s.observe(this._domNode),this._register((0,at.kj)(()=>s.disconnect())),this._register((0,at.hC)(e=>{o.className=this.isScrollTopZero.read(e)?"":"scroll-decoration"})),this._register((0,at.hC)(e=>this.render(e)))}dispose(){super.dispose(),(0,at.jS)(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);let t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),o=new Set(this.views.keys());if(i.length>0){let s=i[0],r=ut.Hi.fromLength(s.startLineNumber,s.endLineNumber-s.startLineNumber).deltaEnd(1),n=this.itemProvider.getIntersectingGutterItems(r,e);for(let e of n){if(!e.range.intersectsOrTouches(r))continue;o.delete(e.id);let i=this.views.get(e.id);if(i)i.gutterItemView.update(e);else{let t=(0,at.jx)("div");this._domNode.appendChild(t),i=new mp(this.itemProvider.createView(e,t),t),this.views.set(e.id,i)}let s=e.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(e.range.startLineNumber,!0)-t:this._editor.getBottomForLineNumber(e.range.startLineNumber-1,!1)-t,n=this._editor.getBottomForLineNumber(e.range.endLineNumberExclusive-1,!0)-t-s;i.domNode.style.top="".concat(s,"px"),i.domNode.style.height="".concat(n,"px"),i.gutterItemView.layout(s,n,0,this._domNode.clientHeight)}}for(let s of o){let e=this.views.get(s);e.gutterItemView.dispose(),e.domNode.remove(),this.views.delete(s)}}},mp=class{constructor(e,t){this.gutterItemView=e,this.domNode=t}};(0,at.Xb)(),(0,at.oS)(),(0,at.sj)(),(0,at.wj)(),(0,at.qS)(),(0,at.ob)(),(0,dt.xi)(),(0,at.gO)(),(0,gt.un)(),(0,ut.xS)(),(0,dt.pr)(),(0,at.ox)(),(0,dt.tt)(),(0,ut.ki)(),(0,ct.n)(),(0,at.rC)(),(0,at.EC)(),(0,at.bC)();var vp=class extends at.mj{updateOptions(e){this.editor.updateOptions(e)}constructor(e,t,i){super(),this.instantiationService=e,this.viewModel=t,this.configurationService=i,this.model=this.viewModel.map(e=>null===e||void 0===e?void 0:e.model),this.htmlElements=(0,at.iS)("div.code-view",[(0,at.iS)("div.header@header",[(0,at.iS)("span.title@title"),(0,at.iS)("span.description@description"),(0,at.iS)("span.detail@detail"),(0,at.iS)("span.toolbar@toolbar")]),(0,at.iS)("div.container",[(0,at.iS)("div.gutter@gutterDiv"),(0,at.iS)("div@editor")])]),this._onDidViewChange=new at.ej,this.view={element:this.htmlElements.root,minimumWidth:dt.X.width,maximumWidth:dt.Y.width,minimumHeight:dt.X.height,maximumHeight:dt.Y.height,onDidChange:this._onDidViewChange.event,layout:(e,t,i,o)=>{(0,ut.Mi)(this.htmlElements.root,{width:e,height:t,top:i,left:o}),this.editor.layout({width:e-this.htmlElements.gutterDiv.clientWidth,height:t-this.htmlElements.header.clientHeight})}},this.checkboxesVisible=(0,ct.r)("mergeEditor.showCheckboxes",!1,this.configurationService),this.showDeletionMarkers=(0,ct.r)("mergeEditor.showDeletionMarkers",!0,this.configurationService),this.useSimplifiedDecorations=(0,ct.r)("mergeEditor.useSimplifiedDecorations",!1,this.configurationService),this.editor=this.instantiationService.createInstance(dt.bi,this.htmlElements.editor,{},{contributions:this.getEditorContributions()}),this.isFocused=(0,at.iC)(this,at.tj.any(this.editor.onDidBlurEditorWidget,this.editor.onDidFocusEditorWidget),()=>this.editor.hasWidgetFocus()),this.cursorPosition=(0,at.iC)(this,this.editor.onDidChangeCursorPosition,()=>this.editor.getPosition()),this.selection=(0,at.iC)(this,this.editor.onDidChangeCursorSelection,()=>this.editor.getSelections()),this.cursorLineNumber=this.cursorPosition.map(e=>null===e||void 0===e?void 0:e.lineNumber)}getEditorContributions(){return at.eb.getEditorContributions().filter(e=>e.id!==ut.bS.ID&&e.id!==gt.ln.ID)}};function Cp(e,t){let i=(0,at.xC)(i=>{let o=e.viewModel.read(i);if(!o)return[];let s=o.selectionInBase.read(i);return s&&s.sourceEditor!==e?s.rangesInBase.map(e=>t(e,o)):[]});return(0,at.hC)(t=>{let o=i.read(t);0!==o.length&&e.editor.setSelections(o.map(e=>new at.mO(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)))})}var wp=class extends at.mj{constructor(e,t,i){super();let o=i.createInstance(dt.dr,t,e,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:e=>"primary"===e}});this._store.add(o)}};wp=(0,at.Jb)([(0,at.Yb)(2,at.rx)],wp),(0,at.Xb)(),(0,at.oS)(),(0,at.Oc)(),(0,at.aP)(),(0,at.qS)(),(0,at.Cy)(),(0,at.TM)(),(0,at.Tb)(),(0,at.i_)(),(0,at.ox)(),(0,ut.ki)(),(0,at.EC)(),(0,at.bC)();var yp=class extends vp{constructor(e,t,i){super(t,e,i),this.decorations=(0,at.xC)(this,e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=i.base,s=t.activeModifiedBaseRange.read(e),r=t.showNonConflictingChanges.read(e),n=this.showDeletionMarkers.read(e),a=[];for(let d of i.modifiedBaseRanges.read(e)){let l=d.baseRange;if(!l)continue;let c=i.isHandled(d).read(e);if(!d.isConflicting&&c&&!r)continue;let h=["merge-editor-block"],u=[0,0,0,0];c&&h.push("handled"),d===s&&(h.push("focused"),u=[0,2,0,2]),h.push("base");let g=t.baseShowDiffAgainst.read(e);if(g)for(let e of d.getInputDiffs(g)){let t=e.inputRange.toInclusiveRange();t&&a.push({range:t,options:{className:"merge-editor-diff base",description:"Merge Editor",isWholeLine:!0}});for(let i of e.rangeMappings)(n||!i.inputRange.isEmpty())&&a.push({range:i.inputRange,options:{className:i.inputRange.isEmpty()?"merge-editor-diff-empty-word base":"merge-editor-diff-word base",description:"Merge Editor",showIfCollapsed:!0}})}a.push({range:l.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:h.join(" "),blockPadding:u,blockIsAfterEnd:l.startLineNumber>o.getLineCount(),description:"Merge Editor",minimap:{position:at.hy.Gutter,color:{id:c?gp:pp}},overviewRuler:d.isConflicting?{position:at.vy.Center,color:{id:c?gp:pp}}:void 0}})}return a}),this._register(Cp(this,(e,t)=>e)),this._register(t.createInstance(wp,at.xb.MergeBaseToolbar,this.htmlElements.title)),this._register((0,at.yC)((e,t)=>{this.checkboxesVisible.read(e)&&t.add(new bp(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(e,t)=>[],createView:(e,t)=>{throw new at.qN}}))})),this._register((0,at.hC)(e=>{let t=this.viewModel.read(e);if(!t)return;this.editor.setModel(t.model.base),(0,at.jS)(this.htmlElements.title,...(0,at.Ac)((0,at.EM)(8652,"Base")));let i,o=t.baseShowDiffAgainst.read(e);if(o){let e=(0,at.EM)(8653,"Comparing with {0}",1===o?t.model.input1.title:t.model.input2.title);i=(0,at.iS)("span",{title:(0,at.EM)(8654,"Differences are highlighted with a background color.")},[e]).root}(0,at.jS)(this.htmlElements.description,...i?[i]:[])})),this._register((0,ut.Di)(this.editor,this.decorations))}};yp=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,at.r_)],yp),(0,at.wj)(),(0,at.qS)(),(0,at.iv)(),(0,ut.Li)(),(0,ut.Pi)(),(0,at.aP)(),(0,at.GM)(),(0,at.EC)();var fp=class extends at.mj{get model(){var e;return null===(e=this.viewModel.get())||void 0===e?void 0:e.model}get lockResultWithInputs(){return"columns"===this.layout.get().kind}get lockBaseWithInputs(){return"mixed"===this.layout.get().kind&&!this.layout.get().showBaseAtTop}constructor(e,t,i,o,s,r){super(),this.viewModel=e,this.input1View=t,this.input2View=i,this.baseView=o,this.inputResultView=s,this.layout=r,this.reentrancyBarrier=new ut.Ni,this._isSyncing=!0;let n=(0,at.xC)(e=>{let t=this.baseView.read(e),i=[this.input1View,this.input2View,this.inputResultView,t].filter(at.qM),o=(e,t,o)=>{this.reentrancyBarrier.runExclusivelyOrSkip(()=>{if(t){let t=e.editor.getScrollLeft();for(let o of i)o!==e&&o.editor.setScrollLeft(t,at.rv.Immediate)}if(o){let t=e.editor.getScrollTop();for(let o of i)if(o!==e)if(this._shouldLock(e,o))o.editor.setScrollTop(t,at.rv.Immediate);else{let t=this._getMapping(e,o);t&&this._synchronizeScrolling(e.editor,o.editor,t)}}})};for(let s of i)e.store.add(s.editor.onDidScrollChange(e=>{this._isSyncing&&o(s,e.scrollLeftChanged,e.scrollTopChanged)}));return{update:()=>{o(this.inputResultView,!0,!0)}}}).recomputeInitiallyAndOnChange(this._store);this.updateScrolling=()=>{n.get().update()}}stopSync(){this._isSyncing=!1}startSync(){this._isSyncing=!0}_shouldLock(e,t){let i=e=>e===this.input1View||e===this.input2View;return i(e)&&t===this.inputResultView||i(t)&&e===this.inputResultView?this.lockResultWithInputs:i(e)&&t===this.baseView.get()||i(t)&&e===this.baseView.get()?this.lockBaseWithInputs:!(!i(e)||!i(t))}_getMapping(e,t){if(e===this.input1View){var i;if(t===this.input2View)return;if(t===this.inputResultView)return null===(i=this.model)||void 0===i?void 0:i.input1ResultMapping.get();if(t===this.baseView.get()){var o;let e=null===(o=this.model)||void 0===o?void 0:o.baseInput1Diffs.get();return e?new ut.Fi(e,-1).reverse():void 0}}else if(e===this.input2View){var s;if(t===this.input1View)return;if(t===this.inputResultView)return null===(s=this.model)||void 0===s?void 0:s.input2ResultMapping.get();if(t===this.baseView.get()){var r;let e=null===(r=this.model)||void 0===r?void 0:r.baseInput2Diffs.get();return e?new ut.Fi(e,-1).reverse():void 0}}else if(e===this.inputResultView){var n,a,d;if(t===this.input1View)return null===(n=this.model)||void 0===n?void 0:n.resultInput1Mapping.get();if(t===this.input2View)return null===(a=this.model)||void 0===a?void 0:a.resultInput2Mapping.get();if(t===this.baseView.get())return(null===(d=this.model)||void 0===d?void 0:d.resultBaseMapping.get())||void 0}else if(e===this.baseView.get()){var l;if(t===this.input1View){var c;let e=null===(c=this.model)||void 0===c?void 0:c.baseInput1Diffs.get();return e?new ut.Fi(e,-1):void 0}if(t===this.input2View){var h;let e=null===(h=this.model)||void 0===h?void 0:h.baseInput2Diffs.get();return e?new ut.Fi(e,-1):void 0}if(t===this.inputResultView)return(null===(l=this.model)||void 0===l?void 0:l.baseResultMapping.get())||void 0}throw new at.qN}_synchronizeScrolling(e,t,i){if(!i)return;let o=e.getVisibleRanges();if(0===o.length)return;let s=o[0].startLineNumber-1,r=i.project(s),n=r.inputRange,a=r.outputRange,d=t.getTopForLineNumber(a.startLineNumber),l=t.getTopForLineNumber(a.endLineNumberExclusive),c=e.getTopForLineNumber(n.startLineNumber),h=e.getTopForLineNumber(n.endLineNumberExclusive),u=d+(l-d)*Math.min((e.getScrollTop()-c)/(h-c),1);t.setScrollTop(u,at.rv.Immediate)}};(0,at.Xb)(),(0,at.vP)(),(0,at.wj)(),(0,at.qS)(),(0,at.vO)(),(0,at.iv)(),(0,at.TM)(),(0,at.i_)(),(0,at.Fd)(),(0,ut.Ui)(),(0,ct.n)(),(0,at.sC)(),(0,at.ZS)(),(0,at.EC)(),(0,at.fC)();var Sp=class extends at.mj{constructor(e,t,i,o,s,r,n,a){super(),this.model=e,this.inputCodeEditorView1=t,this.inputCodeEditorView2=i,this.resultCodeEditorView=o,this.baseCodeEditorView=s,this.showNonConflictingChanges=r,this.configurationService=n,this.notificationService=a,this.manuallySetActiveModifiedBaseRange=(0,at.cC)(this,{range:void 0,counter:0}),this.attachedHistory=this._register(new Ep(this.model.resultTextModel)),this.shouldUseAppendInsteadOfAccept=(0,ct.r)("mergeEditor.shouldUseAppendInsteadOfAccept",!1,this.configurationService),this.counter=0,this.lastFocusedEditor=(0,at.XS)(this,(e,t)=>{let i=[this.inputCodeEditorView1,this.inputCodeEditorView2,this.resultCodeEditorView,this.baseCodeEditorView.read(e)].find(t=>t&&t.isFocused.read(e));return i?{view:i,counter:this.counter++}:t||{view:void 0,counter:this.counter++}}),this.baseShowDiffAgainst=(0,at.xC)(this,e=>{let t=this.lastFocusedEditor.read(e);return t.view===this.inputCodeEditorView1?1:t.view===this.inputCodeEditorView2?2:void 0}),this.focusedEditorType=(0,at.xC)(this,e=>{let t=this.lastFocusedEditor.read(e);if(t.view){if(t.view===this.inputCodeEditorView1)return"input1";if(t.view===this.inputCodeEditorView2)return"input2";if(t.view===this.resultCodeEditorView)return"result";if(t.view===this.baseCodeEditorView.read(e))return"base"}}),this.selectionInBase=(0,at.xC)(this,e=>{let t=this.lastFocusedEditor.read(e).view;if(t)return{rangesInBase:(t.selection.read(e)||[]).map(i=>t===this.inputCodeEditorView1?this.model.translateInputRangeToBase(1,i):t===this.inputCodeEditorView2?this.model.translateInputRangeToBase(2,i):t===this.resultCodeEditorView?this.model.translateResultRangeToBase(i):(this.baseCodeEditorView.read(e),i)),sourceEditor:t}}),this.activeModifiedBaseRange=(0,at.xC)(this,e=>{let t=this.lastFocusedEditor.read(e),i=this.manuallySetActiveModifiedBaseRange.read(e);if(i.counter>t.counter)return i.range;if(!t.view)return;let o=t.view.cursorLineNumber.read(e);return o?this.model.modifiedBaseRanges.read(e).find(i=>{let s=this.getRangeOfModifiedBaseRange(t.view,i,e);return s.isEmpty?s.startLineNumber===o:s.contains(o)}):void 0}),this._register(o.editor.onDidChangeModelContent(e=>{if(this.model.isApplyingEditInResult||e.isRedoing||e.isUndoing)return;let t=[];for(let o of e.changes){let e=this.model.translateResultRangeToBase(at._O.lift(o.range)),i=this.model.findModifiedBaseRangesInRange(ut.Hi.fromLength(e.startLineNumber,e.endLineNumber-e.startLineNumber));1===i.length&&(this.model.isHandled(i[0]).get()||t.push(i[0]))}if(0===t.length)return;let i={model:this.model,redo(){(0,at.mC)(e=>{for(let i of t)this.model.setHandled(i,!0,e)})},undo(){(0,at.mC)(e=>{for(let i of t)this.model.setHandled(i,!1,e)})}};this.attachedHistory.pushAttachedHistoryElement(i),i.redo()}))}getRangeOfModifiedBaseRange(e,t,i){if(e===this.resultCodeEditorView)return this.model.getLineRangeInResult(t.baseRange,i);if(e===this.baseCodeEditorView.get())return t.baseRange;{let i=e===this.inputCodeEditorView1?1:2;return t.getInputRange(i)}}setActiveModifiedBaseRange(e,t){this.manuallySetActiveModifiedBaseRange.set({range:e,counter:this.counter++},t)}setState(e,t,i,o){this.manuallySetActiveModifiedBaseRange.set({range:e,counter:this.counter++},i),this.model.setState(e,t,o,i),this.lastFocusedEditor.clearCache(i)}goToConflict(e){var t;let i=this.lastFocusedEditor.get().view;i||(i=this.resultCodeEditorView);let o=null===(t=i.editor.getPosition())||void 0===t?void 0:t.lineNumber;if(void 0===o)return;let s=e(i,o);if(s){let e=this.getRangeOfModifiedBaseRange(i,s,void 0);i.editor.focus();let t=e.startLineNumber,o=e.endLineNumberExclusive;e.startLineNumber>i.editor.getModel().getLineCount()&&((0,at.mC)(e=>{this.setActiveModifiedBaseRange(s,e)}),t=o=i.editor.getModel().getLineCount()),i.editor.setPosition({lineNumber:t,column:i.editor.getModel().getLineFirstNonWhitespaceColumn(t)}),i.editor.revealLinesNearTop(t,o,at.rv.Smooth)}}goToNextModifiedBaseRange(e){this.goToConflict((t,i)=>this.model.modifiedBaseRanges.get().find(o=>e(o)&&this.getRangeOfModifiedBaseRange(t,o,void 0).startLineNumber>i)||this.model.modifiedBaseRanges.get().find(t=>e(t)))}goToPreviousModifiedBaseRange(e){this.goToConflict((t,i)=>(0,at.hP)(this.model.modifiedBaseRanges.get(),o=>e(o)&&this.getRangeOfModifiedBaseRange(t,o,void 0).endLineNumberExclusive<i)||(0,at.hP)(this.model.modifiedBaseRanges.get(),t=>e(t)))}toggleActiveConflict(e){let t=this.activeModifiedBaseRange.get();t?(0,at.mC)(i=>{this.setState(t,this.model.getState(t).get().toggle(e),i,e)}):this.notificationService.error((0,at.EM)(8671,"There is currently no conflict focused that can be toggled."))}acceptAll(e){(0,at.mC)(t=>{for(let i of this.model.modifiedBaseRanges.get())this.setState(i,this.model.getState(i).get().withInputValue(e,!0),t,e)})}};Sp=(0,at.Jb)([(0,at.Yb)(6,at.r_),(0,at.Yb)(7,at.Pd)],Sp);var Ep=class extends at.mj{constructor(e){super(),this.model=e,this.attachedHistory=[],this.previousAltId=this.model.getAlternativeVersionId(),this._register(e.onDidChangeContent(t=>{let i=e.getAlternativeVersionId();if(t.isRedoing)for(let e of this.attachedHistory)this.previousAltId<e.altId&&e.altId<=i&&e.element.redo();else if(t.isUndoing)for(let e=this.attachedHistory.length-1;e>=0;e--){let t=this.attachedHistory[e];i<t.altId&&t.altId<=this.previousAltId&&t.element.undo()}else for(;this.attachedHistory.length>0&&this.attachedHistory[this.attachedHistory.length-1].altId>this.previousAltId;)this.attachedHistory.pop();this.previousAltId=i}))}pushAttachedHistoryElement(e){this.attachedHistory.push({altId:this.model.getAlternativeVersionId(),element:e})}};(0,at.oS)(),(0,at.wj)(),(0,at.sj)();var kp=(Ye=class e extends at.mj{constructor(t,i,o,s,r){super(),this.editor=t,this.overlayWidgetId="fixedZoneWidget-".concat(e.counter++),this.widgetDomNode=(0,at.iS)("div.fixed-zone-widget").root,this.overlayWidget={getId:()=>this.overlayWidgetId,getDomNode:()=>this.widgetDomNode,getPosition:()=>null},this.viewZoneId=i.addZone({domNode:(0,at.jx)("div"),afterLineNumber:o,heightInPx:s,ordinal:50001,onComputedHeight:e=>{this.widgetDomNode.style.height="".concat(e,"px")},onDomNodeTop:e=>{this.widgetDomNode.style.top="".concat(e,"px")}}),r.push(this.viewZoneId),this._register(at.tj.runAndSubscribe(this.editor.onDidLayoutChange,()=>{this.widgetDomNode.style.left=this.editor.getLayoutInfo().contentLeft+"px"})),this.editor.addOverlayWidget(this.overlayWidget),this._register({dispose:()=>{this.editor.removeOverlayWidget(this.overlayWidget)}})}},{_:Ye.counter=0},Ye);(0,at.oS)(),(0,at.Wg)(),(0,at.Oc)(),(0,at.JC)(),(0,at.wj)(),(0,at.qS)(),(0,at.wk)(),(0,at.TM)(),(0,ut.Ti)(),(0,at.bC)(),(0,at.EC)(),(0,at.fC)();var _p=class extends at.mj{constructor(e){super(),this._editor=e,this._register(this._editor.onDidChangeConfiguration(e=>{(e.hasChanged(at.sk.fontInfo)||e.hasChanged(at.sk.codeLensFontSize)||e.hasChanged(at.sk.codeLensFontFamily))&&this._updateLensStyle()})),this._styleClassName="_conflictActionsFactory_"+(0,at.qC)(this._editor.getId()).toString(16),this._styleElement=(0,at.Hg)((0,at.bS)(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,void 0,this._store),this._updateLensStyle()}_updateLensStyle(){var e,t;let{codeLensHeight:i,fontSize:o}=this._getLayoutInfo(),s=this._editor.getOption(at.sk.codeLensFontFamily),r=this._editor.getOption(at.sk.fontInfo),n="--codelens-font-family".concat(this._styleClassName),a="--codelens-font-features".concat(this._styleClassName),d="\n\t\t.".concat(this._styleClassName," { line-height: ").concat(i,"px; font-size: ").concat(o,"px; padding-right: ").concat(Math.round(.5*o),"px; font-feature-settings: var(").concat(a,") }\n\t\t.monaco-workbench .").concat(this._styleClassName," span.codicon { line-height: ").concat(i,"px; font-size: ").concat(o,"px; }\n\t\t");s&&(d+="".concat(this._styleClassName," { font-family: var(").concat(n,"), ").concat(at.nk.fontFamily,"}")),this._styleElement.textContent=d,null!==(e=this._editor.getContainerDomNode().style)&&void 0!==e&&e.setProperty(n,null!==s&&void 0!==s?s:"inherit"),null===(t=this._editor.getContainerDomNode().style)||void 0===t||t.setProperty(a,r.fontFeatureSettings)}_getLayoutInfo(){let e=Math.max(1.3,this._editor.getOption(at.sk.lineHeight)/this._editor.getOption(at.sk.fontSize)),t=this._editor.getOption(at.sk.codeLensFontSize);return(!t||t<5)&&(t=.9*this._editor.getOption(at.sk.fontSize)|0),{fontSize:t,codeLensHeight:t*e|0}}createWidget(e,t,i,o){let s=this._getLayoutInfo();return new Ap(this._editor,e,t,s.codeLensHeight+2,this._styleClassName,i,o)}},Ip=class{constructor(e,t){this.viewModel=e,this.modifiedBaseRange=t,this.itemsInput1=this.getItemsInput(1),this.itemsInput2=this.getItemsInput(2),this.resultItems=(0,at.xC)(this,e=>{let t=this.viewModel,i=this.modifiedBaseRange,o=t.model.getState(i).read(e),s=t.model,r=[];if(o.kind===ut.wi.unrecognized)r.push({text:(0,at.EM)(8634,"Manual Resolution"),tooltip:(0,at.EM)(8635,"This conflict has been resolved manually.")});else if(o.kind===ut.wi.base)r.push({text:(0,at.EM)(8636,"No Changes Accepted"),tooltip:(0,at.EM)(8637,"The current resolution of this conflict equals the common ancestor of both the right and left changes.")});else{let e=[];o.includesInput1&&e.push(s.input1.title),o.includesInput2&&e.push(s.input2.title),o.kind===ut.wi.both&&2===o.firstInput&&e.reverse(),r.push({text:"".concat(e.join(" + "))})}let n=[];return o.includesInput1&&n.push(xp((0,at.EM)(8638,"Remove {0}",s.input1.title),async()=>{(0,at.mC)(e=>{s.setState(i,o.withInputValue(1,!1),!0,e),s.telemetry.reportRemoveInvoked(1,o.includesInput(2))})},(0,at.EM)(8639,"Remove {0} from the result document.",s.input1.title))),o.includesInput2&&n.push(xp((0,at.EM)(8638,"Remove {0}",s.input2.title),async()=>{(0,at.mC)(e=>{s.setState(i,o.withInputValue(2,!1),!0,e),s.telemetry.reportRemoveInvoked(2,o.includesInput(1))})},(0,at.EM)(8639,"Remove {0} from the result document.",s.input2.title))),o.kind===ut.wi.both&&2===o.firstInput&&n.reverse(),r.push(...n),o.kind===ut.wi.unrecognized&&r.push(xp((0,at.EM)(8640,"Reset to base"),async()=>{(0,at.mC)(e=>{s.setState(i,ut.Ci.base,!0,e),s.telemetry.reportResetToBaseInvoked()})},(0,at.EM)(8641,"Reset this conflict to the common ancestor of both the right and left changes."))),r}),this.isEmpty=(0,at.xC)(this,e=>this.itemsInput1.read(e).length+this.itemsInput2.read(e).length+this.resultItems.read(e).length===0),this.inputIsEmpty=(0,at.xC)(this,e=>this.itemsInput1.read(e).length+this.itemsInput2.read(e).length===0)}getItemsInput(e){return(0,at.xC)(t=>{let i=this.viewModel,o=this.modifiedBaseRange;if(!i.model.hasBaseRange(o))return[];let s=i.model.getState(o).read(t),r=i.model.isHandled(o).read(t),n=i.model,a=[],d=1===e?i.model.input1:i.model.input2,l=i.showNonConflictingChanges.read(t);if(!o.isConflicting&&r&&!l)return[];let c=1===e?2:1;if(s.kind!==ut.wi.unrecognized&&!s.isInputIncluded(e)){if(s.isInputIncluded(c)&&this.viewModel.shouldUseAppendInsteadOfAccept.read(t))a.push(xp((0,at.EM)(8647,"Append {0}",d.title),async()=>{(0,at.mC)(t=>{n.setState(o,s.withInputValue(e,!0,!1),e,t),n.telemetry.reportAcceptInvoked(e,s.includesInput(c))})},(0,at.EM)(8648,"Append {0} to the result document.",d.title))),o.canBeCombined&&a.push(xp((0,at.EM)(8649,"Accept Combination",d.title),async()=>{(0,at.mC)(t=>{n.setState(o,s.withInputValue(e,!0,!0),e,t),n.telemetry.reportSmartCombinationInvoked(s.includesInput(c))})},(0,at.EM)(8646,"Accept an automatic combination of both sides in the result document.")));else if(a.push(xp((0,at.EM)(8642,"Accept {0}",d.title),async()=>{(0,at.mC)(t=>{n.setState(o,s.withInputValue(e,!0,!1),e,t),n.telemetry.reportAcceptInvoked(e,s.includesInput(c))})},(0,at.EM)(8643,"Accept {0} in the result document.",d.title))),o.canBeCombined){let t=o.isOrderRelevant?(0,at.EM)(8644,"Accept Combination ({0} First)",d.title):(0,at.EM)(8645,"Accept Combination");a.push(xp(t,async()=>{(0,at.mC)(t=>{n.setState(o,ut.Ci.base.withInputValue(e,!0).withInputValue(c,!0,!0),!0,t),n.telemetry.reportSmartCombinationInvoked(s.includesInput(c))})},(0,at.EM)(8646,"Accept an automatic combination of both sides in the result document.")))}n.isInputHandled(o,e).read(t)||a.push(xp((0,at.EM)(8650,"Ignore"),async()=>{(0,at.mC)(t=>{n.setInputHandled(o,e,!0,t)})},(0,at.EM)(8651,"Don't take this side of the conflict.")))}return a})}};function xp(e,t,i){return{text:e,action:t,tooltip:i}}var Ap=class extends kp{constructor(e,t,i,o,s,r,n){super(e,t,i,o,n),this._domNode=(0,at.iS)("div.merge-editor-conflict-actions").root,this.widgetDomNode.appendChild(this._domNode),this._domNode.classList.add(s),this._register((0,at.hC)(e=>{let t=r.read(e);this.setState(t)}))}setState(e){let t=[],i=!0;for(let o of e){i?i=!1:t.push((0,at.px)("span",void 0,"\xa0|\xa0"));let e=(0,at.Ac)(o.text);o.action?t.push((0,at.px)("a",{title:o.tooltip,role:"button",onclick:()=>o.action()},...e)):t.push((0,at.px)("span",{title:o.tooltip},...e))}(0,at.jS)(this._domNode,...t)}};function Vp(e){let t=function(e,t){let i=[],o=[];for(let[d,l]of[[0,e],[1,t]])for(let e of l)o.push({input:d,start:!0,inputPos:e.inputRange.getStartPosition(),outputPos:e.outputRange.getStartPosition()}),o.push({input:d,start:!1,inputPos:e.inputRange.getEndPosition(),outputPos:e.outputRange.getEndPosition()});o.sort((0,at.bN)(e=>e.inputPos,at.yO.compare));let s,r=[void 0,void 0];for(let d of o){if(s&&r.some(e=>!!e)){var n,a;let e=(0,ut.Bi)(s,d.inputPos);e.isZero()||(i.push({inputPos:s,length:e,output1Pos:r[0],output2Pos:r[1]}),r[n=0]&&(r[n]=(0,ut.Ri)(r[0],e)),r[a=1]&&(r[a]=(0,ut.Ri)(r[1],e)))}r[d.input]=d.start?d.outputPos:void 0,s=d.inputPos}return i}(Dp(e.input1Diffs.flatMap(e=>e.rangeMappings),e.baseRange.toExclusiveRange(),e.input1Range.toExclusiveRange()),Dp(e.input2Diffs.flatMap(e=>e.rangeMappings),e.baseRange.toExclusiveRange(),e.input2Range.toExclusiveRange())),i=[];function o(e){return e.every(e=>void 0!==e)}i.push([e.input1Range.startLineNumber-1,e.baseRange.startLineNumber-1,e.input2Range.startLineNumber-1]);for(let a of t){var s,r;let e=[null===(s=a.output1Pos)||void 0===s?void 0:s.lineNumber,a.inputPos.lineNumber,null===(r=a.output2Pos)||void 0===r?void 0:r.lineNumber],t=!0;if(o(e)){let s=!i.some(t=>o(t)&&t.some((t,i)=>void 0!==t&&t===e[i]));s&&(i=i.filter(t=>!t.some((t,i)=>void 0!==t&&t===e[i]))),t=s}else t=!i.some(t=>t.some((t,i)=>void 0!==t&&t===e[i]));t?i.push(e):a.length.isGreaterThan(new at.Yv(1,0))&&i.push([a.output1Pos?a.output1Pos.lineNumber+1:void 0,a.inputPos.lineNumber+1,a.output2Pos?a.output2Pos.lineNumber+1:void 0])}let n=[e.input1Range.endLineNumberExclusive,e.baseRange.endLineNumberExclusive,e.input2Range.endLineNumberExclusive];return i=i.filter(e=>e.every((e,t)=>e!==n[t])),i.push(n),(0,at.iN)(()=>(0,at.oN)(i.map(e=>e[0]).filter(at.qM),(e,t)=>e<t)&&(0,at.oN)(i.map(e=>e[1]).filter(at.qM),(e,t)=>e<=t)&&(0,at.oN)(i.map(e=>e[2]).filter(at.qM),(e,t)=>e<t)&&i.every(e=>e.filter(at.qM).length>=2)),i}function Dp(e,t,i){let o=[],s=t.getStartPosition(),r=i.getStartPosition();for(let a of e){let e=new ut.Ii(at._O.fromPositions(s,a.inputRange.getStartPosition()),at._O.fromPositions(r,a.outputRange.getStartPosition()));(0,at.iN)(()=>(0,ut.Vi)(e.inputRange).equals((0,ut.Vi)(e.outputRange))),e.inputRange.isEmpty()||o.push(e),s=a.inputRange.getEndPosition(),r=a.outputRange.getEndPosition()}let n=new ut.Ii(at._O.fromPositions(s,t.getEndPosition()),at._O.fromPositions(r,i.getEndPosition()));return(0,at.iN)(()=>(0,ut.Vi)(n.inputRange).equals((0,ut.Vi)(n.outputRange))),n.inputRange.isEmpty()||o.push(n),o}(0,at.AN)(),(0,at.sN)(),(0,at.GM)(),(0,at.bO)(),(0,at.vO)(),(0,at.Xv)(),(0,ut.Li)(),(0,ut.zi)(),(0,at.oS)(),(0,at.AN)(),(0,ut.Ui)(),(0,ut.ki)();var Mp=class{constructor(e,t,i){this.input1Editor=e,this.input2Editor=t,this.resultEditor=i,this.conflictActionsFactoryInput1=new _p(this.input1Editor),this.conflictActionsFactoryInput2=new _p(this.input2Editor),this.conflictActionsFactoryResult=new _p(this.resultEditor)}computeViewZones(e,t,i){let o,s,r=0,n=0,a=0,d=0,l=[],c=[],h=[],u=[],g=t.model,p=g.baseResultDiffs.read(e),b=(0,ut.Ai)(g.modifiedBaseRanges.read(e),p,(e,t)=>e.baseRange.intersectsOrTouches(t.inputRange)?at.dN.neitherLessOrGreaterThan:ut.Hi.compareByStart(e.baseRange,t.inputRange)),m=i.codeLensesVisible,v=i.showNonConflictingChanges;for(let y of b){if(m&&y.left&&(y.left.isConflicting||v||!g.isHandled(y.left).read(e))){var C,w;let o=new Ip(t,y.left);(i.shouldAlignResult||!o.inputIsEmpty.read(e))&&(l.push(new Lp(this.conflictActionsFactoryInput1,y.left.input1Range.startLineNumber-1,o.itemsInput1)),c.push(new Lp(this.conflictActionsFactoryInput2,y.left.input2Range.startLineNumber-1,o.itemsInput2)),i.shouldAlignBase&&h.push(new Wp(y.left.baseRange.startLineNumber-1,16)));let r=y.left.baseRange.startLineNumber+(null!==(C=null===(w=s)||void 0===w?void 0:w.resultingDeltaFromOriginalToModified)&&void 0!==C?C:0)-1;u.push(new Lp(this.conflictActionsFactoryResult,r,o.resultItems))}let p,b=y.rights.at(-1);b&&(s=b),y.left?(p=Vp(y.left).map(e=>({input1Line:e[0],baseLine:e[1],input2Line:e[2],resultLine:void 0})),o=y.left,p[p.length-1].resultLine=y.left.baseRange.endLineNumberExclusive+(s?s.resultingDeltaFromOriginalToModified:0)):p=[{baseLine:b.inputRange.endLineNumberExclusive,input1Line:b.inputRange.endLineNumberExclusive+(o?o.input1Range.endLineNumberExclusive-o.baseRange.endLineNumberExclusive:0),input2Line:b.inputRange.endLineNumberExclusive+(o?o.input2Range.endLineNumberExclusive-o.baseRange.endLineNumberExclusive:0),resultLine:b.outputRange.endLineNumberExclusive}];for(let{input1Line:e,baseLine:t,input2Line:o,resultLine:s}of p){if(!i.shouldAlignBase&&(void 0===e||void 0===o))continue;let g=void 0===e?-1:e+r,p=void 0===o?-1:o+n,b=t+a,m=void 0===s?-1:s+d,v=Math.max(i.shouldAlignBase?b:0,g,p,i.shouldAlignResult?m:0);if(void 0!==e){let t=v-g;t>0&&(l.push(new Op(e-1,t)),r+=t)}if(void 0!==o){let e=v-p;e>0&&(c.push(new Op(o-1,e)),n+=e)}if(i.shouldAlignBase){let e=v-b;e>0&&(h.push(new Op(t-1,e)),a+=e)}if(i.shouldAlignResult&&void 0!==s){let e=v-m;e>0&&(u.push(new Op(s-1,e)),d+=e)}}}return new Tp(l,c,h,u)}},Tp=class{constructor(e,t,i,o){this.input1ViewZones=e,this.input2ViewZones=t,this.baseViewZones=i,this.resultViewZones=o}},Rp=class{},Op=class extends Rp{constructor(e,t){super(),this.afterLineNumber=e,this.heightInLines=t}create(e,t,i){t.push(e.addZone({afterLineNumber:this.afterLineNumber,heightInLines:this.heightInLines,domNode:(0,at.px)("div.diagonal-fill")}))}},Wp=class extends Rp{constructor(e,t){super(),this.afterLineNumber=e,this.heightPx=t}create(e,t,i){t.push(e.addZone({afterLineNumber:this.afterLineNumber,heightInPx:this.heightPx,domNode:(0,at.px)("div.conflict-actions-placeholder")}))}},Lp=class extends Rp{constructor(e,t,i){super(),this.conflictActionsFactory=e,this.lineNumber=t,this.items=i}create(e,t,i){i.add(this.conflictActionsFactory.createWidget(e,this.lineNumber,this.items,t))}};(0,at.kv)(),(0,at.TM)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,dt.er)(),(0,at.Fg)("settings.settingsHeaderHoverForeground",(0,at.Ig)((0,at.Fg)("settings.headerForeground",{light:"#444444",dark:"#e7e7e7",hcDark:"#ffffff",hcLight:"#292929"},(0,at.EM)(9626,"The foreground color for a section header or active title.")),.7),(0,at.EM)(9627,"The foreground color for a section header or hovered title.")),(0,at.Fg)("settings.modifiedItemIndicator",{light:new at.Ev(new at.Ov(102,175,224)),dark:new at.Ev(new at.Ov(12,125,157)),hcDark:new at.Ev(new at.Ov(0,73,122)),hcLight:new at.Ev(new at.Ov(102,175,224))},(0,at.EM)(9628,"The color of the modified setting indicator.")),(0,at.Fg)("settings.headerBorder",dt.It,(0,at.EM)(9629,"The color of the header container border."));var Jp=(0,at.Fg)("settings.sashBorder",dt.It,(0,at.EM)(9630,"The color of the Settings editor splitview sash border."));(0,at.Fg)("settings.dropdownBackground",at.Qm,(0,at.EM)(9631,"Settings editor dropdown background.")),(0,at.Fg)("settings.dropdownForeground",at.eh,(0,at.EM)(9632,"Settings editor dropdown foreground.")),(0,at.Fg)("settings.dropdownBorder",at.$m,(0,at.EM)(9633,"Settings editor dropdown border.")),(0,at.Fg)("settings.dropdownListBorder",at.Xh,(0,at.EM)(9634,"Settings editor dropdown list border. This surrounds the options and separates the options from the description.")),(0,at.Fg)("settings.checkboxBackground",at.Rm,(0,at.EM)(9635,"Settings editor checkbox background.")),(0,at.Fg)("settings.checkboxForeground",at.Bm,(0,at.EM)(9636,"Settings editor checkbox foreground.")),(0,at.Fg)("settings.checkboxBorder",at.zm,(0,at.EM)(9637,"Settings editor checkbox border.")),(0,at.Fg)("settings.textInputBackground",at.Gm,(0,at.EM)(9638,"Settings editor text input box background.")),(0,at.Fg)("settings.textInputForeground",at.qm,(0,at.EM)(9639,"Settings editor text input box foreground.")),(0,at.Fg)("settings.textInputBorder",at.Km,(0,at.EM)(9640,"Settings editor text input box border.")),(0,at.Fg)("settings.numberInputBackground",at.Gm,(0,at.EM)(9641,"Settings editor number input box background.")),(0,at.Fg)("settings.numberInputForeground",at.qm,(0,at.EM)(9642,"Settings editor number input box foreground.")),(0,at.Fg)("settings.numberInputBorder",at.Km,(0,at.EM)(9643,"Settings editor number input box border.")),(0,at.Fg)("settings.focusedRowBackground",{dark:(0,at.Ig)(at.jm,.6),light:(0,at.Ig)(at.jm,.6),hcDark:null,hcLight:null},(0,at.EM)(9644,"The background color of a settings row when focused.")),(0,at.Fg)("settings.rowHoverBackground",{dark:(0,at.Ig)(at.jm,.3),light:(0,at.Ig)(at.jm,.3),hcDark:null,hcLight:null},(0,at.EM)(9645,"The background color of a settings row when hovered.")),(0,at.Fg)("settings.focusedRowBorder",at.hg,(0,at.EM)(9646,"The color of the row's top and bottom border when the row is focused.")),(0,at.Xb)(),(0,at.oS)(),(0,at.Oc)(),(0,at.cr)(),(0,at.Kb)(),(0,at.pO)(),(0,at.wj)(),(0,at.WC)(),(0,at.qS)(),(0,at.rA)(),(0,at.GM)(),(0,at.Cy)(),(0,at.TM)(),(0,at.Tb)(),(0,at.i_)(),(0,at.Ol)(),(0,at.ox)(),(0,at.Ii)(),(0,ut.Ti)(),(0,ut.ki)(),(0,at.EC)(),(0,at.bC)(),(0,at.fC)(),(0,at.sC)();var Gp=class extends vp{constructor(e,t,i,o,s){super(i,t,s),this.inputNumber=e,this.otherInputNumber=1===this.inputNumber?2:1,this.modifiedBaseRangeGutterItemInfos=(0,at.wC)({debugName:"input".concat(this.inputNumber,".modifiedBaseRangeGutterItemInfos")},e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=this.inputNumber,s=t.showNonConflictingChanges.read(e);return i.modifiedBaseRanges.read(e).filter(t=>t.getInputDiffs(this.inputNumber).length>0&&(s||t.isConflicting||!i.isHandled(t).read(e))).map((e,i)=>new Np(i.toString(),e,o,t))}),this.decorations=(0,at.wC)({debugName:"input".concat(this.inputNumber,".decorations")},e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=(1===this.inputNumber?i.input1:i.input2).textModel,s=t.activeModifiedBaseRange.read(e),r=[],n=t.showNonConflictingChanges.read(e),a=this.showDeletionMarkers.read(e),d=!(void 0!==t.baseCodeEditorView.read(e)&&t.baseShowDiffAgainst.read(e)===this.inputNumber)&&this.useSimplifiedDecorations.read(e);for(let l of i.modifiedBaseRanges.read(e)){let t=l.getInputRange(this.inputNumber);if(!t)continue;let c=["merge-editor-block"],h=[0,0,0,0],u=i.isInputHandled(l,this.inputNumber).read(e);u&&c.push("handled"),l===s&&(c.push("focused"),h=[0,2,0,2]),l.isConflicting&&c.push("conflicting");let g=1===this.inputNumber?"input i1":"input i2";if(c.push(g),(l.isConflicting||n||!u)&&(d&&!u&&c.push("use-simplified-decorations"),r.push({range:t.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:c.join(" "),blockPadding:h,blockIsAfterEnd:t.startLineNumber>o.getLineCount(),description:"Merge Editor",minimap:{position:at.hy.Gutter,color:{id:u?gp:pp}},overviewRuler:l.isConflicting?{position:at.vy.Center,color:{id:u?gp:pp}}:void 0}}),!d&&(l.isConflicting||!i.isHandled(l).read(e)))){let e=l.getInputDiffs(this.inputNumber);for(let t of e){let e=t.outputRange.toInclusiveRange();if(e&&r.push({range:e,options:{className:"merge-editor-diff ".concat(g),description:"Merge Editor",isWholeLine:!0}}),t.rangeMappings)for(let i of t.rangeMappings)(a||!i.outputRange.isEmpty())&&r.push({range:i.outputRange,options:{className:i.outputRange.isEmpty()?"merge-editor-diff-empty-word ".concat(g):"merge-editor-diff-word ".concat(g),description:"Merge Editor",showIfCollapsed:!0}})}}}return r}),this.htmlElements.root.classList.add("input"),this._register(new bp(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(e,t)=>this.checkboxesVisible.read(t)?this.modifiedBaseRangeGutterItemInfos.read(t):[],createView:(e,t)=>new Kp(e,t,o)})),this._register(Cp(this,(e,t)=>t.model.translateBaseRangeToInput(this.inputNumber,e))),this._register(i.createInstance(wp,1===e?at.xb.MergeInput1Toolbar:at.xb.MergeInput2Toolbar,this.htmlElements.toolbar)),this._register((0,at.vC)({debugName:"input".concat(this.inputNumber,": update labels & text model")},e=>{let t=this.viewModel.read(e);if(!t)return;this.editor.setModel(1===this.inputNumber?t.model.input1.textModel:t.model.input2.textModel);let i=1===this.inputNumber?t.model.input1.title||(0,at.EM)(8655,"Input 1"):t.model.input2.title||(0,at.EM)(8656,"Input 2"),o=1===this.inputNumber?t.model.input1.description:t.model.input2.description,s=1===this.inputNumber?t.model.input1.detail:t.model.input2.detail;(0,at.jS)(this.htmlElements.title,...(0,at.Ac)(i)),(0,at.jS)(this.htmlElements.description,...o?(0,at.Ac)(o):[]),(0,at.jS)(this.htmlElements.detail,...s?(0,at.Ac)(s):[])})),this._register((0,ut.Di)(this.editor,this.decorations))}};Gp=(0,at.Jb)([(0,at.Yb)(2,at.rx),(0,at.Yb)(3,at.El),(0,at.Yb)(4,at.r_)],Gp);var Np=class{constructor(e,t,i,o){this.id=e,this.baseRange=t,this.inputNumber=i,this.viewModel=o,this.model=this.viewModel.model,this.range=this.baseRange.getInputRange(this.inputNumber),this.enabled=this.model.isUpToDate,this.toggleState=(0,at.xC)(this,e=>{let t=this.model.getState(this.baseRange).read(e).getInput(this.inputNumber);return t!==ut.Si.second||this.baseRange.isOrderRelevant?t:ut.Si.first}),this.state=(0,at.xC)(this,e=>{let t=this.viewModel.activeModifiedBaseRange.read(e);return this.model.hasBaseRange(this.baseRange)?{handled:this.model.isHandled(this.baseRange).read(e),focused:this.baseRange===t}:{handled:!1,focused:!1}})}setState(e,t){this.viewModel.setState(this.baseRange,this.model.getState(this.baseRange).get().withInputValue(this.inputNumber,e),t,this.inputNumber)}toggleBothSides(){(0,at.mC)(e=>{let t=this.model.getState(this.baseRange).get();this.model.setState(this.baseRange,t.toggle(this.inputNumber).toggle(1===this.inputNumber?2:1),!0,e)})}getContextMenuActions(){let e=this.model.getState(this.baseRange).get(),t=this.model.isHandled(this.baseRange).get(),i=e=>{(0,at.mC)(t=>this.viewModel.setState(this.baseRange,e,t,this.inputNumber))};function o(e,t,o,s){let r=new at.Hb(e,t,void 0,!0,()=>{i(o)});return r.checked=s,r}let s=e.includesInput1&&e.includesInput2;return[this.baseRange.input1Diffs.length>0?o("mergeEditor.acceptInput1",(0,at.EM)(8657,"Accept {0}",this.model.input1.title),e.toggle(1),e.includesInput1):void 0,this.baseRange.input2Diffs.length>0?o("mergeEditor.acceptInput2",(0,at.EM)(8657,"Accept {0}",this.model.input2.title),e.toggle(2),e.includesInput2):void 0,this.baseRange.isConflicting?(0,ut.ji)(o("mergeEditor.acceptBoth",(0,at.EM)(8658,"Accept Both"),e.withInputValue(1,!s).withInputValue(2,!s),s),{enabled:this.baseRange.canBeCombined}):void 0,new at.Wb,this.baseRange.isConflicting?(0,ut.ji)(o("mergeEditor.swap",(0,at.EM)(8659,"Swap"),e.swap(),!1),{enabled:!e.kind&&(!s||this.baseRange.isOrderRelevant)}):void 0,(0,ut.ji)(new at.Hb("mergeEditor.markAsHandled",(0,at.EM)(8660,"Mark as Handled"),void 0,!0,()=>{(0,at.mC)(e=>{this.model.setHandled(this.baseRange,!t,e)})}),{checked:t})].filter(at.qM)}},Kp=class extends at.mj{constructor(e,t,i){super(),this.isMultiLine=(0,at.cC)(this,!1),this.item=(0,at.cC)(this,e);let o=new at.sr((0,rt.A)({isChecked:!1,title:"",icon:at.fO.check},at.Pi));o.domNode.classList.add("accept-conflict-group"),this._register((0,at.Sx)(o.domNode,at._x.MOUSE_DOWN,e=>{let t=this.item.get();t&&(2===e.button?(e.stopPropagation(),e.preventDefault(),i.showContextMenu({getAnchor:()=>o.domNode,getActions:()=>t.getContextMenuActions()})):1===e.button&&(e.stopPropagation(),e.preventDefault(),t.toggleBothSides()))})),this._register((0,at.hC)(e=>{let t=this.item.read(e),i=t.toggleState.read(e),s={[ut.Si.excluded]:{icon:void 0,checked:!1,title:(0,at.EM)(8661,"Accept")},[ut.Si.unrecognized]:{icon:at.fO.circleFilled,checked:!1,title:(0,at.EM)(8662,"Accept (result is dirty)")},[ut.Si.first]:{icon:at.fO.check,checked:!0,title:(0,at.EM)(8663,"Undo accept")},[ut.Si.second]:{icon:at.fO.checkAll,checked:!0,title:(0,at.EM)(8664,"Undo accept (currently second)")}}[i];o.setIcon(s.icon),o.checked=s.checked,o.setTitle(s.title),t.enabled.read(e)?o.enable():o.disable()})),this._register((0,at.hC)(e=>{let i=this.item.read(e).state.read(e);t.className=["merge-accept-gutter-marker",i.handled&&"handled",i.focused&&"focused",this.isMultiLine.read(e)?"multi-line":"single-line"].filter(e=>"string"==typeof e).join(" ")})),this._register(o.onChange(()=>{(0,at.mC)(e=>{this.item.get().setState(o.checked,e)})})),t.appendChild((0,at.iS)("div.background",["\xa0"]).root),t.appendChild(this.checkboxDiv=(0,at.iS)("div.checkbox",[(0,at.iS)("div.checkbox-background",[o.domNode])]).root)}layout(e,t,i,o){let s=this.checkboxDiv.clientHeight,r=e+(t/2-s/2),n=[s,i+o-s-s],a=[e+s,e+t-s-s];a[0]<a[1]&&(r=(0,at.UC)(r,n[0],n[1]),r=(0,at.UC)(r,a[0],a[1])),this.checkboxDiv.style.top="".concat(r-e,"px"),(0,at.mC)(e=>{this.isMultiLine.set(t>30,e)})}update(e){(0,at.mC)(t=>{this.item.set(e,t)})}};(0,at.Xb)(),(0,at.oS)(),(0,at.Ur)(),(0,at.Oc)(),(0,at.AN)(),(0,at.aP)(),(0,at.wj)(),(0,at.qS)(),(0,at.Cy)(),(0,at.TM)(),(0,at.Tb)(),(0,at.i_)(),(0,at.Pb)(),(0,at.ox)(),(0,at.Ua)(),(0,ut.Ui)(),(0,ut.ki)(),(0,ut.xi)(),(0,at.EC)(),(0,at.bC)();var Zp,Bp,Pp=class extends vp{constructor(e,t,i,o){super(t,e,o),this._labelService=i,this.decorations=(0,at.xC)(this,e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=i.resultTextModel,s=[],r=(0,ut.Ai)(i.modifiedBaseRanges.read(e),i.baseResultDiffs.read(e),(e,t)=>e.baseRange.intersectsOrTouches(t.inputRange)?at.dN.neitherLessOrGreaterThan:ut.Hi.compareByStart(e.baseRange,t.inputRange)),n=t.activeModifiedBaseRange.read(e),a=t.showNonConflictingChanges.read(e);for(let d of r){let t=d.left;if(t){let r=["merge-editor-block"],d=[0,0,0,0],l=i.isHandled(t).read(e);if(l&&r.push("handled"),t===n&&(r.push("focused"),d=[0,2,0,2]),t.isConflicting&&r.push("conflicting"),r.push("result"),!t.isConflicting&&!a&&l)continue;let c=i.getLineRangeInResult(t.baseRange,e);s.push({range:c.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:r.join(" "),blockPadding:d,blockIsAfterEnd:c.startLineNumber>o.getLineCount(),description:"Result Diff",minimap:{position:at.hy.Gutter,color:{id:l?gp:pp}},overviewRuler:t.isConflicting?{position:at.vy.Center,color:{id:l?gp:pp}}:void 0}})}if(!t||t.isConflicting)for(let e of d.rights){let t=e.outputRange.toInclusiveRange();if(t&&s.push({range:t,options:{className:"merge-editor-diff result",description:"Merge Editor",isWholeLine:!0}}),e.rangeMappings)for(let i of e.rangeMappings)s.push({range:i.outputRange,options:{className:"merge-editor-diff-word result",description:"Merge Editor"}})}}return s}),this.editor.invokeWithinContext(e=>{let t=e.get(at.Nb),i=ut.mi.bindTo(t);i.set(!0),this._register((0,at.kj)(()=>i.reset()))}),this.htmlElements.gutterDiv.style.width="5px",this.htmlElements.root.classList.add("result"),this._register((0,at.yC)((e,t)=>{this.checkboxesVisible.read(e)&&t.add(new bp(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(e,t)=>[],createView:(e,t)=>{throw new at.qN}}))})),this._register((0,at.hC)(e=>{let t=this.viewModel.read(e);t&&(this.editor.setModel(t.model.resultTextModel),(0,at.jS)(this.htmlElements.title,...(0,at.Ac)((0,at.EM)(8665,"Result"))),(0,at.jS)(this.htmlElements.description,...(0,at.Ac)(this._labelService.getUriLabel(t.model.resultTextModel.uri,{relative:!0}))))}));let s=this._register(new at.Vr(this.htmlElements.detail));this._register((0,at.hC)(e=>{let t=this.viewModel.read(e);if(!t)return;let i=t.model;if(!i)return;let o=i.unhandledConflictsCount.read(e),r=1===o?(0,at.EM)(8666,"{0} Conflict Remaining",o):(0,at.EM)(8667,"{0} Conflicts Remaining ",o);s.clear(),s.push({class:void 0,enabled:o>0,id:"nextConflict",label:r,run(){t.model.telemetry.reportConflictCounterClicked(),t.goToNextModifiedBaseRange(e=>!i.isHandled(e).get())},tooltip:o>0?(0,at.EM)(8668,"Go to next conflict"):(0,at.EM)(8669,"All conflicts handled, the merge can be completed now.")})})),this._register((0,ut.Di)(this.editor,this.decorations)),this._register(Cp(this,(e,t)=>t.model.translateBaseRangeToResult(e))),this._register(t.createInstance(wp,at.xb.MergeInputResultToolbar,this.htmlElements.toolbar))}};Pp=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,at.Ha),(0,at.Yb)(3,at.r_)],Pp),(0,at.vE)(),(0,at.Xb)(),(0,at.oS)(),(0,at.Xt)(),(0,at.kv)(),(0,at.aP)(),(0,at.sj)(),(0,at.wj)(),(0,at.qS)(),(0,at.dT)(),(0,at.GM)(),(0,at.nx)(),(0,at.iv)(),(0,at.pv)(),(0,at.TM)(),(0,at.Pb)(),(0,at.ps)(),(0,at.ox)(),(0,at.Vo)(),(0,at.Lo)(),(0,at.yb)(),(0,at.Xd)(),(0,bt.en)(),(0,ht.h)(),(0,gt.bn)(),(0,ut.di)(),(0,ut.ki)(),(0,ut.xi)(),(0,bt.G)(),(0,dt.a)(),(0,dt.V)(),(0,bt.At)(),(0,at.tn)(),(0,at.sC)(),(0,at.fC)(),(0,at.bC)(),(0,at.bE)({});var Fp=(Qe=class extends yo{get viewModel(){return this._viewModel}get inputModel(){return this._inputModel}get model(){var e;return null===(e=this.inputModel.get())||void 0===e?void 0:e.model}constructor(e,t,i,o,s,r,n,a,d,l,c){var h;super(Zp.ID,e,o,t,s,n,r,a,d,l),this.contextKeyService=i,this._codeEditorService=c,this._sessionDisposables=new at.gj,this._viewModel=(0,at.cC)(this,void 0),this._grid=this._register(new at.vj),this.input1View=this._register(this.instantiationService.createInstance(Gp,1,this._viewModel)),this.baseView=(0,at.cC)(this,void 0),this.baseViewOptions=(0,at.cC)(this,void 0),this.input2View=this._register(this.instantiationService.createInstance(Gp,2,this._viewModel)),this.inputResultView=this._register(this.instantiationService.createInstance(Pp,this._viewModel)),this._layoutMode=this.instantiationService.createInstance(Yp),this._layoutModeObs=(0,at.cC)(this,this._layoutMode.value),this._ctxIsMergeEditor=ut.pi.bindTo(this.contextKeyService),this._ctxUsesColumnLayout=ut.gi.bindTo(this.contextKeyService),this._ctxShowBase=ut._i.bindTo(this.contextKeyService),this._ctxShowBaseAtTop=ut.vi.bindTo(this.contextKeyService),this._ctxResultUri=ut.bi.bindTo(this.contextKeyService),this._ctxBaseUri=ut.hi.bindTo(this.contextKeyService),this._ctxShowNonConflictingChanges=ut.yi.bindTo(this.contextKeyService),this._inputModel=(0,at.cC)(this,void 0),this.viewZoneComputer=new Mp(this.input1View.editor,this.input2View.editor,this.inputResultView.editor),this.scrollSynchronizer=this._register(new fp(this._viewModel,this.input1View,this.input2View,this.baseView,this.inputResultView,this._layoutModeObs)),this._onDidChangeSizeConstraints=new at.ej,this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this.baseViewDisposables=this._register(new at.gj),this.showNonConflictingChangesStore=this.instantiationService.createInstance(ut.Ei,"mergeEditor/showNonConflictingChanges"),this.showNonConflictingChanges=(0,at.cC)(this,null!==(h=this.showNonConflictingChangesStore.get())&&void 0!==h&&h)}dispose(){this._sessionDisposables.dispose(),this._ctxIsMergeEditor.reset(),this._ctxUsesColumnLayout.reset(),this._ctxShowNonConflictingChanges.reset(),super.dispose()}get minimumWidth(){return"mixed"===this._layoutMode.value.kind?this.input1View.view.minimumWidth+this.input2View.view.minimumWidth:this.input1View.view.minimumWidth+this.input2View.view.minimumWidth+this.inputResultView.view.minimumWidth}getTitle(){return this.input?this.input.getName():(0,at.EM)(8670,"Text Merge Editor")}createEditorControl(e,t){this.rootHtmlElement=e,e.classList.add("merge-editor"),this.applyLayout(this._layoutMode.value),this.applyOptions(t)}updateEditorControlOptions(e){this.applyOptions(e)}applyOptions(e){let t=(0,ut.Oi)(e,{minimap:{enabled:!1},glyphMargin:!1,lineNumbersMinChars:2}),i=(0,ut.Oi)(t,{readOnly:!0,readOnlyMessage:void 0});this.input1View.updateOptions(i),this.input2View.updateOptions(i),this.baseViewOptions.set((0,rt.A)({},this.input2View.editor.getRawOptions()),void 0),this.inputResultView.updateOptions(t)}getMainControl(){return this.inputResultView.editor}layout(e){var t;null===(t=this._grid.value)||void 0===t||t.layout(e.width,e.height)}async setInput(e,t,i,o){if(!(e instanceof ut.li))throw new at.qN("ONLY MergeEditorInput is supported");await super.setInput(e,t,i,o),this._sessionDisposables.clear(),(0,at.mC)(e=>{this._viewModel.set(void 0,e),this._inputModel.set(void 0,e)});let s=await e.resolve(),r=s.model,n=this.instantiationService.createInstance(Sp,r,this.input1View,this.input2View,this.inputResultView,this.baseView,this.showNonConflictingChanges);r.telemetry.reportMergeEditorOpened({combinableConflictCount:r.combinableConflictCount,conflictCount:r.conflictCount,baseTop:this._layoutModeObs.get().showBaseAtTop,baseVisible:this._layoutModeObs.get().showBase,isColumnView:"columns"===this._layoutModeObs.get().kind}),(0,at.mC)(e=>{this._viewModel.set(n,e),this._inputModel.set(s,e)}),this._sessionDisposables.add(n),this._sessionDisposables.add((0,at.hC)(t=>{let i=n.focusedEditorType.read(t);e instanceof ut.li&&e.updateFocusedEditor(i||"result")})),this._ctxResultUri.set(s.resultUri.toString()),this._ctxBaseUri.set(r.base.uri.toString()),this._sessionDisposables.add((0,at.kj)(()=>{this._ctxBaseUri.reset(),this._ctxResultUri.reset()}));let a=new at.gj;this._sessionDisposables.add(a),this._sessionDisposables.add((0,at.yC)(e=>{let t=this.baseView.read(e),i=this.inputResultView.editor.getScrollTop();this.scrollSynchronizer.stopSync(),a.clear(),this.inputResultView.editor.changeViewZones(i=>{let o=this._layoutModeObs.read(e),s="columns"===o.kind,r="mixed"===o.kind&&!o.showBaseAtTop;this.input1View.editor.changeViewZones(o=>{this.input2View.editor.changeViewZones(d=>{t?t.editor.changeViewZones(l=>{a.add(this.setViewZones(e,n,this.input1View.editor,o,this.input2View.editor,d,t.editor,l,r,this.inputResultView.editor,i,s))}):a.add(this.setViewZones(e,n,this.input1View.editor,o,this.input2View.editor,d,void 0,void 0,!1,this.inputResultView.editor,i,s))})})}),this.inputResultView.editor.setScrollTop(i,at.rv.Smooth),this.scrollSynchronizer.startSync(),this.scrollSynchronizer.updateScrolling()}));let d=this.loadEditorViewState(e,i);d?this._applyViewState(d):this._sessionDisposables.add((0,at.Oj)(r.onInitialized,()=>{let e=r.modifiedBaseRanges.get().find(e=>e.isConflicting);e&&(this.input1View.editor.revealLineInCenter(e.input1Range.startLineNumber),(0,at.mC)(t=>{n.setActiveModifiedBaseRange(e,t)}))}));let l=e=>{var t;let i=(0,gt.xn)(e,this._codeEditorService);(0,gt.Sn)(r.input2.textModel,i,this._codeEditorService),(0,gt.Sn)(r.input1.textModel,i,this._codeEditorService),(0,gt.Sn)(r.resultTextModel,i,this._codeEditorService);let o=null===(t=this.baseView.get())||void 0===t?void 0:t.editor.getModel();o&&(0,gt.Sn)(o,i,this._codeEditorService)};this._sessionDisposables.add(this._codeEditorService.onDidChangeTransientModelProperty(e=>{l(e)})),l(this.inputResultView.editor.getModel());let c=this;this._sessionDisposables.add(new class{constructor(){this._disposable=new at.gj;for(let e of this.baseInput1Input2())this._disposable.add(e.onDidChangeContent(()=>this._checkBaseInput1Input2AllEmpty()))}dispose(){this._disposable.dispose()}*baseInput1Input2(){yield r.base,yield r.input1.textModel,yield r.input2.textModel}_checkBaseInput1Input2AllEmpty(){for(let e of this.baseInput1Input2())if(e.getValueLength()>0)return;c.editorService.replaceEditors([{editor:e,replacement:{resource:e.result,options:{preserveFocus:!0}},forceReplaceDirty:!0}],c.group)}})}setViewZones(e,t,i,o,s,r,n,a,d,l,c,h){let u=[],g=[],p=[],b=[],m=this.viewZoneComputer.computeViewZones(e,t,{codeLensesVisible:!0,showNonConflictingChanges:this.showNonConflictingChanges.read(e),shouldAlignBase:d,shouldAlignResult:h}),v=new at.gj;if(a)for(let C of m.baseViewZones)C.create(a,p,v);for(let C of m.resultViewZones)C.create(c,b,v);for(let C of m.input1ViewZones)C.create(o,u,v);for(let C of m.input2ViewZones)C.create(r,g,v);return v.add({dispose:()=>{i.changeViewZones(e=>{for(let t of u)e.removeZone(t)}),s.changeViewZones(e=>{for(let t of g)e.removeZone(t)}),null!==n&&void 0!==n&&n.changeViewZones(e=>{for(let t of p)e.removeZone(t)}),l.changeViewZones(e=>{for(let t of b)e.removeZone(t)})}}),v}setOptions(e){super.setOptions(e),e&&(0,ht.m)(e,this.inputResultView.editor,at.rv.Smooth)}clearInput(){super.clearInput(),this._sessionDisposables.clear();for(let{editor:e}of[this.input1View,this.input2View,this.inputResultView])e.setModel(null)}focus(){var e;super.focus(),(null!==(e=this.getControl())&&void 0!==e?e:this.inputResultView.editor).focus()}hasFocus(){for(let{editor:e}of[this.input1View,this.input2View,this.inputResultView])if(e.hasTextFocus())return!0;return super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e);for(let{editor:t}of[this.input1View,this.input2View,this.inputResultView])e?t.onVisible():t.onHide();this._ctxIsMergeEditor.set(e)}getControl(){return this.inputResultView.editor}get scopedContextKeyService(){var e;return null===(e=this.getControl())||void 0===e?void 0:e.invokeWithinContext(e=>e.get(at.Nb))}toggleBase(){this.setLayout((0,rt.A)((0,rt.A)({},this._layoutMode.value),{},{showBase:!this._layoutMode.value.showBase}))}toggleShowBaseTop(){let e=this._layoutMode.value.showBase&&this._layoutMode.value.showBaseAtTop;this.setLayout((0,rt.A)((0,rt.A)({},this._layoutMode.value),{},{showBaseAtTop:!0,showBase:!e}))}toggleShowBaseCenter(){let e=this._layoutMode.value.showBase&&!this._layoutMode.value.showBaseAtTop;this.setLayout((0,rt.A)((0,rt.A)({},this._layoutMode.value),{},{showBaseAtTop:!1,showBase:!e}))}setLayoutKind(e){this.setLayout((0,rt.A)((0,rt.A)({},this._layoutMode.value),{},{kind:e}))}setLayout(e){var t;let i=this._layoutMode.value;JSON.stringify(i)!==JSON.stringify(e)&&(null!==(t=this.model)&&void 0!==t&&t.telemetry.reportLayoutChange({baseTop:e.showBaseAtTop,baseVisible:e.showBase,isColumnView:"columns"===e.kind}),this.applyLayout(e))}applyLayout(e){(0,at.mC)(t=>{if(e.showBase&&!this.baseView.get()){this.baseViewDisposables.clear();let e=this.baseViewDisposables.add(this.instantiationService.createInstance(yp,this.viewModel));this.baseViewDisposables.add((0,at.hC)(t=>{let i=this.baseViewOptions.read(t);i&&e.updateOptions(i)})),this.baseView.set(e,t)}else!e.showBase&&this.baseView.get()&&(this.baseView.set(void 0,t),this.baseViewDisposables.clear());"mixed"===e.kind?this.setGrid([e.showBaseAtTop&&e.showBase?{size:38,data:this.baseView.get().view}:void 0,{size:38,groups:[{data:this.input1View.view},!e.showBaseAtTop&&e.showBase?{data:this.baseView.get().view}:void 0,{data:this.input2View.view}].filter(at.qM)},{size:62,data:this.inputResultView.view}].filter(at.qM)):"columns"===e.kind&&this.setGrid([e.showBase?{size:40,data:this.baseView.get().view}:void 0,{size:60,groups:[{data:this.input1View.view},{data:this.inputResultView.view},{data:this.input2View.view}]}].filter(at.qM)),this._layoutMode.value=e,this._ctxUsesColumnLayout.set(e.kind),this._ctxShowBase.set(e.showBase),this._ctxShowBaseAtTop.set(e.showBaseAtTop),this._onDidChangeSizeConstraints.fire(),this._layoutModeObs.set(e,t)})}setGrid(e){var t;let i=-1,o=-1;this._grid.value&&(i=this._grid.value.width,o=this._grid.value.height),this._grid.value=ii.from({orientation:at.Zt.VERTICAL,size:100,groups:e},{styles:{separatorBorder:null!==(t=this.theme.getColor(Jp))&&void 0!==t?t:at.Ev.transparent},proportionalLayout:!0}),(0,at.jS)(this.rootHtmlElement,this._grid.value.element),-1!==i&&this._grid.value.layout(i,o)}_applyViewState(e){e&&(this.inputResultView.editor.restoreViewState(e),e.input1State&&this.input1View.editor.restoreViewState(e.input1State),e.input2State&&this.input2View.editor.restoreViewState(e.input2State),e.focusIndex>=0&&[this.input1View.editor,this.input2View.editor,this.inputResultView.editor][e.focusIndex].focus())}computeEditorViewState(e){var t,i,o;if(!(0,at.pT)(null===(t=this.inputModel.get())||void 0===t?void 0:t.resultUri,e))return;let s=this.inputResultView.editor.saveViewState();if(!s)return;let r=null!==(i=this.input1View.editor.saveViewState())&&void 0!==i?i:void 0,n=null!==(o=this.input2View.editor.saveViewState())&&void 0!==o?o:void 0,a=[this.input1View.editor,this.input2View.editor,this.inputResultView.editor].findIndex(e=>e.hasWidgetFocus());return(0,rt.A)((0,rt.A)({},s),{},{input1State:r,input2State:n,focusIndex:a})}tracksEditorViewState(e){return e instanceof ut.li}toggleShowNonConflictingChanges(){this.showNonConflictingChanges.set(!this.showNonConflictingChanges.get(),void 0),this.showNonConflictingChangesStore.set(this.showNonConflictingChanges.get()),this._ctxShowNonConflictingChanges.set(this.showNonConflictingChanges.get())}},{_:Zp=Qe},{_:Qe.ID="mergeEditor"},Qe);Fp=Zp=(0,at.Jb)([(0,at.Yb)(1,at.rx),(0,at.Yb)(2,at.Nb),(0,at.Yb)(3,at.vb),(0,at.Yb)(4,at.Io),(0,at.Yb)(5,at.Yd),(0,at.Yb)(6,at.dv),(0,at.Yb)(7,bt.kt),(0,at.Yb)(8,bt.W),(0,at.Yb)(9,at.fs),(0,at.Yb)(10,at.tx)],Fp);var Yp=(Xe=class{constructor(e){this._storageService=e,this._value={kind:"mixed",showBase:!1,showBaseAtTop:!0};let t=e.get(Bp._key,at.Ro.PROFILE,"mixed");if("mixed"===t||"columns"===t)this._value={kind:t,showBase:!1,showBaseAtTop:!0};else if(t)try{this._value=JSON.parse(t)}catch(e){(0,at.sP)(e)}}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._storageService.store(Bp._key,JSON.stringify(this._value),at.Ro.PROFILE,at.zo.USER))}},{_:Bp=Xe},{_:Xe._key="mergeEditor/layout"},Xe);Yp=Bp=(0,at.Jb)([(0,at.Yb)(0,at.Io)],Yp);var Qp=class extends at.mj{constructor(e,t){super(),this._editorService=e,this._store.add(t.registerCodeEditorOpenHandler(this.openCodeEditorFromMergeEditor.bind(this)))}async openCodeEditorFromMergeEditor(e,t,i){let o=this._editorService.activeEditorPane;if(!i&&e.options&&o instanceof Fp&&o.getControl()&&o.input instanceof ut.li&&(0,at.pT)(e.resource,o.input.result)){let t=o.getControl();return(0,ht.m)(e.options,t,at.rv.Smooth),t}return null}};Qp=(0,at.Jb)([(0,at.Yb)(0,bt.kt),(0,at.Yb)(1,at.tx)],Qp);var Xp=(He=class extends at.mj{constructor(e,t){super(),this._register(e.registerEditor("*",{id:bt.Ft.id,label:bt.Ft.displayName,detail:bt.Ft.providerDisplayName,priority:dt.t.builtin},{},{createMergeEditorInput:e=>{var i,o,s,r;return{editor:t.createInstance(ut.li,e.base.resource,{uri:e.input1.resource,title:null!==(i=e.input1.label)&&void 0!==i?i:(0,at.iT)(e.input1.resource),description:null!==(o=e.input1.description)&&void 0!==o?o:"",detail:e.input1.detail},{uri:e.input2.resource,title:null!==(s=e.input2.label)&&void 0!==s?s:(0,at.iT)(e.input2.resource),description:null!==(r=e.input2.description)&&void 0!==r?r:"",detail:e.input2.detail},e.result.resource)}}}))}},{_:He.ID="workbench.contrib.mergeEditorResolver"},He);Xp=(0,at.Jb)([(0,at.Yb)(0,dt.B),(0,at.Yb)(1,at.rx)],Xp),(0,at.pO)(),(0,at.dT)(),(0,at.SO)(),(0,at.TM)(),(0,at.Tb)(),(0,at.Pk)(),(0,at.Vl)(),(0,at.hl)(),(0,at.Vo)(),(0,at.Lo)(),(0,ut.di)(),(0,ut.xi)(),(0,bt.At)(),(0,at.qS)(),(0,ut.Ti)(),(0,at.QO)(),(0,at.Ab)(),(0,at.fC)();var Hp,Up=class extends at.bb{constructor(e){super(e)}run(e){let{activeEditorPane:t}=e.get(bt.kt);if(t instanceof Fp){let i=t.viewModel.get();if(!i)return;this.runWithViewModel(i,e)}}},jp=class extends at.bb{constructor(e){super(e)}run(e){let{activeEditorPane:t}=e.get(bt.kt);if(t instanceof Fp){let r=t.viewModel.get();for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return r?this.runWithMergeEditor({viewModel:r,inputModel:t.inputModel.get(),input:t.input,editorIdentifier:{editor:t.input,groupId:t.group.id}},e,...o):void 0}}},zp=class extends at.bb{constructor(){super({id:"_open.mergeEditor",title:(0,at.DM)(8541,"Open Merge Editor")})}run(e){let t=Hp.validate(arguments.length<=1?void 0:arguments[1]),i={base:{resource:t.base},input1:{resource:t.input1.uri,label:t.input1.title,description:t.input1.description,detail:t.input1.detail},input2:{resource:t.input2.uri,label:t.input2.title,description:t.input2.description,detail:t.input2.detail},result:{resource:t.output},options:{preserveFocus:!0}};e.get(bt.kt).openEditor(i)}};!function(e){function t(e){if("string"==typeof e)return new ut.ui(at.xO.parse(e,!0),void 0,void 0,void 0);if(!e||"object"!=typeof e)throw TypeError("invalid argument");if(function(e){if(!e||"object"!=typeof e)return!1;let t=e;return"string"==typeof t.scheme&&"string"==typeof t.authority&&"string"==typeof t.path&&"string"==typeof t.query&&"string"==typeof t.fragment}(e))return new ut.ui(at.xO.revive(e),void 0,void 0,void 0);let t=e,o=t.title,s=i(t.uri),r=t.detail,n=t.description;return new ut.ui(s,o,r,n)}function i(e){if("string"==typeof e)return at.xO.parse(e,!0);if(e&&"object"==typeof e)return at.xO.revive(e);throw TypeError("invalid argument")}e.validate=function(e){if(!e||"object"!=typeof e)throw TypeError("invalid argument");let o=e,s=i(o.base),r=i(o.output);return{base:s,input1:t(o.input1),input2:t(o.input2),output:r}}}(Hp||(Hp={}));var qp=class extends at.bb{constructor(){super({id:"merge.mixedLayout",title:(0,at.DM)(8542,"Mixed Layout"),toggled:ut.gi.isEqualTo("mixed"),menu:[{id:at.xb.EditorTitle,when:ut.pi,group:"1_merge",order:9}],precondition:ut.pi})}run(e){let{activeEditorPane:t}=e.get(bt.kt);t instanceof Fp&&t.setLayoutKind("mixed")}},$p=class extends at.bb{constructor(){super({id:"merge.columnLayout",title:(0,at.DM)(8543,"Column Layout"),toggled:ut.gi.isEqualTo("columns"),menu:[{id:at.xb.EditorTitle,when:ut.pi,group:"1_merge",order:10}],precondition:ut.pi})}run(e){let{activeEditorPane:t}=e.get(bt.kt);t instanceof Fp&&t.setLayoutKind("columns")}},eb=class extends at.bb{constructor(){super({id:"merge.showNonConflictingChanges",title:(0,at.DM)(8544,"Show Non-Conflicting Changes"),toggled:ut.yi.isEqualTo(!0),menu:[{id:at.xb.EditorTitle,when:ut.pi,group:"3_merge",order:9}],precondition:ut.pi})}run(e){let{activeEditorPane:t}=e.get(bt.kt);t instanceof Fp&&t.toggleShowNonConflictingChanges()}},tb=class extends at.bb{constructor(){super({id:"merge.showBase",title:(0,at.DM)(8545,"Show Base"),toggled:ut._i.isEqualTo(!0),menu:[{id:at.xb.EditorTitle,when:at.Mk.and(ut.pi,ut.gi.isEqualTo("columns")),group:"2_merge",order:9}]})}run(e){let{activeEditorPane:t}=e.get(bt.kt);t instanceof Fp&&t.toggleBase()}},ib=class extends at.bb{constructor(){super({id:"merge.showBaseTop",title:(0,at.DM)(8546,"Show Base Top"),toggled:at.Mk.and(ut._i,ut.vi),menu:[{id:at.xb.EditorTitle,when:at.Mk.and(ut.pi,ut.gi.isEqualTo("mixed")),group:"2_merge",order:10}]})}run(e){let{activeEditorPane:t}=e.get(bt.kt);t instanceof Fp&&t.toggleShowBaseTop()}},ob=class extends at.bb{constructor(){super({id:"merge.showBaseCenter",title:(0,at.DM)(8547,"Show Base Center"),toggled:at.Mk.and(ut._i,ut.vi.negate()),menu:[{id:at.xb.EditorTitle,when:at.Mk.and(ut.pi,ut.gi.isEqualTo("mixed")),group:"2_merge",order:11}]})}run(e){let{activeEditorPane:t}=e.get(bt.kt);t instanceof Fp&&t.toggleShowBaseCenter()}},sb=(0,at.DM)(8548,"Merge Editor");async function rb(e,t,i){t.openEditor(t.activeEditor,{pinned:!0});let o=e.model.base,s=1===i?e.inputCodeEditorView1.editor:e.inputCodeEditorView2.editor,r=s.getPosition().lineNumber;await t.openEditor({original:{resource:o.uri},modified:{resource:s.getModel().uri},options:{selection:{startLineNumber:r,startColumn:1},revealIfOpened:!0,revealIfVisible:!0}})}var nb=class extends at.bb{constructor(){super({id:"mergeEditor.resetCloseWithConflictsChoice",category:sb,title:(0,at.DM)(8562,"Reset Choice for 'Close with Conflicts'"),f1:!0})}run(e){e.get(at.Io).remove(ut.fi,at.Ro.PROFILE)}};(0,at.iw)(),(0,at.pO)(),(0,at.SO)(),(0,at.ev)(),(0,at.TM)(),(0,at.Tb)(),(0,at.S)(),(0,at.Vl)(),(0,at.ps)(),(0,at.Fd)(),(0,at.dc)(),(0,ut.xi)(),(0,bt.At)();var ab=(0,at.DM)(8569,"Merge Editor (Dev)"),db=class extends at.bb{constructor(){super({id:"merge.dev.copyContentsJson",category:ab,title:(0,at.DM)(8570,"Copy Merge Editor State as JSON"),icon:at.fO.layoutCentered,f1:!0,precondition:ut.pi})}run(e){let{activeEditorPane:t}=e.get(bt.kt),i=e.get(at.x),o=e.get(at.Pd);if(!(t instanceof Fp))return void o.info({name:(0,at.EM)(8571,"Merge Editor"),message:(0,at.EM)(8572,"No active merge editor")});let s=t.model;if(!s)return;let r={languageId:s.resultTextModel.getLanguageId(),base:s.base.getValue(),input1:s.input1.textModel.getValue(),input2:s.input2.textModel.getValue(),result:s.resultTextModel.getValue(),initialResult:s.getInitialResultValue()},n=JSON.stringify(r,void 0,4);i.writeText(n),o.info({name:(0,at.EM)(8571,"Merge Editor"),message:(0,at.EM)(8573,"Successfully copied merge editor state")})}},lb=class extends at.bb{constructor(){super({id:"merge.dev.saveContentsToFolder",category:ab,title:(0,at.DM)(8574,"Save Merge Editor State to Folder"),icon:at.fO.layoutCentered,f1:!0,precondition:ut.pi})}async run(e){let{activeEditorPane:t}=e.get(bt.kt),i=e.get(at.Pd),o=e.get(at.Bl),s=e.get(at.fs),r=e.get(at.$_);if(!(t instanceof Fp))return void i.info({name:(0,at.EM)(8571,"Merge Editor"),message:(0,at.EM)(8572,"No active merge editor")});let n=t.model;if(!n)return;let a=await o.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:(0,at.EM)(8575,"Select folder to save to")});if(!a)return;let d=a[0],l=r.getExtensions(n.resultTextModel.getLanguageId())[0]||"";async function c(e,t){await s.writeFile(at.xO.joinPath(d,e+l),at.XC.fromString(t),{})}await Promise.all([c("base",n.base.getValue()),c("input1",n.input1.textModel.getValue()),c("input2",n.input2.textModel.getValue()),c("result",n.resultTextModel.getValue()),c("initialResult",n.getInitialResultValue())]),i.info({name:(0,at.EM)(8571,"Merge Editor"),message:(0,at.EM)(8576,"Successfully saved merge editor state to folder")})}},cb=class extends at.bb{constructor(){super({id:"merge.dev.loadContentsFromFolder",category:ab,title:(0,at.DM)(8577,"Load Merge Editor State from Folder"),icon:at.fO.layoutCentered,f1:!0})}async run(e,t){let i,o=e.get(at.Bl),s=e.get(bt.kt),r=e.get(at.fs),n=e.get(at.uc);if(t||(t={}),t.folderUri)i=t.folderUri;else{let e=await o.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:(0,at.EM)(8575,"Select folder to save to")});if(!e)return;i=e[0]}let a=await r.resolve(i);function d(e){var t;return null===(t=a.children.find(t=>t.name.startsWith(e)))||void 0===t?void 0:t.resource}let l=await async function(e,t){var i;return t?"initial"===t:null===(i=await e.pick([{label:"result",result:!1},{label:"initial result",result:!0}],{canPickMany:!1}))||void 0===i?void 0:i.result}(n,t.resultState),c={base:{resource:d("base")},input1:{resource:d("input1"),label:"Input 1",description:"Input 1",detail:"(from file)"},input2:{resource:d("input2"),label:"Input 2",description:"Input 2",detail:"(from file)"},result:{resource:d(l?"initialResult":"result")}};s.openEditor(c)}};(0,at.aP)(),(0,at.jc)(),(0,ut.di)();(0,at.nx)(),(0,at.TM)(),(0,ut.eg)(),(0,at.Pk)(),(0,ut.Xh)();(0,at.TM)(),(0,at.Tb)(),(0,at.A_)(),(0,at.Zp)(),(0,at.Mb)(),(0,gt.f)(),(0,bt.b)(),(0,bt.en)(),(0,ut.di)(),(0,bt.L)(),(0,gt.En)(),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(Fp,Fp.ID,(0,at.EM)(8578,"Merge Editor")),[new at.Xp(ut.li)]),at.jb.as(bt.Rt.EditorFactory).registerEditorSerializer(ut.li.ID,class{canSerialize(){return!0}serialize(e){return JSON.stringify(this.toJSON(e))}toJSON(e){return{base:e.base,input1:e.input1,input2:e.input2,result:e.result}}deserialize(e,t){try{let i=(0,at.Mc)(t);return e.createInstance(ut.li,i.base,new ut.ui(i.input1.uri,i.input1.title,i.input1.detail,i.input1.description),new ut.ui(i.input2.uri,i.input2.title,i.input2.detail,i.input2.description),i.result)}catch(e){return void(0,at.sP)(e)}}}),at.jb.as(at.b_.Configuration).registerConfiguration({properties:{"mergeEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:"advanced",markdownEnumDescriptions:[(0,at.EM)(8579,"Uses the legacy diffing algorithm."),(0,at.EM)(8580,"Uses the advanced diffing algorithm.")]},"mergeEditor.showDeletionMarkers":{type:"boolean",default:!0,description:"Controls if deletions in base or one of the inputs should be indicated by a vertical bar."}}}),(0,at.Db)(class extends Up{constructor(){super({id:"merge.openResult",icon:at.fO.goToFile,title:(0,at.DM)(8549,"Open File"),category:sb,menu:[{id:at.xb.EditorTitle,when:ut.pi,group:"navigation",order:1}],precondition:ut.pi})}runWithViewModel(e,t){t.get(bt.kt).openEditor({resource:e.model.resultTextModel.uri})}}),(0,at.Db)(qp),(0,at.Db)($p),(0,at.Db)(zp),(0,at.Db)(class extends Up{constructor(){super({id:"merge.openBaseEditor",category:sb,title:(0,at.DM)(8557,"Open Base File"),f1:!0,precondition:ut.pi})}runWithViewModel(e,t){t.get(at.ml).open(e.model.base.uri)}}),(0,at.Db)(eb),(0,at.Db)(tb),(0,at.Db)(ib),(0,at.Db)(ob),(0,at.Db)(class extends Up{constructor(){super({id:"merge.goToNextUnhandledConflict",category:sb,title:(0,at.DM)(8550,"Go to Next Unhandled Conflict"),icon:at.fO.arrowDown,menu:[{id:at.xb.EditorTitle,when:ut.pi,group:"navigation",order:3}],f1:!0,precondition:ut.pi})}runWithViewModel(e){e.model.telemetry.reportNavigationToNextConflict(),e.goToNextModifiedBaseRange(t=>!e.model.isHandled(t).get())}}),(0,at.Db)(class extends Up{constructor(){super({id:"merge.goToPreviousUnhandledConflict",category:sb,title:(0,at.DM)(8551,"Go to Previous Unhandled Conflict"),icon:at.fO.arrowUp,menu:[{id:at.xb.EditorTitle,when:ut.pi,group:"navigation",order:2}],f1:!0,precondition:ut.pi})}runWithViewModel(e){e.model.telemetry.reportNavigationToPreviousConflict(),e.goToPreviousModifiedBaseRange(t=>!e.model.isHandled(t).get())}}),(0,at.Db)(class extends Up{constructor(){super({id:"merge.toggleActiveConflictInput1",category:sb,title:(0,at.DM)(8552,"Toggle Current Conflict from Left"),f1:!0,precondition:ut.pi})}runWithViewModel(e){e.toggleActiveConflict(1)}}),(0,at.Db)(class extends Up{constructor(){super({id:"merge.toggleActiveConflictInput2",category:sb,title:(0,at.DM)(8553,"Toggle Current Conflict from Right"),f1:!0,precondition:ut.pi})}runWithViewModel(e){e.toggleActiveConflict(2)}}),(0,at.Db)(class extends Up{constructor(){super({id:"mergeEditor.compareInput1WithBase",category:sb,title:(0,at.DM)(8554,"Compare Input 1 With Base"),shortTitle:(0,at.EM)(8555,"Compare With Base"),f1:!0,precondition:ut.pi,menu:{id:at.xb.MergeInput1Toolbar,group:"primary"},icon:at.fO.compareChanges})}runWithViewModel(e,t){rb(e,t.get(bt.kt),1)}}),(0,at.Db)(class extends Up{constructor(){super({id:"mergeEditor.compareInput2WithBase",category:sb,title:(0,at.DM)(8556,"Compare Input 2 With Base"),shortTitle:(0,at.EM)(8555,"Compare With Base"),f1:!0,precondition:ut.pi,menu:{id:at.xb.MergeInput2Toolbar,group:"primary"},icon:at.fO.compareChanges})}runWithViewModel(e,t){rb(e,t.get(bt.kt),2)}}),(0,at.Db)(class extends Up{constructor(){super({id:"merge.acceptAllInput1",category:sb,title:(0,at.DM)(8558,"Accept All Incoming Changes from Left"),f1:!0,precondition:ut.pi,menu:{id:at.xb.MergeInput1Toolbar,group:"primary"},icon:at.fO.checkAll})}runWithViewModel(e){e.acceptAll(1)}}),(0,at.Db)(class extends Up{constructor(){super({id:"merge.acceptAllInput2",category:sb,title:(0,at.DM)(8559,"Accept All Current Changes from Right"),f1:!0,precondition:ut.pi,menu:{id:at.xb.MergeInput2Toolbar,group:"primary"},icon:at.fO.checkAll})}runWithViewModel(e){e.acceptAll(2)}}),(0,at.Db)(class extends Up{constructor(){super({id:"mergeEditor.resetResultToBaseAndAutoMerge",category:sb,title:(0,at.DM)(8560,"Reset Result"),shortTitle:(0,at.EM)(8561,"Reset"),f1:!0,precondition:ut.pi,menu:{id:at.xb.MergeInputResultToolbar,group:"primary"},icon:at.fO.discard})}runWithViewModel(e,t){e.model.reset()}}),(0,at.Db)(class extends jp{constructor(){super({id:"mergeEditor.acceptMerge",category:sb,title:(0,at.DM)(8564,"Complete Merge"),f1:!0,precondition:ut.pi,keybinding:[{primary:at.JO.CtrlCmd|at.KO.Enter,weight:at.Ob.EditorContrib,when:ut.pi}]})}async runWithMergeEditor(e,t){let{inputModel:i,editorIdentifier:o,viewModel:s}=e,r=t.get(at.zl),n=t.get(bt.kt);if(s.model.unhandledConflictsCount.get()>0){let{confirmed:e}=await r.confirm({message:(0,at.EM)(8565,"Do you want to complete the merge of {0}?",(0,at.iT)(i.resultUri)),detail:(0,at.EM)(8566,"The file contains unhandled conflicts."),primaryButton:(0,at.EM)(8567,"&&Complete with Conflicts")});if(!e)return{successful:!1}}return await i.accept(),await n.closeEditor(o),{successful:!0}}}),(0,at.Db)(nb),(0,at.Db)(class extends jp{constructor(){super({id:"mergeEditor.acceptAllCombination",category:sb,title:(0,at.DM)(8563,"Accept All Combination"),f1:!0})}runWithMergeEditor(e,t){let{viewModel:i}=e,o=i.model.modifiedBaseRanges.get(),s=i.model;return(0,at.mC)(e=>{for(let t of o){let o=s.getState(t).get();o.kind!==ut.wi.unrecognized&&!o.isInputIncluded(1)&&(!o.isInputIncluded(2)||!i.shouldUseAppendInsteadOfAccept.get())&&t.canBeCombined&&(s.setState(t,o.withInputValue(1,!0).withInputValue(2,!0,!0),!0,e),s.telemetry.reportSmartCombinationInvoked(o.includesInput(2)))}}),{success:!0}}}),(0,at.Db)(class extends jp{constructor(){super({id:"mergeEditor.toggleBetweenInputs",category:sb,title:(0,at.DM)(8568,"Toggle Between Merge Editor Inputs"),f1:!0,precondition:ut.pi,keybinding:[{primary:at.JO.CtrlCmd|at.JO.Shift|at.KO.KeyT,weight:at.Ob.WorkbenchContrib+10,when:ut.pi}]})}runWithMergeEditor(e,t){let{viewModel:i}=e;i.inputCodeEditorView1.editor.hasWidgetFocus()?i.inputCodeEditorView2.editor.focus():i.inputCodeEditorView1.editor.focus()}}),(0,at.Db)(db),(0,at.Db)(lb),(0,at.Db)(cb),at.jb.as(bt.v.Workbench).registerWorkbenchContribution(Qp,bt.M.Restored),(0,bt.x)(Xp.ID,Xp,bt.y.BlockStartup),gt.Tn.register(new class{constructor(){this.name="mergeEditor",this.type=ut.$h.Help,this.priority=125,this.when=at.jk.create("isMergeEditor",!0)}getProvider(e){let t=e.get(at.tx),i=t.getActiveCodeEditor()||t.getFocusedCodeEditor();if(!i)return;let o=[(0,at.EM)(8581,"You are in a merge editor."),(0,at.EM)(8582,"Navigate between merge conflicts using the commands Go to Next Unhandled Conflict{0} and Go to Previous Unhandled Conflict{1}.","<keybinding:merge.goToNextUnhandledConflict>","<keybinding:merge.goToPreviousUnhandledConflict>"),(0,at.EM)(8583,"Run the command Merge Editor: Accept All Incoming Changes from the Left{0} and Merge Editor: Accept All Current Changes from the Right{1}","<keybinding:merge.acceptAllInput1>","<keybinding:merge.acceptAllInput2>"),(0,at.EM)(8584,"Complete the Merge{0}.","<keybinding:mergeEditor.acceptMerge>"),(0,at.EM)(8585,"Toggle between merge editor inputs, incoming and current changes {0}.","<keybinding:mergeEditor.toggleBetweenInputs>")];return new ut.Zh(ut.Qh.MergeEditor,{type:ut.$h.Help},()=>o.join("\n"),()=>i.focus(),ut.qh.MergeEditor)}}),(0,at.oS)(),(0,at.ob)(),(0,gt.mn)(),(0,at.TM)(),(0,at.Tb)(),(0,at.Pk)(),(0,ut.lv)(),(0,ut.Zi)(),(0,bt.At)();function hb(e,t){null===e||void 0===e||e.addImplementation(100,"webview",e=>{var i;let o=e.get(ut.cv).activeWebview;if(null!==o&&void 0!==o&&o.isFocused)return t(o),!0;if(null!==(i=(0,at.zx)())&&void 0!==i&&i.classList.contains("action-menu-item")){let i=e.get(bt.kt);if(i.activeEditor instanceof ut.Xi)return t(i.activeEditor.webview),!0}return!1})}hb(at.ab,e=>e.undo()),hb(at.rb,e=>e.redo()),hb(at.ib,e=>e.selectAll()),hb(gt.dn,e=>e.copy()),hb(gt.pn,e=>e.paste()),hb(gt.fn,e=>e.cut());var ub="preventDefaultContextMenuItems";gt.fn&&at.Cb.appendMenuItem(at.xb.WebviewContext,{command:{id:gt.fn.id,title:(0,at.EM)(12511,"Cut")},group:"5_cutcopypaste",order:1,when:at.Mk.not(ub)}),gt.dn&&at.Cb.appendMenuItem(at.xb.WebviewContext,{command:{id:gt.dn.id,title:(0,at.EM)(12512,"Copy")},group:"5_cutcopypaste",order:2,when:at.Mk.not(ub)}),gt.pn&&at.Cb.appendMenuItem(at.xb.WebviewContext,{command:{id:gt.pn.id,title:(0,at.EM)(12513,"Paste")},group:"5_cutcopypaste",order:3,when:at.Mk.not(ub)}),(0,at.Xb)(),(0,at.wj)(),(0,at.Wd)(),(0,lt.o)(),(0,bt.At)(),(0,mt.n)(),(0,at.Mb)(),(0,bt.b)(),(0,bt.L)(),(0,at.TM)(),(0,ut.xS)(),(0,ut.op)();var gb=(0,at.EM)(8015,"Configure"),pb=class extends at.mj{constructor(e,t){super();let i=[new bb,new mb].map(e=>new vb(t,e));i.forEach(e=>this._register(e));let o,s=()=>{let t=e.activeTextEditorControl;if(t===o)return;o=t;let s=(0,lt.i)(t);i.forEach(e=>e.onActiveEditorChanged(s))};this._register(e.onDidActiveEditorChange(s)),s()}};pb=(0,at.Jb)([(0,at.Yb)(0,bt.kt),(0,at.Yb)(1,mt.t)],pb);var bb=class{constructor(){this.id="decoratorsLimitInfo",this.name=(0,at.EM)(8016,"Color Decorator Status"),this.label=(0,at.EM)(8017,"Color decorators"),this.source=(0,at.EM)(8018,"Color Decorators"),this.settingsId="editor.colorDecoratorsLimit"}getLimitReporter(e){var t;return null===(t=ut.ap.get(e))||void 0===t?void 0:t.limitReporter}},mb=class{constructor(){this.id="foldingLimitInfo",this.name=(0,at.EM)(8019,"Folding Status"),this.label=(0,at.EM)(8020,"Folding ranges"),this.source=(0,at.EM)(8021,"Folding"),this.settingsId="editor.foldingMaximumRegions"}getLimitReporter(e){var t;return null===(t=ut.bS.get(e))||void 0===t?void 0:t.limitReporter}},vb=class{constructor(e,t){this.languageStatusService=e,this.accessor=t}onActiveEditorChanged(e){let t;return this._indicatorChangeListener&&(this._indicatorChangeListener=void this._indicatorChangeListener.dispose()),e&&(t=this.accessor.getLimitReporter(e)),this.updateStatusItem(t),!!t&&(this._indicatorChangeListener=t.onDidChange(e=>{this.updateStatusItem(t)}),!0)}updateStatusItem(e){if(this._limitStatusItem&&(this._limitStatusItem=void this._limitStatusItem.dispose()),e&&!1!==e.limited){let t={id:this.accessor.id,selector:"*",name:this.accessor.name,severity:at.Ud.Warning,label:this.accessor.label,detail:(0,at.EM)(8022,"only {0} shown for performance reasons",e.limited),command:{id:"workbench.action.openSettings",arguments:[this.accessor.settingsId],title:gb},accessibilityInfo:void 0,source:this.accessor.source,busy:!1};this._limitStatusItem=this.languageStatusService.addStatus(t)}}dispose(){this._limitStatusItem=void 0,this._indicatorChangeListener=void 0}};at.jb.as(bt.v.Workbench).registerWorkbenchContribution(pb,bt.M.Restored),(0,at.Xb)(),(0,at.WC)(),(0,at.tn)(),(0,at.sj)(),(0,at.wj)(),(0,at.i_)(),(0,at.Ul)();var Cb=class{constructor(e,t){this.configurationService=e,this.layoutService=t,this.disposables=new at.gj,at.tj.filter(e.onDidChangeConfiguration,e=>e.affectsConfiguration("workbench.sash.size"))(this.onDidChangeSize,this,this.disposables),this.onDidChangeSize(),at.tj.filter(e.onDidChangeConfiguration,e=>e.affectsConfiguration("workbench.sash.hoverDelay"))(this.onDidChangeHoverDelay,this,this.disposables),this.onDidChangeHoverDelay()}onDidChangeSize(){let e=this.configurationService.getValue("workbench.sash.size"),t=(0,at.UC)(e,4,20),i=(0,at.UC)(e,1,8);this.layoutService.mainContainer.style.setProperty("--vscode-sash-size",t+"px"),this.layoutService.mainContainer.style.setProperty("--vscode-sash-hover-size",i+"px"),(0,at.rn)(t)}onDidChangeHoverDelay(){(0,at.nn)(this.configurationService.getValue("workbench.sash.hoverDelay"))}dispose(){this.disposables.dispose()}};Cb=(0,at.Jb)([(0,at.Yb)(0,at.r_),(0,at.Yb)(1,at.Hl)],Cb),(0,at.TM)(),(0,at.A_)(),(0,bt.L)(),(0,at.Mb)(),(0,dt.O)(),(0,bt.b)(),(0,at.iM)(),at.jb.as(bt.v.Workbench).registerWorkbenchContribution(Cb,bt.M.Restored),at.jb.as(at.b_.Configuration).registerConfiguration((0,rt.A)((0,rt.A)({},dt.j),{},{properties:{"workbench.sash.size":{type:"number",default:at.uM?20:4,minimum:1,maximum:20,description:(0,at.EM)(9889,"Controls the feedback area size in pixels of the dragging area in between views/editors. Set it to a larger value if you feel it's hard to resize views using the mouse.")},"workbench.sash.hoverDelay":{type:"number",default:300,minimum:0,maximum:2e3,description:(0,at.EM)(9890,"Controls the hover feedback delay in milliseconds of the dragging area in between views/editors.")}}})),(0,at.Ww)(),(0,at.LA)(),(0,at.TM)(),(0,at.Pk)(),new at.Nk("inPreferencesSearch",!1),new at.Nk("inSettingsEditor",!1),new at.Nk("inSettingsJSONEditor",!1),new at.Nk("inSettingsSearch",!1),new at.Nk("settingsTocRowFocus",!1),new at.Nk("settingRowFocus",!1),new at.Nk("inKeybindings",!1),new at.Nk("inKeybindingsSearch",!1),new at.Nk("keybindingFocus",!1),new at.Nk("whenFocus",!1),new at.Nk("aiSettingResultsAvailable",!1);var wb,yb="workbench.action.openKeyboardLayoutPicker";(function(e){e.ShowAISearchToggle="workbench.settings.showAISearchToggle",e.EnableNaturalLanguageSearch="workbench.settings.enableNaturalLanguageSearch"})(wb||(wb={})),(0,at.EM)(9619,"Preview setting: this setting controls a new feature that is still under refinement yet ready to use. Feedback is welcome."),(0,at.EM)(9620,"Experimental setting: this setting controls a new feature that is actively being developed and may be unstable. It is subject to change or removal.");var fb=new Set;["css","html","scss","less","json","js","ts","ie","id","php","scm"].forEach(e=>fb.add(e));var Sb=new Map;Sb.set("power shell","PowerShell"),Sb.set("powershell","PowerShell"),Sb.set("javascript","JavaScript"),Sb.set("typescript","TypeScript"),Sb.set("github","GitHub"),Sb.set("jet brains","JetBrains"),Sb.set("jetbrains","JetBrains"),Sb.set("re sharper","ReSharper"),Sb.set("resharper","ReSharper"),(0,at.Xb)(),(0,at.TM)(),(0,ut.kb)(),(0,ut.Tb)(),(0,at.wj)(),(0,gt.ar)(),(0,bt.b)(),(0,at.iM)(),(0,at.dc)(),(0,at.Tb)(),(0,at.i_)(),(0,at.Il)(),(0,at.ps)(),(0,bt.At)(),(0,at.iw)();var Eb=(Ue=class extends at.mj{constructor(e,t){super(),this.keyboardLayoutService=e,this.statusbarService=t,this.pickerElement=this._register(new at.vj);let i=(0,at.EM)(9357,"Keyboard Layout"),o=this.keyboardLayoutService.getCurrentKeyboardLayout();if(o){let e=(0,at.EM)(9358,"Layout: {0}",qn(o).label);this.pickerElement.value=this.statusbarService.addEntry({name:i,text:e,ariaLabel:e,command:yb},"status.workbench.keyboardLayout",ut.Db.RIGHT)}this._register(this.keyboardLayoutService.onDidChangeKeyboardLayout(()=>{let e=qn(this.keyboardLayoutService.getCurrentKeyboardLayout());if(this.pickerElement.value){let t=(0,at.EM)(9358,"Layout: {0}",e.label);this.pickerElement.value.update({name:i,text:t,ariaLabel:t,command:yb})}else{let t=(0,at.EM)(9358,"Layout: {0}",e.label);this.pickerElement.value=this.statusbarService.addEntry({name:i,text:t,ariaLabel:t,command:yb},"status.workbench.keyboardLayout",ut.Db.RIGHT)}}))}},{_:Ue.ID="workbench.contrib.keyboardLayoutPicker"},Ue);Eb=(0,at.Jb)([(0,at.Yb)(0,gt.ir),(0,at.Yb)(1,ut.wb)],Eb),(0,bt.x)(Eb.ID,Eb,bt.y.BlockStartup);var kb=["// ".concat((0,at.EM)(9359,"Defines the keyboard layout used in VS Code in the browser environment.")),"// ".concat((0,at.EM)(9360,'Open VS Code and run "Developer: Inspect Key Mappings (JSON)" from Command Palette.')),"","// Once you have the keyboard layout info, please paste it below.","\n"].join("\n");(0,at.Db)(class extends at.bb{constructor(){super({id:yb,title:(0,at.DM)(9361,"Change Keyboard Layout"),f1:!0})}async run(e){let t=e.get(gt.ir),i=e.get(at.uc),o=e.get(at.r_),s=e.get(at.Fl),r=e.get(bt.kt),n=e.get(at.fs),a=t.getAllKeyboardLayouts(),d=t.getCurrentKeyboardLayout(),l="autodetect"===o.getValue("keyboard.layout"),c=a.map(e=>{let t=!l&&zn(d,e),i=qn(e);return{layout:e,label:[i.label,e&&e.isUserKeyboardLayout?"(User configured layout)":""].join(" "),id:e.text||e.lang||e.layout,description:i.description+(t?" (Current layout)":""),picked:!l&&zn(d,e)}}).sort((e,t)=>e.label<t.label?-1:e.label>t.label?1:0);if(c.length>0){let e=at.pM?"Mac":at.yM?"Win":"Linux";c.unshift({type:"separator",label:(0,at.EM)(9362,"Keyboard Layouts ({0})",e)})}let h={label:(0,at.EM)(9363,"Configure Keyboard Layout")};c.unshift(h);let u={label:(0,at.EM)(9364,"Auto Detect"),description:l?"Current: ".concat(qn(d).label):void 0,picked:!!l||void 0};c.unshift(u);let g=await i.pick(c,{placeHolder:(0,at.EM)(9365,"Select Keyboard Layout"),matchOnDescription:!0});if(g){if(g===u)return void o.updateValue("keyboard.layout","autodetect");if(g===h){let e=s.keyboardLayoutResource;return await n.stat(e).then(void 0,()=>n.createFile(e,at.XC.fromString(kb))).then(e=>{if(e)return r.openEditor({resource:e.resource,languageId:"jsonc",options:{pinned:!0}})},t=>{throw Error((0,at.EM)(9366,"Unable to create '{0}' ({1}).",e.toString(),t))}),Promise.resolve()}o.updateValue("keyboard.layout",$n(g.layout))}}}),(0,at.Xb)(),(0,at.TM)(),(0,at.wj)(),(0,gt.ut)(),(0,gt.Gn)(),(0,bt.C)(),(0,bt.l)(),(0,bt.V)();var _b=(je=class extends at.mj{constructor(e,t,i){super(),this.activityService=e,this.workingCopyService=t,this.filesConfigurationService=i,this.badgeHandle=this._register(new at.vj),this.lastKnownDirtyCount=0,this.updateActivityBadge(),this.registerListeners()}registerListeners(){this._register(this.workingCopyService.onDidChangeDirty(e=>this.onWorkingCopyDidChangeDirty(e)))}onWorkingCopyDidChangeDirty(e){let t=e.isDirty();t&&!(e.capabilities&bt.c.Untitled)&&this.filesConfigurationService.hasShortAutoSaveDelay(e.resource)||(t||this.lastKnownDirtyCount>0)&&this.updateActivityBadge()}updateActivityBadge(){let e=this.lastKnownDirtyCount=this.workingCopyService.dirtyCount;e>0?this.badgeHandle.value=this.activityService.showViewContainerActivity(ft.c,{badge:new gt.ct(e,t=>1===t?(0,at.EM)(7755,"1 unsaved file"):(0,at.EM)(7756,"{0} unsaved files",e))}):this.badgeHandle.clear()}},{_:je.ID="workbench.contrib.dirtyFilesIndicator"},je);_b=(0,at.Jb)([(0,at.Yb)(0,gt.Wn),(0,at.Yb)(1,bt.S),(0,at.Yb)(2,bt.B)],_b),(0,at.Xb)(),(0,at.TM)(),(0,at.yb)(),(0,at.Xd)(),(0,at.Lo)(),(0,at.jr)(),(0,dt.a)(),(0,dt.V)(),(0,bt.en)(),(0,bt.it)();var Ib,xb=(ze=class extends og{constructor(e,t,i,o,s){super(Ib.ID,e,{openInternal:(e,t)=>this.openInternal(e,t)},t,i,s),this.editorResolverService=o}async openInternal(e,t){if(e instanceof Et.n&&this.group.activeEditor){var i,o,s,r;let n=this.group.activeEditor,a=null===n||void 0===n?void 0:n.toUntyped();if(!a)return;let d=await this.editorResolverService.resolveEditor((0,rt.A)((0,rt.A)({},a),{},{options:(0,rt.A)((0,rt.A)({},t),{},{override:at.Or.PICK})}),this.group);if(d===dt.n.NONE)d=void 0;else if(d===dt.n.ABORT)return;if((0,bt.in)(d))for(let e of d.editor instanceof bt.nt?[d.editor.original,d.editor.modified]:[d.editor])e instanceof Et.n&&(e.setForceOpenAsText(),e.setPreferredLanguageId(ft.n));await this.group.replaceEditors([{editor:n,replacement:null!==(i=null===(o=d)||void 0===o?void 0:o.editor)&&void 0!==i?i:e,options:(0,rt.A)({},null!==(s=null===(r=d)||void 0===r?void 0:r.options)&&void 0!==s?s:t)}])}}getTitle(){return this.input?this.input.getName():(0,at.EM)(7389,"Binary File Viewer")}},{_:Ib=ze},{_:ze.ID=ft.t},ze);xb=Ib=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.Yd),(0,at.Yb)(3,dt.B),(0,at.Yb)(4,at.Io)],xb),(0,at.Xb)(),(0,at.wj)(),(0,at.SO)(),(0,ht.d)(),(0,at.dT)(),(0,bt.l)(),(0,ut.gg)(),(0,at.ps)();var Ab=(qe=class extends at.mj{constructor(e,t,i){super(),this.textEditorService=t,this.fileService=i,this._register(e.registerHandler(this))}handles(e){return""===e.typeId&&this.fileService.canHandleResource(e.resource)}handlesSync(e){return""===e.typeId&&this.fileService.hasProvider(e.resource)}isOpen(e,t){return!!this.handlesSync(e)&&(0,at.pT)(e.resource,t.resource)}createEditor(e){return this.textEditorService.createTextEditor({resource:e.resource,forceFile:!0})}},{_:qe.ID="workbench.contrib.fileEditorWorkingCopyEditorHandler"},qe);Ab=(0,at.Jb)([(0,at.Yb)(0,ut.hg),(0,at.Yb)(1,ht.u),(0,at.Yb)(2,at.fs)],Ab),(0,at.Xb)(),(0,at.TM)(),(0,at.cc)(),(0,at.GM)(),(0,bt.j)(),(0,at.Kb)(),(0,bt.h)(),(0,bt.D)(),(0,bt.en)(),(0,ht.h)(),(0,at.Qs)(),(0,at.ps)(),(0,at.yb)(),(0,at.Ma)(),(0,at.Lo)(),(0,at.pv)(),(0,at.ox)(),(0,at.Xd)(),(0,at.iv)(),(0,bt.At)(),(0,bt.G)(),(0,at.jr)(),(0,at.Go)(),(0,gt.Zn)(),(0,pt.kt)(),(0,ut.xf)(),(0,at.i_)(),(0,Ct.i)(),(0,dt.z)(),(0,bt.V)();var Vb,Db=($e=class extends $u{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C){super(Vb.ID,e,t,s,n,a,l,d,c,i),this.paneCompositeService=o,this.contextService=r,this.textFileService=h,this.explorerService=u,this.uriIdentityService=g,this.pathService=p,this.configurationService=b,this.preferencesService=m,this.hostService=v,this.filesConfigurationService=C,this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidRunOperation(e)))}onDidFilesChange(e){for(let t of e.rawDeleted)this.clearEditorViewState(t)}onDidRunOperation(e){e.operation===at.Es.MOVE&&e.target&&this.moveEditorViewState(e.resource,e.target.resource,this.uriIdentityService.extUri)}getTitle(){return this.input?this.input.getName():(0,at.EM)(7390,"Text File Editor")}get input(){return this._input}async setInput(e,t,i,o){(0,at.lc)("code/willSetInputToTextFileEditor"),await super.setInput(e,t,i,o);try{let s=await e.resolve(t);if(o.isCancellationRequested)return;if(s instanceof Et.r)return this.openAsBinary(e,t);let r=s,n=(0,at.UM)(this.editorControl);if(n.setModel(r.textEditorModel),!(0,bt.hn)(null===t||void 0===t?void 0:t.viewState)){let o=this.loadEditorViewState(e,i);o&&(null!==t&&void 0!==t&&t.selection&&(o.cursorState=[]),n.restoreViewState(o))}t&&(0,ht.m)(t,n,at.rv.Immediate),n.updateOptions(this.getReadonlyConfiguration(r.isReadonly())),n.handleInitialized&&n.handleInitialized()}catch(i){await this.handleSetInputError(i,e,t)}(0,at.lc)("code/didSetInputToTextFileEditor")}async handleSetInputError(e,t,i){if(e.textFileOperationResult===bt.p.FILE_IS_BINARY)return this.openAsBinary(t,i);if(e.fileOperationResult===at.ks.FILE_IS_DIRECTORY){let e=[];throw e.push((0,at.qb)({id:"workbench.files.action.openFolder",label:(0,at.EM)(7391,"Open Folder"),run:async()=>this.hostService.openWindow([{folderUri:t.resource}],{forceNewWindow:!0})})),this.contextService.isInsideWorkspace(t.preferredResource)&&e.push((0,at.qb)({id:"workbench.files.action.reveal",label:(0,at.EM)(7392,"Reveal Folder"),run:async()=>(await this.paneCompositeService.openPaneComposite(ft.c,ut.gf.Sidebar,!0),this.explorerService.select(t.preferredResource,!0))})),(0,bt.Zt)((0,at.EM)(7393,"The file is not displayed in the text editor because it is a directory."),e,{forceMessage:!0})}if(e.fileOperationResult===at.ks.FILE_TOO_LARGE){let o;throw o=e instanceof at.Ls?(0,at.EM)(7394,"The file is not displayed in the text editor because it is very large ({0}).",at.hs.formatSize(e.size)):(0,at.EM)(7395,"The file is not displayed in the text editor because it is very large."),(0,bt.Qt)(this.group,t,i,o,this.preferencesService)}throw e.fileOperationResult===at.ks.FILE_NOT_FOUND&&!this.filesConfigurationService.isReadonly(t.preferredResource)&&await this.pathService.hasValidBasename(t.preferredResource)?(0,bt.Zt)(new at.Ds((0,at.EM)(7396,"The editor could not be opened because the file was not found."),at.ks.FILE_NOT_FOUND),[(0,at.qb)({id:"workbench.files.action.createMissingFile",label:(0,at.EM)(7397,"Create File"),run:async()=>(await this.textFileService.create([{resource:t.preferredResource}]),this.editorService.openEditor({resource:t.preferredResource,options:{pinned:!0}}))})],{allowDialog:!0}):e}openAsBinary(e,t){let i=this.configurationService.getValue("workbench.editor.defaultBinaryEditor"),o=(0,rt.A)((0,rt.A)({},t),{},{activation:at.Er.PRESERVE});i&&""!==i&&i!==bt.Ft.id?this.doOpenAsBinaryInDifferentEditor(this.group,i,e,o):this.doOpenAsBinaryInSameEditor(this.group,i,e,o)}doOpenAsBinaryInDifferentEditor(e,t,i,o){this.editorService.replaceEditors([{editor:i,replacement:{resource:i.resource,options:(0,rt.A)((0,rt.A)({},o),{},{override:t})}}],e)}doOpenAsBinaryInSameEditor(e,t,i,o){t===bt.Ft.id?(i.setForceOpenAsText(),i.setPreferredLanguageId(ft.n),o=(0,rt.A)((0,rt.A)({},o),{},{forceReload:!0})):i.setForceOpenAsBinary(),e.openEditor(i,o)}clearInput(){var e;super.clearInput(),null===(e=this.editorControl)||void 0===e||e.setModel(null)}createEditorControl(e,t){(0,at.lc)("code/willCreateTextFileEditorControl"),super.createEditorControl(e,t),(0,at.lc)("code/didCreateTextFileEditorControl")}tracksEditorViewState(e){return e instanceof Et.n}tracksDisposedEditorViewState(){return!0}},{_:Vb=$e},{_:$e.ID=ft.o},$e);Db=Vb=(0,at.Jb)([(0,at.Yb)(1,at.vb),(0,at.Yb)(2,at.fs),(0,at.Yb)(3,pt.Ot),(0,at.Yb)(4,at.rx),(0,at.Yb)(5,at.ja),(0,at.Yb)(6,at.Io),(0,at.Yb)(7,at.dv),(0,at.Yb)(8,bt.kt),(0,at.Yb)(9,at.Yd),(0,at.Yb)(10,bt.W),(0,at.Yb)(11,bt.E),(0,at.Yb)(12,gt.Xn),(0,at.Yb)(13,at.Wo),(0,at.Yb)(14,bt.A),(0,at.Yb)(15,at.r_),(0,at.Yb)(16,Ct.r),(0,at.Yb)(17,dt.R),(0,at.Yb)(18,bt.B)],Db),(0,at.Xb)(),(0,bt.h)(),(0,bt.D)(),(0,bt.z)(),(0,at.wj)(),(0,at.AN)(),(0,dt.z)(),(0,bt.At)(),(0,at.Ww)(),(0,at.nx)(),(0,bt.V)(),(0,at.ET)(),(0,ut.gg)(),(0,bt.en)();var Mb=(et=class extends at.mj{constructor(e,t,i,o,s,r,n){super(),this.editorService=e,this.textFileService=t,this.lifecycleService=i,this.hostService=o,this.codeEditorService=s,this.filesConfigurationService=r,this.workingCopyEditorService=n,this.ensureDirtyFilesAreOpenedWorker=this._register(new at.jw(e=>this.ensureDirtyTextFilesAreOpened(e),this.getDirtyTextFileTrackerDelay())),this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.files.onDidSaveError(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.untitled.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.hostService.onDidChangeFocus(e=>e?this.reloadVisibleTextFileEditors():void 0)),this._register(this.lifecycleService.onDidShutdown(()=>this.dispose()))}getDirtyTextFileTrackerDelay(){return 800}ensureDirtyTextFilesAreOpened(e){this.doEnsureDirtyTextFilesAreOpened((0,at.wN)(e.filter(e=>{if(!this.textFileService.isDirty(e))return!1;let t=this.textFileService.files.get(e);if(null!==t&&void 0!==t&&t.hasState(bt.d.PENDING_SAVE)||e.scheme!==at.TT.untitled&&(null===t||void 0===t||!t.hasState(bt.d.ERROR))&&this.filesConfigurationService.hasShortAutoSaveDelay(e)||this.editorService.isOpened({resource:e,typeId:e.scheme===at.TT.untitled?Et.l.ID:"workbench.editors.files.fileEditorInput",editorId:bt.Ft.id}))return!1;let i=null!==t&&void 0!==t?t:this.textFileService.untitled.get(e);return!(i&&this.workingCopyEditorService.findEditor(i))}),e=>e.toString()))}doEnsureDirtyTextFilesAreOpened(e){e.length&&this.editorService.openEditors(e.map(e=>({resource:e,options:{inactive:!0,pinned:!0,preserveFocus:!0}})))}reloadVisibleTextFileEditors(){(0,at.wN)((0,at._N)(this.codeEditorService.listCodeEditors().map(e=>{var t;let i=null===(t=e.getModel())||void 0===t?void 0:t.uri;if(!i)return;let o=this.textFileService.files.get(i);return o&&!o.isDirty()&&o.isResolved()?o:void 0})),e=>e.resource.toString()).forEach(e=>this.textFileService.files.resolve(e.resource,{reload:{async:!0}}))}},{_:et.ID="workbench.contrib.textFileEditorTracker"},et);Mb=(0,at.Jb)([(0,at.Yb)(0,bt.kt),(0,at.Yb)(1,bt.E),(0,at.Yb)(2,bt.R),(0,at.Yb)(3,dt.R),(0,at.Yb)(4,at.tx),(0,at.Yb)(5,bt.B),(0,at.Yb)(6,ut.hg)],Mb),(0,at.Xb)(),(0,at.TM)(),(0,at.Ap)(),(0,at.dT)(),(0,at.Kb)(),(0,at.SO)(),(0,at.Qs)(),(0,bt.D)(),(0,at.ox)(),(0,at.wj)(),(0,at.Qb)(),(0,at.Hj)(),(0,bt.it)(),(0,at.Pk)(),(0,at.Pb)(),(0,ht.l)(),(0,at.Bd)(),(0,at.Fd)(),(0,at.hl)(),(0,at.Vo)(),(0,at.Lo)(),(0,pt.Gt)(),(0,at.sj)(),(0,bt.At)(),(0,at.iM)(),(0,at.ET)(),(0,Ct.i)(),(0,bt.en)(),(0,at.JC)(),(0,at.Wd)();var Tb="conflictResolution",Rb="learnMoreDirtyWriteError",Ob=(0,at.EM)(7398,"Use the actions in the editor tool bar to either undo your changes or overwrite the content of the file with your changes."),Wb=(tt=class extends at.mj{constructor(e,t,i,o,s,r,n){super(),this.notificationService=e,this.textFileService=t,this.editorService=o,this.instantiationService=r,this.storageService=n,this.messages=new at.Lj,this.activeConflictResolutionResource=void 0,this.conflictResolutionContext=new at.Nk("saveConflictResolutionContext",!1,!0).bindTo(i);let a=this._register(r.createInstance(ft.s));this._register(s.registerTextModelContentProvider(Tb,a)),this.textFileService.files.saveErrorHandler=this,this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidSave(e=>this.onFileSavedOrReverted(e.model.resource))),this._register(this.textFileService.files.onDidRevert(e=>this.onFileSavedOrReverted(e.resource))),this._register(this.editorService.onDidActiveEditorChange(()=>this.onActiveEditorChanged()))}onActiveEditorChanged(){var e;let t,i=!1,o=this.editorService.activeEditor;o instanceof bt.nt&&"conflictResolution"===(null===(e=o.original.resource)||void 0===e?void 0:e.scheme)&&(i=!0,t=o.modified.resource),this.conflictResolutionContext.set(i),this.activeConflictResolutionResource=t}onFileSavedOrReverted(e){let t=this.messages.get(e);t&&(t.close(),this.messages.delete(e))}onSaveError(e,t,i){let o,s=e,r=t.resource,n=[],a=[];if(s.fileOperationResult===at.ks.FILE_MODIFIED_SINCE)if(this.activeConflictResolutionResource&&(0,at.pT)(this.activeConflictResolutionResource,t.resource)){if(this.storageService.getBoolean(Rb,at.Ro.APPLICATION))return;o=Ob,n.push(this.instantiationService.createInstance(Jb)),a.push(this.instantiationService.createInstance(Gb))}else o=(0,at.EM)(7399,"Failed to save '{0}': The content of the file is newer. Please compare your version with the file contents or overwrite the content of the file with your changes.",(0,at.iT)(r)),n.push(this.instantiationService.createInstance(Nb,t)),n.push(this.instantiationService.createInstance(Yb,t,i)),a.push(this.instantiationService.createInstance(Qb));else{var d;let a=s.fileOperationResult===at.ks.FILE_WRITE_LOCKED,l=a&&(null===(d=s.options)||void 0===d?void 0:d.unlock),c=s.fileOperationResult===at.ks.FILE_PERMISSION_DENIED,h=r.scheme===at.TT.file;h&&(c||l)?n.push(this.instantiationService.createInstance(Kb,t,i,!!l)):a?n.push(this.instantiationService.createInstance(Fb,t,i)):n.push(this.instantiationService.createInstance(Zb,t,i)),n.push(this.instantiationService.createInstance(Pb,t)),n.push(this.instantiationService.createInstance(Bb,t)),o=a?l&&h?at.yM?(0,at.EM)(7400,"Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",(0,at.iT)(r)):(0,at.EM)(7401,"Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",(0,at.iT)(r)):(0,at.EM)(7402,"Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",(0,at.iT)(r)):h&&c?at.yM?(0,at.EM)(7403,"Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",(0,at.iT)(r)):(0,at.EM)(7404,"Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",(0,at.iT)(r)):(0,at.EM)(7405,"Failed to save '{0}': {1}",(0,at.iT)(r),(0,at.Mp)(e,!1))}let l={primary:n,secondary:a},c=this.notificationService.notify({id:"".concat((0,at.qC)(t.resource.toString())),severity:at.Ud.Error,message:o,actions:l});at.tj.once(c.onDidClose)(()=>{(0,at.Sj)(n),(0,at.Sj)(a)}),this.messages.set(t.resource,c)}dispose(){super.dispose(),this.messages.clear()}},{_:tt.ID="workbench.contrib.textFileSaveErrorHandler"},tt);Wb=(0,at.Jb)([(0,at.Yb)(0,at.Pd),(0,at.Yb)(1,bt.E),(0,at.Yb)(2,at.Nb),(0,at.Yb)(3,bt.kt),(0,at.Yb)(4,at.Zb),(0,at.Yb)(5,at.rx),(0,at.Yb)(6,at.Io)],Wb);var Lb=[],Jb=class extends at.Hb{constructor(e){super("workbench.files.action.resolveConflictLearnMore",(0,at.EM)(7406,"Learn More")),this.openerService=e}async run(){await this.openerService.open(at.xO.parse("https://go.microsoft.com/fwlink/?linkid=868264"))}};Jb=(0,at.Jb)([(0,at.Yb)(0,at.ml)],Jb);var Gb=class extends at.Hb{constructor(e){super("workbench.files.action.resolveConflictLearnMoreDoNotShowAgain",(0,at.EM)(7407,"Don't Show Again")),this.storageService=e}async run(e){this.storageService.store(Rb,!0,at.Ro.APPLICATION,at.zo.USER),e.dispose()}};Gb=(0,at.Jb)([(0,at.Yb)(0,at.Io)],Gb);var Nb=class extends at.Hb{constructor(e,t,i,o,s){super("workbench.files.action.resolveConflict",(0,at.EM)(7408,"Compare")),this.model=e,this.editorService=t,this.notificationService=i,this.instantiationService=o,this.productService=s}async run(){if(!this.model.isDisposed()){let e=this.model.resource,t=(0,at.iT)(e),i=(0,at.EM)(7409,"{0} (in file) \u2194 {1} (in {2}) - Resolve save conflict",t,t,this.productService.nameLong);await ft.s.open(e,Tb,i,this.editorService,{pinned:!0});let o={primary:[this.instantiationService.createInstance(Jb)]},s=this.notificationService.notify({id:"".concat((0,at.qC)(e.toString())),severity:at.Ud.Info,message:Ob,actions:o,neverShowAgain:{id:Rb,isSecondary:!0}});at.tj.once(s.onDidClose)(()=>(0,at.Sj)(o.primary)),Lb.push(s)}}};Nb=(0,at.Jb)([(0,at.Yb)(1,bt.kt),(0,at.Yb)(2,at.Pd),(0,at.Yb)(3,at.rx),(0,at.Yb)(4,pt.Wt)],Nb);var Kb=class extends at.Hb{constructor(e,t,i){super("workbench.files.action.saveModelElevated",i?at.yM?(0,at.EM)(7410,"Overwrite as Admin..."):(0,at.EM)(7411,"Overwrite as Sudo..."):at.yM?(0,at.EM)(7412,"Retry as Admin..."):(0,at.EM)(7413,"Retry as Sudo...")),this.model=e,this.options=t,this.triedToUnlock=i}async run(){this.model.isDisposed()||await this.model.save((0,rt.A)((0,rt.A)({},this.options),{},{writeElevated:!0,writeUnlock:this.triedToUnlock,reason:bt.Kt.EXPLICIT}))}},Zb=class extends at.Hb{constructor(e,t){super("workbench.files.action.saveModel",(0,at.EM)(7414,"Retry")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save((0,rt.A)((0,rt.A)({},this.options),{},{reason:bt.Kt.EXPLICIT}))}},Bb=class extends at.Hb{constructor(e){super("workbench.files.action.revertModel",(0,at.EM)(7415,"Revert")),this.model=e}async run(){this.model.isDisposed()||await this.model.revert()}},Pb=class extends at.Hb{constructor(e,t){super("workbench.files.action.saveModelAs",ht.o.value),this.model=e,this.editorService=t}async run(){if(!this.model.isDisposed()){let e=this.findEditor();e&&await this.editorService.save(e,{saveAs:!0,reason:bt.Kt.EXPLICIT})}}findEditor(){let e,t=this.editorService.findEditors(this.model.resource,{supportSideBySide:bt.Jt.PRIMARY});for(let i of t){if(i.editor instanceof Et.n){e=i;break}e||(e=i)}return e}};Pb=(0,at.Jb)([(0,at.Yb)(1,bt.kt)],Pb);var Fb=class extends at.Hb{constructor(e,t){super("workbench.files.action.unlock",(0,at.EM)(7416,"Overwrite")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save((0,rt.A)((0,rt.A)({},this.options),{},{writeUnlock:!0,reason:bt.Kt.EXPLICIT}))}},Yb=class extends at.Hb{constructor(e,t){super("workbench.files.action.saveIgnoreModifiedSince",(0,at.EM)(7416,"Overwrite")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save((0,rt.A)((0,rt.A)({},this.options),{},{ignoreModifiedSince:!0,reason:bt.Kt.EXPLICIT}))}},Qb=class extends at.Hb{constructor(e){super("workbench.files.action.configureSaveConflict",(0,at.EM)(7417,"Configure")),this.preferencesService=e}async run(){this.preferencesService.openSettings({query:"files.saveConflictResolution"})}};Qb=(0,at.Jb)([(0,at.Yb)(0,Ct.r)],Qb),(0,at.Xb)(),(0,at.TM)(),(0,at.wj)(),(0,at.SO)(),(0,at.i_)(),(0,at.ps)(),(0,at.Ma)(),(0,at.Hj)(),(0,at.Bd)(),(0,at.Fd)(),(0,at.hl)(),(0,at.DO)(),(0,at.Go)(),(0,dt.z)(),(0,at.yb)(),(0,at.Wd)();var Xb=(it=class extends at.mj{constructor(e,t,i,o,s,r,n,a){super(),this.fileService=e,this.configurationService=t,this.contextService=i,this.notificationService=o,this.openerService=s,this.uriIdentityService=r,this.hostService=n,this.telemetryService=a,this.watchedWorkspaces=new at.Lj(e=>this.uriIdentityService.extUri.getComparisonKey(e)),this.registerListeners(),this.refresh()}registerListeners(){this._register(this.contextService.onDidChangeWorkspaceFolders(e=>this.onDidChangeWorkspaceFolders(e))),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onDidChangeWorkbenchState())),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onDidChangeConfiguration(e))),this._register(this.fileService.onDidWatchError(e=>this.onDidWatchError(e)))}onDidChangeWorkspaceFolders(e){for(let t of e.removed)this.unwatchWorkspace(t);for(let t of e.added)this.watchWorkspace(t)}onDidChangeWorkbenchState(){this.refresh()}onDidChangeConfiguration(e){(e.affectsConfiguration("files.watcherExclude")||e.affectsConfiguration("files.watcherInclude"))&&this.refresh()}onDidWatchError(e){let t,i=e.toString();i.indexOf("ENOSPC")>=0?(t="ENOSPC",this.notificationService.prompt(at.Ud.Warning,(0,at.EM)(7751,"Unable to watch for file changes. Please follow the instructions link to resolve this issue."),[{label:(0,at.EM)(7752,"Instructions"),run:()=>this.openerService.open(at.xO.parse("https://go.microsoft.com/fwlink/?linkid=867693"))}],{sticky:!0,neverShowAgain:{id:"ignoreEnospcError",isSecondary:!0,scope:at.Id.WORKSPACE}})):i.indexOf("EUNKNOWN")>=0?(t="EUNKNOWN",this.notificationService.prompt(at.Ud.Warning,(0,at.EM)(7753,"File changes watcher stopped unexpectedly. A reload of the window may enable the watcher again unless the workspace cannot be watched for file changes."),[{label:(0,at.EM)(7754,"Reload"),run:()=>this.hostService.reload()}],{sticky:!0,priority:at.Rd.SILENT})):i.indexOf("ETERM")>=0&&(t="ETERM"),t&&this.telemetryService.publicLog2("fileWatcherError",{reason:t})}watchWorkspace(e){var t,i;let o=[],s=this.configurationService.getValue({resource:e.uri});if(null!==(t=s.files)&&void 0!==t&&t.watcherExclude)for(let a in s.files.watcherExclude)a&&!0===s.files.watcherExclude[a]&&o.push(a);let r=new at.Lj(e=>this.uriIdentityService.extUri.getComparisonKey(e));if(r.set(e.uri,e.uri),null!==(i=s.files)&&void 0!==i&&i.watcherInclude)for(let a of s.files.watcherInclude)if(a)if((0,at.OO)(a)){let t=at.xO.file(a).with({scheme:e.uri.scheme});this.uriIdentityService.extUri.isEqualOrParent(t,e.uri)&&r.set(t,t)}else{let t=e.toResource(a);r.set(t,t)}let n=new at.gj;for(let[,a]of r)n.add(this.fileService.watch(a,{recursive:!0,excludes:o}));this.watchedWorkspaces.set(e.uri,n)}unwatchWorkspace(e){this.watchedWorkspaces.has(e.uri)&&((0,at.Sj)(this.watchedWorkspaces.get(e.uri)),this.watchedWorkspaces.delete(e.uri))}refresh(){this.unwatchWorkspaces();for(let e of this.contextService.getWorkspace().folders)this.watchWorkspace(e)}unwatchWorkspaces(){for(let[,e]of this.watchedWorkspaces)e.dispose();this.watchedWorkspaces.clear()}dispose(){super.dispose(),this.unwatchWorkspaces()}},{_:it.ID="workbench.contrib.workspaceWatcher"},it);Xb=(0,at.Jb)([(0,at.Yb)(0,at.fs),(0,at.Yb)(1,at.r_),(0,at.Yb)(2,at.ja),(0,at.Yb)(3,at.Pd),(0,at.Yb)(4,at.ml),(0,at.Yb)(5,at.Wo),(0,at.Yb)(6,dt.R),(0,at.Yb)(7,at.vb)],Xb),(0,at.Xb)(),(0,at.ET)(),(0,at.DO)(),(0,at.iM)(),(0,at.v_)(),(0,at.TM)(),(0,at.Zp)(),(0,at.Ua)(),(0,at.Mb)(),(0,gt.f)(),(0,bt.b)(),(0,bt.en)();var Hb=(ot=class{constructor(e){e.registerFormatter({scheme:at.TT.file,formatting:{label:"${authority}${path}",separator:at.PO,tildify:!at.yM,normalizeDriveLetter:at.yM,authorityPrefix:at.PO+at.PO,workspaceSuffix:""}})}},{_:ot.ID="workbench.contrib.fileUriLabel"},ot);Hb=(0,at.Jb)([(0,at.Yb)(0,at.Ha)],Hb),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(Db,Db.ID,(0,at.EM)(7657,"Text File Editor")),[new at.Xp(Et.n)]),at.jb.as(bt.Rt.EditorPane).registerEditorPane(gt.u.create(xb,xb.ID,(0,at.EM)(7658,"Binary File Editor")),[new at.Xp(Et.n)]),at.jb.as(bt.Rt.EditorFactory).registerEditorSerializer(ft.r,class{canSerialize(e){return!0}serialize(e){let t=e,i=t.resource,o=t.preferredResource,s={resourceJSON:i.toJSON(),preferredResourceJSON:(0,at.pT)(i,o)?void 0:o,name:t.getPreferredName(),description:t.getPreferredDescription(),encoding:t.getEncoding(),modeId:t.getPreferredLanguageId()};return JSON.stringify(s)}deserialize(e,t){return e.invokeFunction(e=>{let i=JSON.parse(t),o=at.xO.revive(i.resourceJSON),s=at.xO.revive(i.preferredResourceJSON),r=i.name,n=i.description,a=i.encoding,d=i.modeId,l=e.get(ht.u).createTextEditor({resource:o,label:r,description:n,encoding:a,languageId:d,forceFile:!0});return s&&l.setPreferredResource(s),l})}}),(0,bt.x)(Ab.ID,Ab,bt.y.BlockRestore),(0,bt.x)(Mb.ID,Mb,bt.y.BlockStartup),(0,bt.x)(Wb.ID,Wb,bt.y.BlockStartup),(0,bt.x)(Hb.ID,Hb,bt.y.BlockStartup),(0,bt.x)(Xb.ID,Xb,bt.y.AfterRestored),(0,bt.x)(_b.ID,_b,bt.y.BlockStartup),at.h_.registerLanguage({id:ft.n,aliases:["Binary"],mimetypes:["text/x-code-binary"]}),(0,at.TM)(),(0,bt.Q)(),(0,bt.G)(),(0,pt.W)(),(0,pt.st)(),(0,at.Tb)(),(0,vt.c)(),(0,at.QO)(),(0,bt.At)(),(0,pt.kt)(),(0,ut.xf)(),(0,at.Ab)(),(0,at.oS)(),(0,at.SE)();var Ub=class extends at.bb{constructor(e,t){super(e),this.direction=t}run(e){let t,i=e.get(pt.ot),o=e.get(bt.W),s=e.get(pt.Ot),r=i.hasFocus(pt.V.EDITOR_PART),n=i.hasFocus(pt.V.PANEL_PART),a=i.hasFocus(pt.V.SIDEBAR_PART),d=i.hasFocus(pt.V.AUXILIARYBAR_PART);if(r){if(this.navigateAcrossEditorGroup(this.toGroupDirection(this.direction),o))return;t=i.getVisibleNeighborPart(pt.V.EDITOR_PART,this.direction)}n&&(t=i.getVisibleNeighborPart(pt.V.PANEL_PART,this.direction)),a&&(t=i.getVisibleNeighborPart(pt.V.SIDEBAR_PART,this.direction)),d&&(t=t=i.getVisibleNeighborPart(pt.V.AUXILIARYBAR_PART,this.direction)),t===pt.V.EDITOR_PART?this.navigateBackToEditorGroup(this.toGroupDirection(this.direction),o)||this.navigateToEditorGroup(this.direction===Yt.Right?bt.q.FIRST:bt.q.LAST,o):t===pt.V.SIDEBAR_PART?this.navigateToSidebar(i,s):t===pt.V.PANEL_PART?this.navigateToPanel(i,s):t===pt.V.AUXILIARYBAR_PART&&this.navigateToAuxiliaryBar(i,s)}async navigateToPanel(e,t){if(!e.isVisible(pt.V.PANEL_PART))return!1;let i=t.getActivePaneComposite(ut.gf.Panel);if(!i)return!1;let o=i.getId();return await t.openPaneComposite(o,ut.gf.Panel,!0)||!1}async navigateToSidebar(e,t){if(!e.isVisible(pt.V.SIDEBAR_PART))return!1;let i=t.getActivePaneComposite(ut.gf.Sidebar);if(!i)return!1;let o=i.getId();return!!await t.openPaneComposite(o,ut.gf.Sidebar,!0)}async navigateToAuxiliaryBar(e,t){if(!e.isVisible(pt.V.AUXILIARYBAR_PART))return!1;let i=t.getActivePaneComposite(ut.gf.AuxiliaryBar);if(!i)return!1;let o=i.getId();return await t.openPaneComposite(o,ut.gf.AuxiliaryBar,!0)||!1}navigateAcrossEditorGroup(e,t){return this.doNavigateToEditorGroup({direction:e},t)}navigateToEditorGroup(e,t){return this.doNavigateToEditorGroup({location:e},t)}navigateBackToEditorGroup(e,t){if(!t.activeGroup)return!1;let i=this.toOppositeDirection(e);return!t.findGroup({direction:i},t.activeGroup)&&(t.activeGroup.focus(),!0)}toGroupDirection(e){switch(e){case Yt.Down:return bt.K.DOWN;case Yt.Left:return bt.K.LEFT;case Yt.Right:return bt.K.RIGHT;case Yt.Up:return bt.K.UP}}toOppositeDirection(e){switch(e){case bt.K.UP:return bt.K.DOWN;case bt.K.RIGHT:return bt.K.LEFT;case bt.K.LEFT:return bt.K.RIGHT;case bt.K.DOWN:return bt.K.UP}}doNavigateToEditorGroup(e,t){let i=t.findGroup(e,t.activeGroup);return!!i&&(i.focus(),!0)}};(0,at.Db)(class extends Ub{constructor(){super({id:"workbench.action.navigateLeft",title:(0,at.DM)(2824,"Navigate to the View on the Left"),category:vt.s.View,f1:!0},Yt.Left)}}),(0,at.Db)(class extends Ub{constructor(){super({id:"workbench.action.navigateRight",title:(0,at.DM)(2825,"Navigate to the View on the Right"),category:vt.s.View,f1:!0},Yt.Right)}}),(0,at.Db)(class extends Ub{constructor(){super({id:"workbench.action.navigateUp",title:(0,at.DM)(2826,"Navigate to the View Above"),category:vt.s.View,f1:!0},Yt.Up)}}),(0,at.Db)(class extends Ub{constructor(){super({id:"workbench.action.navigateDown",title:(0,at.DM)(2827,"Navigate to the View Below"),category:vt.s.View,f1:!0},Yt.Down)}});var jb=class extends at.bb{constructor(e,t){super(e),this.focusNext=t}run(e){let t=e.get(pt.ot),i=e.get(bt.kt);this.focusNextOrPreviousPart(t,i,this.focusNext)}findVisibleNeighbour(e,t,i){let o,s=(0,at.Bx)();if((0,at.CE)(s))if(t===pt.V.EDITOR_PART)o=pt.V.STATUSBAR_PART;else o=pt.V.EDITOR_PART;else switch(t){case pt.V.EDITOR_PART:o=i?pt.V.PANEL_PART:pt.V.SIDEBAR_PART;break;case pt.V.PANEL_PART:o=i?pt.V.AUXILIARYBAR_PART:pt.V.EDITOR_PART;break;case pt.V.AUXILIARYBAR_PART:o=i?pt.V.STATUSBAR_PART:pt.V.PANEL_PART;break;case pt.V.STATUSBAR_PART:o=i?pt.V.ACTIVITYBAR_PART:pt.V.AUXILIARYBAR_PART;break;case pt.V.ACTIVITYBAR_PART:o=i?pt.V.SIDEBAR_PART:pt.V.STATUSBAR_PART;break;case pt.V.SIDEBAR_PART:o=i?pt.V.EDITOR_PART:pt.V.ACTIVITYBAR_PART;break;default:o=pt.V.EDITOR_PART}return e.isVisible(o,s)||o===pt.V.EDITOR_PART?o:this.findVisibleNeighbour(e,o,i)}focusNextOrPreviousPart(e,t,i){var o;let s;null!==(o=t.activeEditorPane)&&void 0!==o&&o.hasFocus()||e.hasFocus(pt.V.EDITOR_PART)?s=pt.V.EDITOR_PART:e.hasFocus(pt.V.ACTIVITYBAR_PART)?s=pt.V.ACTIVITYBAR_PART:e.hasFocus(pt.V.STATUSBAR_PART)?s=pt.V.STATUSBAR_PART:e.hasFocus(pt.V.SIDEBAR_PART)?s=pt.V.SIDEBAR_PART:e.hasFocus(pt.V.AUXILIARYBAR_PART)?s=pt.V.AUXILIARYBAR_PART:e.hasFocus(pt.V.PANEL_PART)&&(s=pt.V.PANEL_PART),e.focusPart(s?this.findVisibleNeighbour(e,s,i):pt.V.EDITOR_PART,(0,at.Bx)())}};(0,at.Db)(class extends jb{constructor(){super({id:"workbench.action.focusNextPart",title:(0,at.DM)(2828,"Focus Next Part"),category:vt.s.View,f1:!0,keybinding:{primary:at.KO.F6,weight:at.Ob.WorkbenchContrib}},!0)}}),(0,at.Db)(class extends jb{constructor(){super({id:"workbench.action.focusPreviousPart",title:(0,at.DM)(2829,"Focus Previous Part"),category:vt.s.View,f1:!0,keybinding:{primary:at.JO.Shift|at.KO.F6,weight:at.Ob.WorkbenchContrib}},!1)}}),(0,at.vE)(),(0,at.sp)(),(0,dt.er)(),(0,at.iM)(),(0,at.oS)(),(0,at.oE)(),(0,at.jg)(),(0,at.vg)(),(0,at.rh)(),(0,at.Qh)(),(0,at.Vm)(),(0,at.wm)(),(0,at.Sm)(),(0,at.ih)(),(0,at.cg)(),(0,at.vm)(),(0,at._m)(),(0,at.SE)(),(0,at.bE)({}),(0,at.cp)((e,t)=>{let i=(0,dt.$n)(e);t.addRule(".monaco-workbench-part { background-color: ".concat(i,"; }"));let o=e.getColor(at.yg);if(o&&t.addRule(".monaco-workbench-part ::selection { background-color: ".concat(o,"; }")),at._M){let t=e.getColor(dt.Kn);if(t){let e="monaco-workbench-meta-theme-color",i=at.wE.document.getElementById(e);i||(i=(0,at.Px)(),i.name="theme-color",i.id=e),i.content=t.toString()}}at.dE&&t.addRule("\n\t\t\t.monaco-workbench-part.web {\n\t\t\t\ttouch-action: none;\n\t\t\t}\n\t\t\t.monaco-workbench-part .monaco-editor .view-lines {\n\t\t\t\tuser-select: text;\n\t\t\t\t-webkit-user-select: text;\n\t\t\t}\n\t\t"),at.uM&&(0,at.fE)()&&t.addRule(".monaco-workbench-part { background-color: ".concat(i,"; }"))}),(0,at.Xb)(),(0,at.wj)(),(0,at.TM)(),(0,vt.c)(),(0,at.Tb)(),(0,at.Dd)(),(0,bt.en)(),(0,ut.Pi)(),(0,bt.At)(),(0,ut.kb)(),(0,ut.Tb)();var zb=(st=class extends at.mj{constructor(e,t){super(),this.editorService=e,this.statusbarService=t,this.paneInitialScrollTop=new Map,this.syncScrollDispoasbles=this._register(new at.gj),this.paneDisposables=new at.gj,this.statusBarEntry=this._register(new at.vj),this.isActive=!1,this._reentrancyBarrier=new ut.Ni,this.registerActions()}registerActiveListeners(){this.syncScrollDispoasbles.add(this.editorService.onDidVisibleEditorsChange(()=>this.trackVisiblePanes()))}activate(){this.registerActiveListeners(),this.trackVisiblePanes()}toggle(){this.isActive?this.deactivate():this.activate(),this.isActive=!this.isActive,this.toggleStatusbarItem(this.isActive)}trackVisiblePanes(){this.paneDisposables.clear(),this.paneInitialScrollTop.clear();for(let e of this.getAllVisiblePanes())(0,bt.sn)(e)&&(this.paneInitialScrollTop.set(e,e.getScrollPosition()),this.paneDisposables.add(e.onDidChangeScroll(()=>this._reentrancyBarrier.runExclusivelyOrSkip(()=>{this.onDidEditorPaneScroll(e)}))))}onDidEditorPaneScroll(e){let t=this.paneInitialScrollTop.get(e);if(void 0===t)throw Error("Scrolled pane not tracked");if(!(0,bt.sn)(e))throw Error("Scrolled pane does not support scrolling");let i=e.getScrollPosition(),o=i.scrollTop-t.scrollTop,s=void 0!==i.scrollLeft&&void 0!==t.scrollLeft?i.scrollLeft-t.scrollLeft:void 0;for(let r of this.getAllVisiblePanes()){if(r===e||!(0,bt.sn)(r))continue;let t=this.paneInitialScrollTop.get(r);if(void 0===t)throw Error("Could not find initial offset for pane");let i=r.getScrollPosition(),n={scrollTop:t.scrollTop+o,scrollLeft:void 0!==t.scrollLeft&&void 0!==s?t.scrollLeft+s:void 0};i.scrollTop===n.scrollTop&&i.scrollLeft===n.scrollLeft||r.setScrollPosition(n)}}getAllVisiblePanes(){let e=[];for(let t of this.editorService.visibleEditorPanes){if(t instanceof Et.o){let i=t.getPrimaryEditorPane(),o=t.getSecondaryEditorPane();i&&e.push(i),o&&e.push(o);continue}e.push(t)}return e}deactivate(){this.paneDisposables.clear(),this.syncScrollDispoasbles.clear(),this.paneInitialScrollTop.clear()}toggleStatusbarItem(e){if(e){if(!this.statusBarEntry.value){let e=(0,at.EM)(10101,"Scrolling Locked"),t=(0,at.EM)(10102,"Lock Scrolling Enabled");this.statusBarEntry.value=this.statusbarService.addEntry({name:e,text:e,tooltip:t,ariaLabel:e,command:{id:"workbench.action.toggleLockedScrolling",title:""},kind:"prominent",showInAllWindows:!0},"status.scrollLockingEnabled",ut.Db.RIGHT,102)}}else this.statusBarEntry.clear()}registerActions(){let e=this;this._register((0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.toggleLockedScrolling",title:(0,rt.A)((0,rt.A)({},(0,at.DM)(10103,"Toggle Locked Scrolling Across Editors")),{},{mnemonicTitle:(0,at.EM)(10104,"Locked Scrolling")}),category:vt.s.View,f1:!0,metadata:{description:(0,at.EM)(10105,"Synchronize Scrolling Editors")}})}run(){e.toggle()}})),this._register((0,at.Db)(class extends at.bb{constructor(){super({id:"workbench.action.holdLockedScrolling",title:(0,rt.A)((0,rt.A)({},(0,at.DM)(10106,"Hold Locked Scrolling Across Editors")),{},{mnemonicTitle:(0,at.EM)(10107,"Locked Scrolling")}),category:vt.s.View})}run(t){let i=t.get(at.Ed);e.toggle();let o=i.enableKeybindingHoldMode("workbench.action.holdLockedScrolling");o&&o.finally(()=>{e.toggle()})}}))}dispose(){this.deactivate(),super.dispose()}},{_:st.ID="workbench.contrib.syncScrolling"},st);zb=(0,at.Jb)([(0,at.Yb)(0,bt.kt),(0,at.Yb)(1,ut.wb)],zb),(0,bt.b)(),(0,bt.x)(zb.ID,zb,bt.y.Eventually);var qb,$b={"vs/workbench/contrib/debug/browser/media/continue-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIxSURBVHgB7dlNbtNAGMbxZyaUBSuOYHOBYlYskEhPwscFoKsqIBRHCCKyKNADQLkAR0jCiqBIhH6wAim+AWyAVKlnmDdKJUNTimT7nVm8v13SStGjfyauG0AIIYQQQgghBKPu5HGzO0kjBEahYjRUN3QbFk33MHMvkW6tP3iDQFQ6eDFW68GpF1HYzfN5p5WkGTzTYGAtbmu9Nni29/QWPGMZvBS56bu9/SevfZ5tzsELvmvXO1jZoTGms+Inka/atRduJY9SY3SMxSf2n5a1+5y1Wd7SraSVba0/jM+oHXPWZj3DIdRm/9DyXZt98Alftb0NJlT7ornEWtvrYLKZbOL61RtU+woYansfTDbUBtWectQOYvCJ/6nd0GtvUUJQg8l5tS1wGSUEN5gM7ABHmMXuvvomKnYBAaGhB18PMN4f3dfatN1b+FRNdwP/DSUEM3j7cFt9+DSKVMO8cg+bK37F7Tcvf5m8gxK8D6aqH/feq+P86N4ZVd2xRebO8x33x8o7lOT1DO982YGrGh9r23f1nq/4QFpWnV+rYizxUpiqjj+P1eznD5aqReyDqerIVdXnnNWZO6tpkn5HxdgGF6s2mKsWsQz2XbWo9sG9w96/qpJp3VWL6h1sVWTNvA/PVYvqLhy5kxmteJ6q3nVVh2DGfR2mqi+W19UhPOC8LHmrWlRpYQNNZ3H619PeqxbV8HVpN9LI29CK/iWThVCVBQ1PJ2mpm3UhhBBCCCFEOH4DIKF0k8sm4ZEAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,"vs/workbench/contrib/debug/browser/media/pause-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADASURBVHgB7dmxDcIwEEbh3xGLMAIbgFiADWADKmqoEUPAJFY2YAOyBRUxR2GLjkgxzeV9VWLlFD+3lgAAAAAAmJ6gyg4x7ZW0KT8Iup5X4fZr7hiTntI2Je3ymj23l3U4qaKZKrNNLuwUl/n91asdMvc5+b7X3A6ozIZGD1XWaGII9o5g7wj2jmDvCPaOYO8I9o5g7wj2jmDvCPaO4NpGXG0k/UH1mwfbZmeVMb9acDdsrHwbv5bvAgAAAAAAo70BgzIgmYCKG/cAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,"vs/workbench/contrib/debug/browser/media/restart-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASRSURBVHgB7ZlPTxtHGMafGUNsStWEQ6QcTauemha76r1GvZf0CzQ410iBcgiCNGVpipE5ADnkWuMec4hoP4BNbtzstBwqVWq2UlUhBTUoqgv2emf6jg1lcW1iZsdWkeYnGbyz9s48nnnn/TOAxWKxWCwWi8VisXQBQx9ZKS0lfCAR4bjsCzHSbOUuINwq/LKTdPbRY7QEOyXnShS4cnxdBfY7DXa59CDFI5EpJmVKBr7TYTRbkGxDiNrTuaTjogcMQIMoItOc84Xj65jEBv1LBz/TEMp5jt7GISVkNw+WSNEf+t6gXPkps+jXa3nTwjkMs1xajmd/XCqS2CKUWD2YFNIh4YVM6cENGMSoYCWWc1FszlQHpCzThG+cvOQW2VUn2x2NcP6EZnsBhtBa0u1QGxJIbDs7VaKkZPkqvM12tp57nsPu/u8pDjYJzm623FazvUCicff9+UWERGvTIvt0gjbc3Gwayzfe8lFXCJGeS97fQhcUZRHb5e04h++0ES4h2Mxscn4dITCzpJtLOH66jW0eCC/ZrVjFOBvHXHLOHXrzrUlfyJmW2wxcrjZWUgiMb1pNZH42Mf+Zrl+98+4dXB4cWRMCt1puMcnxLULQC8HugahPIyS3r99GDG/kyCRa7TaRfZa5CU3M2HAAmpW0ipyCbWGiqJWdFSbqXoGxk52fBl26O3bvQ2hgfIY5R0754OAr+roI6wyuDl+lTV58HWwjT5BQgQ006JENmyM9mkZkMEpujTzBCYxxTEADLcEx+Mo1lNEnYtGYpFj8h2AbB/8YGmgJ/oLs8ZLwxo9+dbeLVyiuVa+hDrYVbFPLGhr0NT3URUoH62WM1Pjgn8FmIby3z5tc/O9tWMGYo9a1kVz5Qgg2yYURLKpdZdSv5UIIfrzzGIdS/meT0ikOXAjBu9FdymNlKtjGNN2ikXxY5bMvKy8bO/7M9Rkzay9A5a8KIz4NuhQB8RQahJphtdRUrEvJ+3jNr6x54nBVtZlE/ZhAPRWMpaE8lcAmNAgl2PV+SUjhFSheLlCyOkXDmKa2pEN+0xR7r/5g9PzWlNClPLv/MzwIz2USY8G2Rr5KQQIMkH2WZQJMZWXxYBdkwQ40CR1pZUrfTEc4Wzv1UIYNJi/d+uiDihzXHFv25yxD1ae8V+Zabv06O3bvHWgSepeeT365TjF1MdhG15OCeU+2yxh9tPMI50HVtVZ3MoxVxVQbsSqc/AQhMBJLH5VnC/R2tOWWS10ssshAfhjD8sV7L+B0mHG1Oe292mO+qMd5RK5REtya/tFSFouzY/dDVS6NJQ/NMi0KNKqRNr2oI5T8gah9PzQ0tM+rVJCNNbv2pY+BQx816acox71Bad/nbUq9RsQ2h2KQM2Y6SJmM3KVacyMZIHtP0CDiZ5w7GRPb6A+GaYiGv3BUVw7zfBXAHNe1tVxQO3qWDy+XliapvvUVmi7lPP1IdfRCx6kPqfj30PQRas8LANnGYRibYJxNBJZtsN9/Q1F1JMMZ2/xbeN/16qy47wfidF4SF6fKM/w52ehv/ToQt1gsFovFYrFYLJau+AfCNPXR3BjmUgAAAABJRU5ErkJggg==","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,"vs/workbench/contrib/debug/browser/media/run-with-debugging-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAUfSURBVHgB7ZpNTxtHGMefmbWTktICh1x66bqXXqpit5ccKmHovSVfoGCukUqJUlEaqixKE0Qb4RQpxwL9Amn6BWJzKlKl2Ea5VJXqvfVYU1xsx96ZPI+9gxdjwtpmd1G0Pwn2bWZ3/vOft2cAICQkJCQkJCQkJCTkQrKau5tczRk6XBAYeAQJ5Rq/AxKSeGnip4zF8W9/gYDxRPBa7u40cP7riY8x2Las+spSwjAhIDh4gAA+2u2+lDDLeTSzVrg/AwHhieAz0FH69g9797aC6NtBCG4SlNv+CGYyK4RY6fJE99tt3xxeSnxnCMFj0Byxj2O7/dQPt31t0kuJJXNx/HbsFLdjfrgdSB8O0u3ABq2g3A5MsOJa/BNy+z3wye3ABU+ySXK7eElc8cXtwAUrFhILvrh9YQQTfrjtkWCeBSGug5AUHZnQI27c1nj0MfRBBDyARmBoFfQJXVOoCD1CbiPFdC4dq0LZ4BxDTQcSYBT6wJcmjfNuFvogIzNQhWoM4+oJOCcGdlgF+kxCnGodA+ySZCyLFjwZJODf+GsD/tjbnde4MLAJn3ATv/Mv9MFADtPggU0tQ7saqok1j1JO0+Dy4979NPQIubqaW41VKgcZCeJht6ZL9w9F/VPoA1c7HlSIncLO2PDQcOnW+7fko+ePoCz20yjsK1UGJIuvM/FUZ4wl1btpl+PqW++kUrEUPPjzAasflt+9FgdzkhknvvGs8DuzGPsStxCMLkLxFpg4eqewi+xAn7gSTDXOuXiKhc/yy5fn6oe1Gc5hy35cxELMOfspptcpPTSnESy+EJPRK0M7olbbxOaZFKI+hds8RZV+/fk6e1Gv6UwTm/YeWCeYTfxUFdaKkTBKMACu+jBj4mc86DQdYKHJNV09swtvOtPTKI2ip1B0UxT1ccxnUv7WdZTeN0Xn5HqjWpvHtHe69NVzcdWJK8FS8jkU3XSMCs1Uu8DA/u3oVZOaeBfMg0Ypi2mTdh9XFIVVn1MXtcNaPMIh3fWz5+SqE1eCHY4dNdMWDP6rl1Kn5eMatDxqU+xsEVpUyzPLKjn67Lm76qSnbdrmFESjcp9QX+6ck1v99/8043wePHLVSY/zMNcdFxLcY1es1DsfvFndl3UtksXTz7xy1Ykrwbi8ax6rcHh0DxUsWEIUzsorgcU1ztKd76L1MvHPxwxG8lZ2X1gfeeWqE1eCaS1LR860cWUsiXWzZMRuAMpgrkU+r1pl3X5kNH+15mPPhSpcCW4v3HtpxV3AFRi+a9q+MiAA3PZhp9JB/h41YI0NjivBOJVQXIoL7wj+kazVHyMaG4Ee4Uxe//rD5d8gQFwFDzRv0s8laGyre5aUk4Y0XpmP1secs1l13bAaZw5yXtNjtDRCg0uezhjwGTwbOy0lVcZufhcXKWyilR7yb4yOmBAwrgXTdFLjFQNP4/at0SEt+nitsMYyHU5vFbeoWsY4BQPQWndj543XyxWD4twgcTUA0Vr5wNo3GEi1zSIdeU1aLvKhIVNjGjZ1C0TlBa3I1qFdOe30gt0cjo6kb3xwA4LAlcNla3/mmFghb+JRhXcYCkb/hlrjWaNS26QjiqU1txJblCBXQI3QXK7T+yAgXDZpkbRPpBAwt5hYfog7ilM4r9K/NaipJo6R0Sw4XEUy5P4348srlK+d9uh9vuN6Tl0rfL8lBNtZStzePnaf/p+DsS9ol8OOeEyUmhdSbnSuxFZz93AzXU4sji+nICQkJCQkJCTkdecljQujDnl0mKoAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,"vs/workbench/contrib/debug/browser/media/stepinto-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJRSURBVHgB7ZpNbtNAFMf/zzYCdnACcoQKLlCzYAviAvQIoFLEroUVUoXoCZpwBLYg6nKDcoLkBsmCL6luH/Ocpoqjtnbdea9S+n5SFI89mpmfx56PlwCO4ziO4ziODgRj1gtenU9/zGkfhmQwJmEUC6dMb3qCG4YLLzsuvOy48LLjwldl/Vt9JdWVzYLxuohT1jxRhd8U/CJJUWx85z6uwFbB9A/oE2NPykREoglLw5gxqBKEta7SIvsX2D1mrElJocx+TOkowi8LvhcauFM72UF6Qfa0pJD+JHUgAlGEd3KaUImcgUntwiWkz5FFKHNMhMdSByIQ7ZHefkIHXaWbZLdzOkAkog5aXaQtZadNUWDjK69whiIUXn/vZFCjulhCGFjJCmqb73OlG9CUFVSjDZeV1pYV1MMrbaUtZAWTeFKTtJWsYLJ5mBu9x4vXLGUF04jhSU/vzXpapi9LWcE8Lv224F5ZoifHWYbRh5xGcJxomD7Ssqmn26FOnqY5RbWu3MrtmmFWU1gz4xeQ0xGehoHqgZzjBD/CNPHlDjB8ZyRtUovI/glfYTO/ecZlmZZe3QU+W0irz8MNssJ9iWr8LrEKA9SFQ2yqd4HsDKIUu/KOa6MuXB7jWcusPYte1l9aElZaZ02mCxJN1IXD49w6FhWCAWMoo9/DjP22WcNo/RPKqAsfpZXwsCFbWJFgYLGuVheuwqslnp+1NTxBhuZhCryHAWb74YzwMBzKH1p49qluQujZQ8Ijq13TtW0Pw+9Gk8NbGMUKsDuO4ziO4zjXzX/ncxVIRDwWzgAAAABJRU5ErkJggg==","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,"vs/workbench/contrib/debug/browser/media/stepout-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJSSURBVHgB7ZpRbtNAEIb/cYIAqQ/tCQg3qOACOEi8Aj1BOQIPEbw14amoIHECKBcA8cpDDTeAEyQ3oA9AK9XpdsbxSlGUNk60M62i+aRIlr3S5vPYuzvjBRzHcRzHcRwdCMa8KkKnBDpy3AZGb3MawRBT4V4RtkNAwZ1u1qeOUSI/eEK/YEQGI+bICpsc5qPe97ANI0wifInsNH840l2LSKsLN5CNmEirCi8hG1GXVhNeQTaiKq0yaF0mG4DPs23nnNvSHMiSC18l+65Lu7PtNwgvLKWTCi8rK/RzCpbSyYRXkY1YSqeLcMDXWdnzgMEi2Ugtvcs3bTBzSaS/IBHphEs8D7JUrBHZ94+pjyVgaWxk6E9LBxm1CTtIRDJhmUaI18UivYpsZFpaZIl4isrTTVFJBy2RLgn3V5WNROk24UFKWcE8PewdceymOOiS6X8wy5ZuCi687rjwuuPC604b9gRcI+bCYYwuHEcN03XsXhFAt7nP+i0OLQQ6mSQLVpj11GfZv0BOYzzldOGenAsZfvI08e0OMBwYSZv0IrL/UeW4e3MuS8778i6Xdyyk1efhBbLCFl/79K/EIxigLnzKn0avkI0QtfBR3nFt1IXLczxr2LRjEWX9pSWhcYmVssmHck3UhflxPm7aNiOuUCqjH+GAH02b8mj9G8qoC49blfBwQTNekeBw32C/h7rwh5xkH8dOVVCfjwzNwxbwBgaY5MNSr5YaMx8WmAhWv/qrwuEZ4eG+0W4e87r0a9m2VKJDPJid3cKoegIcx3Ecx3GcNeAC4UEBaURTA6MAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,"vs/workbench/contrib/debug/browser/media/stepover-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMnSURBVHgB7ZldTttAFIXPOA5Sfx5YgmEDzQ6agPpcdgB0BVQ09JHQp7a0aruBClZA+9qWOKygdAONl5BKhf4AuT0DQXKCG8cTzwik+SQLezzGc3zv3Dt3Ang8Ho/H4/F4PB4TFG4IrVjQA6J029uGSlAQp4LXYokqqUEHQO8ESDjwXt6zT2NRfUE/1SQnCvNFRYewiBY4AyyLoC5ATQlmR/tUeTTbkkDQUQE+vmyoD7CIFcHrsdQDwSYuhJ6T40oRO6zww6xo8Uphh9bffW7gsnkEKBG6XcQBxxQb87IOMyIKb50J2huxLKNkSrOwtioHuUdLzuZ0TVLn0Zh+cxS+s7Ev9/4GeMbrHyiBUgRrS+jBZd2jS/d47x3DTecsxOFogGp+khoqqPH0Id166crzCo+rnBp/FBarmJ6po/TGF1mSAHsZt/RcbDEI7WICdNr5TYuf0p05qCxXPuRRS10bRempBOs5Szf+esWNadGTAK1J0s0omxR+dIqGquA9xru8keCpghbzYjwqlm1b24tqzUSsZquhcDdEHCgsYHi+l4Kx4Oa+rGDEAlrs60XVwpS0KPoW0NWidQxAiZgHLcU8O0xiIjZryagZqJSqwhanyBuUhJHgdQYqjAyS1mjAgGN+uhlODRk/XzMJT8+fSQo8YubSnLdD6YOD7bywsCrKIQnD4nPcTHCA+0P/RGXnYIt0K5zfJkvPwoJZEOioHKXbaOFvcIexWE3hPNyMuTJi7k23bS+oG1NXFw5aun7lUm/18lpJuWnD4/F4xuE8uupq6PKlevtHFwsucfY2LfQX39fXWz/9wcIlwAEXAh0WCuJKuJO3nNe4YI0rmTVuImdYvROi40J0qZt4/2Mgto3sAiFisd9m0V+HA6x/Um3dY0EX+dVQ9zZ3MGxb2bqFjy62a6MJukY/HVjZumDpTyxCsQqbtK8x1gUXcFAZHFaxH7S4H22lryFO0hJ/fvnOP3M53bosM+dhGSdpiXn2Eca7q+hcDAc4EfzqgepQkN5n1ukpLVyfd3mvwT4HcIDztfSTz1LHZTTmnNUfAx6Px+PxeDwej8dz3fgHnygaDf8DyT4AAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,"vs/workbench/contrib/debug/browser/media/stop-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADLSURBVHgB7dkxDoJAEEbhf4ml3gFvwpGsNFSWxEqPxEmMdzDRRHRXSGjsZIEQhvclhJaXHZodCQAAAAD+4BThXuwyeWWaUqJyk19KdbRSjDrWJe6oCQUfmlepjhItzOKC40b6122dn7ca2bM4uI9eXj0x0tYRbB3B1hFsHcHWEWwdwdYRbB3B1hFsHcHWEWzdEBfxepz2UUu5LqrwdklQb0MEp95XV41sqFEc5IRrqWZirv9waJ/O4k64Xka3+9mphOYbBAAAAABj+QJmPCRPyVBXxgAAAABJRU5ErkJggg==","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href};function em(e){return null!=e&&(qb=e),(0,rt.A)((0,rt.A)({},{[at.wo.toString()]:new at.Xp(kl,[],!0)}),{},{[ut._g.toString()]:new at.Xp(el,[],!1),[ut.vb.toString()]:new at.Xp(Fa,[],!0),[gt.Wn.toString()]:new at.Xp(Vn,[],!0),[pt.Ot.toString()]:new at.Xp(Bd,[],!0),[at.tx.toString()]:new at.Xp(ht.f,[],!0),[ht.u.toString()]:new at.Xp(Et.c,[],!1),[dt.B.toString()]:new at.Xp(Qa,[],!1),[gt.er.toString()]:new at.Xp(Ji,[],!0),[at.Dl.toString()]:new at.Xp(at._c,[],!0),[bt.w.toString()]:new at.Xp(Ha,[],!0),[gt.Pn.toString()]:new at.Xp(za,[],!1),[ut.Iy.toString()]:new at.Xp(bd,[],!0),[ut.cv.toString()]:new at.Xp(Ld,[],!0),[ut.iv.toString()]:new at.Xp(Gd,[],!0),[ut.ov.toString()]:new at.Xp(ut.Ki,[],!0),[at.Ba.toString()]:new at.Xp(Zd,[],!0),[gt.Bn.toString()]:new at.Xp(qd,[],!0),[bt.H.toString()]:new at.Xp(sl,[],!0),[dt.H.toString()]:new at.Xp(gt.Ct,[],!0),[dt.mr.toString()]:new at.Xp(rl,[],!0)})}function tm(e){return at.n.get(pt.ot).isVisible(e,window)}(0,ut.pd)(),(0,ut.md)($b),(0,at.Zp)(),(0,ut.yb)(),(0,gt.Gn)(),(0,pt.kt)(),(0,dt.V)(),(0,gt.tr)(),(0,at.Ol)(),(0,at.vc)(),(0,at.nx)(),(0,ht.d)(),(0,ht.p)(),(0,bt.T)(),(0,gt.Fn)(),(0,ut.Ly)(),(0,ut.qi)(),(0,ut.sv)(),(0,ut.lv)(),(0,ut.av)(),(0,at.Va)(),(0,gt.Vn)(),(0,ut.vg)(),(0,bt.U)(),(0,gt.wt)(),(0,dt.U)(),(0,dt.hr)(),(0,ut.gd)(),(0,ut.pd)(),(0,pt.x)(),(0,gt.bt)(),(0,ut.md)({"vs/workbench/contrib/webview/browser/pre/service-worker.js":()=>(0,ut.hd)(new URL("data:text/javascript;base64,LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi4KICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCi8vQHRzLWNoZWNrCi8vLyA8cmVmZXJlbmNlIGxpYj0id2Vid29ya2VyIiAvPgoKLyoqIEB0eXBlIHtTZXJ2aWNlV29ya2VyR2xvYmFsU2NvcGV9ICovCmNvbnN0IHN3ID0gLyoqIEB0eXBlIHthbnl9ICovIChzZWxmKTsKCmNvbnN0IFZFUlNJT04gPSA0OwoKY29uc3QgcmVzb3VyY2VDYWNoZU5hbWUgPSBgdnNjb2RlLXJlc291cmNlLWNhY2hlLSR7VkVSU0lPTn1gOwoKY29uc3Qgcm9vdFBhdGggPSBzdy5sb2NhdGlvbi5wYXRobmFtZS5yZXBsYWNlKC9cL3NlcnZpY2Utd29ya2VyLmpzJC8sICcnKTsKCmNvbnN0IHNlYXJjaFBhcmFtcyA9IG5ldyBVUkwobG9jYXRpb24udG9TdHJpbmcoKSkuc2VhcmNoUGFyYW1zOwoKY29uc3QgcmVtb3RlQXV0aG9yaXR5ID0gc2VhcmNoUGFyYW1zLmdldCgncmVtb3RlQXV0aG9yaXR5Jyk7CgovKiogQHR5cGUge01lc3NhZ2VQb3J0fHVuZGVmaW5lZH0gKi8KbGV0IG91dGVySWZyYW1lTWVzc2FnZVBvcnQ7CgovKioKICogT3JpZ2luIHVzZWQgZm9yIHJlc291cmNlcwogKi8KY29uc3QgcmVzb3VyY2VCYXNlQXV0aG9yaXR5ID0gc2VhcmNoUGFyYW1zLmdldCgndnNjb2RlLXJlc291cmNlLWJhc2UtYXV0aG9yaXR5Jyk7CgovKioKICogQHBhcmFtIHtzdHJpbmd9IG5hbWUKICogQHBhcmFtIHtSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+fSBbb3B0aW9uc10KICovCmNvbnN0IHBlcmZNYXJrID0gKG5hbWUsIG9wdGlvbnMgPSB7fSkgPT4gewoJcGVyZm9ybWFuY2UubWFyayhgd2Vidmlldy9zZXJ2aWNlLXdvcmtlci8ke25hbWV9YCwgewoJCWRldGFpbDogewoJCQkuLi5vcHRpb25zCgkJfQoJfSk7Cn0KCnBlcmZNYXJrKCdzY3JpcHRTdGFydCcpOwoKLyoqIEB0eXBlIHtudW1iZXJ9ICovCmNvbnN0IHJlc29sdmVUaW1lb3V0ID0gMzBfMDAwOwoKCi8qKgogKiBAdGVtcGxhdGUgVAogKiBAdHlwZWRlZiB7eyBzdGF0dXM6ICdvaycsIHZhbHVlOiBUIH0gfCB7IHN0YXR1czogJ3RpbWVvdXQnIH19IFJlcXVlc3RTdG9yZVJlc3VsdAogKi8KCgovKioKICogQHRlbXBsYXRlIFQKICogQHR5cGVkZWYge3sgcmVzb2x2ZTogKHg6IFJlcXVlc3RTdG9yZVJlc3VsdDxUPikgPT4gdm9pZCwgcHJvbWlzZTogUHJvbWlzZTxSZXF1ZXN0U3RvcmVSZXN1bHQ8VD4+IH19IFJlcXVlc3RTdG9yZUVudHJ5CiAqLwoKCi8qKgogKiBAdGVtcGxhdGUgVAogKi8KY2xhc3MgUmVxdWVzdFN0b3JlIHsKCWNvbnN0cnVjdG9yKCkgewoJCS8qKiBAdHlwZSB7TWFwPG51bWJlciwgUmVxdWVzdFN0b3JlRW50cnk8VD4+fSAqLwoJCXRoaXMubWFwID0gbmV3IE1hcCgpOwoJCS8qKiBAdHlwZSB7bnVtYmVyfSAqLwoJCXRoaXMucmVxdWVzdFBvb2wgPSAwOwoJfQoKCS8qKgoJICogQHJldHVybnMge3sgcmVxdWVzdElkOiBudW1iZXIsIHByb21pc2U6IFByb21pc2U8UmVxdWVzdFN0b3JlUmVzdWx0PFQ+PiB9fQoJICovCgljcmVhdGUoKSB7CgkJY29uc3QgcmVxdWVzdElkID0gKyt0aGlzLnJlcXVlc3RQb29sOwoKCQkvKiogQHR5cGUgeyh4OiBSZXF1ZXN0U3RvcmVSZXN1bHQ8VD4pID0+IHZvaWR9ICovCgkJbGV0IHJlc29sdmU7CgkJY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKHIgPT4gcmVzb2x2ZSA9IHIpOwoKCQkvKiogQHR5cGUge1JlcXVlc3RTdG9yZUVudHJ5PFQ+fSAqLwoJCWNvbnN0IGVudHJ5ID0geyByZXNvbHZlLCBwcm9taXNlIH07CgkJdGhpcy5tYXAuc2V0KHJlcXVlc3RJZCwgZW50cnkpOwoKCQljb25zdCBkaXNwb3NlID0gKCkgPT4gewoJCQljbGVhclRpbWVvdXQodGltZW91dCk7CgkJCWNvbnN0IGV4aXN0aW5nRW50cnkgPSB0aGlzLm1hcC5nZXQocmVxdWVzdElkKTsKCQkJaWYgKGV4aXN0aW5nRW50cnkgPT09IGVudHJ5KSB7CgkJCQlleGlzdGluZ0VudHJ5LnJlc29sdmUoeyBzdGF0dXM6ICd0aW1lb3V0JyB9KTsKCQkJCXRoaXMubWFwLmRlbGV0ZShyZXF1ZXN0SWQpOwoJCQl9CgkJfTsKCQljb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dChkaXNwb3NlLCByZXNvbHZlVGltZW91dCk7CgkJcmV0dXJuIHsgcmVxdWVzdElkLCBwcm9taXNlIH07Cgl9CgoJLyoqCgkgKiBAcGFyYW0ge251bWJlcn0gcmVxdWVzdElkCgkgKiBAcGFyYW0ge1R9IHJlc3VsdAoJICogQHJldHVybnMge2Jvb2xlYW59CgkgKi8KCXJlc29sdmUocmVxdWVzdElkLCByZXN1bHQpIHsKCQljb25zdCBlbnRyeSA9IHRoaXMubWFwLmdldChyZXF1ZXN0SWQpOwoJCWlmICghZW50cnkpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQllbnRyeS5yZXNvbHZlKHsgc3RhdHVzOiAnb2snLCB2YWx1ZTogcmVzdWx0IH0pOwoJCXRoaXMubWFwLmRlbGV0ZShyZXF1ZXN0SWQpOwoJCXJldHVybiB0cnVlOwoJfQp9CgovKioKICogTWFwIG9mIHJlcXVlc3RlZCBwYXRocyB0byByZXNwb25zZXMuCiAqLwovKiogQHR5cGUge1JlcXVlc3RTdG9yZTxSZXNvdXJjZVJlc3BvbnNlPn0gKi8KY29uc3QgcmVzb3VyY2VSZXF1ZXN0U3RvcmUgPSBuZXcgUmVxdWVzdFN0b3JlKCk7CgovKioKICogTWFwIG9mIHJlcXVlc3RlZCBsb2NhbGhvc3Qgb3JpZ2lucyB0byBvcHRpb25hbCByZWRpcmVjdHMuCiAqLwovKiogQHR5cGUge1JlcXVlc3RTdG9yZTxzdHJpbmd8dW5kZWZpbmVkPn0gKi8KY29uc3QgbG9jYWxob3N0UmVxdWVzdFN0b3JlID0gbmV3IFJlcXVlc3RTdG9yZSgpOwoKY29uc3QgdW5hdXRob3JpemVkID0gKCkgPT4KCW5ldyBSZXNwb25zZSgnVW5hdXRob3JpemVkJywgeyBzdGF0dXM6IDQwMSwgfSk7Cgpjb25zdCBub3RGb3VuZCA9ICgpID0+CgluZXcgUmVzcG9uc2UoJ05vdCBGb3VuZCcsIHsgc3RhdHVzOiA0MDQsIH0pOwoKY29uc3QgbWV0aG9kTm90QWxsb3dlZCA9ICgpID0+CgluZXcgUmVzcG9uc2UoJ01ldGhvZCBOb3QgQWxsb3dlZCcsIHsgc3RhdHVzOiA0MDUsIH0pOwoKY29uc3QgcmVxdWVzdFRpbWVvdXQgPSAoKSA9PgoJbmV3IFJlc3BvbnNlKCdSZXF1ZXN0IFRpbWVvdXQnLCB7IHN0YXR1czogNDA4LCB9KTsKCnN3LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBhc3luYyAoZXZlbnQpID0+IHsKCWlmICghZXZlbnQuc291cmNlKSB7CgkJcmV0dXJuOwoJfQoKCS8qKiBAdHlwZSB7Q2xpZW50fSAqLwoJY29uc3Qgc291cmNlID0gZXZlbnQuc291cmNlOwoJc3dpdGNoIChldmVudC5kYXRhLmNoYW5uZWwpIHsKCQljYXNlICd2ZXJzaW9uJzogewoJCQlwZXJmTWFyaygndmVyc2lvbi9yZXF1ZXN0Jyk7CgkJCW91dGVySWZyYW1lTWVzc2FnZVBvcnQgPSBldmVudC5wb3J0c1swXTsKCQkJc3cuY2xpZW50cy5nZXQoc291cmNlLmlkKS50aGVuKGNsaWVudCA9PiB7CgkJCQlwZXJmTWFyaygndmVyc2lvbi9yZXBseScpOwoJCQkJaWYgKGNsaWVudCkgewoJCQkJCWNsaWVudC5wb3N0TWVzc2FnZSh7CgkJCQkJCWNoYW5uZWw6ICd2ZXJzaW9uJywKCQkJCQkJdmVyc2lvbjogVkVSU0lPTgoJCQkJCX0pOwoJCQkJfQoJCQl9KTsKCQkJcmV0dXJuOwoJCX0KCQljYXNlICdkaWQtbG9hZC1yZXNvdXJjZSc6IHsKCQkJLyoqIEB0eXBlIHtSZXNvdXJjZVJlc3BvbnNlfSAqLwoJCQljb25zdCByZXNwb25zZSA9IGV2ZW50LmRhdGEuZGF0YTsKCQkJaWYgKCFyZXNvdXJjZVJlcXVlc3RTdG9yZS5yZXNvbHZlKHJlc3BvbnNlLmlkLCByZXNwb25zZSkpIHsKCQkJCWNvbnNvbGUubG9nKCdDb3VsZCBub3QgcmVzb2x2ZSB1bmtub3duIHJlc291cmNlJywgcmVzcG9uc2UucGF0aCk7CgkJCX0KCQkJcmV0dXJuOwoJCX0KCQljYXNlICdkaWQtbG9hZC1sb2NhbGhvc3QnOiB7CgkJCWNvbnN0IGRhdGEgPSBldmVudC5kYXRhLmRhdGE7CgkJCWlmICghbG9jYWxob3N0UmVxdWVzdFN0b3JlLnJlc29sdmUoZGF0YS5pZCwgZGF0YS5sb2NhdGlvbikpIHsKCQkJCWNvbnNvbGUubG9nKCdDb3VsZCBub3QgcmVzb2x2ZSB1bmtub3duIGxvY2FsaG9zdCcsIGRhdGEub3JpZ2luKTsKCQkJfQoJCQlyZXR1cm47CgkJfQoJCWRlZmF1bHQ6IHsKCQkJY29uc29sZS5sb2coJ1Vua25vd24gbWVzc2FnZScpOwoJCQlyZXR1cm47CgkJfQoJfQp9KTsKCnN3LmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgKGV2ZW50KSA9PiB7Cgljb25zdCByZXF1ZXN0VXJsID0gbmV3IFVSTChldmVudC5yZXF1ZXN0LnVybCk7CglpZiAodHlwZW9mIHJlc291cmNlQmFzZUF1dGhvcml0eSA9PT0gJ3N0cmluZycgJiYgcmVxdWVzdFVybC5wcm90b2NvbCA9PT0gJ2h0dHBzOicgJiYgcmVxdWVzdFVybC5ob3N0bmFtZS5lbmRzV2l0aCgnLicgKyByZXNvdXJjZUJhc2VBdXRob3JpdHkpKSB7CgkJc3dpdGNoIChldmVudC5yZXF1ZXN0Lm1ldGhvZCkgewoJCQljYXNlICdHRVQnOgoJCQljYXNlICdIRUFEJzogewoJCQkJY29uc3QgZmlyc3RIb3N0U2VnbWVudCA9IHJlcXVlc3RVcmwuaG9zdG5hbWUuc2xpY2UoMCwgcmVxdWVzdFVybC5ob3N0bmFtZS5sZW5ndGggLSAocmVzb3VyY2VCYXNlQXV0aG9yaXR5Lmxlbmd0aCArIDEpKTsKCQkJCWNvbnN0IHNjaGVtZSA9IGZpcnN0SG9zdFNlZ21lbnQuc3BsaXQoJysnLCAxKVswXTsKCQkJCWNvbnN0IGF1dGhvcml0eSA9IGZpcnN0SG9zdFNlZ21lbnQuc2xpY2Uoc2NoZW1lLmxlbmd0aCArIDEpOyAvLyBtYXkgYmUgZW1wdHkKCQkJCXJldHVybiBldmVudC5yZXNwb25kV2l0aChwcm9jZXNzUmVzb3VyY2VSZXF1ZXN0KGV2ZW50LCB7CgkJCQkJc2NoZW1lLAoJCQkJCWF1dGhvcml0eSwKCQkJCQlwYXRoOiByZXF1ZXN0VXJsLnBhdGhuYW1lLAoJCQkJCXF1ZXJ5OiByZXF1ZXN0VXJsLnNlYXJjaC5yZXBsYWNlKC9eXD8vLCAnJyksCgkJCQl9KSk7CgkJCX0KCQkJZGVmYXVsdDogewoJCQkJcmV0dXJuIGV2ZW50LnJlc3BvbmRXaXRoKG1ldGhvZE5vdEFsbG93ZWQoKSk7CgkJCX0KCQl9Cgl9CgoJLy8gSWYgd2UncmUgbWFraW5nIGEgcmVxdWVzdCBhZ2FpbnN0IHRoZSByZW1vdGUgYXV0aG9yaXR5LCB3ZSB3YW50IHRvIGdvCgkvLyB0aHJvdWdoIFZTIENvZGUgaXRzZWxmIHNvIHRoYXQgd2UgYXJlIGF1dGhlbnRpY2F0ZWQgcHJvcGVybHkuICBJZiB0aGUKCS8vIHNlcnZpY2Ugd29ya2VyIGlzIGhvc3RlZCBvbiB0aGUgc2FtZSBvcmlnaW4gd2Ugd2lsbCBoYXZlIGNvb2tpZXMgYW5kCgkvLyBhdXRoZW50aWNhdGlvbiB3aWxsIG5vdCBiZSBhbiBpc3N1ZS4KCWlmIChyZXF1ZXN0VXJsLm9yaWdpbiAhPT0gc3cub3JpZ2luICYmIHJlcXVlc3RVcmwuaG9zdCA9PT0gcmVtb3RlQXV0aG9yaXR5KSB7CgkJc3dpdGNoIChldmVudC5yZXF1ZXN0Lm1ldGhvZCkgewoJCQljYXNlICdHRVQnOgoJCQljYXNlICdIRUFEJzogewoJCQkJcmV0dXJuIGV2ZW50LnJlc3BvbmRXaXRoKHByb2Nlc3NSZXNvdXJjZVJlcXVlc3QoZXZlbnQsIHsKCQkJCQlwYXRoOiByZXF1ZXN0VXJsLnBhdGhuYW1lLAoJCQkJCXNjaGVtZTogcmVxdWVzdFVybC5wcm90b2NvbC5zbGljZSgwLCByZXF1ZXN0VXJsLnByb3RvY29sLmxlbmd0aCAtIDEpLAoJCQkJCWF1dGhvcml0eTogcmVxdWVzdFVybC5ob3N0LAoJCQkJCXF1ZXJ5OiByZXF1ZXN0VXJsLnNlYXJjaC5yZXBsYWNlKC9eXD8vLCAnJyksCgkJCQl9KSk7CgkJCX0KCQkJZGVmYXVsdDogewoJCQkJcmV0dXJuIGV2ZW50LnJlc3BvbmRXaXRoKG1ldGhvZE5vdEFsbG93ZWQoKSk7CgkJCX0KCQl9Cgl9CgoJLy8gU2VlIGlmIGl0J3MgYSBsb2NhbGhvc3QgcmVxdWVzdAoJaWYgKHJlcXVlc3RVcmwub3JpZ2luICE9PSBzdy5vcmlnaW4gJiYgcmVxdWVzdFVybC5ob3N0Lm1hdGNoKC9eKGxvY2FsaG9zdHwxMjcuMC4wLjF8MC4wLjAuMCk6KFxkKykkLykpIHsKCQlyZXR1cm4gZXZlbnQucmVzcG9uZFdpdGgocHJvY2Vzc0xvY2FsaG9zdFJlcXVlc3QoZXZlbnQsIHJlcXVlc3RVcmwpKTsKCX0KfSk7Cgpzdy5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgKGV2ZW50KSA9PiB7CglldmVudC53YWl0VW50aWwoc3cuc2tpcFdhaXRpbmcoKSk7IC8vIEFjdGl2YXRlIHdvcmtlciBpbW1lZGlhdGVseQp9KTsKCnN3LmFkZEV2ZW50TGlzdGVuZXIoJ2FjdGl2YXRlJywgKGV2ZW50KSA9PiB7CglldmVudC53YWl0VW50aWwoc3cuY2xpZW50cy5jbGFpbSgpKTsgLy8gQmVjb21lIGF2YWlsYWJsZSB0byBhbGwgcGFnZXMKfSk7CgoKLyoqCiAqIEB0eXBlZGVmIHtPYmplY3R9IFJlc291cmNlUmVxdWVzdFVybENvbXBvbmVudHMKICogQHByb3BlcnR5IHtzdHJpbmd9IHNjaGVtZQogKiBAcHJvcGVydHkge3N0cmluZ30gYXV0aG9yaXR5CiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBwYXRoCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBxdWVyeQogKi8KCi8qKgogKiBAcGFyYW0ge0ZldGNoRXZlbnR9IGV2ZW50CiAqIEBwYXJhbSB7UmVzb3VyY2VSZXF1ZXN0VXJsQ29tcG9uZW50c30gcmVxdWVzdFVybENvbXBvbmVudHMKICogQHJldHVybnMge1Byb21pc2U8UmVzcG9uc2U+fQogKi8KYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1Jlc291cmNlUmVxdWVzdCgKCWV2ZW50LAoJcmVxdWVzdFVybENvbXBvbmVudHMKKSB7CglsZXQgY2xpZW50ID0gYXdhaXQgc3cuY2xpZW50cy5nZXQoZXZlbnQuY2xpZW50SWQpOwoJaWYgKCFjbGllbnQpIHsKCQljbGllbnQgPSBhd2FpdCBnZXRXb3JrZXJDbGllbnRGb3JJZChldmVudC5jbGllbnRJZCk7CgkJaWYgKCFjbGllbnQpIHsKCQkJY29uc29sZS5lcnJvcignQ291bGQgbm90IGZpbmQgaW5uZXIgY2xpZW50IGZvciByZXF1ZXN0Jyk7CgkJCXJldHVybiBub3RGb3VuZCgpOwoJCX0KCX0KCgljb25zdCB3ZWJ2aWV3SWQgPSBnZXRXZWJ2aWV3SWRGb3JDbGllbnQoY2xpZW50KTsKCgkvLyBSZWZzIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlL2lzc3Vlcy8yNDQxNDMKCS8vIFdpdGggUGx6RGVkaWNhdGVkV29ya2VyLCB3b3JrZXIgc3VicmVzb3VyY2VzIGFuZCBibG9iIHdva2VycwoJLy8gd2lsbCB1c2UgY2xpZW50cyBkaWZmZXJlbnQgZnJvbSB0aGUgd2luZG93IGNsaWVudC4KCS8vIFNpbmNlIHdlIGNhbm5vdCBkaWZmZXJlbnQgYSB3b3JrZXIgbWFpbiByZXNvdXJjZSBmcm9tIGEgd29ya2VyIHN1YnJlc291cmNlCgkvLyB3ZSB3aWxsIHVzZSBtZXNzYWdlIGNoYW5uZWwgdG8gdGhlIG91dGVyIGlmcmFtZSBwcm92aWRlZCBhdCB0aGUgdGltZQoJLy8gb2Ygc2VydmljZSB3b3JrZXIgY29udHJvbGxlciB2ZXJzaW9uIGluaXRpYWxpemF0aW9uLgoJaWYgKCF3ZWJ2aWV3SWQgJiYgY2xpZW50LnR5cGUgIT09ICd3b3JrZXInICYmIGNsaWVudC50eXBlICE9PSAnc2hhcmVkd29ya2VyJykgewoJCWNvbnNvbGUuZXJyb3IoJ0NvdWxkIG5vdCByZXNvbHZlIHdlYnZpZXcgaWQnKTsKCQlyZXR1cm4gbm90Rm91bmQoKTsKCX0KCgljb25zdCBzaG91bGRUcnlDYWNoaW5nID0gKGV2ZW50LnJlcXVlc3QubWV0aG9kID09PSAnR0VUJyk7CgoJLyoqCgkgKiBAcGFyYW0ge1JlcXVlc3RTdG9yZVJlc3VsdDxSZXNvdXJjZVJlc3BvbnNlPn0gcmVzdWx0CgkgKiBAcGFyYW0ge1Jlc3BvbnNlfHVuZGVmaW5lZH0gY2FjaGVkUmVzcG9uc2UKCSAqIEByZXR1cm5zIHtSZXNwb25zZX0KCSAqLwoJY29uc3QgcmVzb2x2ZVJlc291cmNlRW50cnkgPSAocmVzdWx0LCBjYWNoZWRSZXNwb25zZSkgPT4gewoJCWlmIChyZXN1bHQuc3RhdHVzID09PSAndGltZW91dCcpIHsKCQkJcmV0dXJuIHJlcXVlc3RUaW1lb3V0KCk7CgkJfQoKCQljb25zdCBlbnRyeSA9IHJlc3VsdC52YWx1ZTsKCQlpZiAoZW50cnkuc3RhdHVzID09PSAzMDQpIHsgLy8gTm90IG1vZGlmaWVkCgkJCWlmIChjYWNoZWRSZXNwb25zZSkgewoJCQkJcmV0dXJuIGNhY2hlZFJlc3BvbnNlLmNsb25lKCk7CgkJCX0gZWxzZSB7CgkJCQl0aHJvdyBuZXcgRXJyb3IoJ05vIGNhY2hlIGZvdW5kJyk7CgkJCX0KCQl9CgoJCWlmIChlbnRyeS5zdGF0dXMgPT09IDQwMSkgewoJCQlyZXR1cm4gdW5hdXRob3JpemVkKCk7CgkJfQoKCQlpZiAoZW50cnkuc3RhdHVzICE9PSAyMDApIHsKCQkJcmV0dXJuIG5vdEZvdW5kKCk7CgkJfQoKCQkvKiogQHR5cGUge1JlY29yZDxzdHJpbmcsIHN0cmluZz59ICovCgkJY29uc3QgY29tbW9uSGVhZGVycyA9IHsKCQkJJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJywKCQl9OwoKCQljb25zdCBieXRlTGVuZ3RoID0gZW50cnkuZGF0YS5ieXRlTGVuZ3RoOwoKCQljb25zdCByYW5nZSA9IGV2ZW50LnJlcXVlc3QuaGVhZGVycy5nZXQoJ3JhbmdlJyk7CgkJaWYgKHJhbmdlKSB7CgkJCS8vIFRvIHN1cHBvcnQgc2Vla2luZyBmb3IgdmlkZW9zLCB3ZSBuZWVkIHRvIGhhbmRsZSByYW5nZSByZXF1ZXN0cwoJCQljb25zdCBieXRlcyA9IHJhbmdlLm1hdGNoKC9eYnl0ZXNcPShcZCspXC0oXGQrKT8kL2cpOwoJCQlpZiAoYnl0ZXMpIHsKCQkJCS8vIFRPRE86IFJpZ2h0IG5vdyB3ZSBhcmUgYWx3YXlzIHJlYWRpbmcgdGhlIGZ1bGwgZmlsZSBjb250ZW50LiBUaGlzIGlzIGEgYmFkIGlkZWEKCQkJCS8vIGZvciBsYXJnZSB2aWRlbyBmaWxlcyA6KQoKCQkJCWNvbnN0IHN0YXJ0ID0gTnVtYmVyKGJ5dGVzWzFdKTsKCQkJCWNvbnN0IGVuZCA9IE51bWJlcihieXRlc1syXSkgfHwgYnl0ZUxlbmd0aCAtIDE7CgkJCQlyZXR1cm4gbmV3IFJlc3BvbnNlKGVudHJ5LmRhdGEuc2xpY2Uoc3RhcnQsIGVuZCArIDEpLCB7CgkJCQkJc3RhdHVzOiAyMDYsCgkJCQkJaGVhZGVyczogewoJCQkJCQkuLi5jb21tb25IZWFkZXJzLAoJCQkJCQknQ29udGVudC1yYW5nZSc6IGBieXRlcyAwLSR7ZW5kfS8ke2J5dGVMZW5ndGh9YCwKCQkJCQl9CgkJCQl9KTsKCQkJfSBlbHNlIHsKCQkJCS8vIFdlIGRvbid0IHVuZGVyc3RhbmQgdGhlIHJlcXVlc3RlZCBieXRlcwoJCQkJcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7CgkJCQkJc3RhdHVzOiA0MTYsCgkJCQkJaGVhZGVyczogewoJCQkJCQkuLi5jb21tb25IZWFkZXJzLAoJCQkJCQknQ29udGVudC1yYW5nZSc6IGAqLyR7Ynl0ZUxlbmd0aH1gCgkJCQkJfQoJCQkJfSk7CgkJCX0KCQl9CgoJCS8qKiBAdHlwZSB7UmVjb3JkPHN0cmluZywgc3RyaW5nPn0gKi8KCQljb25zdCBoZWFkZXJzID0gewoJCQkuLi5jb21tb25IZWFkZXJzLAoJCQknQ29udGVudC1UeXBlJzogZW50cnkubWltZSwKCQkJJ0NvbnRlbnQtTGVuZ3RoJzogYnl0ZUxlbmd0aC50b1N0cmluZygpLAoJCX07CgoJCWlmIChlbnRyeS5ldGFnKSB7CgkJCWhlYWRlcnNbJ0VUYWcnXSA9IGVudHJ5LmV0YWc7CgkJCWhlYWRlcnNbJ0NhY2hlLUNvbnRyb2wnXSA9ICduby1jYWNoZSc7CgkJfQoJCWlmIChlbnRyeS5tdGltZSkgewoJCQloZWFkZXJzWydMYXN0LU1vZGlmaWVkJ10gPSBuZXcgRGF0ZShlbnRyeS5tdGltZSkudG9VVENTdHJpbmcoKTsKCQl9CgoJCS8vIHN1cHBvcnQgQ09JIHJlcXVlc3RzLCBzZWUgbmV0d29yay50cyNDT0kuZ2V0SGVhZGVyc0Zyb21RdWVyeSguLi4pCgkJY29uc3QgY29pUmVxdWVzdCA9IG5ldyBVUkwoZXZlbnQucmVxdWVzdC51cmwpLnNlYXJjaFBhcmFtcy5nZXQoJ3ZzY29kZS1jb2knKTsKCQlpZiAoY29pUmVxdWVzdCA9PT0gJzMnKSB7CgkJCWhlYWRlcnNbJ0Nyb3NzLU9yaWdpbi1PcGVuZXItUG9saWN5J10gPSAnc2FtZS1vcmlnaW4nOwoJCQloZWFkZXJzWydDcm9zcy1PcmlnaW4tRW1iZWRkZXItUG9saWN5J10gPSAncmVxdWlyZS1jb3JwJzsKCQl9IGVsc2UgaWYgKGNvaVJlcXVlc3QgPT09ICcyJykgewoJCQloZWFkZXJzWydDcm9zcy1PcmlnaW4tRW1iZWRkZXItUG9saWN5J10gPSAncmVxdWlyZS1jb3JwJzsKCQl9IGVsc2UgaWYgKGNvaVJlcXVlc3QgPT09ICcxJykgewoJCQloZWFkZXJzWydDcm9zcy1PcmlnaW4tT3BlbmVyLVBvbGljeSddID0gJ3NhbWUtb3JpZ2luJzsKCQl9CgoJCWNvbnN0IHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKGVudHJ5LmRhdGEsIHsKCQkJc3RhdHVzOiAyMDAsCgkJCWhlYWRlcnMKCQl9KTsKCgkJaWYgKHNob3VsZFRyeUNhY2hpbmcgJiYgZW50cnkuZXRhZykgewoJCQljYWNoZXMub3BlbihyZXNvdXJjZUNhY2hlTmFtZSkudGhlbihjYWNoZSA9PiB7CgkJCQlyZXR1cm4gY2FjaGUucHV0KGV2ZW50LnJlcXVlc3QsIHJlc3BvbnNlKTsKCQkJfSk7CgkJfQoJCXJldHVybiByZXNwb25zZS5jbG9uZSgpOwoJfTsKCgkvKiogQHR5cGUge1Jlc3BvbnNlfHVuZGVmaW5lZH0gKi8KCWxldCBjYWNoZWQ7CglpZiAoc2hvdWxkVHJ5Q2FjaGluZykgewoJCWNvbnN0IGNhY2hlID0gYXdhaXQgY2FjaGVzLm9wZW4ocmVzb3VyY2VDYWNoZU5hbWUpOwoJCWNhY2hlZCA9IGF3YWl0IGNhY2hlLm1hdGNoKGV2ZW50LnJlcXVlc3QpOwoJfQoKCWNvbnN0IHsgcmVxdWVzdElkLCBwcm9taXNlIH0gPSByZXNvdXJjZVJlcXVlc3RTdG9yZS5jcmVhdGUoKTsKCglpZiAod2Vidmlld0lkKSB7CgkJY29uc3QgcGFyZW50Q2xpZW50cyA9IGF3YWl0IGdldE91dGVySWZyYW1lQ2xpZW50KHdlYnZpZXdJZCk7CgkJaWYgKCFwYXJlbnRDbGllbnRzLmxlbmd0aCkgewoJCQljb25zb2xlLmxvZygnQ291bGQgbm90IGZpbmQgcGFyZW50IGNsaWVudCBmb3IgcmVxdWVzdCcpOwoJCQlyZXR1cm4gbm90Rm91bmQoKTsKCQl9CgoJCWZvciAoY29uc3QgcGFyZW50Q2xpZW50IG9mIHBhcmVudENsaWVudHMpIHsKCQkJcGFyZW50Q2xpZW50LnBvc3RNZXNzYWdlKHsKCQkJCWNoYW5uZWw6ICdsb2FkLXJlc291cmNlJywKCQkJCWlkOiByZXF1ZXN0SWQsCgkJCQlzY2hlbWU6IHJlcXVlc3RVcmxDb21wb25lbnRzLnNjaGVtZSwKCQkJCWF1dGhvcml0eTogcmVxdWVzdFVybENvbXBvbmVudHMuYXV0aG9yaXR5LAoJCQkJcGF0aDogcmVxdWVzdFVybENvbXBvbmVudHMucGF0aCwKCQkJCXF1ZXJ5OiByZXF1ZXN0VXJsQ29tcG9uZW50cy5xdWVyeSwKCQkJCWlmTm9uZU1hdGNoOiBjYWNoZWQ/LmhlYWRlcnMuZ2V0KCdFVGFnJyksCgkJCX0pOwoJCX0KCX0gZWxzZSBpZiAoY2xpZW50LnR5cGUgPT09ICd3b3JrZXInIHx8IGNsaWVudC50eXBlID09PSAnc2hhcmVkd29ya2VyJykgewoJCW91dGVySWZyYW1lTWVzc2FnZVBvcnQ/LnBvc3RNZXNzYWdlKHsKCQkJY2hhbm5lbDogJ2xvYWQtcmVzb3VyY2UnLAoJCQlpZDogcmVxdWVzdElkLAoJCQlzY2hlbWU6IHJlcXVlc3RVcmxDb21wb25lbnRzLnNjaGVtZSwKCQkJYXV0aG9yaXR5OiByZXF1ZXN0VXJsQ29tcG9uZW50cy5hdXRob3JpdHksCgkJCXBhdGg6IHJlcXVlc3RVcmxDb21wb25lbnRzLnBhdGgsCgkJCXF1ZXJ5OiByZXF1ZXN0VXJsQ29tcG9uZW50cy5xdWVyeSwKCQkJaWZOb25lTWF0Y2g6IGNhY2hlZD8uaGVhZGVycy5nZXQoJ0VUYWcnKSwKCQl9KTsKCX0KCglyZXR1cm4gcHJvbWlzZS50aGVuKGVudHJ5ID0+IHJlc29sdmVSZXNvdXJjZUVudHJ5KGVudHJ5LCBjYWNoZWQpKTsKfQoKLyoqCiAqIEBwYXJhbSB7RmV0Y2hFdmVudH0gZXZlbnQKICogQHBhcmFtIHtVUkx9IHJlcXVlc3RVcmwKICogQHJldHVybnMge1Byb21pc2U8UmVzcG9uc2U+fQogKi8KYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0xvY2FsaG9zdFJlcXVlc3QoCglldmVudCwKCXJlcXVlc3RVcmwKKSB7Cgljb25zdCBjbGllbnQgPSBhd2FpdCBzdy5jbGllbnRzLmdldChldmVudC5jbGllbnRJZCk7CglpZiAoIWNsaWVudCkgewoJCS8vIFRoaXMgaXMgZXhwZWN0ZWQgd2hlbiByZXF1ZXN0aW5nIHJlc291cmNlcyBvbiBvdGhlciBsb2NhbGhvc3QgcG9ydHMKCQkvLyB0aGF0IGFyZSBub3Qgc3Bhd25lZCBieSB2cyBjb2RlCgkJcmV0dXJuIGZldGNoKGV2ZW50LnJlcXVlc3QpOwoJfQoJY29uc3Qgd2Vidmlld0lkID0gZ2V0V2Vidmlld0lkRm9yQ2xpZW50KGNsaWVudCk7CgkvLyBSZWZzIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlL2lzc3Vlcy8yNDQxNDMKCS8vIFdpdGggUGx6RGVkaWNhdGVkV29ya2VyLCB3b3JrZXIgc3VicmVzb3VyY2VzIGFuZCBibG9iIHdva2VycwoJLy8gd2lsbCB1c2UgY2xpZW50cyBkaWZmZXJlbnQgZnJvbSB0aGUgd2luZG93IGNsaWVudC4KCS8vIFNpbmNlIHdlIGNhbm5vdCBkaWZmZXJlbnQgYSB3b3JrZXIgbWFpbiByZXNvdXJjZSBmcm9tIGEgd29ya2VyIHN1YnJlc291cmNlCgkvLyB3ZSB3aWxsIHVzZSBtZXNzYWdlIGNoYW5uZWwgdG8gdGhlIG91dGVyIGlmcmFtZSBwcm92aWRlZCBhdCB0aGUgdGltZQoJLy8gb2Ygc2VydmljZSB3b3JrZXIgY29udHJvbGxlciB2ZXJzaW9uIGluaXRpYWxpemF0aW9uLgoJaWYgKCF3ZWJ2aWV3SWQgJiYgY2xpZW50LnR5cGUgIT09ICd3b3JrZXInICYmIGNsaWVudC50eXBlICE9PSAnc2hhcmVkd29ya2VyJykgewoJCWNvbnNvbGUuZXJyb3IoJ0NvdWxkIG5vdCByZXNvbHZlIHdlYnZpZXcgaWQnKTsKCQlyZXR1cm4gZmV0Y2goZXZlbnQucmVxdWVzdCk7Cgl9CgoJY29uc3Qgb3JpZ2luID0gcmVxdWVzdFVybC5vcmlnaW47CgoJLyoqCgkgKiBAcGFyYW0ge1JlcXVlc3RTdG9yZVJlc3VsdDxzdHJpbmd8dW5kZWZpbmVkPn0gcmVzdWx0CgkgKiBAcmV0dXJucyB7UHJvbWlzZTxSZXNwb25zZT59CgkgKi8KCWNvbnN0IHJlc29sdmVSZWRpcmVjdCA9IGFzeW5jIGZ1bmN0aW9uIChyZXN1bHQpIHsKCQlpZiAocmVzdWx0LnN0YXR1cyAhPT0gJ29rJyB8fCAhcmVzdWx0LnZhbHVlKSB7CgkJCXJldHVybiBmZXRjaChldmVudC5yZXF1ZXN0KTsKCQl9CgoJCWNvbnN0IHJlZGlyZWN0T3JpZ2luID0gcmVzdWx0LnZhbHVlOwoJCWNvbnN0IGxvY2F0aW9uID0gZXZlbnQucmVxdWVzdC51cmwucmVwbGFjZShuZXcgUmVnRXhwKGBeJHtyZXF1ZXN0VXJsLm9yaWdpbn0oL3wkKWApLCBgJHtyZWRpcmVjdE9yaWdpbn0kMWApOwoJCXJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwgewoJCQlzdGF0dXM6IDMwMiwKCQkJaGVhZGVyczogewoJCQkJTG9jYXRpb246IGxvY2F0aW9uCgkJCX0KCQl9KTsKCX07CgoJY29uc3QgeyByZXF1ZXN0SWQsIHByb21pc2UgfSA9IGxvY2FsaG9zdFJlcXVlc3RTdG9yZS5jcmVhdGUoKTsKCWlmICh3ZWJ2aWV3SWQpIHsKCQljb25zdCBwYXJlbnRDbGllbnRzID0gYXdhaXQgZ2V0T3V0ZXJJZnJhbWVDbGllbnQod2Vidmlld0lkKTsKCQlpZiAoIXBhcmVudENsaWVudHMubGVuZ3RoKSB7CgkJCWNvbnNvbGUubG9nKCdDb3VsZCBub3QgZmluZCBwYXJlbnQgY2xpZW50IGZvciByZXF1ZXN0Jyk7CgkJCXJldHVybiBub3RGb3VuZCgpOwoJCX0KCQlmb3IgKGNvbnN0IHBhcmVudENsaWVudCBvZiBwYXJlbnRDbGllbnRzKSB7CgkJCXBhcmVudENsaWVudC5wb3N0TWVzc2FnZSh7CgkJCQljaGFubmVsOiAnbG9hZC1sb2NhbGhvc3QnLAoJCQkJb3JpZ2luOiBvcmlnaW4sCgkJCQlpZDogcmVxdWVzdElkLAoJCQl9KTsKCQl9Cgl9IGVsc2UgaWYgKGNsaWVudC50eXBlID09PSAnd29ya2VyJyB8fCBjbGllbnQudHlwZSA9PT0gJ3NoYXJlZHdvcmtlcicpIHsKCQlvdXRlcklmcmFtZU1lc3NhZ2VQb3J0Py5wb3N0TWVzc2FnZSh7CgkJCWNoYW5uZWw6ICdsb2FkLWxvY2FsaG9zdCcsCgkJCW9yaWdpbjogb3JpZ2luLAoJCQlpZDogcmVxdWVzdElkLAoJCX0pOwoJfQoKCXJldHVybiBwcm9taXNlLnRoZW4ocmVzb2x2ZVJlZGlyZWN0KTsKfQoKLyoqCiAqIEBwYXJhbSB7Q2xpZW50fSBjbGllbnQKICogQHJldHVybnMge3N0cmluZ3xudWxsfQogKi8KZnVuY3Rpb24gZ2V0V2Vidmlld0lkRm9yQ2xpZW50KGNsaWVudCkgewoJY29uc3QgcmVxdWVzdGVyQ2xpZW50VXJsID0gbmV3IFVSTChjbGllbnQudXJsKTsKCXJldHVybiByZXF1ZXN0ZXJDbGllbnRVcmwuc2VhcmNoUGFyYW1zLmdldCgnaWQnKTsKfQoKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSB3ZWJ2aWV3SWQKICogQHJldHVybnMge1Byb21pc2U8Q2xpZW50W10+fQogKi8KYXN5bmMgZnVuY3Rpb24gZ2V0T3V0ZXJJZnJhbWVDbGllbnQod2Vidmlld0lkKSB7Cgljb25zdCBhbGxDbGllbnRzID0gYXdhaXQgc3cuY2xpZW50cy5tYXRjaEFsbCh7IGluY2x1ZGVVbmNvbnRyb2xsZWQ6IHRydWUgfSk7CglyZXR1cm4gYWxsQ2xpZW50cy5maWx0ZXIoY2xpZW50ID0+IHsKCQljb25zdCBjbGllbnRVcmwgPSBuZXcgVVJMKGNsaWVudC51cmwpOwoJCXJldHVybiBjbGllbnRVcmwuc2VhcmNoUGFyYW1zLmdldCgnaWQnKSA9PT0gd2Vidmlld0lkOwoJfSk7Cn0KCi8qKgogKiBAcGFyYW0ge3N0cmluZ30gY2xpZW50SWQKICogQHJldHVybnMge1Byb21pc2U8Q2xpZW50fHVuZGVmaW5lZD59CiAqLwphc3luYyBmdW5jdGlvbiBnZXRXb3JrZXJDbGllbnRGb3JJZChjbGllbnRJZCkgewoJY29uc3QgYWxsRGVkaWNhdGVkV29ya2VyQ2xpZW50cyA9IGF3YWl0IHN3LmNsaWVudHMubWF0Y2hBbGwoeyB0eXBlOiAnd29ya2VyJyB9KTsKCWNvbnN0IGFsbFNoYXJlZFdvcmtlckNsaWVudHMgPSBhd2FpdCBzdy5jbGllbnRzLm1hdGNoQWxsKHsgdHlwZTogJ3NoYXJlZHdvcmtlcicgfSk7Cgljb25zdCBhbGxXb3JrZXJDbGllbnRzID0gWy4uLmFsbERlZGljYXRlZFdvcmtlckNsaWVudHMsIC4uLmFsbFNoYXJlZFdvcmtlckNsaWVudHNdOwoJcmV0dXJuIGFsbFdvcmtlckNsaWVudHMuZmluZChjbGllbnQgPT4gewoJCXJldHVybiBjbGllbnQuaWQgPT09IGNsaWVudElkOwoJfSk7Cn0KCgovKioKICogQHR5cGVkZWYgeygKICogICB8IHsgcmVhZG9ubHkgc3RhdHVzOiAyMDAsIGlkOiBudW1iZXIsIHBhdGg6IHN0cmluZywgbWltZTogc3RyaW5nLCBkYXRhOiBVaW50OEFycmF5LCBldGFnOiBzdHJpbmd8dW5kZWZpbmVkLCBtdGltZTogbnVtYmVyfHVuZGVmaW5lZCB9CiAqICAgfCB7IHJlYWRvbmx5IHN0YXR1czogMzA0LCBpZDogbnVtYmVyLCBwYXRoOiBzdHJpbmcsIG1pbWU6IHN0cmluZywgbXRpbWU6IG51bWJlcnx1bmRlZmluZWQgfQogKiAgIHwgeyByZWFkb25seSBzdGF0dXM6IDQwMSwgaWQ6IG51bWJlciwgcGF0aDogc3RyaW5nIH0KICogICB8IHsgcmVhZG9ubHkgc3RhdHVzOiA0MDQsIGlkOiBudW1iZXIsIHBhdGg6IHN0cmluZyB9CiAqICl9IFJlc291cmNlUmVzcG9uc2UKICovCg==","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,qb),"vs/workbench/contrib/webview/browser/pre/index.html":()=>(0,ut.hd)(new URL("data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIiBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsiPgoKPGhlYWQ+Cgk8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CgoJPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1TZWN1cml0eS1Qb2xpY3kiCgkJY29udGVudD0iZGVmYXVsdC1zcmMgJ25vbmUnOyBzY3JpcHQtc3JjICdzaGEyNTYtL1VYVVpHakRGODhSWXRVTFNTVHBETjZQYXByd3V2aDM4bGltTzkyQ3hIMD0nICdzZWxmJzsgZnJhbWUtc3JjICdzZWxmJzsgc3R5bGUtc3JjICd1bnNhZmUtaW5saW5lJzsiPgoKCTwhLS0gRGlzYWJsZSBwaW5jaCB6b29taW5nIC0tPgoJPG1ldGEgbmFtZT0idmlld3BvcnQiCgkJY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIG1pbmltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIj4KPC9oZWFkPgoKPGJvZHkgc3R5bGU9Im1hcmdpbjogMDsgb3ZlcmZsb3c6IGhpZGRlbjsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgb3ZlcnNjcm9sbC1iZWhhdmlvci14OiBub25lOyIgcm9sZT0iZG9jdW1lbnQiPgoJPHNjcmlwdCBhc3luYyB0eXBlPSJtb2R1bGUiPgoJCS8vIEB0cy1jaGVjawoJCS8vLyA8cmVmZXJlbmNlIGxpYj0iZG9tIiAvPgoKCQljb25zdCBpc1NhZmFyaSA9ICgKCQkJbmF2aWdhdG9yLnZlbmRvciAmJiBuYXZpZ2F0b3IudmVuZG9yLmluZGV4T2YoJ0FwcGxlJykgPiAtMSAmJgoJCQluYXZpZ2F0b3IudXNlckFnZW50ICYmCgkJCW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignQ3JpT1MnKSA9PT0gLTEgJiYKCQkJbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdGeGlPUycpID09PSAtMQoJCSk7CgoJCWNvbnN0IGlzRmlyZWZveCA9ICgKCQkJbmF2aWdhdG9yLnVzZXJBZ2VudCAmJgoJCQluYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0ZpcmVmb3gnKSA+PSAwCgkJKTsKCgkJY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTChsb2NhdGlvbi50b1N0cmluZygpKS5zZWFyY2hQYXJhbXM7CgkJY29uc3QgSUQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdpZCcpOwoJCWNvbnN0IHdlYnZpZXdPcmlnaW4gPSBzZWFyY2hQYXJhbXMuZ2V0KCdvcmlnaW4nKTsKCQljb25zdCBvbkVsZWN0cm9uID0gc2VhcmNoUGFyYW1zLmdldCgncGxhdGZvcm0nKSA9PT0gJ2VsZWN0cm9uJzsKCQljb25zdCBkaXNhYmxlU2VydmljZVdvcmtlciA9IHNlYXJjaFBhcmFtcy5oYXMoJ2Rpc2FibGVTZXJ2aWNlV29ya2VyJyk7CgkJY29uc3QgZXhwZWN0ZWRXb3JrZXJWZXJzaW9uID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnc3dWZXJzaW9uJykpOwoJCWNvbnN0IHNlcnZpY2VXb3JrZXJVcmkgPSBzZWFyY2hQYXJhbXMuZ2V0KCdzZXJ2aWNlV29ya2VyVXJpJyk7CgkJY29uc3QgZmFrZUh0bWxVcmkgPSBzZWFyY2hQYXJhbXMuZ2V0KCdmYWtlSHRtbFVyaScpOwoKCQkvKioKCQkgKiBAcGFyYW0ge3N0cmluZ30gbmFtZQoJCSAqIEBwYXJhbSB7UmVjb3JkPHN0cmluZywgc3RyaW5nPn0gW29wdGlvbnNdCgkJICovCgkJY29uc3QgcGVyZk1hcmsgPSAobmFtZSwgb3B0aW9ucyA9IHt9KSA9PiB7CgkJCXBlcmZvcm1hbmNlLm1hcmsoYHdlYnZpZXcvaW5kZXguaHRtbC8ke25hbWV9YCwgewoJCQkJZGV0YWlsOiB7CgkJCQkJaWQ6IElELAoJCQkJCS4uLm9wdGlvbnMKCQkJCX0KCQkJfSk7CgkJfQoKCQlwZXJmTWFyaygnc2NyaXB0U3RhcnQnKTsKCgkJLyoqIEB0eXBlIHtNZXNzYWdlQ2hhbm5lbCB8IHVuZGVmaW5lZH0gKi8KCQlsZXQgb3V0ZXJJZnJhbWVNZXNzYWdlQ2hhbm5lbDsKCgkJLyoqCgkJICogVXNlIHBvbGxpbmcgdG8gdHJhY2sgZm9jdXMgb2YgbWFpbiB3ZWJ2aWV3IGFuZCBpZnJhbWVzIHdpdGhpbiB0aGUgd2VidmlldwoJCSAqCgkJICogQHBhcmFtIHtPYmplY3R9IGhhbmRsZXJzCgkJICogQHBhcmFtIHsoKSA9PiB2b2lkfSBoYW5kbGVycy5vbkZvY3VzCgkJICogQHBhcmFtIHsoKSA9PiB2b2lkfSBoYW5kbGVycy5vbkJsdXIKCQkgKi8KCQljb25zdCB0cmFja0ZvY3VzID0gKHsgb25Gb2N1cywgb25CbHVyIH0pID0+IHsKCQkJY29uc3QgaW50ZXJ2YWwgPSAyNTA7CgkJCWxldCBpc0ZvY3VzZWQgPSBkb2N1bWVudC5oYXNGb2N1cygpOwoJCQlzZXRJbnRlcnZhbCgoKSA9PiB7CgkJCQljb25zdCB0YXJnZXQgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJY29uc3QgaXNDdXJyZW50bHlGb2N1c2VkID0gZG9jdW1lbnQuaGFzRm9jdXMoKSB8fCAhISh0YXJnZXQgJiYgdGFyZ2V0LmNvbnRlbnREb2N1bWVudCAmJiB0YXJnZXQuY29udGVudERvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKCd2c2NvZGUtY29udGV4dC1tZW51LXZpc2libGUnKSk7CgkJCQlpZiAoaXNDdXJyZW50bHlGb2N1c2VkID09PSBpc0ZvY3VzZWQpIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCQlpc0ZvY3VzZWQgPSBpc0N1cnJlbnRseUZvY3VzZWQ7CgkJCQlpZiAoaXNDdXJyZW50bHlGb2N1c2VkKSB7CgkJCQkJb25Gb2N1cygpOwoJCQkJfSBlbHNlIHsKCQkJCQlvbkJsdXIoKTsKCQkJCX0KCQkJfSwgaW50ZXJ2YWwpOwoJCX07CgoJCWNvbnN0IGdldEFjdGl2ZUZyYW1lID0gKCkgPT4gewoJCQlyZXR1cm4gLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudCB8IHVuZGVmaW5lZH0gKi8gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3RpdmUtZnJhbWUnKSk7CgkJfTsKCgkJY29uc3QgZ2V0UGVuZGluZ0ZyYW1lID0gKCkgPT4gewoJCQlyZXR1cm4gLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudCB8IHVuZGVmaW5lZH0gKi8gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW5kaW5nLWZyYW1lJykpOwoJCX07CgoJCS8qKgoJCSAqIEB0ZW1wbGF0ZSBUCgkJICogQHBhcmFtIHtUIHwgdW5kZWZpbmVkIHwgbnVsbH0gb2JqCgkJICogQHJldHVybiB7VH0KCQkgKi8KCQlmdW5jdGlvbiBhc3NlcnRJc0RlZmluZWQob2JqKSB7CgkJCWlmICh0eXBlb2Ygb2JqID09PSAndW5kZWZpbmVkJyB8fCBvYmogPT09IG51bGwpIHsKCQkJCXRocm93IG5ldyBFcnJvcignRm91bmQgdW5leHBlY3RlZCBudWxsJyk7CgkJCX0KCQkJcmV0dXJuIG9iajsKCQl9CgoJCWNvbnN0IHZzY29kZVBvc3RNZXNzYWdlRnVuY05hbWUgPSAnX192c2NvZGVfcG9zdF9tZXNzYWdlX18nOwoKCQljb25zdCBkZWZhdWx0U3R5bGVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKCQlkZWZhdWx0U3R5bGVzLmlkID0gJ19kZWZhdWx0U3R5bGVzJzsKCQlkZWZhdWx0U3R5bGVzLnRleHRDb250ZW50ID0gYAoJCUBsYXllciB2c2NvZGUtZGVmYXVsdCB7CgkJCWh0bWwgewoJCQkJc2Nyb2xsYmFyLWNvbG9yOiB2YXIoLS12c2NvZGUtc2Nyb2xsYmFyU2xpZGVyLWJhY2tncm91bmQpIHZhcigtLXZzY29kZS1lZGl0b3ItYmFja2dyb3VuZCk7CgkJCX0KCgkJCWJvZHkgewoJCQkJb3ZlcnNjcm9sbC1iZWhhdmlvci14OiBub25lOwoJCQkJYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLWVkaXRvci1mb3JlZ3JvdW5kKTsKCQkJCWZvbnQtZmFtaWx5OiB2YXIoLS12c2NvZGUtZm9udC1mYW1pbHkpOwoJCQkJZm9udC13ZWlnaHQ6IHZhcigtLXZzY29kZS1mb250LXdlaWdodCk7CgkJCQlmb250LXNpemU6IHZhcigtLXZzY29kZS1mb250LXNpemUpOwoJCQkJbWFyZ2luOiAwOwoJCQkJcGFkZGluZzogMCAyMHB4OwoJCQl9CgoJCQlpbWcsIHZpZGVvIHsKCQkJCW1heC13aWR0aDogMTAwJTsKCQkJCW1heC1oZWlnaHQ6IDEwMCU7CgkJCX0KCgkJCWEsIGEgY29kZSB7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLXRleHRMaW5rLWZvcmVncm91bmQpOwoJCQl9CgoJCQlwID4gYSB7CgkJCQl0ZXh0LWRlY29yYXRpb246IHZhcigtLXRleHQtbGluay1kZWNvcmF0aW9uKTsKCQkJfQoKCQkJYTpob3ZlciB7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLXRleHRMaW5rLWFjdGl2ZUZvcmVncm91bmQpOwoJCQl9CgoJCQlhOmZvY3VzLAoJCQlpbnB1dDpmb2N1cywKCQkJc2VsZWN0OmZvY3VzLAoJCQl0ZXh0YXJlYTpmb2N1cyB7CgkJCQlvdXRsaW5lOiAxcHggc29saWQgLXdlYmtpdC1mb2N1cy1yaW5nLWNvbG9yOwoJCQkJb3V0bGluZS1vZmZzZXQ6IC0xcHg7CgkJCX0KCgkJCWNvZGUgewoJCQkJZm9udC1mYW1pbHk6IHZhcigtLW1vbmFjby1tb25vc3BhY2UtZm9udCk7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLXRleHRQcmVmb3JtYXQtZm9yZWdyb3VuZCk7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS12c2NvZGUtdGV4dFByZWZvcm1hdC1iYWNrZ3JvdW5kKTsKCQkJCXBhZGRpbmc6IDFweCAzcHg7CgkJCQlib3JkZXItcmFkaXVzOiA0cHg7CgkJCX0KCgkJCXByZSBjb2RlIHsKCQkJCXBhZGRpbmc6IDA7CgkJCX0KCgkJCWJsb2NrcXVvdGUgewoJCQkJYmFja2dyb3VuZDogdmFyKC0tdnNjb2RlLXRleHRCbG9ja1F1b3RlLWJhY2tncm91bmQpOwoJCQkJYm9yZGVyLWNvbG9yOiB2YXIoLS12c2NvZGUtdGV4dEJsb2NrUXVvdGUtYm9yZGVyKTsKCQkJfQoKCQkJa2JkIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1rZXliaW5kaW5nTGFiZWwtYmFja2dyb3VuZCk7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLWtleWJpbmRpbmdMYWJlbC1mb3JlZ3JvdW5kKTsKCQkJCWJvcmRlci1zdHlsZTogc29saWQ7CgkJCQlib3JkZXItd2lkdGg6IDFweDsKCQkJCWJvcmRlci1yYWRpdXM6IDNweDsKCQkJCWJvcmRlci1jb2xvcjogdmFyKC0tdnNjb2RlLWtleWJpbmRpbmdMYWJlbC1ib3JkZXIpOwoJCQkJYm9yZGVyLWJvdHRvbS1jb2xvcjogdmFyKC0tdnNjb2RlLWtleWJpbmRpbmdMYWJlbC1ib3R0b21Cb3JkZXIpOwoJCQkJYm94LXNoYWRvdzogaW5zZXQgMCAtMXB4IDAgdmFyKC0tdnNjb2RlLXdpZGdldC1zaGFkb3cpOwoJCQkJdmVydGljYWwtYWxpZ246IG1pZGRsZTsKCQkJCXBhZGRpbmc6IDFweCAzcHg7CgkJCX0KCgkJCTo6LXdlYmtpdC1zY3JvbGxiYXIgewoJCQkJd2lkdGg6IDEwcHg7CgkJCQloZWlnaHQ6IDEwcHg7CgkJCX0KCgkJCTo6LXdlYmtpdC1zY3JvbGxiYXItY29ybmVyIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1lZGl0b3ItYmFja2dyb3VuZCk7CgkJCX0KCgkJCTo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgewoJCQkJYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tdnNjb2RlLXNjcm9sbGJhclNsaWRlci1iYWNrZ3JvdW5kKTsKCQkJfQoJCQk6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1zY3JvbGxiYXJTbGlkZXItaG92ZXJCYWNrZ3JvdW5kKTsKCQkJfQoJCQk6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmFjdGl2ZSB7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS12c2NvZGUtc2Nyb2xsYmFyU2xpZGVyLWFjdGl2ZUJhY2tncm91bmQpOwoJCQl9CgkJCTo6aGlnaGxpZ2h0KGZpbmQtaGlnaGxpZ2h0KSB7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS12c2NvZGUtZWRpdG9yLWZpbmRNYXRjaEhpZ2hsaWdodEJhY2tncm91bmQpOwoJCQl9CgkJCTo6aGlnaGxpZ2h0KGN1cnJlbnQtZmluZC1oaWdobGlnaHQpIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1lZGl0b3ItZmluZE1hdGNoQmFja2dyb3VuZCk7CgkJCX0KCQkJfWA7CgoJCS8qKgoJCSAqIEBwYXJhbSB7Ym9vbGVhbn0gYWxsb3dNdWx0aXBsZUFQSUFjcXVpcmUKCQkgKiBAcGFyYW0geyp9IFtzdGF0ZV0KCQkgKiBAcmV0dXJuIHtzdHJpbmd9CgkJICovCgkJZnVuY3Rpb24gZ2V0VnNDb2RlQXBpU2NyaXB0KGFsbG93TXVsdGlwbGVBUElBY3F1aXJlLCBzdGF0ZSkgewoJCQljb25zdCBlbmNvZGVkU3RhdGUgPSBzdGF0ZSA/IGVuY29kZVVSSUNvbXBvbmVudChzdGF0ZSkgOiB1bmRlZmluZWQ7CgkJCXJldHVybiAvKiBqcyAqL2AKCQkJCQlnbG9iYWxUaGlzLmFjcXVpcmVWc0NvZGVBcGkgPSAoZnVuY3Rpb24oKSB7CgkJCQkJCWNvbnN0IG9yaWdpbmFsUG9zdE1lc3NhZ2UgPSB3aW5kb3cucGFyZW50Wycke3ZzY29kZVBvc3RNZXNzYWdlRnVuY05hbWV9J10uYmluZCh3aW5kb3cucGFyZW50KTsKCQkJCQkJY29uc3QgZG9Qb3N0TWVzc2FnZSA9IChjaGFubmVsLCBkYXRhLCB0cmFuc2ZlcikgPT4gewoJCQkJCQkJb3JpZ2luYWxQb3N0TWVzc2FnZShjaGFubmVsLCBkYXRhLCB0cmFuc2Zlcik7CgkJCQkJCX07CgoJCQkJCQlsZXQgYWNxdWlyZWQgPSBmYWxzZTsKCgkJCQkJCWxldCBzdGF0ZSA9ICR7c3RhdGUgPyBgSlNPTi5wYXJzZShkZWNvZGVVUklDb21wb25lbnQoIiR7ZW5jb2RlZFN0YXRlfSIpKWAgOiB1bmRlZmluZWR9OwoKCQkJCQkJcmV0dXJuICgpID0+IHsKCQkJCQkJCWlmIChhY3F1aXJlZCAmJiAhJHthbGxvd011bHRpcGxlQVBJQWNxdWlyZX0pIHsKCQkJCQkJCQl0aHJvdyBuZXcgRXJyb3IoJ0FuIGluc3RhbmNlIG9mIHRoZSBWUyBDb2RlIEFQSSBoYXMgYWxyZWFkeSBiZWVuIGFjcXVpcmVkJyk7CgkJCQkJCQl9CgkJCQkJCQlhY3F1aXJlZCA9IHRydWU7CgkJCQkJCQlyZXR1cm4gT2JqZWN0LmZyZWV6ZSh7CgkJCQkJCQkJcG9zdE1lc3NhZ2U6IGZ1bmN0aW9uKG1lc3NhZ2UsIHRyYW5zZmVyKSB7CgkJCQkJCQkJCWRvUG9zdE1lc3NhZ2UoJ29ubWVzc2FnZScsIHsgbWVzc2FnZSwgdHJhbnNmZXIgfSwgdHJhbnNmZXIpOwoJCQkJCQkJCX0sCgkJCQkJCQkJc2V0U3RhdGU6IGZ1bmN0aW9uKG5ld1N0YXRlKSB7CgkJCQkJCQkJCXN0YXRlID0gbmV3U3RhdGU7CgkJCQkJCQkJCWRvUG9zdE1lc3NhZ2UoJ2RvLXVwZGF0ZS1zdGF0ZScsIEpTT04uc3RyaW5naWZ5KG5ld1N0YXRlKSk7CgkJCQkJCQkJCXJldHVybiBuZXdTdGF0ZTsKCQkJCQkJCQl9LAoJCQkJCQkJCWdldFN0YXRlOiBmdW5jdGlvbigpIHsKCQkJCQkJCQkJcmV0dXJuIHN0YXRlOwoJCQkJCQkJCX0KCQkJCQkJCX0pOwoJCQkJCQl9OwoJCQkJCX0pKCk7CgkJCQkJd2luZG93LnBhcmVudCA9IHdpbmRvdzsKCQkJCQl3aW5kb3cudG9wID0gd2luZG93OwoJCQkJCXdpbmRvdy5mcmFtZUVsZW1lbnQgPSBudWxsOwoJCQkJYDsKCQl9CgoJCS8qKiBAdHlwZSB7UHJvbWlzZTx2b2lkPn0gKi8KCQljb25zdCB3b3JrZXJSZWFkeSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKCQkJaWYgKGRpc2FibGVTZXJ2aWNlV29ya2VyKSB7CgkJCQlyZXR1cm4gcmVzb2x2ZSgpOwoJCQl9CgoJCQlpZiAoIWFyZVNlcnZpY2VXb3JrZXJzRW5hYmxlZCgpKSB7CgkJCQlyZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignU2VydmljZSBXb3JrZXJzIGFyZSBub3QgZW5hYmxlZC4gV2Vidmlld3Mgd2lsbCBub3Qgd29yay4gVHJ5IGRpc2FibGluZyBwcml2YXRlL2luY29nbml0byBtb2RlLicpKTsKCQkJfQoKCQkJY29uc3Qgc3dQYXRoID0gZW5jb2RlVVJJKGAke3NlcnZpY2VXb3JrZXJVcml9P3Y9JHtleHBlY3RlZFdvcmtlclZlcnNpb259JnZzY29kZS1yZXNvdXJjZS1iYXNlLWF1dGhvcml0eT0ke3NlYXJjaFBhcmFtcy5nZXQoJ3ZzY29kZS1yZXNvdXJjZS1iYXNlLWF1dGhvcml0eScpfSZyZW1vdGVBdXRob3JpdHk9JHtzZWFyY2hQYXJhbXMuZ2V0KCdyZW1vdGVBdXRob3JpdHknKSA/PyAnJ31gKTsKCQkJbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoc3dQYXRoLCB7IHR5cGU6ICdtb2R1bGUnIH0pCgkJCQkudGhlbihhc3luYyByZWdpc3RyYXRpb24gPT4gewoJCQkJCS8qKgoJCQkJCSAqIEBwYXJhbSB7TWVzc2FnZUV2ZW50fSBldmVudAoJCQkJCSAqLwoJCQkJCWNvbnN0IHZlcnNpb25IYW5kbGVyID0gYXN5bmMgKGV2ZW50KSA9PiB7CgkJCQkJCWlmIChldmVudC5kYXRhLmNoYW5uZWwgIT09ICd2ZXJzaW9uJykgewoJCQkJCQkJcmV0dXJuOwoJCQkJCQl9CgoJCQkJCQluYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdmVyc2lvbkhhbmRsZXIpOwoJCQkJCQlpZiAoZXZlbnQuZGF0YS52ZXJzaW9uID09PSBleHBlY3RlZFdvcmtlclZlcnNpb24pIHsKCQkJCQkJCXJldHVybiByZXNvbHZlKCk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljb25zb2xlLmxvZyhgRm91bmQgdW5leHBlY3RlZCBzZXJ2aWNlIHdvcmtlciB2ZXJzaW9uLiBGb3VuZDogJHtldmVudC5kYXRhLnZlcnNpb259LiBFeHBlY3RlZDogJHtleHBlY3RlZFdvcmtlclZlcnNpb259YCk7CgkJCQkJCQljb25zb2xlLmxvZyhgQXR0ZW1wdGluZyB0byByZWxvYWQgc2VydmljZSB3b3JrZXJgKTsKCgkJCQkJCQkvLyBJZiB3ZSBoYXZlIHRoZSB3cm9uZyB2ZXJzaW9uLCB0cnkgb25jZSAoYW5kIG9ubHkgb25jZSkgdG8gdW5yZWdpc3RlciBhbmQgcmUtcmVnaXN0ZXIKCQkJCQkJCS8vIE5vdGUgdGhhdCBgLnVwZGF0ZWAgZG9lc24ndCBzZWVtIHRvIHdvcmsgZGVza3RvcCBlbGVjdHJvbiBhdCB0aGUgbW9tZW50IHNvIHdlIHVzZQoJCQkJCQkJLy8gYHVucmVnaXN0ZXJgIGFuZCBgcmVnaXN0ZXJgIGhlcmUuCgkJCQkJCQlyZXR1cm4gcmVnaXN0cmF0aW9uLnVucmVnaXN0ZXIoKQoJCQkJCQkJCS50aGVuKCgpID0+IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKHN3UGF0aCkpCgkJCQkJCQkJLmZpbmFsbHkoKCkgPT4geyByZXNvbHZlKCk7IH0pOwoJCQkJCQl9CgkJCQkJfTsKCQkJCQluYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdmVyc2lvbkhhbmRsZXIpOwoKCQkJCQljb25zdCBwb3N0VmVyc2lvbk1lc3NhZ2UgPSAoLyoqIEB0eXBlIHtTZXJ2aWNlV29ya2VyfSAqLyBjb250cm9sbGVyKSA9PiB7CgkJCQkJCW91dGVySWZyYW1lTWVzc2FnZUNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTsKCQkJCQkJY29udHJvbGxlci5wb3N0TWVzc2FnZSh7IGNoYW5uZWw6ICd2ZXJzaW9uJyB9LCBbb3V0ZXJJZnJhbWVNZXNzYWdlQ2hhbm5lbC5wb3J0Ml0pOwoJCQkJCX07CgoJCQkJCS8vIEF0IHRoaXMgcG9pbnQsIGVpdGhlciB0aGUgc2VydmljZSB3b3JrZXIgaXMgcmVhZHkgYW5kCgkJCQkJLy8gYmVjYW1lIG91ciBjb250cm9sbGVyLCBvciB3ZSBuZWVkIHRvIHdhaXQgZm9yIGl0LgoJCQkJCS8vIE5vdGUgdGhhdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyIGNvdWxkIGJlIGEKCQkJCQkvLyBjb250cm9sbGVyIGZyb20gYSBwcmV2aW91c2x5IGxvYWRlZCBzZXJ2aWNlIHdvcmtlci4KCQkJCQljb25zdCBjdXJyZW50Q29udHJvbGxlciA9IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXI7CgkJCQkJaWYgKGN1cnJlbnRDb250cm9sbGVyPy5zY3JpcHRVUkwuZW5kc1dpdGgoc3dQYXRoKSkgewoJCQkJCQkvLyBzZXJ2aWNlIHdvcmtlciBhbHJlYWR5IGxvYWRlZCAmIHJlYWR5IHRvIHJlY2VpdmUgbWVzc2FnZXMKCQkJCQkJcG9zdFZlcnNpb25NZXNzYWdlKGN1cnJlbnRDb250cm9sbGVyKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlpZiAoY3VycmVudENvbnRyb2xsZXIpIHsKCQkJCQkJCWNvbnNvbGUubG9nKGBGb3VuZCB1bmV4cGVjdGVkIHNlcnZpY2Ugd29ya2VyIGNvbnRyb2xsZXIuIEZvdW5kOiAke2N1cnJlbnRDb250cm9sbGVyLnNjcmlwdFVSTH0uIEV4cGVjdGVkOiAke3N3UGF0aH0uIFdhaXRpbmcgZm9yIGNvbnRyb2xsZXJjaGFuZ2UuYCk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljb25zb2xlLmxvZyhgTm8gc2VydmljZSB3b3JrZXIgY29udHJvbGxlciBmb3VuZC4gV2FpdGluZyBmb3IgY29udHJvbGxlcmNoYW5nZS5gKTsKCQkJCQkJfQoKCQkJCQkJLy8gRWl0aGVyIHRoZXJlJ3Mgbm8gY29udHJvbGxpbmcgc2VydmljZSB3b3JrZXIsIG9yIGl0J3MgYW4gb2xkIG9uZS4KCQkJCQkJLy8gV2FpdCBmb3IgaXQgdG8gY2hhbmdlIGJlZm9yZSBwb3N0aW5nIHRoZSBtZXNzYWdlCgkJCQkJCWNvbnN0IG9uQ29udHJvbGxlckNoYW5nZSA9ICgpID0+IHsKCQkJCQkJCW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjaGFuZ2UnLCBvbkNvbnRyb2xsZXJDaGFuZ2UpOwoJCQkJCQkJaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHsKCQkJCQkJCQlwb3N0VmVyc2lvbk1lc3NhZ2UobmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlcik7CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCXJldHVybiByZWplY3QobmV3IEVycm9yKCdObyBjb250cm9sbGVyIGZvdW5kLicpKTsKCQkJCQkJCX0KCQkJCQkJfTsKCQkJCQkJbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNoYW5nZScsIG9uQ29udHJvbGxlckNoYW5nZSk7CgkJCQkJfQoJCQkJfSkuY2F0Y2goZXJyb3IgPT4gewoJCQkJCWlmICghb25FbGVjdHJvbiAmJiBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3VzZXIgZGVuaWVkIHBlcm1pc3Npb24nKSkgewoJCQkJCQlyZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihgQ291bGQgbm90IHJlZ2lzdGVyIHNlcnZpY2Ugd29ya2VyLiBQbGVhc2UgbWFrZSBzdXJlIHRoaXJkIHBhcnR5IGNvb2tpZXMgYXJlIGVuYWJsZWQ6ICR7ZXJyb3J9YCkpOwoJCQkJCX0KCQkJCQlyZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihgQ291bGQgbm90IHJlZ2lzdGVyIHNlcnZpY2Ugd29ya2VyOiAke2Vycm9yfS5gKSk7CgkJCQl9KTsKCQl9KTsKCgkJLyoqCgkJICogIEB0eXBlIHtpbXBvcnQoJy4uL3dlYnZpZXdNZXNzYWdlcycpLldlYnZpZXdIb3N0TWVzc2FnaW5nfQoJCSAqLwoJCWNvbnN0IGhvc3RNZXNzYWdpbmcgPSBuZXcgY2xhc3MgSG9zdE1lc3NhZ2luZyB7CgoJCQljb25zdHJ1Y3RvcigpIHsKCQkJCXRoaXMuY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwoKCQkJCS8qKiBAdHlwZSB7TWFwPHN0cmluZywgQXJyYXk8KGV2ZW50OiBNZXNzYWdlRXZlbnQsIGRhdGE6IGFueSkgPT4gdm9pZD4+fSAqLwoJCQkJdGhpcy5oYW5kbGVycyA9IG5ldyBNYXAoKTsKCgkJCQl0aGlzLmNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gKGUpID0+IHsKCQkJCQljb25zdCBjaGFubmVsID0gZS5kYXRhLmNoYW5uZWw7CgkJCQkJY29uc3QgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmdldChjaGFubmVsKTsKCQkJCQlpZiAoaGFuZGxlcnMpIHsKCQkJCQkJZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKSB7CgkJCQkJCQloYW5kbGVyKGUsIGUuZGF0YS5hcmdzKTsKCQkJCQkJfQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNvbnNvbGUubG9nKCdubyBoYW5kbGVyIGZvciAnLCBlKTsKCQkJCQl9CgkJCQl9OwoJCQl9CgoJCQlwb3N0TWVzc2FnZShjaGFubmVsLCBkYXRhLCB0cmFuc2ZlcikgewoJCQkJdGhpcy5jaGFubmVsLnBvcnQxLnBvc3RNZXNzYWdlKHsgY2hhbm5lbCwgZGF0YSB9LCB0cmFuc2Zlcik7CgkJCX0KCgkJCW9uTWVzc2FnZShjaGFubmVsLCBoYW5kbGVyKSB7CgkJCQlsZXQgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmdldChjaGFubmVsKTsKCQkJCWlmICghaGFuZGxlcnMpIHsKCQkJCQloYW5kbGVycyA9IFtdOwoJCQkJCXRoaXMuaGFuZGxlcnMuc2V0KGNoYW5uZWwsIGhhbmRsZXJzKTsKCQkJCX0KCQkJCWhhbmRsZXJzLnB1c2goaGFuZGxlcik7CgkJCX0KCgkJCWFzeW5jIHNpZ25hbFJlYWR5KCkgewoJCQkJY29uc3Qgc3RhcnQgPSAoLyoqIEB0eXBlIHtzdHJpbmd9ICovIHBhcmVudE9yaWdpbikgPT4gewoJCQkJCXBlcmZNYXJrKCdzaWduYWxpbmdSZWFkeScpOwoJCQkJCXdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoeyB0YXJnZXQ6IElELCBjaGFubmVsOiAnd2Vidmlldy1yZWFkeScsIGRhdGE6IHt9IH0sIHBhcmVudE9yaWdpbiwgW3RoaXMuY2hhbm5lbC5wb3J0Ml0pOwoJCQkJfTsKCgkJCQljb25zdCBwYXJlbnRPcmlnaW4gPSBzZWFyY2hQYXJhbXMuZ2V0KCdwYXJlbnRPcmlnaW4nKTsKCgkJCQlyZXR1cm4gc3RhcnQocGFyZW50T3JpZ2luKTsKCQkJfQoJCX0oKTsKCgkJY29uc3QgdW5sb2FkTW9uaXRvciA9IG5ldyBjbGFzcyB7CgoJCQljb25zdHJ1Y3RvcigpIHsKCQkJCXRoaXMuY29uZmlybUJlZm9yZUNsb3NlID0gJ2tleWJvYXJkT25seSc7CgkJCQl0aGlzLmlzTW9kaWZpZXJLZXlEb3duID0gZmFsc2U7CgoJCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ3NldC1jb25maXJtLWJlZm9yZS1jbG9zZScsIChfZSwgZGF0YSkgPT4gewoJCQkJCXRoaXMuY29uZmlybUJlZm9yZUNsb3NlID0gZGF0YTsKCQkJCX0pOwoKCQkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdjb250ZW50JywgKF9lLCBkYXRhKSA9PiB7CgkJCQkJdGhpcy5jb25maXJtQmVmb3JlQ2xvc2UgPSBkYXRhLmNvbmZpcm1CZWZvcmVDbG9zZTsKCQkJCX0pOwoKCQkJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCAoZXZlbnQpID0+IHsKCQkJCQlpZiAob25FbGVjdHJvbikgewoJCQkJCQlyZXR1cm47CgkJCQkJfQoKCQkJCQlzd2l0Y2ggKHRoaXMuY29uZmlybUJlZm9yZUNsb3NlKSB7CgkJCQkJCWNhc2UgJ2Fsd2F5cyc6IHsKCQkJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQkJCQlldmVudC5yZXR1cm5WYWx1ZSA9ICcnOwoJCQkJCQkJcmV0dXJuICcnOwoJCQkJCQl9CgkJCQkJCWNhc2UgJ25ldmVyJzogewoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQkJY2FzZSAna2V5Ym9hcmRPbmx5JzoKCQkJCQkJZGVmYXVsdDogewoJCQkJCQkJaWYgKHRoaXMuaXNNb2RpZmllcktleURvd24pIHsKCQkJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQkJCWV2ZW50LnJldHVyblZhbHVlID0gJyc7CgkJCQkJCQkJcmV0dXJuICcnOwoJCQkJCQkJfQoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQl9KTsKCQkJfQoKCQkJb25JZnJhbWVMb2FkZWQoLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudH0gKi8gZnJhbWUpIHsKCQkJCWFzc2VydElzRGVmaW5lZChmcmFtZS5jb250ZW50V2luZG93KS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZSA9PiB7CgkJCQkJdGhpcy5pc01vZGlmaWVyS2V5RG93biA9IGUubWV0YUtleSB8fCBlLmN0cmxLZXkgfHwgZS5hbHRLZXk7CgkJCQl9KTsKCgkJCQlhc3NlcnRJc0RlZmluZWQoZnJhbWUuY29udGVudFdpbmRvdykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoKSA9PiB7CgkJCQkJdGhpcy5pc01vZGlmaWVyS2V5RG93biA9IGZhbHNlOwoJCQkJfSk7CgkJCX0KCQl9OwoKCQkvLyBzdGF0ZQoJCWxldCBmaXJzdExvYWQgPSB0cnVlOwoJCS8qKiBAdHlwZSB7YW55fSAqLwoJCWxldCBsb2FkVGltZW91dDsKCQlsZXQgc3R5bGVWZXJzaW9uID0gMDsKCgkJLyoqIEB0eXBlIHtBcnJheTx7IHJlYWRvbmx5IG1lc3NhZ2U6IGFueSwgdHJhbnNmZXI/OiBBcnJheUJ1ZmZlcltdIH0+fSAqLwoJCWxldCBwZW5kaW5nTWVzc2FnZXMgPSBbXTsKCgkJY29uc3QgaW5pdERhdGEgPSB7CgkJCS8qKiBAdHlwZSB7bnVtYmVyIHwgdW5kZWZpbmVkfSAqLwoJCQlpbml0aWFsU2Nyb2xsUHJvZ3Jlc3M6IHVuZGVmaW5lZCwKCgkJCS8qKiBAdHlwZSB7eyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSB8IHVuZGVmaW5lZH0gKi8KCQkJc3R5bGVzOiB1bmRlZmluZWQsCgoJCQkvKiogQHR5cGUge3N0cmluZyB8IHVuZGVmaW5lZH0gKi8KCQkJYWN0aXZlVGhlbWU6IHVuZGVmaW5lZCwKCgkJCS8qKiBAdHlwZSB7c3RyaW5nIHwgdW5kZWZpbmVkfSAqLwoJCQl0aGVtZUlkOiB1bmRlZmluZWQsCgoJCQkvKiogQHR5cGUge3N0cmluZyB8IHVuZGVmaW5lZH0gKi8KCQkJdGhlbWVMYWJlbDogdW5kZWZpbmVkLAoKCQkJLyoqIEB0eXBlIHtib29sZWFufSAqLwoJCQlzY3JlZW5SZWFkZXI6IGZhbHNlLAoKCQkJLyoqIEB0eXBlIHtib29sZWFufSAqLwoJCQlyZWR1Y2VNb3Rpb246IGZhbHNlLAoJCX07CgoJCWlmICghZGlzYWJsZVNlcnZpY2VXb3JrZXIpIHsKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ2RpZC1sb2FkLXJlc291cmNlJywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJYXNzZXJ0SXNEZWZpbmVkKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpLnBvc3RNZXNzYWdlKHsgY2hhbm5lbDogJ2RpZC1sb2FkLXJlc291cmNlJywgZGF0YSB9LCBkYXRhLmRhdGE/LmJ1ZmZlciA/IFtkYXRhLmRhdGEuYnVmZmVyXSA6IFtdKTsKCQkJfSk7CgoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnZGlkLWxvYWQtbG9jYWxob3N0JywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJYXNzZXJ0SXNEZWZpbmVkKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpLnBvc3RNZXNzYWdlKHsgY2hhbm5lbDogJ2RpZC1sb2FkLWxvY2FsaG9zdCcsIGRhdGEgfSk7CgkJCX0pOwoKCQkJbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGV2ZW50ID0+IHsKCQkJCXN3aXRjaCAoZXZlbnQuZGF0YS5jaGFubmVsKSB7CgkJCQkJY2FzZSAnbG9hZC1yZXNvdXJjZSc6CgkJCQkJY2FzZSAnbG9hZC1sb2NhbGhvc3QnOgoJCQkJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKGV2ZW50LmRhdGEuY2hhbm5lbCwgZXZlbnQuZGF0YSk7CgkJCQkJCXJldHVybjsKCQkJCX0KCQkJfSk7CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge0hUTUxEb2N1bWVudD99IGRvY3VtZW50CgkJICogQHBhcmFtIHtIVE1MRWxlbWVudD99IGJvZHkKCQkgKi8KCQljb25zdCBhcHBseVN0eWxlcyA9IChkb2N1bWVudCwgYm9keSkgPT4gewoJCQlpZiAoIWRvY3VtZW50KSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmIChib2R5KSB7CgkJCQlib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3ZzY29kZS1saWdodCcsICd2c2NvZGUtZGFyaycsICd2c2NvZGUtaGlnaC1jb250cmFzdCcsICd2c2NvZGUtaGlnaC1jb250cmFzdC1saWdodCcsICd2c2NvZGUtcmVkdWNlLW1vdGlvbicsICd2c2NvZGUtdXNpbmctc2NyZWVuLXJlYWRlcicpOwoKCQkJCWlmIChpbml0RGF0YS5hY3RpdmVUaGVtZSkgewoJCQkJCWJvZHkuY2xhc3NMaXN0LmFkZChpbml0RGF0YS5hY3RpdmVUaGVtZSk7CgkJCQkJaWYgKGluaXREYXRhLmFjdGl2ZVRoZW1lID09PSAndnNjb2RlLWhpZ2gtY29udHJhc3QtbGlnaHQnKSB7CgkJCQkJCS8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5CgkJCQkJCWJvZHkuY2xhc3NMaXN0LmFkZCgndnNjb2RlLWhpZ2gtY29udHJhc3QnKTsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGluaXREYXRhLnJlZHVjZU1vdGlvbikgewoJCQkJCWJvZHkuY2xhc3NMaXN0LmFkZCgndnNjb2RlLXJlZHVjZS1tb3Rpb24nKTsKCQkJCX0KCgkJCQlpZiAoaW5pdERhdGEuc2NyZWVuUmVhZGVyKSB7CgkJCQkJYm9keS5jbGFzc0xpc3QuYWRkKCd2c2NvZGUtdXNpbmctc2NyZWVuLXJlYWRlcicpOwoJCQkJfQoKCQkJCWJvZHkuZGF0YXNldC52c2NvZGVUaGVtZUtpbmQgPSBpbml0RGF0YS5hY3RpdmVUaGVtZTsKCQkJCS8qKiBAZGVwcmVjYXRlZCBkYXRhLXZzY29kZS10aGVtZS1uYW1lIHdpbGwgYmUgcmVtb3ZlZCwgdXNlIGRhdGEtdnNjb2RlLXRoZW1lLWlkIGluc3RlYWQgKi8KCQkJCWJvZHkuZGF0YXNldC52c2NvZGVUaGVtZU5hbWUgPSBpbml0RGF0YS50aGVtZUxhYmVsIHx8ICcnOwoJCQkJYm9keS5kYXRhc2V0LnZzY29kZVRoZW1lSWQgPSBpbml0RGF0YS50aGVtZUlkIHx8ICcnOwoJCQl9CgoJCQlpZiAoaW5pdERhdGEuc3R5bGVzKSB7CgkJCQljb25zdCBkb2N1bWVudFN0eWxlID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlOwoKCQkJCS8vIFJlbW92ZSBzdGFsZSBwcm9wZXJ0aWVzCgkJCQlmb3IgKGxldCBpID0gZG9jdW1lbnRTdHlsZS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewoJCQkJCWNvbnN0IHByb3BlcnR5ID0gZG9jdW1lbnRTdHlsZVtpXTsKCgkJCQkJLy8gRG9uJ3QgcmVtb3ZlIHByb3BlcnRpZXMgdGhhdCB0aGUgd2VidmlldyBtaWdodCBoYXZlIGFkZGVkIHNlcGFyYXRlbHkKCQkJCQlpZiAocHJvcGVydHkgJiYgcHJvcGVydHkuc3RhcnRzV2l0aCgnLS12c2NvZGUtJykpIHsKCQkJCQkJZG9jdW1lbnRTdHlsZS5yZW1vdmVQcm9wZXJ0eShwcm9wZXJ0eSk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFJlLWFkZCBuZXcgcHJvcGVydGllcwoJCQkJZm9yIChjb25zdCBbdmFyaWFibGUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhpbml0RGF0YS5zdHlsZXMpKSB7CgkJCQkJZG9jdW1lbnRTdHlsZS5zZXRQcm9wZXJ0eShgLS0ke3ZhcmlhYmxlfWAsIHZhbHVlKTsKCQkJCX0KCQkJfQoJCX07CgoJCS8qKgoJCSAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZlbnQKCQkgKi8KCQljb25zdCBoYW5kbGVJbm5lckNsaWNrID0gKGV2ZW50KSA9PiB7CgkJCWlmICghZXZlbnQ/LnZpZXc/LmRvY3VtZW50KSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWNvbnN0IGJhc2VFbGVtZW50ID0gZXZlbnQudmlldy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdiYXNlJyk7CgoJCQlmb3IgKGNvbnN0IHBhdGhFbGVtZW50IG9mIGV2ZW50LmNvbXBvc2VkUGF0aCgpKSB7CgkJCQkvKiogQHR5cGUge2FueX0gKi8KCQkJCWNvbnN0IG5vZGUgPSBwYXRoRWxlbWVudDsKCQkJCWlmIChub2RlLnRhZ05hbWUgJiYgbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJyAmJiBub2RlLmhyZWYpIHsKCQkJCQlpZiAobm9kZS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSA9PT0gJyMnKSB7CgkJCQkJCWV2ZW50LnZpZXcuc2Nyb2xsVG8oMCwgMCk7CgkJCQkJfSBlbHNlIGlmIChub2RlLmhhc2ggJiYgKG5vZGUuZ2V0QXR0cmlidXRlKCdocmVmJykgPT09IG5vZGUuaGFzaCB8fCAoYmFzZUVsZW1lbnQgJiYgbm9kZS5ocmVmID09PSBiYXNlRWxlbWVudC5ocmVmICsgbm9kZS5oYXNoKSkpIHsKCQkJCQkJY29uc3QgZnJhZ21lbnQgPSBub2RlLmhhc2guc2xpY2UoMSk7CgkJCQkJCWNvbnN0IGRlY29kZWRGcmFnbWVudCA9IGRlY29kZVVSSUNvbXBvbmVudChmcmFnbWVudCk7CgkJCQkJCWNvbnN0IHNjcm9sbFRhcmdldCA9IGV2ZW50LnZpZXcuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhZ21lbnQpID8/IGV2ZW50LnZpZXcuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGVjb2RlZEZyYWdtZW50KTsKCQkJCQkJaWYgKHNjcm9sbFRhcmdldCkgewoJCQkJCQkJc2Nyb2xsVGFyZ2V0LnNjcm9sbEludG9WaWV3KCk7CgkJCQkJCX0gZWxzZSBpZiAoZGVjb2RlZEZyYWdtZW50LnRvTG93ZXJDYXNlKCkgPT09ICd0b3AnKSB7CgkJCQkJCQlldmVudC52aWV3LnNjcm9sbFRvKDAsIDApOwoJCQkJCQl9CgkJCQkJfSBlbHNlIHsKCQkJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWNsaWNrLWxpbmsnLCB7IHVyaTogbm9kZS5ocmVmLmJhc2VWYWwgfHwgbm9kZS5ocmVmIH0pOwoJCQkJCX0KCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJfQoJCX07CgoJCS8qKgoJCSAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZlbnQKCQkgKi8KCQljb25zdCBoYW5kbGVBdXhDbGljayA9IChldmVudCkgPT4gewoJCQkvLyBQcmV2ZW50IG1pZGRsZSBjbGlja3Mgb3BlbmluZyBhIGJyb2tlbiBsaW5rIGluIHRoZSBicm93c2VyCgkJCWlmICghZXZlbnQ/LnZpZXc/LmRvY3VtZW50KSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmIChldmVudC5idXR0b24gPT09IDEpIHsKCQkJCWZvciAoY29uc3QgcGF0aEVsZW1lbnQgb2YgZXZlbnQuY29tcG9zZWRQYXRoKCkpIHsKCQkJCQkvKiogQHR5cGUge2FueX0gKi8KCQkJCQljb25zdCBub2RlID0gcGF0aEVsZW1lbnQ7CgkJCQkJaWYgKG5vZGUudGFnTmFtZSAmJiBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIG5vZGUuaHJlZikgewoJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICovCgkJY29uc3QgaGFuZGxlSW5uZXJLZXlkb3duID0gKGUpID0+IHsKCQkJLy8gSWYgdGhlIGtleXByZXNzIHdvdWxkIHRyaWdnZXIgYSBicm93c2VyIGV2ZW50LCBzdWNoIGFzIGNvcHkgb3IgcGFzdGUsCgkJCS8vIG1ha2Ugc3VyZSB3ZSBibG9jayB0aGUgYnJvd3NlciBmcm9tIGRpc3BhdGNoaW5nIGl0LiBJbnN0ZWFkIFZTIENvZGUKCQkJLy8gaGFuZGxlcyB0aGVzZSBldmVudHMgYW5kIHdpbGwgZGlzcGF0Y2ggYSBjb3B5L3Bhc3RlIGJhY2sgdG8gdGhlIHdlYnZpZXcKCQkJLy8gaWYgbmVlZGVkCgkJCWlmIChpc1VuZG9SZWRvKGUpIHx8IGlzUHJpbnQoZSkgfHwgaXNGaW5kRXZlbnQoZSkgfHwgaXNTYXZlRXZlbnQoZSkpIHsKCQkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJfSBlbHNlIGlmIChpc0NvcHlQYXN0ZU9yQ3V0KGUpKSB7CgkJCQlpZiAob25FbGVjdHJvbikgewoJCQkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJCX0gZWxzZSB7CgkJCQkJcmV0dXJuOyAvLyBsZXQgdGhlIGJyb3dzZXIgaGFuZGxlIHRoaXMKCQkJCX0KCQkJfSBlbHNlIGlmICghb25FbGVjdHJvbiAmJiAoaXNDbG9zZVRhYihlKSB8fCBpc05ld1dpbmRvdyhlKSB8fCBpc0hlbHAoZSkgfHwgaXNSZWZyZXNoKGUpKSkgewoJCQkJLy8gUHJldmVudCBDdHJsK1cgY2xvc2luZyB3aW5kb3cgLyBDdHJsK04gb3BlbmluZyBuZXcgd2luZG93IGluIFBXQS4KCQkJCS8vIChObyBlZmZlY3QgaW4gYSByZWd1bGFyIGJyb3dzZXIgdGFiLikKCQkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJfQoKCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWtleWRvd24nLCB7CgkJCQlrZXk6IGUua2V5LAoJCQkJa2V5Q29kZTogZS5rZXlDb2RlLAoJCQkJY29kZTogZS5jb2RlLAoJCQkJc2hpZnRLZXk6IGUuc2hpZnRLZXksCgkJCQlhbHRLZXk6IGUuYWx0S2V5LAoJCQkJY3RybEtleTogZS5jdHJsS2V5LAoJCQkJbWV0YUtleTogZS5tZXRhS2V5LAoJCQkJcmVwZWF0OiBlLnJlcGVhdAoJCQl9KTsKCQl9OwoJCS8qKgoJCSAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZQoJCSAqLwoJCWNvbnN0IGhhbmRsZUlubmVyS2V5dXAgPSAoZSkgPT4gewoJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKCdkaWQta2V5dXAnLCB7CgkJCQlrZXk6IGUua2V5LAoJCQkJa2V5Q29kZTogZS5rZXlDb2RlLAoJCQkJY29kZTogZS5jb2RlLAoJCQkJc2hpZnRLZXk6IGUuc2hpZnRLZXksCgkJCQlhbHRLZXk6IGUuYWx0S2V5LAoJCQkJY3RybEtleTogZS5jdHJsS2V5LAoJCQkJbWV0YUtleTogZS5tZXRhS2V5LAoJCQkJcmVwZWF0OiBlLnJlcGVhdAoJCQl9KTsKCQl9OwoKCQkvKioKCQkgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGUKCQkgKiBAcmV0dXJuIHtib29sZWFufQoJCSAqLwoJCWZ1bmN0aW9uIGlzQ29weVBhc3RlT3JDdXQoZSkgewoJCQljb25zdCBoYXNNZXRhID0gZS5jdHJsS2V5IHx8IGUubWV0YUtleTsKCQkJLy8gNDU6IGtleUNvZGUgb2YgIkluc2VydCIKCQkJY29uc3Qgc2hpZnRJbnNlcnQgPSBlLnNoaWZ0S2V5ICYmIGUua2V5Q29kZSA9PT0gNDU7CgkJCS8vIDY3LCA4NiwgODg6IGtleUNvZGUgb2YgIkMiLCAiViIsICJYIgoJCQlyZXR1cm4gKGhhc01ldGEgJiYgWzY3LCA4NiwgODhdLmluY2x1ZGVzKGUua2V5Q29kZSkpIHx8IHNoaWZ0SW5zZXJ0OwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc1VuZG9SZWRvKGUpIHsKCQkJY29uc3QgaGFzTWV0YSA9IGUuY3RybEtleSB8fCBlLm1ldGFLZXk7CgkJCS8vIDkwLCA4OToga2V5Q29kZSBvZiAiWiIsICJZIgoJCQlyZXR1cm4gaGFzTWV0YSAmJiBbOTAsIDg5XS5pbmNsdWRlcyhlLmtleUNvZGUpOwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc1ByaW50KGUpIHsKCQkJY29uc3QgaGFzTWV0YSA9IGUuY3RybEtleSB8fCBlLm1ldGFLZXk7CgkJCS8vIDgwOiBrZXlDb2RlIG9mICJQIgoJCQlyZXR1cm4gaGFzTWV0YSAmJiBlLmtleUNvZGUgPT09IDgwOwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc0ZpbmRFdmVudChlKSB7CgkJCWNvbnN0IGhhc01ldGEgPSBlLmN0cmxLZXkgfHwgZS5tZXRhS2V5OwoJCQkvLyA3MDoga2V5Q29kZSBvZiAiRiIKCQkJcmV0dXJuIGhhc01ldGEgJiYgZS5rZXlDb2RlID09PSA3MDsKCQl9CgoJCS8qKgoJCSAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZQoJCSAqIEByZXR1cm4ge2Jvb2xlYW59CgkJICovCgkJZnVuY3Rpb24gaXNTYXZlRXZlbnQoZSkgewoJCQljb25zdCBoYXNNZXRhID0gZS5jdHJsS2V5IHx8IGUubWV0YUtleTsKCQkJLy8gODM6IGtleUNvZGUgb2YgIlMiCgkJCXJldHVybiBoYXNNZXRhICYmIGUua2V5Q29kZSA9PT0gODM7CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGUKCQkgKiBAcmV0dXJuIHtib29sZWFufQoJCSAqLwoJCWZ1bmN0aW9uIGlzQ2xvc2VUYWIoZSkgewoJCQljb25zdCBoYXNNZXRhID0gZS5jdHJsS2V5IHx8IGUubWV0YUtleTsKCQkJLy8gODc6IGtleUNvZGUgb2YgIlciCgkJCXJldHVybiBoYXNNZXRhICYmIGUua2V5Q29kZSA9PT0gODc7CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGUKCQkgKiBAcmV0dXJuIHtib29sZWFufQoJCSAqLwoJCWZ1bmN0aW9uIGlzTmV3V2luZG93KGUpIHsKCQkJY29uc3QgaGFzTWV0YSA9IGUuY3RybEtleSB8fCBlLm1ldGFLZXk7CgkJCS8vIDc4OiBrZXlDb2RlIG9mICJOIgoJCQlyZXR1cm4gaGFzTWV0YSAmJiBlLmtleUNvZGUgPT09IDc4OwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQkgZnVuY3Rpb24gaXNIZWxwKGUpIHsKCQkJLy8gMTEyOiBrZXlDb2RlIG9mICJGMSIKCQkJcmV0dXJuIGUua2V5Q29kZSA9PT0gMTEyOwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc1JlZnJlc2goZSkgewoJCQkvLyAxMTY6IGtleUNvZGUgb2YgIkY1IgoJCQlyZXR1cm4gZS5rZXlDb2RlID09PSAxMTY7CgkJfQoKCQlsZXQgaXNIYW5kbGluZ1Njcm9sbCA9IGZhbHNlOwoKCQkvKioKCQkgKiBAcGFyYW0ge1doZWVsRXZlbnR9IGV2ZW50CgkJICovCgkJY29uc3QgaGFuZGxlV2hlZWwgPSAoZXZlbnQpID0+IHsKCQkJaWYgKGlzSGFuZGxpbmdTY3JvbGwpIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLXNjcm9sbC13aGVlbCcsIHsKCQkJCWRlbHRhTW9kZTogZXZlbnQuZGVsdGFNb2RlLAoJCQkJZGVsdGFYOiBldmVudC5kZWx0YVgsCgkJCQlkZWx0YVk6IGV2ZW50LmRlbHRhWSwKCQkJCWRlbHRhWjogZXZlbnQuZGVsdGFaLAoJCQkJZGV0YWlsOiBldmVudC5kZXRhaWwsCgkJCQl0eXBlOiBldmVudC50eXBlCgkJCX0pOwoJCX07CgoJCS8qKgoJCSAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50CgkJICovCgkJY29uc3QgaGFuZGxlSW5uZXJTY3JvbGwgPSAoZXZlbnQpID0+IHsKCQkJaWYgKGlzSGFuZGxpbmdTY3JvbGwpIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJY29uc3QgdGFyZ2V0ID0gLyoqIEB0eXBlIHtIVE1MRG9jdW1lbnQgfCBudWxsfSAqLyAoZXZlbnQudGFyZ2V0KTsKCQkJY29uc3QgY3VycmVudFRhcmdldCA9IC8qKiBAdHlwZSB7V2luZG93IHwgbnVsbH0gKi8gKGV2ZW50LmN1cnJlbnRUYXJnZXQpOwoJCQlpZiAoIWN1cnJlbnRUYXJnZXQgfHwgIXRhcmdldD8uYm9keSkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQljb25zdCBwcm9ncmVzcyA9IGN1cnJlbnRUYXJnZXQuc2Nyb2xsWSAvIHRhcmdldC5ib2R5LmNsaWVudEhlaWdodDsKCQkJaWYgKGlzTmFOKHByb2dyZXNzKSkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlpc0hhbmRsaW5nU2Nyb2xsID0gdHJ1ZTsKCQkJd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7CgkJCQl0cnkgewoJCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RpZC1zY3JvbGwnLCB7IHNjcm9sbFlQZXJjZW50YWdlOiBwcm9ncmVzcyB9KTsKCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQkvLyBub29wCgkJCQl9CgkJCQlpc0hhbmRsaW5nU2Nyb2xsID0gZmFsc2U7CgkJCX0pOwoJCX07CgoJCWZ1bmN0aW9uIGhhbmRsZUlubmVyRHJhZ1N0YXJ0RXZlbnQoLyoqIEB0eXBlIHtEcmFnRXZlbnR9ICovIGUpIHsKCQkJaWYgKGUuZGVmYXVsdFByZXZlbnRlZCkgewoJCQkJLy8gRXh0ZW5zaW9uIGNvZGUgaGFzIGFscmVhZHkgaGFuZGxlZCB0aGlzIGV2ZW50CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmICghZS5kYXRhVHJhbnNmZXIgfHwgZS5zaGlmdEtleSkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBPbmx5IGhhbmRsZSBkcmFncyBmcm9tIG91dHNpZGUgZWRpdG9yIGZvciBub3cKCQkJaWYgKGUuZGF0YVRyYW5zZmVyLml0ZW1zLmxlbmd0aCAmJiBBcnJheS5wcm90b3R5cGUuZXZlcnkuY2FsbChlLmRhdGFUcmFuc2Zlci5pdGVtcywgaXRlbSA9PiBpdGVtLmtpbmQgPT09ICdmaWxlJykpIHsKCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RyYWctc3RhcnQnLCB1bmRlZmluZWQpOwoJCQl9CgkJfQoKCgkJZnVuY3Rpb24gaGFuZGxlSW5uZXJEcmFnRXZlbnQoLyoqIEB0eXBlIHtEcmFnRXZlbnR9ICovIGUpIHsKCQkJLyoqCgkJCSAqIFRvIGVuc3VyZSB0aGF0IHRoZSBkcm9wIGV2ZW50IGFsd2F5cyBmaXJlcyBhcyBleHBlY3RlZCwgeW91IHNob3VsZCBhbHdheXMgaW5jbHVkZSBhIHByZXZlbnREZWZhdWx0KCkgY2FsbCBpbiB0aGUgcGFydCBvZiB5b3VyIGNvZGUgd2hpY2ggaGFuZGxlcyB0aGUgZHJhZ292ZXIgZXZlbnQuCgkJCSAqIHNvdXJjZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxFbGVtZW50L2Ryb3BfZXZlbnQKCQkJICoqLwoJCQllLnByZXZlbnREZWZhdWx0KCk7CgoJCQlpZiAoIWUuZGF0YVRyYW5zZmVyKSB7CgkJCQlyZXR1cm47CgkJCX0KCgoJCQkvLyBPbmx5IGhhbmRsZSBkcmFncyBmcm9tIG91dHNpZGUgZWRpdG9yIGZvciBub3cKCQkJaWYgKGUuZGF0YVRyYW5zZmVyLml0ZW1zLmxlbmd0aCAmJiBBcnJheS5wcm90b3R5cGUuZXZlcnkuY2FsbChlLmRhdGFUcmFuc2Zlci5pdGVtcywgaXRlbSA9PiBpdGVtLmtpbmQgPT09ICdmaWxlJykpIHsKCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RyYWcnLCB7CgkJCQkJc2hpZnRLZXk6IGUuc2hpZnRLZXkKCQkJCX0pOwoJCQl9CgoJCX0KCgkJZnVuY3Rpb24gaGFuZGxlSW5uZXJEcm9wRXZlbnQoLyoqQHR5cGUge0RyYWdFdmVudH0gKi9lKSB7CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQl9CgoJCS8qKgoJCSAqIEBwYXJhbSB7KCkgPT4gdm9pZH0gY2FsbGJhY2sKCQkgKi8KCQlmdW5jdGlvbiBvbkRvbVJlYWR5KGNhbGxiYWNrKSB7CgkJCWlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnaW50ZXJhY3RpdmUnIHx8IGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHsKCQkJCWNhbGxiYWNrKCk7CgkJCX0gZWxzZSB7CgkJCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgY2FsbGJhY2spOwoJCQl9CgkJfQoKCQlmdW5jdGlvbiBhcmVTZXJ2aWNlV29ya2Vyc0VuYWJsZWQoKSB7CgkJCXRyeSB7CgkJCQlyZXR1cm4gISFuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcjsKCQkJfSBjYXRjaCAoZSkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge2ltcG9ydCgnLi4vd2Vidmlld01lc3NhZ2VzJykuVXBkYXRlQ29udGVudEV2ZW50fSBkYXRhCgkJICogQHJldHVybiB7c3RyaW5nfQoJCSAqLwoJCWZ1bmN0aW9uIHRvQ29udGVudEh0bWwoZGF0YSkgewoJCQljb25zdCBvcHRpb25zID0gZGF0YS5vcHRpb25zOwoJCQljb25zdCB0ZXh0ID0gZGF0YS5jb250ZW50czsKCQkJY29uc3QgbmV3RG9jdW1lbnQgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHRleHQsICd0ZXh0L2h0bWwnKTsKCgkJCW5ld0RvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKS5mb3JFYWNoKGEgPT4gewoJCQkJaWYgKCFhLnRpdGxlKSB7CgkJCQkJY29uc3QgaHJlZiA9IGEuZ2V0QXR0cmlidXRlKCdocmVmJyk7CgkJCQkJaWYgKHR5cGVvZiBocmVmID09PSAnc3RyaW5nJykgewoJCQkJCQlhLnRpdGxlID0gaHJlZjsKCQkJCQl9CgkJCQl9CgkJCX0pOwoKCQkJLy8gU2V0IGRlZmF1bHQgYXJpYSByb2xlCgkJCWlmICghbmV3RG9jdW1lbnQuYm9keS5oYXNBdHRyaWJ1dGUoJ3JvbGUnKSkgewoJCQkJbmV3RG9jdW1lbnQuYm9keS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnZG9jdW1lbnQnKTsKCQkJfQoKCQkJLy8gSW5qZWN0IGRlZmF1bHQgc2NyaXB0CgkJCWlmIChvcHRpb25zLmFsbG93U2NyaXB0cykgewoJCQkJY29uc3QgZGVmYXVsdFNjcmlwdCA9IG5ld0RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwoJCQkJZGVmYXVsdFNjcmlwdC5pZCA9ICdfdnNjb2RlQXBpU2NyaXB0JzsKCQkJCWRlZmF1bHRTY3JpcHQudGV4dENvbnRlbnQgPSBnZXRWc0NvZGVBcGlTY3JpcHQob3B0aW9ucy5hbGxvd011bHRpcGxlQVBJQWNxdWlyZSwgZGF0YS5zdGF0ZSk7CgkJCQluZXdEb2N1bWVudC5oZWFkLnByZXBlbmQoZGVmYXVsdFNjcmlwdCk7CgkJCX0KCgkJCS8vIEluamVjdCBkZWZhdWx0IHN0eWxlcwoJCQluZXdEb2N1bWVudC5oZWFkLnByZXBlbmQoZGVmYXVsdFN0eWxlcy5jbG9uZU5vZGUodHJ1ZSkpOwoKCQkJYXBwbHlTdHlsZXMobmV3RG9jdW1lbnQsIG5ld0RvY3VtZW50LmJvZHkpOwoKCQkJLy8gU3RyaXAgb3V0IHVuc3VwcG9ydGVkIGh0dHAtZXF1aXYgdGFncwoJCQlmb3IgKGNvbnN0IG1ldGFFbGVtZW50IG9mIEFycmF5LmZyb20obmV3RG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbWV0YScpKSkgewoJCQkJY29uc3QgaHR0cEVxdWl2ID0gbWV0YUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdodHRwLWVxdWl2Jyk7CgkJCQlpZiAoaHR0cEVxdWl2ICYmICEvXihjb250ZW50LXNlY3VyaXR5LXBvbGljeXxkZWZhdWx0LXN0eWxlfGNvbnRlbnQtdHlwZSkkL2kudGVzdChodHRwRXF1aXYpKSB7CgkJCQkJY29uc29sZS53YXJuKGBSZW1vdmluZyB1bnN1cHBvcnRlZCBtZXRhIGh0dHAtZXF1aXY6ICR7aHR0cEVxdWl2fWApOwoJCQkJCW1ldGFFbGVtZW50LnJlbW92ZSgpOwoJCQkJfQoJCQl9CgoJCQkvLyBDaGVjayBmb3IgQ1NQCgkJCWNvbnN0IGNzcCA9IG5ld0RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21ldGFbaHR0cC1lcXVpdj0iQ29udGVudC1TZWN1cml0eS1Qb2xpY3kiXScpOwoJCQlpZiAoIWNzcCkgewoJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnbm8tY3NwLWZvdW5kJywgdW5kZWZpbmVkKTsKCQkJfSBlbHNlIHsKCQkJCXRyeSB7CgkJCQkJLy8gQXR0ZW1wdCB0byByZXdyaXRlIENTUHMgdGhhdCBoYXJkY29kZSBvbGQtc3R5bGUgcmVzb3VyY2UgZW5kcG9pbnQKCQkJCQljb25zdCBjc3BDb250ZW50ID0gY3NwLmdldEF0dHJpYnV0ZSgnY29udGVudCcpOwoJCQkJCWlmIChjc3BDb250ZW50KSB7CgkJCQkJCWNvbnN0IG5ld0NzcCA9IGNzcENvbnRlbnQucmVwbGFjZSgvKHZzY29kZS13ZWJ2aWV3LXJlc291cmNlfHZzY29kZS1yZXNvdXJjZSk6KD89KFxzfDt8JCkpL2csIGRhdGEuY3NwU291cmNlKTsKCQkJCQkJY3NwLnNldEF0dHJpYnV0ZSgnY29udGVudCcsIG5ld0NzcCk7CgkJCQkJfQoJCQkJfSBjYXRjaCAoZSkgewoJCQkJCWNvbnNvbGUuZXJyb3IoYENvdWxkIG5vdCByZXdyaXRlIGNzcDogJHtlfWApOwoJCQkJfQoJCQl9CgoJCQkvLyBzZXQgRE9DVFlQRSBmb3IgbmV3RG9jdW1lbnQgZXhwbGljaXRseSBhcyBET01QYXJzZXIucGFyc2VGcm9tU3RyaW5nIHN0cmlwcyBpdCBvZmYKCQkJLy8gYW5kIERPQ1RZUEUgaXMgbmVlZGVkIGluIHRoZSBpZnJhbWUgdG8gZW5zdXJlIHRoYXQgdGhlIHVzZXIgYWdlbnQgc3R5bGVzaGVldCBpcyBjb3JyZWN0bHkgb3ZlcnJpZGRlbgoJCQlyZXR1cm4gJzwhRE9DVFlQRSBodG1sPlxuJyArIG5ld0RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUw7CgkJfQoKCQkvLyBBbHNvIGZvcndhcmQgZXZlbnRzIGJlZm9yZSB0aGUgY29udGVudHMgb2YgdGhlIHdlYnZpZXcgaGF2ZSBsb2FkZWQKCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUlubmVyS2V5ZG93bik7CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgaGFuZGxlSW5uZXJLZXl1cCk7CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGhhbmRsZUlubmVyRHJhZ1N0YXJ0RXZlbnQpOwoJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGhhbmRsZUlubmVyRHJhZ0V2ZW50KTsKCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJhZycsIGhhbmRsZUlubmVyRHJhZ0V2ZW50KTsKCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGhhbmRsZUlubmVyRHJvcEV2ZW50KTsKCgoJCW9uRG9tUmVhZHkoKCkgPT4gewoJCQlpZiAoIWRvY3VtZW50LmJvZHkpIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ3N0eWxlcycsIChfZXZlbnQsIGRhdGEpID0+IHsKCQkJCSsrc3R5bGVWZXJzaW9uOwoKCQkJCWluaXREYXRhLnN0eWxlcyA9IGRhdGEuc3R5bGVzOwoJCQkJaW5pdERhdGEuYWN0aXZlVGhlbWUgPSBkYXRhLmFjdGl2ZVRoZW1lOwoJCQkJaW5pdERhdGEudGhlbWVMYWJlbCA9IGRhdGEudGhlbWVMYWJlbDsKCQkJCWluaXREYXRhLnRoZW1lSWQgPSBkYXRhLnRoZW1lSWQ7CgkJCQlpbml0RGF0YS5yZWR1Y2VNb3Rpb24gPSBkYXRhLnJlZHVjZU1vdGlvbjsKCQkJCWluaXREYXRhLnNjcmVlblJlYWRlciA9IGRhdGEuc2NyZWVuUmVhZGVyOwoKCQkJCWNvbnN0IHRhcmdldCA9IGdldEFjdGl2ZUZyYW1lKCk7CgkJCQlpZiAoIXRhcmdldCkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAodGFyZ2V0LmNvbnRlbnREb2N1bWVudCkgewoJCQkJCWFwcGx5U3R5bGVzKHRhcmdldC5jb250ZW50RG9jdW1lbnQsIHRhcmdldC5jb250ZW50RG9jdW1lbnQuYm9keSk7CgkJCQl9CgkJCX0pOwoKCQkJLy8gcHJvcGFnYXRlIGZvY3VzCgkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdmb2N1cycsICgpID0+IHsKCQkJCWNvbnN0IGFjdGl2ZUZyYW1lID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCWlmICghYWN0aXZlRnJhbWUgfHwgIWFjdGl2ZUZyYW1lLmNvbnRlbnRXaW5kb3cpIHsKCQkJCQkvLyBGb2N1cyB0aGUgdG9wIGxldmVsIHdlYnZpZXcgaW5zdGVhZAoJCQkJCXdpbmRvdy5mb2N1cygpOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gYWN0aXZlRnJhbWUpIHsKCQkJCQkvLyBXZSBhcmUgYWxyZWFkeSBmb2N1c2VkIG9uIHRoZSBpZnJhbWUgKG9yIG9uZSBvZiBpdHMgY2hpbGRyZW4pIHNvIG5vIG5lZWQKCQkJCQkvLyB0byByZWZvY3VzLgoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlhY3RpdmVGcmFtZS5jb250ZW50V2luZG93LmZvY3VzKCk7CgkJCX0pOwoKCQkJLy8gdXBkYXRlIGlmcmFtZS1jb250ZW50cwoJCQlsZXQgdXBkYXRlSWQgPSAwOwoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnY29udGVudCcsIGFzeW5jIChfZXZlbnQsIC8qKiBAdHlwZSB7aW1wb3J0KCcuLi93ZWJ2aWV3TWVzc2FnZXMnKS5VcGRhdGVDb250ZW50RXZlbnR9ICovIGRhdGEpID0+IHsKCQkJCXBlcmZNYXJrKCdjb250ZW50L3N0YXJ0ZWQnKTsKCgkJCQljb25zdCBjdXJyZW50VXBkYXRlSWQgPSArK3VwZGF0ZUlkOwoJCQkJdHJ5IHsKCQkJCQlhd2FpdCB3b3JrZXJSZWFkeTsKCQkJCQlwZXJmTWFyaygnY29udGVudC93b3JrZXJSZWFkeScpOwoJCQkJfSBjYXRjaCAoZSkgewoJCQkJCWNvbnNvbGUuZXJyb3IoYFdlYnZpZXcgZmF0YWwgZXJyb3I6ICR7ZX1gKTsKCQkJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKCdmYXRhbC1lcnJvcicsIHsgbWVzc2FnZTogZSArICcnIH0pOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAoY3VycmVudFVwZGF0ZUlkICE9PSB1cGRhdGVJZCkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQljb25zdCBvcHRpb25zID0gZGF0YS5vcHRpb25zOwoJCQkJY29uc3QgbmV3RG9jdW1lbnQgPSB0b0NvbnRlbnRIdG1sKGRhdGEpOwoKCQkJCWNvbnN0IGluaXRpYWxTdHlsZVZlcnNpb24gPSBzdHlsZVZlcnNpb247CgoJCQkJY29uc3QgZnJhbWUgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJY29uc3Qgd2FzRmlyc3RMb2FkID0gZmlyc3RMb2FkOwoJCQkJLy8ga2VlcCBjdXJyZW50IHNjcm9sbFkgYXJvdW5kIGFuZCB1c2UgbGF0ZXIKCQkJCS8qKiBAdHlwZSB7KGJvZHk6IEhUTUxFbGVtZW50LCB3aW5kb3c6IFdpbmRvdykgPT4gdm9pZH0gKi8KCQkJCWxldCBzZXRJbml0aWFsU2Nyb2xsUG9zaXRpb247CgkJCQlpZiAoZmlyc3RMb2FkKSB7CgkJCQkJZmlyc3RMb2FkID0gZmFsc2U7CgkJCQkJc2V0SW5pdGlhbFNjcm9sbFBvc2l0aW9uID0gKGJvZHksIHdpbmRvdykgPT4gewoJCQkJCQlpZiAodHlwZW9mIGluaXREYXRhLmluaXRpYWxTY3JvbGxQcm9ncmVzcyA9PT0gJ251bWJlcicgJiYgIWlzTmFOKGluaXREYXRhLmluaXRpYWxTY3JvbGxQcm9ncmVzcykpIHsKCQkJCQkJCWlmICh3aW5kb3cuc2Nyb2xsWSA9PT0gMCkgewoJCQkJCQkJCXdpbmRvdy5zY3JvbGwoMCwgYm9keS5jbGllbnRIZWlnaHQgKiBpbml0RGF0YS5pbml0aWFsU2Nyb2xsUHJvZ3Jlc3MpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfTsKCQkJCX0gZWxzZSB7CgkJCQkJY29uc3Qgc2Nyb2xsWSA9IGZyYW1lICYmIGZyYW1lLmNvbnRlbnREb2N1bWVudCAmJiBmcmFtZS5jb250ZW50RG9jdW1lbnQuYm9keSA/IGFzc2VydElzRGVmaW5lZChmcmFtZS5jb250ZW50V2luZG93KS5zY3JvbGxZIDogMDsKCQkJCQlzZXRJbml0aWFsU2Nyb2xsUG9zaXRpb24gPSAoYm9keSwgd2luZG93KSA9PiB7CgkJCQkJCWlmICh3aW5kb3cuc2Nyb2xsWSA9PT0gMCkgewoJCQkJCQkJd2luZG93LnNjcm9sbCgwLCBzY3JvbGxZKTsKCQkJCQkJfQoJCQkJCX07CgkJCQl9CgoJCQkJLy8gQ2xlYW4gdXAgb2xkIHBlbmRpbmcgZnJhbWVzIGFuZCBzZXQgY3VycmVudCBvbmUgYXMgbmV3IG9uZQoJCQkJY29uc3QgcHJldmlvdXNQZW5kaW5nRnJhbWUgPSBnZXRQZW5kaW5nRnJhbWUoKTsKCQkJCWlmIChwcmV2aW91c1BlbmRpbmdGcmFtZSkgewoJCQkJCXByZXZpb3VzUGVuZGluZ0ZyYW1lLnNldEF0dHJpYnV0ZSgnaWQnLCAnJyk7CgkJCQkJcHJldmlvdXNQZW5kaW5nRnJhbWUucmVtb3ZlKCk7CgkJCQl9CgkJCQlpZiAoIXdhc0ZpcnN0TG9hZCkgewoJCQkJCXBlbmRpbmdNZXNzYWdlcyA9IFtdOwoJCQkJfQoKCQkJCWNvbnN0IG5ld0ZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CgkJCQluZXdGcmFtZS50aXRsZSA9IGRhdGEudGl0bGU7CgkJCQluZXdGcmFtZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3BlbmRpbmctZnJhbWUnKTsKCQkJCW5ld0ZyYW1lLnNldEF0dHJpYnV0ZSgnZnJhbWVib3JkZXInLCAnMCcpOwoKCQkJCWNvbnN0IHNhbmRib3hSdWxlcyA9IG5ldyBTZXQoWydhbGxvdy1zYW1lLW9yaWdpbicsICdhbGxvdy1wb2ludGVyLWxvY2snXSk7CgkJCQlpZiAob3B0aW9ucy5hbGxvd1NjcmlwdHMpIHsKCQkJCQlzYW5kYm94UnVsZXMuYWRkKCdhbGxvdy1zY3JpcHRzJyk7CgkJCQkJc2FuZGJveFJ1bGVzLmFkZCgnYWxsb3ctZG93bmxvYWRzJyk7CgkJCQl9CgkJCQlpZiAob3B0aW9ucy5hbGxvd0Zvcm1zKSB7CgkJCQkJc2FuZGJveFJ1bGVzLmFkZCgnYWxsb3ctZm9ybXMnKTsKCQkJCX0KCQkJCW5ld0ZyYW1lLnNldEF0dHJpYnV0ZSgnc2FuZGJveCcsIEFycmF5LmZyb20oc2FuZGJveFJ1bGVzKS5qb2luKCcgJykpOwoKCQkJCWNvbnN0IGFsbG93UnVsZXMgPSBbJ2Nyb3NzLW9yaWdpbi1pc29sYXRlZDsnLCAnYXV0b3BsYXk7J107CgkJCQlpZiAoIWlzRmlyZWZveCAmJiBvcHRpb25zLmFsbG93U2NyaXB0cykgewoJCQkJCWFsbG93UnVsZXMucHVzaCgnY2xpcGJvYXJkLXJlYWQ7JywgJ2NsaXBib2FyZC13cml0ZTsnKTsKCQkJCX0KCQkJCW5ld0ZyYW1lLnNldEF0dHJpYnV0ZSgnYWxsb3cnLCBhbGxvd1J1bGVzLmpvaW4oJyAnKSk7CgkJCQkvLyBXZSBzaG91bGQganVzdCBiZSBhYmxlIHRvIHVzZSBzcmNkb2MsIGJ1dCBJIHdhc24ndAoJCQkJLy8gc2VlaW5nIHRoZSBzZXJ2aWNlIHdvcmtlciBhcHBseWluZyBwcm9wZXJseS4KCQkJCS8vIEZha2UgbG9hZCBhbiBlbXB0eSBvbiB0aGUgY29ycmVjdCBvcmlnaW4gYW5kIHRoZW4gd3JpdGUgcmVhbCBodG1sCgkJCQkvLyBpbnRvIGl0IHRvIGdldCBhcm91bmQgdGhpcy4KCQkJCWNvbnN0IGZha2VVcmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgaWQ6IElEIH0pOwoJCQkJaWYgKGdsb2JhbFRoaXMuY3Jvc3NPcmlnaW5Jc29sYXRlZCkgewoJCQkJCWZha2VVcmxQYXJhbXMuc2V0KCd2c2NvZGUtY29pJywgJzMnKTsgLypDT09QK0NPRVAqLwoJCQkJfQoJCQkJbmV3RnJhbWUuc3JjID0gYCR7ZmFrZUh0bWxVcml9PyR7ZmFrZVVybFBhcmFtcy50b1N0cmluZygpfWA7CgoJCQkJbmV3RnJhbWUuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OiBibG9jazsgbWFyZ2luOiAwOyBvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7IHZpc2liaWxpdHk6IGhpZGRlbic7CgkJCQlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG5ld0ZyYW1lKTsKCgkJCQluZXdGcmFtZS5jb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVJbm5lcktleWRvd24pOwoJCQkJbmV3RnJhbWUuY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGhhbmRsZUlubmVyS2V5dXApOwoKCQkJCS8qKgoJCQkJICogQHBhcmFtIHtEb2N1bWVudH0gY29udGVudERvY3VtZW50CgkJCQkgKi8KCQkJCWZ1bmN0aW9uIG9uRnJhbWVMb2FkZWQoY29udGVudERvY3VtZW50KSB7CgkJCQkJcGVyZk1hcmsoJ2NvbnRlbnQvaW5uZXJGcmFtZUxvYWRlZCcpCgoJCQkJCS8vIFdvcmthcm91bmQgZm9yIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTk3ODMyNQoJCQkJCXNldFRpbWVvdXQoKCkgPT4gewoJCQkJCQljb250ZW50RG9jdW1lbnQub3BlbigpOwoJCQkJCQljb250ZW50RG9jdW1lbnQud3JpdGUobmV3RG9jdW1lbnQpOwoJCQkJCQljb250ZW50RG9jdW1lbnQuY2xvc2UoKTsKCQkJCQkJaG9va3VwT25Mb2FkSGFuZGxlcnMobmV3RnJhbWUpOwoJCQkJCQlwZXJmTWFyaygnY29udGVudC93cm90ZUlubmVyQ29udGVudCcpCgoJCQkJCQlpZiAoaW5pdGlhbFN0eWxlVmVyc2lvbiAhPT0gc3R5bGVWZXJzaW9uKSB7CgkJCQkJCQlhcHBseVN0eWxlcyhjb250ZW50RG9jdW1lbnQsIGNvbnRlbnREb2N1bWVudC5ib2R5KTsKCQkJCQkJfQoJCQkJCX0sIDApOwoJCQkJfQoKCQkJCWlmICghb3B0aW9ucy5hbGxvd1NjcmlwdHMgJiYgaXNTYWZhcmkpIHsKCQkJCQkvLyBPbiBTYWZhcmkgZm9yIGlmcmFtZXMgd2l0aCBzY3JpcHRzIGRpc2FibGVkLCB0aGUgYERPTUNvbnRlbnRMb2FkZWRgIG5ldmVyIHNlZW1zIHRvIGJlIGZpcmVkOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MzM2MDQKCQkJCQkvLyBVc2UgcG9sbGluZyBpbnN0ZWFkLgoJCQkJCWNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewoJCQkJCQkvLyBJZiB0aGUgZnJhbWUgaXMgbm8gbG9uZ2VyIG1vdW50ZWQsIGxvYWRpbmcgaGFzIHN0b3BwZWQKCQkJCQkJaWYgKCFuZXdGcmFtZS5wYXJlbnRFbGVtZW50KSB7CgkJCQkJCQljbGVhckludGVydmFsKGludGVydmFsKTsKCQkJCQkJCXJldHVybjsKCQkJCQkJfQoKCQkJCQkJY29uc3QgY29udGVudERvY3VtZW50ID0gYXNzZXJ0SXNEZWZpbmVkKG5ld0ZyYW1lLmNvbnRlbnREb2N1bWVudCk7CgkJCQkJCWlmIChjb250ZW50RG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUuZW5kc1dpdGgoJy9mYWtlLmh0bWwnKSAmJiBjb250ZW50RG9jdW1lbnQucmVhZHlTdGF0ZSAhPT0gJ2xvYWRpbmcnKSB7CgkJCQkJCQljbGVhckludGVydmFsKGludGVydmFsKTsKCQkJCQkJCW9uRnJhbWVMb2FkZWQoY29udGVudERvY3VtZW50KTsKCQkJCQkJfQoJCQkJCX0sIDEwKTsKCQkJCX0gZWxzZSB7CgkJCQkJYXNzZXJ0SXNEZWZpbmVkKG5ld0ZyYW1lLmNvbnRlbnRXaW5kb3cpLmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBlID0+IHsKCQkJCQkJY29uc3QgY29udGVudERvY3VtZW50ID0gZS50YXJnZXQgPyAoLyoqIEB0eXBlIHtIVE1MRG9jdW1lbnR9ICovIChlLnRhcmdldCkpIDogdW5kZWZpbmVkOwoJCQkJCQlvbkZyYW1lTG9hZGVkKGFzc2VydElzRGVmaW5lZChjb250ZW50RG9jdW1lbnQpKTsKCQkJCQl9KTsKCQkJCX0KCgkJCQkvKioKCQkJCSAqIEBwYXJhbSB7RG9jdW1lbnR9IGNvbnRlbnREb2N1bWVudAoJCQkJICogQHBhcmFtIHtXaW5kb3d9IGNvbnRlbnRXaW5kb3cKCQkJCSAqLwoJCQkJY29uc3Qgb25Mb2FkID0gKGNvbnRlbnREb2N1bWVudCwgY29udGVudFdpbmRvdykgPT4gewoJCQkJCWlmIChjb250ZW50RG9jdW1lbnQgJiYgY29udGVudERvY3VtZW50LmJvZHkpIHsKCQkJCQkJLy8gV29ya2Fyb3VuZCBmb3IgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvaXNzdWVzLzEyODY1CgkJCQkJCS8vIGNoZWNrIG5ldyBzY3JvbGxZIGFuZCByZXNldCBpZiBuZWNlc3NhcnkKCQkJCQkJc2V0SW5pdGlhbFNjcm9sbFBvc2l0aW9uKGNvbnRlbnREb2N1bWVudC5ib2R5LCBjb250ZW50V2luZG93KTsKCQkJCQl9CgoJCQkJCWNvbnN0IG5ld0ZyYW1lID0gZ2V0UGVuZGluZ0ZyYW1lKCk7CgkJCQkJaWYgKG5ld0ZyYW1lICYmIG5ld0ZyYW1lLmNvbnRlbnREb2N1bWVudCAmJiBuZXdGcmFtZS5jb250ZW50RG9jdW1lbnQgPT09IGNvbnRlbnREb2N1bWVudCkgewoJCQkJCQljb25zdCB3YXNGb2N1c2VkID0gZG9jdW1lbnQuaGFzRm9jdXMoKTsKCQkJCQkJY29uc3Qgb2xkQWN0aXZlRnJhbWUgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJCQlvbGRBY3RpdmVGcmFtZT8ucmVtb3ZlKCk7CgkJCQkJCS8vIFN0eWxlcyBtYXkgaGF2ZSBjaGFuZ2VkIHNpbmNlIHdlIGNyZWF0ZWQgdGhlIGVsZW1lbnQuIE1ha2Ugc3VyZSB3ZSByZS1zdHlsZQoJCQkJCQlpZiAoaW5pdGlhbFN0eWxlVmVyc2lvbiAhPT0gc3R5bGVWZXJzaW9uKSB7CgkJCQkJCQlhcHBseVN0eWxlcyhuZXdGcmFtZS5jb250ZW50RG9jdW1lbnQsIG5ld0ZyYW1lLmNvbnRlbnREb2N1bWVudC5ib2R5KTsKCQkJCQkJfQoJCQkJCQluZXdGcmFtZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2FjdGl2ZS1mcmFtZScpOwoJCQkJCQluZXdGcmFtZS5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOwoKCQkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBoYW5kbGVJbm5lclNjcm9sbCk7CgkJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBoYW5kbGVXaGVlbCk7CgoJCQkJCQlpZiAod2FzRm9jdXNlZCkgewoJCQkJCQkJY29udGVudFdpbmRvdy5mb2N1cygpOwoJCQkJCQl9CgoJCQkJCQkvLyBHZXQgYm9keSBzaXplCgkJCQkJCWNvbnN0IGRvY0VsID0gY29udGVudERvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCQkJCQkJaWYgKGRvY0VsKSB7CgkJCQkJCQljb25zdCBwb3N0U2l6ZSA9ICgpID0+IHsKCQkJCQkJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKCd1cGRhdGVkLWludHJpbnNpYy1jb250ZW50LXNpemUnLCB7CgkJCQkJCQkJCXdpZHRoOiBkb2NFbC5vZmZzZXRXaWR0aCwKCQkJCQkJCQkJaGVpZ2h0OiBkb2NFbC5vZmZzZXRIZWlnaHQKCQkJCQkJCQl9KTsKCQkJCQkJCX07CgoJCQkJCQkJY29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIocG9zdFNpemUpOwoJCQkJCQkJcmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShkb2NFbCk7CgkJCQkJCQlwb3N0U2l6ZSgpOwoJCQkJCQl9CgoJCQkJCQlwZW5kaW5nTWVzc2FnZXMuZm9yRWFjaCgobWVzc2FnZSkgPT4gewoJCQkJCQkJY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShtZXNzYWdlLm1lc3NhZ2UsIHdpbmRvdy5vcmlnaW4sIG1lc3NhZ2UudHJhbnNmZXIpOwoJCQkJCQl9KTsKCQkJCQkJcGVuZGluZ01lc3NhZ2VzID0gW107CgkJCQkJfQoJCQkJfTsKCgkJCQkvKioKCQkJCSAqIEBwYXJhbSB7SFRNTElGcmFtZUVsZW1lbnR9IG5ld0ZyYW1lCgkJCQkgKi8KCQkJCWZ1bmN0aW9uIGhvb2t1cE9uTG9hZEhhbmRsZXJzKG5ld0ZyYW1lKSB7CgkJCQkJY2xlYXJUaW1lb3V0KGxvYWRUaW1lb3V0KTsKCQkJCQlsb2FkVGltZW91dCA9IHVuZGVmaW5lZDsKCQkJCQlsb2FkVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gewoJCQkJCQljbGVhclRpbWVvdXQobG9hZFRpbWVvdXQpOwoJCQkJCQlsb2FkVGltZW91dCA9IHVuZGVmaW5lZDsKCQkJCQkJb25Mb2FkKGFzc2VydElzRGVmaW5lZChuZXdGcmFtZS5jb250ZW50RG9jdW1lbnQpLCBhc3NlcnRJc0RlZmluZWQobmV3RnJhbWUuY29udGVudFdpbmRvdykpOwoJCQkJCX0sIDIwMCk7CgoJCQkJCWNvbnN0IGNvbnRlbnRXaW5kb3cgPSBhc3NlcnRJc0RlZmluZWQobmV3RnJhbWUuY29udGVudFdpbmRvdyk7CgoJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uIChlKSB7CgkJCQkJCWNvbnN0IGNvbnRlbnREb2N1bWVudCA9IC8qKiBAdHlwZSB7RG9jdW1lbnR9ICovIChlLnRhcmdldCk7CgoJCQkJCQlpZiAobG9hZFRpbWVvdXQpIHsKCQkJCQkJCWNsZWFyVGltZW91dChsb2FkVGltZW91dCk7CgkJCQkJCQlsb2FkVGltZW91dCA9IHVuZGVmaW5lZDsKCQkJCQkJCW9uTG9hZChjb250ZW50RG9jdW1lbnQsIHRoaXMpOwoJCQkJCQl9CgkJCQkJfSk7CgoJCQkJCS8vIEJ1YmJsZSBvdXQgdmFyaW91cyBldmVudHMKCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlSW5uZXJDbGljayk7CgkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdhdXhjbGljaycsIGhhbmRsZUF1eENsaWNrKTsKCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVJbm5lcktleWRvd24pOwoJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBoYW5kbGVJbm5lcktleXVwKTsKCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgZSA9PiB7CgkJCQkJCWlmIChlLmRlZmF1bHRQcmV2ZW50ZWQpIHsKCQkJCQkJCS8vIEV4dGVuc2lvbiBjb2RlIGhhcyBhbHJlYWR5IGhhbmRsZWQgdGhpcyBldmVudAoJCQkJCQkJcmV0dXJuOwoJCQkJCQl9CgoJCQkJCQllLnByZXZlbnREZWZhdWx0KCk7CgoJCQkJCQkvKiogQHR5cGUgeyBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPn0gKi8KCQkJCQkJbGV0IGNvbnRleHQgPSB7fTsKCgkJCQkJCS8qKiBAdHlwZSB7SFRNTEVsZW1lbnQgfCBudWxsfSAqLwoJCQkJCQlsZXQgZWwgPSBlLnRhcmdldDsKCQkJCQkJd2hpbGUgKHRydWUpIHsKCQkJCQkJCWlmICghZWwpIHsKCQkJCQkJCQlicmVhazsKCQkJCQkJCX0KCgkJCQkJCQkvLyBTZWFyY2ggc2VsZi9hbmNlc3RvcnMgZm9yIHRoZSBjbG9zZXN0IGNvbnRleHQgZGF0YSBhdHRyaWJ1dGUKCQkJCQkJCWVsID0gZWwuY2xvc2VzdCgnW2RhdGEtdnNjb2RlLWNvbnRleHRdJyk7CgkJCQkJCQlpZiAoIWVsKSB7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQl9CgoJCQkJCQkJdHJ5IHsKCQkJCQkJCQljb250ZXh0ID0geyAuLi5KU09OLnBhcnNlKGVsLmRhdGFzZXQudnNjb2RlQ29udGV4dCksIC4uLmNvbnRleHQgfTsKCQkJCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQkJCQljb25zb2xlLmVycm9yKGBFcnJvciBwYXJzaW5nICdkYXRhLXZzY29kZS1jb250ZXh0JyBhcyBqc29uYCwgZWwsIGUpOwoJCQkJCQkJfQoKCQkJCQkJCWVsID0gZWwucGFyZW50RWxlbWVudDsKCQkJCQkJfQoKCQkJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWNvbnRleHQtbWVudScsIHsKCQkJCQkJCWNsaWVudFg6IGUuY2xpZW50WCwKCQkJCQkJCWNsaWVudFk6IGUuY2xpZW50WSwKCQkJCQkJCWNvbnRleHQ6IGNvbnRleHQKCQkJCQkJfSk7CgkJCQkJfSk7CgoJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgaGFuZGxlSW5uZXJEcmFnU3RhcnRFdmVudCk7CgkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGhhbmRsZUlubmVyRHJhZ0V2ZW50KTsKCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWcnLCBoYW5kbGVJbm5lckRyYWdFdmVudCk7CgkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgaGFuZGxlSW5uZXJEcm9wRXZlbnQpOwoKCQkJCQl1bmxvYWRNb25pdG9yLm9uSWZyYW1lTG9hZGVkKG5ld0ZyYW1lKTsKCQkJCX0KCgkJCQlpZiAoIWRpc2FibGVTZXJ2aWNlV29ya2VyICYmIG91dGVySWZyYW1lTWVzc2FnZUNoYW5uZWwpIHsKCQkJCQlvdXRlcklmcmFtZU1lc3NhZ2VDaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGV2ZW50ID0+IHsKCQkJCQkJc3dpdGNoIChldmVudC5kYXRhLmNoYW5uZWwpIHsKCQkJCQkJCWNhc2UgJ2xvYWQtcmVzb3VyY2UnOgoJCQkJCQkJY2FzZSAnbG9hZC1sb2NhbGhvc3QnOgoJCQkJCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoZXZlbnQuZGF0YS5jaGFubmVsLCBldmVudC5kYXRhKTsKCQkJCQkJCQlyZXR1cm47CgkJCQkJCX0KCQkJCQl9OwoJCQkJfQoJCQl9KTsKCgkJCS8vIHByb3BhZ2F0ZSB2c2NvZGUtY29udGV4dC1tZW51LXZpc2libGUgY2xhc3MKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ3NldC1jb250ZXh0LW1lbnUtdmlzaWJsZScsIChfZXZlbnQsIGRhdGEpID0+IHsKCQkJCWNvbnN0IHRhcmdldCA9IGdldEFjdGl2ZUZyYW1lKCk7CgkJCQlpZiAodGFyZ2V0ICYmIHRhcmdldC5jb250ZW50RG9jdW1lbnQpIHsKCQkJCQl0YXJnZXQuY29udGVudERvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgndnNjb2RlLWNvbnRleHQtbWVudS12aXNpYmxlJywgZGF0YS52aXNpYmxlKTsKCQkJCX0KCQkJfSk7CgoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnc2V0LXRpdGxlJywgYXN5bmMgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJY29uc3QgdGFyZ2V0ID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCWlmICh0YXJnZXQpIHsKCQkJCQl0YXJnZXQudGl0bGUgPSBkYXRhOwoJCQkJfQoJCQl9KTsKCgkJCS8vIEZvcndhcmQgbWVzc2FnZSB0byB0aGUgZW1iZWRkZWQgaWZyYW1lCgkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdtZXNzYWdlJywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJY29uc3QgcGVuZGluZyA9IGdldFBlbmRpbmdGcmFtZSgpOwoJCQkJaWYgKCFwZW5kaW5nKSB7CgkJCQkJY29uc3QgdGFyZ2V0ID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCQlpZiAodGFyZ2V0KSB7CgkJCQkJCWFzc2VydElzRGVmaW5lZCh0YXJnZXQuY29udGVudFdpbmRvdykucG9zdE1lc3NhZ2UoZGF0YS5tZXNzYWdlLCB3aW5kb3cub3JpZ2luLCBkYXRhLnRyYW5zZmVyKTsKCQkJCQkJcmV0dXJuOwoJCQkJCX0KCQkJCX0KCQkJCXBlbmRpbmdNZXNzYWdlcy5wdXNoKGRhdGEpOwoJCQl9KTsKCgkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdpbml0aWFsLXNjcm9sbC1wb3NpdGlvbicsIChfZXZlbnQsIHByb2dyZXNzKSA9PiB7CgkJCQlpbml0RGF0YS5pbml0aWFsU2Nyb2xsUHJvZ3Jlc3MgPSBwcm9ncmVzczsKCQkJfSk7CgoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnZXhlY0NvbW1hbmQnLCAoX2V2ZW50LCBkYXRhKSA9PiB7CgkJCQljb25zdCB0YXJnZXQgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJaWYgKCF0YXJnZXQpIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCQlhc3NlcnRJc0RlZmluZWQodGFyZ2V0LmNvbnRlbnREb2N1bWVudCkuZXhlY0NvbW1hbmQoZGF0YSk7CgkJCX0pOwoKCQkJLyoqIEB0eXBlIHtzdHJpbmcgfCB1bmRlZmluZWR9ICovCgkJCWxldCBsYXN0RmluZFZhbHVlID0gdW5kZWZpbmVkOwoKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ2ZpbmQnLCAoX2V2ZW50LCBkYXRhKSA9PiB7CgkJCQljb25zdCB0YXJnZXQgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJaWYgKCF0YXJnZXQpIHsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJaWYgKCFkYXRhLnByZXZpb3VzICYmIGxhc3RGaW5kVmFsdWUgIT09IGRhdGEudmFsdWUgJiYgdGFyZ2V0LmNvbnRlbnRXaW5kb3cpIHsKCQkJCQkvLyBSZXNldCBzZWxlY3Rpb24gc28gd2Ugc3RhcnQgc2VhcmNoIGF0IHRoZSBoZWFkIG9mIHRoZSBsYXN0IHNlYXJjaAoJCQkJCWNvbnN0IHNlbGVjdGlvbiA9IHRhcmdldC5jb250ZW50V2luZG93LmdldFNlbGVjdGlvbigpOwoJCQkJCWlmIChzZWxlY3Rpb24pIHsKCQkJCQkJc2VsZWN0aW9uLmNvbGxhcHNlKHNlbGVjdGlvbi5hbmNob3JOb2RlKTsKCQkJCQl9CgkJCQl9CgkJCQlsYXN0RmluZFZhbHVlID0gZGF0YS52YWx1ZTsKCgkJCQljb25zdCBkaWRGaW5kID0gKC8qKiBAdHlwZSB7YW55fSAqLyAodGFyZ2V0LmNvbnRlbnRXaW5kb3cpKS5maW5kKAoJCQkJCWRhdGEudmFsdWUsCgkJCQkJLyogY2FzZVNlbnNpdGl2ZSovIGZhbHNlLAoJCQkJCS8qIGJhY2t3YXJkcyovIGRhdGEucHJldmlvdXMsCgkJCQkJLyogd3JhcEFyb3VuZCovIHRydWUsCgkJCQkJLyogd2hvbGVXb3JkICovIGZhbHNlLAoJCQkJCS8qIHNlYXJjaEluRnJhbWVzKi8gZmFsc2UsCgkJCQkJZmFsc2UpOwoJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWZpbmQnLCBkaWRGaW5kKTsKCQkJfSk7CgoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnZmluZC1zdG9wJywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJY29uc3QgdGFyZ2V0ID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCWlmICghdGFyZ2V0KSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCWxhc3RGaW5kVmFsdWUgPSB1bmRlZmluZWQ7CgoJCQkJaWYgKCFkYXRhLmNsZWFyU2VsZWN0aW9uICYmIHRhcmdldC5jb250ZW50V2luZG93KSB7CgkJCQkJY29uc3Qgc2VsZWN0aW9uID0gdGFyZ2V0LmNvbnRlbnRXaW5kb3cuZ2V0U2VsZWN0aW9uKCk7CgkJCQkJaWYgKHNlbGVjdGlvbikgewoJCQkJCQlmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdGlvbi5yYW5nZUNvdW50OyBpKyspIHsKCQkJCQkJCXNlbGVjdGlvbi5yZW1vdmVSYW5nZShzZWxlY3Rpb24uZ2V0UmFuZ2VBdChpKSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0pOwoKCQkJdHJhY2tGb2N1cyh7CgkJCQlvbkZvY3VzOiAoKSA9PiBob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKCdkaWQtZm9jdXMnLCB1bmRlZmluZWQpLAoJCQkJb25CbHVyOiAoKSA9PiBob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKCdkaWQtYmx1cicsIHVuZGVmaW5lZCkKCQkJfSk7CgoJCQkoLyoqIEB0eXBlIHthbnl9ICovICh3aW5kb3cpKVt2c2NvZGVQb3N0TWVzc2FnZUZ1bmNOYW1lXSA9ICgvKiogQHR5cGUge3N0cmluZ30gKi8gY29tbWFuZCwgLyoqIEB0eXBlIHthbnl9ICovIGRhdGEpID0+IHsKCQkJCXN3aXRjaCAoY29tbWFuZCkgewoJCQkJCWNhc2UgJ29ubWVzc2FnZSc6CgkJCQkJY2FzZSAnZG8tdXBkYXRlLXN0YXRlJzoKCQkJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZShjb21tYW5kLCBkYXRhKTsKCQkJCQkJYnJlYWs7CgkJCQl9CgkJCX07CgoJCQlob3N0TWVzc2FnaW5nLnNpZ25hbFJlYWR5KCk7CgkJfSk7Cgk8L3NjcmlwdD4KPC9ib2R5PgoKPC9odG1sPgo=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,qb),"vs/workbench/contrib/webview/browser/pre/fake.html":()=>(0,ut.hd)(new URL("data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+Cgk8bWV0YSBjaGFyc2V0PSJVVEYtOCI+Cgk8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+Cgk8dGl0bGU+RmFrZTwvdGl0bGU+CjwvaGVhZD4KPGJvZHk+CjwvYm9keT4KPC9odG1sPgo=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-CDNzQHRh.js").href,qb)}),(0,pt.w)(async e=>{e.get(gt.Pn)}),(0,ut.xf)(),(0,at.wj)(),(0,at.oS)(),(0,ut.q)(),(0,at.Mb)(),(0,ut.N)(),(0,at.SO)(),(0,at.pO)(),(0,dt.a)(),(0,dt.V)(),(0,bt.Mt)(),(0,bt.en)(),(0,at.Tb)(),(0,vt.c)(),(0,at.Pk)(),(0,gt.f)(),(0,dt.c)(),(0,at.yb)(),(0,at.Lo)(),(0,at.Xd)(),(0,at.LA)(),(0,at.zp)(),(0,at.GM)(),(0,at.XA)(),(0,ut.ta)(),(0,dt.x)(),(0,dt._)(),(0,pt.W)(),(0,pt.st)(),(0,at.r)(),(0,at.sj)(),(0,at.Xt)(),(0,gt.n)(),at.jb.as(ut.uf.ViewContainersRegistry),at.jb.as(ut.uf.ViewsRegistry);var im=e=>at.n.get(pt.ot).onDidChangeSideBarPosition(e);function om(){return at.n.get(pt.ot).getSideBarPosition()}}}]);