"use strict";(self.webpackChunkWindmill_Whitelabel_Example=self.webpackChunkWindmill_Whitelabel_Example||[]).push([[97],{97:(e,t,i)=>{i.d(t,{_:()=>ci,a:()=>Sl,c:()=>ea,d:()=>er,f:()=>zs,g:()=>yi,h:()=>Vi,i:()=>zm,l:()=>zn,m:()=>wi,n:()=>qm,o:()=>hd,p:()=>Pi,r:()=>$m,s:()=>ia,t:()=>ev,u:()=>Un});var o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C,w,y,f,S,I,k,_,E,A,D,x,V,R,T,L,W,F,G,Z,N,P,J,B,O,K,M,j,Q,Y,H,X,U,z,q,$,ee,te,ie,oe,se,re,ne,ae,de,le,ce,he,ue,ge,pe,be,me,ve,Ce,we,ye,fe,Se,Ie,ke,_e,Ee,Ae,De,xe,Ve,Re,Te,Le,We,Fe,Ge,Ze,Ne,Pe,Je,Be,Oe,Ke,Me,je,Qe,Ye,He,Xe,Ue,ze,qe,$e,et,tt,it,ot,st,rt,nt,at,dt,lt,ct,ht,ut,gt,pt,bt,mt,vt,Ct,wt,yt,ft,St,It,kt,_t,Et,At,Dt,xt=i(9379),Vt=i(9495),Rt=i(6233),Tt=i(3262),Lt=i(9114),Wt=i(5452),Ft=i(3890),Gt=i(9558),Zt=i(4747),Nt=i(1588),Pt=i(5929),Jt=i(7077),Bt=i(6693),Ot=i(6048),Kt=i(4673),Mt=i(9863),jt=i(9399),Qt=i(7564),Yt=i(6567),Ht=i(7),Xt=i(308),Ut=i(6183),zt=i(5321);(0,Rt.Ib)(),(0,Rt.vb)(),(0,Lt.f)(),(0,Rt.Kb)(),(0,Rt.Mb)(),(0,Rt.db)(),(0,Rt.wl)(),(0,Rt.Wo)(),(0,Rt.ab)(),(0,Rt.$d)(),(0,Rt.za)(),(0,Wt.L)(),(0,Nt.Ot)(),(0,Wt.Q)();var qt=class extends Lt.l{constructor(e,t,i,o,s,r,n,a){super(e,t,s,i),this.storageService=i,this.instantiationService=o,this.contextMenuService=r,this.extensionService=n,this.contextService=a}create(e){super.create(e),this.viewPaneContainer=this._register(this.createViewPaneContainer(e)),this._register(this.viewPaneContainer.onTitleAreaUpdate(()=>this.updateTitleArea())),this.viewPaneContainer.create(e)}setVisible(e){var t;super.setVisible(e),null===(t=this.viewPaneContainer)||void 0===t||t.setVisible(e)}layout(e){var t;null===(t=this.viewPaneContainer)||void 0===t||t.layout(e)}setBoundarySashes(e){var t;null===(t=this.viewPaneContainer)||void 0===t||t.setBoundarySashes(e)}getOptimalWidth(){var e,t;return null!==(e=null===(t=this.viewPaneContainer)||void 0===t?void 0:t.getOptimalWidth())&&void 0!==e?e:0}openView(e,t){var i;return null===(i=this.viewPaneContainer)||void 0===i?void 0:i.openView(e,t)}getViewPaneContainer(){return this.viewPaneContainer}getActionsContext(){var e;return null===(e=this.getViewPaneContainer())||void 0===e?void 0:e.getActionsContext()}getContextMenuActions(){var e,t;return null!==(e=null===(t=this.viewPaneContainer)||void 0===t||null===(t=t.menuActions)||void 0===t?void 0:t.getContextMenuActions())&&void 0!==e?e:[]}getMenuIds(){var e;let t=[];return null!==(e=this.viewPaneContainer)&&void 0!==e&&e.menuActions&&(t.push(this.viewPaneContainer.menuActions.menuId),this.viewPaneContainer.isViewMergedWithContainer()&&t.push(this.viewPaneContainer.panes[0].menuActions.menuId)),t}getActions(){var e;let t=[];if(null!==(e=this.viewPaneContainer)&&void 0!==e&&e.menuActions&&(t.push(...this.viewPaneContainer.menuActions.getPrimaryActions()),this.viewPaneContainer.isViewMergedWithContainer())){let e=this.viewPaneContainer.panes[0];e.shouldShowFilterInHeader()&&t.push(Wt.J),t.push(...e.menuActions.getPrimaryActions())}return t}getSecondaryActions(){var e;if(null===(e=this.viewPaneContainer)||void 0===e||!e.menuActions)return[];let t=this.viewPaneContainer.isViewMergedWithContainer()?this.viewPaneContainer.panes[0].menuActions.getSecondaryActions():[],i=this.viewPaneContainer.menuActions.getSecondaryActions(),o=i.findIndex(e=>e instanceof Rt.ub&&e.item.submenu===Wt.I);if(-1!==o){let e=i[o];e.actions.some(e=>{let{enabled:t}=e;return t})?1===i.length&&0===t.length?i=e.actions.slice():0!==o&&(i=[e,...i.slice(0,o),...i.slice(o+1)]):i.splice(o,1)}return i.length&&t.length?[...i,new Rt.Ab,...t]:i.length?i:t}getActionViewItem(e,t){var i;return null===(i=this.viewPaneContainer)||void 0===i?void 0:i.getActionViewItem(e,t)}getTitle(){var e,t;return null!==(e=null===(t=this.viewPaneContainer)||void 0===t?void 0:t.getTitle())&&void 0!==e?e:""}focus(){var e;super.focus(),null===(e=this.viewPaneContainer)||void 0===e||e.focus()}};qt=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.Uo),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Rt.Qd),(0,Rt.Fb)(5,Rt.Sl),(0,Rt.Fb)(6,Nt.Dt),(0,Rt.Fb)(7,Rt.Ra)],qt);var $t=class e extends Lt.u{static create(t,i,o,s,r,n,a){return new e(t,i,o,s,r,n,a)}constructor(e,t,i,o,s,r,n){super(e,t,i,o,s,r),this.iconUrl=n}},ei="workbench.contributions.viewlets",ti="workbench.contributions.panels",ii="workbench.contributions.auxiliary",oi=class extends Lt.d{registerPaneComposite(e){super.registerComposite(e)}deregisterPaneComposite(e){super.deregisterComposite(e)}getPaneComposite(e){return this.getComposite(e)}getPaneComposites(){return this.getComposites()}};Rt._b.add(ei,new oi),Rt._b.add(ti,new oi),Rt._b.add(ii,new oi),(0,Rt.fE)(),(0,Rt.Fj)(),(0,Rt.na)(),(0,Rt.PA)(),(0,Rt.gA)(),(0,Rt.xN)(),(0,Rt.zr)(),(0,Rt.Hn)(),(0,Tt.mt)(),(0,Rt.Jo)(),(0,Rt.tu)(),(0,Rt.Ja)(),(0,Rt.qx)(),(0,Rt.ml)(),(0,Rt.nM)(),(0,Rt.Xr)(),(0,Wt.nt)(),(0,Lt.lr)(),(0,Rt.Mi)(),(0,Rt.da)(),(0,Rt.mE)({});var si,ri,ni,ai=class extends Tt.pt{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){var v;super(b,m,a,t,o),this.notificationService=e,this.storageService=t,this.contextMenuService=i,this.keybindingService=s,this.hoverService=r,this.instantiationService=n,this.registry=d,this.activeCompositeSettingsKey=l,this.defaultCompositeId=c,this.nameForTelemetry=h,this.compositeCSSClass=u,this.titleForegroundColor=g,this.titleBorderColor=p,this.onDidCompositeOpen=this._register(new Rt.uA),this.onDidCompositeClose=this._register(new Rt.uA),this.mapCompositeToCompositeContainer=new Map,this.mapActionsBindingToComposite=new Map,this.instantiatedCompositeItems=new Map,this.actionsListener=this._register(new Rt.OA),this.lastActiveCompositeId=t.get(l,Rt.Go.WORKSPACE,this.defaultCompositeId),this.toolbarHoverDelegate=this._register((0,Rt.la)()),this.trailingSeparator=null!==(v=m.trailingSeparator)&&void 0!==v&&v}openComposite(e,t){var i;return(null===(i=this.activeComposite)||void 0===i?void 0:i.getId())===e?(t&&this.activeComposite.focus(),this.activeComposite):this.element?this.doOpenComposite(e,t):void 0}doOpenComposite(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=Rt.ta.nextId();this.currentCompositeOpenToken=o,this.activeComposite&&this.hideActiveComposite(),this.updateTitle(e);let s=this.createComposite(e,!0);if(!(this.currentCompositeOpenToken!==o||this.activeComposite&&this.activeComposite.getId()!==s.getId()))return(null===(t=this.activeComposite)||void 0===t?void 0:t.getId())===s.getId()?(i&&s.focus(),this.onDidCompositeOpen.fire({composite:s,focus:i}),s):(this.showComposite(s),i&&s.focus(),s&&this.onDidCompositeOpen.fire({composite:s,focus:i}),s)}createComposite(e,t){let i=this.instantiatedCompositeItems.get(e);if(i)return i.composite;let o=this.registry.getComposite(e);if(o){let i=this,s=new Wt.tt((0,Rt.$j)(this.progressBar),this._register(new class extends Wt.${constructor(){super(o.id,!!t),this._register(i.onDidCompositeOpen.event(e=>this.onScopeOpened(e.composite.getId()))),this._register(i.onDidCompositeClose.event(e=>this.onScopeClosed(e.getId())))}})),r=this._register(this.instantiationService.createChild(new Rt.eu([Rt.Ka,s]))),n=o.instantiate(r),a=new Rt.EA;return this.instantiatedCompositeItems.set(e,{composite:n,disposable:a,progress:s}),a.add(n.onTitleAreaUpdate(()=>this.onTitleAreaUpdate(n.getId()),this)),a.add(r),n}throw Error("Unable to find composite with id ".concat(e))}showComposite(e){var t;this.activeComposite=e;let i=this.activeComposite.getId();i===this.defaultCompositeId?this.storageService.remove(this.activeCompositeSettingsKey,Rt.Go.WORKSPACE):this.storageService.store(this.activeCompositeSettingsKey,i,Rt.Go.WORKSPACE,Rt.Ko.MACHINE),this.lastActiveCompositeId=this.activeComposite.getId();let o=this.mapCompositeToCompositeContainer.get(e.getId());if(o||(o=(0,Rt.Zb)(".composite"),o.classList.add(...this.compositeCSSClass.split(" ")),o.id=e.getId(),e.create(o),e.updateStyles(),this.mapCompositeToCompositeContainer.set(e.getId(),o)),!this.activeComposite||e.getId()!==this.activeComposite.getId())return;null!==(t=this.contentArea)&&void 0!==t&&t.appendChild(o),(0,Rt.DS)(o);let s=(0,Rt.$j)(this.toolBar);s.actionRunner=e.getActionRunner();let r=this.registry.getComposite(e.getId());r&&r.name!==e.getTitle()&&this.updateTitle(e.getId(),e.getTitle());let n=this.mapActionsBindingToComposite.get(e.getId());n||(n=this.collectCompositeActions(e),this.mapActionsBindingToComposite.set(e.getId(),n)),n(),this.actionsListener.value=s.actionRunner.onDidRun(e=>{e.error&&!(0,Rt.SN)(e.error)&&this.notificationService.error(e.error)}),e.setVisible(!0),this.activeComposite&&e.getId()===this.activeComposite.getId()&&(this.contentAreaSize&&e.layout(this.contentAreaSize),this.boundarySashes&&e.setBoundarySashes(this.boundarySashes))}onTitleAreaUpdate(e){var t;let i=this.instantiatedCompositeItems.get(e);if(i&&this.updateTitle(e,i.composite.getTitle()),(null===(t=this.activeComposite)||void 0===t?void 0:t.getId())===e){let e=this.collectCompositeActions(this.activeComposite);this.mapActionsBindingToComposite.set(this.activeComposite.getId(),e),e()}else this.mapActionsBindingToComposite.delete(e)}updateTitle(e,t){var i;let o=this.registry.getComposite(e);if(!o||!this.titleLabel)return;t||(t=o.name);let s=this.keybindingService.lookupKeybinding(e);this.titleLabel.updateTitle(e,t,null!==(i=null===s||void 0===s?void 0:s.getLabel())&&void 0!==i?i:void 0),(0,Rt.$j)(this.toolBar).setAriaLabel((0,Rt.Ij)(3044,"{0} actions",t))}collectCompositeActions(e){let t=null===e||void 0===e?void 0:e.getMenuIds(),i=(null===e||void 0===e?void 0:e.getActions().slice(0))||[],o=(null===e||void 0===e?void 0:e.getSecondaryActions().slice(0))||[],s=(0,Rt.$j)(this.toolBar);return s.context=this.actionsContextProvider(),()=>{var e;s.setActions((0,Rt.Br)(i),(0,Rt.Br)(o),t),null===(e=this.titleArea)||void 0===e||e.classList.toggle("has-actions",i.length>0||o.length>0)}}getActiveComposite(){return this.activeComposite}getLastActiveCompositeId(){return this.lastActiveCompositeId}hideActiveComposite(){var e;if(!this.activeComposite)return;let t=this.activeComposite;this.activeComposite=void 0;let i=this.mapCompositeToCompositeContainer.get(t.getId());return t.setVisible(!1),i&&(i.remove(),(0,Rt.Kx)(i)),null!==(e=this.progressBar)&&void 0!==e&&e.stop().hide(),this.toolBar&&this.collectCompositeActions()(),this.onDidCompositeClose.fire(t),t}createTitleArea(e){let t=(0,Rt.dx)(e,(0,Rt.Zb)(".composite"));t.classList.add("title"),this.titleLabel=this.createTitleLabel(t);let i=(0,Rt.dx)(t,(0,Rt.Zb)(".title-actions"));return this.toolBar=this._register(this.instantiationService.createInstance(Lt.cr,i,{actionViewItemProvider:(e,t)=>this.actionViewItemProvider(e,t),orientation:Rt.Rr.HORIZONTAL,getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:(0,Rt.Ij)(3045,"Views and More Actions..."),telemetrySource:this.nameForTelemetry,hoverDelegate:this.toolbarHoverDelegate,trailingSeparator:this.trailingSeparator})),this.collectCompositeActions()(),t}createTitleLabel(e){let t=(0,Rt.dx)((0,Rt.dx)(e,(0,Rt.Zb)(".title-label")),(0,Rt.Zb)("h2"));this.titleLabelElement=t;let i=this._register(this.hoverService.setupManagedHover((0,Rt.ua)("mouse"),t,"")),o=this;return{updateTitle:(e,o,s)=>{(!this.activeComposite||this.activeComposite.getId()===e)&&(t.textContent=o,i.update(s?(0,Rt.Ij)(3046,"{0} ({1})",o,s):o))},updateStyles:()=>{t.style.color=o.titleForegroundColor&&o.getColor(o.titleForegroundColor)||"";let i=o.titleBorderColor?o.getColor(o.titleBorderColor):void 0;e.style.borderBottom=i?"1px solid ".concat(i):""}}}createHeaderArea(){return(0,Rt.Zb)(".composite")}createFooterArea(){return(0,Rt.Zb)(".composite")}updateStyles(){super.updateStyles(),(0,Rt.$j)(this.titleLabel).updateStyles()}actionViewItemProvider(e,t){return this.activeComposite?this.activeComposite.getActionViewItem(e,t):(0,Rt.Wr)(this.instantiationService,e,t)}actionsContextProvider(){return this.activeComposite?this.activeComposite.getActionsContext():null}createContentArea(e){let t=(0,Rt.dx)(e,(0,Rt.Zb)(".content"));return this.progressBar=this._register(new Rt.Vn(t,Rt.ki)),this.progressBar.hide(),t}getProgressIndicator(e){let t=this.instantiatedCompositeItems.get(e);return t?t.progress:void 0}getTitleAreaDropDownAnchorAlignment(){return Rt.fl.RIGHT}layout(e,t,i,o){var s;super.layout(e,t,i,o),this.contentAreaSize=Rt.Qb.lift(super.layoutContents(e,t).contentSize),null===(s=this.activeComposite)||void 0===s||s.layout(this.contentAreaSize)}setBoundarySashes(e){var t;this.boundarySashes=e,null===(t=this.activeComposite)||void 0===t||t.setBoundarySashes(e)}removeComposite(e){var t;if((null===(t=this.activeComposite)||void 0===t?void 0:t.getId())===e)return!1;this.mapCompositeToCompositeContainer.delete(e),this.mapActionsBindingToComposite.delete(e);let i=this.instantiatedCompositeItems.get(e);return i&&(i.composite.dispose(),(0,Rt.MA)(i.disposable),this.instantiatedCompositeItems.delete(e)),!0}dispose(){this.mapCompositeToCompositeContainer.clear(),this.mapActionsBindingToComposite.clear(),this.instantiatedCompositeItems.forEach(e=>{e.composite.dispose(),(0,Rt.MA)(e.disposable)}),this.instantiatedCompositeItems.clear(),super.dispose()}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.gA)(),(0,Rt.Kb)(),(0,Wt.Df)(),(0,Wt.fx)(),(0,Rt.PA)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Tt.E)(),(0,Rt.qx)(),(0,Rt.vb)(),(0,Rt.Rd)(),(0,Rt.Wo)(),(0,Rt.wl)(),(0,Rt.Ad)(),(0,Rt.$d)(),(0,Rt.bb)(),(0,Nt.Ot)(),(0,Rt.Fj)(),(0,Wt.W)(),(0,Lt.Xn)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.zr)(),(0,Rt.ym)(),(0,Rt.FT)(),(0,Rt.Mb)(),(0,Wt.L)(),(0,Rt.Xr)(),(0,Rt.cr)(),(0,Lt.lr)(),(0,Rt.Iw)(),(0,Rt.mE)({}),(ni=ri||(ri={}))[ni.TOP=0]="TOP",ni[ni.TITLE=1]="TITLE",ni[ni.BOTTOM=2]="BOTTOM";var di,li=(o=class extends ai{get snap(){var e;return this.layoutService.isVisible(this.partId)||!(null===(e=this.paneCompositeBar.value)||void 0===e||!e.getVisiblePaneCompositeIds().length)}get onDidPaneCompositeOpen(){return Rt.dA.map(this.onDidCompositeOpen.event,e=>e.composite)}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C,w,y){var f;let S=Wt.Sf.Sidebar,I=ei,k=Rt.sb.SidebarTitle;e===Nt.I.PANEL_PART?(S=Wt.Sf.Panel,I=ti,k=Rt.sb.PanelTitle):e===Nt.I.AUXILIARYBAR_PART&&(S=Wt.Sf.AuxiliaryBar,I=ii,k=Rt.sb.AuxiliaryBarTitle),super(l,c,h,u,g,p,b,m,Rt._b.as(I),i,(null===(f=v.getDefaultViewContainer(S))||void 0===f?void 0:f.id)||"",r,n,a,d,e,t),this.partId=e,this.activePaneContextKey=o,this.paneFocusContextKey=s,this.viewDescriptorService=v,this.contextKeyService=C,this.extensionService=w,this.menuService=y,this.onDidPaneCompositeClose=this.onDidCompositeClose.event,this.headerFooterCompositeBarDispoables=this._register(new Rt.EA),this.paneCompositeBar=this._register(new Rt.OA),this.compositeBarPosition=void 0,this.blockOpening=void 0,this.location=S,this.globalActionsMenuId=k,this.registerListeners()}registerListeners(){this._register(this.onDidPaneCompositeOpen(e=>this.onDidOpen(e))),this._register(this.onDidPaneCompositeClose(this.onDidClose,this)),this._register(this.registry.onDidDeregister(e=>{let t=this.viewDescriptorService.getViewContainersByLocation(this.location).filter(e=>this.viewDescriptorService.getViewContainerModel(e).activeViewDescriptors.length>0);var i;if(t.length){if((null===(i=this.getActiveComposite())||void 0===i?void 0:i.getId())===e.id){var o;let e=null===(o=this.viewDescriptorService.getDefaultViewContainer(this.location))||void 0===o?void 0:o.id,i=t.filter(t=>t.id===e)[0]||t[0];this.doOpenPaneComposite(i.id)}}else this.layoutService.setPartHidden(!0,this.partId);this.removeComposite(e.id)})),this._register(this.extensionService.onDidRegisterExtensions(()=>{this.layoutCompositeBar()}))}onDidOpen(e){this.activePaneContextKey.set(e.getId())}onDidClose(e){let t=e.getId();this.activePaneContextKey.get()===t&&this.activePaneContextKey.reset()}showComposite(e){this.layoutEmptyMessage(!1),super.showComposite(e),this.layoutCompositeBar()}hideActiveComposite(){let e=super.hideActiveComposite();return this.layoutCompositeBar(),this.layoutEmptyMessage(!0),e}create(e){this.element=e,this.element.classList.add("pane-composite-part"),super.create(e),this.contentArea&&this.createEmptyPaneMessage(this.contentArea),this.updateCompositeBar();let t=this._register((0,Rt.AS)(e));this._register(t.onDidFocus(()=>this.paneFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.paneFocusContextKey.set(!1)))}createEmptyPaneMessage(e){this.emptyPaneMessageElement=(0,Rt.Zb)(".empty-pane-message-area");let t=(0,Rt.Zb)(".empty-pane-message");t.textContent=(0,Rt.Ij)(3593,"Drag a view here to display."),this.emptyPaneMessageElement.appendChild(t),e.appendChild(this.emptyPaneMessageElement);let i=e=>{var t;let i=!this.getActiveComposite()||!e,o=e&&(null===(t=this.theme.getColor(Lt.pt))||void 0===t?void 0:t.toString())||"";this.titleContainer&&i&&(this.titleContainer.style.backgroundColor=o),this.headerFooterCompositeBarContainer&&i&&(this.headerFooterCompositeBarContainer.style.backgroundColor=o),this.emptyPaneMessageElement.style.backgroundColor=o};this._register(Wt.R.INSTANCE.registerTarget(this.element,{onDragOver:e=>{if(Rt.ex.stop(e.eventData,!0),this.paneCompositeBar.value){let t=this.paneCompositeBar.value.dndHandler.onDragEnter(e.dragAndDropData,void 0,e.eventData);(0,Wt.K)(e.eventData.dataTransfer,"move",t)}},onDragEnter:e=>{Rt.ex.stop(e.eventData,!0),this.paneCompositeBar.value&&i(this.paneCompositeBar.value.dndHandler.onDragEnter(e.dragAndDropData,void 0,e.eventData))},onDragLeave:e=>{Rt.ex.stop(e.eventData,!0),i(!1)},onDragEnd:e=>{Rt.ex.stop(e.eventData,!0),i(!1)},onDrop:e=>{if(Rt.ex.stop(e.eventData,!0),i(!1),this.paneCompositeBar.value)this.paneCompositeBar.value.dndHandler.drop(e.dragAndDropData,void 0,e.eventData);else{let t=e.dragAndDropData.getData();if("composite"===t.type){let e=this.viewDescriptorService.getViewContainerById(t.id);this.viewDescriptorService.moveViewContainerToLocation(e,this.location,void 0,"dnd"),this.openPaneComposite(e.id,!0)}else if("view"===t.type){let e=this.viewDescriptorService.getViewDescriptorById(t.id);if(e.canMoveView){this.viewDescriptorService.moveViewToLocation(e,this.location,"dnd");let t=this.viewDescriptorService.getViewContainerByViewId(e.id);this.openPaneComposite(t.id,!0).then(t=>{null===t||void 0===t||t.openView(e.id,!0)})}}}}}))}createTitleArea(e){let t=super.createTitleArea(e);this._register((0,Rt.ox)(t,Rt.tx.CONTEXT_MENU,e=>{this.onTitleAreaContextMenu(new Rt.NT((0,Rt.Bx)(t),e))})),this._register(Rt.vm.addTarget(t)),this._register((0,Rt.ox)(t,Rt._m.Contextmenu,e=>{this.onTitleAreaContextMenu(new Rt.NT((0,Rt.Bx)(t),e))}));let i=t.appendChild((0,Rt.Zb)(".global-actions"));return this.globalToolBar=this._register(this.instantiationService.createInstance(Lt.sr,i,this.globalActionsMenuId,{actionViewItemProvider:(e,t)=>this.actionViewItemProvider(e,t),orientation:Rt.Rr.HORIZONTAL,getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:(0,Rt.Ij)(3594,"More Actions..."),hoverDelegate:this.toolbarHoverDelegate,hiddenItemStrategy:Lt.or.NoHide,highlightToggledItems:!0,telemetrySource:this.nameForTelemetry})),t}createTitleLabel(e){this.titleContainer=e;let t=super.createTitleLabel(e);return this.titleLabelElement.draggable=!0,this._register(Wt.R.INSTANCE.registerDraggable(this.titleLabelElement,()=>({type:"composite",id:this.getActivePaneComposite().getId()}),{})),t}updateCompositeBar(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=void 0!==this.compositeBarPosition,o=this.shouldShowCompositeBar(),s=this.compositeBarPosition,r=o?this.getCompositeBarPosition():void 0;if(t||s!==r){if(i){let e=s===ri.TITLE?this.titleContainer:this.headerFooterCompositeBarContainer;if(!this.paneCompositeBarContainer||!this.paneCompositeBar.value||!e)throw Error("Composite bar containers should exist when removing the previous composite bar");this.paneCompositeBarContainer.remove(),this.paneCompositeBarContainer=void 0,this.paneCompositeBar.value=void 0,e.classList.remove("has-composite-bar"),s===ri.TOP?this.removeFooterHeaderArea(!0):s===ri.BOTTOM&&this.removeFooterHeaderArea(!1)}switch(r){case ri.TOP:e=this.createHeaderArea();break;case ri.TITLE:e=this.titleContainer;break;case ri.BOTTOM:e=this.createFooterArea()}if(o){if(this.paneCompositeBarContainer||this.paneCompositeBar.value||!e)throw Error("Invalid composite bar state when creating the new composite bar");e.classList.add("has-composite-bar"),this.paneCompositeBarContainer=(0,Rt.gS)(e,(0,Rt.Zb)(".composite-bar-container")),this.paneCompositeBar.value=this.createCompositeBar(),this.paneCompositeBar.value.create(this.paneCompositeBarContainer),r===ri.TOP?this.setHeaderArea(e):r===ri.BOTTOM&&this.setFooterArea(e)}this.compositeBarPosition=r,t&&this.layoutCompositeBar()}}createHeaderArea(){let e=super.createHeaderArea();return this.createHeaderFooterCompositeBarArea(e)}createFooterArea(){let e=super.createFooterArea();return this.createHeaderFooterCompositeBarArea(e)}createHeaderFooterCompositeBarArea(e){if(this.headerFooterCompositeBarContainer)throw Error("Header or Footer composite bar already exists");return this.headerFooterCompositeBarContainer=e,this.headerFooterCompositeBarDispoables.add((0,Rt.ox)(e,Rt.tx.CONTEXT_MENU,t=>{this.onCompositeBarAreaContextMenu(new Rt.NT((0,Rt.Bx)(e),t))})),this.headerFooterCompositeBarDispoables.add(Rt.vm.addTarget(e)),this.headerFooterCompositeBarDispoables.add((0,Rt.ox)(e,Rt._m.Contextmenu,t=>{this.onCompositeBarAreaContextMenu(new Rt.NT((0,Rt.Bx)(e),t))})),e}removeFooterHeaderArea(e){this.headerFooterCompositeBarContainer=void 0,this.headerFooterCompositeBarDispoables.clear(),e?this.removeHeaderArea():this.removeFooterArea()}createCompositeBar(){return this.instantiationService.createInstance(Tt.T,this.getCompositeBarOptions(),this.partId,this)}onTitleAreaUpdate(e){super.onTitleAreaUpdate(e),this.layoutCompositeBar()}async openPaneComposite(e,t){if("string"==typeof e&&this.getPaneComposite(e)||(await this.extensionService.whenInstalledExtensionsRegistered(),"string"==typeof e&&this.getPaneComposite(e)))return this.doOpenPaneComposite(e,t)}async doOpenPaneComposite(e,t){if(this.blockOpening)return this.blockOpening.p;let i;if(!this.layoutService.isVisible(this.partId))try{i=this.blockOpening=new Rt.pw,this.layoutService.setPartHidden(!1,this.partId)}finally{this.blockOpening=void 0}try{var o;let s=this.openComposite(e,t);return null!==(o=i)&&void 0!==o&&o.complete(s),s}catch(e){var s;throw null!==(s=i)&&void 0!==s&&s.error(e),e}}getPaneComposite(e){return this.registry.getPaneComposite(e)}getPaneComposites(){return this.registry.getPaneComposites().sort((e,t)=>"number"==typeof e.order?"number"==typeof t.order?e.order-t.order:-1:1)}getPinnedPaneCompositeIds(){var e,t;return null!==(e=null===(t=this.paneCompositeBar.value)||void 0===t?void 0:t.getPinnedPaneCompositeIds())&&void 0!==e?e:[]}getVisiblePaneCompositeIds(){var e,t;return null!==(e=null===(t=this.paneCompositeBar.value)||void 0===t?void 0:t.getVisiblePaneCompositeIds())&&void 0!==e?e:[]}getPaneCompositeIds(){var e,t;return null!==(e=null===(t=this.paneCompositeBar.value)||void 0===t?void 0:t.getPaneCompositeIds())&&void 0!==e?e:[]}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.layoutService.isVisible(this.partId)&&this.layoutService.setPartHidden(!0,this.partId),this.hideActiveComposite()}focusCompositeBar(){var e;null===(e=this.paneCompositeBar.value)||void 0===e||e.focus()}layout(e,t,i,o){this.layoutService.isVisible(this.partId)&&(this.contentDimension=new Rt.Qb(e,t),super.layout(this.contentDimension.width,this.contentDimension.height,i,o),this.layoutCompositeBar(),this.layoutEmptyMessage())}layoutCompositeBar(){if(this.contentDimension&&this.dimension&&this.paneCompositeBar.value){let e=this.compositeBarPosition===ri.TITLE?16:8,t=this.partId===Nt.I.PANEL_PART?0:1,i=this.contentDimension.width-e-t;i=Math.max(si.MIN_COMPOSITE_BAR_WIDTH,i-this.getToolbarWidth()),this.paneCompositeBar.value.layout(i,this.dimension.height)}}layoutEmptyMessage(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.getActiveComposite();this.element.classList.toggle("empty",t),t&&(null===(e=this.titleLabel)||void 0===e||e.updateTitle("",""))}getToolbarWidth(){return this.toolBar&&this.compositeBarPosition===ri.TITLE&&this.getActivePaneComposite()?this.toolBar.getItemsWidth()+4*this.toolBar.getItemsLength()+(this.globalToolBar?this.globalToolBar.getItemsWidth()+4*this.globalToolBar.getItemsLength():0)+8:0}onTitleAreaContextMenu(e){if(this.shouldShowCompositeBar()&&this.getCompositeBarPosition()===ri.TITLE)return this.onCompositeBarContextMenu(e);{let t=this.getActivePaneComposite(),i=t?t.getContextMenuActions():[];i.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>i,getActionViewItem:(e,t)=>this.actionViewItemProvider(e,t),actionRunner:t.getActionRunner(),skipTelemetry:!0})}}onCompositeBarAreaContextMenu(e){return this.onCompositeBarContextMenu(e)}onCompositeBarContextMenu(e){if(this.paneCompositeBar.value){let t=[...this.paneCompositeBar.value.getContextMenuActions()];t.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>t,skipTelemetry:!0})}}getViewsSubmenuAction(){var e;let t=null===(e=this.getActivePaneComposite())||void 0===e?void 0:e.getViewPaneContainer();if(t){let e=new Rt.EA,i=e.add(this.contextKeyService.createScoped(this.element));i.createKey("viewContainer",t.viewContainer.id);let o=(0,Rt.Kr)(this.menuService.getMenuActions(Wt.I,i,{shouldForwardArgs:!0,renderShortTitle:!0}),()=>!0).primary;return e.dispose(),o.length>1&&o.some(e=>e.enabled)?new Rt.jb("views",(0,Rt.Ij)(3595,"Views"),o):void 0}}},{_:si=o},{_:o.MIN_COMPOSITE_BAR_WIDTH=50},o);li=si=(0,Rt.Pb)([(0,Rt.Fb)(9,Rt.Ld),(0,Rt.Fb)(10,Rt.Uo),(0,Rt.Fb)(11,Rt.Sl),(0,Rt.Fb)(12,Nt.Z),(0,Rt.Fb)(13,Rt.kd),(0,Rt.Fb)(14,Rt.sr),(0,Rt.Fb)(15,Rt.Ub),(0,Rt.Fb)(16,Rt.Qd),(0,Rt.Fb)(17,Wt.dx),(0,Rt.Fb)(18,Rt.yb),(0,Rt.Fb)(19,Nt.Dt),(0,Rt.Fb)(20,Rt.Zr)],li),(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Rt.Kb)(),(0,Rt.Ad)(),(0,Rt.Rd)(),(0,Rt.Wo)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.$d)(),(0,Nt.ir)(),(0,Lt.Xn)(),(0,Wt.fx)(),(0,Nt.Ot)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Rt.xl)(),(0,Rt.Mb)(),(0,Tt.it)(),(0,Rt.nM)(),(0,Rt.Yt)(),(0,Tt.nt)(),(0,Rt.wb)(),(0,Rt.zr)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.s_)(),(0,Rt.Xr)(),(0,Rt.cr)(),(0,Rt.mE)({});var ci=(s=class extends li{get preferredHeight(){return.4*this.layoutService.mainContainerDimension.height}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g){super(Nt.I.AUXILIARYBAR_PART,{hasTitle:!0,trailingSeparator:!0,borderWidth:()=>this.getColor(Lt.qt)||this.getColor(Rt._g)?1:0},di.activeViewSettingsKey,Nt.Kt.bindTo(l),Nt.ln.bindTo(l),"auxiliarybar","auxiliarybar",void 0,Lt.nn,e,t,i,o,s,r,n,a,d,l,c,u),this.commandService=h,this.configurationService=g,this.minimumWidth=170,this.maximumWidth=1/0,this.minimumHeight=0,this.maximumHeight=1/0,this.priority=Rt.Kt.Low,this.configuration=this.resolveConfiguration(),this._register(g.onDidChangeConfiguration(e=>{e.affectsConfiguration(Nt.P.ACTIVITY_BAR_LOCATION)?(this.configuration=this.resolveConfiguration(),this.onDidChangeActivityBarLocation()):e.affectsConfiguration("workbench.secondarySideBar.showLabels")&&(this.configuration=this.resolveConfiguration(),this.updateCompositeBar(!0))}))}resolveConfiguration(){let e=this.configurationService.getValue(Nt.P.ACTIVITY_BAR_LOCATION),t=e!==Nt.j.TOP&&e!==Nt.j.BOTTOM;return{position:e,canShowLabels:t,showLabels:t&&!1!==this.configurationService.getValue("workbench.secondarySideBar.showLabels")}}onDidChangeActivityBarLocation(){var e;this.updateCompositeBar();let t=null===(e=this.getActiveComposite())||void 0===e?void 0:e.getId();t&&this.onTitleAreaUpdate(t)}updateStyles(){super.updateStyles();let e=(0,Rt.$j)(this.getContainer());e.style.backgroundColor=this.getColor(Lt.Kt)||"";let t=this.getColor(Lt.qt)||this.getColor(Rt._g),i=this.layoutService.getSideBarPosition()===Nt.L.RIGHT;e.style.color=this.getColor(Lt.Yt)||"",e.style.borderLeftColor=null!==t&&void 0!==t?t:"",e.style.borderRightColor=null!==t&&void 0!==t?t:"",e.style.borderLeftStyle=t&&!i?"solid":"none",e.style.borderRightStyle=t&&i?"solid":"none",e.style.borderLeftWidth=t&&!i?"1px":"0px",e.style.borderRightWidth=t&&i?"1px":"0px"}getCompositeBarOptions(){let e=this;return{partContainerClass:"auxiliarybar",pinnedViewContainersKey:di.pinnedViewsKey,placeholderViewContainersKey:di.placeholdeViewContainersKey,viewContainersWorkspaceStateKey:di.viewContainersWorkspaceStateKey,icon:!this.configuration.showLabels,orientation:Rt.Rr.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===ri.BOTTOM?Rt._l.ABOVE:Rt._l.BELOW},fillExtraContextMenuActions:e=>this.fillExtraContextMenuActions(e),compositeSize:0,iconSize:16,get overflowActionSize(){return e.getCompositeBarPosition()===ri.TITLE?40:30},colors:t=>({activeBackgroundColor:t.getColor(Lt.Kt),inactiveBackgroundColor:t.getColor(Lt.Kt),get activeBorderBottomColor(){return e.getCompositeBarPosition()===ri.TITLE?t.getColor(Lt.kt):t.getColor(Lt.lt)},get activeForegroundColor(){return e.getCompositeBarPosition()===ri.TITLE?t.getColor(Lt.At):t.getColor(Lt.dt)},get inactiveForegroundColor(){return e.getCompositeBarPosition()===ri.TITLE?t.getColor(Lt.Pt):t.getColor(Lt.ft)},badgeBackground:t.getColor(Lt.rt),badgeForeground:t.getColor(Lt.it),get dragAndDropBorder(){return e.getCompositeBarPosition()===ri.TITLE?t.getColor(Lt.Nt):t.getColor(Lt.ut)}}),compact:!0}}fillExtraContextMenuActions(e){let t=this.layoutService.getSideBarPosition()===Nt.L.LEFT;if(this.getCompositeBarPosition()===ri.TITLE){let t=this.getViewsSubmenuAction();t&&(e.push(new Rt.Ab),e.push(t))}let i=(0,Rt.qr)(this.menuService.getMenuActions(Rt.sb.ActivityBarPositionMenu,this.contextKeyService,{shouldForwardArgs:!0,renderShortTitle:!0})).secondary,o=(0,Rt.Nb)({id:"workbench.action.auxiliarybar.toggleShowLabels",label:this.configuration.showLabels?(0,Rt.Ij)(3026,"Show Icons"):(0,Rt.Ij)(3027,"Show Labels"),enabled:this.configuration.canShowLabels,run:()=>this.configurationService.updateValue("workbench.secondarySideBar.showLabels",!this.configuration.showLabels)});e.push(new Rt.Ab,new Rt.jb("workbench.action.panel.position",(0,Rt.Ij)(3028,"Activity Bar Position"),i),(0,Rt.Nb)({id:Tt.Z.ID,label:t?(0,Rt.Ij)(3029,"Move Secondary Side Bar Left"):(0,Rt.Ij)(3030,"Move Secondary Side Bar Right"),run:()=>this.commandService.executeCommand(Tt.Z.ID)}),o,(0,Rt.Nb)({id:Tt.rt.ID,label:(0,Rt.Ij)(3031,"Hide Secondary Side Bar"),run:()=>this.commandService.executeCommand(Tt.rt.ID)}))}shouldShowCompositeBar(){return this.configuration.position!==Nt.j.HIDDEN}getCompositeBarPosition(){switch(this.configuration.position){case Nt.j.TOP:return ri.TOP;case Nt.j.BOTTOM:return ri.BOTTOM;case Nt.j.HIDDEN:case Nt.j.DEFAULT:default:return ri.TITLE}}toJSON(){return{type:Nt.I.AUXILIARYBAR_PART}}},{_:di=s},{_:s.activeViewSettingsKey="workbench.auxiliarybar.activepanelid"},{_:s.pinnedViewsKey="workbench.auxiliarybar.pinnedPanels"},{_:s.placeholdeViewContainersKey="workbench.auxiliarybar.placeholderPanels"},{_:s.viewContainersWorkspaceStateKey="workbench.auxiliarybar.viewContainersWorkspaceState"},s);ci=di=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ld),(0,Rt.Fb)(1,Rt.Uo),(0,Rt.Fb)(2,Rt.Sl),(0,Rt.Fb)(3,Nt.Z),(0,Rt.Fb)(4,Rt.kd),(0,Rt.Fb)(5,Rt.sr),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.Qd),(0,Rt.Fb)(8,Wt.dx),(0,Rt.Fb)(9,Rt.yb),(0,Rt.Fb)(10,Nt.Dt),(0,Rt.Fb)(11,Rt.Cb),(0,Rt.Fb)(12,Rt.Zr),(0,Rt.Fb)(13,Rt.o_)],ci);var hi={};(0,Rt.fE)(),(0,Rt.qx)(),(0,Rt.en)(),(0,Rt.Yt)(),(0,Rt.WM)(),(0,Rt.Ev)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.IC)(),(0,Rt.nM)(),(0,Rt.mE)(hi);var ui={separatorBorder:Rt.Sv.transparent};function gi(e){return e===Rt.Xt.VERTICAL?Rt.Xt.HORIZONTAL:Rt.Xt.VERTICAL}var pi=class{constructor(e){this.isLayoutEnabled=e}};function bi(e,t){if(Math.abs(e)>t)throw Error("Invalid index");return(0,Rt.LC)(e,t+1)}var mi=class e{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get absoluteOffset(){return this._absoluteOffset}get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}get styles(){return this._styles}get width(){return this.orientation===Rt.Xt.HORIZONTAL?this.size:this.orthogonalSize}get height(){return this.orientation===Rt.Xt.HORIZONTAL?this.orthogonalSize:this.size}get top(){return this.orientation===Rt.Xt.HORIZONTAL?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return this.orientation===Rt.Xt.HORIZONTAL?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return 0===this.children.length?0:Math.max(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.minimumOrthogonalSize:0))}get maximumSize(){return Math.min(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.maximumOrthogonalSize:1/0))}get priority(){if(0===this.children.length)return Rt.Kt.Normal;let e=this.children.map(e=>void 0===e.priority?Rt.Kt.Normal:e.priority);return e.some(e=>e===Rt.Kt.High)?Rt.Kt.High:e.some(e=>e===Rt.Kt.Low)?Rt.Kt.Low:Rt.Kt.Normal}get proportionalLayout(){return 0===this.children.length||this.children.every(e=>e.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return this.orientation===Rt.Xt.HORIZONTAL?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===Rt.Xt.HORIZONTAL?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===Rt.Xt.HORIZONTAL?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===Rt.Xt.HORIZONTAL?this.maximumSize:this.maximumOrthogonalSize}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){if(this._boundarySashes.start!==e.start||this._boundarySashes.end!==e.end||this._boundarySashes.orthogonalStart!==e.orthogonalStart||this._boundarySashes.orthogonalEnd!==e.orthogonalEnd){this._boundarySashes=e,this.splitview.orthogonalStartSash=e.orthogonalStart,this.splitview.orthogonalEndSash=e.orthogonalEnd;for(let t=0;t<this.children.length;t++){let i=this.children[t],o=0===t,s=t===this.children.length-1;i.boundarySashes={start:e.orthogonalStart,end:e.orthogonalEnd,orthogonalStart:o?e.start:i.boundarySashes.orthogonalStart,orthogonalEnd:s?e.end:i.boundarySashes.orthogonalEnd}}}}get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(t){if(this._edgeSnapping!==t){this._edgeSnapping=t;for(let i of this.children)i instanceof e&&(i.edgeSnapping=t);this.updateSplitviewEdgeSnappingEnablement()}}constructor(e,t,i,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,n=arguments.length>7?arguments[7]:void 0;if(this.orientation=e,this.layoutController=t,this.splitviewProportionalLayout=o,this.children=[],this._absoluteOffset=0,this._absoluteOrthogonalOffset=0,this.absoluteOrthogonalSize=0,this._onDidChange=new Rt.uA,this.onDidChange=this._onDidChange.event,this._onDidVisibilityChange=new Rt.uA,this.onDidVisibilityChange=this._onDidVisibilityChange.event,this.childrenVisibilityChangeDisposable=new Rt.EA,this._onDidScroll=new Rt.uA,this.onDidScrollDisposable=Rt.CA.None,this.onDidScroll=this._onDidScroll.event,this.childrenChangeDisposable=Rt.CA.None,this._onDidSashReset=new Rt.uA,this.onDidSashReset=this._onDidSashReset.event,this.splitviewSashResetDisposable=Rt.CA.None,this.childrenSashResetDisposable=Rt.CA.None,this._boundarySashes={},this._edgeSnapping=!1,this._styles=i,this._size=s,this._orthogonalSize=r,this.element=(0,Rt.Zb)(".monaco-grid-branch-node"),n){let t={views:n.map(e=>({view:e.node,size:e.node.size,visible:!1!==e.visible})),size:this.orthogonalSize},s={proportionalLayout:o,orientation:e,styles:i};this.children=n.map(e=>e.node),this.splitview=new Rt.Jt(this.element,(0,xt.A)((0,xt.A)({},s),{},{descriptor:t})),this.children.forEach((e,t)=>{let i=0===t,o=t===this.children.length;e.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:i?this.boundarySashes.start:this.splitview.sashes[t-1],orthogonalEnd:o?this.boundarySashes.end:this.splitview.sashes[t]}})}else this.splitview=new Rt.Jt(this.element,{orientation:e,styles:i,proportionalLayout:o}),this.splitview.layout(s,{orthogonalSize:r,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:s,absoluteOrthogonalSize:r});this.splitviewSashResetDisposable=Rt.dA.map(this.splitview.onDidSashReset,e=>[e])(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}style(t){this._styles=t,this.splitview.style(t);for(let i of this.children)i instanceof e&&i.style(t)}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(void 0===i)throw Error("Invalid state");this._size=i.orthogonalSize,this._orthogonalSize=e,this._absoluteOffset=i.absoluteOffset+t,this._absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=i.absoluteOrthogonalSize,this.splitview.layout(i.orthogonalSize,{orthogonalSize:e,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:i.absoluteOrthogonalSize,absoluteOrthogonalSize:i.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(e){for(let t of this.children)t.setVisible(e)}addChild(e,t,i,o){i=bi(i,this.children.length),this.splitview.addView(e,t,i,o),this.children.splice(i,0,e),this.updateBoundarySashes(),this.onDidChildrenChange()}removeChild(e,t){e=bi(e,this.children.length);let i=this.splitview.removeView(e,t);return this.children.splice(e,1),this.updateBoundarySashes(),this.onDidChildrenChange(),i}removeAllChildren(){let e=this.splitview.removeAllViews();return this.children.splice(0,this.children.length),this.updateBoundarySashes(),this.onDidChildrenChange(),e}moveChild(e,t){(e=bi(e,this.children.length))!==(t=bi(t,this.children.length))&&(e<t&&--t,this.splitview.moveView(e,t),this.children.splice(t,0,this.children.splice(e,1)[0]),this.updateBoundarySashes(),this.onDidChildrenChange())}swapChildren(e,t){(e=bi(e,this.children.length))!==(t=bi(t,this.children.length))&&(this.splitview.swapViews(e,t),[this.children[e].boundarySashes,this.children[t].boundarySashes]=[this.children[e].boundarySashes,this.children[t].boundarySashes],[this.children[e],this.children[t]]=[this.children[t],this.children[e]],this.onDidChildrenChange())}resizeChild(e,t){e=bi(e,this.children.length),this.splitview.resizeView(e,t)}isChildExpanded(e){return this.splitview.isViewExpanded(e)}distributeViewSizes(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.splitview.distributeViewSizes(),t)for(let i of this.children)i instanceof e&&i.distributeViewSizes(!0)}getChildSize(e){return e=bi(e,this.children.length),this.splitview.getViewSize(e)}isChildVisible(e){return e=bi(e,this.children.length),this.splitview.isViewVisible(e)}setChildVisible(e,t){if(e=bi(e,this.children.length),this.splitview.isViewVisible(e)===t)return;let i=0===this.splitview.contentSize;this.splitview.setViewVisible(e,t);let o=0===this.splitview.contentSize;(t&&i||!t&&o)&&this._onDidVisibilityChange.fire(t)}getChildCachedVisibleSize(e){return e=bi(e,this.children.length),this.splitview.getViewCachedVisibleSize(e)}updateBoundarySashes(){for(let e=0;e<this.children.length;e++)this.children[e].boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:0===e?this.boundarySashes.start:this.splitview.sashes[e-1],orthogonalEnd:e===this.children.length-1?this.boundarySashes.end:this.splitview.sashes[e]}}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){let t=Rt.dA.map(Rt.dA.any(...this.children.map(e=>e.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=t(this._onDidChange.fire,this._onDidChange);let i=Rt.dA.any(...this.children.map((e,t)=>Rt.dA.map(e.onDidSashReset,e=>[t,...e])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=i(this._onDidSashReset.fire,this._onDidSashReset);let o=Rt.dA.any(Rt.dA.signal(this.splitview.onDidScroll),...this.children.map(e=>e.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=o(this._onDidScroll.fire,this._onDidScroll),this.childrenVisibilityChangeDisposable.clear(),this.children.forEach((t,i)=>{t instanceof e&&this.childrenVisibilityChangeDisposable.add(t.onDidVisibilityChange(e=>{this.setChildVisible(i,e)}))})}trySet2x2(e){if(2!==this.children.length||2!==e.children.length||this.getChildSize(0)!==e.getChildSize(0))return Rt.CA.None;let[t,i]=this.children,[o,s]=e.children;if(!(t instanceof vi)||!(i instanceof vi)||!(o instanceof vi)||!(s instanceof vi))return Rt.CA.None;this.orientation===Rt.Xt.VERTICAL?(i.linkedWidthNode=o.linkedHeightNode=t,t.linkedWidthNode=s.linkedHeightNode=i,s.linkedWidthNode=t.linkedHeightNode=o,o.linkedWidthNode=i.linkedHeightNode=s):(o.linkedWidthNode=i.linkedHeightNode=t,s.linkedWidthNode=t.linkedHeightNode=i,t.linkedWidthNode=s.linkedHeightNode=o,i.linkedWidthNode=o.linkedHeightNode=s);let r=this.splitview.sashes[0],n=e.splitview.sashes[0];return r.linkedSash=n,n.linkedSash=r,this._onDidChange.fire(void 0),e._onDidChange.fire(void 0),(0,Rt.zA)(()=>{r.linkedSash=n.linkedSash=void 0,t.linkedHeightNode=t.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,o.linkedHeightNode=o.linkedWidthNode=void 0,s.linkedHeightNode=s.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(let e of this.children)e.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this._onDidVisibilityChange.dispose(),this.childrenVisibilityChangeDisposable.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.onDidScrollDisposable.dispose(),this.splitview.dispose()}};var vi=class{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(e){this._onDidLinkedWidthNodeChange.input=e?e._onDidViewChange:Rt.dA.None,this._linkedWidthNode=e,this._onDidSetLinkedNode.fire(void 0)}get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(e){this._onDidLinkedHeightNodeChange.input=e?e._onDidViewChange:Rt.dA.None,this._linkedHeightNode=e,this._onDidSetLinkedNode.fire(void 0)}constructor(e,t,i,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.view=e,this.orientation=t,this.layoutController=i,this._size=0,this.absoluteOffset=0,this.absoluteOrthogonalOffset=0,this.onDidScroll=Rt.dA.None,this.onDidSashReset=Rt.dA.None,this._onDidLinkedWidthNodeChange=new Rt.pA,this._linkedWidthNode=void 0,this._onDidLinkedHeightNodeChange=new Rt.pA,this._linkedHeightNode=void 0,this._onDidSetLinkedNode=new Rt.uA,this.disposables=new Rt.EA,this._boundarySashes={},this.cachedWidth=0,this.cachedHeight=0,this.cachedTop=0,this.cachedLeft=0,this._orthogonalSize=o,this._size=s;let r=function(e){let[t,i]=Rt.dA.split(e.onDidChange,Rt.fM);return Rt.dA.any(i,Rt.dA.map(Rt.dA.latch(Rt.dA.map(t,t=>[e.minimumWidth,e.maximumWidth,e.minimumHeight,e.maximumHeight]),Rt.RM),e=>{}))}(e);this._onDidViewChange=Rt.dA.map(r,e=>e&&(this.orientation===Rt.Xt.VERTICAL?e.width:e.height),this.disposables),this.onDidChange=Rt.dA.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}get width(){return this.orientation===Rt.Xt.HORIZONTAL?this.orthogonalSize:this.size}get height(){return this.orientation===Rt.Xt.HORIZONTAL?this.size:this.orthogonalSize}get top(){return this.orientation===Rt.Xt.HORIZONTAL?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return this.orientation===Rt.Xt.HORIZONTAL?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return this.orientation===Rt.Xt.HORIZONTAL?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===Rt.Xt.HORIZONTAL?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){var e;return null===(e=this.view.proportionalLayout)||void 0===e||e}get snap(){return this.view.snap}get minimumOrthogonalSize(){return this.orientation===Rt.Xt.HORIZONTAL?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===Rt.Xt.HORIZONTAL?this.maximumWidth:this.maximumHeight}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){var t,i;this._boundarySashes=e,null===(t=(i=this.view).setBoundarySashes)||void 0===t||t.call(i,function(e,t){return t===Rt.Xt.HORIZONTAL?{left:e.start,right:e.end,top:e.orthogonalStart,bottom:e.orthogonalEnd}:{top:e.start,bottom:e.end,left:e.orthogonalStart,right:e.orthogonalEnd}}(e,this.orientation))}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(void 0===i)throw Error("Invalid state");this._size=e,this._orthogonalSize=i.orthogonalSize,this.absoluteOffset=i.absoluteOffset+t,this.absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}_layout(e,t,i,o){this.cachedWidth===e&&this.cachedHeight===t&&this.cachedTop===i&&this.cachedLeft===o||(this.cachedWidth=e,this.cachedHeight=t,this.cachedTop=i,this.cachedLeft=o,this.view.layout(e,t,i,o))}setVisible(e){var t,i;null===(t=(i=this.view).setVisible)||void 0===t||t.call(i,e)}dispose(){this.disposables.dispose()}};function Ci(e,t,i){if(e instanceof mi){let o=new mi(gi(e.orientation),e.layoutController,e.styles,e.splitviewProportionalLayout,t,i,e.edgeSnapping),s=0;for(let r=e.children.length-1;r>=0;r--){let n=e.children[r],a=n instanceof mi?n.orthogonalSize:n.size,d=0===e.size?0:Math.round(t*a/e.size);s+=d,0===r&&(d+=t-s),o.addChild(Ci(n,i,d),d,0,!0)}return e.dispose(),o}{let t=new vi(e.view,gi(e.orientation),e.layoutController,i);return e.dispose(),t}}var wi,yi,fi=class e{get root(){return this._root}set root(e){let t=this._root;t&&(t.element.remove(),t.dispose()),this._root=e,this.element.appendChild(e.element),this.onDidSashResetRelay.input=e.onDidSashReset,this._onDidChange.input=Rt.dA.map(e.onDidChange,()=>{}),this._onDidScroll.input=e.onDidScroll}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(e){if(this._root.orientation===e)return;let{size:t,orthogonalSize:i,absoluteOffset:o,absoluteOrthogonalOffset:s}=this._root;this.root=Ci(this._root,i,t),this.root.layout(t,0,{orthogonalSize:i,absoluteOffset:s,absoluteOrthogonalOffset:o,absoluteSize:t,absoluteOrthogonalSize:i}),this.boundarySashes=this.boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.root.boundarySashes=function(e,t){return t===Rt.Xt.HORIZONTAL?{start:e.left,end:e.right,orthogonalStart:e.top,orthogonalEnd:e.bottom}:{start:e.top,end:e.bottom,orthogonalStart:e.left,orthogonalEnd:e.right}}(e,this.orientation)}set edgeSnapping(e){this.root.edgeSnapping=e}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.onDidSashResetRelay=new Rt.pA,this._onDidScroll=new Rt.pA,this._onDidChange=new Rt.pA,this._boundarySashes={},this.disposable2x2=Rt.CA.None,this.onDidSashReset=this.onDidSashResetRelay.event,this.onDidScroll=this._onDidScroll.event,this.onDidChange=this._onDidChange.event,this.maximizedNode=void 0,this._onDidChangeViewMaximized=new Rt.uA,this.onDidChangeViewMaximized=this._onDidChangeViewMaximized.event,this.element=(0,Rt.Zb)(".monaco-grid-view"),this.styles=e.styles||ui,this.proportionalLayout=void 0===e.proportionalLayout||!!e.proportionalLayout,this.layoutController=new pi(!1),this.root=new mi(Rt.Xt.VERTICAL,this.layoutController,this.styles,this.proportionalLayout)}style(e){this.styles=e,this.root.style(e)}layout(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.layoutController.isLayoutEnabled=!0;let[s,r,n,a]=this.root.orientation===Rt.Xt.HORIZONTAL?[t,e,i,o]:[e,t,o,i];this.root.layout(s,0,{orthogonalSize:r,absoluteOffset:n,absoluteOrthogonalOffset:a,absoluteSize:s,absoluteOrthogonalSize:r})}addView(e,t,i){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=Rt.CA.None;let[o,s]=(0,Rt.sN)(i),[r,n]=this.getNode(o);if(n instanceof mi){let i=new vi(e,gi(n.orientation),this.layoutController,n.orthogonalSize);try{n.addChild(i,t,s)}catch(e){throw i.dispose(),e}}else{let[,i]=(0,Rt.sN)(r),[,a]=(0,Rt.sN)(o),d=0,l=i.getChildCachedVisibleSize(a);"number"==typeof l&&(d=Rt.qt.Invisible(l)),i.removeChild(a).dispose();let c=new mi(n.orientation,n.layoutController,this.styles,this.proportionalLayout,n.size,n.orthogonalSize,i.edgeSnapping);i.addChild(c,n.size,a);let h=new vi(n.view,i.orientation,this.layoutController,n.size);c.addChild(h,d,0),"number"!=typeof t&&"split"===t.type&&(t=Rt.qt.Split(0));let u=new vi(e,i.orientation,this.layoutController,n.size);c.addChild(u,t,s)}this.trySet2x2()}removeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=Rt.CA.None;let[i,o]=(0,Rt.sN)(e),[s,r]=this.getNode(i);if(!(r instanceof mi))throw Error("Invalid location");let n=r.children[o];if(!(n instanceof vi))throw Error("Invalid location");if(r.removeChild(o,t),n.dispose(),0===r.children.length)throw Error("Invalid grid state");if(r.children.length>1)return this.trySet2x2(),n.view;if(0===s.length){let e=r.children[0];return e instanceof vi||(r.removeChild(0),r.dispose(),this.root=e,this.boundarySashes=this.boundarySashes,this.trySet2x2()),n.view}let[,a]=(0,Rt.sN)(s),[,d]=(0,Rt.sN)(i),l=r.isChildVisible(0),c=r.removeChild(0),h=a.children.map((e,t)=>a.getChildSize(t));if(a.removeChild(d,t),r.dispose(),c instanceof mi){h.splice(d,1,...c.children.map(e=>e.size));let e=c.removeAllChildren();for(let t=0;t<e.length;t++)a.addChild(e[t],e[t].size,d+t)}else{let e=new vi(c.view,gi(c.orientation),this.layoutController,c.size),t=l?c.orthogonalSize:Rt.qt.Invisible(c.orthogonalSize);a.addChild(e,t,d)}c.dispose();for(let u=0;u<h.length;u++)a.resizeChild(u,h[u]);return this.trySet2x2(),n.view}moveView(e,t,i){this.hasMaximizedView()&&this.exitMaximizedView();let[,o]=this.getNode(e);if(!(o instanceof mi))throw Error("Invalid location");o.moveChild(t,i),this.trySet2x2()}swapViews(e,t){this.hasMaximizedView()&&this.exitMaximizedView();let[i,o]=(0,Rt.sN)(e),[,s]=this.getNode(i);if(!(s instanceof mi))throw Error("Invalid from location");let r=s.getChildSize(o),n=s.children[o];if(!(n instanceof vi))throw Error("Invalid from location");let[a,d]=(0,Rt.sN)(t),[,l]=this.getNode(a);if(!(l instanceof mi))throw Error("Invalid to location");let c=l.getChildSize(d),h=l.children[d];if(!(h instanceof vi))throw Error("Invalid to location");s===l?s.swapChildren(o,d):(s.removeChild(o),l.removeChild(d),s.addChild(h,r,o),l.addChild(n,c,d)),this.trySet2x2()}resizeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView();let[i,o]=(0,Rt.sN)(e),[s,r]=this.getNode(i);if(!(r instanceof mi))throw Error("Invalid location");if(!t.width&&!t.height)return;let[n,a]=r.orientation===Rt.Xt.HORIZONTAL?[t.width,t.height]:[t.height,t.width];if("number"==typeof a&&s.length>0){let[,e]=(0,Rt.sN)(s),[,t]=(0,Rt.sN)(i);e.resizeChild(t,a)}"number"==typeof n&&r.resizeChild(o,n),this.trySet2x2()}getViewSize(e){if(!e)return{width:this.root.width,height:this.root.height};let[,t]=this.getNode(e);return{width:t.width,height:t.height}}getViewCachedVisibleSize(e){let[t,i]=(0,Rt.sN)(e),[,o]=this.getNode(t);if(!(o instanceof mi))throw Error("Invalid location");return o.getChildCachedVisibleSize(i)}expandView(e){this.hasMaximizedView()&&this.exitMaximizedView();let[t,i]=this.getNode(e);if(!(i instanceof vi))throw Error("Invalid location");for(let o=0;o<t.length;o++)t[o].resizeChild(e[o],1/0)}isViewExpanded(e){if(this.hasMaximizedView())return!1;let[t,i]=this.getNode(e);if(!(i instanceof vi))throw Error("Invalid location");for(let o=0;o<t.length;o++)if(!t[o].isChildExpanded(e[o]))return!1;return!0}maximizeView(e){let[,t]=this.getNode(e);if(!(t instanceof vi))throw Error("Location is not a LeafNode");this.maximizedNode!==t&&(this.hasMaximizedView()&&this.exitMaximizedView(),function e(t,i){for(let o=0;o<t.children.length;o++){let s=t.children[o];s instanceof vi?s!==i&&t.setChildVisible(o,!1):e(s,i)}}(this.root,t),this.maximizedNode=t,this._onDidChangeViewMaximized.fire(!0))}exitMaximizedView(){this.maximizedNode&&(this.maximizedNode=void 0,function e(t){for(let i=t.children.length-1;i>=0;i--){let o=t.children[i];o instanceof vi?t.setChildVisible(i,!0):e(o)}}(this.root),this._onDidChangeViewMaximized.fire(!1))}hasMaximizedView(){return void 0!==this.maximizedNode}isViewMaximized(e){let[,t]=this.getNode(e);if(!(t instanceof vi))throw Error("Location is not a LeafNode");return t===this.maximizedNode}distributeViewSizes(e){if(this.hasMaximizedView()&&this.exitMaximizedView(),!e)return void this.root.distributeViewSizes(!0);let[,t]=this.getNode(e);if(!(t instanceof mi))throw Error("Invalid location");t.distributeViewSizes(),this.trySet2x2()}isViewVisible(e){let[t,i]=(0,Rt.sN)(e),[,o]=this.getNode(t);if(!(o instanceof mi))throw Error("Invalid from location");return o.isChildVisible(i)}setViewVisible(e,t){if(this.hasMaximizedView())return void this.exitMaximizedView();let[i,o]=(0,Rt.sN)(e),[,s]=this.getNode(i);if(!(s instanceof mi))throw Error("Invalid from location");s.setChildVisible(o,t)}getView(e){let t=e?this.getNode(e)[1]:this._root;return this._getViews(t,this.orientation)}static deserialize(t,i){var o;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("number"!=typeof t.orientation)throw Error("Invalid JSON: 'orientation' property must be a number.");if("number"!=typeof t.width)throw Error("Invalid JSON: 'width' property must be a number.");if("number"!=typeof t.height)throw Error("Invalid JSON: 'height' property must be a number.");if("branch"!==(null===(o=t.root)||void 0===o?void 0:o.type))throw Error("Invalid JSON: 'root' property must have 'type' value of branch.");let r=t.orientation,n=t.height,a=new e(s);return a._deserialize(t.root,r,i,n),a}_deserialize(e,t,i,o){this.root=this._deserializeNode(e,t,i,o)}_deserializeNode(e,t,i,o){let s;if("branch"===e.type){let r=e.data.map(o=>({node:this._deserializeNode(o,gi(t),i,e.size),visible:o.visible}));s=new mi(t,this.layoutController,this.styles,this.proportionalLayout,e.size,o,void 0,r)}else s=new vi(i.fromJSON(e.data),t,this.layoutController,o,e.size),e.maximized&&!this.maximizedNode&&(this.maximizedNode=s,this._onDidChangeViewMaximized.fire(!0));return s}_getViews(e,t,i){let o={top:e.top,left:e.left,width:e.width,height:e.height};if(e instanceof vi)return{view:e.view,box:o,cachedVisibleSize:i,maximized:this.maximizedNode===e};let s=[];for(let r=0;r<e.children.length;r++){let i=e.children[r],o=e.getChildCachedVisibleSize(r);s.push(this._getViews(i,gi(t),o))}return{children:s,box:o}}getNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===e.length)return[i,t];if(!(t instanceof mi))throw Error("Invalid location");let[o,...s]=e;if(o<0||o>=t.children.length)throw Error("Invalid location");let r=t.children[o];return i.push(t),this.getNode(s,r,i)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=Rt.CA.None,2!==this.root.children.length)return;let[e,t]=this.root.children;!(e instanceof mi)||!(t instanceof mi)||(this.disposable2x2=e.trySet2x2(t))}getViewMap(e,t){t||(t=this.root),t instanceof mi?t.children.forEach(t=>this.getViewMap(e,t)):e.set(t.view,t.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element.remove()}};function Si(e){return!!e.children}function Ii(e,t){if(0===t.length)return e;if(!Si(e))throw Error("Invalid location");let[i,...o]=t;return Ii(e.children[i],o)}function ki(e,t){let i=Ei(t);return{offset:t===wi.Up?e.top:t===wi.Right?e.left+e.width:t===wi.Down?e.top+e.height:e.left,range:{start:i===Rt.Xt.HORIZONTAL?e.top:e.left,end:i===Rt.Xt.HORIZONTAL?e.top+e.height:e.left+e.width}}}function _i(e,t){return t.length%2==0?gi(e):e}function Ei(e){return e===wi.Up||e===wi.Down?Rt.Xt.VERTICAL:Rt.Xt.HORIZONTAL}function Ai(e,t,i){if(_i(e,t)===Ei(i)){let[e,o]=(0,Rt.sN)(t);return(i===wi.Right||i===wi.Down)&&(o+=1),[...e,o]}{let e=i===wi.Right||i===wi.Down?1:0;return[...t,e]}}function Di(e){let t=e.parentElement;if(!t)throw Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(t.className))return[];let i=function(e){let t=e.parentElement;if(!t)throw Error("Invalid grid element");let i=t.firstElementChild,o=0;for(;i!==e&&i!==t.lastElementChild&&i;)i=i.nextElementSibling,o++;return o}(t);return[...Di(t.parentElement.parentElement.parentElement.parentElement),i]}(0,Rt.fE)(),(0,Rt.en)(),(0,Rt.WM)(),(0,Rt.PA)(),(0,Rt.Yt)(),(0,Rt.mE)(hi),function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(wi||(wi={})),function(e){e.Distribute={type:"distribute"},e.Split={type:"split"},e.Auto={type:"auto"},e.Invisible=function(e){return{type:"invisible",cachedVisibleSize:e}}}(yi||(yi={}));var xi=class extends Rt.CA{get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(e){this.gridview.boundarySashes=e}set edgeSnapping(e){this.gridview.edgeSnapping=e}get element(){return this.gridview.element}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.views=new Map,this.didLayout=!1,e instanceof fi?(this.gridview=e,this.gridview.getViewMap(this.views)):this.gridview=new fi(t),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),e instanceof fi||this._addView(e,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll,this.onDidChangeViewMaximized=this.gridview.onDidChangeViewMaximized}style(e){this.gridview.style(e)}layout(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.gridview.layout(e,t,i,o),this.didLayout=!0}addView(e,t,i,o){if(this.views.has(e))throw Error("Can't add same view twice");let s=Ei(o);1===this.views.size&&this.orientation!==s&&(this.orientation=s);let r,n=this.getViewLocation(i),a=Ai(this.gridview.orientation,n,o);if("number"==typeof t)r=t;else if("split"===t.type){let[,e]=(0,Rt.sN)(n);r=Rt.qt.Split(e)}else if("distribute"===t.type)r=Rt.qt.Distribute;else if("auto"===t.type){let[,e]=(0,Rt.sN)(n);r=Rt.qt.Auto(e)}else r=t;this._addView(e,r,a)}addViewAt(e,t,i){if(this.views.has(e))throw Error("Can't add same view twice");let o;o="number"==typeof t?t:"distribute"===t.type?Rt.qt.Distribute:t,this._addView(e,o,i)}_addView(e,t,i){this.views.set(e,e.element),this.gridview.addView(e,t,i)}removeView(e,t){if(1===this.views.size)throw Error("Can't remove last view");let i,o=this.getViewLocation(e);if("distribute"===(null===t||void 0===t?void 0:t.type))i=Rt.qt.Distribute;else if("auto"===(null===t||void 0===t?void 0:t.type)){let e=o[o.length-1];i=Rt.qt.Auto(0===e?1:e-1)}this.gridview.removeView(o,i),this.views.delete(e)}moveView(e,t,i,o){let[s,r]=(0,Rt.sN)(this.getViewLocation(e)),n=this.getViewLocation(i),[a,d]=(0,Rt.sN)(Ai(this.gridview.orientation,n,o));(0,Rt.RM)(s,a)?this.gridview.moveView(s,r,d):(this.removeView(e,"number"==typeof t?void 0:t),this.addView(e,t,i,o))}moveViewTo(e,t){let i=this.getViewLocation(e),[o,s]=(0,Rt.sN)(i),[r,n]=(0,Rt.sN)(t);if((0,Rt.RM)(o,r))this.gridview.moveView(o,s,n);else{let o=this.getViewSize(e),s=_i(this.gridview.orientation,i),r=this.getViewCachedVisibleSize(e),n=void 0===r?s===Rt.Xt.HORIZONTAL?o.width:o.height:yi.Invisible(r);this.removeView(e),this.addViewAt(e,n,t)}}swapViews(e,t){let i=this.getViewLocation(e),o=this.getViewLocation(t);return this.gridview.swapViews(i,o)}resizeView(e,t){let i=this.getViewLocation(e);return this.gridview.resizeView(i,t)}isViewExpanded(e){let t=this.getViewLocation(e);return this.gridview.isViewExpanded(t)}isViewMaximized(e){let t=this.getViewLocation(e);return this.gridview.isViewMaximized(t)}hasMaximizedView(){return this.gridview.hasMaximizedView()}getViewSize(e){if(!e)return this.gridview.getViewSize();let t=this.getViewLocation(e);return this.gridview.getViewSize(t)}getViewCachedVisibleSize(e){let t=this.getViewLocation(e);return this.gridview.getViewCachedVisibleSize(t)}maximizeView(e){if(this.views.size<2)throw Error("At least two views are required to maximize a view");let t=this.getViewLocation(e);this.gridview.maximizeView(t)}exitMaximizedView(){this.gridview.exitMaximizedView()}expandView(e){let t=this.getViewLocation(e);this.gridview.expandView(t)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(e){let t=this.getViewLocation(e);return this.gridview.isViewVisible(t)}setViewVisible(e,t){let i=this.getViewLocation(e);this.gridview.setViewVisible(i,t)}getViews(){return this.gridview.getView()}getNeighborViews(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.didLayout)throw Error("Can't call getNeighborViews before first layout");let o=this.getViewLocation(e),s=this.getViews(),r=Ii(s,o),n=ki(r.box,t);return i&&(t===wi.Up&&0===r.box.top?n={offset:s.box.top+s.box.height,range:n.range}:t===wi.Right&&r.box.left+r.box.width===s.box.width||t===wi.Down&&r.box.top+r.box.height===s.box.height?n={offset:0,range:n.range}:t===wi.Left&&0===r.box.left&&(n={offset:s.box.left+s.box.width,range:n.range})),function(e,t,i){let o=[];return function e(t,i,s){if(Si(t))for(let o of t.children)e(o,i,s);else{let{offset:e,range:r}=ki(t.box,i);e===s.offset&&function(e,t){return!(e.start>=t.end||t.start>=e.end)}(r,s.range)&&o.push(t)}}(e,t,i),o}(s,function(e){switch(e){case wi.Up:return wi.Down;case wi.Down:return wi.Up;case wi.Left:return wi.Right;case wi.Right:return wi.Left}}(t),n).map(e=>e.view)}getViewLocation(e){let t=this.views.get(e);if(!t)throw Error("View not found");return Di(t)}onDidSashReset(e){let t=e=>{let t=this.gridview.getView(e);if(Si(t))return!1;let i=_i(this.orientation,e),o=i===Rt.Xt.HORIZONTAL?t.view.preferredWidth:t.view.preferredHeight;if("number"!=typeof o)return!1;let s=i===Rt.Xt.HORIZONTAL?{width:Math.round(o)}:{height:Math.round(o)};return this.gridview.resizeView(e,s),!0};if(t(e))return;let[i,o]=(0,Rt.sN)(e);t([...i,o+1])||this.gridview.distributeViewSizes(i)}},Vi=class e extends xi{constructor(){super(...arguments),this.initialLayoutContext=!0}static serializeNode(t,i){let o=i===Rt.Xt.VERTICAL?t.box.width:t.box.height;if(!Si(t)){let e={type:"leaf",data:t.view.toJSON(),size:o};return"number"==typeof t.cachedVisibleSize?(e.size=t.cachedVisibleSize,e.visible=!1):t.maximized&&(e.maximized=!0),e}let s=t.children.map(t=>e.serializeNode(t,gi(i)));return s.some(e=>!1!==e.visible)?{type:"branch",data:s,size:o}:{type:"branch",data:s,size:o,visible:!1}}static deserialize(t,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("number"!=typeof t.orientation)throw Error("Invalid JSON: 'orientation' property must be a number.");if("number"!=typeof t.width)throw Error("Invalid JSON: 'width' property must be a number.");if("number"!=typeof t.height)throw Error("Invalid JSON: 'height' property must be a number.");return new e(fi.deserialize(t,i,o),o)}static from(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.deserialize(Fi(t),{fromJSON:e=>e},i)}serialize(){return{root:e.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super.layout(e,t,i,o),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}};function Ri(e){return!!e.groups}function Ti(e,t){if(!t&&e.groups&&e.groups.length<=1&&(e.groups=void 0),!Ri(e))return;let i=0,o=0;for(let r of e.groups)Ti(r,!1),r.size&&(i+=r.size,o++);let s=(o>0?i:1)/(e.groups.length-o);for(let r of e.groups)r.size||(r.size=s)}function Li(e){return Ri(e)?{type:"branch",data:e.groups.map(e=>Li(e)),size:e.size}:{type:"leaf",data:e.data,size:e.size}}function Wi(e,t){if("branch"===e.type){let i=e.data.map(e=>Wi(e,gi(t)));return t===Rt.Xt.VERTICAL?{width:e.size||(0===i.length?void 0:Math.max(...i.map(e=>e.width||0))),height:0===i.length?void 0:i.reduce((e,t)=>e+(t.height||0),0)}:{width:0===i.length?void 0:i.reduce((e,t)=>e+(t.width||0),0),height:e.size||(0===i.length?void 0:Math.max(...i.map(e=>e.height||0)))}}return{width:t===Rt.Xt.VERTICAL?e.size:void 0,height:t===Rt.Xt.VERTICAL?void 0:e.size}}function Fi(e){Ti(e,!0);let t=Li(e),{width:i,height:o}=Wi(t,e.orientation);return{root:t,orientation:e.orientation,width:i||1,height:o||1}}(0,Rt.qx)(),(0,Rt.Wi)(),(0,Rt.da)(),(0,Rt.Yi)();var Gi,Zi,Ni,Pi=class{constructor(e){this._container=e}set text(e){(0,Rt.vS)(this._container,...(0,Rt.Zi)(null!==e&&void 0!==e?e:""))}set title(e){!this.hover&&e?this.hover=(0,Rt.Ui)().setupManagedHover((0,Rt.ua)("mouse"),this._container,e):this.hover&&this.hover.update(e)}dispose(){var e;null===(e=this.hover)||void 0===e||e.dispose()}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.ok)(),(0,Rt.qd)(),(0,Pt.en)(),(0,Lt.c)(),(0,Rt.ab)(),(0,Rt.Up)(),(0,Rt.oA)(),(0,Rt.$d)(),(0,Rt.qx)(),(0,Rt.PA)(),(0,Rt.Wo)(),(0,Rt.nM)(),(0,Rt.wb)(),(0,Rt.ss)(),(0,Rt.za)(),(0,Rt.$p)(),(0,Tt.f)(),(0,Rt.Qn)(),(0,Rt.Mi)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.Pp)(),(0,Rt.Ll)(),(0,Tt.un)(),(0,Rt.mE)({});var Ji=(r=class extends Lt.s{constructor(e,t,i,o,s){super(e,t,i,o,s),this.inputDisposable=this._register(new Rt.OA)}createEditor(e){this.container=(0,Rt.Zb)(".monaco-editor-pane-placeholder",{tabIndex:0}),this.container.style.outline="none",this.scrollbar=this._register(new Rt.zp(this.container,{horizontal:Rt.aA.Auto,vertical:Rt.aA.Auto})),e.appendChild(this.scrollbar.getDomNode())}async setInput(e,t,i,o){await super.setInput(e,t,i,o),!o.isCancellationRequested&&(this.inputDisposable.value=await this.renderInput(e,t))}async renderInput(e,t){let[i,o]=(0,Rt.Qj)(this.container,this.scrollbar);(0,Rt.fx)(i);let s=new Rt.EA,{icon:r,label:n,actions:a}=await this.getContents(e,t,s),d=(0,Rt.Ak)(n,Gi.PLACEHOLDER_LABEL_MAX_LENGTH),l=i.appendChild((0,Rt.Zb)(".editor-placeholder-icon-container"));s.add(new Pi(l)).text=r;let c=i.appendChild((0,Rt.Zb)(".editor-placeholder-label-container")),h=(0,Rt.Zb)("span");if(h.textContent=d,c.appendChild(h),i.setAttribute("aria-label","".concat((0,Tt.d)(e,void 0,this.group,void 0),", ").concat(d)),a.length){let e=i.appendChild((0,Rt.Zb)(".editor-placeholder-buttons-container")),t=s.add(new Rt.Jn(e));for(let i=0;i<a.length;i++){let e=s.add(t.addButton((0,xt.A)((0,xt.A)({},Rt.xi),{},{secondary:0!==i})));e.label=a[i].label,s.add(e.onDidClick(e=>{e&&Rt.ex.stop(e,!0),a[i].run()}))}}return o.scanDomNode(),s}clearInput(){this.container&&(0,Rt.fx)(this.container),this.inputDisposable.clear(),super.clearInput()}layout(e){let[t,i]=(0,Rt.Qj)(this.container,this.scrollbar);(0,Rt.OS)(t,e.width,e.height),i.scanDomNode(),t.classList.toggle("max-height-200px",e.height<=200)}focus(){var e;super.focus(),null===(e=this.container)||void 0===e||e.focus()}dispose(){var e;null!==(e=this.container)&&void 0!==e&&e.remove(),super.dispose()}},{_:Gi=r},{_:r.PLACEHOLDER_LABEL_MAX_LENGTH=1024},r);Ji=Gi=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.ib),(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Rt.Uo)],Ji);var Bi=(n=class extends Ji{constructor(e,t,i,o,s,r){super(Zi.ID,e,t,i,r),this.commandService=o,this.workspaceService=s}getTitle(){return Zi.LABEL}async getContents(){return{icon:"$(workspace-untrusted)",label:(0,Rt.us)((0,Rt.vs)(this.workspaceService.getWorkspace()))?(0,Rt.Ij)(3430,"The file is not displayed in the editor because trust has not been granted to the folder."):(0,Rt.Ij)(3431,"The file is not displayed in the editor because trust has not been granted to the workspace."),actions:[{label:(0,Rt.Ij)(3432,"Manage Workspace Trust"),run:()=>this.commandService.executeCommand("workbench.trust.manage")}]}}},{_:Zi=n},{_:n.ID="workbench.editors.workspaceTrustRequiredEditor"},{_:n.LABEL=(0,Rt.Ij)(3429,"Workspace Trust Required")},{_:n.DESCRIPTOR=Tt.u.create(n,n.ID,n.LABEL)},n);Bi=Zi=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.Qd),(0,Rt.Fb)(3,Rt.Cb),(0,Rt.Fb)(4,Rt.Ra),(0,Rt.Fb)(5,Rt.Uo)],Bi);var Oi=(a=class extends Ji{constructor(e,t,i,o,s,r,n){super(Ni.ID,e,t,i,o),this.fileService=s,this.dialogService=r,this.commandService=n}async getContents(e,t,i){let o,s=e.resource,r=t.error,n=(null===r||void 0===r?void 0:r.fileOperationResult)===Rt.Is.FILE_NOT_FOUND;o=n?(0,Rt.Ij)(3434,"The editor could not be opened because the file was not found."):(0,Pt.on)(r)&&r.forceMessage?r.message:r?(0,Rt.Ij)(3435,"The editor could not be opened due to an unexpected error. Please consult the log for more details."):(0,Rt.Ij)(3436,"The editor could not be opened due to an unexpected error.");let a,d="$(error)";return(0,Pt.on)(r)&&(r.forceSeverity===Rt.Kd.Info?d="$(info)":r.forceSeverity===Rt.Kd.Warning&&(d="$(warning)")),a=(0,Pt.on)(r)&&r.actions.length>0?r.actions.map(e=>({label:e.label,run:()=>{let t=e.run();t instanceof Promise&&t.catch(e=>this.dialogService.error((0,Rt.Ip)(e)))}})):[{label:(0,Rt.Ij)(3437,"Try Again"),run:()=>this.group.openEditor(e,(0,xt.A)((0,xt.A)({},t),{},{source:Rt.Yp.USER}))},{label:(0,Rt.Ij)(3438,"Show Logs"),run:()=>this.commandService.executeCommand(Tt.dn)}],n&&s&&this.fileService.hasProvider(s)&&i.add(this.fileService.onDidFilesChange(i=>{i.contains(s,Rt.As.ADDED,Rt.As.UPDATED)&&this.group.openEditor(e,t)})),{icon:d,label:o,actions:null!==a&&void 0!==a?a:[]}}},{_:Ni=a},{_:a.ID="workbench.editors.errorEditor"},{_:a.LABEL=(0,Rt.Ij)(3433,"Error Editor")},{_:a.DESCRIPTOR=Tt.u.create(a,a.ID,a.LABEL)},a);Oi=Ni=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.Qd),(0,Rt.Fb)(3,Rt.Uo),(0,Rt.Fb)(4,Rt.ys),(0,Rt.Fb)(5,Rt.Fl),(0,Rt.Fb)(6,Rt.Cb)],Oi),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.gA)(),(0,Rt.qd)(),(0,Rt.PA)(),(0,Pt.en)(),(0,Rt.qx)(),(0,Rt.vb)(),(0,Nt.Q)(),(0,Rt.Kb)(),(0,Nt.gt)(),(0,Rt.Ja)(),(0,Lt.Z)(),(0,Rt.nM)(),(0,Rt.Ma)(),(0,Rt.$p)(),(0,Rt.xN)(),(0,Rt.Pp)(),(0,Rt.nb)(),(0,Rt.Ll)(),(0,Lt.F)();var Ki=class extends Rt.CA{get minimumWidth(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.minimumWidth)&&void 0!==e?e:Lt.K.width}get minimumHeight(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.minimumHeight)&&void 0!==e?e:Lt.K.height}get maximumWidth(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.maximumWidth)&&void 0!==e?e:Lt.G.width}get maximumHeight(){var e,t;return null!==(e=null===(t=this._activeEditorPane)||void 0===t?void 0:t.maximumHeight)&&void 0!==e?e:Lt.G.height}get activeEditorPane(){return this._activeEditorPane}constructor(e,t,i,o,s,r,n,a,d,l){super(),this.editorGroupParent=e,this.editorPanesParent=t,this.groupView=i,this.layoutService=o,this.instantiationService=s,this.workspaceTrustService=n,this.logService=a,this.dialogService=d,this.hostService=l,this._onDidFocus=this._register(new Rt.uA),this.onDidFocus=this._onDidFocus.event,this._onDidChangeSizeConstraints=this._register(new Rt.uA),this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this._activeEditorPane=null,this.editorPanes=[],this.mapEditorPaneToPendingSetInput=new Map,this.activeEditorPaneDisposables=this._register(new Rt.EA),this.editorPanesRegistry=Rt._b.as(Pt.Rt.EditorPane),this.editorOperation=this._register(new Nt.ft(r)),this.registerListeners()}registerListeners(){this._register(this.workspaceTrustService.onDidChangeTrust(()=>this.onDidChangeWorkspaceTrust()))}onDidChangeWorkspaceTrust(){var e,t;let i=null===(e=this._activeEditorPane)||void 0===e?void 0:e.input,o=null===(t=this._activeEditorPane)||void 0===t?void 0:t.options;(null===i||void 0===i?void 0:i.hasCapability(Pt.zt.RequiresTrust))&&this.groupView.openEditor(i,o)}async openEditor(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object.create(null);try{return await this.doOpenEditor(this.getEditorPaneDescriptor(e),e,t,i,o)}catch(s){return null!==t&&void 0!==t&&t.ignoreError?{error:s}:this.doShowError(s,e,t,i,o)}}async doShowError(e,t,i,o,s){this.logService.error(e);let r=!1;if((null===i||void 0===i?void 0:i.source)===Rt.Yp.USER&&(!(0,Pt.on)(e)||e.allowDialog)&&(r=await this.doShowErrorDialog(e,t)),r)return{error:e};let n=(0,xt.A)({},i);return(0,Rt.SN)(e)||(n.error=e),(0,xt.A)((0,xt.A)({},await this.doOpenEditor(Oi.DESCRIPTOR,t,n,o,s)),{},{error:e})}async doShowErrorDialog(e,t){var i;let o,s,r=Rt.Kd.Error,n=(0,Rt.Ip)(e);(0,Pt.on)(e)&&(s=e.actions,r=null!==(i=e.forceSeverity)&&void 0!==i?i:Rt.Kd.Error,e.forceMessage&&(o=e.message,n=void 0)),o||(o=(0,Rt.Ij)(3426,"Unable to open '{0}'",t.getName()));let a,d=[];if(s&&s.length>0)for(let h of s)d.push({label:h.label,run:()=>h});else d.push({label:(0,Rt.Ij)(3427,"&&OK"),run:()=>{}});1===d.length&&(a={run:()=>{l=!0}});let l=!1,{result:c}=await this.dialogService.prompt({type:r,message:o,detail:n,buttons:d,cancelButton:a});if(c){let e=c.run();e instanceof Promise&&e.catch(e=>this.dialogService.error((0,Rt.Ip)(e))),l=!0}return l}async doOpenEditor(e,t,i,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Object.create(null),r=this.doShowEditorPane(e),n=(0,Rt.Tx)(),{changed:a,cancelled:d}=await this.doSetInput(r,t,i,s);return d||(null!==i&&void 0!==i&&i.preserveFocus||!this.shouldRestoreFocus(n)?(null===o||void 0===o?void 0:o.preserveWindowOrder)||this.hostService.moveTop((0,Rt.Vx)(this.groupView.windowId,!0).window):r.focus()),{pane:r,changed:a,cancelled:d}}shouldRestoreFocus(e){if(!this.layoutService.isRestored()||!e)return!0;let t=(0,Rt.Tx)();return!(t&&t!==e.ownerDocument.body&&e!==t&&(0,Rt.$x)(t)&&!(0,Rt.Xx)(t,this.editorGroupParent))}getEditorPaneDescriptor(e){return e.hasCapability(Pt.zt.RequiresTrust)&&!this.workspaceTrustService.isWorkspaceTrusted()?Bi.DESCRIPTOR:(0,Rt.$j)(this.editorPanesRegistry.getEditorPane(e))}doShowEditorPane(e){if(this._activeEditorPane&&e.describes(this._activeEditorPane))return this._activeEditorPane;this.doHideActiveEditorPane();let t=this.doCreateEditorPane(e);this.doSetActiveEditorPane(t);let i=(0,Rt.$j)(t.getContainer());return this.editorPanesParent.appendChild(i),(0,Rt.DS)(i),t.setVisible(!0),this.pagePosition&&t.layout(new Rt.Qb(this.pagePosition.width,this.pagePosition.height),{top:this.pagePosition.top,left:this.pagePosition.left}),this.boundarySashes&&t.setBoundarySashes(this.boundarySashes),t}doCreateEditorPane(e){let t=this.doInstantiateEditorPane(e);if(!t.getContainer()){let e=(0,Rt.Zb)(".editor-instance");this.editorPanesParent.appendChild(e);try{t.create(e)}catch(t){throw e.remove(),(0,Rt.Kx)(e),t}}return t}doInstantiateEditorPane(e){let t=this.editorPanes.find(t=>e.describes(t));if(t)return t;let i=this._register(e.instantiate(this.instantiationService,this.groupView));return this.editorPanes.push(i),i}doSetActiveEditorPane(e){this._activeEditorPane=e,this.activeEditorPaneDisposables.clear(),e&&(this.activeEditorPaneDisposables.add(e.onDidChangeSizeConstraints(e=>this._onDidChangeSizeConstraints.fire(e))),this.activeEditorPaneDisposables.add(e.onDidFocus(()=>this._onDidFocus.fire()))),this._onDidChangeSizeConstraints.fire(void 0)}async doSetInput(e,t,i,o){var s,r;let n=null===(s=e.input)||void 0===s?void 0:s.matches(t);if(n&&(null===i||void 0===i||!i.forceReload))return this.mapEditorPaneToPendingSetInput.has(e)&&await this.mapEditorPaneToPendingSetInput.get(e),n=null===(r=e.input)||void 0===r?void 0:r.matches(t),n&&e.setOptions(i),{changed:!1,cancelled:!n};let a=this.editorOperation.start(this.layoutService.isRestored()?800:3200),d=!1;try{e.clearInput();let s=e.setInput(t,i,o,a.token);this.mapEditorPaneToPendingSetInput.set(e,s),await s,a.isCurrent()||(d=!0)}catch(e){if(a.isCurrent())throw e;d=!0}finally{a.isCurrent()&&this.mapEditorPaneToPendingSetInput.delete(e),a.stop()}return{changed:!n,cancelled:d}}doHideActiveEditorPane(){if(!this._activeEditorPane)return;this.editorOperation.stop(),this.safeRun(()=>{var e;return null===(e=this._activeEditorPane)||void 0===e?void 0:e.clearInput()}),this.safeRun(()=>{var e;return null===(e=this._activeEditorPane)||void 0===e?void 0:e.setVisible(!1)}),this.mapEditorPaneToPendingSetInput.delete(this._activeEditorPane);let e=this._activeEditorPane.getContainer();e&&(e.remove(),(0,Rt.Kx)(e)),this.doSetActiveEditorPane(null)}closeEditor(e){var t;(null===(t=this._activeEditorPane)||void 0===t?void 0:t.input)&&e.matches(this._activeEditorPane.input)&&this.doHideActiveEditorPane()}setVisible(e){this.safeRun(()=>{var t;return null===(t=this._activeEditorPane)||void 0===t?void 0:t.setVisible(e)})}layout(e){this.pagePosition=e,this.safeRun(()=>{var t;return null===(t=this._activeEditorPane)||void 0===t?void 0:t.layout(new Rt.Qb(e.width,e.height),e)})}setBoundarySashes(e){this.boundarySashes=e,this.safeRun(()=>{var t;return null===(t=this._activeEditorPane)||void 0===t?void 0:t.setBoundarySashes(e)})}safeRun(e){try{e()}catch(e){this.logService.error(e)}}};Ki=(0,Rt.Pb)([(0,Rt.Fb)(3,Nt.Z),(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.Ka),(0,Rt.Fb)(6,Rt.Aa),(0,Rt.Fb)(7,Rt.eb),(0,Rt.Fb)(8,Rt.Fl),(0,Rt.Fb)(9,Lt.P)],Ki),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.vn)(),(0,Rt.WM)(),(0,Rt.PA)(),(0,Rt.mj)(),(0,Rt.Fj)(),(0,Rt.Sb)(),(0,Rt.s_)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.Ad)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.Mi)(),(0,Rt.ss)(),(0,Rt.za)();var Mi,ji=Rt.PO.and(Rt.PO.equals("chatSetupHidden",!1),Rt.PO.equals("chatSetupDisabled",!1)),Qi={text:(0,Rt.Ij)(3414,"Open Chat"),id:"workbench.action.chat.open",when:{native:ji,web:ji}},Yi={text:(0,Rt.Ij)(3415,"Show All Commands"),id:"workbench.action.showCommands"},Hi={text:(0,Rt.Ij)(3416,"Go to File"),id:"workbench.action.quickOpen"},Xi={text:(0,Rt.Ij)(3417,"Open File"),id:"workbench.action.files.openFile"},Ui={text:(0,Rt.Ij)(3418,"Open Folder"),id:"workbench.action.files.openFolder"},zi={text:(0,Rt.Ij)(3419,"Open File or Folder"),id:"workbench.action.files.openFileFolder"},qi={text:(0,Rt.Ij)(3420,"Open Recent"),id:"workbench.action.openRecent"},$i={text:(0,Rt.Ij)(3421,"New Untitled Text File"),id:"workbench.action.files.newUntitledFile"},eo={text:(0,Rt.Ij)(3422,"Find in Files"),id:"workbench.action.findInFiles"},to={text:(0,Rt.Ij)(3423,"Toggle Terminal"),id:"workbench.action.terminal.toggleTerminal",when:{web:Rt.PO.equals("terminalProcessSupported",!0)}},io={text:(0,Rt.Ij)(3424,"Start Debugging"),id:"workbench.action.debug.start",when:{web:Rt.PO.equals("terminalProcessSupported",!0)}},oo={text:(0,Rt.Ij)(3425,"Open Settings"),id:"workbench.action.openSettings"},so=[Qi,Yi],ro=(0,Rt.AM)([...so,...Rt.Cj&&!Rt.Dj?[zi]:[Xi,Ui],qi,Rt.Cj&&!Rt.Dj?$i:void 0]),no=[...so],ao=[Hi,eo,io,to,oo],lo=(d=class extends Rt.CA{constructor(e,t,i,o,s,r){super(),this.keybindingService=t,this.contextService=i,this.contextKeyService=o,this.configurationService=s,this.storageService=r,this.transientDisposables=this._register(new Rt.EA),this.keybindingLabels=this._register(new Rt.EA),this.enabled=!1,this.cachedWhen=this.storageService.getObject(Mi.CACHED_WHEN,Rt.Go.PROFILE,Object.create(null)),this.workbenchState=this.contextService.getWorkbenchState();let n=(0,Rt.Gx)(".editor-group-watermark",[(0,Rt.Gx)(".watermark-container",[(0,Rt.Gx)(".letterpress"),(0,Rt.Gx)(".shortcuts@shortcuts")])]);(0,Rt.dx)(e,n.root),this.shortcuts=n.shortcuts,this.registerListeners(),this.render()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Mi.SETTINGS_KEY)&&this.enabled!==this.configurationService.getValue(Mi.SETTINGS_KEY)&&this.render()})),this._register(this.contextService.onDidChangeWorkbenchState(e=>{this.workbenchState!==e&&(this.workbenchState=e,this.render())})),this._register(this.storageService.onWillSaveState(e=>{if(e.reason===Rt.qo.SHUTDOWN){let e=[...ro,...no,...ao];for(let o of e){var t,i;let e=Rt.Dj?null===(t=o.when)||void 0===t?void 0:t.web:null===(i=o.when)||void 0===i?void 0:i.native;e&&(this.cachedWhen[o.id]=this.contextKeyService.contextMatchesRules(e))}this.storageService.store(Mi.CACHED_WHEN,JSON.stringify(this.cachedWhen),Rt.Go.PROFILE,Rt.Ko.MACHINE)}}))}render(){if(this.enabled=this.configurationService.getValue(Mi.SETTINGS_KEY),(0,Rt.fx)(this.shortcuts),this.transientDisposables.clear(),!this.enabled)return;let e=this.filterEntries(this.workbenchState===Rt.rs.EMPTY?ro:no);if(e.length<Mi.MINIMUM_ENTRIES){let t=this.filterEntries(ao);(0,Rt.iN)(t),e.push(...t.slice(0,Mi.MINIMUM_ENTRIES-e.length))}let t=(0,Rt.dx)(this.shortcuts,(0,Rt.Zb)(".watermark-box")),i=()=>{(0,Rt.fx)(t),this.keybindingLabels.clear();for(let i of e){let e=this.keybindingService.lookupKeybinding(i.id);if(!e)continue;let o=(0,Rt.dx)(t,(0,Rt.Zb)("dl"));(0,Rt.dx)(o,(0,Rt.Zb)("dt")).textContent=i.text;let s=(0,Rt.dx)(o,(0,Rt.Zb)("dd"));this.keybindingLabels.add(new Rt._n(s,Rt.uj,(0,xt.A)({renderUnboundKeybindings:!0},Rt.Ei))).set(e)}};i(),this.transientDisposables.add(this.keybindingService.onDidUpdateKeybindings(i))}filterEntries(e){return e.filter(e=>{var t,i;if(this.cachedWhen[e.id])return!0;let o=Rt.Dj?null===(t=e.when)||void 0===t?void 0:t.web:null===(i=e.when)||void 0===i?void 0:i.native;return!o||this.contextKeyService.contextMatchesRules(o)}).filter(e=>!!Rt.xb.getCommand(e.id)).filter(e=>!!this.keybindingService.lookupKeybinding(e.id))}},{_:Mi=d},{_:d.CACHED_WHEN="editorGroupWatermark.whenConditions"},{_:d.SETTINGS_KEY="workbench.tips.enabled"},{_:d.MINIMUM_ENTRIES=3},d);lo=Mi=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.kd),(0,Rt.Fb)(2,Rt.Ra),(0,Rt.Fb)(3,Rt.yb),(0,Rt.Fb)(4,Rt.o_),(0,Rt.Fb)(5,Rt.Uo)],lo);(0,Rt.fE)(),(0,Rt.qx)(),(0,Rt.qg)(),(0,Rt.Up)(),(0,Rt.WM)(),(0,Rt.Db)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.oA)(),(0,Rt.mE)({});var co=class{},ho=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rt.aA.Auto,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;this._disposables=new Rt.EA,this._onDidSelectItem=new Rt.uA,this._onDidFocusItem=new Rt.uA,this._onDidChangeFocus=new Rt.uA,this.onDidSelectItem=this._onDidSelectItem.event,this.onDidFocusItem=this._onDidFocusItem.event,this.onDidChangeFocus=this._onDidChangeFocus.event,this._items=[],this._nodes=[],this._freeNodes=[],this._enabled=!0,this._focusedItemIdx=-1,this._selectedItemIdx=-1,this._domNode=(0,Rt.gx)("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new Rt.zp(this._domNode,{vertical:Rt.aA.Hidden,horizontal:i,horizontalScrollbarSize:t,useShadows:!1,scrollYToX:!0}),this._separatorIcon=o,this._disposables.add(this._scrollable),this._disposables.add((0,Rt.lx)(this._domNode,"click",e=>this._onClick(e))),e.appendChild(this._scrollable.getDomNode());let r=(0,Rt.Gg)(this._domNode);this._style(r,s);let n=(0,Rt.AS)(this._domNode);this._disposables.add(n),this._disposables.add(n.onDidBlur(e=>this._onDidChangeFocus.fire(!1))),this._disposables.add(n.onDidFocus(e=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(e){this._scrollable.updateOptions({horizontalScrollbarSize:e})}setHorizontalScrollbarVisibility(e){this._scrollable.updateOptions({horizontal:e})}dispose(){var e,t;this._disposables.dispose(),null!==(e=this._pendingLayout)&&void 0!==e&&e.dispose(),null!==(t=this._pendingDimLayout)&&void 0!==t&&t.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(e){var t,i;e&&Rt.Qb.equals(e,this._dimension)||(e?(null!==(t=this._pendingDimLayout)&&void 0!==t&&t.dispose(),this._pendingDimLayout=this._updateDimensions(e)):(null!==(i=this._pendingLayout)&&void 0!==i&&i.dispose(),this._pendingLayout=this._updateScrollbar()))}_updateDimensions(e){let t=new Rt.EA;return t.add((0,Rt.dS)((0,Rt.Bx)(this._domNode),()=>{this._dimension=e,this._domNode.style.width="".concat(e.width,"px"),this._domNode.style.height="".concat(e.height,"px"),t.add(this._updateScrollbar())})),t}_updateScrollbar(){return(0,Rt.uS)((0,Rt.Bx)(this._domNode),()=>{(0,Rt.uS)((0,Rt.Bx)(this._domNode),()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(e,t){let i="";t.breadcrumbsBackground&&(i+=".monaco-breadcrumbs { background-color: ".concat(t.breadcrumbsBackground,"}")),t.breadcrumbsForeground&&(i+=".monaco-breadcrumbs .monaco-breadcrumb-item { color: ".concat(t.breadcrumbsForeground,"}\n")),t.breadcrumbsFocusForeground&&(i+=".monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ".concat(t.breadcrumbsFocusForeground,"}\n")),t.breadcrumbsFocusAndSelectionForeground&&(i+=".monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ".concat(t.breadcrumbsFocusAndSelectionForeground,"}\n")),t.breadcrumbsHoverForeground&&(i+=".monaco-breadcrumbs:not(.disabled\t) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ".concat(t.breadcrumbsHoverForeground,"}\n")),e.textContent=i}setEnabled(e){this._enabled=e,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){let e=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;e>=0&&e<this._items.length?this._focus(e,void 0):this._domNode.focus()}isDOMFocused(){return(0,Rt.Zx)(this._domNode)}getFocused(){return this._items[this._focusedItemIdx]}setFocused(e,t){this._focus(this._items.indexOf(e),t)}focusPrev(e){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,e)}focusNext(e){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,e)}_focus(e,t){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let t=this._nodes[i];i===e?(this._focusedItemIdx=i,t.classList.add("focused"),t.focus()):t.classList.remove("focused")}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:t})}reveal(e){let t=this._items.indexOf(e);t>=0&&this._reveal(t,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(e,t){if(e<0||e>=this._nodes.length)return;let i=this._nodes[e];if(!i)return;let{width:o}=this._scrollable.getScrollDimensions(),{scrollLeft:s}=this._scrollable.getScrollPosition();(!t||i.offsetLeft>s+o||i.offsetLeft<s)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(e,t){this._select(this._items.indexOf(e),t)}_select(e,t){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){let t=this._nodes[i];i===e?(this._selectedItemIdx=i,t.classList.add("selected")):t.classList.remove("selected")}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:t})}getItems(){return this._items}setItems(e){let t,i=[];try{t=(0,Rt.MM)(this._items,e,(e,t)=>e.equals(t)),i=this._items.splice(t,this._items.length-t,...e.slice(t)),this._render(t),(0,Rt.MA)(i),(0,Rt.MA)(e.slice(0,t)),this._focus(-1,void 0)}catch(o){let s=Error("BreadcrumbsItem#setItems: newItems: ".concat(e.length,", prefix: ").concat(t,", removed: ").concat(i.length));throw s.name=o.name,s.stack=o.stack,s}}_render(e){let t=!1;for(;e<this._items.length&&e<this._nodes.length;e++){let i=this._items[e],o=this._nodes[e];this._renderItem(i,o),t=!0}for(;e<this._nodes.length;){let e=this._nodes.pop();e&&(this._freeNodes.push(e),e.remove(),t=!0)}for(;e<this._items.length;e++){let i=this._items[e],o=this._freeNodes.length>0?this._freeNodes.pop():(0,Rt.gx)("div");o&&(this._renderItem(i,o),this._domNode.appendChild(o),this._nodes.push(o),t=!0)}t&&this.layout(void 0)}_renderItem(e,t){(0,Rt.fx)(t),t.className="";try{e.render(t)}catch(e){t.textContent="<<RENDER ERROR>>",console.error(e)}t.tabIndex=-1,t.setAttribute("role","listitem"),t.classList.add("monaco-breadcrumb-item");let i=(0,Rt.Zb)(Rt.Eb.asCSSSelector(this._separatorIcon));t.appendChild(i)}_onClick(e){if(this._enabled)for(let t=e.target;t;t=t.parentElement){let i=this._nodes.indexOf(t);if(i>=0){this._focus(i,e),this._select(i,e);break}}}};(0,Rt.gA)(),(0,Rt.Fj)(),(0,Rt.I_)(),(0,Rt.im)(),(0,Rt.vb)(),(0,Rt.Kb)();var uo=class{constructor(){this._map=new Map}register(e,t){if(this._map.has(e))throw Error("group (".concat(e,") has already a widget"));return this._map.set(e,t),{dispose:()=>this._map.delete(e)}}getWidget(e){return this._map.get(e)}},go=(l=class{constructor(){}static _stub(e){return{bindTo(t){let i=new Rt.uA,o=t.onDidChangeConfiguration(t=>{t.affectsConfiguration(e)&&i.fire(void 0)});return new class{constructor(){this.name=e,this.onDidChange=i.event}getValue(i){return i?t.getValue(e,i):t.getValue(e)}updateValue(i,o){return o?t.updateValue(e,i,o):t.updateValue(e,i)}dispose(){o.dispose(),i.dispose()}}}}}},{_:l.IsEnabled=l._stub("breadcrumbs.enabled")},{_:l.UseQuickPick=l._stub("breadcrumbs.useQuickPick")},{_:l.FilePath=l._stub("breadcrumbs.filePath")},{_:l.SymbolPath=l._stub("breadcrumbs.symbolPath")},{_:l.SymbolSortOrder=l._stub("breadcrumbs.symbolSortOrder")},{_:l.SymbolPathSeparator=l._stub("breadcrumbs.symbolPathSeparator")},{_:l.Icons=l._stub("breadcrumbs.icons")},{_:l.TitleScrollbarSizing=l._stub("workbench.editor.titleScrollbarSizing")},{_:l.TitleScrollbarVisibility=l._stub("workbench.editor.titleScrollbarVisibility")},{_:l.FileExcludes=l._stub("files.exclude")},l);Rt._b.as(Rt.E_.Configuration).registerConfiguration({id:"breadcrumbs",title:(0,Rt.Ij)(3056,"Breadcrumb Navigation"),order:101,type:"object",properties:{"breadcrumbs.enabled":{description:(0,Rt.Ij)(3057,"Enable/disable navigation breadcrumbs."),type:"boolean",default:!0},"breadcrumbs.filePath":{description:(0,Rt.Ij)(3058,"Controls whether and how file paths are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[(0,Rt.Ij)(3059,"Show the file path in the breadcrumbs view."),(0,Rt.Ij)(3060,"Do not show the file path in the breadcrumbs view."),(0,Rt.Ij)(3061,"Only show the last element of the file path in the breadcrumbs view.")]},"breadcrumbs.symbolPath":{description:(0,Rt.Ij)(3062,"Controls whether and how symbols are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[(0,Rt.Ij)(3063,"Show all symbols in the breadcrumbs view."),(0,Rt.Ij)(3064,"Do not show symbols in the breadcrumbs view."),(0,Rt.Ij)(3065,"Only show the current symbol in the breadcrumbs view.")]},"breadcrumbs.symbolSortOrder":{description:(0,Rt.Ij)(3066,"Controls how symbols are sorted in the breadcrumbs outline view."),type:"string",default:"position",scope:Rt.w_.LANGUAGE_OVERRIDABLE,enum:["position","name","type"],enumDescriptions:[(0,Rt.Ij)(3067,"Show symbol outline in file position order."),(0,Rt.Ij)(3068,"Show symbol outline in alphabetical order."),(0,Rt.Ij)(3069,"Show symbol outline in symbol type order.")]},"breadcrumbs.icons":{description:(0,Rt.Ij)(3070,"Render breadcrumb items with icons."),type:"boolean",default:!0},"breadcrumbs.symbolPathSeparator":{description:(0,Rt.Ij)(3071,"The separator used when copying the breadcrumb symbol path."),type:"string",default:".",scope:Rt.w_.LANGUAGE_OVERRIDABLE},"breadcrumbs.showFiles":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3072,"When enabled breadcrumbs show `file`-symbols.")},"breadcrumbs.showModules":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3073,"When enabled breadcrumbs show `module`-symbols.")},"breadcrumbs.showNamespaces":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3074,"When enabled breadcrumbs show `namespace`-symbols.")},"breadcrumbs.showPackages":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3075,"When enabled breadcrumbs show `package`-symbols.")},"breadcrumbs.showClasses":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3076,"When enabled breadcrumbs show `class`-symbols.")},"breadcrumbs.showMethods":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3077,"When enabled breadcrumbs show `method`-symbols.")},"breadcrumbs.showProperties":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3078,"When enabled breadcrumbs show `property`-symbols.")},"breadcrumbs.showFields":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3079,"When enabled breadcrumbs show `field`-symbols.")},"breadcrumbs.showConstructors":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3080,"When enabled breadcrumbs show `constructor`-symbols.")},"breadcrumbs.showEnums":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3081,"When enabled breadcrumbs show `enum`-symbols.")},"breadcrumbs.showInterfaces":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3082,"When enabled breadcrumbs show `interface`-symbols.")},"breadcrumbs.showFunctions":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3083,"When enabled breadcrumbs show `function`-symbols.")},"breadcrumbs.showVariables":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3084,"When enabled breadcrumbs show `variable`-symbols.")},"breadcrumbs.showConstants":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3085,"When enabled breadcrumbs show `constant`-symbols.")},"breadcrumbs.showStrings":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3086,"When enabled breadcrumbs show `string`-symbols.")},"breadcrumbs.showNumbers":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3087,"When enabled breadcrumbs show `number`-symbols.")},"breadcrumbs.showBooleans":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3088,"When enabled breadcrumbs show `boolean`-symbols.")},"breadcrumbs.showArrays":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3089,"When enabled breadcrumbs show `array`-symbols.")},"breadcrumbs.showObjects":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3090,"When enabled breadcrumbs show `object`-symbols.")},"breadcrumbs.showKeys":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3091,"When enabled breadcrumbs show `key`-symbols.")},"breadcrumbs.showNull":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3092,"When enabled breadcrumbs show `null`-symbols.")},"breadcrumbs.showEnumMembers":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3093,"When enabled breadcrumbs show `enumMember`-symbols.")},"breadcrumbs.showStructs":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3094,"When enabled breadcrumbs show `struct`-symbols.")},"breadcrumbs.showEvents":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3095,"When enabled breadcrumbs show `event`-symbols.")},"breadcrumbs.showOperators":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3096,"When enabled breadcrumbs show `operator`-symbols.")},"breadcrumbs.showTypeParameters":{type:"boolean",default:!0,scope:Rt.w_.LANGUAGE_OVERRIDABLE,markdownDescription:(0,Rt.Ij)(3097,"When enabled breadcrumbs show `typeParameter`-symbols.")}}}),(0,Rt.Ib)(),(0,Rt.zk)(),(0,Rt.xN)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.yT)(),(0,Rt.iT)(),(0,Rt.s_)(),(0,Rt.ac)(),(0,Rt.ss)(),(0,Rt.za)(),(0,Tt.kt)(),(0,Tt.Tn)();var po=class{constructor(e,t){this.uri=e,this.kind=t}},bo=class{constructor(e,t){this.element=e,this.outline=t}},mo=class{constructor(e,t,i,o,s){this.resource=e,this.editor=t,this._workspaceService=o,this._outlineService=s,this._disposables=new Rt.EA,this._currentOutline=new Rt.OA,this._outlineDisposables=new Rt.EA,this._onDidUpdate=new Rt.uA,this.onDidUpdate=this._onDidUpdate.event,this._cfgFilePath=go.FilePath.bindTo(i),this._cfgSymbolPath=go.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(e=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(e=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(e),t&&(this._bindToEditor(t),this._disposables.add(s.onDidChange(()=>this._bindToEditor(t))),this._disposables.add(t.onDidChangeControl(()=>this._bindToEditor(t)))),this._onDidUpdate.fire(this)}dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let e=[];if("on"===this._cfgFilePath.getValue()?e=e.concat(this._fileInfo.path):"last"===this._cfgFilePath.getValue()&&this._fileInfo.path.length>0&&(e=e.concat(this._fileInfo.path.slice(-1))),"off"===this._cfgSymbolPath.getValue()||!this._currentOutline.value)return e;let t=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i="last"===this._cfgSymbolPath.getValue()&&t.length>0?t.length-1:0;i<t.length;i++)e.push(new bo(t[i].element,this._currentOutline.value));return 0===t.length&&!this._currentOutline.value.isEmpty&&e.push(new bo(this._currentOutline.value,this._currentOutline.value)),e}_initFilePathInfo(e){var t;if((0,Rt.xT)(e,Rt.vT.untitled,Rt.vT.data))return{folder:void 0,path:[]};let i={folder:null!==(t=this._workspaceService.getWorkspaceFolder(e))&&void 0!==t?t:void 0,path:[]},o=e;for(;o&&"/"!==o.path&&(!i.folder||!(0,Rt.oT)(i.folder.uri,o));){i.path.unshift(new po(o,0===i.path.length?Rt.Ms.FILE:Rt.Ms.FOLDER));let e=o.path.length;if(o=(0,Rt.Qw)(o),o.path.length===e)break}return i.folder&&this._workspaceService.getWorkbenchState()===Rt.rs.WORKSPACE&&i.path.unshift(new po(i.folder.uri,Rt.Ms.ROOT_FOLDER)),i}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(e){let t=new Rt.Lk;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add((0,Rt.zA)(()=>t.dispose(!0))),this._outlineService.createOutline(e,Tt.Ot.Breadcrumbs,t.token).then(e=>{var i;t.token.isCancellationRequested&&(null!==(i=e)&&void 0!==i&&i.dispose(),e=void 0),this._currentOutline.value=e,this._onDidUpdate.fire(this),e&&this._outlineDisposables.add(e.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(e=>{this._onDidUpdate.fire(this),(0,Rt.CN)(e)})}};mo=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.o_),(0,Rt.Fb)(3,Rt.Ra),(0,Rt.Fb)(4,Tt.wn)],mo);var vo={};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.cn)(),(0,Rt.xN)(),(0,Rt.gA)(),(0,Rt.Qc)(),(0,Rt.wa)(),(0,Rt.PA)(),(0,Rt.AD)(),(0,Rt.iT)(),(0,Rt.TD)(),(0,Rt.s_)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.Kb)(),(0,Rt.Ct)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.ss)(),(0,Rt.za)(),(0,Wt.ot)(),(0,Rt.$d)(),(0,Rt.Fj)(),(0,Lt.U)(),(0,Pt.At)(),(0,Rt._v)(),(0,Rt.qx)(),(0,Rt.mE)(vo);var Co=class{constructor(e,t,i,o,s){this.resource=t,this._instantiationService=i,this._themeService=o,this._configurationService=s,this._disposables=new Rt.EA,this._fakeEvent=new UIEvent("fakeEvent"),this._onWillPickElement=new Rt.uA,this.onWillPickElement=this._onWillPickElement.event,this._previewDispoables=new Rt.OA,this._domNode=(0,Rt.gx)("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",e.appendChild(this._domNode)}dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(e,t,i,o,s){let r=this._themeService.getColorTheme().getColor(Rt.gh);this._arrow=(0,Rt.gx)("div"),this._arrow.className="arrow",this._arrow.style.borderColor="transparent transparent ".concat(r?r.toString():""),this._domNode.appendChild(this._arrow),this._treeContainer=(0,Rt.gx)("div"),this._treeContainer.style.background=r?r.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow="0 0 8px 2px ".concat(this._themeService.getColorTheme().getColor(Rt.dg)),this._treeContainer.style.border="1px solid ".concat(this._themeService.getColorTheme().getColor(Rt.ug)),this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:t,width:i,arrowSize:o,arrowOffset:s,inputHeight:0},this._tree=this._createTree(this._treeContainer,e),this._disposables.add(this._tree.onDidOpen(async e=>{let{element:t,editorOptions:i,sideBySide:o}=e;await this._revealElement(t,(0,xt.A)((0,xt.A)({},i),{},{preserveFocus:!1}),o)})),this._disposables.add(this._tree.onDidChangeFocus(e=>{this._previewDispoables.value=this._previewElement(e.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(e),this._layout()}catch(e){(0,Rt.CN)(e)}}_layout(){let e=2*this._layoutInfo.arrowSize,t=Math.min(this._layoutInfo.maxHeight-e,this._tree.contentHeight),i=t+e;this._domNode.style.height="".concat(i,"px"),this._domNode.style.width="".concat(this._layoutInfo.width,"px"),this._arrow.style.top="-".concat(2*this._layoutInfo.arrowSize,"px"),this._arrow.style.borderWidth="".concat(this._layoutInfo.arrowSize,"px"),this._arrow.style.marginLeft="".concat(this._layoutInfo.arrowOffset,"px"),this._treeContainer.style.height="".concat(t,"px"),this._treeContainer.style.width="".concat(this._layoutInfo.width,"px"),this._tree.layout(t,this._layoutInfo.width)}restoreViewState(){}};Co=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Rt.o_)],Co);var wo=class{getHeight(e){return 22}getTemplateId(e){return"FileStat"}},yo=class{getId(e){return Rt.wD.isUri(e)?e.toString():(0,Rt.ms)(e)?e.id:(0,Rt.hs)(e)?e.uri.toString():e.resource.toString()}},fo=class{constructor(e){this._fileService=e}hasChildren(e){return Rt.wD.isUri(e)||(0,Rt.ms)(e)||(0,Rt.hs)(e)||e.isDirectory}async getChildren(e){var t;if((0,Rt.ms)(e))return e.folders;let i;return i=(0,Rt.hs)(e)?e.uri:Rt.wD.isUri(e)?e:e.resource,null!==(t=(await this._fileService.resolve(i)).children)&&void 0!==t?t:[]}};fo=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.ys)],fo);var So=class{constructor(e,t){this._labels=e,this._configService=t,this.templateId="FileStat"}renderTemplate(e){return this._labels.create(e,{supportHighlights:!0})}renderElement(e,t,i){let o,s,r=this._configService.getValue("explorer.decorations"),{element:n}=e;(0,Rt.hs)(n)?(o=n.uri,s=Rt.Ms.ROOT_FOLDER):(o=n.resource,s=n.isDirectory?Rt.Ms.FOLDER:Rt.Ms.FILE),i.setFile(o,{fileKind:s,hidePath:!0,fileDecorations:r,matches:(0,Rt.Yc)(e.filterData),extraClasses:["picker-item"]})}disposeTemplate(e){e.dispose()}};So=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.o_)],So);var Io=class{getKeyboardNavigationLabel(e){return e.name}},ko=class{getWidgetAriaLabel(){return(0,Rt.Ij)(3110,"Breadcrumbs")}getAriaLabel(e){return e.name}},_o=class{constructor(e,t,i){this._workspaceService=e,this._cachedExpressions=new Map,this._disposables=new Rt.EA;let o=go.FileExcludes.bindTo(t),s=()=>{e.getWorkspace().folders.forEach(e=>{let t=o.getValue({resource:e.uri});if(!t)return;let s={};for(let i in t){if("boolean"!=typeof t[i])continue;s[0===i.indexOf("**/")?i:Rt.FD.join(e.uri.path,i)]=t[i]}let r=!i.hasCapability(e.uri,Rt.Rs.PathCaseSensitive);this._cachedExpressions.set(e.uri.toString(),(0,Rt.Da)(s,{ignoreCase:r}))})};s(),this._disposables.add(o),this._disposables.add(o.onDidChange(s)),this._disposables.add(e.onDidChangeWorkspaceFolders(s))}dispose(){this._disposables.dispose()}filter(e,t){if((0,Rt.hs)(e))return!0;let i=this._workspaceService.getWorkspaceFolder(e.resource);return!i||!this._cachedExpressions.has(i.uri.toString())||!this._cachedExpressions.get(i.uri.toString())((0,Rt.ID)(i.uri.path,e.resource.path),(0,Rt.Xw)(e.resource))}};_o=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ra),(0,Rt.Fb)(1,Rt.o_),(0,Rt.Fb)(2,Rt.ys)],_o);var Eo=class{compare(e,t){return(0,Rt.hs)(e)&&(0,Rt.hs)(t)?e.index-t.index:e.isDirectory===t.isDirectory?(0,Rt.on)(e.name,t.name):e.isDirectory?-1:1}},Ao=class extends Co{constructor(e,t,i,o,s,r,n){super(e,t,i,o,s),this._workspaceService=r,this._editorService=n}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");let t=e=>{this._treeContainer.classList.toggle("align-icons-and-twisties",e.hasFileIcons&&!e.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",!0===e.hidesExplorerArrows)};this._disposables.add(this._themeService.onDidFileIconThemeChange(t)),t(this._themeService.getFileIconTheme());let i=this._instantiationService.createInstance(Wt.at,Wt.rt);return this._disposables.add(i),this._instantiationService.createInstance(Rt.it,"BreadcrumbsFilePicker",e,new wo,[this._instantiationService.createInstance(So,i)],this._instantiationService.createInstance(fo),{multipleSelectionSupport:!1,sorter:new Eo,filter:this._instantiationService.createInstance(_o),identityProvider:new yo,keyboardNavigationLabelProvider:new Io,accessibilityProvider:this._instantiationService.createInstance(ko),showNotFoundMessage:!1,overrideStyles:{listBackground:Rt.gh}})}async _setInput(e){let t,{uri:i,kind:o}=e;t=o===Rt.Ms.ROOT_FOLDER?this._workspaceService.getWorkspace():(0,Rt.Qw)(i);let s,r=this._tree;await r.setInput(t);for(let{element:n}of r.getNode().children){if((0,Rt.hs)(n)&&(0,Rt.oT)(n.uri,i)){s=n;break}if((0,Rt.oT)(n.resource,i)){s=n;break}}s&&(r.reveal(s,.5),r.setFocus([s],this._fakeEvent)),r.domFocus()}_previewElement(e){return Rt.CA.None}async _revealElement(e,t,i){return!((0,Rt.hs)(e)||!e.isFile)&&(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:e.resource,options:t},i?-2:void 0),!0)}};Ao=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Rt.o_),(0,Rt.Fb)(5,Rt.Ra),(0,Rt.Fb)(6,Pt.kt)],Ao);var Do=class{constructor(e,t,i){this.comparator=e,this._order=i.getValue(t,"breadcrumbs.symbolSortOrder")}compare(e,t){return"name"===this._order?this.comparator.compareByName(e,t):"type"===this._order?this.comparator.compareByType(e,t):this.comparator.compareByPosition(e,t)}};Do=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.hv)],Do);var xo,Vo,Ro,To=class extends Co{_createTree(e,t){let{config:i}=t.outline;return this._instantiationService.createInstance(Rt.at,"BreadcrumbsOutlinePicker",e,i.delegate,i.renderers,i.treeDataSource,(0,xt.A)((0,xt.A)({},i.options),{},{sorter:this._instantiationService.createInstance(Do,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1}))}_setInput(e){let t=e.outline.captureViewState();this.restoreViewState=()=>{t.dispose()};let i=this._tree;return i.setInput(e.outline),e.element!==e.outline&&(i.reveal(e.element,.5),i.setFocus([e.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(e){return this._tree.getInput().preview(e)}async _revealElement(e,t,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(e,t,i,!1),!0}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.FT)(),(0,Lt.xo)(),(0,Rt.ca)(),(0,Rt.da)(),(0,Rt.Iw)(),(0,Rt.gD)(),(0,Rt.gA)(),(0,Rt.tO)(),(0,Rt.PA)(),(0,Rt.iT)(),(0,Rt.TD)(),(0,Wt.aC)(),(0,Rt.Fj)(),(0,Mt.c)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.w)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Wt.rh)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.Kb)(),(0,Rt.gb)(),(0,Rt.Xa)(),(0,Rt.Ct)(),(0,Rt.Tt)(),(0,Rt.Sc)(),(0,Rt.Mi)(),(0,Rt.q)(),(0,Pt.en)(),(0,Pt.G)(),(0,Lt.U)(),(0,Pt.At)(),(0,Tt.kt)(),(0,Tt.Tn)(),(0,Wt.W)(),(0,Wt.ot)(),(0,Tt.qn)(),(0,Rt.oA)(),(0,Rt.zk)(),(0,Rt.mE)(vo);var Lo=xo=class extends co{constructor(e,t,i,o){super(),this.model=e,this.element=t,this.options=i,this._instantiationService=o,this._disposables=new Rt.EA}dispose(){this._disposables.dispose()}equals(e){return e instanceof xo&&(this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons)}render(e){let{element:t,outline:i}=this.element;if(t===i){let t=(0,Rt.Zb)("span",void 0,"\u2026");return void e.appendChild(t)}let o=i.config.delegate.getTemplateId(t),s=i.config.renderers.find(e=>e.templateId===o);if(!s)return void(e.textContent="<<NO RENDERER>>");let r=s.renderTemplate(e);s.renderElement({element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,r,void 0),this.options.showSymbolIcons||(0,Rt.Kx)(r.iconClass),this._disposables.add((0,Rt.zA)(()=>{s.disposeTemplate(r)})),t instanceof Wt.rC&&i.uri&&this._disposables.add(this._instantiationService.invokeFunction(o=>Fo(o,e,t.symbol.name,{symbol:t.symbol,uri:i.uri},this.model,this.options.dragEditor)))}};Lo=xo=(0,Rt.Pb)([(0,Rt.Fb)(3,Rt.Ub)],Lo);var Wo=Vo=class extends co{constructor(e,t,i,o,s,r){super(),this.model=e,this.element=t,this.options=i,this._labels=o,this._hoverDelegate=s,this._instantiationService=r,this._disposables=new Rt.EA}dispose(){this._disposables.dispose()}equals(e){return e instanceof Vo&&(Rt.$w.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons)}render(e){let t=this._labels.create(e,{hoverDelegate:this._hoverDelegate});t.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===Rt.Ms.FOLDER||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add(Rt.Ms[this.element.kind].toLowerCase()),this._disposables.add(t),this._disposables.add(this._instantiationService.invokeFunction(t=>Fo(t,e,(0,Rt.Xw)(this.element.uri),this.element.uri,this.model,this.options.dragEditor)))}};function Fo(e,t,i,o,s,r){let n=e.get(Rt.Ub);return t.draggable=!0,new Rt.$b(t,{onDragStart:e=>{e.dataTransfer&&(e.dataTransfer.effectAllowed="copyMove",n.invokeFunction(t=>{var i;Rt.wD.isUri(o)?(0,Wt.U)(t,[o],e):((0,Wt.U)(t,[{resource:o.uri,selection:o.symbol.range}],e),(0,Wt.nh)([{name:o.symbol.name,fsPath:o.uri.fsPath,range:o.symbol.range,kind:o.symbol.kind}],e)),r&&(null===(i=s.editor)||void 0===i?void 0:i.input)&&Wt.eh.getInstance().setData([new Wt.B({editor:s.editor.input,groupId:s.editor.group.id})],Wt.B.prototype)}),(0,Rt.sa)(e,t,i))}})}Wo=Vo=(0,Rt.Pb)([(0,Rt.Fb)(5,Rt.Ub)],Wo);var Go=(0,Rt.J)("breadcrumb-separator",Rt.mD.chevronRight,(0,Rt.Ij)(3098,"Icon for the separator in the breadcrumbs.")),Zo=(c=class{get onDidVisibilityChange(){return this._onDidVisibilityChange.event}constructor(e,t,i,o,s,r,n,a,d,l,c,h){var u,g,p,b;this._options=t,this._editorGroup=i,this._contextKeyService=o,this._contextViewService=s,this._instantiationService=r,this._quickInputService=n,this._fileService=a,this._editorService=d,this._labelService=l,this._disposables=new Rt.EA,this._breadcrumbsDisposables=new Rt.EA,this._model=new Rt.OA,this._breadcrumbsPickerShowing=!1,this._onDidVisibilityChange=this._disposables.add(new Rt.uA),this.domNode=(0,Rt.gx)("div"),this.domNode.classList.add("breadcrumbs-control"),(0,Rt.dx)(e,this.domNode),this._cfUseQuickPick=go.UseQuickPick.bindTo(c),this._cfShowIcons=go.Icons.bindTo(c),this._cfTitleScrollbarSizing=go.TitleScrollbarSizing.bindTo(c),this._cfTitleScrollbarVisibility=go.TitleScrollbarVisibility.bindTo(c),this._labels=this._instantiationService.createInstance(Wt.at,Wt.rt);let m=null!==(u=this._cfTitleScrollbarSizing.getValue())&&void 0!==u?u:"default",v=null!==(g=t.widgetStyles)&&void 0!==g?g:Rt.bi,C=null!==(p=null===(b=this._cfTitleScrollbarVisibility)||void 0===b?void 0:b.getValue())&&void 0!==p?p:"auto";this._widget=new ho(this.domNode,Ro.SCROLLBAR_SIZES[m],Ro.SCROLLBAR_VISIBILITY[C],Go,v),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=Ro.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=Ro.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=Ro.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._hoverDelegate=(0,Rt.ua)("mouse"),this._disposables.add(h.register(this._editorGroup.id,this._widget)),this.hide()}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._model.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._cfTitleScrollbarSizing.dispose(),this._cfTitleScrollbarVisibility.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(e){this._widget.layout(e)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){let e=this.isHidden();this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0),e||this._onDidVisibilityChange.fire()}show(){let e=this.isHidden();this._ckBreadcrumbsVisible.set(!0),this.domNode.classList.toggle("hidden",!1),e&&this._onDidVisibilityChange.fire()}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();let e=Pt.Ht.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:Pt.Jt.PRIMARY}),t=this.isHidden();if(!e||!this._fileService.hasProvider(e))return this._ckBreadcrumbsPossible.set(!1),!t&&(this.hide(),!0);let i=Pt.Ht.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:Pt.Jt.PRIMARY});this.show(),this._ckBreadcrumbsPossible.set(!0);let o=this._instantiationService.createInstance(mo,null!==i&&void 0!==i?i:e,this._editorGroup.activeEditorPane);this._model.value=o,this.domNode.classList.toggle("backslash-path","\\"===this._labelService.getSeparator(e.scheme,e.authority));let s=()=>{this.domNode.classList.toggle("relative-path",o.isRelative());let e=this._cfShowIcons.getValue(),t=(0,xt.A)((0,xt.A)({},this._options),{},{showFileIcons:this._options.showFileIcons&&e,showSymbolIcons:this._options.showSymbolIcons&&e}),i=o.getElements().map(e=>e instanceof po?this._instantiationService.createInstance(Wo,o,e,t,this._labels,this._hoverDelegate):this._instantiationService.createInstance(Lo,o,e,t));0===i.length?(this._widget.setEnabled(!1),this._widget.setItems([new class extends co{render(e){e.textContent=(0,Rt.Ij)(3102,"no elements")}equals(e){return e===this}dispose(){}}])):(this._widget.setEnabled(!0),this._widget.setItems(i),this._widget.reveal(i[i.length-1]))},r=o.onDidUpdate(s),n=this._cfShowIcons.onDidChange(s);s(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(r),this._breadcrumbsDisposables.add((0,Rt.zA)(()=>this._model.clear())),this._breadcrumbsDisposables.add(n),this._breadcrumbsDisposables.add((0,Rt.zA)(()=>this._widget.setItems([])));let a=()=>{var e,t,i;let o=null!==(e=this._cfTitleScrollbarSizing.getValue())&&void 0!==e?e:"default",s=null!==(t=null===(i=this._cfTitleScrollbarVisibility)||void 0===i?void 0:i.getValue())&&void 0!==t?t:"auto";this._widget.setHorizontalScrollbarSize(Ro.SCROLLBAR_SIZES[o]),this._widget.setHorizontalScrollbarVisibility(Ro.SCROLLBAR_VISIBILITY[s])};a();let d=this._cfTitleScrollbarSizing.onDidChange(a),l=this._cfTitleScrollbarVisibility.onDidChange(a);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add(l),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),t!==this.isHidden()}_onFocusEvent(e){e.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(e.item))}_onSelectEvent(e){if(!e.item)return;if(e.item===this._breadcrumbsPickerIgnoreOnceItem)return this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),void this._widget.setSelection(void 0);let{element:t}=e.item;this._editorGroup.focus();let i,o,s=this._getEditorGroup(e.payload);return void 0!==s?(this._widget.setFocused(void 0),this._widget.setSelection(void 0),void this._revealInEditor(e,t,s)):this._cfUseQuickPick.getValue()?(this._widget.setFocused(void 0),this._widget.setSelection(void 0),void this._quickInputService.quickAccess.show(t instanceof bo?"@":"")):void this._contextViewService.showContextView({render:t=>{e.item instanceof Wo?i=this._instantiationService.createInstance(Ao,t,e.item.model.resource):e.item instanceof Lo&&(i=this._instantiationService.createInstance(To,t,e.item.model.resource));let o=i.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),s=Lt.bo.getInstance((0,Rt.Bx)(this.domNode)).onDidChange(()=>this._contextViewService.hideContextView({source:this})),r=(0,Rt.AS)(t),n=r.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?e.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),(0,Rt.jA)(i,o,s,r,n)},getAnchor:()=>{if(!o){let s,r=(0,Rt.Bx)(this.domNode),n=r.innerWidth-8,a=Math.min(.7*r.innerHeight,300),d=Math.min(n,Math.max(240,n/4.17)),l=(0,Rt.jx)(e.node.firstChild),c=l.top+l.height+8;c+a>=r.innerHeight&&(a=r.innerHeight-c-30);let h=l.left;if(h+d>=n&&(h=n-d),e.payload instanceof Rt.NT){let t=d-16;s=e.payload.posx-h,s>t&&(h=Math.min(n-d,h+s-t),s=t)}else s=l.left+.3*l.width-h;i.show(t,a,d,8,Math.max(0,s)),o={x:h,y:c}}return o},onHide:e=>{null!==e&&void 0!==e&&e.didPick||i.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),(null===e||void 0===e?void 0:e.source)===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),i.dispose()}})}_updateCkBreadcrumbsActive(){let e=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(e)}async _revealInEditor(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t instanceof po)if(t.kind===Rt.Ms.FILE)await this._editorService.openEditor({resource:t.uri,options:{pinned:o}},i);else{let t=this._widget.getItems(),i=t.indexOf(e.item);this._widget.setFocused(t[i+1]),this._widget.setSelection(t[i+1],Ro.Payload_Pick)}else t.outline.reveal(t,{pinned:o},-2===i,!1)}_getEditorGroup(e){return e===Ro.Payload_RevealAside?-2:e===Ro.Payload_Reveal?-1:void 0}},{_:Ro=c},{_:c.HEIGHT=22},{_:c.SCROLLBAR_SIZES={default:3,large:8}},{_:c.SCROLLBAR_VISIBILITY={auto:Rt.aA.Auto,visible:Rt.aA.Visible,hidden:Rt.aA.Hidden}},{_:c.Payload_Reveal={}},{_:c.Payload_RevealAside={}},{_:c.Payload_Pick={}},{_:c.CK_BreadcrumbsPossible=new Rt.FO("breadcrumbsPossible",!1,(0,Rt.Ij)(3099,"Whether the editor can show breadcrumbs"))},{_:c.CK_BreadcrumbsVisible=new Rt.FO("breadcrumbsVisible",!1,(0,Rt.Ij)(3100,"Whether breadcrumbs are currently visible"))},{_:c.CK_BreadcrumbsActive=new Rt.FO("breadcrumbsActive",!1,(0,Rt.Ij)(3101,"Whether breadcrumbs have focus"))},c);Zo=Ro=(0,Rt.Pb)([(0,Rt.Fb)(3,Rt.yb),(0,Rt.Fb)(4,Rt.Cl),(0,Rt.Fb)(5,Rt.Ub),(0,Rt.Fb)(6,Rt.xc),(0,Rt.Fb)(7,Rt.ys),(0,Rt.Fb)(8,Pt.kt),(0,Rt.Fb)(9,Rt.Ya),(0,Rt.Fb)(10,Rt.o_),(0,Rt.Fb)(11,Tt.Kn)],Zo);var No=class{get control(){return this._control}get onDidEnablementChange(){return this._onDidEnablementChange.event}get onDidVisibilityChange(){return this._onDidVisibilityChange.event}constructor(e,t,i,o,s,r){this._container=e,this._editorGroup=t,this._options=i,this._instantiationService=s,this._disposables=new Rt.EA,this._controlDisposables=new Rt.EA,this._onDidEnablementChange=this._disposables.add(new Rt.uA),this._onDidVisibilityChange=this._disposables.add(new Rt.uA);let n=this._disposables.add(go.IsEnabled.bindTo(o));this._disposables.add(n.onDidChange(()=>{let e=n.getValue();!e&&this._control?(this._controlDisposables.clear(),this._control=void 0,this._onDidEnablementChange.fire()):e&&!this._control&&(this._control=this.createControl(),this._control.update(),this._onDidEnablementChange.fire())})),n.getValue()&&(this._control=this.createControl()),this._disposables.add(r.onDidChangeFileSystemProviderRegistrations(e=>{var t,i;(null===(t=this._control)||void 0===t?void 0:t.model)&&this._control.model.resource.scheme!==e.scheme||(null===(i=this._control)||void 0===i?void 0:i.update())&&this._onDidEnablementChange.fire()}))}createControl(){let e=this._controlDisposables.add(this._instantiationService.createInstance(Zo,this._container,this._options,this._editorGroup));return this._controlDisposables.add(e.onDidVisibilityChange(()=>this._onDidVisibilityChange.fire())),e}dispose(){this._disposables.dispose(),this._controlDisposables.dispose()}};function Po(e,t){let i=e.get(Pt.W),o=e.get(Tt.Kn).getWidget(i.activeGroup.id);if(o){let e=o.getItems().at(-1);o.setFocused(e),t&&o.setSelection(e,Zo.Payload_Pick)}}No=(0,Rt.Pb)([(0,Rt.Fb)(3,Rt.o_),(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.ys)],No),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"breadcrumbs.toggle",title:(0,Rt.Lj)(3103,"Toggle Breadcrumbs"),shortTitle:(0,Rt.Lj)(3104,"Breadcrumbs"),category:Mt.s.View,toggled:{condition:Rt.PO.equals("config.breadcrumbs.enabled",!0),title:(0,Rt.Ij)(3105,"Breadcrumbs"),mnemonicTitle:(0,Rt.Ij)(3106,"&&Breadcrumbs")},menu:[{id:Rt.sb.CommandPalette},{id:Rt.sb.MenubarAppearanceMenu,group:"4_editor",order:2},{id:Rt.sb.NotebookToolbar,group:"notebookLayout",order:2},{id:Rt.sb.StickyScrollContext},{id:Rt.sb.NotebookStickyScrollContext,group:"notebookView",order:2},{id:Rt.sb.NotebookToolbarContext,group:"notebookView",order:2}]})}run(e){let t=e.get(Rt.o_),i=go.IsEnabled.bindTo(t),o=i.getValue();i.updateValue(!o),i.dispose()}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"breadcrumbs.focusAndSelect",title:(0,Rt.Lj)(3107,"Focus and Select Breadcrumbs"),precondition:Zo.CK_BreadcrumbsVisible,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Period,when:Zo.CK_BreadcrumbsPossible},f1:!0})}run(e){Po(e,!0)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"breadcrumbs.focus",title:(0,Rt.Lj)(3108,"Focus Breadcrumbs"),precondition:Zo.CK_BreadcrumbsVisible,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Semicolon,when:Zo.CK_BreadcrumbsPossible},f1:!0})}run(e){Po(e,!1)}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Period,when:Rt.PO.not("config.breadcrumbs.enabled"),handler:async e=>{let t=e.get(Rt.Ub),i=e.get(Rt.o_),o=go.IsEnabled.bindTo(i);return o.getValue()||(await o.updateValue(!0),await(0,Rt.Gw)(50)),o.dispose(),t.invokeFunction(Po,!0)}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:Rt.mb.WorkbenchContrib,primary:Rt.YD.RightArrow,secondary:[Rt.ZD.CtrlCmd|Rt.YD.RightArrow],mac:{primary:Rt.YD.RightArrow,secondary:[Rt.ZD.Alt|Rt.YD.RightArrow]},when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive),handler(e){let t=e.get(Pt.W),i=e.get(Tt.Kn).getWidget(t.activeGroup.id);i&&i.focusNext()}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:Rt.mb.WorkbenchContrib,primary:Rt.YD.LeftArrow,secondary:[Rt.ZD.CtrlCmd|Rt.YD.LeftArrow],mac:{primary:Rt.YD.LeftArrow,secondary:[Rt.ZD.Alt|Rt.YD.LeftArrow]},when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive),handler(e){let t=e.get(Pt.W),i=e.get(Tt.Kn).getWidget(t.activeGroup.id);i&&i.focusPrev()}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:Rt.mb.WorkbenchContrib+1,primary:Rt.ZD.CtrlCmd|Rt.YD.RightArrow,mac:{primary:Rt.ZD.Alt|Rt.YD.RightArrow},when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive,Rt.st),handler(e){let t=e.get(Pt.W),i=e.get(Tt.Kn).getWidget(t.activeGroup.id);i&&i.focusNext()}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:Rt.mb.WorkbenchContrib+1,primary:Rt.ZD.CtrlCmd|Rt.YD.LeftArrow,mac:{primary:Rt.ZD.Alt|Rt.YD.LeftArrow},when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive,Rt.st),handler(e){let t=e.get(Pt.W),i=e.get(Tt.Kn).getWidget(t.activeGroup.id);i&&i.focusPrev()}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:Rt.mb.WorkbenchContrib,primary:Rt.YD.Enter,secondary:[Rt.YD.DownArrow],when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive),handler(e){let t=e.get(Pt.W),i=e.get(Tt.Kn).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),Zo.Payload_Pick)}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:Rt.mb.WorkbenchContrib,primary:Rt.YD.Space,secondary:[Rt.ZD.CtrlCmd|Rt.YD.Enter],when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive),handler(e){let t=e.get(Pt.W),i=e.get(Tt.Kn).getWidget(t.activeGroup.id);i&&i.setSelection(i.getFocused(),Zo.Payload_Reveal)}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:Rt.mb.WorkbenchContrib+1,primary:Rt.YD.Escape,when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive),handler(e){var t;let i=e.get(Pt.W),o=e.get(Tt.Kn).getWidget(i.activeGroup.id);o&&(o.setFocused(void 0),o.setSelection(void 0),null===(t=i.activeGroup.activeEditorPane)||void 0===t||t.focus())}}),Rt.hb.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.Enter,when:Rt.PO.and(Zo.CK_BreadcrumbsVisible,Zo.CK_BreadcrumbsActive,Rt.st),handler(e){let t=e.get(Pt.kt),i=e.get(Rt.wt).lastFocusedList;if(!(i instanceof Rt.at)&&!(i instanceof Rt.it))return;let o=i.getFocus()[0];if(Rt.wD.isUri(null===o||void 0===o?void 0:o.resource))return t.openEditor({resource:o.resource,options:{pinned:!0}},-2);let s=i.getInput();return s&&"string"==typeof s.outlineKind?s.reveal(o,{pinned:!0,preserveFocus:!1},!0,!1):void 0}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"breadcrumbs.copyPath",title:(0,Rt.Lj)(3109,"Copy Breadcrumbs Path"),category:Mt.s.View,precondition:Zo.CK_BreadcrumbsVisible,f1:!0,menu:[{id:Rt.sb.EditorTitleContext,group:"1_cutcopypaste",order:100,when:Zo.CK_BreadcrumbsPossible}]})}async run(e){var t;let i=e.get(Pt.W),o=e.get(Rt.C),s=e.get(Rt.o_),r=e.get(Tt.wn);if(!i.activeGroup.activeEditorPane)return;let n=await r.createOutline(i.activeGroup.activeEditorPane,Tt.Ot.Breadcrumbs,Rt.Ik.None);if(!n)return;let a=n.config.breadcrumbsDataSource.getBreadcrumbElements().map(e=>e.label).filter(Boolean);if(n.dispose(),0===a.length)return;let d=i.activeGroup.activeEditorPane.input.resource,l=go.SymbolPathSeparator.bindTo(s),c=null!==(t=l.getValue(d&&{resource:d}))&&void 0!==t?t:".";l.dispose();let h=a.join(c);await o.writeText(h)}});var Jo,Bo,Oo;(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.mr)(),(0,Tt.Rt)(),(0,Pt.Q)(),(0,Pt.G)(),(0,Pt.en)(),(0,Pt.At)(),(0,Rt.Bb)(),(0,Rt.lv)(),(0,Mt.o)(),(0,Tt.jt)(),(0,Rt.gD)(),(0,Rt.Db)(),(0,Rt.mE)({});var Ko=class extends Tt.It{constructor(e,t,i,o,s){super(e,{canAcceptInBackground:!0,noResultsPick:{label:(0,Rt.Ij)(3439,"No matching editors"),groupId:-1}}),this.editorGroupService=t,this.editorService=i,this.modelService=o,this.languageService=s,this.pickState=new class{constructor(){this.scorerCache=Object.create(null),this.isQuickNavigating=void 0}reset(e){e||(this.scorerCache=Object.create(null)),this.isQuickNavigating=e}}}provide(e,t){return this.pickState.reset(!!e.quickNavigate),super.provide(e,t)}_getPicks(e){let t=(0,Tt.Mt)(e),i=this.doGetEditorPickItems().filter(e=>{if(!t.normalized)return!0;let i=(0,Tt.Nt)(e,t,!0,Rt.hr,this.pickState.scorerCache);return!!i.score&&(e.highlights={label:i.labelMatch,description:i.descriptionMatch},!0)});if(t.normalized){let e=this.editorGroupService.getGroups(Pt.X.GRID_APPEARANCE).map(e=>e.id);i.sort((i,o)=>i.groupId===o.groupId?(0,Tt.At)(i,o,t,!0,Rt.hr,this.pickState.scorerCache):e.indexOf(i.groupId)-e.indexOf(o.groupId))}let o=[];if(this.editorGroupService.count>1){let e;for(let t of i){if("number"!=typeof e||e!==t.groupId){let i=this.editorGroupService.getGroup(t.groupId);i&&o.push({type:"separator",label:i.label}),e=t.groupId}o.push(t)}}else o.push(...i);return o}doGetEditorPickItems(){let e=this.doGetEditors(),t=new Map;for(let{groupId:i}of e)if(!t.has(i)){let e=this.editorGroupService.getGroup(i);e&&t.set(i,e.ariaLabel)}return this.doGetEditors().map(e=>{var i;let{editor:o,groupId:s}=e,r=Pt.Ht.getOriginalUri(o,{supportSideBySide:Pt.Jt.PRIMARY}),n=o.isDirty()&&!o.isSaving(),a=o.getDescription(),d=a?"".concat(o.getName()," ").concat(a):o.getName();return{groupId:s,resource:r,label:o.getName(),ariaLabel:t.size>1?n?(0,Rt.Ij)(3440,"{0}, unsaved changes, {1}",d,t.get(s)):(0,Rt.Ij)(3441,"{0}, {1}",d,t.get(s)):n?(0,Rt.Ij)(3442,"{0}, unsaved changes",d):d,description:a,iconClasses:(0,Mt.i)(this.modelService,this.languageService,r,void 0,o.getIcon()).concat(o.getLabelExtraClasses()),italic:!(null!==(i=this.editorGroupService.getGroup(s))&&void 0!==i&&i.isPinned(o)),buttons:[{iconClass:n?"dirty-editor "+Rt.Eb.asClassName(Rt.mD.closeDirty):Rt.Eb.asClassName(Rt.mD.close),tooltip:(0,Rt.Ij)(3443,"Close Editor"),alwaysVisible:n}],trigger:async()=>{let e=this.editorGroupService.getGroup(s);return e&&(await e.closeEditor(o,{preserveFocus:!0}),!e.contains(o))?Tt.Lt.REMOVE_ITEM:Tt.Lt.NO_ACTION},accept:(e,t)=>{var i;return null===(i=this.editorGroupService.getGroup(s))||void 0===i?void 0:i.openEditor(o,{preserveFocus:t.inBackground})}}})}};Ko=(0,Rt.Pb)([(0,Rt.Fb)(1,Pt.W),(0,Rt.Fb)(2,Pt.kt),(0,Rt.Fb)(3,Rt.zb),(0,Rt.Fb)(4,Rt.cv)],Ko);var Mo=(h=class extends Ko{constructor(e,t,i,o){super(Jo.PREFIX,e,t,i,o)}doGetEditors(){let e=this.editorGroupService.activeGroup;return e.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE).map(t=>({editor:t,groupId:e.id}))}},{_:Jo=h},{_:h.PREFIX="edt active "},h);Mo=Jo=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.W),(0,Rt.Fb)(1,Pt.kt),(0,Rt.Fb)(2,Rt.zb),(0,Rt.Fb)(3,Rt.cv)],Mo);var jo=(u=class extends Ko{constructor(e,t,i,o){super(Bo.PREFIX,e,t,i,o)}doGetEditors(){let e=[];for(let t of this.editorGroupService.getGroups(Pt.X.GRID_APPEARANCE))for(let i of t.getEditors(Pt.Ut.SEQUENTIAL))e.push({editor:i,groupId:t.id});return e}},{_:Bo=u},{_:u.PREFIX="edt "},u);jo=Bo=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.W),(0,Rt.Fb)(1,Pt.kt),(0,Rt.Fb)(2,Rt.zb),(0,Rt.Fb)(3,Rt.cv)],jo);var Qo=(g=class extends Ko{constructor(e,t,i,o){super(Oo.PREFIX,e,t,i,o)}doGetEditors(){let e=[];for(let t of this.editorService.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE))e.push(t);return e}},{_:Oo=g},{_:g.PREFIX="edt mru "},g);Qo=Oo=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.W),(0,Rt.Fb)(1,Pt.kt),(0,Rt.Fb)(2,Rt.zb),(0,Rt.Fb)(3,Rt.cv)],Qo),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.qj)(),(0,Rt.gA)(),(0,Rt.nM)(),(0,Rt.PA)(),(0,Pt.en)(),(0,Tt.f)(),(0,Rt.Wo)(),(0,Rt.Kb)(),(0,Rt.ab)(),(0,Rt.$d)(),(0,Rt._v)(),(0,Pt.G)(),(0,Pt.At)(),(0,Rt.$p)(),(0,Rt.bs)();var Yo,Ho=(p=class extends zt.s{constructor(e,t,i,o,s,r,n,a,d,l){super(e,t,Yo.VIEW_STATE_PREFERENCE_KEY,i,o,s,r,n,a,d),this.fileService=l,this._onDidChangeSelection=this._register(new Rt.uA),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeScroll=this._register(new Rt.uA),this.onDidChangeScroll=this._onDidChangeScroll.event,this.inputListener=this._register(new Rt.OA),this._register(this.textResourceConfigurationService.onDidChangeConfiguration(e=>this.handleConfigurationChangeEvent(e))),this._register(Rt.dA.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{var e;let t=this.computeAriaLabel();null!==(e=this.editorContainer)&&void 0!==e&&e.setAttribute("aria-label",t),this.updateEditorControlOptions({ariaLabel:t})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(e=>this.onDidChangeFileSystemProvider(e.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(e=>this.onDidChangeFileSystemProvider(e.scheme)))}handleConfigurationChangeEvent(e){let t=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(e,t)&&(this.isVisible()?this.updateEditorConfiguration(t):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(e,t){return e.affectsConfiguration(t,"editor")||e.affectsConfiguration(t,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.hasPendingConfigurationChange=(this.updateEditorConfiguration(),!1))}computeConfiguration(e){let t=(0,Rt.lM)(e.editor)?(0,Rt.Hj)(e.editor):Object.create(null);return Object.assign(t,this.getConfigurationOverrides(e)),t.ariaLabel=this.computeAriaLabel(),t}computeAriaLabel(){return this.input?(0,Tt.d)(this.input,void 0,this.group,this.editorGroupService.count):(0,Rt.Ij)(3512,"Editor")}onDidChangeFileSystemProvider(e){var t;this.input&&(null===(t=this.getActiveResource())||void 0===t?void 0:t.scheme)===e&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(e){this.input===e&&this.updateReadonly(e)}updateReadonly(e){this.updateEditorControlOptions((0,xt.A)({},this.getReadonlyConfiguration(e.isReadonly())))}getReadonlyConfiguration(e){return{readOnly:!!e,readOnlyMessage:"boolean"==typeof e?void 0:e}}getConfigurationOverrides(e){var t,i;return(0,xt.A)((0,xt.A)({overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0},this.getReadonlyConfiguration(null===(t=this.input)||void 0===t?void 0:t.isReadonly())),{},{renderValidationDecorations:!1===(null===(i=e.problems)||void 0===i?void 0:i.visibility)?"off":"on"})}createEditor(e){this.editorContainer=e,this.createEditorControl(e,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){let e=this.getMainControl();e&&(this._register(e.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeCursorPosition(e=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(e)}))),this._register(e.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:Pt.Bt.EDIT}))),this._register(e.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(e){switch(e.source){case Rt.Qp.PROGRAMMATIC:return Pt.Bt.PROGRAMMATIC;case Rt.Qp.NAVIGATION:return Pt.Bt.NAVIGATION;case Rt.Qp.JUMP:return Pt.Bt.JUMP;default:return Pt.Bt.USER}}getSelection(){let e=this.getMainControl();if(e){let t=e.getSelection();if(t)return new Xo(t)}}async setInput(e,t,i,o){await super.setInput(e,t,i,o),this.inputListener.value=e.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(e)),this.updateEditorConfiguration(),(0,Rt.$j)(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){let e=this.getMainControl();if(!e)throw Error("Control has not yet been initialized");return{scrollTop:e.getScrollTop()-e.getTopForLineNumber(1),scrollLeft:e.getScrollLeft()}}setScrollPosition(e){let t=this.getMainControl();if(!t)throw Error("Control has not yet been initialized");t.setScrollTop(e.scrollTop),e.scrollLeft&&t.setScrollLeft(e.scrollLeft)}setEditorVisible(e){e&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(e)}toEditorViewStateResource(e){return e.resource}updateEditorConfiguration(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getActiveResource();if(t&&(e=this.textResourceConfigurationService.getValue(t)),!e)return;let i=this.computeConfiguration(e),o=i;this.lastAppliedEditorOptions&&(o=(0,Rt.Wj)(this.lastAppliedEditorOptions,o)),Object.keys(o).length>0&&(this.lastAppliedEditorOptions=i,this.updateEditorControlOptions(o))}getActiveResource(){let e=this.getMainControl();if(e){let t=e.getModel();if(t)return t.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}},{_:Yo=p},{_:p.VIEW_STATE_PREFERENCE_KEY="textEditorViewState"},p);Ho=Yo=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.ib),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Rt.Uo),(0,Rt.Fb)(5,Rt.hv),(0,Rt.Fb)(6,Rt.Qd),(0,Rt.Fb)(7,Pt.kt),(0,Rt.Fb)(8,Pt.W),(0,Rt.Fb)(9,Rt.ys)],Ho);var Xo=(b=class e{constructor(e){this.textSelection=e}compare(t){if(!(t instanceof e))return Pt.Vt.DIFFERENT;let i=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),o=Math.min(t.textSelection.selectionStartLineNumber,t.textSelection.positionLineNumber);return i===o?Pt.Vt.IDENTICAL:Math.abs(i-o)<e.TEXT_EDITOR_SELECTION_THRESHOLD?Pt.Vt.SIMILAR:Pt.Vt.DIFFERENT}restore(e){return(0,xt.A)((0,xt.A)({},e),{},{selection:this.textSelection,selectionRevealType:Rt.Zp.CenterIfOutsideViewport})}log(){return"line: ".concat(this.textSelection.startLineNumber,"-").concat(this.textSelection.endLineNumber,", col:  ").concat(this.textSelection.startColumn,"-").concat(this.textSelection.endColumn)}},{_:b.TEXT_EDITOR_SELECTION_THRESHOLD=10},b);(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.qj)(),(0,Rt.nM)(),(0,Pt.en)(),(0,Zt.h)(),(0,Pt.it)(),(0,Pt._t)(),(0,Rt.ab)(),(0,Rt.Wo)(),(0,Rt._v)(),(0,Rt.Kb)(),(0,Rt.$d)(),(0,Pt.h)(),(0,Rt.pv)(),(0,Rt.vb)(),(0,Rt.TD)(),(0,Pt.G)(),(0,Pt.At)(),(0,Rt.$p)(),(0,Rt.bb)(),(0,Rt.iT)(),(0,Rt.ok)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,jt.i)(),(0,Rt.yA)(),(0,Zt.w)();var Uo,zo=(m=class extends Ho{get scopedContextKeyService(){if(!this.diffEditorControl)return;let e=this.diffEditorControl.getOriginalEditor(),t=this.diffEditorControl.getModifiedEditor();return(e.hasTextFocus()?e:t).invokeWithinContext(e=>e.get(Rt.yb))}constructor(e,t,i,o,s,r,n,a,d,l){super(Uo.ID,e,t,i,o,s,n,r,a,d),this.preferencesService=l,this.diffEditorControl=void 0,this.inputLifecycleStopWatch=void 0,this._previousViewModel=null}getTitle(){return this.input?this.input.getName():(0,Rt.Ij)(3509,"Text Diff Editor")}createEditorControl(e,t){this.diffEditorControl=this._register(this.instantiationService.createInstance(Zt.C,e,t,{}))}updateEditorControlOptions(e){var t;null===(t=this.diffEditorControl)||void 0===t||t.updateOptions(e)}getMainControl(){var e;return null===(e=this.diffEditorControl)||void 0===e?void 0:e.getModifiedEditor()}async setInput(e,t,i,o){this._previousViewModel&&(this._previousViewModel=(this._previousViewModel.dispose(),null)),this.inputLifecycleStopWatch=void 0,await super.setInput(e,t,i,o);try{var s,r;let n=await e.resolve();if(o.isCancellationRequested)return;if(!(n instanceof Pt.gt))return void this.openAsBinary(e,t);let a=(0,Rt.$j)(this.diffEditorControl),d=n,l=d.textDiffEditorModel?a.createViewModel(d.textDiffEditorModel):null;this._previousViewModel=l,await(null===l||void 0===l?void 0:l.waitForDiff()),a.setModel(l);let c=!1;(0,Pt.hn)(null===t||void 0===t?void 0:t.viewState)||(c=this.restoreTextDiffEditorViewState(e,t,i,a));let h=!1;t&&(h=(0,Zt.m)(t,a,Rt.fv.Immediate)),!h&&!c&&a.revealFirstDiff(),a.updateOptions((0,xt.A)((0,xt.A)({},this.getReadonlyConfiguration(null===(s=d.modifiedModel)||void 0===s?void 0:s.isReadonly())),{},{originalEditable:!(null!==(r=d.originalModel)&&void 0!==r&&r.isReadonly())})),a.handleInitialized(),this.inputLifecycleStopWatch=new Rt.vA(!1)}catch(i){await this.handleSetInputError(i,e,t)}}async handleSetInputError(e,t,i){if(this.isFileBinaryError(e))return this.openAsBinary(t,i);if(e.fileOperationResult===Rt.Is.FILE_TOO_LARGE){let o;throw o=e instanceof Rt.Ws?(0,Rt.Ij)(3510,"At least one file is not displayed in the text compare editor because it is very large ({0}).",Rt.Ss.formatSize(e.size)):(0,Rt.Ij)(3511,"At least one file is not displayed in the text compare editor because it is very large."),(0,Pt.Qt)(this.group,t,i,o,this.preferencesService)}throw e}restoreTextDiffEditorViewState(e,t,i,o){let s=this.loadEditorViewState(e,i);return!!s&&(null!==t&&void 0!==t&&t.selection&&s.modified&&(s.modified.cursorState=[]),o.restoreViewState(s),null!==t&&void 0!==t&&t.revealIfVisible&&o.revealFirstDiff(),!0)}openAsBinary(e,t){let i=e.original,o=e.modified,s=this.instantiationService.createInstance(Pt.nt,e.getName(),e.getDescription(),i,o,!0),r=Rt._b.as(Pt.Rt.EditorFactory).getFileEditorFactory();r.isFileEditor(i)&&i.setForceOpenAsBinary(),r.isFileEditor(o)&&o.setForceOpenAsBinary(),this.group.replaceEditors([{editor:e,replacement:s,options:(0,xt.A)((0,xt.A)({},t),{},{activation:Rt.Jp.PRESERVE,pinned:this.group.isPinned(e),sticky:this.group.isSticky(e)})}])}setOptions(e){super.setOptions(e),e&&(0,Zt.m)(e,(0,Rt.$j)(this.diffEditorControl),Rt.fv.Smooth)}shouldHandleConfigurationChangeEvent(e,t){return!!super.shouldHandleConfigurationChangeEvent(e,t)||(e.affectsConfiguration(t,"diffEditor")||e.affectsConfiguration(t,"accessibility.verbosity.diffEditor"))}computeConfiguration(e){var t,i;let o=super.computeConfiguration(e);if((0,Rt.lM)(e.diffEditor)){let t=(0,Rt.Hj)(e.diffEditor);t.diffCodeLens=t.codeLens,delete t.codeLens,t.diffWordWrap=t.wordWrap,delete t.wordWrap,Object.assign(o,t)}return o.accessibilityVerbose=null!==(t=null===(i=e.accessibility)||void 0===i||null===(i=i.verbosity)||void 0===i?void 0:i.diffEditor)&&void 0!==t&&t,o}getConfigurationOverrides(e){var t;return(0,xt.A)((0,xt.A)((0,xt.A)({},super.getConfigurationOverrides(e)),this.getReadonlyConfiguration(null===(t=this.input)||void 0===t?void 0:t.isReadonly())),{},{originalEditable:this.input instanceof Pt.nt&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"})}updateReadonly(e){var t;e instanceof Pt.nt?null===(t=this.diffEditorControl)||void 0===t||t.updateOptions((0,xt.A)((0,xt.A)({},this.getReadonlyConfiguration(e.isReadonly())),{},{originalEditable:!e.original.isReadonly()})):super.updateReadonly(e)}isFileBinaryError(e){return Array.isArray(e)?e.some(e=>this.isFileBinaryError(e)):e.textFileOperationResult===Pt.p.FILE_IS_BINARY}clearInput(){var e,t,i;this._previousViewModel&&(this._previousViewModel=(this._previousViewModel.dispose(),null)),super.clearInput();let o=null===(e=this.inputLifecycleStopWatch)||void 0===e?void 0:e.elapsed();this.inputLifecycleStopWatch=void 0,"number"==typeof o&&this.logInputLifecycleTelemetry(o,null===(t=this.getControl())||void 0===t||null===(t=t.getModel())||void 0===t||null===(t=t.modified)||void 0===t?void 0:t.getLanguageId()),null===(i=this.diffEditorControl)||void 0===i||i.setModel(null)}logInputLifecycleTelemetry(e,t){let i=!1;this.diffEditorControl instanceof Zt.C&&(i=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:e,languageId:null!==t&&void 0!==t?t:"",collapseUnchangedRegions:i})}getControl(){return this.diffEditorControl}focus(){var e;super.focus(),null===(e=this.diffEditorControl)||void 0===e||e.focus()}hasFocus(){var e;return(null===(e=this.diffEditorControl)||void 0===e?void 0:e.hasTextFocus())||super.hasFocus()}setEditorVisible(e){var t,i;super.setEditorVisible(e),e?null===(t=this.diffEditorControl)||void 0===t||t.onVisible():null===(i=this.diffEditorControl)||void 0===i||i.onHide()}layout(e){var t;null===(t=this.diffEditorControl)||void 0===t||t.layout(e)}setBoundarySashes(e){var t;null===(t=this.diffEditorControl)||void 0===t||t.setBoundarySashes(e)}tracksEditorViewState(e){return e instanceof Pt.nt}computeEditorViewState(e){var t;if(!this.diffEditorControl)return;let i=this.diffEditorControl.getModel();if(null===i||void 0===i||!i.modified||!i.original)return;let o=this.toEditorViewStateResource(i);return o&&(0,Rt.oT)(o,e)&&null!==(t=this.diffEditorControl.saveViewState())&&void 0!==t?t:void 0}toEditorViewStateResource(e){let t,i;if(e instanceof Pt.nt?(t=e.original.resource,i=e.modified.resource):(0,Pt.rn)(e)||(t=e.original.uri,i=e.modified.uri),t&&i)return Rt.wD.from({scheme:"diff",path:"".concat((0,Rt.vk)(t.toString())).concat((0,Rt.vk)(i.toString()))})}},{_:Uo=m},{_:m.ID=Pt.Yt},m);zo=Uo=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Rt.Uo),(0,Rt.Fb)(4,Rt.hv),(0,Rt.Fb)(5,Pt.kt),(0,Rt.Fb)(6,Rt.Qd),(0,Rt.Fb)(7,Pt.W),(0,Rt.Fb)(8,Rt.ys),(0,Rt.Fb)(9,jt.r)],zo),(0,Rt.tO)(),(0,Rt.iT)(),(0,Rt.TD)(),(0,Rt._v)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.IO)(),(0,Rt.gb)(),(0,Nt.ir)(),(0,Pt.it)(),(0,Pt.At)(),(0,Lt.Ki)(),(0,Pt.G)(),(0,Gt.o)();var qo="toggle.diff.renderSideBySide",$o="workbench.action.compareEditor.nextChange",es="workbench.action.compareEditor.previousChange",ts="workbench.action.compareEditor.focusPrimarySide",is="workbench.action.compareEditor.focusSecondarySide",os="workbench.action.compareEditor.focusOtherSide",ss="workbench.action.compareEditor.openSide",rs="toggle.diff.ignoreTrimWhitespace",ns="workbench.action.compareEditor.swapSides";(0,Rt.tO)(),(0,Rt.yT)(),(0,Rt.iT)(),(0,Rt.nM)(),(0,Rt.TD)(),(0,Lt.Ki)(),(0,Rt.Fj)(),(0,Mt.c)(),(0,Rt.db)(),(0,Rt.Sb)(),(0,Rt.wb)(),(0,Rt.s_)(),(0,Rt.IO)(),(0,Rt.$p)(),(0,Rt.Kb)(),(0,Rt.gb)(),(0,Rt.Tt)(),(0,Rt.br)(),(0,Rt.Sc)(),(0,Rt.ab)(),(0,Nt.ir)(),(0,Pt.en)(),(0,Pt.Ot)(),(0,Wt.ha)(),(0,Pt.Q)(),(0,Pt.G)(),(0,Lt.L)(),(0,Lt.U)(),(0,Pt.At)(),(0,Pt.j)(),(0,Pt.T)(),(0,Lt.Z)();var as,ds="workbench.action.closeUnmodifiedEditors",ls="workbench.action.closeEditorsInGroup",cs="workbench.action.closeEditorsAndGroup",hs="workbench.action.closeEditorsToTheRight",us="workbench.action.closeActiveEditor",gs="workbench.action.closeActivePinnedEditor",ps="workbench.action.closeGroup",bs="workbench.action.closeOtherEditors",ms="moveActiveEditor",vs="copyActiveEditor",Cs="layoutEditorGroups",ws="workbench.action.keepEditor",ys="workbench.action.toggleKeepEditors",fs="workbench.action.toggleEditorGroupLock",Ss="workbench.action.lockEditorGroup",Is="workbench.action.unlockEditorGroup",ks="workbench.action.showEditorsInGroup",_s="workbench.action.reopenWithEditor",Es="workbench.action.pinEditor",As="workbench.action.unpinEditor",Ds="workbench.action.splitEditor",xs="workbench.action.splitEditorUp",Vs="workbench.action.splitEditorDown",Rs="workbench.action.splitEditorLeft",Ts="workbench.action.splitEditorRight",Ls="workbench.action.moveEditorToAboveGroup",Ws="workbench.action.moveEditorToBelowGroup",Fs="workbench.action.moveEditorToLeftGroup",Gs="workbench.action.moveEditorToRightGroup",Zs="workbench.action.toggleMaximizeEditorGroup",Ns="workbench.action.splitEditorInGroup",Ps="workbench.action.joinEditorInGroup",Js="workbench.action.toggleSplitEditorInGroupLayout",Bs="workbench.action.focusFirstSideEditor",Os="workbench.action.focusSecondSideEditor",Ks="workbench.action.openEditorAtIndex",Ms="workbench.action.moveEditorToNewWindow",js="workbench.action.copyEditorToNewWindow",Qs="workbench.action.moveEditorGroupToNewWindow",Ys="workbench.action.copyEditorGroupToNewWindow",Hs="workbench.action.newEmptyEditorWindow",Xs="_workbench.open",Us="_workbench.diff",zs=[Ds,us,As,Is,Zs],qs=function(e){return!(!(0,Rt.lM)(e)||!(0,Rt.uM)(e.to)||!(0,Rt.fM)(e.by)&&!(0,Rt.uM)(e.by)||!(0,Rt.fM)(e.value)&&!(0,Rt.cM)(e.value))};function $s(e,t,i){if(!i.groupedEditors.length)return;let{group:o,editors:s}=i.groupedEditors[0],r=i.preserveFocus,n=e.addGroup(o,t);for(let a of s)a&&!a.hasCapability(Pt.zt.Singleton)&&o.copyEditor(a,n,{preserveFocus:r});n.focus()}(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.ha)(),(0,Rt.qx)(),(0,Rt.FT)(),(0,Rt.zr)(),(0,Rt.Mb)(),(0,Rt.PA)(),(0,Rt.Xr)(),(0,Rt.db)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Rt.Kb)(),(0,Rt.Ad)(),(0,Rt.Rd)(),(0,Rt.Sc)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Wt.W)(),(0,Lt.c)(),(0,Pt.en)(),(0,Nt.ir)(),(0,Rt.ml)(),(0,Rt.nM)(),(0,Rt.eE)(),(0,Rt.xN)(),(0,Pt.Ot)(),(0,Lt.lr)(),(0,Wt.rh)(),(0,Lt.L)(),(0,Pt.Q)(),(0,Rt.mj)(),(0,Lt.F)(),(0,Rt.tu)(),(0,Rt.Ic)(),(0,Rt.ca)(),(0,Rt.mE)({});var er=class extends Rt.kb{constructor(e){super(),this.context=e}run(e,t){let i=this.context;return null!==t&&void 0!==t&&t.preserveFocus&&(i=(0,xt.A)((0,xt.A)({},this.context),{},{preserveFocus:!0})),super.run(e,i)}},tr=(v=class extends Rt.lp{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g){super(h),this.parent=e,this.editorPartsView=t,this.groupsView=i,this.groupView=o,this.tabsModel=s,this.contextMenuService=r,this.instantiationService=n,this.contextKeyService=a,this.keybindingService=d,this.notificationService=l,this.quickInputService=c,this.editorResolverService=u,this.hostService=g,this.editorTransfer=Wt.eh.getInstance(),this.groupTransfer=Wt.eh.getInstance(),this.treeItemsTransfer=Wt.eh.getInstance(),this.editorActionsToolbarDisposables=this._register(new Rt.EA),this.editorActionsDisposables=this._register(new Rt.EA),this.renderDropdownAsChildElement=!1;let p=this.create(e);this.contextMenuContextKeyService=this._register(this.contextKeyService.createScoped(p));let b=this._register(this.instantiationService.createChild(new Rt.eu([Rt.yb,this.contextMenuContextKeyService])));this.resourceContext=this._register(b.createInstance(Nt.Vn)),this.editorPinnedContext=Nt.in.bindTo(this.contextMenuContextKeyService),this.editorIsFirstContext=Nt.en.bindTo(this.contextMenuContextKeyService),this.editorIsLastContext=Nt.rn.bindTo(this.contextMenuContextKeyService),this.editorStickyContext=Nt.on.bindTo(this.contextMenuContextKeyService),this.editorAvailableEditorIds=Nt.Jt.bindTo(this.contextMenuContextKeyService),this.editorCanSplitInGroupContext=Nt.Xt.bindTo(this.contextMenuContextKeyService),this.sideBySideEditorContext=Nt.Wn.bindTo(this.contextMenuContextKeyService),this.groupLockedContext=Nt.nn.bindTo(this.contextMenuContextKeyService)}create(e){return this.updateTabHeight(),e}get editorActionsEnabled(){return"default"===this.groupsView.partOptions.editorActionsLocation&&"none"!==this.groupsView.partOptions.showTabs}createEditorActionsToolBar(e,t){this.editorActionsToolbarContainer=(0,Rt.Zb)("div"),this.editorActionsToolbarContainer.classList.add(...t),e.appendChild(this.editorActionsToolbarContainer),this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer)}handleEditorActionToolBarVisibility(e){var t;let i=this.editorActionsEnabled,o=!!this.editorActionsToolbar;i&&!o?this.doCreateEditorActionsToolBar(e):!i&&o&&(null!==(t=this.editorActionsToolbar)&&void 0!==t&&t.getElement().remove(),this.editorActionsToolbar=void 0,this.editorActionsToolbarDisposables.clear(),this.editorActionsDisposables.clear()),e.classList.toggle("hidden",!i)}doCreateEditorActionsToolBar(e){let t={groupId:this.groupView.id};this.editorActionsToolbar=this.editorActionsToolbarDisposables.add(this.instantiationService.createInstance(Lt.cr,e,{actionViewItemProvider:(e,t)=>this.actionViewItemProvider(e,t),orientation:Rt.Rr.HORIZONTAL,ariaLabel:(0,Rt.Ij)(3504,"Editor actions"),getKeyBinding:e=>this.getKeybinding(e),actionRunner:this.editorActionsToolbarDisposables.add(new er(t)),anchorAlignmentProvider:()=>Rt.fl.RIGHT,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:Rt.sb.EditorTitle,overflowBehavior:{maxItems:9,exempted:zs},highlightToggledItems:!0})),this.editorActionsToolbar.context=t,this.editorActionsToolbarDisposables.add(this.editorActionsToolbar.actionRunner.onDidRun(e=>{e.error&&!(0,Rt.SN)(e.error)&&this.notificationService.error(e.error)}))}actionViewItemProvider(e,t){let i=this.groupView.activeEditorPane;if(i instanceof Lt.s){let o=i.getActionViewItem(e,t);if(o)return o}return(0,Rt.Wr)(this.instantiationService,e,(0,xt.A)((0,xt.A)({},t),{},{menuAsChild:this.renderDropdownAsChildElement}))}updateEditorActionsToolbar(){if(!this.editorActionsEnabled)return;this.editorActionsDisposables.clear();let e=this.groupView.createEditorActions(this.editorActionsDisposables);this.editorActionsDisposables.add(e.onDidChange(()=>this.updateEditorActionsToolbar()));let t=(0,Rt.$j)(this.editorActionsToolbar),{primary:i,secondary:o}=this.prepareEditorActions(e.actions);t.setActions((0,Rt.Br)(i),(0,Rt.Br)(o))}getEditorPaneAwareContextKeyService(){var e,t;return null!==(e=null===(t=this.groupView.activeEditorPane)||void 0===t?void 0:t.scopedContextKeyService)&&void 0!==e?e:this.contextKeyService}clearEditorActionsToolbar(){this.editorActionsEnabled&&(0,Rt.$j)(this.editorActionsToolbar).setActions([],[])}onGroupDragStart(e,t){var i;if(e.target!==t)return!1;let o=this.isNewWindowOperation(e);this.groupTransfer.setData([new Wt.z(this.groupView.id)],Wt.z.prototype),e.dataTransfer&&(e.dataTransfer.effectAllowed="copyMove");let s=!1;if("multiple"===this.groupsView.partOptions.showTabs?s=this.doFillResourceDataTransfers(this.groupView.getEditors(Pt.Ut.SEQUENTIAL),e,o):this.groupView.activeEditor&&(s=this.doFillResourceDataTransfers([this.groupView.activeEditor],e,o)),!s&&Rt.rE&&null!==(i=e.dataTransfer)&&void 0!==i&&i.setData(Rt.pa.TEXT,String(this.groupView.label)),this.groupView.activeEditor){let i=this.groupView.activeEditor.getName();"multiple"===this.groupsView.partOptions.showTabs&&this.groupView.count>1&&(i=(0,Rt.Ij)(3505,"{0} (+{1})",i,this.groupView.count-1)),(0,Rt.sa)(e,t,i)}return o}async onGroupDragEnd(e,t,i,o){if(this.groupTransfer.clearData(Wt.z.prototype),e.target!==i||!o||(0,Wt.G)())return;let s=await this.maybeCreateAuxiliaryEditorPartAt(e,i);if(!s)return;let r=s.activeGroup;this.groupsView.mergeGroup(this.groupView,r.id,{mode:this.isMoveOperation(null!==t&&void 0!==t?t:e,r.id)?Pt.Z.MOVE_EDITORS:Pt.Z.COPY_EDITORS}),r.focus()}async maybeCreateAuxiliaryEditorPartAt(e,t){var i;let{point:o,display:s}=null!==(i=await this.hostService.getCursorScreenPoint())&&void 0!==i?i:{point:{x:e.screenX,y:e.screenY}},r=(0,Rt.Ex)();if("visible"===r.document.visibilityState&&r.document.hasFocus()&&o.x>=r.screenX&&o.x<=r.screenX+r.outerWidth&&o.y>=r.screenY&&o.y<=r.screenY+r.outerHeight)return;let n=t.offsetWidth/2,a=30+t.offsetHeight/2,d={x:o.x-n,y:o.y-a};return s&&(d.x<s.x&&(d.x=s.x),d.y<s.y&&(d.y=s.y)),this.editorPartsView.createAuxiliaryEditorPart({bounds:d})}isNewWindowOperation(e){return this.groupsView.partOptions.dragToOpenWindow?!e.altKey:e.altKey}isMoveOperation(e,t,i){return!(null===i||void 0===i||!i.hasCapability(Pt.zt.Singleton))||(!(e.ctrlKey&&!Rt.Cj||e.altKey&&Rt.Cj)||t===this.groupView.id)}doFillResourceDataTransfers(e,t,i){return!!e.length&&(this.instantiationService.invokeFunction(Wt.U,e.map(e=>({editor:e,groupId:this.groupView.id})),t,{disableStandardTransfer:i}),!0)}onTabContextMenu(e,t,i){this.resourceContext.set(Pt.Ht.getOriginalUri(e,{supportSideBySide:Pt.Jt.PRIMARY})),this.editorPinnedContext.set(this.tabsModel.isPinned(e)),this.editorIsFirstContext.set(this.tabsModel.isFirst(e)),this.editorIsLastContext.set(this.tabsModel.isLast(e)),this.editorStickyContext.set(this.tabsModel.isSticky(e)),this.groupLockedContext.set(this.tabsModel.isLocked),this.editorCanSplitInGroupContext.set(e.hasCapability(Pt.zt.CanSplitInGroup)),this.sideBySideEditorContext.set(e.typeId===Pt.Et.ID),(0,Nt.nr)(this.editorAvailableEditorIds,e,this.editorResolverService);let o=i;(0,Rt.lS)(t)&&(o=new Rt.NT((0,Rt.Bx)(i),t)),this.contextMenuService.showContextMenu({getAnchor:()=>o,menuId:Rt.sb.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextMenuContextKeyService,getActionsContext:()=>({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(e)}),getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id,this.contextMenuContextKeyService),onHide:()=>this.groupsView.activeGroup.focus()})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){var t;let i=this.getKeybinding(e);return i&&null!==(t=i.getLabel())&&void 0!==t?t:void 0}get tabHeight(){return"compact"===this.groupsView.partOptions.tabHeight?as.EDITOR_TAB_HEIGHT.compact:as.EDITOR_TAB_HEIGHT.normal}getHoverTitle(e){let t=e.getTitle(Pt.Xt.LONG);return this.tabsModel.isPinned(e)?t:{markdown:new Rt.Pc("",{supportThemeIcons:!0,isTrusted:!0}).appendText(t).appendMarkdown(' (_preview_ [$(gear)](command:workbench.action.openSettings?%5B%22workbench.editor.enablePreview%22%5D "Configure Preview Mode"))'),markdownNotSupportedFallback:t+" (preview)"}}updateTabHeight(){this.parent.style.setProperty("--editor-group-tab-height","".concat(this.tabHeight,"px"))}updateOptions(e,t){e.tabHeight!==t.tabHeight&&this.updateTabHeight(),(e.editorActionsLocation!==t.editorActionsLocation||e.showTabs!==t.showTabs)&&this.editorActionsToolbarContainer&&(this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer),this.updateEditorActionsToolbar())}},{_:as=v},{_:v.EDITOR_TAB_HEIGHT={normal:35,compact:22}},v);tr=as=(0,Rt.Pb)([(0,Rt.Fb)(5,Rt.Sl),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.yb),(0,Rt.Fb)(8,Rt.kd),(0,Rt.Fb)(9,Rt.Ld),(0,Rt.Fb)(10,Rt.xc),(0,Rt.Fb)(11,Rt.Qd),(0,Rt.Fb)(12,Lt.I),(0,Rt.Fb)(13,Lt.P)],tr),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.Mb)(),(0,Pt.en)(),(0,Pt.Ot)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Tt.s)(),(0,Tt.kn)(),(0,Rt.Ad)(),(0,Rt.wb)(),(0,Pt.Q)(),(0,Pt.G)(),(0,Pt.At)(),(0,Rt.s_)(),(0,Wt.Dx)(),(0,Wt.ca)(),(0,Rt.Ll)(),(0,Rt.mr)(),(0,Rt.Sc)(),(0,Rt.gD)(),(0,Rt.Db)(),(0,Pt.i)(),(0,Pt.V)(),(0,Lt.L)(),(0,Rt.mj)(),(0,Rt.db)(),(0,Rt.IO)(),(0,Rt.tO)(),(0,Rt.gb)(),(0,Rt.nb)(),(0,Mt.c)(),(0,Nt.ir)(),(0,Rt.qx)(),(0,Nt.gt)(),(0,Rt.Ja)(),(0,Rt.Tt)(),(0,Lt.Z)();var ir=class extends Rt.ob{constructor(e,t,i){super(e),this.commandId=t,this.commandArgs=i}run(e){return e.get(Rt.Cb).executeCommand(this.commandId,this.commandArgs)}},or=class extends Rt.ob{getDirection(e){return(0,Pt.tt)(e)}async run(e){let t=e.get(Pt.W),i=e.get(Rt.o_),o=e.get(Pt.kt),s=e.get(Rt.wt);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];$s(t,this.getDirection(i),(0,zt.t)(n,o,t,s))}},sr=(C=class e extends or{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3252,"Split Editor"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.Backslash},category:Mt.s.View})}},{_:C.ID=Ds},C),rr=({_:(w=class extends ir{constructor(){super({id:xs,title:(0,Rt.Lj)(3256,"Split Editor Up"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.Backslash)},category:Mt.s.View},xs)}}).LABEL=(0,Rt.Ij)(3256,"Split Editor Up")},w),nr=({_:(y=class extends ir{constructor(){super({id:Vs,title:(0,Rt.Lj)(3257,"Split Editor Down"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.Backslash)},category:Mt.s.View},Vs)}}).LABEL=(0,Rt.Ij)(3257,"Split Editor Down")},y),ar=class extends Rt.ob{constructor(){super({id:"workbench.action.joinTwoGroups",title:(0,Rt.Lj)(3258,"Join Editor Group with Next Group"),f1:!0,category:Mt.s.View})}async run(e,t){let i,o=e.get(Pt.W);if(i=t&&"number"==typeof t.groupId?o.getGroup(t.groupId):o.activeGroup,i){let e=[Pt.K.RIGHT,Pt.K.DOWN,Pt.K.LEFT,Pt.K.UP];for(let t of e){let e=o.findGroup({direction:t},i);if(e&&i!==e){o.mergeGroup(i,e);break}}}}},dr=class extends Rt.ob{constructor(){super({id:"workbench.action.joinAllGroups",title:(0,Rt.Lj)(3259,"Join All Editor Groups"),f1:!0,category:Mt.s.View})}async run(e){let t=e.get(Pt.W);t.mergeAllGroups(t.activeGroup)}},lr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateEditorGroups",title:(0,Rt.Lj)(3260,"Navigate Between Editor Groups"),f1:!0,category:Mt.s.View})}async run(e){var t;let i=e.get(Pt.W);null===(t=i.findGroup({location:Pt.q.NEXT},i.activeGroup,!0))||void 0===t||t.focus()}},cr=class extends Rt.ob{constructor(){super({id:"workbench.action.focusActiveEditorGroup",title:(0,Rt.Lj)(3261,"Focus Active Editor Group"),f1:!0,category:Mt.s.View})}async run(e){e.get(Pt.W).activeGroup.focus()}},hr=class extends Rt.ob{constructor(e,t){super(e),this.scope=t}async run(e){var t;let i=e.get(Pt.W);null===(t=i.findGroup(this.scope,i.activeGroup,!0))||void 0===t||t.focus()}},ur=(f=class extends Rt.Ob{constructor(e,t,i){super(e,t,Rt.Eb.asClassName(Rt.mD.close)),this.commandService=i}run(e){return this.commandService.executeCommand(us,void 0,e)}},{_:f.ID="workbench.action.closeActiveEditor"},{_:f.LABEL=(0,Rt.Ij)(3270,"Close Editor")},f);ur=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Cb)],ur);var gr=(S=class extends Rt.Ob{constructor(e,t,i){super(e,t,Rt.Eb.asClassName(Rt.mD.pinned)),this.commandService=i}run(e){return this.commandService.executeCommand(As,void 0,e)}},{_:S.ID="workbench.action.unpinActiveEditor"},{_:S.LABEL=(0,Rt.Ij)(3271,"Unpin Editor")},S);gr=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Cb)],gr);var pr=(I=class extends Rt.Ob{constructor(e,t,i){super(e,t,Rt.Eb.asClassName(Rt.mD.close)),this.editorGroupService=i}async run(e){let t=e?this.editorGroupService.getGroup(e.groupId):this.editorGroupService.activeGroup;if(!t)return;let i=void 0===(null===e||void 0===e?void 0:e.editorIndex)?t.activeEditor:t.getEditorByIndex(e.editorIndex);if(!i)return;let o=[];t.isSelected(i)?o.push(...t.selectedEditors):o.push(i);for(let s of o)await t.closeEditor(s,{preserveFocus:null===e||void 0===e?void 0:e.preserveFocus})}},{_:I.ID="workbench.action.closeActiveEditor"},{_:I.LABEL=(0,Rt.Ij)(3272,"Close")},I);pr=(0,Rt.Pb)([(0,Rt.Fb)(2,Pt.W)],pr);var br=class extends Rt.ob{constructor(){super({id:"workbench.action.revertAndCloseActiveEditor",title:(0,Rt.Lj)(3273,"Revert and Close Editor"),f1:!0,category:Mt.s.View})}async run(e){let t=e.get(Pt.kt),i=e.get(Rt.eb),o=t.activeEditorPane;if(o){let e=o.input,s=o.group;try{await t.revert({editor:e,groupId:s.id})}catch(o){i.error(o),await t.revert({editor:e,groupId:s.id},{soft:!0})}await s.closeEditor(e)}}},mr=class extends Rt.ob{constructor(){super({id:"workbench.action.closeEditorsToTheLeft",title:(0,Rt.Lj)(3274,"Close Editors to the Left in Group"),f1:!0,category:Mt.s.View})}async run(e,t){let i=e.get(Pt.W),{group:o,editor:s}=this.getTarget(i,t);o&&s&&await o.closeEditors({direction:Pt.Pt.LEFT,except:s,excludeSticky:!0})}getTarget(e,t){return t?{editor:t.editor,group:e.getGroup(t.groupId)}:{group:e.activeGroup,editor:e.activeGroup.activeEditor}}},vr=class extends Rt.ob{groupsToClose(e){let t=[],i=e.getGroups(Pt.X.GRID_APPEARANCE);for(let o=i.length-1;o>=0;o--)t.push(i[o]);return t}async run(e){let t=e.get(Pt.kt),i=e.get(Rt.eb),o=e.get(Rt.qa),s=e.get(Pt.W),r=e.get(Pt.B),n=e.get(Rt.Il),a=new Set,d=new Set,l=new Set,c=new Map;for(let{editor:p,groupId:b}of t.getEditors(Pt.Ut.SEQUENTIAL,{excludeSticky:this.excludeSticky})){var h;let t=!1,o=!1;if(p.closeHandler)try{t=p.closeHandler.showConfirm()}catch(e){i.error(e),o=!0}if((!p.closeHandler||o)&&(t=p.isDirty()&&!p.isSaving()),t)if("function"==typeof(null===(h=p.closeHandler)||void 0===h?void 0:h.confirm)){let e=c.get(p.typeId);e||(e=new Set,c.set(p.typeId,e)),e.add({editor:p,groupId:b})}else p.hasCapability(Pt.zt.Untitled)||r.getAutoSaveMode(p).mode!==Pt.n.ON_FOCUS_CHANGE?Rt.Tj&&(Rt.kj||Rt.xj)&&!p.hasCapability(Pt.zt.Untitled)&&r.getAutoSaveMode(p).mode===Pt.n.ON_WINDOW_CHANGE?l.add({editor:p,groupId:b}):a.add({editor:p,groupId:b}):d.add({editor:p,groupId:b})}if(a.size>0){let e=Array.from(a.values());switch(await this.revealEditorsToConfirm(e,s),await n.showSaveConfirm(e.map(e=>{let{editor:t}=e;return t instanceof Pt.Et?t.primary.getName():t.getName()}))){case Wt.sa.CANCEL:return;case Wt.sa.DONT_SAVE:await this.revertEditors(t,i,o,e);break;case Wt.sa.SAVE:await t.save(e,{reason:Pt.Kt.EXPLICIT})}}for(let[,p]of c){var u,g;let e=Array.from(p.values());await this.revealEditorsToConfirm(e,s);let r=await(null===(u=e.at(0))||void 0===u||null===(u=u.editor.closeHandler)||void 0===u||null===(g=u.confirm)||void 0===g?void 0:g.call(u,e));if("number"==typeof r)switch(r){case Wt.sa.CANCEL:return;case Wt.sa.DONT_SAVE:await this.revertEditors(t,i,o,e);break;case Wt.sa.SAVE:await t.save(e,{reason:Pt.Kt.EXPLICIT})}}if(d.size>0){let e=Array.from(d.values());await t.save(e,{reason:Pt.Kt.FOCUS_CHANGE})}if(l.size>0){let e=Array.from(l.values());await t.save(e,{reason:Pt.Kt.WINDOW_CHANGE})}return this.doCloseAll(s)}revertEditors(e,t,i,o){return i.withProgress({location:Nt.mt.Window,delay:800,title:(0,Rt.Ij)(3275,"Reverting Editors...")},()=>this.doRevertEditors(e,t,o))}async doRevertEditors(e,t,i){try{await e.revert(i)}catch(o){t.error(o),await e.revert(i,{soft:!0})}}async revealEditorsToConfirm(e,t){try{let o=new Set;for(let{editor:s,groupId:r}of e){var i;o.has(r)||(o.add(r),await(null===(i=t.getGroup(r))||void 0===i?void 0:i.openEditor(s)))}}catch(o){}}async doCloseAll(e){await Promise.all(this.groupsToClose(e).map(e=>e.closeAllEditors({excludeSticky:this.excludeSticky})))}},Cr=(k=class e extends vr{constructor(){super({id:e.ID,title:e.LABEL,f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyW)},icon:Rt.mD.closeAll,category:Mt.s.View})}get excludeSticky(){return!0}},{_:k.ID="workbench.action.closeAllEditors"},{_:k.LABEL=(0,Rt.Lj)(3276,"Close All Editors")},k),wr=class extends Rt.ob{constructor(){super({id:"workbench.action.closeEditorsInOtherGroups",title:(0,Rt.Lj)(3278,"Close Editors in Other Groups"),f1:!0,category:Mt.s.View})}async run(e,t){let i=e.get(Pt.W),o=t?i.getGroup(t.groupId):i.activeGroup;await Promise.all(i.getGroups(Pt.X.MOST_RECENTLY_ACTIVE).map(async e=>{if(!o||e.id!==o.id)return e.closeAllEditors({excludeSticky:!0})}))}},yr=class extends Rt.ob{constructor(){super({id:"workbench.action.closeEditorInAllGroups",title:(0,Rt.Lj)(3279,"Close Editor in All Groups"),f1:!0,category:Mt.s.View})}async run(e){let t=e.get(Pt.kt),i=e.get(Pt.W),o=t.activeEditor;o&&await Promise.all(i.getGroups(Pt.X.MOST_RECENTLY_ACTIVE).map(e=>e.closeEditor(o)))}},fr=class extends Rt.ob{constructor(e,t,i){super(e),this.direction=t,this.isMove=i}async run(e,t){let i,o=e.get(Pt.W);if(i=t&&"number"==typeof t.groupId?o.getGroup(t.groupId):o.activeGroup,i){let e;if(this.isMove){let t=this.findTargetGroup(o,i);t&&(e=o.moveGroup(i,t,this.direction))}else e=o.copyGroup(i,i,this.direction);e&&o.activateGroup(e)}}findTargetGroup(e,t){let i=[this.direction];switch(this.direction){case Pt.K.LEFT:case Pt.K.RIGHT:i.push(Pt.K.UP,Pt.K.DOWN);break;case Pt.K.UP:case Pt.K.DOWN:i.push(Pt.K.LEFT,Pt.K.RIGHT)}for(let o of i){let i=e.findGroup({direction:o},t);if(i)return i}}},Sr=class extends fr{constructor(e,t){super(e,t,!0)}},Ir=class extends fr{constructor(e,t){super(e,t,!1)}},kr=class extends Rt.ob{constructor(){super({id:"workbench.action.minimizeOtherEditors",title:(0,Rt.Lj)(3288,"Expand Editor Group"),f1:!0,category:Mt.s.View,precondition:Nt.kn})}async run(e){e.get(Pt.W).arrangeGroups(Pt.Y.EXPAND)}},_r=class extends Rt.ob{constructor(){super({id:"workbench.action.minimizeOtherEditorsHideSidebar",title:(0,Rt.Lj)(3289,"Expand Editor Group and Hide Side Bars"),f1:!0,category:Mt.s.View,precondition:Rt.PO.or(Nt.kn,Nt.Un,Nt.dn)})}async run(e){let t=e.get(Pt.W),i=e.get(Nt.Z);i.setPartHidden(!0,Nt.I.SIDEBAR_PART),i.setPartHidden(!0,Nt.I.AUXILIARYBAR_PART),t.arrangeGroups(Pt.Y.EXPAND)}},Er=class extends Rt.ob{constructor(){super({id:"workbench.action.evenEditorWidths",title:(0,Rt.Lj)(3290,"Reset Editor Group Sizes"),f1:!0,category:Mt.s.View})}async run(e){e.get(Pt.W).arrangeGroups(Pt.Y.EVEN)}},Ar=class extends Rt.ob{constructor(){super({id:"workbench.action.toggleEditorWidths",title:(0,Rt.Lj)(3291,"Toggle Editor Group Sizes"),f1:!0,category:Mt.s.View})}async run(e){e.get(Pt.W).toggleExpandGroup()}},Dr=class extends Rt.ob{constructor(){super({id:"workbench.action.maximizeEditorHideSidebar",title:(0,Rt.Lj)(3292,"Maximize Editor Group and Hide Side Bars"),f1:!0,category:Mt.s.View,precondition:Rt.PO.or(Rt.PO.and(Nt.mn.negate(),Nt.hn),Nt.Un,Nt.dn)})}async run(e){let t=e.get(Nt.Z),i=e.get(Pt.W);e.get(Pt.kt).activeEditor&&(t.setPartHidden(!0,Nt.I.SIDEBAR_PART),t.setPartHidden(!0,Nt.I.AUXILIARYBAR_PART),i.arrangeGroups(Pt.Y.MAXIMIZE))}},xr=class extends Rt.ob{constructor(){super({id:Zs,title:(0,Rt.Lj)(3293,"Toggle Maximize Editor Group"),f1:!0,category:Mt.s.View,precondition:Rt.PO.or(Nt.hn,Nt.mn),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyM)},menu:[{id:Rt.sb.EditorTitle,order:-1e4,group:"navigation",when:Nt.mn},{id:Rt.sb.EmptyEditorGroup,order:-1e4,group:"navigation",when:Nt.mn}],icon:Rt.mD.screenFull,toggled:{condition:Nt.mn,title:(0,Rt.Ij)(3294,"Unmaximize Group")}})}async run(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(Pt.W),r=(0,zt.t)(i,e.get(Pt.kt),s,e.get(Rt.wt));r.groupedEditors.length&&s.toggleMaximizeGroup(r.groupedEditors[0].group)}},Vr=class extends Rt.ob{async run(e){let t=e.get(Pt.W),i=this.navigate(t);if(!i)return;let{groupId:o,editor:s}=i;if(!s)return;let r=t.getGroup(o);r&&await r.openEditor(s)}},Rr=(_=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3301,"Go Forward")),{},{mnemonicTitle:(0,Rt.Ij)(3302,"&&Forward")}),f1:!0,icon:Rt.mD.arrowRight,precondition:Rt.PO.has("canNavigateForward"),keybinding:{weight:Rt.mb.WorkbenchContrib,win:{primary:Rt.ZD.Alt|Rt.YD.RightArrow,secondary:[Rt.YD.BrowserForward]},mac:{primary:Rt.ZD.WinCtrl|Rt.ZD.Shift|Rt.YD.Minus,secondary:[Rt.YD.BrowserForward]},linux:{primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Minus,secondary:[Rt.YD.BrowserForward]}},menu:[{id:Rt.sb.MenubarGoMenu,group:"1_history_nav",order:2},{id:Rt.sb.CommandCenter,order:2,when:Rt.PO.has("config.workbench.navigationControl.enabled")}]})}async run(e){await e.get(Tt.On).goForward(Tt.a.NONE)}},{_:_.ID="workbench.action.navigateForward"},{_:_.LABEL=(0,Rt.Ij)(3301,"Go Forward")},_),Tr=(E=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3303,"Go Back")),{},{mnemonicTitle:(0,Rt.Ij)(3304,"&&Back")}),f1:!0,precondition:Rt.PO.has("canNavigateBack"),icon:Rt.mD.arrowLeft,keybinding:{weight:Rt.mb.WorkbenchContrib,win:{primary:Rt.ZD.Alt|Rt.YD.LeftArrow,secondary:[Rt.YD.BrowserBack]},mac:{primary:Rt.ZD.WinCtrl|Rt.YD.Minus,secondary:[Rt.YD.BrowserBack]},linux:{primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.Minus,secondary:[Rt.YD.BrowserBack]}},menu:[{id:Rt.sb.MenubarGoMenu,group:"1_history_nav",order:1},{id:Rt.sb.CommandCenter,order:1,when:Rt.PO.has("config.workbench.navigationControl.enabled")}]})}async run(e){await e.get(Tt.On).goBack(Tt.a.NONE)}},{_:E.ID="workbench.action.navigateBack"},{_:E.LABEL=(0,Rt.Ij)(3303,"Go Back")},E),Lr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateLast",title:(0,Rt.Lj)(3305,"Go Previous"),f1:!0})}async run(e){await e.get(Tt.On).goPrevious(Tt.a.NONE)}},Wr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateForwardInEditLocations",title:(0,Rt.Lj)(3306,"Go Forward in Edit Locations"),f1:!0})}async run(e){await e.get(Tt.On).goForward(Tt.a.EDITS)}},Fr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateBackInEditLocations",title:(0,Rt.Lj)(3307,"Go Back in Edit Locations"),f1:!0})}async run(e){await e.get(Tt.On).goBack(Tt.a.EDITS)}},Gr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigatePreviousInEditLocations",title:(0,Rt.Lj)(3308,"Go Previous in Edit Locations"),f1:!0})}async run(e){await e.get(Tt.On).goPrevious(Tt.a.EDITS)}},Zr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateToLastEditLocation",title:(0,Rt.Lj)(3309,"Go to Last Edit Location"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyQ)}})}async run(e){await e.get(Tt.On).goLast(Tt.a.EDITS)}},Nr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateForwardInNavigationLocations",title:(0,Rt.Lj)(3310,"Go Forward in Navigation Locations"),f1:!0})}async run(e){await e.get(Tt.On).goForward(Tt.a.NAVIGATION)}},Pr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateBackInNavigationLocations",title:(0,Rt.Lj)(3311,"Go Back in Navigation Locations"),f1:!0})}async run(e){await e.get(Tt.On).goBack(Tt.a.NAVIGATION)}},Jr=class extends Rt.ob{constructor(){super({id:"workbench.action.navigatePreviousInNavigationLocations",title:(0,Rt.Lj)(3312,"Go Previous in Navigation Locations"),f1:!0})}async run(e){await e.get(Tt.On).goPrevious(Tt.a.NAVIGATION)}},Br=class extends Rt.ob{constructor(){super({id:"workbench.action.navigateToLastNavigationLocation",title:(0,Rt.Lj)(3313,"Go to Last Navigation Location"),f1:!0})}async run(e){await e.get(Tt.On).goLast(Tt.a.NAVIGATION)}},Or=(A=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3314,"Reopen Closed Editor"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.KeyT},category:Mt.s.View})}async run(e){await e.get(Tt.On).reopenLastClosedEditor()}},{_:A.ID="workbench.action.reopenClosedEditor"},A),Kr=(D=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3315,"Clear Recently Opened..."),f1:!0,category:Mt.s.File})}async run(e){let t=e.get(Rt.Fl),i=e.get(Wt.Ex),o=e.get(Tt.On),{confirmed:s}=await t.confirm({type:"warning",message:(0,Rt.Ij)(3316,"Do you want to clear all recently opened files and workspaces?"),detail:(0,Rt.Ij)(3317,"This action is irreversible!"),primaryButton:(0,Rt.Ij)(3318,"&&Clear")});s&&(i.clearRecentlyOpened(),o.clearRecentlyOpened())}},{_:D.ID="workbench.action.clearRecentFiles"},D),Mr=(x=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3319,"Show Editors in Active Group By Most Recently Used"),f1:!0,category:Mt.s.View})}async run(e){e.get(Rt.xc).quickAccess.show(Mo.PREFIX)}},{_:x.ID="workbench.action.showEditorsInActiveGroup"},x),jr=(V=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3320,"Show All Editors By Appearance"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyP),mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.Tab}},category:Mt.s.File})}async run(e){e.get(Rt.xc).quickAccess.show(jo.PREFIX)}},{_:V.ID="workbench.action.showAllEditors"},V),Qr=(R=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3321,"Show All Editors By Most Recently Used"),f1:!0,category:Mt.s.View})}async run(e){e.get(Rt.xc).quickAccess.show(Qo.PREFIX)}},{_:R.ID="workbench.action.showAllEditorsByMostRecentlyUsed"},R),Yr=class extends Rt.ob{constructor(e,t,i){super(e),this.prefix=t,this.itemActivation=i}async run(e){let t=e.get(Rt.kd),i=e.get(Rt.xc),o=t.lookupKeybindings(this.desc.id);i.quickAccess.show(this.prefix,{quickNavigateConfiguration:{keybindings:o},itemActivation:this.itemActivation})}},Hr=(T=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3326,"Quick Open Previous Editor from History"),f1:!0})}async run(t){let i,o=t.get(Rt.kd),s=t.get(Rt.xc),r=t.get(Pt.W),n=o.lookupKeybindings(e.ID);0===r.activeGroup.count&&(i=Rt.dr.FIRST),s.quickAccess.show("",{quickNavigateConfiguration:{keybindings:n},itemActivation:i})}},{_:T.ID="workbench.action.openPreviousEditorFromHistory"},T),Xr=class extends Rt.ob{constructor(){super({id:"workbench.action.openNextRecentlyUsedEditor",title:(0,Rt.Lj)(3327,"Open Next Recently Used Editor"),f1:!0,category:Mt.s.View})}async run(e){e.get(Tt.On).openNextRecentlyUsedEditor()}},Ur=class extends Rt.ob{constructor(){super({id:"workbench.action.openPreviousRecentlyUsedEditor",title:(0,Rt.Lj)(3328,"Open Previous Recently Used Editor"),f1:!0,category:Mt.s.View})}async run(e){e.get(Tt.On).openPreviouslyUsedEditor()}},zr=class extends Rt.ob{constructor(){super({id:"workbench.action.openNextRecentlyUsedEditorInGroup",title:(0,Rt.Lj)(3329,"Open Next Recently Used Editor In Group"),f1:!0,category:Mt.s.View})}async run(e){let t=e.get(Tt.On),i=e.get(Pt.W);t.openNextRecentlyUsedEditor(i.activeGroup.id)}},qr=class extends Rt.ob{constructor(){super({id:"workbench.action.openPreviousRecentlyUsedEditorInGroup",title:(0,Rt.Lj)(3330,"Open Previous Recently Used Editor In Group"),f1:!0,category:Mt.s.View})}async run(e){let t=e.get(Tt.On),i=e.get(Pt.W);t.openPreviouslyUsedEditor(i.activeGroup.id)}},$r=class extends Rt.ob{constructor(){super({id:"workbench.action.clearEditorHistoryWithoutConfirm",title:(0,Rt.Lj)(3331,"Clear Editor History without Confirmation"),f1:!0,precondition:Nt.bn})}async run(e){e.get(Tt.On).clear()}},en=class extends Rt.ob{constructor(){super({id:"workbench.action.clearEditorHistory",title:(0,Rt.Lj)(3332,"Clear Editor History"),f1:!0})}async run(e){let t=e.get(Rt.Fl),i=e.get(Tt.On),{confirmed:o}=await t.confirm({type:"warning",message:(0,Rt.Ij)(3333,"Do you want to clear the history of recently opened editors?"),detail:(0,Rt.Ij)(3317,"This action is irreversible!"),primaryButton:(0,Rt.Ij)(3318,"&&Clear")});o&&i.clear()}},tn=({_:(L=class extends ir{constructor(){super({id:"workbench.action.splitEditorToLeftGroup",title:(0,Rt.Lj)(3350,"Split Editor into Left Group"),f1:!0,category:Mt.s.View},vs,{to:"left",by:"group"})}}).ID="workbench.action.splitEditorToLeftGroup"},{_:L.LABEL=(0,Rt.Ij)(3350,"Split Editor into Left Group")},L),on=(W=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3354,"Single Column Editor Layout"),f1:!0,category:Mt.s.View},Cs,{groups:[{}],orientation:Pt.J.HORIZONTAL})}},{_:W.ID="workbench.action.editorLayoutSingle"},W),sn=(F=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3355,"Two Columns Editor Layout"),f1:!0,category:Mt.s.View},Cs,{groups:[{},{}],orientation:Pt.J.HORIZONTAL})}},{_:F.ID="workbench.action.editorLayoutTwoColumns"},F),rn=(G=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3356,"Three Columns Editor Layout"),f1:!0,category:Mt.s.View},Cs,{groups:[{},{},{}],orientation:Pt.J.HORIZONTAL})}},{_:G.ID="workbench.action.editorLayoutThreeColumns"},G),nn=(Z=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3357,"Two Rows Editor Layout"),f1:!0,category:Mt.s.View},Cs,{groups:[{},{}],orientation:Pt.J.VERTICAL})}},{_:Z.ID="workbench.action.editorLayoutTwoRows"},Z),an=(N=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3358,"Three Rows Editor Layout"),f1:!0,category:Mt.s.View},Cs,{groups:[{},{},{}],orientation:Pt.J.VERTICAL})}},{_:N.ID="workbench.action.editorLayoutThreeRows"},N),dn=(P=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3359,"Grid Editor Layout (2x2)"),f1:!0,category:Mt.s.View},Cs,{groups:[{groups:[{},{}]},{groups:[{},{}]}],orientation:Pt.J.HORIZONTAL})}},{_:P.ID="workbench.action.editorLayoutTwoByTwoGrid"},P),ln=(J=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3360,"Two Columns Bottom Editor Layout"),f1:!0,category:Mt.s.View},Cs,{groups:[{},{groups:[{},{}]}],orientation:Pt.J.VERTICAL})}},{_:J.ID="workbench.action.editorLayoutTwoColumnsBottom"},J),cn=(B=class e extends ir{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3361,"Two Rows Right Editor Layout"),f1:!0,category:Mt.s.View},Cs,{groups:[{},{groups:[{},{}]}],orientation:Pt.J.HORIZONTAL})}},{_:B.ID="workbench.action.editorLayoutTwoRowsRight"},B),hn=class extends Rt.ob{constructor(e,t){super(e),this.direction=t}async run(e){let t=e.get(Pt.W),i=e.get(Nt.Z),o=(0,Rt.wx)(),s=i.hasFocus(Nt.I.EDITOR_PART)||o.activeElement===o.body,r=t.addGroup(t.activeGroup,this.direction);t.activateGroup(r),s&&r.focus()}},un=class extends Rt.ob{constructor(){super({id:"workbench.action.toggleEditorType",title:(0,Rt.Lj)(3366,"Toggle Editor Type"),f1:!0,category:Mt.s.View,precondition:Nt.Jt})}async run(e){let t=e.get(Pt.kt),i=e.get(Lt.I),o=t.activeEditorPane;if(!o)return;let s=Pt.Ht.getCanonicalUri(o.input);if(!s)return;let r=i.getEditors(s).map(e=>e.id).filter(e=>e!==o.input.editorId);0!==r.length&&await t.replaceEditors([{editor:o.input,replacement:{resource:s,options:{override:r[0]}}}],o.group)}},gn=class extends Rt.ob{constructor(){super({id:"workbench.action.reopenTextEditor",title:(0,Rt.Lj)(3367,"Reopen Editor with Text Editor"),f1:!0,category:Mt.s.View,precondition:Nt.Jt})}async run(e){let t=e.get(Pt.kt),i=t.activeEditorPane;if(!i)return;let o=Pt.Ht.getCanonicalUri(i.input);o&&await t.replaceEditors([{editor:i.input,replacement:{resource:o,options:{override:Pt.Ft.id}}}],i.group)}},pn=class extends Rt.ob{constructor(e,t,i,o){super({id:e,title:t,category:Mt.s.View,precondition:Nt.Qt,keybinding:i,f1:!0}),this.move=o}async run(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(Pt.W),r=(0,zt.t)(i,e.get(Pt.kt),s,e.get(Rt.wt));if(!r.groupedEditors.length)return;let n=await s.createAuxiliaryEditorPart(),{group:a,editors:d}=r.groupedEditors[0],l=(0,Lt.Q)(a,d,r.preserveFocus);this.move?a.moveEditors(l,n.activeGroup):a.copyEditors(l,n.activeGroup),n.activeGroup.focus()}},bn=class extends Rt.ob{constructor(e,t,i){super({id:e,title:t,category:Mt.s.View,f1:!0}),this.move=i}async run(e){let t=e.get(Pt.W),i=t.activeGroup,o=await t.createAuxiliaryEditorPart();t.mergeGroup(i,o.activeGroup,{mode:this.move?Pt.Z.MOVE_EDITORS:Pt.Z.COPY_EDITORS}),o.activeGroup.focus()}},mn=class extends Rt.ob{constructor(){super({id:"workbench.action.restoreEditorsToMainWindow",title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3376,"Restore Editors into Main Window")),{},{mnemonicTitle:(0,Rt.Ij)(3377,"&&Restore Editors into Main Window")}),f1:!0,precondition:Nt.Cn,category:Mt.s.View})}async run(e){let t=e.get(Pt.W);t.mergeAllGroups(t.mainPart.activeGroup)}},vn=class extends Rt.ob{constructor(){super({id:Hs,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3378,"New Empty Editor Window")),{},{mnemonicTitle:(0,Rt.Ij)(3379,"&&New Empty Editor Window")}),f1:!0,category:Mt.s.View})}async run(e){(await e.get(Pt.W).createAuxiliaryEditorPart()).activeGroup.focus()}};(0,Pt.en)(),(0,Rt.gA)(),(0,Rt.PA)();var Cn,wn=class extends Rt.CA{constructor(e){super(),this.model=e,this._onDidModelChange=this._register(new Rt.uA),this.onDidModelChange=this._onDidModelChange.event,this._register(this.model.onDidModelChange(e=>{var t;let i=null!==(t=e.editorIndex)&&void 0!==t?t:e.editor;void 0!==i&&!this.filter(i)||this._onDidModelChange.fire(e)}))}get id(){return this.model.id}get isLocked(){return this.model.isLocked}get stickyCount(){return this.model.stickyCount}get activeEditor(){return this.model.activeEditor&&this.filter(this.model.activeEditor)?this.model.activeEditor:null}get previewEditor(){return this.model.previewEditor&&this.filter(this.model.previewEditor)?this.model.previewEditor:null}get selectedEditors(){return this.model.selectedEditors.filter(e=>this.filter(e))}isPinned(e){return this.model.isPinned(e)}isTransient(e){return this.model.isTransient(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}isSelected(e){return this.model.isSelected(e)}isFirst(e){return this.model.isFirst(e,this.getEditors(Pt.Ut.SEQUENTIAL))}isLast(e){return this.model.isLast(e,this.getEditors(Pt.Ut.SEQUENTIAL))}getEditors(e,t){return this.model.getEditors(e,t).filter(e=>this.filter(e))}findEditor(e,t){let i=this.model.findEditor(e,t);if(i)return this.filter(i[1])?i:void 0}},yn=class extends wn{get count(){return this.model.stickyCount}getEditors(e,t){return null!==t&&void 0!==t&&t.excludeSticky?[]:e===Pt.Ut.SEQUENTIAL?this.model.getEditors(Pt.Ut.SEQUENTIAL).slice(0,this.model.stickyCount):super.getEditors(e,t)}isSticky(e){return!0}getEditorByIndex(e){return e<this.count?this.model.getEditorByIndex(e):void 0}indexOf(e,t,i){let o=this.model.indexOf(e,t,i);return o<0||o>=this.model.stickyCount?-1:o}contains(e,t){let i=this.model.indexOf(e,void 0,t);return i>=0&&i<this.model.stickyCount}filter(e){return this.model.isSticky(e)}},fn=class extends wn{get count(){return this.model.count-this.model.stickyCount}get stickyCount(){return 0}isSticky(e){return!1}getEditors(e,t){return e===Pt.Ut.SEQUENTIAL?this.model.getEditors(Pt.Ut.SEQUENTIAL).slice(this.model.stickyCount):super.getEditors(e,t)}getEditorByIndex(e){return e>=0?this.model.getEditorByIndex(e+this.model.stickyCount):void 0}indexOf(e,t,i){let o=this.model.indexOf(e,t,i);return o<this.model.stickyCount||o>=this.model.count?-1:o-this.model.stickyCount}contains(e,t){let i=this.model.indexOf(e,void 0,t);return i>=this.model.stickyCount&&i<this.model.count}filter(e){return!this.model.isSticky(e)}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.mj)(),(0,Pt.ot)(),(0,Pt.en)(),(0,Tt.f)(),(0,Rt.zT)(),(0,Rt.ym)(),(0,Rt.tO)(),(0,Wt.ot)(),(0,Rt.zr)(),(0,Rt.wl)(),(0,Rt.Kb)(),(0,Rt.Ad)(),(0,Rt.bb)(),(0,Rt.db)(),(0,Rt.Sc)(),(0,Rt.PA)(),(0,Rt.Up)(),(0,Rt.oA)(),(0,Rt.QA)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Lt.Xn)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Wt.W)(),(0,Rt.Rd)(),(0,Pt.Q)(),(0,Rt.qx)(),(0,Rt.Fj)(),(0,Lt.Z)(),(0,Rt.nM)(),(0,Pt.At)(),(0,Rt.iT)(),(0,Rt.Iw)(),(0,Pt.j)(),(0,Rt.AD)(),(0,Rt.WM)(),(0,Rt.wm)(),(0,Rt.eE)(),(0,Rt.qj)(),(0,Rt.$p)(),(0,Rt.FT)(),(0,Wt.sC)(),(0,Wt._m)(),(0,Lt.L)(),(0,Lt.F)(),(0,Rt.xN)(),(0,Rt.ca)(),(0,Rt.mE)({});var Sn=(O=class extends tr{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super(e,t,i,o,s,r,n,a,d,l,c,h,b,m),this.editorService=u,this.pathService=g,this.treeViewsDragAndDropService=p,this.closeEditorAction=this._register(this.instantiationService.createInstance(pr,pr.ID,pr.LABEL)),this.unpinEditorAction=this._register(this.instantiationService.createInstance(gr,gr.ID,gr.LABEL)),this.tabResourceLabels=this._register(this.instantiationService.createInstance(Wt.at,Wt.rt)),this.tabLabels=[],this.tabActionBars=[],this.tabDisposables=[],this.dimensions={container:Rt.Qb.None,available:Rt.Qb.None},this.layoutScheduler=this._register(new Rt.OA),this.path=Rt.kj?Rt.RD:Rt.FD,this.lastMouseWheelEventTime=0,this.isMouseOverTabs=!1,this.updateEditorLabelScheduler=this._register(new Rt.Sw(()=>this.doUpdateEditorLabels(),0)),(async()=>{this.path=await this.pathService.path})(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}create(e){return super.create(e),this.titleContainer=e,this.tabsAndActionsContainer=(0,Rt.Zb)(".tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=(0,Rt.Zb)(".tabs-container",{role:"tablist",draggable:!0}),this._register(Rt.vm.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new Rt.EA),this.updateTabSizing(!1),this.tabsScrollbar=this.createTabsScrollbar(this.tabsContainer),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.createEditorActionsToolBar(this.tabsAndActionsContainer,["editor-actions"]),this.updateTabsControlVisibility(),this.tabsAndActionsContainer}createTabsScrollbar(e){let t=this._register(new Rt.Vp(e,{horizontal:this.getTabsScrollbarVisibility(),horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:Rt.aA.Hidden,scrollYToX:!0,useShadows:!1}));return this._register(t.onScroll(t=>{t.scrollLeftChanged&&(e.scrollLeft=t.scrollLeft)})),t}updateTabsScrollbarSizing(){var e;null===(e=this.tabsScrollbar)||void 0===e||e.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabsScrollbarVisibility(){var e;null===(e=this.tabsScrollbar)||void 0===e||e.updateOptions({horizontal:this.getTabsScrollbarVisibility()})}updateTabSizing(e){let[t,i]=(0,Rt.Qj)(this.tabsContainer,this.tabSizingFixedDisposables);i.clear();let o=this.groupsView.partOptions;"fixed"===o.tabSizing?(t.style.setProperty("--tab-sizing-fixed-min-width","".concat(o.tabSizingFixedMinWidth,"px")),t.style.setProperty("--tab-sizing-fixed-max-width","".concat(o.tabSizingFixedMaxWidth,"px")),i.add((0,Rt.ox)(t,Rt.tx.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),i.add((0,Rt.ox)(t,Rt.tx.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(t.style.removeProperty("--tab-sizing-fixed-min-width"),t.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((t,i,o)=>{if(e){let{width:e}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width","".concat(e,"px"))}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return"large"===this.groupsView.partOptions.titleScrollbarSizing?Cn.SCROLLBAR_SIZES.large:Cn.SCROLLBAR_SIZES.default}getTabsScrollbarVisibility(){switch(this.groupsView.partOptions.titleScrollbarVisibility){case"visible":return Rt.aA.Visible;case"hidden":return Rt.aA.Hidden;default:return Rt.aA.Auto}}registerTabsContainerListeners(e,t){this._register((0,Rt.ox)(e,Rt.tx.SCROLL,()=>{e.classList.contains("scroll")&&t.setScrollPosition({scrollLeft:e.scrollLeft})}));for(let r of[Rt._m.Tap,Rt.tx.DBLCLICK])this._register((0,Rt.ox)(e,r,t=>{if(r===Rt.tx.DBLCLICK){if(t.target!==e)return}else if(2!==t.tapCount||t.initialTarget!==e)return;Rt.ex.stop(t),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.groupView.count,override:Pt.Ft.id}},this.groupView.id)}));this._register((0,Rt.ox)(e,Rt.tx.MOUSE_DOWN,e=>{1===e.button&&e.preventDefault()})),Rt.xj&&this._register((0,Rt.ox)(e,Rt.tx.MOUSE_UP,e=>{1===e.button&&e.preventDefault()}));let i,o=!1;this._register(new Rt.$b(e,{onDragStart:t=>{o=this.onGroupDragStart(t,e)},onDrag:e=>{i=e},onDragEnter:t=>{if(e.classList.add("scroll"),t.target===e){if(!this.isSupportedDropTransfer(t))return void(t.dataTransfer&&(t.dataTransfer.dropEffect="none"));this.editorTransfer.hasData(Wt.B.prototype)||t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,t)}},onDragLeave:t=>{this.updateDropFeedback(e,!1,t),e.classList.remove("scroll")},onDragEnd:t=>{this.updateDropFeedback(e,!1,t),e.classList.remove("scroll"),this.onGroupDragEnd(t,i,e,o)},onDrop:t=>{if(this.updateDropFeedback(e,!1,t),e.classList.remove("scroll"),t.target===e){let i=this.groupTransfer.hasData(Wt.z.prototype);this.onDrop(t,i?this.groupView.count:this.tabsModel.count,e)}}})),this._register((0,Rt.ox)(e,Rt.tx.MOUSE_WHEEL,e=>{let t=this.groupView.activeEditor;if(!t||this.groupView.count<2)return;if(!0===this.groupsView.partOptions.scrollToSwitchTabs){if(e.shiftKey)return}else if(!e.shiftKey)return;let i,o=Date.now();if(o-this.lastMouseWheelEventTime<Cn.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(e.deltaX)+Math.abs(e.deltaY)))return;if(this.lastMouseWheelEventTime=o,e.deltaX+e.deltaY<-Cn.MOUSE_WHEEL_DISTANCE_THRESHOLD)i=-1;else{if(!(e.deltaX+e.deltaY>Cn.MOUSE_WHEEL_DISTANCE_THRESHOLD))return;i=1}let s=this.groupView.getEditorByIndex(this.groupView.getIndexOfEditor(t)+i);s&&(this.groupView.openEditor(s),Rt.ex.stop(e,!0))}));let s=t=>{Rt.ex.stop(t);let i=e;(0,Rt.lS)(t)&&(i=new Rt.NT((0,Rt.Bx)(this.parent),t)),this.contextMenuService.showContextMenu({getAnchor:()=>i,menuId:Rt.sb.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.groupView.id}),getKeyBinding:e=>this.getKeybinding(e),onHide:()=>this.groupView.focus()})};this._register((0,Rt.ox)(e,Rt._m.Contextmenu,e=>s(e))),this._register((0,Rt.ox)(e,Rt.tx.CONTEXT_MENU,e=>s(e)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e,t){let i=this.handleOpenedEditors();return null!==t&&void 0!==t&&t.focusTabControl&&this.withTab(e,(e,t,i)=>i.focus()),i}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){this.updateTabsControlVisibility();let[e,t]=(0,Rt.Qj)(this.tabsContainer,this.tabsScrollbar);for(let r=e.children.length;r<this.tabsModel.count;r++)e.appendChild(this.createTab(r,e,t));let i=this.didActiveEditorChange(),o=this.tabLabels;this.computeTabLabels();let s=!1;return i||o.length!==this.tabLabels.length||o.some((e,t)=>!this.equalsEditorInputLabel(e,this.tabLabels.at(t)))?(this.redraw({forceRevealActiveTab:!0}),s=!0):this.layout(this.dimensions,{forceRevealActiveTab:!0}),s}didActiveEditorChange(){var e,t,i;return!((null!==(e=this.activeTabLabel)&&void 0!==e&&e.editor||!this.tabsModel.activeEditor)&&(null===(t=this.activeTabLabel)||void 0===t||!t.editor||this.tabsModel.activeEditor)&&null!==(i=this.activeTabLabel)&&void 0!==i&&i.editor&&this.tabsModel.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,t){return e===t||!(!e||!t)&&(e.name===t.name&&e.description===t.description&&e.forceDescription===t.forceDescription&&e.title===t.title&&e.ariaLabel===t.ariaLabel)}beforeCloseEditor(e){if(this.isMouseOverTabs&&"fixed"===this.groupsView.partOptions.tabSizing){let t=this.tabsModel.isLast(e);this.updateTabsFixedWidth(!t)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){if(this.tabsModel.count){let t=(0,Rt.$j)(this.tabsContainer);for(;t.children.length>this.tabsModel.count;){var e;null!==(e=t.lastChild)&&void 0!==e&&e.remove(),(0,Rt.MA)(this.tabDisposables.pop())}this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&(0,Rt.fx)(this.tabsContainer),this.tabDisposables=(0,Rt.MA)(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),this.updateTabsControlVisibility()}moveEditor(e,t,i){let o=this.tabLabels[t];this.tabLabels.splice(t,1),this.tabLabels.splice(i,0,o),this.forEachTab((e,t,i,o,s,r)=>{this.redrawTab(e,t,i,o,s,r)},Math.min(t,i),Math.max(t,i)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(e,t,i,o,s)=>this.redrawTabLabel(e,t,i,o,s))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(e,t,i,o,s,r)=>this.redrawTab(e,t,i,o,s,r)),this.forEachTab((e,t,i,o,s)=>{this.redrawTabBorders(t,i)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((t,i,o,s,r,n)=>{this.redrawTabSelectedActiveAndDirty(e,t,o,n)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorSelections(){this.forEachTab((e,t,i,o,s,r)=>{this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r)})}updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,t,i,o,s)=>{this.redrawTabLabel(e,t,i,o,s)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(e,t,i,o,s,r)=>this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r))}updateOptions(e,t){super.updateOptions(e,t),e.labelFormat!==t.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==t.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),e.titleScrollbarVisibility!==t.titleScrollbarVisibility&&this.updateTabsScrollbarVisibility(),e.alwaysShowEditorActions!==t.alwaysShowEditorActions&&this.updateEditorActionsToolbar(),(e.tabSizingFixedMinWidth!==t.tabSizingFixedMinWidth||e.tabSizingFixedMaxWidth!==t.tabSizingFixedMaxWidth||e.tabSizing!==t.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==t.labelFormat||e.tabActionLocation!==t.tabActionLocation||e.tabActionCloseVisibility!==t.tabActionCloseVisibility||e.tabActionUnpinVisibility!==t.tabActionUnpinVisibility||e.tabSizing!==t.tabSizing||e.pinnedTabSizing!==t.pinnedTabSizing||e.showIcons!==t.showIcons||e.hasIcons!==t.hasIcons||e.highlightModifiedTabs!==t.highlightModifiedTabs||e.wrapTabs!==t.wrapTabs||e.showTabIndex!==t.showTabIndex||!(0,Rt.Gj)(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,t,i){this.tabsModel.getEditors(Pt.Ut.SEQUENTIAL).forEach((o,s)=>{"number"==typeof t&&t>s||"number"==typeof i&&i<s||this.doWithTab(s,o,e)})}withTab(e,t){this.doWithTab(this.tabsModel.indexOf(e),e,t)}doWithTab(e,t,i){let o=(0,Rt.$j)(this.tabsContainer).children[e],s=this.tabResourceLabels.get(e),r=this.tabLabels[e],n=this.tabActionBars[e];o&&s&&r&&i(t,e,o,s,r,n)}createTab(e,t,i){let o=(0,Rt.Zb)(".tab",{draggable:!0,role:"tab"}),s=Rt.vm.addTarget(o),r=(0,Rt.Zb)(".tab-border-top-container");o.appendChild(r);let n=this.tabResourceLabels.create(o,{hoverTargetOverride:o}),a=(0,Rt.Zb)(".tab-actions");o.appendChild(a);let d=this,l=new er({groupId:this.groupView.id,get editorIndex(){return d.toEditorIndex(e)}}),c=new Rt.Lr(a,{ariaLabel:(0,Rt.Ij)(3506,"Tab actions"),actionRunner:l}),h=(0,Rt.jA)(l,c,c.onWillRun(e=>{e.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()}),(0,Rt.zA)((0,Rt.GM)(this.tabActionBars,c))),u=(0,Rt.Zb)(".tab-fade-hider");o.appendChild(u);let g=(0,Rt.Zb)(".tab-border-bottom-container");o.appendChild(g);let p=this.registerTabListeners(o,e,t,i);return this.tabDisposables.push((0,Rt.jA)(s,p,h,n)),o}toEditorIndex(e){let t=(0,Rt.$j)(this.tabsModel.getEditorByIndex(e));return this.groupView.getIndexOfEditor(t)}registerTabListeners(e,t,i,o){let s=new Rt.EA,r=async(i,o)=>{if(e.blur(),(0,Rt.lS)(i)&&(0!==i.button||Rt.Cj&&i.ctrlKey))return void(1===i.button&&i.preventDefault());if(this.originatesFromTabActionBar(i))return;let s=this.tabsModel.getEditorByIndex(t);if(s)if(i.shiftKey){let e;if(this.lastSingleSelectSelectedEditor&&this.tabsModel.isSelected(this.lastSingleSelectSelectedEditor))e=this.lastSingleSelectSelectedEditor;else{let t=(0,Rt.$j)(this.groupView.activeEditor);this.lastSingleSelectSelectedEditor=t,e=t}await this.selectEditorsBetween(s,e)}else if(i.ctrlKey&&!Rt.Cj||i.metaKey&&Rt.Cj)this.tabsModel.isSelected(s)?await this.unselectEditor(s):(await this.selectEditor(s),this.lastSingleSelectSelectedEditor=s);else{let e=this.tabsModel.isSelected(s)?this.groupView.selectedEditors.filter(e=>!e.matches(s)):[];await this.groupView.openEditor(s,{preserveFocus:o,activation:Rt.Jp.ACTIVATE},{inactiveSelection:e,focusTabControl:!0})}},n=i=>{Rt.ex.stop(i);let o=this.tabsModel.getEditorByIndex(t);o&&this.onTabContextMenu(o,i,e)};s.add((0,Rt.ox)(e,Rt.tx.MOUSE_DOWN,e=>r(e,!1))),s.add((0,Rt.ox)(e,Rt._m.Tap,e=>r(e,!0))),s.add((0,Rt.ox)(e,Rt._m.Change,e=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-e.translationX})})),s.add((0,Rt.ox)(e,Rt.tx.MOUSE_UP,async t=>{Rt.ex.stop(t),e.blur(),(!(0,Rt.lS)(t)||!(0!==t.button||Rt.Cj&&t.ctrlKey))&&(this.originatesFromTabActionBar(t)||!(t.ctrlKey&&!Rt.Cj||t.metaKey&&Rt.Cj)&&!t.shiftKey&&this.groupView.selectedEditors.length>1&&await this.unselectAllEditors())})),s.add((0,Rt.ox)(e,Rt.tx.AUXCLICK,e=>{if(1===e.button){Rt.ex.stop(e,!0);let i=this.tabsModel.getEditorByIndex(t);if(i){if((0,Pt.vn)(this.tabsModel,i,Pt.Lt.MOUSE,this.groupsView.partOptions))return;this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(i)})}}})),s.add((0,Rt.ox)(e,Rt.tx.KEY_DOWN,e=>{let t=new Rt.RT(e);t.shiftKey&&t.keyCode===Rt.YD.F10&&n(e)})),s.add((0,Rt.ox)(e,Rt._m.Contextmenu,e=>{n(e)})),s.add((0,Rt.ox)(e,Rt.tx.KEY_UP,e=>{let s=new Rt.RT(e),r=!1;if(s.equals(Rt.YD.Enter)||s.equals(Rt.YD.Space)){r=!0;let e=this.tabsModel.getEditorByIndex(t);e&&this.groupView.openEditor(e)}else if([Rt.YD.LeftArrow,Rt.YD.RightArrow,Rt.YD.UpArrow,Rt.YD.DownArrow,Rt.YD.Home,Rt.YD.End].some(e=>s.equals(e))){let e=this.toEditorIndex(t);s.equals(Rt.YD.LeftArrow)||s.equals(Rt.YD.UpArrow)?--e:s.equals(Rt.YD.RightArrow)||s.equals(Rt.YD.DownArrow)?e+=1:e=s.equals(Rt.YD.Home)?0:this.groupView.count-1;let i=this.groupView.getEditorByIndex(e);i&&(r=!0,this.groupView.openEditor(i,{preserveFocus:!0},{focusTabControl:!0}))}r&&Rt.ex.stop(e,!0),o.setScrollPosition({scrollLeft:i.scrollLeft})}));for(let l of[Rt._m.Tap,Rt.tx.DBLCLICK])s.add((0,Rt.ox)(e,l,e=>{if(l===Rt.tx.DBLCLICK)Rt.ex.stop(e);else if(2!==e.tapCount)return;let i=this.tabsModel.getEditorByIndex(t);if(i&&this.tabsModel.isPinned(i))switch(this.groupsView.partOptions.doubleClickTabToToggleEditorGroupSizes){case"maximize":this.groupsView.toggleMaximizeGroup(this.groupView);break;case"expand":this.groupsView.toggleExpandGroup(this.groupView)}else this.groupView.pinEditor(i)}));s.add((0,Rt.ox)(e,Rt.tx.CONTEXT_MENU,i=>{Rt.ex.stop(i,!0);let o=this.tabsModel.getEditorByIndex(t);o&&this.onTabContextMenu(o,i,e)},!0));let a,d=!1;return s.add(new Rt.$b(e,{onDragStart:i=>{let o=this.tabsModel.getEditorByIndex(t);if(!o)return;d=this.isNewWindowOperation(i);let s=this.groupView.selectedEditors;this.editorTransfer.setData(s.map(e=>new Wt.B({editor:e,groupId:this.groupView.id})),Wt.B.prototype),i.dataTransfer&&(i.dataTransfer.effectAllowed="copyMove",s.length>1?(0,Rt.sa)(i,e,"".concat(o.getName()," + ").concat(s.length-1)):i.dataTransfer.setDragImage(e,0,0)),this.doFillResourceDataTransfers(s,i,d),(0,Rt.CS)((0,Rt.Bx)(this.parent),()=>this.updateDropFeedback(e,!1,i,t))},onDrag:e=>{a=e},onDragEnter:i=>{this.isSupportedDropTransfer(i)?(this.editorTransfer.hasData(Wt.B.prototype)||i.dataTransfer&&(i.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,i,t)):i.dataTransfer&&(i.dataTransfer.dropEffect="none")},onDragOver:(i,o)=>{if(o>=Cn.DRAG_OVER_OPEN_TAB_THRESHOLD){let e=this.tabsModel.getEditorByIndex(t);e&&this.tabsModel.activeEditor!==e&&this.groupView.openEditor(e,{preserveFocus:!0})}this.updateDropFeedback(e,!0,i,t)},onDragEnd:async i=>{this.updateDropFeedback(e,!1,i,t);let o=this.editorTransfer.getData(Wt.B.prototype);if(this.editorTransfer.clearData(Wt.B.prototype),!d||(0,Wt.G)()||!o||0===o.length)return;let s=await this.maybeCreateAuxiliaryEditorPartAt(i,e);if(!s)return;let r=s.activeGroup,n=(0,Lt.Q)(this.groupView,o.map(e=>e.identifier.editor));this.isMoveOperation(null!==a&&void 0!==a?a:i,r.id,o[0].identifier.editor)?this.groupView.moveEditors(n,r):this.groupView.copyEditors(n,r),r.focus()},onDrop:o=>{this.updateDropFeedback(e,!1,o,t);let s=t;"right"===this.getTabDragOverLocation(o,e)&&s++,this.onDrop(o,s,i)}})),s}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(Wt.z.prototype)){let e=this.groupTransfer.getData(Wt.z.prototype);return!(Array.isArray(e)&&e.length>0&&e[0].identifier===this.groupView.id)}return!!(this.editorTransfer.hasData(Wt.B.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,t,i,o){let s;s=t?"number"==typeof o?this.computeDropTarget(i,o,e):{leftElement:e.lastElementChild,rightElement:void 0}:void 0,this.updateDropTarget(s)}updateDropTarget(e){var t,i,o,s;let r=this.dropTarget;if(r===e||r&&e&&r.leftElement===e.leftElement&&r.rightElement===e.rightElement)return;let n="drop-target-left",a="drop-target-right";r&&(null!==(t=r.leftElement)&&void 0!==t&&t.classList.remove(n),null!==(i=r.rightElement)&&void 0!==i&&i.classList.remove(a)),e&&(null!==(o=e.leftElement)&&void 0!==o&&o.classList.add(n),null!==(s=e.rightElement)&&void 0!==s&&s.classList.add(a)),this.dropTarget=e}getTabDragOverLocation(e,t){let i=t.getBoundingClientRect();return e.clientX-i.left<=i.width/2?"left":"right"}computeDropTarget(e,t,i){let o="left"===this.getTabDragOverLocation(e,i),s=t===this.tabsModel.count-1;return o&&0===t?{leftElement:void 0,rightElement:i}:!o&&s?{leftElement:i,rightElement:void 0}:{leftElement:o?i.previousElementSibling:i,rightElement:o?i:i.nextElementSibling}}async selectEditor(e){this.groupView.isActive(e)||await this.groupView.setSelection(e,this.groupView.selectedEditors)}async selectEditorsBetween(e,t){let i=this.groupView.getIndexOfEditor(e);if(-1===i)throw new Rt.lN;let o=this.groupView.getIndexOfEditor(t);if(-1===o)throw new Rt.lN;let s=this.groupView.selectedEditors,r=o;for(;r>=0&&r<=this.groupView.count-1;){r=o<i?r-1:r+1;let e=this.groupView.getEditorByIndex(r);if(!e||!this.groupView.isSelected(e))break;s=s.filter(t=>!t.matches(e))}let n=o<i?o:i,a=o<i?i:o,d=this.groupView.getEditors(Pt.Ut.SEQUENTIAL).slice(n,a+1);for(let c of d)this.groupView.isSelected(c)||s.push(c);let l=s.filter(t=>!t.matches(e));await this.groupView.setSelection(e,l)}async unselectEditor(e){let t=this.groupView.isActive(e);if(t&&1===this.groupView.selectedEditors.length)return;let i=(0,Rt.$j)(this.groupView.activeEditor);if(t){let e=this.groupView.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE);for(let t=1;t<e.length;t++){let o=e[t];if(this.groupView.isSelected(o)){i=o;break}}}let o=this.groupView.selectedEditors.filter(t=>!t.matches(e)&&!t.matches(i));await this.groupView.setSelection(i,o)}async unselectAllEditors(){if(this.groupView.selectedEditors.length>1){let e=(0,Rt.$j)(this.groupView.activeEditor);await this.groupView.setSelection(e,[])}}computeTabLabels(){let{labelFormat:e}=this.groupsView.partOptions,{verbosity:t,shortenDuplicates:i}=this.getLabelConfigFlags(e),o=[],s=-1;this.tabsModel.getEditors(Pt.Ut.SEQUENTIAL).forEach((e,i)=>{o.push({editor:e,name:e.getName(),description:e.getDescription(t),forceDescription:e.hasCapability(Pt.zt.ForceDescription),title:e.getTitle(Pt.Xt.LONG),ariaLabel:(0,Tt.d)(e,i,this.groupView,this.editorPartsView.count)}),e===this.tabsModel.activeEditor&&(s=i)}),i&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[s]}shortenTabLabels(e){let t=new Map;for(let i of e)"string"==typeof i.description?(0,Rt.ZA)(t,i.name,[]).push(i):i.description="";for(let[,i]of t){if(1===i.length&&!i[0].forceDescription){i[0].description="";continue}let e=new Map;for(let r of i)(0,Rt.ZA)(e,r.description,[]).push(r);let t=!1;for(let[,i]of e)if(!t&&i.length>1){let[e,...o]=i.map(e=>{let{editor:t}=e;return t.getDescription(Pt.Xt.LONG)});t=o.some(t=>t!==e)}if(t){e.clear();for(let t of i)t.description=t.editor.getDescription(Pt.Xt.LONG),(0,Rt.ZA)(e,t.description,[]).push(t)}let o=[];for(let[i]of e)o.push(i);if(1===o.length){for(let t of e.get(o[0])||[])t.forceDescription||(t.description="");continue}let s=(0,Pt.ut)(o,this.path.sep);o.forEach((t,i)=>{for(let o of e.get(t)||[])o.description=s[i]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:Pt.Xt.SHORT,shortenDuplicates:!1};case"medium":return{verbosity:Pt.Xt.MEDIUM,shortenDuplicates:!1};case"long":return{verbosity:Pt.Xt.LONG,shortenDuplicates:!1};default:return{verbosity:Pt.Xt.MEDIUM,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let e=this.getColor(Lt.St);!e&&(0,Rt.Em)(this.theme.type)&&(e=this.getColor(Lt.wn)||this.getColor(Rt._g)),e?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",e.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((e,t,i,o,s,r)=>{this.redrawTab(e,t,i,o,s,r)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,t,i,o,s,r){let n=this.tabsModel.isSticky(t),a=this.groupsView.partOptions;this.redrawTabLabel(e,t,i,o,s);let d,l=n&&a.tabActionUnpinVisibility,c=!l&&a.tabActionCloseVisibility,h=l||c;d=h?l?this.unpinEditorAction:this.closeEditorAction:n?this.unpinEditorAction:this.closeEditorAction,r.hasAction(d)||(r.isEmpty()||r.clear(),r.push(d,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(d)})),i.classList.toggle("pinned-action-off",n&&!l),i.classList.toggle("close-action-off",!l&&!c);for(let g of["left","right"])i.classList.toggle("tab-actions-".concat(g),h&&a.tabActionLocation===g);let u=n&&"shrink"===a.pinnedTabSizing?"shrink":a.tabSizing;for(let g of["fit","shrink","fixed"])i.classList.toggle("sizing-".concat(g),u===g);i.classList.toggle("has-icon",a.showIcons&&a.hasIcons),i.classList.toggle("sticky",n);for(let g of["normal","compact","shrink"])i.classList.toggle("sticky-".concat(g),n&&a.pinnedTabSizing===g);if(!a.wrapTabs&&n&&"normal"!==a.pinnedTabSizing){let e=0;switch(a.pinnedTabSizing){case"compact":e=Cn.TAB_WIDTH.compact;break;case"shrink":e=Cn.TAB_WIDTH.shrink}i.style.left="".concat(t*e,"px")}else i.style.left="auto";this.redrawTabBorders(t,i),this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r)}redrawTabLabel(e,t,i,o,s){var r,n,a;let d,l,c,h=this.groupsView.partOptions,u=!1,g=!(null===(r=h.decorations)||void 0===r||!r.badges),p=!(null===(n=h.decorations)||void 0===n||!n.colors);"compact"===h.pinnedTabSizing&&this.tabsModel.isSticky(t)?(d=h.showIcons&&h.hasIcons?"":null===(a=s.name)||void 0===a?void 0:a.charAt(0).toUpperCase(),c="",u=!0,g=!1):(d=s.name,l=h.showTabIndex?"".concat(this.toEditorIndex(t)+1,": "):void 0,c=s.description||""),s.ariaLabel&&(i.setAttribute("aria-label",s.ariaLabel),i.setAttribute("aria-description","")),o.setResource({name:d,description:c,resource:Pt.Ht.getOriginalUri(e,{supportSideBySide:Pt.Jt.BOTH})},{title:this.getHoverTitle(e),extraClasses:(0,Rt.AM)(["tab-label",g?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.tabsModel.isPinned(e),forceLabel:u,fileDecorations:{colors:p,badges:g},icon:e.getIcon(),hideIcon:!1===h.showIcons,namePrefix:l});let b=Pt.Ht.getOriginalUri(e,{supportSideBySide:Pt.Jt.PRIMARY});b?i.setAttribute("data-resource-name",(0,Rt.Zw)(b)):i.removeAttribute("data-resource-name")}redrawTabSelectedActiveAndDirty(e,t,i,o){let s=this.tabsModel.isActive(t),r=this.doRedrawTabDirty(e,s,t,i);this.doRedrawTabActive(e,!r,t,i,o)}doRedrawTabActive(e,t,i,o,s){let r=this.tabsModel.isActive(i),n=this.tabsModel.isSelected(i);if(o.classList.toggle("active",r),o.classList.toggle("selected",n),o.setAttribute("aria-selected",r?"true":"false"),o.tabIndex=r?0:-1,s.setFocusable(r),r){let t=this.getColor(e?Lt.bn:Lt.Nn);o.classList.toggle("tab-border-bottom",!!t),o.style.setProperty("--tab-border-bottom-color",null!==t&&void 0!==t?t:"")}let a=null;t&&(r&&(a=this.getColor(e?Lt.xn:Lt.Pn)),null===a&&n&&(a=this.getColor(Lt.jn))),o.classList.toggle("tab-border-top",!!a),o.style.setProperty("--tab-border-top-color",null!==a&&void 0!==a?a:"")}doRedrawTabDirty(e,t,i,o){let s=!1;if(i.isDirty()&&!i.isSaving())if(o.classList.add("dirty"),this.groupsView.partOptions.highlightModifiedTabs){let i;i=e&&t?this.getColor(Lt.Cn):e&&!t?this.getColor(Lt.kn):!e&&t?this.getColor(Lt.In):this.getColor(Lt.Vn),i&&(s=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",i))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return s}redrawTabBorders(e,t){let i=this.tabsModel.isSticky(e)&&this.tabsModel.stickyCount===e+1,o=this.tabsModel.stickyCount!==this.tabsModel.count,s=(i&&o?this.getColor(Lt.An):void 0)||this.getColor(Lt.wn)||this.getColor(Rt._g);t.style.borderRight=s?"1px solid ".concat(s):"",t.style.outlineColor=this.getColor(Rt.gg)||""}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(e=>e.id===Is),secondary:e.secondary}}getHeight(){return this.dimensions.used?this.dimensions.used.height:this.computeHeight()}computeHeight(){var e;let t;return t=this.visible?this.groupsView.partOptions.wrapTabs&&null!==(e=this.tabsAndActionsContainer)&&void 0!==e&&e.classList.contains("wrapping")?this.tabsAndActionsContainer.offsetHeight:this.tabHeight:0,t}layout(e,t){if(Object.assign(this.dimensions,e),this.visible){if(!this.layoutScheduler.value){let e=(0,Rt.CS)((0,Rt.Bx)(this.parent),()=>{var e;this.doLayout(this.dimensions,null===(e=this.layoutScheduler.value)||void 0===e?void 0:e.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:t,dispose:()=>e.dispose()}}(null===t||void 0===t?void 0:t.forceRevealActiveTab)&&(this.layoutScheduler.value.options=(0,xt.A)((0,xt.A)({},this.layoutScheduler.value.options),{},{forceRevealActiveTab:!0}))}return this.dimensions.used||(this.dimensions.used=new Rt.Qb(e.container.width,this.computeHeight())),this.dimensions.used}doLayout(e,t){e.container!==Rt.Qb.None&&e.available!==Rt.Qb.None&&this.doLayoutTabs(e,t);let i=this.dimensions.used,o=this.dimensions.used=new Rt.Qb(e.container.width,this.computeHeight());i&&i.height!==o.height&&this.groupView.relayout()}doLayoutTabs(e,t){this.doLayoutTabsWrapping(e)||this.doLayoutTabsNonWrapping(t)}doLayoutTabsWrapping(e){let[t,i,o,s]=(0,Rt.Qj)(this.tabsAndActionsContainer,this.tabsContainer,this.editorActionsToolbarContainer,this.tabsScrollbar),r=t.classList.contains("wrapping"),n=r;function a(e){n=e,t.classList.toggle("wrapping",n),i.style.setProperty("--last-tab-margin-right",n?"".concat(o.offsetWidth,"px"):"0");for(let t of i.children)t.classList.remove("last-in-row")}if(this.groupsView.partOptions.wrapTabs){let t=i.offsetWidth,s=i.scrollWidth,r=()=>{let t=this.getLastTab();return!t||!(t.offsetWidth+o.offsetWidth-e.available.width>1)};(n||s>t&&r())&&a(!0),n&&(i.offsetHeight>e.available.height||s===t&&i.offsetHeight===this.tabHeight||!r())&&a(!1)}else r&&a(!1);if(n&&!r){let e=i.offsetWidth;s.setScrollDimensions({width:e,scrollWidth:e})}if(n){let e,t,o=new Map;for(let s of i.children){let i=s,r=i.offsetTop;r!==e&&(e=r,t&&o.set(t,!0)),t=i,o.set(i,!1)}t&&o.set(t,!0);for(let[i,s]of o)i.classList.toggle("last-in-row",s)}return n}doLayoutTabsNonWrapping(e){var t;let[i,o]=(0,Rt.Qj)(this.tabsContainer,this.tabsScrollbar),s=i.offsetWidth,r=i.scrollWidth,n=0;if(this.tabsModel.stickyCount>0){let e=0;switch(this.groupsView.partOptions.pinnedTabSizing){case"compact":e=Cn.TAB_WIDTH.compact;break;case"shrink":e=Cn.TAB_WIDTH.shrink}n=this.tabsModel.stickyCount*e}let a,d,[l,c]=null!==(t=this.tabsModel.activeEditor?this.getTabAndIndex(this.tabsModel.activeEditor):void 0)&&void 0!==t?t:[void 0,void 0],h="normal"!==this.groupsView.partOptions.pinnedTabSizing&&"number"==typeof c&&this.tabsModel.isSticky(c),u=s-n;this.tabsModel.stickyCount>0&&u<Cn.TAB_WIDTH.fit?(i.classList.add("disable-sticky-tabs"),u=s,n=0,h=!1):i.classList.remove("disable-sticky-tabs"),!this.blockRevealActiveTab&&l&&(a=l.offsetLeft,d=l.offsetWidth);let{width:g,scrollWidth:p}=o.getScrollDimensions();o.setScrollDimensions({width:s,scrollWidth:r});let b=g!==s||p!==r;if(this.blockRevealActiveTab||"number"!=typeof a||"number"!=typeof d||h||!b&&(null===e||void 0===e||!e.forceRevealActiveTab))return void(this.blockRevealActiveTab=!1);let m=o.getScrollPosition().scrollLeft,v=d<=u,C=a-n;v&&m+u<C+d?o.setScrollPosition({scrollLeft:m+(C+d-(m+u))}):(m>C||!v)&&o.setScrollPosition({scrollLeft:C})}updateTabsControlVisibility(){(0,Rt.$j)(this.tabsAndActionsContainer).classList.toggle("empty",!this.visible),!this.visible&&this.dimensions&&(this.dimensions.used=void 0)}get visible(){return this.tabsModel.count>0}getTabAndIndex(e){let t=this.tabsModel.indexOf(e),i=this.getTabAtIndex(t);if(i)return[i,t]}getTabAtIndex(e){if(e>=0)return(0,Rt.$j)(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.tabsModel.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let t;return t=(0,Rt.lS)(e)?e.target||e.srcElement:e.initialTarget,!!(0,Rt.Cx)(t,"action-item","tab")}async onDrop(e,t,i){Rt.ex.stop(e,!0),this.updateDropFeedback(i,!1,e,t),i.classList.remove("scroll");let o=this.tabsModel instanceof fn?t+this.groupView.stickyCount:t,s={sticky:this.tabsModel instanceof yn&&this.tabsModel.stickyCount===o,index:o};if(this.groupTransfer.hasData(Wt.z.prototype)){let t=this.groupTransfer.getData(Wt.z.prototype);if(Array.isArray(t)&&t.length>0){let i=this.editorPartsView.getGroup(t[0].identifier);if(i){let t={index:o};this.isMoveOperation(e,i.id)||(t.mode=Pt.Z.COPY_EDITORS),this.groupsView.mergeGroup(i,this.groupView,t)}this.groupView.focus(),this.groupTransfer.clearData(Wt.z.prototype)}}else if(this.editorTransfer.hasData(Wt.B.prototype)){let t=this.editorTransfer.getData(Wt.B.prototype);if(Array.isArray(t)&&t.length>0){let i=this.editorPartsView.getGroup(t[0].identifier.groupId);if(i)for(let r of t){let t=r.identifier.editor;if(i.id!==r.identifier.groupId)continue;let n=i.getIndexOfEditor(t);i===this.groupView&&n<o&&o--,this.isMoveOperation(e,r.identifier.groupId,t)?i.moveEditor(t,this.groupView,(0,xt.A)((0,xt.A)({},s),{},{index:o})):i.copyEditor(t,this.groupView,(0,xt.A)((0,xt.A)({},s),{},{index:o})),o++}}this.groupView.focus(),this.editorTransfer.clearData(Wt.B.prototype)}else if(this.treeItemsTransfer.hasData(Wt.hm.prototype)){let e=this.treeItemsTransfer.getData(Wt.hm.prototype);if(Array.isArray(e)&&e.length>0){let t=[];for(let i of e){let e=await this.treeViewsDragAndDropService.removeDragOperationTransfer(i.identifier);if(e){let i=await(0,Wt.H)(e);t.push(...i.map(e=>(0,xt.A)((0,xt.A)({},e),{},{options:(0,xt.A)((0,xt.A)({},e.options),{},{pinned:!0,index:o})})))}}this.editorService.openEditors(t,this.groupView,{validateTrust:!0})}this.treeItemsTransfer.clearData(Wt.hm.prototype)}else this.instantiationService.createInstance(Wt.V,{allowWorkspaceOpen:!1}).handleDrop(e,(0,Rt.Bx)(this.parent),()=>this.groupView,()=>this.groupView.focus(),s)}dispose(){super.dispose(),this.tabDisposables=(0,Rt.MA)(this.tabDisposables)}},{_:Cn=O},{_:O.SCROLLBAR_SIZES={default:3,large:10}},{_:O.TAB_WIDTH={compact:38,shrink:80,fit:120}},{_:O.DRAG_OVER_OPEN_TAB_THRESHOLD=1500},{_:O.MOUSE_WHEEL_EVENT_THRESHOLD=150},{_:O.MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5},O);Sn=Cn=(0,Rt.Pb)([(0,Rt.Fb)(5,Rt.Sl),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.yb),(0,Rt.Fb)(8,Rt.kd),(0,Rt.Fb)(9,Rt.Ld),(0,Rt.Fb)(10,Rt.xc),(0,Rt.Fb)(11,Rt.Qd),(0,Rt.Fb)(12,Pt.kt),(0,Rt.Fb)(13,Pt.A),(0,Rt.Fb)(14,Wt.oC),(0,Rt.Fb)(15,Lt.I),(0,Rt.Fb)(16,Lt.P)],Sn),(0,Rt.fp)((e,t)=>{let i=e.getColor(Lt.wn);i&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {\n\t\t\t\tborder-bottom: 1px solid ".concat(i,";\n\t\t\t}\n\t\t"));let o=e.getColor(Rt.gg);o&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {\n\t\t\t\toutline: 1px solid;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.selected:not(.active):not(:hover)  {\n\t\t\t\toutline: 1px dotted;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:focus {\n\t\t\t\toutline-style: dashed;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {\n\t\t\t\toutline: 1px dotted;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {\n\t\t\t\toutline: 1px dashed;\n\t\t\t\toutline-offset: -5px;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t");let s=e.getColor(Rt._g);s&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {\n\t\t\t\toutline: 1px solid ".concat(s,"\n\t\t\t}\n\t\t"));let r=e.getColor(Lt.Tn);r&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover {\n\t\t\t\tbackground-color: ".concat(r," !important;\n\t\t\t}\n\t\t"));let n=e.getColor(Lt.Ln);n&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {\n\t\t\t\tbackground-color: ".concat(n," !important;\n\t\t\t}\n\t\t"));let a=e.getColor(Lt.Dn);a&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover  {\n\t\t\t\tcolor: ".concat(a," !important;\n\t\t\t}\n\t\t"));let d=e.getColor(Lt.zn);d&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {\n\t\t\t\tcolor: ".concat(d," !important;\n\t\t\t}\n\t\t"));let l=e.getColor(Lt.En);l&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t\twidth: 100%;\n\t\t\t\tz-index: 10;\n\t\t\t\tbottom: 0;\n\t\t\t\theight: 1px;\n\t\t\t\tbackground-color: ".concat(l,";\n\t\t\t}\n\t\t"));let c=e.getColor(Lt.Rn);if(c&&t.addRule("\n\t\t\t.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\tleft: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t\twidth: 100%;\n\t\t\t\tz-index: 10;\n\t\t\t\tbottom: 0;\n\t\t\t\theight: 1px;\n\t\t\t\tbackground-color: ".concat(c,";\n\t\t\t}\n\t\t")),!(0,Rt.Em)(e.type)&&!Rt.aE&&!o){let i,o,s=(0,Lt.Yn)(e),a=e.getColor(Rt.Th),d=e.getColor(Lt.xt),l=e.getColor(Lt.pt);d&&a&&(i=d.flatten(a,a,s)),d&&a&&l&&a&&(o=d.flatten(a,l,a,s));let c=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"\n\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container".concat(i?".active":""," > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,\n\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container").concat(i?".active":""," > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\tbackground: linear-gradient(to left, ").concat(e,", transparent) !important;\n\t\t\t}\n\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":""," > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,\n\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":""," > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\tbackground: linear-gradient(to left, ").concat(t,", transparent) !important;\n\t\t\t}\n\t\t")};if(r&&i&&o){let e=r.flatten(i),s=r.flatten(o);t.addRule(c(e,s,!0))}if(n&&i&&o){let e=n.flatten(i),s=n.flatten(o);t.addRule(c(e,s))}if(l&&o){let e=l.flatten(o);t.addRule("\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ".concat(e,", transparent) !important;\n\t\t\t\t}\n\t\t"))}let h=(e,t,i,o)=>"\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container".concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-shrink").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container").concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-fixed").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ").concat(e,", transparent);\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-shrink").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,\n\t\t\t\t.monaco-workbench .part.editor > .content.dragged-over .editor-group-container").concat(i?".active":":not(.active)"," > .title .tabs-container > .tab.sizing-fixed").concat(o?".active":"",":not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {\n\t\t\t\t\tbackground: linear-gradient(to left, ").concat(t,", transparent);\n\t\t\t\t}\n\t\t"),u=e.getColor(Lt.yn);if(u&&i&&o){let e=u.flatten(i),s=u.flatten(o);t.addRule(h(e,s,!0,!0))}let g=e.getColor(Lt.Mn);if(g&&i&&o){let e=g.flatten(i),s=g.flatten(o);t.addRule(h(e,s,!1,!0))}let p=e.getColor(Lt.On);if(p&&i&&o){let e=p.flatten(i),s=p.flatten(o);t.addRule(h(e,s,!0,!1))}let b=e.getColor(Lt.Bn);if(b&&i&&o){let e=b.flatten(i),s=b.flatten(o);t.addRule(h(e,s,!1,!1))}}});var In={};(0,Rt.fE)(),(0,Pt.en)(),(0,Wt.ot)(),(0,Lt.Xn)(),(0,Rt.ym)(),(0,Rt.qx)(),(0,Rt.Ev)(),(0,Rt.nM)(),(0,Rt.qj)(),(0,Rt.PA)(),(0,Rt.Mi)(),(0,Rt.mE)(In);var kn=class extends tr{constructor(){super(...arguments),this.activeLabel=Object.create(null)}get breadcrumbsControl(){var e;return null===(e=this.breadcrumbsControlFactory)||void 0===e?void 0:e.control}create(e){super.create(e);let t=this.titleContainer=e;t.draggable=!0,this.registerContainerListeners(t),this._register(Rt.vm.addTarget(t));let i=(0,Rt.Zb)(".label-container");return t.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(Wt.it,i,{})).element,this._register((0,Rt.ox)(this.editorLabel.element,Rt.tx.CLICK,e=>this.onTitleLabelClick(e))),this.breadcrumbsControlFactory=this._register(this.instantiationService.createInstance(No,i,this.groupView,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:(0,xt.A)((0,xt.A)({},Rt.bi),{},{breadcrumbsBackground:Rt.Sv.transparent.toString()}),showPlaceholder:!1,dragEditor:!0})),this._register(this.breadcrumbsControlFactory.onDidEnablementChange(()=>this.handleBreadcrumbsEnablementChange())),t.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register((0,Rt.zA)(()=>t.classList.remove("breadcrumbs"))),this.createEditorActionsToolBar(t,["title-actions"]),t}registerContainerListeners(e){let t,i=!1;this._register(new Rt.$b(e,{onDragStart:t=>{i=this.onGroupDragStart(t,e)},onDrag:e=>{t=e},onDragEnd:o=>{this.onGroupDragEnd(o,t,e,i)}})),this._register((0,Rt.ox)(e,Rt.tx.DBLCLICK,e=>this.onTitleDoubleClick(e))),this._register((0,Rt.ox)(e,Rt.tx.AUXCLICK,e=>this.onTitleAuxClick(e))),this._register((0,Rt.ox)(e,Rt._m.Tap,e=>this.onTitleTap(e)));for(let o of[Rt.tx.CONTEXT_MENU,Rt._m.Contextmenu])this._register((0,Rt.ox)(e,o,t=>{this.tabsModel.activeEditor&&this.onTabContextMenu(this.tabsModel.activeEditor,t,e)}))}onTitleLabelClick(e){Rt.ex.stop(e,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(e){Rt.ex.stop(e),this.groupView.pinEditor()}onTitleAuxClick(e){1===e.button&&this.tabsModel.activeEditor&&(Rt.ex.stop(e,!0),(0,Pt.vn)(this.tabsModel,this.tabsModel.activeEditor,Pt.Lt.MOUSE,this.groupsView.partOptions)||this.groupView.closeEditor(this.tabsModel.activeEditor))}onTitleTap(e){let t=e.initialTarget;!(0,Rt.iS)(t)||!this.editorLabel||!(0,Rt.Xx)(t,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(e){return this.doHandleOpenEditor()}openEditors(e){return this.doHandleOpenEditor()}doHandleOpenEditor(){let e=this.ifActiveEditorChanged(()=>this.redraw());return e||this.ifActiveEditorPropertiesChanged(()=>this.redraw()),e}beforeCloseEditor(e){}closeEditor(e){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(e){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(e,t,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(e){this.ifEditorIsActive(e,()=>this.redraw())}stickEditor(e){}unstickEditor(e){}setActive(e){this.redraw()}updateEditorSelections(){}updateEditorLabel(e){this.ifEditorIsActive(e,()=>this.redraw())}updateEditorDirty(e){this.ifEditorIsActive(e,()=>{let t=(0,Rt.$j)(this.titleContainer);e.isDirty()&&!e.isSaving()?t.classList.add("dirty"):t.classList.remove("dirty")})}updateOptions(e,t){super.updateOptions(e,t),(e.labelFormat!==t.labelFormat||!(0,Rt.Gj)(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){(0,Rt.$j)(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(e){return!(!(!this.activeLabel.editor&&this.tabsModel.activeEditor||this.activeLabel.editor&&!this.tabsModel.activeEditor)&&this.activeLabel.editor&&this.tabsModel.isActive(this.activeLabel.editor))&&(e(),!0)}ifActiveEditorPropertiesChanged(e){!this.activeLabel.editor||!this.tabsModel.activeEditor||this.activeLabel.pinned!==this.tabsModel.isPinned(this.tabsModel.activeEditor)&&e()}ifEditorIsActive(e,t){this.tabsModel.isActive(e)&&t()}redraw(){var e;let t=null!==(e=this.tabsModel.activeEditor)&&void 0!==e?e:void 0,i=this.groupsView.partOptions,o=!!t&&this.tabsModel.isPinned(t),s=this.groupsView.activeGroup===this.groupView;this.activeLabel={editor:t,pinned:o},this.breadcrumbsControl&&(s?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!o)):this.breadcrumbsControl.hide());let[r,n]=(0,Rt.Qj)(this.titleContainer,this.editorLabel);if(t){var a,d;this.updateEditorDirty(t);let e,{labelFormat:l}=this.groupsView.partOptions;e=this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||"default"===l&&!s?"":t.getDescription(this.getVerbosity(l))||"",n.setResource({resource:Pt.Ht.getOriginalUri(t,{supportSideBySide:Pt.Jt.BOTH}),name:t.getName(),description:e},{title:this.getHoverTitle(t),italic:!o,extraClasses:["single-tab","title-label"].concat(t.getLabelExtraClasses()),fileDecorations:{colors:!(null===(a=i.decorations)||void 0===a||!a.colors),badges:!(null===(d=i.decorations)||void 0===d||!d.badges)},icon:t.getIcon(),hideIcon:!1===i.showIcons}),r.style.color=s?this.getColor(Lt.Sn)||"":this.getColor(Lt.Fn)||"",this.updateEditorActionsToolbar()}else r.classList.remove("dirty"),n.clear(),this.clearEditorActionsToolbar()}getVerbosity(e){switch(e){case"short":return Pt.Xt.SHORT;case"long":return Pt.Xt.LONG;default:return Pt.Xt.MEDIUM}}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(e=>"workbench.action.closeActiveEditor"===e.id||"workbench.action.unlockEditorGroup"===e.id),secondary:e.secondary}}getHeight(){return this.tabHeight}layout(e){var t;return null!==(t=this.breadcrumbsControl)&&void 0!==t&&t.layout(void 0),new Rt.Qb(e.container.width,this.getHeight())}};(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Kb)(),(0,Rt.PA)();var _n=class extends Rt.CA{constructor(e,t,i,o,s,r){super(),this.parent=e,this.groupsView=i,this.groupView=o,this.model=s,this.instantiationService=r;let n=this._register(new yn(this.model)),a=this._register(new fn(this.model));this.stickyEditorTabsControl=this._register(this.instantiationService.createInstance(Sn,this.parent,t,this.groupsView,this.groupView,n)),this.unstickyEditorTabsControl=this._register(this.instantiationService.createInstance(Sn,this.parent,t,this.groupsView,this.groupView,a)),this.handleTabBarsStateChange()}handleTabBarsStateChange(){this.activeControl=this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0,this.handleTabBarsLayoutChange()}handleTabBarsLayoutChange(){if(0===this.groupView.count)return;let e=this.parent.classList.contains("two-tab-bars"),t=this.groupView.count!==this.groupView.stickyCount&&this.groupView.stickyCount>0;this.parent.classList.toggle("two-tab-bars",t),e!==t&&this.groupView.relayout()}didActiveControlChange(){return this.activeControl!==(this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0)}getEditorTabsController(e){return this.model.isSticky(e)?this.stickyEditorTabsControl:this.unstickyEditorTabsControl}openEditor(e,t){let i=this.didActiveControlChange(),o=this.getEditorTabsController(e).openEditor(e,t)||i;return o&&this.handleOpenedEditors(),o}openEditors(e){let t=e.filter(e=>this.model.isSticky(e)),i=e.filter(e=>!this.model.isSticky(e)),o=this.didActiveControlChange(),s=this.stickyEditorTabsControl.openEditors(t),r=this.unstickyEditorTabsControl.openEditors(i),n=s||r||o;return n&&this.handleOpenedEditors(),n}handleOpenedEditors(){this.handleTabBarsStateChange()}beforeCloseEditor(e){this.getEditorTabsController(e).beforeCloseEditor(e)}closeEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){let t=e.filter(e=>this.model.isSticky(e)),i=e.filter(e=>!this.model.isSticky(e));this.stickyEditorTabsControl.closeEditors(t),this.unstickyEditorTabsControl.closeEditors(i),this.handleClosedEditors()}handleClosedEditors(){this.handleTabBarsStateChange()}moveEditor(e,t,i,o){o?(this.model.isSticky(e)?(this.stickyEditorTabsControl.openEditor(e),this.unstickyEditorTabsControl.closeEditor(e)):(this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e)),this.handleTabBarsStateChange()):this.model.isSticky(e)?this.stickyEditorTabsControl.moveEditor(e,t,i,o):this.unstickyEditorTabsControl.moveEditor(e,t-this.model.stickyCount,i-this.model.stickyCount,o)}pinEditor(e){this.getEditorTabsController(e).pinEditor(e)}stickEditor(e){this.unstickyEditorTabsControl.closeEditor(e),this.stickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}unstickEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}setActive(e){this.stickyEditorTabsControl.setActive(e),this.unstickyEditorTabsControl.setActive(e)}updateEditorSelections(){this.stickyEditorTabsControl.updateEditorSelections(),this.unstickyEditorTabsControl.updateEditorSelections()}updateEditorLabel(e){this.getEditorTabsController(e).updateEditorLabel(e)}updateEditorDirty(e){this.getEditorTabsController(e).updateEditorDirty(e)}updateOptions(e,t){this.stickyEditorTabsControl.updateOptions(e,t),this.unstickyEditorTabsControl.updateOptions(e,t)}layout(e){let t=this.stickyEditorTabsControl.layout(e),i={container:e.container,available:new Rt.Qb(e.available.width,e.available.height-t.height)},o=this.unstickyEditorTabsControl.layout(i);return new Rt.Qb(e.container.width,t.height+o.height)}getHeight(){return this.stickyEditorTabsControl.getHeight()+this.unstickyEditorTabsControl.getHeight()}dispose(){this.parent.classList.toggle("two-tab-bars",!1),super.dispose()}};_n=(0,Rt.Pb)([(0,Rt.Fb)(5,Rt.Ub)],_n),(0,Rt.fE)(),(0,Rt.qx)(),(0,Rt.mE)(In);var En=class extends tr{constructor(){super(...arguments),this.activeEditor=null}prepareEditorActions(e){return{primary:[],secondary:[]}}openEditor(e){return this.handleOpenedEditors()}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){let e=this.activeEditorChanged();return this.activeEditor=this.tabsModel.activeEditor,e}activeEditorChanged(){return!(!(!this.activeEditor&&this.tabsModel.activeEditor||this.activeEditor&&!this.tabsModel.activeEditor)&&this.activeEditor&&this.tabsModel.isActive(this.activeEditor))}beforeCloseEditor(e){}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){this.activeEditor=this.tabsModel.activeEditor}moveEditor(e,t,i){}pinEditor(e){}stickEditor(e){}unstickEditor(e){}setActive(e){}updateEditorSelections(){}updateEditorLabel(e){}updateEditorDirty(e){}getHeight(){return 0}layout(e){return new Rt.Qb(e.container.width,this.getHeight())}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Kb)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Rt.PA)(),(0,Rt.mE)({});var An,Dn=class extends Rt.lp{get breadcrumbsControl(){var e;return null===(e=this.breadcrumbsControlFactory)||void 0===e?void 0:e.control}constructor(e,t,i,o,s,r,n){super(n),this.parent=e,this.editorPartsView=t,this.groupsView=i,this.groupView=o,this.model=s,this.instantiationService=r,this.editorTabsControlDisposable=this._register(new Rt.EA),this.breadcrumbsControlDisposables=this._register(new Rt.EA),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()}createEditorTabsControl(){let e;switch(this.groupsView.partOptions.showTabs){case"none":e=En;break;case"single":e=kn;break;default:e=this.groupsView.partOptions.pinnedTabsOnSeparateRow?_n:Sn}let t=this.instantiationService.createInstance(e,this.parent,this.editorPartsView,this.groupsView,this.groupView,this.model);return this.editorTabsControlDisposable.add(t)}createBreadcrumbsControl(){if("single"===this.groupsView.partOptions.showTabs)return;let e=(0,Rt.Zb)(".breadcrumbs-below-tabs");this.parent.appendChild(e);let t=this.breadcrumbsControlDisposables.add(this.instantiationService.createInstance(No,e,this.groupView,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0,dragEditor:!1}));return this.breadcrumbsControlDisposables.add(t.onDidEnablementChange(()=>this.groupView.relayout())),this.breadcrumbsControlDisposables.add(t.onDidVisibilityChange(()=>this.groupView.relayout())),t}openEditor(e,t){let i=this.editorTabsControl.openEditor(e,t);this.handleOpenedEditors(i)}openEditors(e){let t=this.editorTabsControl.openEditors(e);this.handleOpenedEditors(t)}handleOpenedEditors(e){var t,i;e?null===(t=this.breadcrumbsControl)||void 0===t||t.update():null===(i=this.breadcrumbsControl)||void 0===i||i.revealLast()}beforeCloseEditor(e){return this.editorTabsControl.beforeCloseEditor(e)}closeEditor(e){this.editorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){this.editorTabsControl.closeEditors(e),this.handleClosedEditors()}handleClosedEditors(){var e;this.groupView.activeEditor||null===(e=this.breadcrumbsControl)||void 0===e||e.update()}moveEditor(e,t,i,o){return this.editorTabsControl.moveEditor(e,t,i,o)}pinEditor(e){return this.editorTabsControl.pinEditor(e)}stickEditor(e){return this.editorTabsControl.stickEditor(e)}unstickEditor(e){return this.editorTabsControl.unstickEditor(e)}setActive(e){return this.editorTabsControl.setActive(e)}updateEditorSelections(){this.editorTabsControl.updateEditorSelections()}updateEditorLabel(e){return this.editorTabsControl.updateEditorLabel(e)}updateEditorDirty(e){return this.editorTabsControl.updateEditorDirty(e)}updateOptions(e,t){e.showTabs!==t.showTabs||"single"!==t.showTabs&&e.pinnedTabsOnSeparateRow!==t.pinnedTabsOnSeparateRow?(this.editorTabsControlDisposable.clear(),this.breadcrumbsControlDisposables.clear(),(0,Rt.fx)(this.parent),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()):this.editorTabsControl.updateOptions(e,t)}layout(e){var t;let i,o=this.editorTabsControl.layout(e);return!1===(null===(t=this.breadcrumbsControl)||void 0===t?void 0:t.isHidden())&&(i=new Rt.Qb(e.container.width,Zo.HEIGHT),this.breadcrumbsControl.layout(i)),new Rt.Qb(e.container.width,o.height+(i?i.height:0))}getHeight(){var e;let t=this.editorTabsControl.getHeight();return{total:t+(!1===(null===(e=this.breadcrumbsControl)||void 0===e?void 0:e.isHidden())?Zo.HEIGHT:0),offset:t}}};Dn=(0,Rt.Pb)([(0,Rt.Fb)(5,Rt.Ub),(0,Rt.Fb)(6,Rt.Qd)],Dn),(0,Rt.fE)(),(0,Rt.Ib)(),(0,Wt.ua)(),(0,Pt.en)(),(0,Nt.ir)(),(0,Pt.Ot)(),(0,Rt.gA)(),(0,Rt.Kb)(),(0,Rt.qx)(),(0,Rt.tu)(),(0,Rt.bb)(),(0,Rt.Hn)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Lt.Xn)(),(0,Pt.Q)(),(0,Rt.Ja)(),(0,Wt.nt)(),(0,Rt.Fj)(),(0,Rt.WM)(),(0,Rt.PA)(),(0,Rt.ab)(),(0,Rt.Iw)(),(0,Rt.ym)(),(0,Lt.Z)(),(0,Rt.zr)(),(0,Rt.Ad)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.FT)(),(0,Rt.Xr)(),(0,Rt.wl)(),(0,Pt.At)(),(0,Rt.BC)(),(0,Rt.ba)(),(0,Rt.iT)(),(0,Rt.yT)(),(0,Rt.$p)(),(0,Wt.ca)(),(0,Rt.Ll)(),(0,Pt.i)(),(0,Pt.V)(),(0,Rt.TD)(),(0,Rt.Qo)(),(0,Rt.mj)(),(0,Rt.nb)(),(0,Ot.nt)(),(0,Rt.Mi)(),(0,Lt.c)(),(0,Lt.L)(),(0,Lt.F)(),(0,Pt.it)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.mE)({});var xn=An=class extends Rt.lp{static createNew(e,t,i,o,s,r){return s.createInstance(An,null,e,t,i,o,r)}static createFromSerialized(e,t,i,o,s,r,n){return r.createInstance(An,e,t,i,o,s,n)}static createCopy(e,t,i,o,s,r,n){return r.createInstance(An,e,t,i,o,s,n)}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C,w,y,f){var S;super(d),this.editorPartsView=t,this.groupsView=i,this.groupsLabel=o,this._index=s,this.instantiationService=n,this.contextKeyService=a,this.telemetryService=l,this.keybindingService=c,this.menuService=h,this.contextMenuService=u,this.fileDialogService=g,this.editorService=p,this.filesConfigurationService=b,this.uriIdentityService=m,this.logService=v,this.editorResolverService=C,this.hostService=w,this.dialogService=y,this.fileService=f,this._onDidFocus=this._register(new Rt.uA),this.onDidFocus=this._onDidFocus.event,this._onWillDispose=this._register(new Rt.uA),this.onWillDispose=this._onWillDispose.event,this._onDidModelChange=this._register(new Rt.uA),this.onDidModelChange=this._onDidModelChange.event,this._onDidActiveEditorChange=this._register(new Rt.uA),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidOpenEditorFail=this._register(new Rt.uA),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onWillCloseEditor=this._register(new Rt.uA),this.onWillCloseEditor=this._onWillCloseEditor.event,this._onDidCloseEditor=this._register(new Rt.uA),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onWillMoveEditor=this._register(new Rt.uA),this.onWillMoveEditor=this._onWillMoveEditor.event,this._onWillOpenEditor=this._register(new Rt.uA),this.onWillOpenEditor=this._onWillOpenEditor.event,this.disposedEditorsWorker=this._register(new Rt.Cw(e=>this.handleDisposedEditors(e),0)),this.mapEditorToPendingConfirmation=new Map,this.containerToolBarMenuDisposable=this._register(new Rt.OA),this.whenRestoredPromise=new Rt.pw,this.whenRestored=this.whenRestoredPromise.p,this._disposed=!1,this.element=(0,Rt.Zb)("div"),this._onDidChange=this._register(new Rt.pA),this.onDidChange=this._onDidChange.event,e instanceof An?this.model=this._register(e.model.clone()):(0,Wt.pa)(e)?this.model=this._register(n.createInstance(Wt.la,e)):this.model=this._register(n.createInstance(Wt.la,void 0)),this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.element)),this.element.classList.add(...(0,Rt.AM)(["editor-group-container",this.model.isLocked?"locked":void 0])),this.registerContainerListeners(),this.createContainerToolbar(),this.createContainerContextMenu(),this._register(this.instantiationService.createInstance(lo,this.element)),this.progressBar=this._register(new Rt.Vn(this.element,Rt.ki)),this.progressBar.hide(),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new Rt.eu([Rt.yb,this.scopedContextKeyService],[Rt.Ka,this._register(new Wt.et(this.progressBar,this))]))),this.resourceContext=this._register(this.scopedInstantiationService.createInstance(Nt.Vn)),this.handleGroupContextKeys(),this.titleContainer=(0,Rt.Zb)(".title"),this.element.appendChild(this.titleContainer),this.titleControl=this._register(this.scopedInstantiationService.createInstance(Dn,this.titleContainer,this.editorPartsView,this.groupsView,this,this.model)),this.editorContainer=(0,Rt.Zb)(".editor-container"),this.element.appendChild(this.editorContainer),this.editorPane=this._register(this.scopedInstantiationService.createInstance(Ki,this.element,this.editorContainer,this)),this._onDidChange.input=this.editorPane.onDidChangeSizeConstraints,this.doTrackFocus(),this.updateTitleContainer(),this.updateContainer(),this.updateStyles(),(null!==(S=this.restoreEditors(e,r))&&void 0!==S?S:Promise.resolve()).finally(()=>{this.whenRestoredPromise.complete()}),this.registerListeners()}handleGroupContextKeys(){let e=this.editorPartsView.bind(Nt.$t,this),t=this.editorPartsView.bind(Nt.in,this),i=this.editorPartsView.bind(Nt.en,this),o=this.editorPartsView.bind(Nt.rn,this),s=this.editorPartsView.bind(Nt.on,this),r=this.editorPartsView.bind(Nt.pn,this),n=this.editorPartsView.bind(Nt.nn,this),a=Nt.An.bindTo(this.scopedContextKeyService),d=Nt.$n.bindTo(this.scopedContextKeyService),l=Nt.Hn.bindTo(this.scopedContextKeyService),c=this.editorPartsView.bind(Nt.Qt,this),h=this.editorPartsView.bind(Nt.an,this),u=this.editorPartsView.bind(Nt.Yt,this),g=this.editorPartsView.bind(Nt.Zt,this),p=this.editorPartsView.bind(Nt.qt,this),b=this.editorPartsView.bind(Nt.Xn,this),m=this.editorPartsView.bind(Nt.Yn,this),v=this.editorPartsView.bind(Nt.Jt,this),C=this.editorPartsView.bind(Nt.Xt,this),w=this.editorPartsView.bind(Nt.Wn,this),y=this._register(new Rt.OA),f=()=>{y.clear(),this.scopedContextKeyService.bufferChangeEvents(()=>{let t=this.activeEditor,i=this.activeEditorPane;if(this.resourceContext.set(Pt.Ht.getOriginalUri(t,{supportSideBySide:Pt.Jt.PRIMARY})),(0,Nt.nr)(v,t,this.editorResolverService),t?(C.set(t.hasCapability(Pt.zt.CanSplitInGroup)),w.set(t.typeId===Pt.Et.ID),e.set(t.isDirty()&&!t.isSaving()),y.value=t.onDidChangeDirty(()=>{e.set(t.isDirty()&&!t.isSaving())})):(C.set(!1),w.set(!1),e.set(!1)),i){c.set(i.getId()),u.set(!i.input.hasCapability(Pt.zt.Untitled)),h.set(!!i.input.isReadonly());let e=Pt.Ht.getOriginalUri(i.input,{supportSideBySide:Pt.Jt.PRIMARY}),t=Pt.Ht.getOriginalUri(i.input,{supportSideBySide:Pt.Jt.SECONDARY});p.set(i.input instanceof Pt.nt&&!i.input.original.isReadonly()&&!!e&&(this.fileService.hasProvider(e)||e.scheme===Rt.vT.untitled)&&!!t&&(this.fileService.hasProvider(t)||t.scheme===Rt.vT.untitled)),g.set(!!e&&this.fileService.hasProvider(e)&&!this.fileService.hasCapability(e,Rt.Rs.Readonly));let o=(null===i||void 0===i?void 0:i.getId())===Pt.Yt;m.set(o),b.set(o)}else c.reset(),u.reset(),h.reset(),p.reset(),g.reset()})},S=e=>{switch(e.kind){case Pt.Wt.GROUP_LOCKED:n.set(this.isLocked);break;case Pt.Wt.EDITOR_ACTIVE:i.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor)),t.set(!!this.model.activeEditor&&this.model.isPinned(this.model.activeEditor)),s.set(!!this.model.activeEditor&&this.model.isSticky(this.model.activeEditor));break;case Pt.Wt.EDITOR_CLOSE:t.set(!!this.model.activeEditor&&this.model.isPinned(this.model.activeEditor)),s.set(!!this.model.activeEditor&&this.model.isSticky(this.model.activeEditor));break;case Pt.Wt.EDITOR_OPEN:case Pt.Wt.EDITOR_MOVE:i.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor));break;case Pt.Wt.EDITOR_PIN:e.editor&&e.editor===this.model.activeEditor&&t.set(this.model.isPinned(this.model.activeEditor));break;case Pt.Wt.EDITOR_STICKY:e.editor&&e.editor===this.model.activeEditor&&s.set(this.model.isSticky(this.model.activeEditor));break;case Pt.Wt.EDITORS_SELECTION:a.set(this.model.selectedEditors.length>1),d.set(2===this.model.selectedEditors.length),l.set(this.model.selectedEditors.every(e=>e.resource&&(this.fileService.hasProvider(e.resource)||e.resource.scheme===Rt.vT.untitled)))}r.set(this.count)};this._register(this.onDidModelChange(e=>S(e))),this._register(this.onDidActiveEditorChange(()=>f())),f(),S({kind:Pt.Wt.EDITOR_ACTIVE}),S({kind:Pt.Wt.GROUP_LOCKED})}registerContainerListeners(){this._register((0,Rt.ox)(this.element,Rt.tx.DBLCLICK,e=>{this.isEmpty&&(Rt.ex.stop(e),this.editorService.openEditor({resource:void 0,options:{pinned:!0,override:Pt.Ft.id}},this.id))})),this._register((0,Rt.ox)(this.element,Rt.tx.AUXCLICK,e=>{this.isEmpty&&1===e.button&&(Rt.ex.stop(e,!0),this.groupsView.removeGroup(this))}))}createContainerToolbar(){let e=(0,Rt.Zb)(".editor-group-container-toolbar");this.element.appendChild(e);let t=this._register(new Rt.Lr(e,{ariaLabel:(0,Rt.Ij)(3407,"Empty editor group actions"),highlightToggledItems:!0})),i=this._register(this.menuService.createMenu(Rt.sb.EmptyEditorGroup,this.scopedContextKeyService)),o=()=>{this.containerToolBarMenuDisposable.value=(0,Rt.zA)(()=>t.clear());let e=(0,Rt.Kr)(i.getActions({arg:{groupId:this.id},shouldForwardArgs:!0}),"navigation");for(let i of[...e.primary,...e.secondary]){let e=this.keybindingService.lookupKeybinding(i.id);t.push(i,{icon:!0,label:!1,keybinding:null===e||void 0===e?void 0:e.getLabel()})}};o(),this._register(i.onDidChange(o))}createContainerContextMenu(){this._register((0,Rt.ox)(this.element,Rt.tx.CONTEXT_MENU,e=>this.onShowContainerContextMenu(e))),this._register((0,Rt.ox)(this.element,Rt._m.Contextmenu,()=>this.onShowContainerContextMenu()))}onShowContainerContextMenu(e){if(!this.isEmpty)return;let t=this.element;e&&(t=new Rt.NT((0,Rt.Bx)(this.element),e)),this.contextMenuService.showContextMenu({menuId:Rt.sb.EmptyEditorGroupContext,contextKeyService:this.contextKeyService,getAnchor:()=>t,onHide:()=>this.focus()})}doTrackFocus(){let e=this._register((0,Rt.AS)(this.element));this._register(e.onDidFocus(()=>{this.isEmpty&&this._onDidFocus.fire()}));let t=e=>{let t;if((0,Rt.lS)(e)){if(0!==e.button||Rt.Cj&&e.ctrlKey)return;t=e.target}else t=e.initialTarget;(0,Rt.Cx)(t,"monaco-action-bar",this.titleContainer)||(0,Rt.Cx)(t,"monaco-breadcrumb-item",this.titleContainer)||setTimeout(()=>{this.focus()})};this._register((0,Rt.ox)(this.titleContainer,Rt.tx.MOUSE_DOWN,e=>t(e))),this._register((0,Rt.ox)(this.titleContainer,Rt._m.Tap,e=>t(e))),this._register(this.editorPane.onDidFocus(()=>{this._onDidFocus.fire()}))}updateContainer(){this.isEmpty?(this.element.classList.add("empty"),this.element.tabIndex=0,this.element.setAttribute("aria-label",(0,Rt.Ij)(3408,"{0} (empty)",this.ariaLabel))):(this.element.classList.remove("empty"),this.element.removeAttribute("tabIndex"),this.element.removeAttribute("aria-label")),this.updateStyles()}updateTitleContainer(){this.titleContainer.classList.toggle("tabs","multiple"===this.groupsView.partOptions.showTabs),this.titleContainer.classList.toggle("show-file-icons",this.groupsView.partOptions.showIcons)}restoreEditors(e,t){if(0===this.count)return;let i;i=e instanceof An?(0,Lt.J)(e):Object.create(null);let o=this.model.activeEditor;if(!o)return;i.pinned=this.model.isPinned(o),i.sticky=this.model.isSticky(o),i.preserveFocus=!0;let s=(0,Rt.Tx)(),r=this.doShowEditor(o,{active:!0,isNew:!1},i,{preserveWindowOrder:!0,skipTitleUpdate:!0}).then(()=>{this.groupsView.activeGroup===this&&s&&(0,Rt.Yx)(s)&&(null===t||void 0===t||!t.preserveFocus)&&this.focus()});return this.titleControl.openEditors(this.editors),r}registerListeners(){this._register(this.model.onDidModelChange(e=>this.onDidGroupModelChange(e))),this._register(this.groupsView.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this._register(this.groupsView.onDidVisibilityChange(e=>this.onDidVisibilityChange(e))),this._register(this.onDidFocus(()=>this.onDidGainFocus()))}onDidGroupModelChange(e){switch(this._onDidModelChange.fire(e),e.kind){case Pt.Wt.GROUP_LOCKED:this.element.classList.toggle("locked",this.isLocked);break;case Pt.Wt.EDITORS_SELECTION:this.onDidChangeEditorSelection()}if(e.editor)switch(e.kind){case Pt.Wt.EDITOR_OPEN:(0,Wt.fa)(e)&&this.onDidOpenEditor(e.editor,e.editorIndex);break;case Pt.Wt.EDITOR_CLOSE:(0,Wt.da)(e)&&this.handleOnDidCloseEditor(e.editor,e.editorIndex,e.context,e.sticky);break;case Pt.Wt.EDITOR_WILL_DISPOSE:this.onWillDisposeEditor(e.editor);break;case Pt.Wt.EDITOR_DIRTY:this.onDidChangeEditorDirty(e.editor);break;case Pt.Wt.EDITOR_TRANSIENT:this.onDidChangeEditorTransient(e.editor);break;case Pt.Wt.EDITOR_LABEL:this.onDidChangeEditorLabel(e.editor)}}onDidOpenEditor(e,t){this.telemetryService.publicLog("editorOpened",this.toEditorTelemetryDescriptor(e)),this.updateContainer()}handleOnDidCloseEditor(e,t,i,o){this._onWillCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o});let s=[e];e instanceof Pt.Et&&s.push(e.primary,e.secondary);for(let r of s)this.canDispose(r)&&r.dispose();this.updateContainer(),this._onDidCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o})}canDispose(e){for(let t of this.editorPartsView.groups)if(t instanceof An&&t.model.contains(e,{strictEquals:!0,supportSideBySide:Pt.Jt.ANY}))return!1;return!0}toResourceTelemetryDescriptor(e){if(!e)return;let t=e?e.scheme===Rt.vT.file?e.fsPath:e.path:void 0;if(!t)return;let i=(0,Rt.nT)(e),o=i.indexOf("?");return i=-1===o?i:i.substr(0,o),{mimeType:new Ot.Q((0,Rt.ya)(e).join(", ")),scheme:e.scheme,ext:i,path:(0,Rt.zC)(t)}}toEditorTelemetryDescriptor(e){let t=e.getTelemetryDescriptor(),i=Pt.Ht.getOriginalUri(e,{supportSideBySide:Pt.Jt.BOTH});return Rt.wD.isUri(i)?(t.resource=this.toResourceTelemetryDescriptor(i),t):i?(i.primary&&(t.resource=this.toResourceTelemetryDescriptor(i.primary)),i.secondary&&(t.resourceSecondary=this.toResourceTelemetryDescriptor(i.secondary)),t):t}onWillDisposeEditor(e){this.disposedEditorsWorker.work(e)}handleDisposedEditors(e){let t,i=[];for(let o of e){let e=this.model.findEditor(o);if(!e)continue;let s=e[0];s.isDisposed()&&(this.model.isActive(s)?t=s:i.push(s))}for(let o of i)this.doCloseEditor(o,!0);t&&this.doCloseEditor(t,!0)}onDidChangeEditorPartOptions(e){this.updateTitleContainer(),this.titleControl.updateOptions(e.oldPartOptions,e.newPartOptions),(e.oldPartOptions.showTabs!==e.newPartOptions.showTabs||e.oldPartOptions.tabHeight!==e.newPartOptions.tabHeight||"multiple"===e.oldPartOptions.showTabs&&e.oldPartOptions.pinnedTabsOnSeparateRow!==e.newPartOptions.pinnedTabsOnSeparateRow)&&(this.relayout(),this.model.activeEditor&&this.titleControl.openEditors(this.model.getEditors(Pt.Ut.SEQUENTIAL))),this.updateStyles(),e.oldPartOptions.enablePreview&&!e.newPartOptions.enablePreview&&this.model.previewEditor&&this.pinEditor(this.model.previewEditor)}onDidChangeEditorDirty(e){this.pinEditor(e),this.titleControl.updateEditorDirty(e)}onDidChangeEditorTransient(e){!this.model.isTransient(e)&&!this.groupsView.partOptions.enablePreview&&this.pinEditor(e)}onDidChangeEditorLabel(e){this.titleControl.updateEditorLabel(e)}onDidChangeEditorSelection(){this.titleControl.updateEditorSelections()}onDidVisibilityChange(e){this.editorPane.setVisible(e)}onDidGainFocus(){this.activeEditor&&this.model.setTransient(this.activeEditor,!1)}get index(){return this._index}get label(){return this.groupsLabel?(0,Rt.Ij)(3409,"{0}: Group {1}",this.groupsLabel,this._index+1):(0,Rt.Ij)(3410,"Group {0}",this._index+1)}get ariaLabel(){return this.groupsLabel?(0,Rt.Ij)(3411,"{0}: Editor Group {1}",this.groupsLabel,this._index+1):(0,Rt.Ij)(3412,"Editor Group {0}",this._index+1)}get disposed(){return this._disposed}get isEmpty(){return 0===this.count}get titleHeight(){return this.titleControl.getHeight()}notifyIndexChanged(e){this._index!==e&&(this._index=e,this.model.setIndex(e))}notifyLabelChanged(e){this.groupsLabel!==e&&(this.groupsLabel=e,this.model.setLabel(e))}setActive(e){this.active=e,!e&&this.activeEditor&&this.selectedEditors.length>1&&this.setSelection(this.activeEditor,[]),this.element.classList.toggle("active",e),this.element.classList.toggle("inactive",!e),this.titleControl.setActive(e),this.updateStyles(),this.model.setActive(void 0)}get id(){return this.model.id}get windowId(){return this.groupsView.windowId}get editors(){return this.model.getEditors(Pt.Ut.SEQUENTIAL)}get count(){return this.model.count}get stickyCount(){return this.model.stickyCount}get activeEditorPane(){var e;return this.editorPane&&null!==(e=this.editorPane.activeEditorPane)&&void 0!==e?e:void 0}get activeEditor(){return this.model.activeEditor}get selectedEditors(){return this.model.selectedEditors}get previewEditor(){return this.model.previewEditor}isPinned(e){return this.model.isPinned(e)}isSticky(e){return this.model.isSticky(e)}isSelected(e){return this.model.isSelected(e)}isTransient(e){return this.model.isTransient(e)}isActive(e){return this.model.isActive(e)}async setSelection(e,t){this.isActive(e)?this.model.setSelection(e,t):await this.openEditor(e,{activation:Rt.Jp.ACTIVATE},{inactiveSelection:t})}contains(e,t){return this.model.contains(e,t)}getEditors(e,t){return this.model.getEditors(e,t)}findEditors(e,t){var i;let o=this.uriIdentityService.asCanonicalUri(e);return this.getEditors(null!==(i=null===t||void 0===t?void 0:t.order)&&void 0!==i?i:Pt.Ut.SEQUENTIAL).filter(e=>{if(e.resource&&(0,Rt.oT)(e.resource,o))return!0;if((null===t||void 0===t?void 0:t.supportSideBySide)===Pt.Jt.PRIMARY||(null===t||void 0===t?void 0:t.supportSideBySide)===Pt.Jt.ANY){let t=Pt.Ht.getCanonicalUri(e,{supportSideBySide:Pt.Jt.PRIMARY});if(t&&(0,Rt.oT)(t,o))return!0}if((null===t||void 0===t?void 0:t.supportSideBySide)===Pt.Jt.SECONDARY||(null===t||void 0===t?void 0:t.supportSideBySide)===Pt.Jt.ANY){let t=Pt.Ht.getCanonicalUri(e,{supportSideBySide:Pt.Jt.SECONDARY});if(t&&(0,Rt.oT)(t,o))return!0}return!1})}getEditorByIndex(e){return this.model.getEditorByIndex(e)}getIndexOfEditor(e){return this.model.indexOf(e)}isFirst(e){return this.model.isFirst(e)}isLast(e){return this.model.isLast(e)}focus(){this.activeEditorPane?this.activeEditorPane.focus():this.element.focus(),this._onDidFocus.fire()}pinEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0;if(e&&!this.model.isPinned(e)){let t=this.model.pin(e);t&&this.titleControl.pinEditor(t)}}stickEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0;this.doStickEditor(e,!0)}unstickEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0;this.doStickEditor(e,!1)}doStickEditor(e,t){if(e&&this.model.isSticky(e)!==t){let i=this.getIndexOfEditor(e),o=t?this.model.stick(e):this.model.unstick(e);if(!o)return;let s=this.getIndexOfEditor(o);s!==i&&this.titleControl.moveEditor(o,i,s,!0),t?this.titleControl.stickEditor(o):this.titleControl.unstickEditor(o)}}async openEditor(e,t,i){return this.doOpenEditor(e,t,(0,xt.A)((0,xt.A)({},i),{},{supportSideBySide:Pt.Jt.BOTH}))}async doOpenEditor(e,t,i){var o,s;if(!e||e.isDisposed())return;this._onWillOpenEditor.fire({editor:e,groupId:this.id});let r=(null===t||void 0===t?void 0:t.sticky)||!this.groupsView.partOptions.enablePreview&&!(null!==t&&void 0!==t&&t.transient)||e.isDirty()||(null!==(o=null===t||void 0===t?void 0:t.pinned)&&void 0!==o?o:"number"==typeof(null===t||void 0===t?void 0:t.index))||"number"==typeof(null===t||void 0===t?void 0:t.index)&&this.model.isSticky(t.index)||e.hasCapability(Pt.zt.Scratchpad),n={index:t?t.index:void 0,pinned:r,sticky:(null===t||void 0===t?void 0:t.sticky)||"number"==typeof(null===t||void 0===t?void 0:t.index)&&this.model.isSticky(t.index),transient:!(null===t||void 0===t||!t.transient),inactiveSelection:null===i||void 0===i?void 0:i.inactiveSelection,active:0===this.count||!(null!==t&&void 0!==t&&t.inactive),supportSideBySide:null===i||void 0===i?void 0:i.supportSideBySide};!n.active&&!n.pinned&&this.model.activeEditor&&!this.model.isPinned(this.model.activeEditor)&&(n.active=!0);let a=!1,d=!1;if((null===t||void 0===t?void 0:t.activation)===Rt.Jp.ACTIVATE?a=!0:(null===t||void 0===t?void 0:t.activation)===Rt.Jp.RESTORE?d=!0:(null===t||void 0===t?void 0:t.activation)===Rt.Jp.PRESERVE?(a=!1,d=!1):n.active&&(a=!(null!==t&&void 0!==t&&t.preserveFocus),d=!a),"number"==typeof n.index){let t=this.model.indexOf(e);-1!==t&&t!==n.index&&this.doMoveEditorInsideGroup(e,n)}let{editor:l,isNew:c}=this.model.openEditor(e,n);c&&1===this.count&&this.editorPartsView.groups.length>1&&l.editorId&&(null===(s=this.groupsView.partOptions.autoLockGroups)||void 0===s?void 0:s.has(l.editorId))&&this.lock(!0);let h=this.doShowEditor(l,{active:!!n.active,isNew:c},t,i);return a?this.groupsView.activateGroup(this):d&&this.groupsView.restoreGroup(this),h}doShowEditor(e,t,i,o){let s;return s=t.active?(async()=>{let{pane:s,changed:r,cancelled:n,error:a}=await this.editorPane.openEditor(e,i,o,{newInGroup:t.isNew});if(!n)return r&&this._onDidActiveEditorChange.fire({editor:e}),a&&this._onDidOpenEditorFail.fire(e),!s&&this.activeEditor===e&&this.doCloseEditor(e,null===i||void 0===i?void 0:i.preserveFocus,{fromError:!0}),s})():Promise.resolve(void 0),null!==o&&void 0!==o&&o.skipTitleUpdate||this.titleControl.openEditor(e,o),s}async openEditors(e){var t;let i=(0,Rt.AM)(e).filter(e=>{let{editor:t}=e;return!t.isDisposed()}),o=i.at(0);if(!o)return;let s={supportSideBySide:Pt.Jt.BOTH};await this.doOpenEditor(o.editor,o.options,s);let r=i.slice(1),n=this.getIndexOfEditor(o.editor)+1;return await Rt.yw.settled(r.map((e,t)=>{let{editor:i,options:o}=e;return this.doOpenEditor(i,(0,xt.A)((0,xt.A)({},o),{},{inactive:!0,pinned:!0,index:n+t}),(0,xt.A)((0,xt.A)({},s),{},{skipTitleUpdate:!0}))})),this.titleControl.openEditors(r.map(e=>{let{editor:t}=e;return t})),null!==(t=this.editorPane.activeEditorPane)&&void 0!==t?t:void 0}moveEditors(e,t){let i={skipTitleUpdate:this!==t},o=!1,s=new Set;for(let{editor:r,options:n}of e)this.moveEditor(r,t,n,i)?s.add(r):o=!0;return i.skipTitleUpdate&&(t.titleControl.openEditors(Array.from(s)),this.titleControl.closeEditors(Array.from(s))),!o}moveEditor(e,t,i,o){return this===t?(this.doMoveEditorInsideGroup(e,i),!0):this.doMoveOrCopyEditorAcrossGroups(e,t,i,(0,xt.A)((0,xt.A)({},o),{},{keepCopy:!1}))}doMoveEditorInsideGroup(e,t){let i=t?t.index:void 0;if("number"!=typeof i)return;let o=this.model.indexOf(e),s=this.model.getEditorByIndex(o);if(s){if(o!==i){let e=this.model.stickyCount;this.model.moveEditor(s,i),this.model.pin(s),this.titleControl.moveEditor(s,o,i,e!==this.model.stickyCount),this.titleControl.pinEditor(s)}(null===t||void 0===t?void 0:t.sticky)&&this.stickEditor(s)}}doMoveOrCopyEditorAcrossGroups(e,t,i,o){var s;let r=null===o||void 0===o?void 0:o.keepCopy;if(!r||e.hasCapability(Pt.zt.Singleton)){let i=e.canMove(this.id,t.id);if("string"==typeof i)return this.dialogService.error(i,(0,Rt.Ij)(3413,"Try saving or reverting the editor first and then try again.")),!1}let n=(0,Lt.J)(this,e,(0,xt.A)((0,xt.A)({},i),{},{pinned:!0,sticky:null!==(s=null===i||void 0===i?void 0:i.sticky)&&void 0!==s?s:!r&&this.model.isSticky(e)}));return r||this._onWillMoveEditor.fire({groupId:this.id,editor:e,target:t.id}),t.doOpenEditor(r?e.copy():e,n,o),r||this.doCloseEditor(e,!0,(0,xt.A)((0,xt.A)({},o),{},{context:Pt.It.MOVE})),!0}copyEditors(e,t){let i={skipTitleUpdate:this!==t};for(let{editor:o,options:s}of e)this.copyEditor(o,t,s,i);if(i.skipTitleUpdate){let i=e.map(e=>{let{editor:t}=e;return t});t.titleControl.openEditors(i)}}copyEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,(0,xt.A)((0,xt.A)({},o),{},{keepCopy:!0}))}async closeEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0,t=arguments.length>1?arguments[1]:void 0;return this.doCloseEditorWithConfirmationHandling(e,t)}async doCloseEditorWithConfirmationHandling(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeEditor||void 0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return!(!e||await this.handleCloseConfirmation([e]))&&(this.doCloseEditor(e,null===t||void 0===t?void 0:t.preserveFocus,i),!0)}doCloseEditor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.groupsView.activeGroup!==this,i=arguments.length>2?arguments[2]:void 0;null!==i&&void 0!==i&&i.skipTitleUpdate||this.titleControl.beforeCloseEditor(e),this.model.isActive(e)?this.doCloseActiveEditor(t,i):this.doCloseInactiveEditor(e,i),(null===i||void 0===i?void 0:i.skipTitleUpdate)||this.titleControl.closeEditor(e)}doCloseActiveEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.groupsView.activeGroup!==this,t=arguments.length>1?arguments[1]:void 0,i=this.activeEditor,o=!e&&this.shouldRestoreFocus(this.element),s=this.groupsView.partOptions.closeEmptyGroups;if(s&&this.active&&1===this.count){let e=this.groupsView.getGroups(Pt.X.MOST_RECENTLY_ACTIVE)[1];e&&(o?e.focus():this.groupsView.activateGroup(e,!0))}i&&this.model.closeEditor(i,null===t||void 0===t?void 0:t.context);let r=this.model.activeEditor;if(r){let i;e&&this.groupsView.activeGroup!==this&&(i=Rt.Jp.PRESERVE);let o={preserveFocus:e,activation:i,ignoreError:null===t||void 0===t?void 0:t.fromError};this.doOpenEditor(r,o,{preserveWindowOrder:!0})}else i&&this.editorPane.closeEditor(i),o&&!s&&this.focus(),this._onDidActiveEditorChange.fire({editor:void 0}),s&&this.groupsView.removeGroup(this,e)}shouldRestoreFocus(e){let t=(0,Rt.Tx)();return t===(0,Rt.Fx)(e)||(0,Rt.Xx)(t,e)}doCloseInactiveEditor(e,t){this.model.closeEditor(e,null===t||void 0===t?void 0:t.context)}async handleCloseConfirmation(e){if(!e.length)return!1;let t,i=e.shift(),o=this.mapEditorToPendingConfirmation.get(i);o||(o=this.doHandleCloseConfirmation(i),this.mapEditorToPendingConfirmation.set(i,o));try{t=await o}finally{this.mapEditorToPendingConfirmation.delete(i)}return t||this.handleCloseConfirmation(e)}async doHandleCloseConfirmation(e,t){if(!this.shouldConfirmClose(e)||e instanceof Pt.Et&&this.model.contains(e.primary)||this.editorPartsView.groups.some(t=>{if(t===this)return!1;let i=t;return!!(i.contains(e,{supportSideBySide:Pt.Jt.BOTH})||e instanceof Pt.Et&&i.contains(e.primary))}))return!1;let i=Wt.sa.CANCEL,o=Pt.Kt.EXPLICIT,s=!1;if(!e.hasCapability(Pt.zt.Untitled)&&!(null!==t&&void 0!==t&&t.skipAutoSave)&&!e.closeHandler&&(this.filesConfigurationService.getAutoSaveMode(e).mode===Pt.n.ON_FOCUS_CHANGE?(s=!0,i=Wt.sa.SAVE,o=Pt.Kt.FOCUS_CHANGE):Rt.Tj&&(Rt.kj||Rt.xj)&&this.filesConfigurationService.getAutoSaveMode(e).mode===Pt.n.ON_WINDOW_CHANGE&&(s=!0,i=Wt.sa.SAVE,o=Pt.Kt.WINDOW_CHANGE)),!s){var r,n,a;null!==(r=this.activeEditor)&&void 0!==r&&r.matches(e)||await this.doOpenEditor(e),await this.hostService.focus((0,Rt.Bx)(this.element));let t=!1;if("function"==typeof(null===(n=e.closeHandler)||void 0===n?void 0:n.confirm))try{i=await e.closeHandler.confirm([{editor:e,groupId:this.id}])}catch(e){this.logService.error(e),t=!0}if("function"!=typeof(null===(a=e.closeHandler)||void 0===a?void 0:a.confirm)||t){let t;t=e instanceof Pt.Et?e.primary.getName():e.getName(),i=await this.fileDialogService.showSaveConfirm([t])}}if(!e.closeHandler&&!this.shouldConfirmClose(e))return i===Wt.sa.CANCEL;switch(i){case Wt.sa.SAVE:return!await e.save(this.id,{reason:o})&&s?this.doHandleCloseConfirmation(e,{skipAutoSave:!0}):e.isDirty();case Wt.sa.DONT_SAVE:try{return await e.revert(this.id),e.isDirty()}catch(t){return this.logService.error(t),await e.revert(this.id,{soft:!0}),e.isDirty()}case Wt.sa.CANCEL:return!0}}shouldConfirmClose(e){if(e.closeHandler)try{return e.closeHandler.showConfirm()}catch(e){this.logService.error(e)}return e.isDirty()&&!e.isSaving()}async closeEditors(e,t){if(this.isEmpty)return!0;let i=this.doGetEditorsToClose(e);return!await this.handleCloseConfirmation(i.slice(0))&&(this.doCloseEditors(i,t),!0)}doGetEditorsToClose(e){if(Array.isArray(e))return e;let t=e,i="number"==typeof t.direction,o=this.model.getEditors(i?Pt.Ut.SEQUENTIAL:Pt.Ut.MOST_RECENTLY_ACTIVE,t);return t.savedOnly?o=o.filter(e=>!e.isDirty()||e.isSaving()):i&&t.except?o=t.direction===Pt.Pt.LEFT?o.slice(0,this.model.indexOf(t.except,o)):o.slice(this.model.indexOf(t.except,o)+1):t.except&&(o=o.filter(e=>t.except&&!e.matches(t.except))),o}doCloseEditors(e,t){let i=!1;for(let o of e)this.isActive(o)?i=!0:this.doCloseInactiveEditor(o);i&&this.doCloseActiveEditor(null===t||void 0===t?void 0:t.preserveFocus),e.length&&this.titleControl.closeEditors(e)}closeAllEditors(e){return this.isEmpty?(this.groupsView.partOptions.closeEmptyGroups&&this.groupsView.removeGroup(this),!0):null!==e&&void 0!==e&&e.excludeConfirming?(this.doCloseAllEditors(e),!0):this.handleCloseConfirmation(this.model.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE,e)).then(t=>!t&&(this.doCloseAllEditors(e),!0))}doCloseAllEditors(e){let t=this.model.getEditors(Pt.Ut.SEQUENTIAL,e);(null===e||void 0===e?void 0:e.excludeConfirming)&&(t=t.filter(e=>!this.shouldConfirmClose(e)));let i=[];for(let o of t)this.isActive(o)||this.doCloseInactiveEditor(o),i.push(o);this.activeEditor&&i.includes(this.activeEditor)&&this.doCloseActiveEditor(),i.length&&this.titleControl.closeEditors(i)}async replaceEditors(e){let t,i=[];for(let{editor:s,replacement:r,forceReplaceDirty:n,options:a}of e){let e=this.getIndexOfEditor(s);if(e>=0){var o;let d=this.isActive(s);a?a.index=e:a={index:e},a.inactive=!d,a.pinned=null===(o=a.pinned)||void 0===o||o;let l={editor:s,replacement:r,forceReplaceDirty:n,options:a};d?t=l:i.push(l)}}for(let{editor:s,replacement:r,forceReplaceDirty:n,options:a}of i)if(await this.doOpenEditor(r,a),!s.matches(r)){let e=!1;if(n?(this.doCloseEditor(s,!0,{context:Pt.It.REPLACE}),e=!0):e=await this.doCloseEditorWithConfirmationHandling(s,{preserveFocus:!0},{context:Pt.It.REPLACE}),!e)return}if(t){let e=this.doOpenEditor(t.replacement,t.options);t.editor.matches(t.replacement)||(t.forceReplaceDirty?this.doCloseEditor(t.editor,!0,{context:Pt.It.REPLACE}):await this.doCloseEditorWithConfirmationHandling(t.editor,{preserveFocus:!0},{context:Pt.It.REPLACE})),await e}}get isLocked(){return this.model.isLocked}lock(e){this.model.lock(e)}createEditorActions(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rt.sb.EditorTitle,o={primary:[],secondary:[]},s=this.activeEditorPane;if(s instanceof Lt.s){var r;let n=null!==(r=s.scopedContextKeyService)&&void 0!==r?r:this.scopedContextKeyService,a=e.add(this.menuService.createMenu(i,n,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:0}));t=a.onDidChange,o=(0,Rt.Kr)(a.getActions({arg:this.resourceContext.get(),shouldForwardArgs:!0,renderShortTitle:!0}),"navigation",(e,t)=>"navigation"===t&&e.actions.length<=1)}else{let i=e.add(new Rt.uA);t=i.event,e.add(this.onDidActiveEditorChange(()=>i.fire()))}return{actions:o,onDidChange:t}}updateStyles(){let e=this.isEmpty;this.element.style.backgroundColor=e&&this.getColor(Lt.vt)||"";let t=this.getColor(Lt.yt)||this.getColor(Rt._g);!e&&t?(this.titleContainer.classList.add("title-border-bottom"),this.titleContainer.style.setProperty("--title-border-bottom-color",t)):(this.titleContainer.classList.remove("title-border-bottom"),this.titleContainer.style.removeProperty("--title-border-bottom-color"));let{showTabs:i}=this.groupsView.partOptions;this.titleContainer.style.backgroundColor=this.getColor("multiple"===i?Lt.xt:Lt.bt)||"",this.editorContainer.style.backgroundColor=this.getColor(Rt.Th)||""}get minimumWidth(){return this.editorPane.minimumWidth}get minimumHeight(){return this.editorPane.minimumHeight}get maximumWidth(){return this.editorPane.maximumWidth}get maximumHeight(){return this.editorPane.maximumHeight}get proportionalLayout(){return!this.lastLayout||!(this.lastLayout.width===this.minimumWidth||this.lastLayout.height===this.minimumHeight)}layout(e,t,i,o){this.lastLayout={width:e,height:t,top:i,left:o},this.element.classList.toggle("max-height-478px",t<=478);let s=this.titleControl.layout({container:new Rt.Qb(e,t),available:new Rt.Qb(e,t-this.editorPane.minimumHeight)});this.progressBar.getContainer().style.top="".concat(Math.max(this.titleHeight.offset-2,0),"px");let r=Math.max(0,t-s.height);this.editorContainer.style.height="".concat(r,"px"),this.editorPane.layout({width:e,height:r,top:i+s.height,left:o})}relayout(){if(this.lastLayout){let{width:e,height:t,top:i,left:o}=this.lastLayout;this.layout(e,t,i,o)}}setBoundarySashes(e){this.editorPane.setBoundarySashes(e)}toJSON(){return this.model.serialize()}dispose(){this._disposed=!0,this._onWillDispose.fire(),super.dispose()}};xn=An=(0,Rt.Pb)([(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.yb),(0,Rt.Fb)(8,Rt.Qd),(0,Rt.Fb)(9,Rt.ib),(0,Rt.Fb)(10,Rt.kd),(0,Rt.Fb)(11,Rt.Zr),(0,Rt.Fb)(12,Rt.Sl),(0,Rt.Fb)(13,Rt.Il),(0,Rt.Fb)(14,Pt.kt),(0,Rt.Fb)(15,Pt.B),(0,Rt.Fb)(16,Rt.Zo),(0,Rt.Fb)(17,Rt.eb),(0,Rt.Fb)(18,Lt.I),(0,Rt.Fb)(19,Lt.P),(0,Rt.Fb)(20,Rt.Fl),(0,Rt.Fb)(21,Rt.ys)],xn);var Vn;function Rn(e){return e.getValue("editor.dropIntoEditor.enabled")}function Tn(e){return e.shiftKey}(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.ha)(),(0,Rt.qx)(),(0,Rt.Mn)(),(0,Rt.Iw)(),(0,Rt.PA)(),(0,Rt.mj)(),(0,Rt.nM)(),(0,Rt.Fj)(),(0,Rt.s_)(),(0,Rt.Kb)(),(0,Rt.vb)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Rt.ss)(),(0,Rt.za)(),(0,Wt.rh)(),(0,Wt.W)(),(0,Lt.Z)(),(0,Pt.en)(),(0,Lt.Xn)(),(0,Pt.Q)(),(0,Pt.G)(),(0,Pt.At)(),(0,Wt.sC)(),(0,Wt._m)(),(0,Rt.mE)({});var Ln=(K=class extends Rt.lp{get disposed(){return!!this._disposed}constructor(e,t,i,o,s,r,n,a){super(t),this.groupView=e,this.configurationService=i,this.instantiationService=o,this.editorService=s,this.editorGroupService=r,this.treeViewsDragAndDropService=n,this.contextService=a,this.editorTransfer=Wt.eh.getInstance(),this.groupTransfer=Wt.eh.getInstance(),this.treeItemsTransfer=Wt.eh.getInstance(),this.cleanupOverlayScheduler=this._register(new Rt.Sw(()=>this.dispose(),300)),this.enableDropIntoEditor=Rn(this.configurationService)&&this.isDropIntoActiveEditorEnabled(),this.create()}create(){let e=this.getOverlayOffsetHeight(),t=this.container=(0,Rt.Zb)("div",{id:Vn.OVERLAY_ID});t.style.top="".concat(e,"px"),this.groupView.element.appendChild(t),this.groupView.element.classList.add("dragged-over"),this._register((0,Rt.zA)(()=>{t.remove(),this.groupView.element.classList.remove("dragged-over")})),this.overlay=(0,Rt.Zb)(".editor-group-overlay-indicator"),t.appendChild(this.overlay),this.enableDropIntoEditor&&(this.dropIntoPromptElement=(0,Rt.Nn)((0,Rt.Ij)(3406,"Hold __{0}__ to drop into editor",Rt.Cj?"\u21e7":"Shift"),{}),this.dropIntoPromptElement.classList.add("editor-group-overlay-drop-into-prompt"),this.overlay.appendChild(this.dropIntoPromptElement)),this.registerListeners(t),this.updateStyles()}updateStyles(){let e=(0,Rt.$j)(this.overlay);e.style.backgroundColor=this.getColor(Lt.pt)||"";let t=this.getColor(Rt.gg);if(e.style.outlineColor=t||"",e.style.outlineOffset=t?"-2px":"",e.style.outlineStyle=t?"dashed":"",e.style.outlineWidth=t?"2px":"",this.dropIntoPromptElement){var i,o;this.dropIntoPromptElement.style.backgroundColor=null!==(i=this.getColor(Lt.mt))&&void 0!==i?i:"",this.dropIntoPromptElement.style.color=null!==(o=this.getColor(Lt.gt))&&void 0!==o?o:"";let e=this.getColor(Lt.ht);e?(this.dropIntoPromptElement.style.borderWidth="1px",this.dropIntoPromptElement.style.borderStyle="solid",this.dropIntoPromptElement.style.borderColor=e):this.dropIntoPromptElement.style.borderWidth="0"}}registerListeners(e){this._register(new Rt.$b(e,{onDragOver:e=>{if(this.enableDropIntoEditor&&Tn(e))return void this.dispose();let t=this.groupTransfer.hasData(Wt.z.prototype),i=this.editorTransfer.hasData(Wt.B.prototype);!i&&!t&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy");let o=!0;if(t)o=this.isCopyOperation(e);else if(i){let t=this.editorTransfer.getData(Wt.B.prototype);Array.isArray(t)&&t.length>0&&(o=this.isCopyOperation(e,t[0].identifier))}if(!o){let e=this.findSourceGroupView();if(e===this.groupView&&(t||i&&e.count<2))return void this.hideOverlay()}let s=!!this.editorGroupService.partOptions.splitOnDragAndDrop;this.isToggleSplitOperation(e)&&(s=!s),this.positionOverlay(e.offsetX,e.offsetY,t,s),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:e=>this.dispose(),onDragEnd:e=>this.dispose(),onDrop:e=>{Rt.ex.stop(e,!0),this.dispose(),this.currentDropOperation&&this.handleDrop(e,this.currentDropOperation.splitDirection)}})),this._register((0,Rt.ox)(e,Rt.tx.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}isDropIntoActiveEditorEnabled(){var e;return!(null===(e=this.groupView.activeEditor)||void 0===e||!e.hasCapability(Pt.zt.CanDropIntoEditor))}findSourceGroupView(){if(this.groupTransfer.hasData(Wt.z.prototype)){let e=this.groupTransfer.getData(Wt.z.prototype);if(Array.isArray(e)&&e.length>0)return this.editorGroupService.getGroup(e[0].identifier)}else if(this.editorTransfer.hasData(Wt.B.prototype)){let e=this.editorTransfer.getData(Wt.B.prototype);if(Array.isArray(e)&&e.length>0)return this.editorGroupService.getGroup(e[0].identifier.groupId)}}async handleDrop(e,t){let i=()=>{let e;return e="number"==typeof t?this.editorGroupService.addGroup(this.groupView,t):this.groupView,e};if(this.groupTransfer.hasData(Wt.z.prototype)){let i=this.groupTransfer.getData(Wt.z.prototype);if(Array.isArray(i)&&i.length>0){let o=this.editorGroupService.getGroup(i[0].identifier);if(o){if("number"!=typeof t&&o===this.groupView)return;let i;if("number"==typeof t)i=this.isCopyOperation(e)?this.editorGroupService.copyGroup(o,this.groupView,t):this.editorGroupService.moveGroup(o,this.groupView,t);else{let t;this.isCopyOperation(e)&&(t={mode:Pt.Z.COPY_EDITORS}),this.editorGroupService.mergeGroup(o,this.groupView,t)}i&&this.editorGroupService.activateGroup(i)}this.groupTransfer.clearData(Wt.z.prototype)}}else if(this.editorTransfer.hasData(Wt.B.prototype)){let o=this.editorTransfer.getData(Wt.B.prototype);if(Array.isArray(o)&&o.length>0){let s=o,r=o[0].identifier,n=this.editorGroupService.getGroup(r.groupId);if(n){let o,a=this.isCopyOperation(e,r);if(this.editorGroupService.partOptions.closeEmptyGroups&&1===n.count&&"number"==typeof t&&!a)o=this.editorGroupService.moveGroup(n,this.groupView,t);else{if(o=i(),n===o)return;let e=(0,Lt.Q)(this.groupView,s.map(e=>e.identifier.editor));a?n.copyEditors(e,o):n.moveEditors(e,o)}o.focus()}this.editorTransfer.clearData(Wt.B.prototype)}}else if(this.treeItemsTransfer.hasData(Wt.hm.prototype)){let e=this.treeItemsTransfer.getData(Wt.hm.prototype);if(Array.isArray(e)&&e.length>0){let t=[];for(let i of e){let e=await this.treeViewsDragAndDropService.removeDragOperationTransfer(i.identifier);if(e){let i=await(0,Wt.H)(e);t.push(...i.map(e=>(0,xt.A)((0,xt.A)({},e),{},{options:(0,xt.A)((0,xt.A)({},e.options),{},{pinned:!0})})))}}t.length&&this.editorService.openEditors(t,i(),{validateTrust:!0})}this.treeItemsTransfer.clearData(Wt.hm.prototype)}else this.instantiationService.createInstance(Wt.V,{allowWorkspaceOpen:!Rt.Dj||(0,Rt.fs)(this.contextService.getWorkspace())}).handleDrop(e,(0,Rt.Bx)(this.groupView.element),()=>i(),e=>null===e||void 0===e?void 0:e.focus())}isCopyOperation(e,t){return(null===t||void 0===t||!t.editor.hasCapability(Pt.zt.Singleton))&&(e.ctrlKey&&!Rt.Cj||e.altKey&&Rt.Cj)}isToggleSplitOperation(e){return e.altKey&&!Rt.Cj||e.shiftKey&&Rt.Cj}positionOverlay(e,t,i,o){let s,r,n="right"===this.editorGroupService.partOptions.openSideBySideDirection,a=this.groupView.element.clientWidth,d=this.groupView.element.clientHeight-this.getOverlayOffsetHeight();o?(s=i&&n?.3:.1,r=i?n?.1:.3:.1):(s=0,r=0);let l,c=a*s,h=d*r,u=a/3,g=d/3;switch(l=e>c&&e<a-c&&t>h&&t<d-h?void 0:n?e<u?Pt.K.LEFT:e>2*u?Pt.K.RIGHT:t<d/2?Pt.K.UP:Pt.K.DOWN:t<g?Pt.K.UP:t>2*g?Pt.K.DOWN:e<a/2?Pt.K.LEFT:Pt.K.RIGHT,l){case Pt.K.UP:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case Pt.K.DOWN:this.doPositionOverlay({top:"50%",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case Pt.K.LEFT:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;case Pt.K.RIGHT:this.doPositionOverlay({top:"0",left:"50%",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;default:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),this.toggleDropIntoPrompt(!0)}let p=(0,Rt.$j)(this.overlay);p.style.opacity="1",setTimeout(()=>p.classList.add("overlay-move-transition"),0),this.currentDropOperation={splitDirection:l}}doPositionOverlay(e){let[t,i]=(0,Rt.Qj)(this.container,this.overlay),o=this.getOverlayOffsetHeight();t.style.height=o?"calc(100% - ".concat(o,"px)"):"100%",i.style.top=e.top,i.style.left=e.left,i.style.width=e.width,i.style.height=e.height}getOverlayOffsetHeight(){return this.groupView.isEmpty||"multiple"!==this.editorGroupService.partOptions.showTabs?0:this.groupView.titleHeight.offset}hideOverlay(){let e=(0,Rt.$j)(this.overlay);this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),e.style.opacity="0",e.classList.remove("overlay-move-transition"),this.currentDropOperation=void 0}toggleDropIntoPrompt(e){this.dropIntoPromptElement&&(this.dropIntoPromptElement.style.opacity=e?"1":"0")}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}},{_:Vn=K},{_:K.OVERLAY_ID="monaco-workbench-editor-drop-overlay"},K);Ln=Vn=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Qd),(0,Rt.Fb)(2,Rt.o_),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Pt.kt),(0,Rt.Fb)(5,Pt.W),(0,Rt.Fb)(6,Wt.oC),(0,Rt.Fb)(7,Rt.Ra)],Ln);var Wn=class extends Rt.lp{constructor(e,t,i,o,s,r){super(o),this.container=e,this.delegate=t,this.editorGroupService=i,this.configurationService=s,this.instantiationService=r,this.counter=0,this.editorTransfer=Wt.eh.getInstance(),this.groupTransfer=Wt.eh.getInstance(),this.registerListeners()}get overlay(){if(this._overlay&&!this._overlay.disposed)return this._overlay}registerListeners(){this._register((0,Rt.ox)(this.container,Rt.tx.DRAG_ENTER,e=>this.onDragEnter(e))),this._register((0,Rt.ox)(this.container,Rt.tx.DRAG_LEAVE,()=>this.onDragLeave()));for(let e of[this.container,(0,Rt.Bx)(this.container)])this._register((0,Rt.ox)(e,Rt.tx.DRAG_END,()=>this.onDragEnd()))}onDragEnter(e){if(Rn(this.configurationService)&&Tn(e))return;if(this.counter++,!this.editorTransfer.hasData(Wt.B.prototype)&&!this.groupTransfer.hasData(Wt.z.prototype)&&e.dataTransfer){let t=Rt._b.as(Wt.$m.DragAndDropContribution).getAll(),i=Array.from(t).map(e=>e.dataFormatKey);if(!(0,Wt.th)(e,Rt.pa.FILES,Wt.Qm.FILES,Rt.pa.RESOURCES,Wt.Qm.EDITORS,...i))return void(e.dataTransfer.dropEffect="none")}this.updateContainer(!0);let t=e.target;if(t&&(this.overlay&&!this.overlay.contains(t)&&this.disposeOverlay(),!this.overlay)){let e=this.findTargetGroupView(t);e&&(this._overlay=this.instantiationService.createInstance(Ln,e))}}onDragLeave(){this.counter--,0===this.counter&&this.updateContainer(!1)}onDragEnd(){this.counter=0,this.updateContainer(!1),this.disposeOverlay()}findTargetGroupView(e){return this.editorGroupService.groups.find(t=>{var i,o;return(0,Rt.Xx)(e,t.element)||(null===(i=(o=this.delegate).containsGroup)||void 0===i?void 0:i.call(o,t))})}updateContainer(e){this.container.classList.toggle("dragged-over",e)}dispose(){super.dispose(),this.disposeOverlay()}disposeOverlay(){this.overlay&&(this.overlay.dispose(),this._overlay=void 0)}};Wn=(0,Rt.Pb)([(0,Rt.Fb)(2,Pt.W),(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Rt.o_),(0,Rt.Fb)(5,Rt.Ub)],Wn),(0,Rt.qx)(),(0,Rt.Yt)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.en)();var Fn={targetWidth:900,leftMarginRatio:.1909,rightMarginRatio:.1909},Gn={type:"distribute"};function Zn(e){let t=(0,Rt.Zb)(".centered-layout-margin");return t.style.height="100%",e&&(t.style.backgroundColor=e.toString()),{element:t,layout:()=>{},minimumSize:60,maximumSize:1/0,onDidChange:Rt.dA.None}}var Nn=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,xt.A)({},Fn),o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.container=e,this.view=t,this.state=i,this.centeredLayoutFixedWidth=o,this.lastLayoutPosition={width:0,height:0,left:0,top:0},this.didLayout=!1,this.splitViewDisposables=new Rt.EA,this._boundarySashes={},this.container.appendChild(this.view.element),this.container.style.overflow="hidden"}get minimumWidth(){return this.splitView?this.splitView.minimumSize:this.view.minimumWidth}get maximumWidth(){return this.splitView?this.splitView.maximumSize:this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get onDidChange(){return this.view.onDidChange}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitView&&(this.splitView.orthogonalStartSash=e.top,this.splitView.orthogonalEndSash=e.bottom)}layout(e,t,i,o){this.lastLayoutPosition={width:e,height:t,top:i,left:o},this.splitView?(this.splitView.layout(e,this.lastLayoutPosition),(!this.didLayout||this.centeredLayoutFixedWidth)&&this.resizeSplitViews()):this.view.layout(e,t,i,o),this.didLayout=!0}resizeSplitViews(){if(this.splitView)if(this.centeredLayoutFixedWidth){let e=Math.min(this.lastLayoutPosition.width,this.state.targetWidth),t=(this.lastLayoutPosition.width-e)/2;this.splitView.resizeView(0,Math.floor(t)),this.splitView.resizeView(1,e),this.splitView.resizeView(2,Math.ceil(t))}else{let e=this.state.leftMarginRatio*this.lastLayoutPosition.width,t=this.state.rightMarginRatio*this.lastLayoutPosition.width,i=this.lastLayoutPosition.width-e-t;this.splitView.resizeView(0,e),this.splitView.resizeView(1,i),this.splitView.resizeView(2,t)}}setFixedWidth(e){this.centeredLayoutFixedWidth=e,this.splitView&&(this.updateState(),this.resizeSplitViews())}updateState(){this.splitView&&(this.state.targetWidth=this.splitView.getViewSize(1),this.state.leftMarginRatio=this.splitView.getViewSize(0)/this.lastLayoutPosition.width,this.state.rightMarginRatio=this.splitView.getViewSize(2)/this.lastLayoutPosition.width)}isActive(){return!!this.splitView}styles(e){this.style=e,this.splitView&&this.emptyViews&&(this.splitView.style(this.style),this.emptyViews[0].element.style.backgroundColor=this.style.background.toString(),this.emptyViews[1].element.style.backgroundColor=this.style.background.toString())}activate(e){var t,i;if(e!==this.isActive())if(e){this.view.element.remove(),this.splitView=new Rt.Jt(this.container,{inverseAltBehavior:!0,orientation:Rt.Xt.HORIZONTAL,styles:this.style}),this.splitView.orthogonalStartSash=this.boundarySashes.top,this.splitView.orthogonalEndSash=this.boundarySashes.bottom,this.splitViewDisposables.add(this.splitView.onDidSashChange(()=>{this.splitView&&this.updateState()})),this.splitViewDisposables.add(this.splitView.onDidSashReset(()=>{this.state=(0,xt.A)({},Fn),this.resizeSplitViews()})),this.splitView.layout(this.lastLayoutPosition.width,this.lastLayoutPosition);let e=this.style?this.style.background:void 0;this.emptyViews=[Zn(e),Zn(e)],this.splitView.addView(this.emptyViews[0],Gn,0),this.splitView.addView(function(e,t){return{element:e.element,get maximumSize(){return e.maximumWidth},get minimumSize(){return e.minimumWidth},onDidChange:Rt.dA.map(e.onDidChange,e=>e&&e.width),layout:(i,o,s)=>{var r,n;return e.layout(i,t(),null!==(r=null===s||void 0===s?void 0:s.top)&&void 0!==r?r:0,(null!==(n=null===s||void 0===s?void 0:s.left)&&void 0!==n?n:0)+o)}}}(this.view,()=>this.lastLayoutPosition.height),Gn,1),this.splitView.addView(this.emptyViews[1],Gn,2),this.resizeSplitViews()}else null!==(t=this.splitView)&&void 0!==t&&t.el.remove(),this.splitViewDisposables.clear(),null!==(i=this.splitView)&&void 0!==i&&i.dispose(),this.splitView=void 0,this.emptyViews=void 0,this.container.appendChild(this.view.element),this.view.layout(this.lastLayoutPosition.width,this.lastLayoutPosition.height,this.lastLayoutPosition.top,this.lastLayoutPosition.left)}isDefault(e){return this.centeredLayoutFixedWidth?e.targetWidth===Fn.targetWidth:e.leftMarginRatio===Fn.leftMarginRatio&&e.rightMarginRatio===Fn.rightMarginRatio}dispose(){this.splitViewDisposables.dispose(),this.splitView&&(this.splitView=void this.splitView.dispose())}};(0,Rt.Ib)(),(0,Rt.$d)(),(0,Tt.mt)(),(0,Rt.qx)(),(0,Rt.gA)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Pt.Q)(),(0,Rt.Kb)(),(0,Pt.en)(),(0,Lt.Xn)(),(0,Rt.WM)(),(0,Lt.Z)(),(0,Rt.s_)(),(0,Rt.PA)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Wt.ua)(),(0,Rt.Ev)(),(0,Rt.xN)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Rt.nM)(),(0,Wt.W)(),(0,Rt.Iw)(),(0,Lt.U)(),(0,Lt.F)(),(0,Rt.bb)(),(0,Rt.tu)(),(0,Nt.ir)(),(0,Rt.gE)(),(0,Rt.Yt)(),(0,Rt.en)();var Pn,Jn=class{constructor(){this.element=(0,Rt.Zb)(".grid-view-container"),this._onDidChange=new Rt.pA,this.onDidChange=this._onDidChange.event}get minimumWidth(){return this.gridWidget?this.gridWidget.minimumWidth:0}get maximumWidth(){return this.gridWidget?this.gridWidget.maximumWidth:1/0}get minimumHeight(){return this.gridWidget?this.gridWidget.minimumHeight:0}get maximumHeight(){return this.gridWidget?this.gridWidget.maximumHeight:1/0}get gridWidget(){return this._gridWidget}set gridWidget(e){this.element.textContent="",e?(this.element.appendChild(e.element),this._onDidChange.input=e.onDidChange):this._onDidChange.input=Rt.dA.None,this._gridWidget=e}layout(e,t,i,o){var s;null===(s=this.gridWidget)||void 0===s||s.layout(e,t,i,o)}dispose(){this._onDidChange.dispose()}},Bn=(M=class extends Tt.pt{constructor(e,t,i,o,s,r,n,a,d,l,c){super(t,{hasTitle:!1},r,a,d),this.editorPartsView=e,this.groupsLabel=i,this.windowId=o,this.instantiationService=s,this.configurationService=n,this.hostService=l,this.contextKeyService=c,this._onDidFocus=this._register(new Rt.uA),this.onDidFocus=this._onDidFocus.event,this._onDidLayout=this._register(new Rt.uA),this.onDidLayout=this._onDidLayout.event,this._onDidChangeActiveGroup=this._register(new Rt.uA),this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidChangeGroupIndex=this._register(new Rt.uA),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLabel=this._register(new Rt.uA),this.onDidChangeGroupLabel=this._onDidChangeGroupLabel.event,this._onDidChangeGroupLocked=this._register(new Rt.uA),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidChangeGroupMaximized=this._register(new Rt.uA),this.onDidChangeGroupMaximized=this._onDidChangeGroupMaximized.event,this._onDidActivateGroup=this._register(new Rt.uA),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidAddGroup=this._register(new Rt.fA),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new Rt.fA),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new Rt.uA),this.onDidMoveGroup=this._onDidMoveGroup.event,this.onDidSetGridWidget=this._register(new Rt.uA),this._onDidChangeSizeConstraints=this._register(new Rt.pA),this.onDidChangeSizeConstraints=Rt.dA.any(this.onDidSetGridWidget.event,this._onDidChangeSizeConstraints.event),this._onDidScroll=this._register(new Rt.pA),this.onDidScroll=Rt.dA.any(this.onDidSetGridWidget.event,this._onDidScroll.event),this._onDidChangeEditorPartOptions=this._register(new Rt.uA),this.onDidChangeEditorPartOptions=this._onDidChangeEditorPartOptions.event,this._onWillDispose=this._register(new Rt.uA),this.onWillDispose=this._onWillDispose.event,this.workspaceMemento=this.getMemento(Rt.Go.WORKSPACE,Rt.Ko.USER),this.profileMemento=this.getMemento(Rt.Go.PROFILE,Rt.Ko.MACHINE),this.groupViews=new Map,this.mostRecentActiveGroups=[],this.container=(0,Rt.Zb)(".content"),this.gridWidgetDisposables=this._register(new Rt.EA),this.gridWidgetView=this._register(new Jn),this.enforcedPartOptions=[],this.top=0,this.left=0,this.sideGroup={openEditor:(e,t)=>{let[i]=this.scopedInstantiationService.invokeFunction(i=>(0,zt.a)(i,{editor:e,options:t},-2));return i.openEditor(e,t)}},this._isReady=!1,this.whenReadyPromise=new Rt.pw,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new Rt.pw,this.whenRestored=this.whenRestoredPromise.p,this._willRestoreState=!1,this.priority=Rt.Kt.High,this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.container)),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new Rt.eu([Rt.yb,this.scopedContextKeyService]))),this._partOptions=(0,Lt.Y)(this.configurationService,this.themeService),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.themeService.onDidFileIconThemeChange(()=>this.handleChangedPartOptions())),this._register(this.onDidChangeMementoValue(Rt.Go.WORKSPACE,this._store)(e=>this.onDidChangeMementoState(e)))}onConfigurationUpdated(e){(0,Lt.X)(e)&&this.handleChangedPartOptions()}handleChangedPartOptions(){let e=this._partOptions,t=(0,Lt.Y)(this.configurationService,this.themeService);for(let i of this.enforcedPartOptions)Object.assign(t,i);this._partOptions=t,this._onDidChangeEditorPartOptions.fire({oldPartOptions:e,newPartOptions:t})}get partOptions(){return this._partOptions}enforcePartOptions(e){return this.enforcedPartOptions.push(e),this.handleChangedPartOptions(),(0,Rt.zA)(()=>{this.enforcedPartOptions.splice(this.enforcedPartOptions.indexOf(e),1),this.handleChangedPartOptions()})}get contentDimension(){return this._contentDimension}get activeGroup(){return this._activeGroup}get groups(){return Array.from(this.groupViews.values())}get count(){return this.groupViews.size}get orientation(){return this.gridWidget&&this.gridWidget.orientation===Rt.Xt.VERTICAL?Pt.J.VERTICAL:Pt.J.HORIZONTAL}get isReady(){return this._isReady}get hasRestorableState(){return!!this.workspaceMemento[Pn.EDITOR_PART_UI_STATE_STORAGE_KEY]}get willRestoreState(){return this._willRestoreState}getGroups(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt.X.CREATION_TIME){case Pt.X.CREATION_TIME:return this.groups;case Pt.X.MOST_RECENTLY_ACTIVE:return(0,Rt.LM)([...(0,Rt.AM)(this.mostRecentActiveGroups.map(e=>this.getGroup(e))),...this.groups]);case Pt.X.GRID_APPEARANCE:{let e=[];return this.gridWidget&&this.fillGridNodes(e,this.gridWidget.getViews()),e}}}fillGridNodes(e,t){Si(t)?t.children.forEach(t=>this.fillGridNodes(e,t)):e.push(t.view)}hasGroup(e){return this.groupViews.has(e)}getGroup(e){return this.groupViews.get(e)}findGroup(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeGroup,i=arguments.length>2?arguments[2]:void 0;if("number"==typeof e.direction)return this.doFindGroupByDirection(e.direction,t,i);if("number"==typeof e.location)return this.doFindGroupByLocation(e.location,t,i);throw Error("invalid arguments")}doFindGroupByDirection(e,t,i){let o=this.assertGroupView(t),s=this.gridWidget.getNeighborViews(o,this.toGridViewDirection(e),i);return s.sort((e,t)=>this.mostRecentActiveGroups.indexOf(e.id)-this.mostRecentActiveGroups.indexOf(t.id)),s[0]}doFindGroupByLocation(e,t,i){let o=this.assertGroupView(t),s=this.getGroups(Pt.X.GRID_APPEARANCE),r=s.indexOf(o);switch(e){case Pt.q.FIRST:return s[0];case Pt.q.LAST:return s[s.length-1];case Pt.q.NEXT:{let e=s[r+1];return!e&&i&&(e=this.doFindGroupByLocation(Pt.q.FIRST,t)),e}case Pt.q.PREVIOUS:{let e=s[r-1];return!e&&i&&(e=this.doFindGroupByLocation(Pt.q.LAST,t)),e}}}activateGroup(e,t){let i=this.assertGroupView(e);return this.doSetGroupActive(i),t||this.hostService.moveTop((0,Rt.Bx)(this.element)),i}restoreGroup(e){let t=this.assertGroupView(e);return this.doRestoreGroup(t),t}getSize(e){let t=this.assertGroupView(e);return this.gridWidget.getViewSize(t)}setSize(e,t){let i=this.assertGroupView(e);this.gridWidget.resizeView(i,t)}arrangeGroups(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeGroup;if(this.count<2||!this.gridWidget)return;let i=this.assertGroupView(t);switch(e){case Pt.Y.EVEN:this.gridWidget.distributeViewSizes();break;case Pt.Y.MAXIMIZE:if(this.groups.length<2)return;this.gridWidget.maximizeView(i),i.focus();break;case Pt.Y.EXPAND:this.gridWidget.expandView(i)}}toggleMaximizeGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeGroup;this.hasMaximizedGroup()?this.unmaximizeGroup():this.arrangeGroups(Pt.Y.MAXIMIZE,e)}toggleExpandGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeGroup;this.isGroupExpanded(this.activeGroup)?this.arrangeGroups(Pt.Y.EVEN):this.arrangeGroups(Pt.Y.EXPAND,e)}unmaximizeGroup(){this.gridWidget.exitMaximizedView(),this._activeGroup.focus()}hasMaximizedGroup(){return this.gridWidget.hasMaximizedView()}isGroupMaximized(e){return this.gridWidget.isViewMaximized(e)}isGroupExpanded(e){return this.gridWidget.isViewExpanded(e)}setGroupOrientation(e){if(!this.gridWidget)return;let t=e===Pt.J.HORIZONTAL?Rt.Xt.HORIZONTAL:Rt.Xt.VERTICAL;this.gridWidget.orientation!==t&&(this.gridWidget.orientation=t)}applyLayout(e){let t=this.shouldRestoreFocus(this.container),i=0;!function e(t){for(let o of t)Array.isArray(o.groups)?e(o.groups):i++}(e.groups);let o=this.getGroups(Pt.X.GRID_APPEARANCE);if(i<o.length){let e=o[i-1];o.forEach((t,o)=>{o>=i&&this.mergeGroup(t,e)}),o=this.getGroups(Pt.X.GRID_APPEARANCE)}let s=this.activeGroup,r=Fi({orientation:this.toGridViewOrientation(e.orientation,this.isTwoDimensionalGrid()?this.gridWidget.orientation:gi(this.gridWidget.orientation)),groups:e.groups});this.doApplyGridState(r,s.id,o),t&&this._activeGroup.focus()}getLayout(){let e=this.gridWidget.serialize();return{orientation:e.orientation===Rt.Xt.HORIZONTAL?Pt.J.HORIZONTAL:Pt.J.VERTICAL,groups:this.serializedNodeToGroupLayoutArgument(e.root).groups}}serializedNodeToGroupLayoutArgument(e){return"branch"===e.type?{size:e.size,groups:e.data.map(e=>this.serializedNodeToGroupLayoutArgument(e))}:{size:e.size}}shouldRestoreFocus(e){return!!e&&((0,Rt.Tx)()===e.ownerDocument.body||(0,Rt.Zx)(e))}isTwoDimensionalGrid(){let e=this.gridWidget.getViews();return!!Si(e)&&e.children.some(e=>Si(e))}addGroup(e,t,i){let o,s=this.assertGroupView(e);if(s.groupsView===this){let e=this.shouldRestoreFocus(s.element),r=this.groupViews.size>1&&this.isGroupExpanded(s);o=this.doCreateGroupView(i),this.gridWidget.addView(o,this.getSplitSizingStyle(),s,this.toGridViewDirection(t)),this.updateContainer(),this._onDidAddGroup.fire(o),this.notifyGroupIndexChange(),r&&this.arrangeGroups(Pt.Y.EXPAND,o),e&&s.focus()}else o=s.groupsView.addGroup(s,t,i);return o}getSplitSizingStyle(){switch(this._partOptions.splitSizing){case"distribute":return yi.Distribute;case"split":return yi.Split;default:return yi.Auto}}doCreateGroupView(e,t){let i;i=e instanceof xn?xn.createCopy(e,this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t):(0,Wt.pa)(e)?xn.createFromSerialized(e,this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t):xn.createNew(this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t),this.groupViews.set(i.id,i);let o=new Rt.EA;return o.add(i.onDidFocus(()=>{this.doSetGroupActive(i),this._onDidFocus.fire()})),o.add(i.onDidModelChange(e=>{switch(e.kind){case Pt.Wt.GROUP_LOCKED:this._onDidChangeGroupLocked.fire(i);break;case Pt.Wt.GROUP_INDEX:this._onDidChangeGroupIndex.fire(i);break;case Pt.Wt.GROUP_LABEL:this._onDidChangeGroupLabel.fire(i)}})),o.add(i.onDidActiveEditorChange(()=>{this.updateContainer()})),Rt.dA.once(i.onWillDispose)(()=>{(0,Rt.MA)(o),this.groupViews.delete(i.id),this.doUpdateMostRecentActive(i)}),i}doSetGroupActive(e){if(this._activeGroup!==e){let t=this._activeGroup;this._activeGroup=e,this.doUpdateMostRecentActive(e,!0),t&&!t.disposed&&t.setActive(!1),e.setActive(!0),this.doRestoreGroup(e),this._onDidChangeActiveGroup.fire(e)}this._onDidActivateGroup.fire(e)}doRestoreGroup(e){if(this.gridWidget)try{this.hasMaximizedGroup()&&!this.isGroupMaximized(e)&&this.unmaximizeGroup();let t=this.gridWidget.getViewSize(e);(t.width===e.minimumWidth||t.height===e.minimumHeight)&&this.arrangeGroups(Pt.Y.EXPAND,e)}catch(t){}}doUpdateMostRecentActive(e,t){let i=this.mostRecentActiveGroups.indexOf(e.id);-1!==i&&this.mostRecentActiveGroups.splice(i,1),t&&this.mostRecentActiveGroups.unshift(e.id)}toGridViewDirection(e){switch(e){case Pt.K.UP:return wi.Up;case Pt.K.DOWN:return wi.Down;case Pt.K.LEFT:return wi.Left;case Pt.K.RIGHT:return wi.Right}}toGridViewOrientation(e,t){return"number"==typeof e?e===Pt.J.HORIZONTAL?Rt.Xt.HORIZONTAL:Rt.Xt.VERTICAL:t}removeGroup(e,t){let i=this.assertGroupView(e);1!==this.count&&(i.isEmpty?this.doRemoveEmptyGroup(i,t):this.doRemoveGroupWithEditors(i))}doRemoveGroupWithEditors(e){let t,i=this.getGroups(Pt.X.MOST_RECENTLY_ACTIVE);t=this._activeGroup===e?i[1]:i[0],this.mergeGroup(e,t)}doRemoveEmptyGroup(e,t){let i=!t&&this.shouldRestoreFocus(this.container);if(this._activeGroup===e){let e=this.getGroups(Pt.X.MOST_RECENTLY_ACTIVE)[1];this.doSetGroupActive(e)}this.gridWidget.removeView(e,this.getSplitSizingStyle()),e.dispose(),i&&this._activeGroup.focus(),this.notifyGroupIndexChange(),this.updateContainer(),this._onDidRemoveGroup.fire(e)}moveGroup(e,t,i){let o=this.assertGroupView(e),s=this.assertGroupView(t);if(o.id===s.id)throw Error("Cannot move group into its own");let r,n=this.shouldRestoreFocus(o.element);return o.groupsView===s.groupsView?(this.gridWidget.moveView(o,this.getSplitSizingStyle(),s,this.toGridViewDirection(i)),r=o):(r=s.groupsView.addGroup(s,i,o),o.closeAllEditors(),this.removeGroup(o,n)),n&&r.focus(),this._onDidMoveGroup.fire(r),this.notifyGroupIndexChange(),r}copyGroup(e,t,i){let o=this.assertGroupView(e),s=this.assertGroupView(t),r=this.shouldRestoreFocus(o.element),n=this.addGroup(s,i,o);return r&&n.focus(),n}mergeGroup(e,t,i){let o=this.assertGroupView(e),s=this.assertGroupView(t),r=[],n=i&&"number"==typeof i.index?i.index:s.count;for(let d of o.editors){let e,t=!o.isActive(d)||this._activeGroup!==o;s.contains(d)&&(s.isSticky(d)||null!==i&&void 0!==i&&i.preserveExistingIndex)||(e=n,n++),r.push({editor:d,options:{index:e,inactive:t,preserveFocus:t}})}let a=!0;return(null===i||void 0===i?void 0:i.mode)===Pt.Z.COPY_EDITORS?o.copyEditors(r,s):a=o.moveEditors(r,s),o.isEmpty&&!o.disposed&&this.removeGroup(o,!0),a}mergeAllGroups(e,t){let i=this.assertGroupView(e),o=!0;for(let s of this.getGroups(Pt.X.MOST_RECENTLY_ACTIVE))s!==i&&(this.mergeGroup(s,i,t)||(o=!1));return o}assertGroupView(e){let t;if(t="number"==typeof e?this.editorPartsView.getGroup(e):e,!t)throw Error("Invalid editor group provided!");return t}createEditorDropTarget(e,t){return(0,Rt.eM)((0,Rt.iS)(e)),this.scopedInstantiationService.createInstance(Wn,e,t)}get minimumWidth(){return Math.min(this.centeredLayoutWidget.minimumWidth,this.layoutService.getMaximumEditorDimensions(this.layoutService.getContainer((0,Rt.Bx)(this.container))).width)}get maximumWidth(){return this.centeredLayoutWidget.maximumWidth}get minimumHeight(){return Math.min(this.centeredLayoutWidget.minimumHeight,this.layoutService.getMaximumEditorDimensions(this.layoutService.getContainer((0,Rt.Bx)(this.container))).height)}get maximumHeight(){return this.centeredLayoutWidget.maximumHeight}get snap(){return"center"===this.layoutService.getPanelAlignment()}get onDidChange(){return Rt.dA.any(this.centeredLayoutWidget.onDidChange,this.onDidSetGridWidget.event)}get gridSeparatorBorder(){return this.theme.getColor(Lt._t)||this.theme.getColor(Rt._g)||Rt.Sv.transparent}updateStyles(){this.container.style.backgroundColor=this.getColor(Rt.Th)||"";let e={separatorBorder:this.gridSeparatorBorder,background:this.theme.getColor(Lt.Ct)||Rt.Sv.transparent};this.gridWidget.style(e),this.centeredLayoutWidget.styles(e)}createContentArea(e,t){return this.element=e,this.windowId!==Rt.vE.vscodeWindowId&&this.container.classList.add("auxiliary"),e.appendChild(this.container),this._willRestoreState=!t||t.restorePreviousState,this.doCreateGridControl(),this.centeredLayoutWidget=this._register(new Nn(this.container,this.gridWidgetView,this.profileMemento[Pn.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY],this._partOptions.centeredLayoutFixedWidth)),this._register(this.onDidChangeEditorPartOptions(e=>{var t;return this.centeredLayoutWidget.setFixedWidth(null!==(t=e.newPartOptions.centeredLayoutFixedWidth)&&void 0!==t&&t)})),this.setupDragAndDropSupport(e,this.container),this.handleContextKeys(),this.whenReadyPromise.complete(),this._isReady=!0,Rt.yw.settled(this.groups.map(e=>e.whenRestored)).finally(()=>{this.whenRestoredPromise.complete()}),this.container}handleContextKeys(){Nt.Sn.bindTo(this.scopedContextKeyService).set(this.windowId!==Rt.vE.vscodeWindowId);let e=Nt.hn.bindTo(this.scopedContextKeyService),t=Nt.mn.bindTo(this.scopedContextKeyService),i=()=>{this.count>1?e.set(!0):e.reset(),this.hasMaximizedGroup()?t.set(!0):t.reset()};i(),this._register(this.onDidAddGroup(()=>i())),this._register(this.onDidRemoveGroup(()=>i())),this._register(this.onDidChangeGroupMaximized(()=>i()))}setupDragAndDropSupport(e,t){this._register(this.createEditorDropTarget(t,Object.create(null)));let i=(0,Rt.Zb)(".drop-block-overlay");e.appendChild(i),this._register((0,Rt.ax)(i,()=>i.classList.remove("visible"))),this._register(Wt.R.INSTANCE.registerTarget(this.element,{onDragStart:e=>i.classList.add("visible"),onDragEnd:e=>i.classList.remove("visible")}));let o,s,r,n,a=e=>{this.layoutService.isVisible(Nt.I.PANEL_PART)||e!==this.layoutService.getPanelPosition()?!this.layoutService.isVisible(Nt.I.AUXILIARYBAR_PART)&&e===(this.layoutService.getSideBarPosition()===Nt.L.RIGHT?Nt.L.LEFT:Nt.L.RIGHT)&&this.layoutService.setPartHidden(!1,Nt.I.AUXILIARYBAR_PART):this.layoutService.setPartHidden(!1,Nt.I.PANEL_PART)},d=()=>{o&&(o=void clearTimeout(o)),s&&(s=void clearTimeout(s))};this._register(Wt.R.INSTANCE.registerTarget(i,{onDragOver:e=>{Rt.ex.stop(e.eventData,!0),e.eventData.dataTransfer&&(e.eventData.dataTransfer.dropEffect="none");let t,d,l=i.getBoundingClientRect();e.eventData.clientX<l.left+100&&(t=Nt.L.LEFT),e.eventData.clientX>l.right-100&&(t=Nt.L.RIGHT),e.eventData.clientY>l.bottom-100&&(d=Nt.L.BOTTOM),e.eventData.clientY<l.top+100&&(d=Nt.L.TOP),o&&t!==r&&(clearTimeout(o),o=void 0),s&&d!==n&&(clearTimeout(s),s=void 0),!o&&void 0!==t&&(r=t,o=setTimeout(()=>a(t),200)),!s&&void 0!==d&&(n=d,s=setTimeout(()=>a(d),200))},onDragLeave:()=>d(),onDragEnd:()=>d(),onDrop:()=>d()}))}centerLayout(e){this.centeredLayoutWidget.activate(e)}isLayoutCentered(){return!!this.centeredLayoutWidget&&this.centeredLayoutWidget.isActive()}doCreateGridControl(){let e=!1;if(this._willRestoreState&&(e=!this.doCreateGridControlWithPreviousState()),!this.gridWidget||e){let e=this.doCreateGroupView();this.doSetGridWidget(new Vi(e)),this.doSetGroupActive(e)}this.updateContainer(),this.notifyGroupIndexChange()}doCreateGridControlWithPreviousState(){let e=this.loadState();if(null!==e&&void 0!==e&&e.serializedGrid)try{this.mostRecentActiveGroups=e.mostRecentActiveGroups,this.doCreateGridControlWithState(e.serializedGrid,e.activeGroup)}catch(t){return(0,Rt.CN)(Error("Error restoring editor grid widget: ".concat(t," (with state: ").concat(JSON.stringify(e),")"))),this.disposeGroups(),!1}return!0}doCreateGridControlWithState(e,t,i,o){let s;s=i?i.slice(0):[];let r=[],n=Vi.deserialize(e,{fromJSON:e=>{let i;return i=s.length>0?s.shift():this.doCreateGroupView(e,o),r.push(i),i.id===t&&this.doSetGroupActive(i),i}},{styles:{separatorBorder:this.gridSeparatorBorder}});this._activeGroup||this.doSetGroupActive(r[0]),this.mostRecentActiveGroups.some(e=>!this.getGroup(e))&&(this.mostRecentActiveGroups=r.map(e=>e.id)),this.doSetGridWidget(n)}doSetGridWidget(e){let t={};this.gridWidget&&(t=this.gridWidget.boundarySashes,this.gridWidget.dispose()),this.gridWidget=e,this.gridWidget.boundarySashes=t,this.gridWidgetView.gridWidget=e,this._onDidChangeSizeConstraints.input=e.onDidChange,this._onDidScroll.input=e.onDidScroll,this.gridWidgetDisposables.clear(),this.gridWidgetDisposables.add(e.onDidChangeViewMaximized(e=>this._onDidChangeGroupMaximized.fire(e))),this.onDidSetGridWidget.fire(void 0)}updateContainer(){this.container.classList.toggle("empty",this.isEmpty)}notifyGroupIndexChange(){this.getGroups(Pt.X.GRID_APPEARANCE).forEach((e,t)=>e.notifyIndexChanged(t))}notifyGroupsLabelChange(e){for(let t of this.groups)t.notifyLabelChanged(e)}get isEmpty(){return 1===this.count&&this._activeGroup.isEmpty}setBoundarySashes(e){this.gridWidget.boundarySashes=e,this.centeredLayoutWidget.boundarySashes=e}layout(e,t,i,o){this.top=i,this.left=o;let s=super.layoutContents(e,t).contentSize;this.doLayout(Rt.Qb.lift(s),i,o)}doLayout(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.top,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.left;this._contentDimension=e,this.centeredLayoutWidget.layout(this._contentDimension.width,this._contentDimension.height,t,i),this._onDidLayout.fire(e)}saveState(){if(this.gridWidget&&(this.isEmpty?delete this.workspaceMemento[Pn.EDITOR_PART_UI_STATE_STORAGE_KEY]:this.workspaceMemento[Pn.EDITOR_PART_UI_STATE_STORAGE_KEY]=this.createState()),this.centeredLayoutWidget){let e=this.centeredLayoutWidget.state;this.centeredLayoutWidget.isDefault(e)?delete this.profileMemento[Pn.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]:this.profileMemento[Pn.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]=e}super.saveState()}loadState(){return this.workspaceMemento[Pn.EDITOR_PART_UI_STATE_STORAGE_KEY]}createState(){return{serializedGrid:this.gridWidget.serialize(),activeGroup:this._activeGroup.id,mostRecentActiveGroups:this.mostRecentActiveGroups}}applyState(e,t){return"empty"===e?this.doApplyEmptyState():this.doApplyState(e,t)}async doApplyState(e,t){let i=await this.doPrepareApplyState();this._onDidAddGroup.pause(),this._onDidRemoveGroup.pause(),this.disposeGroups(),this.mostRecentActiveGroups=e.mostRecentActiveGroups;try{this.doApplyGridState(e.serializedGrid,e.activeGroup,void 0,t)}finally{this._onDidRemoveGroup.resume(),this._onDidAddGroup.resume()}await this.activeGroup.openEditors(i.flatMap(e=>e.editors).filter(e=>this.editorPartsView.groups.every(t=>!t.contains(e))).map(e=>({editor:e,options:{pinned:!0,preserveFocus:!0,inactive:!0}})))}async doApplyEmptyState(){await this.doPrepareApplyState(),this.mergeAllGroups(this.activeGroup)}async doPrepareApplyState(){let e=this.getGroups(Pt.X.MOST_RECENTLY_ACTIVE);for(let t of e)await t.closeAllEditors({excludeConfirming:!0});return e}doApplyGridState(e,t,i,o){this.doCreateGridControlWithState(e,t,i,o),this.doLayout(this._contentDimension),this.updateContainer();for(let s of this.getGroups(Pt.X.GRID_APPEARANCE))(null===i||void 0===i?void 0:i.includes(s))||this._onDidAddGroup.fire(s);this.notifyGroupIndexChange()}onDidChangeMementoState(e){if(e.external&&e.scope===Rt.Go.WORKSPACE){this.reloadMemento(e.scope);let t=this.loadState();t&&this.applyState(t)}}toJSON(){return{type:Nt.I.EDITOR_PART}}disposeGroups(){for(let e of this.groups)e.dispose(),this._onDidRemoveGroup.fire(e);this.groupViews.clear(),this.mostRecentActiveGroups=[]}dispose(){var e;this._onWillDispose.fire(),this.disposeGroups(),null!==(e=this.gridWidget)&&void 0!==e&&e.dispose(),super.dispose()}},{_:Pn=M},{_:M.EDITOR_PART_UI_STATE_STORAGE_KEY="editorpart.state"},{_:M.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY="editorpart.centeredview"},M);Bn=Pn=(0,Rt.Pb)([(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.Qd),(0,Rt.Fb)(6,Rt.o_),(0,Rt.Fb)(7,Rt.Uo),(0,Rt.Fb)(8,Nt.Z),(0,Rt.Fb)(9,Lt.P),(0,Rt.Fb)(10,Rt.yb)],Bn);var On=class extends Bn{constructor(e,t,i,o,s,r,n,a){super(e,Nt.I.EDITOR_PART,"",Rt.vE.vscodeWindowId,t,i,o,s,r,n,a)}};On=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Rt.Qd),(0,Rt.Fb)(3,Rt.o_),(0,Rt.Fb)(4,Rt.Uo),(0,Rt.Fb)(5,Nt.Z),(0,Rt.Fb)(6,Lt.P),(0,Rt.Fb)(7,Rt.yb)],On),(0,Rt.Ib)(),(0,Rt.eE)(),(0,Rt.qx)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.mj)(),(0,Rt.s_)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.Kb)(),(0,Rt.tu)(),(0,Rt.Wo)(),(0,Rt.$d)(),(0,Rt.hi)(),(0,Tt.Ct)(),(0,Tt.Fn)(),(0,Pt.Q)(),(0,Pt.At)(),(0,Lt.F)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Pt.z)(),(0,Wt.vx)(),(0,Tt.Cn)(),(0,Rt.db)(),(0,Rt.Fj)(),(0,Rt.gD)(),(0,Nt.ir)(),(0,Mt.c)();var Kn,Mn,jn=(0,Rt.IA)(new Rt.uA);(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.toggleCompactAuxiliaryWindow",title:(0,Rt.Lj)(3049,"Toggle Window Compact Mode"),category:Mt.s.View,f1:!0,precondition:Nt.Cn})}async run(){jn.fire({windowId:(0,Rt.Ex)().vscodeWindowId,compact:"toggle"})}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.enableCompactAuxiliaryWindow",title:(0,Rt.Ij)(3050,"Turn On Compact Mode"),icon:Rt.mD.screenFull,menu:{id:Rt.sb.LayoutControlMenu,when:Rt.PO.and(Nt.wn.toNegated(),Nt.Sn),order:0}})}async run(){jn.fire({windowId:(0,Rt.Ex)().vscodeWindowId,compact:!0})}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.disableCompactAuxiliaryWindow",title:(0,Rt.Ij)(3051,"Turn Off Compact Mode"),icon:Rt.mD.screenNormal,menu:{id:Rt.sb.LayoutControlMenu,when:Rt.PO.and(Nt.wn,Nt.Sn),order:0}})}async run(){jn.fire({windowId:(0,Rt.Ex)().vscodeWindowId,compact:!1})}});var Qn=(j=class{constructor(e,t,i,o,s,r,n,a,d){this.editorPartsView=e,this.instantiationService=t,this.auxiliaryWindowService=i,this.lifecycleService=o,this.configurationService=s,this.statusbarService=r,this.titleService=n,this.editorService=a,this.layoutService=d}async create(e,t){let i=this,o=new Rt.EA,s=!(null===t||void 0===t||!t.compact);function r(e){b?(0,Rt.DS)(p.container):(0,Rt.Kx)(p.container),e&&d.layout()}function n(e){h&&(g?(0,Rt.DS)(h.container):(0,Rt.Kx)(h.container),e&&d.layout())}function a(e){var t;if(e===s)return;s=e,d.updateOptions({compact:s}),null!==(t=h)&&void 0!==t&&t.updateOptions({compact:s}),c.updateOptions({compact:s});let o=b;b=!s&&!1!==i.configurationService.getValue(Kn.STATUS_BAR_VISIBILITY),o!==b&&r(!0)}let d=o.add(await this.auxiliaryWindowService.open(t)),l=(0,Rt.Zb)(".part.editor",{role:"main"});l.style.position="relative",d.container.appendChild(l);let c=o.add(this.instantiationService.createInstance(Yn,d.window.vscodeWindowId,this.editorPartsView,null===t||void 0===t?void 0:t.state,e));c.updateOptions({compact:s}),o.add(this.editorPartsView.registerPart(c)),c.create(l);let h,u=o.add(c.scopedInstantiationService.createChild(new Rt.eu([Pt.kt,this.editorService.createScoped(c,o)]))),g=!1;if(Rt.Tj&&(0,Rt.fi)()){h=o.add(this.titleService.createAuxiliaryTitlebarPart(d.container,c,u)),h.updateOptions({compact:s}),g=(0,Nt.G)(this.configurationService,d.window,void 0);let e=()=>{let e=g;g=(0,Nt.G)(this.configurationService,d.window,void 0),e!==g&&n(!0)};o.add(h.onDidChange(()=>d.layout())),o.add(this.layoutService.onDidChangePartVisibility(()=>e())),o.add((0,Rt.uE)(t=>{t===d.window.vscodeWindowId&&e()})),n(!1)}else o.add(u.createInstance(Tt.St,d.window));let p=o.add(this.statusbarService.createAuxiliaryStatusbarPart(d.container,u)),b=!s&&!1!==this.configurationService.getValue(Kn.STATUS_BAR_VISIBILITY);o.add(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Kn.STATUS_BAR_VISIBILITY)&&(b=!s&&!1!==this.configurationService.getValue(Kn.STATUS_BAR_VISIBILITY),r(!0))})),r(!1);let m=o.add(Rt.dA.once(c.onWillClose)(()=>d.window.close()));return o.add(Rt.dA.once(d.onUnload)(()=>{o.isDisposed||(m.dispose(),c.close(),o.dispose())})),o.add(Rt.dA.once(this.lifecycleService.onDidShutdown)(()=>o.dispose())),o.add(d.onBeforeUnload(e=>{for(let t of c.groups)for(let i of t.editors){let o=i.canMove(t.id,this.editorPartsView.mainPart.activeGroup.id);if("string"==typeof o)return t.openEditor(i),void e.veto(o)}})),o.add(d.onWillLayout(e=>{var t,i,o;let s=null!==(t=null===(i=h)||void 0===i?void 0:i.height)&&void 0!==t?t:0;null===(o=h)||void 0===o||o.layout(e.width,s,0,0);let r=e.height-function(){let e=0;return b&&(e+=p.height),h&&g&&(e+=h.height),e}();c.layout(e.width,r,s,0),p.layout(e.width,p.height,e.height-p.height,0)})),d.layout(),o.add(jn.event(e=>{if(e.windowId===d.window.vscodeWindowId){let t;t="boolean"==typeof e.compact?e.compact:!s,a(t)}})),o.add(c.onDidAddGroup(e=>{a(!1),o.add(e.onDidActiveEditorChange(()=>{e.count>1&&a(!1)}))})),o.add(c.activeGroup.onDidActiveEditorChange(()=>{c.activeGroup.count>1&&a(!1)})),{part:c,instantiationService:o.add(u.createChild(new Rt.eu([Wt._x,this.statusbarService.createScoped(p,o)]))),disposables:o}}},{_:Kn=j},{_:j.STATUS_BAR_VISIBILITY="workbench.statusBar.visible"},j);Qn=Kn=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Tt.Pn),(0,Rt.Fb)(3,Pt.R),(0,Rt.Fb)(4,Rt.o_),(0,Rt.Fb)(5,Wt._x),(0,Rt.Fb)(6,Tt.Sn),(0,Rt.Fb)(7,Pt.kt),(0,Rt.Fb)(8,Nt.Z)],Qn);var Yn=(Q=class extends Bn{constructor(e,t,i,o,s,r,n,a,d,l,c){let h=Mn.COUNTER++;super(t,"workbench.parts.auxiliaryEditor.".concat(h),o,e,s,r,n,a,d,l,c),this.state=i,this._onWillClose=this._register(new Rt.uA),this.onWillClose=this._onWillClose.event,this.optionsDisposable=this._register(new Rt.OA),this.isCompact=!1}updateOptions(e){this.isCompact=e.compact,e.compact?this.optionsDisposable.value||(this.optionsDisposable.value=this.enforcePartOptions({showTabs:"none",closeEmptyGroups:!0})):this.optionsDisposable.clear()}addGroup(e,t,i){return this.isCompact&&(e=this.editorPartsView.mainPart.activeGroup),super.addGroup(e,t,i)}removeGroup(e,t){let i=this.assertGroupView(e);1===this.count&&this.activeGroup===i?this.doRemoveLastGroup(t):super.removeGroup(e,t)}doRemoveLastGroup(e){let t=!e&&this.shouldRestoreFocus(this.container),i=this.editorPartsView.getGroups(Pt.X.MOST_RECENTLY_ACTIVE)[1];i&&(i.groupsView.activateGroup(i),t&&i.focus()),this.doClose(!1)}loadState(){return this.state}saveState(){}close(){return this.doClose(!0)}doClose(e){let t=!0;if(e){for(let e of this.groups)e.closeAllEditors({excludeConfirming:!0});t=this.mergeGroupsToMainPart()}return this._onWillClose.fire(),t}mergeGroupsToMainPart(){if(!this.groups.some(e=>e.count>0))return!0;let e;for(let i of this.editorPartsView.mainPart.getGroups(Pt.X.MOST_RECENTLY_ACTIVE))if(!i.isLocked){e=i;break}e||(e=this.editorPartsView.mainPart.addGroup(this.editorPartsView.mainPart.activeGroup,"right"===this.partOptions.openSideBySideDirection?Pt.K.RIGHT:Pt.K.DOWN));let t=this.mergeAllGroups(e,{preserveExistingIndex:!0});return e.focus(),t}},{_:Mn=Q},{_:Q.COUNTER=1},Q);Yn=Mn=(0,Rt.Pb)([(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.Qd),(0,Rt.Fb)(6,Rt.o_),(0,Rt.Fb)(7,Rt.Uo),(0,Rt.Fb)(8,Nt.Z),(0,Rt.Fb)(9,Lt.P),(0,Rt.Fb)(10,Rt.yb)],Yn),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Pt.Q)(),(0,Rt.Kb)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.im)(),(0,Rt.WM)(),(0,Tt.mt)(),(0,Rt.Iw)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.$d)(),(0,Tt.Fn)(),(0,Rt.hp)(),(0,Rt.bb)(),(0,Rt.qx)(),(0,Rt.tu)(),(0,Pt.At)(),(0,Wt.vx)(),(0,Rt.gE)();var Hn,Xn,Un=(Y=class extends Tt.ft{constructor(e,t,i,o,s){super("workbench.editorParts",i,t),this.instantiationService=e,this.storageService=t,this.auxiliaryWindowService=o,this.contextKeyService=s,this.mapPartToInstantiationService=new Map,this._onDidCreateAuxiliaryEditorPart=this._register(new Rt.uA),this.onDidCreateAuxiliaryEditorPart=this._onDidCreateAuxiliaryEditorPart.event,this.workspaceMemento=this.getMemento(Rt.Go.WORKSPACE,Rt.Ko.USER),this._isReady=!1,this.whenReadyPromise=new Rt.pw,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new Rt.pw,this.whenRestored=this.whenRestoredPromise.p,this._onDidActiveGroupChange=this._register(new Rt.uA),this.onDidChangeActiveGroup=this._onDidActiveGroupChange.event,this._onDidAddGroup=this._register(new Rt.uA),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new Rt.uA),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new Rt.uA),this.onDidMoveGroup=this._onDidMoveGroup.event,this._onDidActivateGroup=this._register(new Rt.uA),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidChangeGroupIndex=this._register(new Rt.uA),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLocked=this._register(new Rt.uA),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidChangeGroupMaximized=this._register(new Rt.uA),this.onDidChangeGroupMaximized=this._onDidChangeGroupMaximized.event,this.globalContextKeys=new Map,this.scopedContextKeys=new Map,this.contextKeyProviders=new Map,this.registeredContextKeys=new Map,this.contextKeyProviderDisposables=this._register(new Rt.wA),this.editorWorkingSets=(()=>{let e=this.storageService.get(Hn.EDITOR_WORKING_SETS_STORAGE_KEY,Rt.Go.WORKSPACE);return e?JSON.parse(e):[]})(),this.mainPart=this._register(this.createMainEditorPart()),this._register(this.registerPart(this.mainPart)),this.mostRecentActiveParts=[this.mainPart],this.restoreParts(),this.registerListeners()}registerListeners(){this._register(this.onDidChangeMementoValue(Rt.Go.WORKSPACE,this._store)(e=>this.onDidChangeMementoState(e))),this.whenReady.then(()=>this.registerGroupsContextKeyListeners())}createMainEditorPart(){return this.instantiationService.createInstance(On,this)}getScopedInstantiationService(e){var t;return e===this.mainPart&&(this.mapPartToInstantiationService.has(e.windowId)||this.instantiationService.invokeFunction(t=>{let i=t.get(Pt.kt),o=t.get(Wt._x);this.mapPartToInstantiationService.set(e.windowId,this._register(this.mainPart.scopedInstantiationService.createChild(new Rt.eu([Pt.kt,i.createScoped(this.mainPart,this._store)],[Wt._x,o.createScoped(o,this._store)]))))})),null!==(t=this.mapPartToInstantiationService.get(e.windowId))&&void 0!==t?t:this.instantiationService}async createAuxiliaryEditorPart(e){let{part:t,instantiationService:i,disposables:o}=await this.instantiationService.createInstance(Qn,this).create(this.getGroupsLabel(this._parts.size),e);return this.mapPartToInstantiationService.set(t.windowId,i),o.add((0,Rt.zA)(()=>this.mapPartToInstantiationService.delete(t.windowId))),this._onDidAddGroup.fire(t.activeGroup),this._onDidCreateAuxiliaryEditorPart.fire(t),t}registerPart(e){let t=this._register(new Rt.EA);return t.add(super.registerPart(e)),this.registerEditorPartListeners(e,t),t}unregisterPart(e){super.unregisterPart(e),this.parts.forEach((e,t)=>{e!==this.mainPart&&e.notifyGroupsLabelChange(this.getGroupsLabel(t))})}registerEditorPartListeners(e,t){t.add(e.onDidFocus(()=>{this.doUpdateMostRecentActive(e,!0),this._parts.size>1&&this._onDidActiveGroupChange.fire(this.activeGroup)})),t.add((0,Rt.zA)(()=>{this.doUpdateMostRecentActive(e),e.windowId!==Rt.vE.vscodeWindowId&&this._onDidActiveGroupChange.fire(this.activeGroup)})),t.add(e.onDidChangeActiveGroup(e=>this._onDidActiveGroupChange.fire(e))),t.add(e.onDidAddGroup(e=>this._onDidAddGroup.fire(e))),t.add(e.onDidRemoveGroup(e=>this._onDidRemoveGroup.fire(e))),t.add(e.onDidMoveGroup(e=>this._onDidMoveGroup.fire(e))),t.add(e.onDidActivateGroup(e=>this._onDidActivateGroup.fire(e))),t.add(e.onDidChangeGroupMaximized(e=>this._onDidChangeGroupMaximized.fire(e))),t.add(e.onDidChangeGroupIndex(e=>this._onDidChangeGroupIndex.fire(e))),t.add(e.onDidChangeGroupLocked(e=>this._onDidChangeGroupLocked.fire(e)))}doUpdateMostRecentActive(e,t){let i=this.mostRecentActiveParts.indexOf(e);-1!==i&&this.mostRecentActiveParts.splice(i,1),t&&this.mostRecentActiveParts.unshift(e)}getGroupsLabel(e){return(0,Rt.Ij)(3428,"Window {0}",e+1)}getPart(e){if(this._parts.size>1){if((0,Rt.iS)(e)){let t=e;return this.getPartByDocument(t.ownerDocument)}{let t;t="number"==typeof e?e:e.id;for(let e of this._parts)if(e.hasGroup(t))return e}}return this.mainPart}get isReady(){return this._isReady}async restoreParts(){var e;if(await this.mainPart.whenReady,this.mainPart.willRestoreState){let e=this.loadState();e&&await this.restoreState(e)}null!==(e=this.mostRecentActiveParts.at(0))&&void 0!==e&&e.activeGroup.focus(),this._isReady=!0,this.whenReadyPromise.complete(),await Promise.allSettled(this.parts.map(e=>e.whenRestored)),this.whenRestoredPromise.complete()}loadState(){return this.workspaceMemento[Hn.EDITOR_PARTS_UI_STATE_STORAGE_KEY]}saveState(){let e=this.createState();0===e.auxiliary.length?delete this.workspaceMemento[Hn.EDITOR_PARTS_UI_STATE_STORAGE_KEY]:this.workspaceMemento[Hn.EDITOR_PARTS_UI_STATE_STORAGE_KEY]=e}createState(){return{auxiliary:this.parts.filter(e=>e!==this.mainPart).map(e=>{let t=this.auxiliaryWindowService.getWindow(e.windowId);return(0,xt.A)({state:e.createState()},null===t||void 0===t?void 0:t.createState())}),mru:this.mostRecentActiveParts.map(e=>this.parts.indexOf(e))}}async restoreState(e){if(e.auxiliary.length){let t=[];for(let i of e.auxiliary)t.push(this.createAuxiliaryEditorPart(i));await Promise.allSettled(t),e.mru.length===this.parts.length?this.mostRecentActiveParts=e.mru.map(e=>this.parts[e]):this.mostRecentActiveParts=[...this.parts],await Promise.allSettled(this.parts.map(e=>e.whenReady))}}get hasRestorableState(){return this.parts.some(e=>e.hasRestorableState)}onDidChangeMementoState(e){if(e.external&&e.scope===Rt.Go.WORKSPACE){this.reloadMemento(e.scope);let t=this.loadState();t&&this.applyState(t)}}async applyState(e){for(let t of this.parts)if(t!==this.mainPart){for(let e of t.getGroups(Pt.X.MOST_RECENTLY_ACTIVE))await e.closeAllEditors({excludeConfirming:!0});if(!t.close())return!1}return"empty"!==e&&await this.restoreState(e),!0}saveWorkingSet(e){let t={id:(0,Rt.mp)(),name:e,main:this.mainPart.createState(),auxiliary:this.createState()};return this.editorWorkingSets.push(t),this.saveWorkingSets(),{id:t.id,name:t.name}}getWorkingSets(){return this.editorWorkingSets.map(e=>({id:e.id,name:e.name}))}deleteWorkingSet(e){let t=this.indexOfWorkingSet(e);"number"==typeof t&&(this.editorWorkingSets.splice(t,1),this.saveWorkingSets())}async applyWorkingSet(e,t){var i;let o;if(o="empty"===e?"empty":this.editorWorkingSets[null!==(i=this.indexOfWorkingSet(e))&&void 0!==i?i:-1],!o||!await this.applyState("empty"===o?o:o.auxiliary))return!1;if(await this.mainPart.applyState("empty"===o?o:o.main,t),null===t||void 0===t||!t.preserveFocus){let e=this.mostRecentActiveParts.at(0);e&&(await e.whenReady,e.activeGroup.focus())}return!0}indexOfWorkingSet(e){for(let t=0;t<this.editorWorkingSets.length;t++)if(this.editorWorkingSets[t].id===e.id)return t}saveWorkingSets(){this.storageService.store(Hn.EDITOR_WORKING_SETS_STORAGE_KEY,JSON.stringify(this.editorWorkingSets),Rt.Go.WORKSPACE,Rt.Ko.MACHINE)}get activeGroup(){return this.activePart.activeGroup}get sideGroup(){return this.activePart.sideGroup}get groups(){return this.getGroups()}get count(){return this.groups.length}getGroups(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt.X.CREATION_TIME;if(this._parts.size>1){let t;switch(e){case Pt.X.GRID_APPEARANCE:case Pt.X.CREATION_TIME:t=this.parts;break;case Pt.X.MOST_RECENTLY_ACTIVE:t=(0,Rt.LM)([...this.mostRecentActiveParts,...this.parts])}return t.flatMap(t=>t.getGroups(e))}return this.mainPart.getGroups(e)}getGroup(e){if(this._parts.size>1)for(let t of this._parts){let i=t.getGroup(e);if(i)return i}return this.mainPart.getGroup(e)}assertGroupView(e){let t;if(t="number"==typeof e?this.getGroup(e):e,!t)throw Error("Invalid editor group provided!");return t}activateGroup(e){return this.getPart(e).activateGroup(e)}getSize(e){return this.getPart(e).getSize(e)}setSize(e,t){this.getPart(e).setSize(e,t)}arrangeGroups(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activePart.activeGroup;this.getPart(t).arrangeGroups(e,t)}toggleMaximizeGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activePart.activeGroup;this.getPart(e).toggleMaximizeGroup(e)}toggleExpandGroup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activePart.activeGroup;this.getPart(e).toggleExpandGroup(e)}restoreGroup(e){return this.getPart(e).restoreGroup(e)}applyLayout(e){this.activePart.applyLayout(e)}getLayout(){return this.activePart.getLayout()}get orientation(){return this.activePart.orientation}setGroupOrientation(e){this.activePart.setGroupOrientation(e)}findGroup(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeGroup,i=arguments.length>2?arguments[2]:void 0,o=this.getPart(t);if(this._parts.size>1){let s=this.getGroups(Pt.X.GRID_APPEARANCE);if(e.location===Pt.q.FIRST||e.location===Pt.q.LAST)return e.location===Pt.q.FIRST?s[0]:s[s.length-1];let r=o.findGroup(e,t,!1);if(r)return r;if(e.location===Pt.q.NEXT||e.location===Pt.q.PREVIOUS){let o=this.assertGroupView(t),r=s.indexOf(o);if(e.location===Pt.q.NEXT){let e=s[r+1];return!e&&i&&(e=s[0]),e}{let e=s[r-1];return!e&&i&&(e=s[s.length-1]),e}}}return o.findGroup(e,t,i)}addGroup(e,t){return this.getPart(e).addGroup(e,t)}removeGroup(e){this.getPart(e).removeGroup(e)}moveGroup(e,t,i){return this.getPart(e).moveGroup(e,t,i)}mergeGroup(e,t,i){return this.getPart(e).mergeGroup(e,t,i)}mergeAllGroups(e,t){return this.activePart.mergeAllGroups(e,t)}copyGroup(e,t,i){return this.getPart(e).copyGroup(e,t,i)}createEditorDropTarget(e,t){return this.getPart(e).createEditorDropTarget(e,t)}registerGroupsContextKeyListeners(){this._register(this.onDidChangeActiveGroup(()=>this.updateGlobalContextKeys())),this.groups.forEach(e=>this.registerGroupContextKeyProvidersListeners(e)),this._register(this.onDidAddGroup(e=>this.registerGroupContextKeyProvidersListeners(e))),this._register(this.onDidRemoveGroup(e=>{this.scopedContextKeys.delete(e.id),this.registeredContextKeys.delete(e.id),this.contextKeyProviderDisposables.deleteAndDispose(e.id)}))}updateGlobalContextKeys(){let e=this.scopedContextKeys.get(this.activeGroup.id);if(e)for(let[t,i]of this.globalContextKeys){let o=e.get(t);o?i.set(o.get()):i.reset()}}bind(e,t){let i=this.globalContextKeys.get(e.key);i||(i=e.bindTo(this.contextKeyService),this.globalContextKeys.set(e.key,i));let o=this.scopedContextKeys.get(t.id);o||(o=new Map,this.scopedContextKeys.set(t.id,o));let s=o.get(e.key);s||(s=e.bindTo(t.scopedContextKeyService),o.set(e.key,s));let r=this;return{get:()=>s.get(),set(e){r.activeGroup===t&&i.set(e),s.set(e)},reset(){r.activeGroup===t&&i.reset(),s.reset()}}}registerContextKeyProvider(e){var t;if(this.contextKeyProviders.has(e.contextKey.key)||this.globalContextKeys.has(e.contextKey.key))throw Error("A context key provider for key ".concat(e.contextKey.key," already exists."));this.contextKeyProviders.set(e.contextKey.key,e);let i=()=>{for(let t of this.groups)this.updateRegisteredContextKey(t,e)};i();let o=null===(t=e.onDidChange)||void 0===t?void 0:t.call(e,()=>i());return(0,Rt.zA)(()=>{null!==o&&void 0!==o&&o.dispose(),this.globalContextKeys.delete(e.contextKey.key),this.scopedContextKeys.forEach(t=>t.delete(e.contextKey.key)),this.contextKeyProviders.delete(e.contextKey.key),this.registeredContextKeys.forEach(t=>t.delete(e.contextKey.key))})}registerGroupContextKeyProvidersListeners(e){let t=e.onDidActiveEditorChange(()=>{for(let t of this.contextKeyProviders.values())this.updateRegisteredContextKey(e,t)});this.contextKeyProviderDisposables.set(e.id,t)}updateRegisteredContextKey(e,t){let i=this.registeredContextKeys.get(e.id);i||(i=new Map,this.registeredContextKeys.set(e.id,i));let o=i.get(t.contextKey.key);o||(o=this.bind(t.contextKey,e),i.set(t.contextKey.key,o)),o.set(t.getGroupContextKeyValue(e))}get partOptions(){return this.mainPart.partOptions}get onDidChangeEditorPartOptions(){return this.mainPart.onDidChangeEditorPartOptions}enforcePartOptions(e){return this.mainPart.enforcePartOptions(e)}},{_:Hn=Y},{_:Y.EDITOR_PARTS_UI_STATE_STORAGE_KEY="editorparts.state"},{_:Y.EDITOR_WORKING_SETS_STORAGE_KEY="editor.workingSets"},Y);Un=Hn=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Rt.Uo),(0,Rt.Fb)(2,Rt.Qd),(0,Rt.Fb)(3,Tt.Pn),(0,Rt.Fb)(4,Rt.yb)],Un),(0,Rt.fE)(),(0,Rt.Ib)(),(0,Tt.st)(),(0,Rt.Fj)(),(0,Rt.Mb)(),(0,Rt.zr)(),(0,Nt.ir)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Rt.Wo)(),(0,Rt.wl)(),(0,Rt.Ad)(),(0,Rt.Kb)(),(0,Tt.ot)(),(0,Rt.$d)(),(0,Lt.Xn)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.Rd)(),(0,Rt.qx)(),(0,Rt.bb)(),(0,Rt.nM)(),(0,Nt.Ot)(),(0,Wt.fx)(),(0,Rt.xl)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.wb)(),(0,Rt.Xr)(),(0,Rt.cr)(),(0,Rt.s_)(),(0,Rt.mE)(Tt.ct);var zn=(H=class extends li{get preferredHeight(){return.4*this.layoutService.mainContainerDimension.height}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g){super(Nt.I.PANEL_PART,{hasTitle:!0,trailingSeparator:!0},Xn.activePanelSettingsKey,Nt.sn.bindTo(l),Nt.In.bindTo(l),"panel","panel",void 0,Lt.Gt,e,t,i,o,s,r,n,a,d,l,c,u),this.commandService=h,this.configurationService=g,this.minimumWidth=300,this.maximumWidth=1/0,this.minimumHeight=77,this.maximumHeight=1/0,this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("workbench.panel.showLabels")&&this.updateCompositeBar(!0)}))}updateStyles(){super.updateStyles();let e=(0,Rt.$j)(this.getContainer());e.style.backgroundColor=this.getColor(Lt.jt)||"";let t=this.getColor(Lt.Mt)||this.getColor(Rt._g)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t,e.style.borderBottomColor=t,this.titleArea&&(this.titleArea.style.borderTopColor=this.getColor(Lt.Mt)||this.getColor(Rt._g)||"")}getCompositeBarOptions(){return{partContainerClass:"panel",pinnedViewContainersKey:"workbench.panel.pinnedPanels",placeholderViewContainersKey:"workbench.panel.placeholderPanels",viewContainersWorkspaceStateKey:"workbench.panel.viewContainersWorkspaceState",icon:!1===this.configurationService.getValue("workbench.panel.showLabels"),orientation:Rt.Rr.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.layoutService.getPanelPosition()!==Nt.L.BOTTOM||this.layoutService.isPanelMaximized()?Rt._l.BELOW:Rt._l.ABOVE},fillExtraContextMenuActions:e=>this.fillExtraContextMenuActions(e),compositeSize:0,iconSize:16,compact:!0,overflowActionSize:44,colors:e=>({activeBackgroundColor:e.getColor(Lt.jt),inactiveBackgroundColor:e.getColor(Lt.jt),activeBorderBottomColor:e.getColor(Lt.kt),activeForegroundColor:e.getColor(Lt.At),inactiveForegroundColor:e.getColor(Lt.Pt),badgeBackground:e.getColor(Lt.Ut),badgeForeground:e.getColor(Lt.Wt),dragAndDropBorder:e.getColor(Lt.Nt)})}}fillExtraContextMenuActions(e){if(this.getCompositeBarPosition()===ri.TITLE){let t=this.getViewsSubmenuAction();t&&(e.push(new Rt.Ab),e.push(t))}let t=this.menuService.getMenuActions(Rt.sb.PanelPositionMenu,this.contextKeyService,{shouldForwardArgs:!0}),i=this.menuService.getMenuActions(Rt.sb.PanelAlignmentMenu,this.contextKeyService,{shouldForwardArgs:!0}),o=(0,Rt.qr)(t).secondary,s=(0,Rt.qr)(i).secondary,r=this.configurationService.getValue("workbench.panel.showLabels"),n=(0,Rt.Nb)({id:"workbench.action.panel.toggleShowLabels",label:r?(0,Rt.Ij)(3632,"Show Icons"):(0,Rt.Ij)(3633,"Show Labels"),run:()=>this.configurationService.updateValue("workbench.panel.showLabels",!r)});e.push(new Rt.Ab,new Rt.jb("workbench.action.panel.position",(0,Rt.Ij)(3634,"Panel Position"),o),new Rt.jb("workbench.action.panel.align",(0,Rt.Ij)(3635,"Align Panel"),s),n,(0,Rt.Nb)({id:Tt.at.ID,label:(0,Rt.Ij)(3636,"Hide Panel"),run:()=>this.commandService.executeCommand(Tt.at.ID)}))}layout(e,t,i,o){let s;switch(this.layoutService.getPanelPosition()){case Nt.L.RIGHT:s=new Rt.Qb(e-1,t);break;case Nt.L.TOP:s=new Rt.Qb(e,t-1);break;default:s=new Rt.Qb(e,t)}super.layout(s.width,s.height,i,o)}shouldShowCompositeBar(){return!0}getCompositeBarPosition(){return ri.TITLE}toJSON(){return{type:Nt.I.PANEL_PART}}},{_:Xn=H},{_:H.activePanelSettingsKey="workbench.panelpart.activepanelid"},H);zn=Xn=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ld),(0,Rt.Fb)(1,Rt.Uo),(0,Rt.Fb)(2,Rt.Sl),(0,Rt.Fb)(3,Nt.Z),(0,Rt.Fb)(4,Rt.kd),(0,Rt.Fb)(5,Rt.sr),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.Qd),(0,Rt.Fb)(8,Wt.dx),(0,Rt.Fb)(9,Rt.yb),(0,Rt.Fb)(10,Nt.Dt),(0,Rt.Fb)(11,Rt.Cb),(0,Rt.Fb)(12,Rt.Zr),(0,Rt.Fb)(13,Rt.o_)],zn);var qn,$n={};(0,Rt.fE)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Rt.tO)(),(0,Rt.gb)(),(0,Mt.c)(),(0,Nt.wt)(),(0,Wt.Df)(),(0,Nt.ir)(),(0,Rt.mE)($n),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.closeSidebar",title:(0,Rt.Lj)(3637,"Close Primary Side Bar"),category:Mt.s.View,f1:!0,precondition:Nt.Un})}run(e){e.get(Nt.Z).setPartHidden(!0,Nt.I.SIDEBAR_PART)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.focusSideBar",title:(0,Rt.Lj)(3638,"Focus into Primary Side Bar"),category:Mt.s.View,f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,when:null,primary:Rt.ZD.CtrlCmd|Rt.YD.Digit0}})}async run(e){var t;let i=e.get(Nt.Z),o=e.get(Nt.Ct);i.isVisible(Nt.I.SIDEBAR_PART)||i.setPartHidden(!1,Nt.I.SIDEBAR_PART),null===(t=o.getActivePaneComposite(Wt.Sf.Sidebar))||void 0===t||t.focus()}}),(0,Rt.fE)(),(0,Rt.Ib)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Nt.ir)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.wl)(),(0,Rt.Ad)(),(0,Rt.Kb)(),(0,Rt.$d)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Lt.Xn)(),(0,Rt.Rd)(),(0,Rt.bb)(),(0,Rt.ml)(),(0,Nt.Ot)(),(0,Rt.nM)(),(0,Wt.fx)(),(0,Tt.g)(),(0,Rt.zr)(),(0,Rt.xl)(),(0,Rt.s_)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.Mb)(),(0,Tt.nt)(),(0,Rt.Fj)(),(0,Rt.cr)(),(0,Rt.Yt)(),(0,Rt.mE)($n);var ea=(X=class extends li{get snap(){return!0}get preferredWidth(){let e=this.getActivePaneComposite();if(!e)return;let t=e.getOptimalWidth();return"number"==typeof t?Math.max(t,300):void 0}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u){super(Nt.I.SIDEBAR_PART,{hasTitle:!0,trailingSeparator:!1,borderWidth:()=>this.getColor(Lt.qt)||this.getColor(Rt._g)?1:0},qn.activeViewletSettingsKey,Nt.cn.bindTo(l),Nt.Gn.bindTo(l),"sideBar","viewlet",Lt.rn,Lt.nn,e,t,i,o,s,r,n,a,d,l,c,u),this.configurationService=h,this.minimumWidth=170,this.maximumWidth=1/0,this.minimumHeight=0,this.maximumHeight=1/0,this.priority=Rt.Kt.Low,this.activityBarPart=this._register(this.instantiationService.createInstance(Tt.h,this)),this.rememberActivityBarVisiblePosition(),this._register(h.onDidChangeConfiguration(e=>{e.affectsConfiguration(Nt.P.ACTIVITY_BAR_LOCATION)&&this.onDidChangeActivityBarLocation()})),this.registerActions()}onDidChangeActivityBarLocation(){var e;this.activityBarPart.hide(),this.updateCompositeBar();let t=null===(e=this.getActiveComposite())||void 0===e?void 0:e.getId();t&&this.onTitleAreaUpdate(t),this.shouldShowActivityBar()&&this.activityBarPart.show(),this.rememberActivityBarVisiblePosition()}updateStyles(){var e;super.updateStyles();let t=(0,Rt.$j)(this.getContainer());t.style.backgroundColor=this.getColor(Lt.Kt)||"",t.style.color=this.getColor(Lt.Yt)||"";let i=this.getColor(Lt.qt)||this.getColor(Rt._g),o=this.layoutService.getSideBarPosition()===Nt.L.LEFT;t.style.borderRightWidth=i&&o?"1px":"",t.style.borderRightStyle=i&&o?"solid":"",t.style.borderRightColor=o&&i||"",t.style.borderLeftWidth=i&&!o?"1px":"",t.style.borderLeftStyle=i&&!o?"solid":"",t.style.borderLeftColor=o?"":i||"",t.style.outlineColor=null!==(e=this.getColor(Lt.Jt))&&void 0!==e?e:""}layout(e,t,i,o){this.layoutService.isVisible(Nt.I.SIDEBAR_PART)&&super.layout(e,t,i,o)}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===Nt.L.LEFT?Rt.fl.LEFT:Rt.fl.RIGHT}createCompositeBar(){return this.instantiationService.createInstance(Tt.m,this.getCompositeBarOptions(),this.partId,this,!1)}getCompositeBarOptions(){return{partContainerClass:"sidebar",pinnedViewContainersKey:Tt.h.pinnedViewContainersKey,placeholderViewContainersKey:Tt.h.placeholderViewContainersKey,viewContainersWorkspaceStateKey:Tt.h.viewContainersWorkspaceStateKey,icon:!0,orientation:Rt.Rr.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===ri.BOTTOM?Rt._l.ABOVE:Rt._l.BELOW},fillExtraContextMenuActions:e=>{if(this.getCompositeBarPosition()===ri.TITLE){let t=this.getViewsSubmenuAction();t&&(e.push(new Rt.Ab),e.push(t))}},compositeSize:0,iconSize:16,overflowActionSize:30,colors:e=>({activeBackgroundColor:e.getColor(Lt.Kt),inactiveBackgroundColor:e.getColor(Lt.Kt),activeBorderBottomColor:e.getColor(Lt.lt),activeForegroundColor:e.getColor(Lt.dt),inactiveForegroundColor:e.getColor(Lt.ft),badgeBackground:e.getColor(Lt.rt),badgeForeground:e.getColor(Lt.it),dragAndDropBorder:e.getColor(Lt.ut)}),compact:!0}}shouldShowCompositeBar(){let e=this.configurationService.getValue(Nt.P.ACTIVITY_BAR_LOCATION);return e===Nt.j.TOP||e===Nt.j.BOTTOM}shouldShowActivityBar(){return!this.shouldShowCompositeBar()&&this.configurationService.getValue(Nt.P.ACTIVITY_BAR_LOCATION)!==Nt.j.HIDDEN}getCompositeBarPosition(){switch(this.configurationService.getValue(Nt.P.ACTIVITY_BAR_LOCATION)){case Nt.j.TOP:return ri.TOP;case Nt.j.BOTTOM:return ri.BOTTOM;case Nt.j.HIDDEN:case Nt.j.DEFAULT:default:return ri.TITLE}}rememberActivityBarVisiblePosition(){let e=this.configurationService.getValue(Nt.P.ACTIVITY_BAR_LOCATION);e!==Nt.j.HIDDEN&&this.storageService.store(Nt.P.ACTIVITY_BAR_LOCATION,e,Rt.Go.PROFILE,Rt.Ko.USER)}getRememberedActivityBarVisiblePosition(){switch(this.storageService.get(Nt.P.ACTIVITY_BAR_LOCATION,Rt.Go.PROFILE)){case Nt.j.TOP:return Nt.j.TOP;case Nt.j.BOTTOM:return Nt.j.BOTTOM;default:return Nt.j.DEFAULT}}getPinnedPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPinnedPaneCompositeIds():this.activityBarPart.getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(){return this.shouldShowCompositeBar()?super.getVisiblePaneCompositeIds():this.activityBarPart.getVisiblePaneCompositeIds()}getPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPaneCompositeIds():this.activityBarPart.getPaneCompositeIds()}async focusActivityBar(){this.configurationService.getValue(Nt.P.ACTIVITY_BAR_LOCATION)===Nt.j.HIDDEN&&(await this.configurationService.updateValue(Nt.P.ACTIVITY_BAR_LOCATION,this.getRememberedActivityBarVisiblePosition()),this.onDidChangeActivityBarLocation()),this.shouldShowCompositeBar()?this.focusCompositeBar():(this.layoutService.isVisible(Nt.I.ACTIVITYBAR_PART)||this.layoutService.setPartHidden(!1,Nt.I.ACTIVITYBAR_PART),this.activityBarPart.show(!0))}registerActions(){let e=this;this._register((0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Tt.X,title:(0,Rt.Lj)(3639,"Toggle Activity Bar Visibility")})}run(){let t=e.configurationService.getValue(Nt.P.ACTIVITY_BAR_LOCATION)===Nt.j.HIDDEN?e.getRememberedActivityBarVisiblePosition():Nt.j.HIDDEN;return e.configurationService.updateValue(Nt.P.ACTIVITY_BAR_LOCATION,t)}}))}toJSON(){return{type:Nt.I.SIDEBAR_PART}}},{_:qn=X},{_:X.activeViewletSettingsKey="workbench.sidebar.activeviewletid"},X);ea=qn=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ld),(0,Rt.Fb)(1,Rt.Uo),(0,Rt.Fb)(2,Rt.Sl),(0,Rt.Fb)(3,Nt.Z),(0,Rt.Fb)(4,Rt.kd),(0,Rt.Fb)(5,Rt.sr),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.Qd),(0,Rt.Fb)(8,Wt.dx),(0,Rt.Fb)(9,Rt.yb),(0,Rt.Fb)(10,Nt.Dt),(0,Rt.Fb)(11,Rt.o_),(0,Rt.Fb)(12,Rt.Zr)],ea),(0,Rt.Ib)(),(0,Tt.zn)(),(0,Rt.PA)(),(0,Rt.im)(),(0,Wt.fx)(),(0,Tt.w)(),(0,Rt.gA)(),(0,Rt.Kb)();var ta=class extends Rt.CA{constructor(e,t,i){super(),this.viewId=e,this.viewDescriptorService=t,this.activityService=i,this.activity=void 0,this.activityDisposable=Rt.CA.None,this._register(Rt.dA.filter(this.viewDescriptorService.onDidChangeContainer,t=>t.views.some(t=>t.id===e))(()=>this.update())),this._register(Rt.dA.filter(this.viewDescriptorService.onDidChangeLocation,t=>t.views.some(t=>t.id===e))(()=>this.update()))}setActivity(e){this.activity=e,this.update()}clearActivity(){this.activity=void 0,this.update()}update(){this.activityDisposable.dispose();let e=this.viewDescriptorService.getViewContainerByViewId(this.viewId);e&&this.activity&&(this.activityDisposable=this.activityService.showViewContainerActivity(e.id,this.activity))}dispose(){this.activityDisposable.dispose(),super.dispose()}};ta=(0,Rt.Pb)([(0,Rt.Fb)(1,Wt.dx),(0,Rt.Fb)(2,Tt.Rn)],ta);var ia=class extends Rt.CA{constructor(e,t){super(),this.viewDescriptorService=e,this.instantiationService=t,this.viewActivities=new Map,this._onDidChangeActivity=this._register(new Rt.uA),this.onDidChangeActivity=this._onDidChangeActivity.event,this.viewContainerActivities=new Map,this.globalActivities=new Map}showViewContainerActivity(e,t){let i=this.viewDescriptorService.getViewContainerById(e);if(!i)return Rt.CA.None;let o=this.viewContainerActivities.get(e);return o||(o=[],this.viewContainerActivities.set(e,o)),o.push(t),this._onDidChangeActivity.fire(i),(0,Rt.zA)(()=>{o.splice(o.indexOf(t),1),0===o.length&&this.viewContainerActivities.delete(e),this._onDidChangeActivity.fire(i)})}getViewContainerActivities(e){var t;return this.viewDescriptorService.getViewContainerById(e)&&null!==(t=this.viewContainerActivities.get(e))&&void 0!==t?t:[]}showViewActivity(e,t){let i=this.viewActivities.get(e);i?i.id++:(i={id:1,activity:this.instantiationService.createInstance(ta,e)},this.viewActivities.set(e,i));let o=i.id;i.activity.setActivity(t);let s=i;return(0,Rt.zA)(()=>{s.id===o&&(s.activity.dispose(),this.viewActivities.delete(e))})}showAccountsActivity(e){return this.showActivity(Tt.S,e)}showGlobalActivity(e){return this.showActivity(Tt.C,e)}getActivity(e){var t;return null!==(t=this.globalActivities.get(e))&&void 0!==t?t:[]}showActivity(e,t){let i=this.globalActivities.get(e);return i||(i=[],this.globalActivities.set(e,i)),i.push(t),this._onDidChangeActivity.fire(e),(0,Rt.zA)(()=>{i.splice(i.indexOf(t),1),0===i.length&&this.globalActivities.delete(e),this._onDidChangeActivity.fire(e)})}};ia=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.dx),(0,Rt.Fb)(1,Rt.Ub)],ia),(0,Rt.tO)(),(0,Rt.GT)();var oa=class{static _readModifiers(e){e=e.toLowerCase().trim();let t,i=!1,o=!1,s=!1,r=!1;do{t=!1,/^ctrl(\+|\-)/.test(e)&&(i=!0,e=e.substr(5),t=!0),/^shift(\+|\-)/.test(e)&&(o=!0,e=e.substr(6),t=!0),/^alt(\+|\-)/.test(e)&&(s=!0,e=e.substr(4),t=!0),/^meta(\+|\-)/.test(e)&&(r=!0,e=e.substr(5),t=!0),/^win(\+|\-)/.test(e)&&(r=!0,e=e.substr(4),t=!0),/^cmd(\+|\-)/.test(e)&&(r=!0,e=e.substr(4),t=!0)}while(t);let n,a=e.indexOf(" ");return a>0?(n=e.substring(0,a),e=e.substring(a)):(n=e,e=""),{remains:e,ctrl:i,shift:o,alt:s,meta:r,key:n}}static parseChord(e){let t=this._readModifiers(e),i=t.key.match(/^\[([^\]]+)\]$/);if(i){let e=i[1],o=Rt.eO.lowerCaseToEnum(e);return[new Rt.WT(t.ctrl,t.shift,t.alt,t.meta,o),t.remains]}let o=Rt.XD.fromUserSettings(t.key);return[new Rt.HT(t.ctrl,t.shift,t.alt,t.meta,o),t.remains]}static parseKeybinding(e){if(!e)return null;let t,i=[];for(;e.length>0;)[t,e]=this.parseChord(e),i.push(t);return i.length>0?new Rt.UT(i):null}};(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.ok)(),(0,Rt.iT)(),(0,Qt.a)(),(0,Rt.IO)(),(0,Rt.db)(),(0,Rt.PA)(),(0,Rt.Db)(),(0,Rt.WM)(),(0,Ot.P)(),(0,Qt.n)(),(0,Rt.vb)(),(0,Rt.sm)(),(0,Rt.HD)(),(0,Rt.Ic)(),(0,Rt.Ad)();var sa,ra=[{key:"commandPalette",id:Rt.sb.CommandPalette,description:(0,Rt.Ij)(13585,"The Command Palette"),supportsSubmenus:!1},{key:"touchBar",id:Rt.sb.TouchBarContext,description:(0,Rt.Ij)(13586,"The touch bar (macOS only)"),supportsSubmenus:!1},{key:"editor/title",id:Rt.sb.EditorTitle,description:(0,Rt.Ij)(13587,"The editor title menu")},{key:"editor/title/run",id:Rt.sb.EditorTitleRun,description:(0,Rt.Ij)(13588,"Run submenu inside the editor title menu")},{key:"editor/context",id:Rt.sb.EditorContext,description:(0,Rt.Ij)(13589,"The editor context menu")},{key:"editor/context/copy",id:Rt.sb.EditorContextCopy,description:(0,Rt.Ij)(13590,"'Copy as' submenu in the editor context menu")},{key:"editor/context/share",id:Rt.sb.EditorContextShare,description:(0,Rt.Ij)(13591,"'Share' submenu in the editor context menu"),proposed:"contribShareMenu"},{key:"explorer/context",id:Rt.sb.ExplorerContext,description:(0,Rt.Ij)(13592,"The file explorer context menu")},{key:"explorer/context/share",id:Rt.sb.ExplorerContextShare,description:(0,Rt.Ij)(13593,"'Share' submenu in the file explorer context menu"),proposed:"contribShareMenu"},{key:"editor/title/context",id:Rt.sb.EditorTitleContext,description:(0,Rt.Ij)(13594,"The editor tabs context menu")},{key:"editor/title/context/share",id:Rt.sb.EditorTitleContextShare,description:(0,Rt.Ij)(13595,"'Share' submenu inside the editor title context menu"),proposed:"contribShareMenu"},{key:"debug/callstack/context",id:Rt.sb.DebugCallStackContext,description:(0,Rt.Ij)(13596,"The debug callstack view context menu")},{key:"debug/variables/context",id:Rt.sb.DebugVariablesContext,description:(0,Rt.Ij)(13597,"The debug variables view context menu")},{key:"debug/watch/context",id:Rt.sb.DebugWatchContext,description:(0,Rt.Ij)(13598,"The debug watch view context menu")},{key:"debug/toolBar",id:Rt.sb.DebugToolBar,description:(0,Rt.Ij)(13599,"The debug toolbar menu")},{key:"debug/createConfiguration",id:Rt.sb.DebugCreateConfiguration,proposed:"contribDebugCreateConfiguration",description:(0,Rt.Ij)(13600,"The debug create configuration menu")},{key:"notebook/variables/context",id:Rt.sb.NotebookVariablesContext,description:(0,Rt.Ij)(13601,"The notebook variables view context menu")},{key:"menuBar/home",id:Rt.sb.MenubarHomeMenu,description:(0,Rt.Ij)(13602,"The home indicator context menu (web only)"),proposed:"contribMenuBarHome",supportsSubmenus:!1},{key:"menuBar/edit/copy",id:Rt.sb.MenubarCopy,description:(0,Rt.Ij)(13603,"'Copy as' submenu in the top level Edit menu")},{key:"scm/title",id:Rt.sb.SCMTitle,description:(0,Rt.Ij)(13604,"The Source Control title menu")},{key:"scm/sourceControl",id:Rt.sb.SCMSourceControl,description:(0,Rt.Ij)(13605,"The Source Control menu")},{key:"scm/repositories/title",id:Rt.sb.SCMSourceControlTitle,description:(0,Rt.Ij)(13606,"The Source Control Repositories title menu"),proposed:"contribSourceControlTitleMenu"},{key:"scm/repository",id:Rt.sb.SCMSourceControlInline,description:(0,Rt.Ij)(13607,"The Source Control repository menu")},{key:"scm/resourceState/context",id:Rt.sb.SCMResourceContext,description:(0,Rt.Ij)(13608,"The Source Control resource state context menu")},{key:"scm/resourceFolder/context",id:Rt.sb.SCMResourceFolderContext,description:(0,Rt.Ij)(13609,"The Source Control resource folder context menu")},{key:"scm/resourceGroup/context",id:Rt.sb.SCMResourceGroupContext,description:(0,Rt.Ij)(13610,"The Source Control resource group context menu")},{key:"scm/change/title",id:Rt.sb.SCMChangeContext,description:(0,Rt.Ij)(13611,"The Source Control inline change menu")},{key:"scm/inputBox",id:Rt.sb.SCMInputBox,description:(0,Rt.Ij)(13612,"The Source Control input box menu"),proposed:"contribSourceControlInputBoxMenu"},{key:"scm/history/title",id:Rt.sb.SCMHistoryTitle,description:(0,Rt.Ij)(13613,"The Source Control History title menu"),proposed:"contribSourceControlHistoryTitleMenu"},{key:"scm/historyItem/context",id:Rt.sb.SCMHistoryItemContext,description:(0,Rt.Ij)(13614,"The Source Control history item context menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"scm/historyItemRef/context",id:Rt.sb.SCMHistoryItemRefContext,description:(0,Rt.Ij)(13615,"The Source Control history item reference context menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"scm/artifactGroup/context",id:Rt.sb.SCMArtifactGroupContext,description:(0,Rt.Ij)(13616,"The Source Control artifact group context menu"),proposed:"contribSourceControlArtifactGroupMenu"},{key:"scm/artifact/context",id:Rt.sb.SCMArtifactContext,description:(0,Rt.Ij)(13617,"The Source Control artifact context menu"),proposed:"contribSourceControlArtifactMenu"},{key:"statusBar/remoteIndicator",id:Rt.sb.StatusBarRemoteIndicatorMenu,description:(0,Rt.Ij)(13618,"The remote indicator menu in the status bar"),supportsSubmenus:!1},{key:"terminal/context",id:Rt.sb.TerminalInstanceContext,description:(0,Rt.Ij)(13619,"The terminal context menu")},{key:"terminal/title/context",id:Rt.sb.TerminalTabContext,description:(0,Rt.Ij)(13620,"The terminal tabs context menu")},{key:"view/title",id:Rt.sb.ViewTitle,description:(0,Rt.Ij)(13621,"The contributed view title menu")},{key:"viewContainer/title",id:Rt.sb.ViewContainerTitle,description:(0,Rt.Ij)(13622,"The contributed view container title menu"),proposed:"contribViewContainerTitle"},{key:"view/item/context",id:Rt.sb.ViewItemContext,description:(0,Rt.Ij)(13623,"The contributed view item context menu")},{key:"comments/comment/editorActions",id:Rt.sb.CommentEditorActions,description:(0,Rt.Ij)(13624,"The contributed comment editor actions"),proposed:"contribCommentEditorActionsMenu"},{key:"comments/commentThread/title",id:Rt.sb.CommentThreadTitle,description:(0,Rt.Ij)(13625,"The contributed comment thread title menu")},{key:"comments/commentThread/context",id:Rt.sb.CommentThreadActions,description:(0,Rt.Ij)(13626,"The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/additionalActions",id:Rt.sb.CommentThreadAdditionalActions,description:(0,Rt.Ij)(13626,"The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!0,proposed:"contribCommentThreadAdditionalMenu"},{key:"comments/commentThread/title/context",id:Rt.sb.CommentThreadTitleContext,description:(0,Rt.Ij)(13627,"The contributed comment thread title's peek context menu, rendered as a right click menu on the comment thread's peek title."),proposed:"contribCommentPeekContext"},{key:"comments/comment/title",id:Rt.sb.CommentTitle,description:(0,Rt.Ij)(13628,"The contributed comment title menu")},{key:"comments/comment/context",id:Rt.sb.CommentActions,description:(0,Rt.Ij)(13629,"The contributed comment context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/comment/context",id:Rt.sb.CommentThreadCommentContext,description:(0,Rt.Ij)(13630,"The contributed comment context menu, rendered as a right click menu on the an individual comment in the comment thread's peek view."),proposed:"contribCommentPeekContext"},{key:"commentsView/commentThread/context",id:Rt.sb.CommentsViewThreadActions,description:(0,Rt.Ij)(13631,"The contributed comment thread context menu in the comments view"),proposed:"contribCommentsViewThreadMenus"},{key:"notebook/toolbar",id:Rt.sb.NotebookToolbar,description:(0,Rt.Ij)(13632,"The contributed notebook toolbar menu")},{key:"notebook/kernelSource",id:Rt.sb.NotebookKernelSource,description:(0,Rt.Ij)(13633,"The contributed notebook kernel sources menu"),proposed:"notebookKernelSource"},{key:"notebook/cell/title",id:Rt.sb.NotebookCellTitle,description:(0,Rt.Ij)(13634,"The contributed notebook cell title menu")},{key:"notebook/cell/execute",id:Rt.sb.NotebookCellExecute,description:(0,Rt.Ij)(13635,"The contributed notebook cell execution menu")},{key:"interactive/toolbar",id:Rt.sb.InteractiveToolbar,description:(0,Rt.Ij)(13636,"The contributed interactive toolbar menu")},{key:"interactive/cell/title",id:Rt.sb.InteractiveCellTitle,description:(0,Rt.Ij)(13637,"The contributed interactive cell title menu")},{key:"issue/reporter",id:Rt.sb.IssueReporter,description:(0,Rt.Ij)(13638,"The contributed issue reporter menu")},{key:"testing/item/context",id:Rt.sb.TestItem,description:(0,Rt.Ij)(13639,"The contributed test item menu")},{key:"testing/item/gutter",id:Rt.sb.TestItemGutter,description:(0,Rt.Ij)(13640,"The menu for a gutter decoration for a test item")},{key:"testing/profiles/context",id:Rt.sb.TestProfilesContext,description:(0,Rt.Ij)(13641,"The menu for configuring testing profiles.")},{key:"testing/item/result",id:Rt.sb.TestPeekElement,description:(0,Rt.Ij)(13642,"The menu for an item in the Test Results view or peek.")},{key:"testing/message/context",id:Rt.sb.TestMessageContext,description:(0,Rt.Ij)(13643,"A prominent button overlaying editor content where the message is displayed")},{key:"testing/message/content",id:Rt.sb.TestMessageContent,description:(0,Rt.Ij)(13644,"Context menu for the message in the results tree")},{key:"extension/context",id:Rt.sb.ExtensionContext,description:(0,Rt.Ij)(13645,"The extension context menu")},{key:"timeline/title",id:Rt.sb.TimelineTitle,description:(0,Rt.Ij)(13646,"The Timeline view title menu")},{key:"timeline/item/context",id:Rt.sb.TimelineItemContext,description:(0,Rt.Ij)(13647,"The Timeline view item context menu")},{key:"ports/item/context",id:Rt.sb.TunnelContext,description:(0,Rt.Ij)(13648,"The Ports view item context menu")},{key:"ports/item/origin/inline",id:Rt.sb.TunnelOriginInline,description:(0,Rt.Ij)(13649,"The Ports view item origin inline menu")},{key:"ports/item/port/inline",id:Rt.sb.TunnelPortInline,description:(0,Rt.Ij)(13650,"The Ports view item port inline menu")},{key:"file/newFile",id:Rt.sb.NewFile,description:(0,Rt.Ij)(13651,"The 'New File...' quick pick, shown on welcome page and File menu."),supportsSubmenus:!1},{key:"webview/context",id:Rt.sb.WebviewContext,description:(0,Rt.Ij)(13652,"The webview context menu")},{key:"file/share",id:Rt.sb.MenubarShare,description:(0,Rt.Ij)(13653,"Share submenu shown in the top level File menu."),proposed:"contribShareMenu"},{key:"editor/inlineCompletions/actions",id:Rt.sb.InlineCompletionsActions,description:(0,Rt.Ij)(13654,"The actions shown when hovering on an inline completion"),supportsSubmenus:!1,proposed:"inlineCompletionsAdditions"},{key:"editor/content",id:Rt.sb.EditorContent,description:(0,Rt.Ij)(13655,"The prominent button in an editor, overlays its content"),proposed:"contribEditorContentMenu"},{key:"editor/lineNumber/context",id:Rt.sb.EditorLineNumberContext,description:(0,Rt.Ij)(13656,"The contributed editor line number context menu")},{key:"mergeEditor/result/title",id:Rt.sb.MergeInputResultToolbar,description:(0,Rt.Ij)(13657,"The result toolbar of the merge editor"),proposed:"contribMergeEditorMenus"},{key:"multiDiffEditor/content",id:Rt.sb.MultiDiffEditorContent,description:(0,Rt.Ij)(13658,"A prominent button overlaying the multi diff editor"),proposed:"contribEditorContentMenu"},{key:"multiDiffEditor/resource/title",id:Rt.sb.MultiDiffEditorFileToolbar,description:(0,Rt.Ij)(13659,"The resource toolbar in the multi diff editor"),proposed:"contribMultiDiffEditorMenus"},{key:"diffEditor/gutter/hunk",id:Rt.sb.DiffEditorHunkToolbar,description:(0,Rt.Ij)(13660,"The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"},{key:"diffEditor/gutter/selection",id:Rt.sb.DiffEditorSelectionToolbar,description:(0,Rt.Ij)(13660,"The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"},{key:"searchPanel/aiResults/commands",id:Rt.sb.SearchActionMenu,description:(0,Rt.Ij)(13661,"The commands that will contribute to the menu rendered as buttons next to the AI search title")},{key:"editor/context/chat",id:Rt.sb.ChatTextEditorMenu,description:(0,Rt.Ij)(13662,"The Chat submenu in the text editor context menu."),supportsSubmenus:!1,proposed:"chatParticipantPrivate"},{key:"chat/input/editing/sessionToolbar",id:Rt.sb.ChatEditingSessionChangesToolbar,description:(0,Rt.Ij)(13663,"The Chat Editing widget toolbar menu for session changes."),proposed:"chatSessionsProvider"},{key:"chat/chatSessions",id:Rt.sb.AgentSessionsContext,description:(0,Rt.Ij)(13664,"The Chat Sessions menu."),supportsSubmenus:!1,proposed:"chatSessionsProvider"},{key:"chatSessions/newSession",id:Rt.sb.AgentSessionsCreateSubMenu,description:(0,Rt.Ij)(13665,"Menu for new chat sessions."),supportsSubmenus:!1,proposed:"chatSessionsProvider"},{key:"chat/multiDiff/context",id:Rt.sb.ChatMultiDiffContext,description:(0,Rt.Ij)(13666,"The Chat Multi-Diff context menu."),supportsSubmenus:!1,proposed:"chatSessionsProvider"}];!function(e){function t(e){return"string"==typeof e.command}function i(e,t){return"string"==typeof e.command?e.alt&&"string"!=typeof e.alt?(t.error((0,Rt.Ij)(13668,"property `{0}` can be omitted or must be of type `string`","alt")),!1):e.when&&"string"!=typeof e.when?(t.error((0,Rt.Ij)(13668,"property `{0}` can be omitted or must be of type `string`","when")),!1):!e.group||"string"==typeof e.group||(t.error((0,Rt.Ij)(13668,"property `{0}` can be omitted or must be of type `string`","group")),!1):(t.error((0,Rt.Ij)(13667,"property `{0}` is mandatory and must be of type `string`","command")),!1)}function o(e,t){return"string"==typeof e.submenu?e.when&&"string"!=typeof e.when?(t.error((0,Rt.Ij)(13668,"property `{0}` can be omitted or must be of type `string`","when")),!1):!e.group||"string"==typeof e.group||(t.error((0,Rt.Ij)(13668,"property `{0}` can be omitted or must be of type `string`","group")),!1):(t.error((0,Rt.Ij)(13667,"property `{0}` is mandatory and must be of type `string`","submenu")),!1)}e.isMenuItem=t,e.isValidMenuItem=i,e.isValidSubmenuItem=o,e.isValidItems=function(e,s){if(!Array.isArray(e))return s.error((0,Rt.Ij)(13669,"submenu items must be an array")),!1;for(let r of e)if(t(r)){if(!i(r,s))return!1}else if(!o(r,s))return!1;return!0},e.isValidSubmenu=function(e,t){return"object"==typeof e?"string"==typeof e.id?"string"==typeof e.label||(t.error((0,Rt.Ij)(13667,"property `{0}` is mandatory and must be of type `string`","label")),!1):(t.error((0,Rt.Ij)(13667,"property `{0}` is mandatory and must be of type `string`","id")),!1):(t.error((0,Rt.Ij)(13670,"submenu items must be an object")),!1)};let s={type:"object",required:["command"],properties:{command:{description:(0,Rt.Ij)(13671,"Identifier of the command to execute. The command must be declared in the 'commands'-section"),type:"string"},alt:{description:(0,Rt.Ij)(13672,"Identifier of an alternative command to execute. The command must be declared in the 'commands'-section"),type:"string"},when:{description:(0,Rt.Ij)(13673,"Condition which must be true to show this item"),type:"string"},group:{description:(0,Rt.Ij)(13674,"Group into which this item belongs"),type:"string"}}},r={type:"object",required:["submenu"],properties:{submenu:{description:(0,Rt.Ij)(13675,"Identifier of the submenu to display in this item."),type:"string"},when:{description:(0,Rt.Ij)(13673,"Condition which must be true to show this item"),type:"string"},group:{description:(0,Rt.Ij)(13674,"Group into which this item belongs"),type:"string"}}},n={type:"object",required:["id","label"],properties:{id:{description:(0,Rt.Ij)(13676,"Identifier of the menu to display as a submenu."),type:"string"},label:{description:(0,Rt.Ij)(13677,"The label of the menu item which leads to this submenu."),type:"string"},icon:{description:(0,Rt.Ij)(13678,'(Optional) Icon which is used to represent the submenu in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like "\\$(zap)"'),anyOf:[{type:"string"},{type:"object",properties:{light:{description:(0,Rt.Ij)(13679,"Icon path when a light theme is used"),type:"string"},dark:{description:(0,Rt.Ij)(13680,"Icon path when a dark theme is used"),type:"string"}}}]}}};function a(e,t,i){return void 0===e?(t.error((0,Rt.Ij)(13686,"property `{0}` is mandatory and must be of type `string` or `object`",i)),!1):"string"==typeof e&&(0,Rt.lk)(e)?(t.error((0,Rt.Ij)(13667,"property `{0}` is mandatory and must be of type `string`",i)),!1):"string"==typeof e||!(0,Rt.lk)(e.original)&&!(0,Rt.lk)(e.value)||(t.error((0,Rt.Ij)(13687,"properties `{0}` and `{1}` are mandatory and must be of type `string`","".concat(i,".value"),"".concat(i,".original"))),!1)}e.menusContribution={description:(0,Rt.Ij)(13681,"Contributes menu items to the editor"),type:"object",properties:(0,Rt.UM)(ra,e=>e.key,e=>({markdownDescription:e.proposed?(0,Rt.Ij)(13682,'Proposed API, requires `enabledApiProposal: ["{0}"]` - {1}',e.proposed,e.description):e.description,type:"array",items:!1===e.supportsSubmenus?s:{oneOf:[s,r]}})),additionalProperties:{description:"Submenu",type:"array",items:{oneOf:[s,r]}}},e.submenusContribution={description:(0,Rt.Ij)(13683,"Contributes submenu items to the editor"),type:"array",items:n},e.isValidCommand=function(e,t){return e?(0,Rt.lk)(e.command)?(t.error((0,Rt.Ij)(13667,"property `{0}` is mandatory and must be of type `string`","command")),!1):!(!a(e.title,t,"title")||e.shortTitle&&!a(e.shortTitle,t,"shortTitle"))&&(e.enablement&&"string"!=typeof e.enablement?(t.error((0,Rt.Ij)(13668,"property `{0}` can be omitted or must be of type `string`","precondition")),!1):!(e.category&&!a(e.category,t,"category")||!function(e,t){return void 0===e||"string"==typeof e||"string"==typeof e.dark&&"string"==typeof e.light||(t.error((0,Rt.Ij)(13685,"property `icon` can be omitted or must be either a string or a literal like `{dark, light}`")),!1)}(e.icon,t))):(t.error((0,Rt.Ij)(13684,"expected non-empty value.")),!1)};let d={type:"object",required:["command","title"],properties:{command:{description:(0,Rt.Ij)(13688,"Identifier of the command to execute"),type:"string"},title:{description:(0,Rt.Ij)(13689,"Title by which the command is represented in the UI"),type:"string"},shortTitle:{markdownDescription:(0,Rt.Ij)(13690,"(Optional) Short title by which the command is represented in the UI. Menus pick either `title` or `shortTitle` depending on the context in which they show commands."),type:"string"},category:{description:(0,Rt.Ij)(13691,"(Optional) Category string by which the command is grouped in the UI"),type:"string"},enablement:{description:(0,Rt.Ij)(13692,"(Optional) Condition which must be true to enable the command in the UI (menu and keybindings). Does not prevent executing the command by other means, like the `executeCommand`-api."),type:"string"},icon:{description:(0,Rt.Ij)(13693,'(Optional) Icon which is used to represent the command in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like "\\$(zap)"'),anyOf:[{type:"string"},{type:"object",properties:{light:{description:(0,Rt.Ij)(13694,"Icon path when a light theme is used"),type:"string"},dark:{description:(0,Rt.Ij)(13695,"Icon path when a dark theme is used"),type:"string"}}}]}}};e.commandsContribution={description:(0,Rt.Ij)(13696,"Contributes commands to the command palette."),oneOf:[d,{type:"array",items:d}]}}(sa||(sa={}));var na=new Rt.EA,aa=Qt.i.registerExtensionPoint({extensionPoint:"commands",jsonSchema:sa.commandsContribution,activationEventsGenerator:function*(e){for(let t of e)t.command&&(yield"onCommand:".concat(t.command))}});aa.setHandler(e=>{function t(e,t){var i,o;if(!sa.isValidCommand(e,t.collector))return;let s,{icon:r,enablement:n,category:a,title:d,shortTitle:l,command:c}=e;r&&(s="string"==typeof r?null!==(i=Rt.Eb.fromString(r))&&void 0!==i?i:{dark:(0,Rt.lT)(t.description.extensionLocation,r),light:(0,Rt.lT)(t.description.extensionLocation,r)}:{dark:(0,Rt.lT)(t.description.extensionLocation,r.dark),light:(0,Rt.lT)(t.description.extensionLocation,r.light)});let h=Rt.lb.getCommand(c);h&&(h.source?t.collector.info((0,Rt.Ij)(13697,"Command `{0}` already registered by {1} ({2})",e.command,h.source.title,h.source.id)):t.collector.info((0,Rt.Ij)(13698,"Command `{0}` already registered",e.command))),na.add(Rt.lb.addCommand({id:c,title:d,source:{id:t.description.identifier.value,title:null!==(o=t.description.displayName)&&void 0!==o?o:t.description.name},shortTitle:l,tooltip:d,category:a,precondition:Rt.PO.deserialize(n),icon:s}))}na.clear();for(let i of e){let{value:e}=i;if(Array.isArray(e))for(let o of e)t(o,i);else t(e,i)}});var da=new Map,la=Qt.i.registerExtensionPoint({extensionPoint:"submenus",jsonSchema:sa.submenusContribution});la.setHandler(e=>{da.clear();for(let t of e){let{value:e,collector:i}=t;for(let[,o]of Object.entries(e)){if(!sa.isValidSubmenu(o,i))continue;if(!o.id){i.warn((0,Rt.Ij)(13699,"`{0}` is not a valid submenu identifier",o.id));continue}if(da.has(o.id)){i.info((0,Rt.Ij)(13700,"The `{0}` submenu was already previously registered.",o.id));continue}if(!o.label){i.warn((0,Rt.Ij)(13701,"`{0}` is not a valid submenu label",o.label));continue}let e;o.icon&&(e="string"==typeof o.icon?Rt.Eb.fromString(o.icon)||{dark:(0,Rt.lT)(t.description.extensionLocation,o.icon)}:{dark:(0,Rt.lT)(t.description.extensionLocation,o.icon.dark),light:(0,Rt.lT)(t.description.extensionLocation,o.icon.light)});let s={id:Rt.sb.for("api:".concat(o.id)),label:o.label,icon:e};da.set(o.id,s)}}});var ca=new Map(ra.map(e=>[e.key,e])),ha=new Rt.EA,ua=new Map;Qt.i.registerExtensionPoint({extensionPoint:"menus",jsonSchema:sa.menusContribution,deps:[la]}).setHandler(e=>{ha.clear(),ua.clear();for(let i of e){let{value:e,collector:o}=i;for(let s of Object.entries(e)){if(!sa.isValidItems(s[1],o))continue;let e=ca.get(s[0]);if(!e){let t=da.get(s[0]);t&&(e={key:s[0],id:t.id,description:""})}if(e){if(e.proposed&&!(0,Ot.F)(i.description,e.proposed)){o.error((0,Rt.Ij)(13702,"{0} is a proposed menu identifier. It requires 'package.json#enabledApiProposals: [\"{1}\"]' and is only available when running out of dev or with the following command line switch: --enable-proposed-api {2}",s[0],e.proposed,i.description.identifier.value));continue}for(let i of s[1]){var t;let r;if(sa.isMenuItem(i)){let e=Rt.lb.getCommand(i.command),t=i.alt&&Rt.lb.getCommand(i.alt)||void 0;if(!e){o.error((0,Rt.Ij)(13703,"Menu item references a command `{0}` which is not defined in the 'commands' section.",i.command));continue}i.alt&&!t&&o.warn((0,Rt.Ij)(13704,"Menu item references an alt-command `{0}` which is not defined in the 'commands' section.",i.alt)),i.command===i.alt&&o.info((0,Rt.Ij)(13705,"Menu item references the same command as default and alt-command")),r={command:e,alt:t,group:void 0,order:void 0,when:void 0}}else{if(!1===e.supportsSubmenus){o.error((0,Rt.Ij)(13706,"Menu item references a submenu for a menu which doesn't have submenu support."));continue}let t=da.get(i.submenu);if(!t){o.error((0,Rt.Ij)(13707,"Menu item references a submenu `{0}` which is not defined in the 'submenus' section.",i.submenu));continue}let n=ua.get(e.id.id);if(n||(n=new Set,ua.set(e.id.id,n)),n.has(t.id.id)){o.warn((0,Rt.Ij)(13708,"The `{0}` submenu was already contributed to the `{1}` menu.",i.submenu,s[0]));continue}n.add(t.id.id),r={submenu:t.id,icon:t.icon,title:t.label,group:void 0,order:void 0,when:void 0}}if(i.group){let e=i.group.lastIndexOf("@");e>0?(r.group=i.group.substr(0,e),r.order=Number(i.group.substr(e+1))||void 0):r.group=i.group}e.id!==Rt.sb.ViewContainerTitle||null!==(t=i.when)&&void 0!==t&&t.includes("viewContainer == workbench.view.debug")?(r.when=Rt.PO.deserialize(i.when),ha.add(Rt.lb.appendMenuItem(e.id,r))):o.error((0,Rt.Ij)(13709,"The {0} menu contribution must check {1} in its {2} clause.","`viewContainer/title`","`viewContainer == workbench.view.debug`",'"when"'))}}}}});var ga=class extends Rt.CA{constructor(e){super(),this._keybindingService=e,this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.commands)}render(e){var t,i,o;let s=((null===(t=e.contributes)||void 0===t?void 0:t.commands)||[]).map(e=>({id:e.command,title:e.title,keybindings:[],menus:[]})),r=(0,Rt.UM)(s,e=>e.id),n=(null===(i=e.contributes)||void 0===i?void 0:i.menus)||{},a=(0,Rt.UM)(s,e=>e.id);if(n.commandPalette)for(let d of n.commandPalette)delete a[d.command];if(Object.keys(a).length)for(let d in n.commandPalette||(n.commandPalette=[]),a)n.commandPalette.push({command:d});for(let d in n)for(let e of n[d])if("false"!==e.when&&e.command){let t=r[e.command];t?t.menus.includes(d)||t.menus.push(d):(t={id:e.command,title:"",keybindings:[],menus:[d]},r[t.id]=t,s.push(t))}return(null!==(o=e.contributes)&&void 0!==o&&o.keybindings?Array.isArray(e.contributes.keybindings)?e.contributes.keybindings:[e.contributes.keybindings]:[]).forEach(e=>{let t=this.resolveKeybinding(e);if(!t)return;let i=r[e.command];i?i.keybindings.push(t):(i={id:e.command,title:"",keybindings:[t],menus:[]},r[i.id]=i,s.push(i))}),s.length?{data:{headers:[(0,Rt.Ij)(13710,"ID"),(0,Rt.Ij)(13711,"Title"),(0,Rt.Ij)(13712,"Keyboard Shortcuts"),(0,Rt.Ij)(13713,"Menu Contexts")],rows:s.sort((e,t)=>e.id.localeCompare(t.id)).map(e=>[(new Rt.Pc).appendMarkdown("`".concat(e.id,"`")),"string"==typeof e.title?e.title:e.title.value,e.keybindings,(new Rt.Pc).appendMarkdown("".concat(e.menus.sort((e,t)=>e.localeCompare(t)).map(e=>"`".concat(e,"`")).join("&nbsp;")))])},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}resolveKeybinding(e){let t;switch(Rt.UD){case"win32":t=e.win;break;case"linux":t=e.linux;break;case"darwin":t=e.mac}return this._keybindingService.resolveUserBinding(null!==t&&void 0!==t?t:e.key)[0]}};ga=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.kd)],ga),Rt._b.as(Qt.t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"commands",label:(0,Rt.Ij)(13714,"Commands"),access:{canToggle:!1},renderer:new Rt.om(ga)}),(0,Rt.IO)();var pa=class{static writeKeybindingItem(e,t){if(!t.resolvedKeybinding)return;let i=JSON.stringify(t.resolvedKeybinding.getUserSettingsLabel());e.write('{ "key": '.concat(function(e,t){return e.length<t?e+Array(t-e.length).join(" "):e}(i+",",25),' "command": '));let o=t.when?JSON.stringify(t.when.serialize()):"",s=JSON.stringify(t.command);o.length>0?(e.write("".concat(s,",")),e.writeLine(),e.write('                                     "when": '.concat(o))):e.write("".concat(s)),t.commandArgs&&(e.write(","),e.writeLine(),e.write('                                     "args": '.concat(JSON.stringify(t.commandArgs)))),e.write(" }")}static readUserKeybindingItem(e){let t="key"in e&&"string"==typeof e.key?oa.parseKeybinding(e.key):null,i="when"in e&&"string"==typeof e.when?Rt.PO.deserialize(e.when):void 0;return{keybinding:t,command:"command"in e&&"string"==typeof e.command?e.command:null,commandArgs:"args"in e&&void 0!==e.args?e.args:void 0,when:i,_sourceKey:"key"in e&&"string"==typeof e.key?e.key:void 0}}};var ba,ma=class{constructor(){this._lines=[],this._currentLine=""}write(e){this._currentLine+=e}writeLine(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this._lines.push(this._currentLine+e),this._currentLine=""}toString(){return this.writeLine(),this._lines.join("\n")}};(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.eE)(),(0,Rt.JT)(),(0,Rt.qx)(),(0,Rt.zT)(),(0,Rt.gE)(),(0,Rt.Iw)(),(0,Rt.gA)(),(0,Rt.Co)(),(0,Rt.io)(),(0,Rt.GT)(),(0,Rt.tO)(),(0,Rt.PA)(),(0,Rt.qj)(),(0,Rt.mj)(),(0,Rt.iT)(),(0,Rt.Ni)(),(0,Rt.db)(),(0,Rt.Sb)(),(0,Rt.wb)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.im)(),(0,Rt.Y_)(),(0,Rt.lo)(),(0,Rt.Kb)(),(0,Rt.kc)(),(0,Rt.gb)(),(0,Rt.oo)(),(0,Tt.Zn)(),(0,Rt.nb)(),(0,Rt.Rd)(),(0,Rt.vb)(),(0,Rt.ab)(),(0,Rt.Qo)(),(0,Rt.WM)(),(0,Nt.Ot)(),(0,Qt.a)(),(0,Lt.F)(),(0,Wt.A_)(),(0,Tt.Ft)();var va={type:"object",default:{command:"",key:""},required:["command","key"],properties:{command:{description:(0,Rt.Ij)(14118,"Identifier of the command to run when keybinding is triggered."),type:"string"},args:{description:(0,Rt.Ij)(14119,"Arguments to pass to the command to execute.")},key:{description:(0,Rt.Ij)(14120,"Key or key sequence (separate keys with plus-sign and sequences with space, e.g. Ctrl+O and Ctrl+L L for a chord)."),type:"string"},mac:{description:(0,Rt.Ij)(14121,"Mac specific key or key sequence."),type:"string"},linux:{description:(0,Rt.Ij)(14122,"Linux specific key or key sequence."),type:"string"},win:{description:(0,Rt.Ij)(14123,"Windows specific key or key sequence."),type:"string"},when:{description:(0,Rt.Ij)(14124,"Condition when the key is active."),type:"string"}}},Ca=Qt.i.registerExtensionPoint({extensionPoint:"keybindings",deps:[aa],jsonSchema:{description:(0,Rt.Ij)(14125,"Contributes keybindings."),oneOf:[va,{type:"array",items:va}]}}),wa=[Rt.$D.NumpadDivide,Rt.$D.NumpadMultiply,Rt.$D.NumpadSubtract,Rt.$D.NumpadAdd,Rt.$D.Numpad1,Rt.$D.Numpad2,Rt.$D.Numpad3,Rt.$D.Numpad4,Rt.$D.Numpad5,Rt.$D.Numpad6,Rt.$D.Numpad7,Rt.$D.Numpad8,Rt.$D.Numpad9,Rt.$D.Numpad0,Rt.$D.NumpadDecimal],ya=new Map;ya.set(Rt.$D.Numpad1,Rt.YD.Digit1),ya.set(Rt.$D.Numpad2,Rt.YD.Digit2),ya.set(Rt.$D.Numpad3,Rt.YD.Digit3),ya.set(Rt.$D.Numpad4,Rt.YD.Digit4),ya.set(Rt.$D.Numpad5,Rt.YD.Digit5),ya.set(Rt.$D.Numpad6,Rt.YD.Digit6),ya.set(Rt.$D.Numpad7,Rt.YD.Digit7),ya.set(Rt.$D.Numpad8,Rt.YD.Digit8),ya.set(Rt.$D.Numpad9,Rt.YD.Digit9),ya.set(Rt.$D.Numpad0,Rt.YD.Digit0);var fa=ba=class extends Rt.co{constructor(e,t,i,o,s,r,n,a,d,l,c){super(e,t,i,o,l),this.hostService=r,this.keyboardLayoutService=c,this._contributions=[],this.isComposingGlobalContextKey=e.createKey("isComposing",!1),this.kbsJsonSchema=new Ia,this.updateKeybindingsJsonSchema(),this._keyboardMapper=this.keyboardLayoutService.getKeyboardMapper(),this._register(this.keyboardLayoutService.onDidChangeKeyboardLayout(()=>{this._keyboardMapper=this.keyboardLayoutService.getKeyboardMapper(),this.updateResolver()})),this._keybindingHoldMode=null,this._cachedResolver=null,this.userKeybindings=this._register(new Sa(s,d,a,l)),this.userKeybindings.initialize().then(()=>{this.userKeybindings.keybindings.length&&this.updateResolver()}),this._register(this.userKeybindings.onDidChange(()=>{l.debug("User keybindings changed"),this.updateResolver()})),Ca.setHandler(e=>{let t=[];for(let i of e)this._handleKeybindingsExtensionPointUser(i.description.identifier,i.description.isBuiltin,i.value,i.collector,t);Rt.hb.setExtensionKeybindings(t),this.updateResolver()}),this.updateKeybindingsJsonSchema(),this._register(n.onDidRegisterExtensions(()=>this.updateKeybindingsJsonSchema())),this._register(Rt.dA.runAndSubscribe(Rt.pS,e=>{let{window:t,disposables:i}=e;return i.add(this._registerKeyListeners(t))},{window:Rt.vE,disposables:this._store})),this._register((0,Rt.uE)(e=>{e===Rt.vE.vscodeWindowId&&Rt.KT.keyboard!==Rt.qT.None&&(this.lockKeyCodes((0,Rt.iE)(Rt.vE)?["Escape"]:[]),this._cachedResolver=null,this._onDidUpdateKeybindings.fire())}))}lockKeyCodes(e){let t=Rt.vE.navigator.keyboard;e.length>0?null===t||void 0===t||t.lock(e):null===t||void 0===t||t.unlock()}dispose(){this._contributions.forEach(e=>{var t;return null===(t=e.listener)||void 0===t?void 0:t.dispose()}),this._contributions.length=0,super.dispose()}_registerKeyListeners(e){let t=new Rt.EA;return t.add((0,Rt.ox)(e,Rt.tx.KEY_DOWN,e=>{if(this._keybindingHoldMode)return;this.isComposingGlobalContextKey.set(e.isComposing);let t=new Rt.RT(e);this._log("/ Received  keydown event - ".concat((0,Rt.BT)(e))),this._log("| Converted keydown event - ".concat((0,Rt.VT)(t))),this._dispatch(t,t.target)&&t.preventDefault(),this.isComposingGlobalContextKey.set(!1)})),t.add((0,Rt.ox)(e,Rt.tx.KEY_UP,e=>{this._resetKeybindingHoldMode(),this.isComposingGlobalContextKey.set(e.isComposing);let t=new Rt.RT(e);this._singleModifierDispatch(t,t.target)&&t.preventDefault(),this.isComposingGlobalContextKey.set(!1)})),t}registerSchemaContribution(e){var t;let i=null===(t=e.onDidChange)||void 0===t?void 0:t.call(e,()=>this.updateKeybindingsJsonSchema()),o={listener:i,contribution:e};return this._contributions.push(o),this.updateKeybindingsJsonSchema(),(0,Rt.zA)(()=>{null!==i&&void 0!==i&&i.dispose(),(0,Rt.nN)(this._contributions,o),this.updateKeybindingsJsonSchema()})}updateKeybindingsJsonSchema(){this.kbsJsonSchema.updateSchema(this._contributions.flatMap(e=>e.contribution.getSchemaAdditions()))}_printKeybinding(e){return Rt.ro.toLabel(Rt.uj,e.chords,e=>e instanceof Rt.HT?Rt.XD.toString(e.keyCode):Rt.eO.toString(e.scanCode))||"[null]"}_printResolvedKeybinding(e){return e.getDispatchChords().map(e=>e||"[null]").join(" ")}_printResolvedKeybindings(e,t,i){let o="".concat(t.padStart(35," ")," => ");if(0!==i.length)for(let s of i)e.push("".concat(o).concat(this._printResolvedKeybinding(s).padStart(35," ")));else e.push("".concat(o).concat("[NO BINDING]".padStart(35," ")))}_dumpResolveKeybindingDebugInfo(){let e=new Set,t=[];t.push("Default Resolved Keybindings (unique only):");for(let o of Rt.hb.getDefaultKeybindings()){if(!o.keybinding)continue;let i=this._printKeybinding(o.keybinding);if(e.has(i))continue;e.add(i);let s=this._keyboardMapper.resolveKeybinding(o.keybinding);this._printResolvedKeybindings(t,i,s)}t.push("User Resolved Keybindings (unique only):");for(let o of this.userKeybindings.keybindings){var i;if(!o.keybinding)continue;let s=null!==(i=o._sourceKey)&&void 0!==i?i:"Impossible: missing source key, but has keybinding";if(e.has(s))continue;e.add(s);let r=this._keyboardMapper.resolveKeybinding(o.keybinding);this._printResolvedKeybindings(t,s,r)}return t.join("\n")}_dumpDebugInfo(){let e=JSON.stringify(this.keyboardLayoutService.getCurrentKeyboardLayout(),null,"\t"),t=this._keyboardMapper.dumpDebugInfo();return"Layout info:\n".concat(e,"\n\n").concat(this._dumpResolveKeybindingDebugInfo(),"\n\n").concat(t,"\n\nRaw mapping:\n").concat(JSON.stringify(this.keyboardLayoutService.getRawKeyboardMapping(),null,"\t"))}_dumpDebugInfoJSON(){let e={layout:this.keyboardLayoutService.getCurrentKeyboardLayout(),rawMapping:this.keyboardLayoutService.getRawKeyboardMapping()};return JSON.stringify(e,null,"\t")}enableKeybindingHoldMode(e){if(this._currentlyDispatchingCommandId!==e)return;this._keybindingHoldMode=new Rt.pw;let t=(0,Rt.AS)((0,Rt.Bx)(void 0)),i=t.onDidBlur(()=>this._resetKeybindingHoldMode());return this._keybindingHoldMode.p.finally(()=>{i.dispose(),t.dispose()}),this._log("+ Enabled hold-mode for ".concat(e,".")),this._keybindingHoldMode.p}_resetKeybindingHoldMode(){var e;this._keybindingHoldMode&&(this._keybindingHoldMode=(null!==(e=this._keybindingHoldMode)&&void 0!==e&&e.complete(),null))}customKeybindingsCount(){return this.userKeybindings.keybindings.length}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}getUserKeybindingItems(){return this._resolveUserKeybindingItems(this.userKeybindings.keybindings,!1)}_getResolver(){return this._cachedResolver||(this._cachedResolver=new Rt.Dc(this._resolveKeybindingItems(Rt.hb.getDefaultKeybindings(),!0),this.getUserKeybindingItems(),e=>this._log(e))),this._cachedResolver}_documentHasFocus(){return this.hostService.hasFocus}_resolveKeybindingItems(e,t){let i=[],o=0;for(let s of e){let e=s.when||void 0,r=s.keybinding;if(r){if(this._assertBrowserConflicts(r))continue;let n=this._keyboardMapper.resolveKeybinding(r);for(let r=n.length-1;r>=0;r--){let a=n[r];i[o++]=new Rt.ao(a,s.command,s.commandArgs,e,t,s.extensionId,s.isBuiltinExtension)}}else i[o++]=new Rt.ao(void 0,s.command,s.commandArgs,e,t,s.extensionId,s.isBuiltinExtension)}return i}_resolveUserKeybindingItems(e,t){let i=[],o=0;for(let s of e){let e=s.when||void 0;if(s.keybinding){let r=this._keyboardMapper.resolveKeybinding(s.keybinding);for(let n of r)i[o++]=new Rt.ao(n,s.command,s.commandArgs,e,t,null,!1)}else i[o++]=new Rt.ao(void 0,s.command,s.commandArgs,e,t,null,!1)}return i}_assertBrowserConflicts(e){if(Rt.KT.keyboard===Rt.qT.Always||Rt.KT.keyboard===Rt.qT.FullScreen&&(0,Rt.iE)(Rt.vE))return!1;for(let t of e.chords){if(!t.metaKey&&!t.altKey&&!t.ctrlKey&&!t.shiftKey)continue;let e=Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.ZD.Shift,i=0;if(t.metaKey&&(i|=Rt.ZD.CtrlCmd),t.shiftKey&&(i|=Rt.ZD.Shift),t.altKey&&(i|=Rt.ZD.Alt),t.ctrlKey&&Rt.uj===Rt.dj.Macintosh&&(i|=Rt.ZD.WinCtrl),(i&e)===(Rt.ZD.CtrlCmd|Rt.ZD.Alt)&&(t instanceof Rt.WT&&(t.scanCode===Rt.$D.ArrowLeft||t.scanCode===Rt.$D.ArrowRight)||t instanceof Rt.HT&&(t.keyCode===Rt.YD.LeftArrow||t.keyCode===Rt.YD.RightArrow))||(i&e)===Rt.ZD.CtrlCmd&&(t instanceof Rt.WT&&t.scanCode>=Rt.$D.Digit1&&t.scanCode<=Rt.$D.Digit0||t instanceof Rt.HT&&t.keyCode>=Rt.YD.Digit0&&t.keyCode<=Rt.YD.Digit9))return!0}return!1}resolveKeybinding(e){return this._keyboardMapper.resolveKeybinding(e)}resolveKeyboardEvent(e){return this.keyboardLayoutService.validateCurrentKeyboardMapping(e),this._keyboardMapper.resolveKeyboardEvent(e)}resolveUserBinding(e){let t=oa.parseKeybinding(e);return t?this._keyboardMapper.resolveKeybinding(t):[]}_handleKeybindingsExtensionPointUser(e,t,i,o,s){if(Array.isArray(i))for(let r=0,n=i.length;r<n;r++)this._handleKeybinding(e,t,r+1,i[r],o,s);else this._handleKeybinding(e,t,1,i,o,s)}_handleKeybinding(e,t,i,o,s,r){let n=[];if(function(e,t){return e?"string"==typeof e.command?e.key&&"string"!=typeof e.key?(t.push((0,Rt.Ij)(14117,"property `{0}` can be omitted or must be of type `string`","key")),!1):e.when&&"string"!=typeof e.when?(t.push((0,Rt.Ij)(14117,"property `{0}` can be omitted or must be of type `string`","when")),!1):e.mac&&"string"!=typeof e.mac?(t.push((0,Rt.Ij)(14117,"property `{0}` can be omitted or must be of type `string`","mac")),!1):e.linux&&"string"!=typeof e.linux?(t.push((0,Rt.Ij)(14117,"property `{0}` can be omitted or must be of type `string`","linux")),!1):!e.win||"string"==typeof e.win||(t.push((0,Rt.Ij)(14117,"property `{0}` can be omitted or must be of type `string`","win")),!1):(t.push((0,Rt.Ij)(14116,"property `{0}` is mandatory and must be of type `string`","command")),!1):(t.push((0,Rt.Ij)(14115,"expected non-empty value.")),!1)}(o,n)){let s=this._asCommandRule(e,t,i++,o);s&&r.push(s)}n.length>0&&s.error((0,Rt.Ij)(14126,"Invalid `contributes.{0}`: {1}",Ca.name,n.join("\n")))}static bindToCurrentPlatform(e,t,i,o){if(Rt.uj===Rt.dj.Windows&&o){if(o)return o}else if(Rt.uj===Rt.dj.Macintosh){if(t)return t}else if(i)return i;return e}_asCommandRule(e,t,i,o){let s,{command:r,args:n,when:a,key:d,mac:l,linux:c,win:h}=o,u=ba.bindToCurrentPlatform(d,l,c,h);if(!u)return;s=t?Rt.mb.BuiltinExtension+i:Rt.mb.ExternalExtension+i;let g,p=Rt.lb.getCommand(r),b=p&&p.precondition;return a&&b?g=Rt.PO.and(b,Rt.PO.deserialize(a)):a?g=Rt.PO.deserialize(a):b&&(g=b),{id:r,args:n,when:g,weight:s,keybinding:oa.parseKeybinding(u),extensionId:e.value,isBuiltinExtension:t}}getDefaultKeybindingsContent(){let e=this._getResolver(),t=e.getDefaultKeybindings(),i=e.getDefaultBoundCommands();return ba._getDefaultKeybindings(t)+"\n\n"+ba._getAllCommandsAsComment(i)}static _getDefaultKeybindings(e){let t=new ma;t.writeLine("[");let i=e.length-1;return e.forEach((e,o)=>{pa.writeKeybindingItem(t,e),o===i?t.writeLine():t.writeLine(",")}),t.writeLine("]"),t.toString()}static _getAllCommandsAsComment(e){let t=(0,Tt.Pt)(e).sort().join("\n// - ");return"// "+(0,Rt.Ij)(14127,"Here are other available commands: ")+"\n// - "+t}mightProducePrintableCharacter(e){if(e.ctrlKey||e.metaKey||e.altKey)return!1;let t=Rt.eO.toEnum(e.code);if(-1!==wa.indexOf(t))return!!(e.keyCode===Rt.KD[t]||Rt.Cj&&e.keyCode===ya.get(t));if(-1!==Rt.KD[t])return!1;let i=this.keyboardLayoutService.getRawKeyboardMapping();if(!i)return!1;let o=i[e.code];return!(!o||!o.value||/\s/.test(o.value))}};fa=ba=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.yb),(0,Rt.Fb)(1,Rt.Cb),(0,Rt.Fb)(2,Rt.ib),(0,Rt.Fb)(3,Rt.Ld),(0,Rt.Fb)(4,Wt.k_),(0,Rt.Fb)(5,Lt.P),(0,Rt.Fb)(6,Nt.Dt),(0,Rt.Fb)(7,Rt.ys),(0,Rt.Fb)(8,Rt.Zo),(0,Rt.Fb)(9,Rt.eb),(0,Rt.Fb)(10,Tt.Xn)],fa);var Sa=class extends Rt.CA{get keybindings(){return this._keybindings}constructor(e,t,i,o){super(),this.userDataProfileService=e,this.uriIdentityService=t,this.fileService=i,this._rawKeybindings=[],this._keybindings=[],this.watchDisposables=this._register(new Rt.EA),this._onDidChange=this._register(new Rt.uA),this.onDidChange=this._onDidChange.event,this.watch(),this.reloadConfigurationScheduler=this._register(new Rt.Sw(()=>this.reload().then(e=>{e&&this._onDidChange.fire()}),50)),this._register(Rt.dA.filter(this.fileService.onDidFilesChange,e=>e.contains(this.userDataProfileService.currentProfile.keybindingsResource))(()=>{o.debug("Keybindings file changed"),this.reloadConfigurationScheduler.schedule()})),this._register(this.fileService.onDidRunOperation(e=>{e.operation===Rt.Ns.WRITE&&e.resource.toString()===this.userDataProfileService.currentProfile.keybindingsResource.toString()&&(o.debug("Keybindings file written"),this.reloadConfigurationScheduler.schedule())})),this._register(e.onDidChangeCurrentProfile(e=>{this.uriIdentityService.extUri.isEqual(e.previous.keybindingsResource,e.profile.keybindingsResource)||e.join(this.whenCurrentProfileChanged())}))}async whenCurrentProfileChanged(){this.watch(),this.reloadConfigurationScheduler.schedule()}watch(){this.watchDisposables.clear(),this.watchDisposables.add(this.fileService.watch((0,Rt.Qw)(this.userDataProfileService.currentProfile.keybindingsResource))),this.watchDisposables.add(this.fileService.watch(this.userDataProfileService.currentProfile.keybindingsResource))}async initialize(){await this.reload()}async reload(){let e=await this.readUserKeybindings();return!(0,Rt.Gj)(this._rawKeybindings,e)&&(this._rawKeybindings=e,this._keybindings=this._rawKeybindings.map(e=>pa.readUserKeybindingItem(e)),!0)}async readUserKeybindings(){try{let e=(0,Rt.wo)((await this.fileService.readFile(this.userDataProfileService.currentProfile.keybindingsResource)).value.toString());return Array.isArray(e)?e.filter(e=>e&&"object"==typeof e):[]}catch(e){return[]}}},Ia=(U=class e{constructor(){this.commandsSchemas=[],this.commandsEnum=[],this.removalCommandsEnum=[],this.commandsEnumDescriptions=[],this.schema={id:e.schemaId,type:"array",title:(0,Rt.Ij)(14128,"Keybindings configuration"),allowTrailingCommas:!0,allowComments:!0,definitions:{editorGroupsSchema:{type:"array",items:{type:"object",properties:{groups:{$ref:"#/definitions/editorGroupsSchema",default:[{},{}]},size:{type:"number",default:.5}}}},commandNames:{type:"string",enum:this.commandsEnum,enumDescriptions:this.commandsEnumDescriptions,description:(0,Rt.Ij)(14129,"Name of the command to execute")},commandType:{anyOf:[{$ref:"#/definitions/commandNames"},{type:"string",enum:this.removalCommandsEnum,enumDescriptions:this.commandsEnumDescriptions,description:(0,Rt.Ij)(14130,"Name of the command to remove keyboard shortcut for")},{type:"string"}]},commandsSchemas:{allOf:this.commandsSchemas}},items:{required:["key"],type:"object",defaultSnippets:[{body:{key:"$1",command:"$2",when:"$3"}}],properties:{key:{type:"string",description:(0,Rt.Ij)(14131,"Key or key sequence (separated by space)")},command:{anyOf:[{if:{type:"array"},then:{not:{type:"array"},errorMessage:(0,Rt.Ij)(14132,"Incorrect type. Expected \"{0}\". The field 'command' does not support running multiple commands. Use command 'runCommands' to pass it multiple commands to run.","string")},else:{$ref:"#/definitions/commandType"}},{$ref:"#/definitions/commandType"}]},when:{type:"string",description:(0,Rt.Ij)(14133,"Condition when the key is active.")},args:{description:(0,Rt.Ij)(14134,"Arguments to pass to the command to execute.")}},$ref:"#/definitions/commandsSchemas"}},this.schemaRegistry=Rt._b.as(Rt.J_.JSONContribution),this.schemaRegistry.registerSchema(e.schemaId,this.schema)}updateSchema(t){this.commandsSchemas.length=0,this.commandsEnum.length=0,this.removalCommandsEnum.length=0,this.commandsEnumDescriptions.length=0;let i=new Set,o=(e,t)=>{/^_/.test(e)||i.has(e)||(i.add(e),this.commandsEnum.push(e),this.commandsEnumDescriptions.push(void 0===t?"":(0,Rt.Fi)(t)?t.value:t),this.removalCommandsEnum.push("-".concat(e)))},s=Rt.xb.getCommands();for(let[e,d]of s){var r,n;let t=d.metadata;if(o(e,null!==(r=null===t||void 0===t?void 0:t.description)&&void 0!==r?r:null===(n=Rt.lb.getCommand(e))||void 0===n?void 0:n.title),!t||!t.args||1!==t.args.length||!t.args[0].schema)continue;let i=t.args[0].schema,s=void 0===t.args[0].isOptional?Array.isArray(i.required)&&i.required.length>0:!t.args[0].isOptional,a={if:{required:["command"],properties:{command:{const:e}}},then:{required:[].concat(s?["args"]:[]),properties:{args:i}}};this.commandsSchemas.push(a)}let a=Rt.lb.getCommands();for(let e of a.keys())o(e);this.commandsSchemas.push(...t),this.schemaRegistry.notifySchemaChanged(e.schemaId)}},{_:U.schemaId="vscode://schemas/keybindings"},U);function ka(e,t){return!(!e||!t)&&!!(e.name&&t.name&&e.name===t.name||e.id&&t.id&&e.id===t.id||e.model&&t.model&&e.model===t.model&&e.layout===t.layout)}function _a(e){if(!e)return{label:"",description:""};if(e.name)return{label:e.text,description:""};if(e.id){let t=e;return t.localizedName?{label:t.localizedName,description:""}:/^com\.apple\.keylayout\./.test(t.id)?{label:t.id.replace(/^com\.apple\.keylayout\./,"").replace(/-/," "),description:""}:/^.*inputmethod\./.test(t.id)?{label:t.id.replace(/^.*inputmethod\./,"").replace(/[-\.]/," "),description:"Input Method (".concat(t.lang,")")}:{label:t.lang,description:""}}return{label:e.layout,description:""}}function Ea(e){return e.name?e.name:e.id?e.id:e.layout}(0,Rt.tO)(),(0,Rt.mj)();var Aa,Da=class e{constructor(e,t,i,o){this.layout=e,this.secondaryLayouts=t,this.mapping=function(e){let t=e,i={};for(let o in t){let e=t[o];if(e.length){let t=e[0],s=e[1],r=e[2],n=e[3],a=Number(e[4]);i[o]={value:t,vkey:6===e.length?e[5]:void 0,withShift:s,withAltGr:r,withShiftAltGr:n,valueIsDeadKey:(1&a)>0,withShiftIsDeadKey:(2&a)>0,withAltGrIsDeadKey:(4&a)>0,withShiftAltGrIsDeadKey:(8&a)>0}}else i[o]={value:"",valueIsDeadKey:!1,withShift:"",withShiftIsDeadKey:!1,withAltGr:"",withAltGrIsDeadKey:!1,withShiftAltGr:"",withShiftAltGrIsDeadKey:!1}}return i}(i),this.isUserKeyboardLayout=!!o,this.layout.isUserKeyboardLayout=!!o}static createKeyboardLayoutFromDebugInfo(t,i,o){let s=new e(t,[],{},!0);return s.mapping=i,s}update(e){this.layout=e.layout,this.secondaryLayouts=e.secondaryLayouts,this.mapping=e.mapping,this.isUserKeyboardLayout=e.isUserKeyboardLayout,this.layout.isUserKeyboardLayout=e.isUserKeyboardLayout}getScore(e){let t=0;for(let i in e){if(Rt.kj&&("Backslash"===i||"KeyQ"===i)||Rt.xj&&("Backspace"===i||"Escape"===i))continue;let o=this.mapping[i];void 0===o&&--t;let s=e[i];o&&s&&o.value!==s.value&&--t}return t}equal(e){return this.isUserKeyboardLayout===e.isUserKeyboardLayout&&Ea(this.layout)===Ea(e.layout)&&this.fuzzyEqual(e.mapping)}fuzzyEqual(e){for(let t in e){if(Rt.kj&&("Backslash"===t||"KeyQ"===t))continue;if(void 0===this.mapping[t])return!1;let i=this.mapping[t],o=e[t];if(i.value!==o.value)return!1}return!0}};(0,Rt.Fj)(),(0,Rt.mj)(),(0,Rt.I_)(),(0,Rt.vb)(),function(e){e[e.Code=0]="Code",e[e.KeyCode=1]="KeyCode"}(Aa||(Aa={}));var xa=Rt._b.as(Rt.E_.Configuration),Va={id:"keyboard",order:15,type:"object",title:(0,Rt.Ij)(1952,"Keyboard"),properties:{"keyboard.dispatch":{scope:Rt.w_.APPLICATION,type:"string",enum:["code","keyCode"],default:"code",markdownDescription:(0,Rt.Ij)(1953,"Controls the dispatching logic for key presses to use either `code` (recommended) or `keyCode`."),included:Rt.uj===Rt.dj.Macintosh||Rt.uj===Rt.dj.Linux},"keyboard.mapAltGrToCtrlAlt":{scope:Rt.w_.APPLICATION,type:"boolean",default:!1,markdownDescription:(0,Rt.Ij)(1954,"Controls if the AltGraph+ modifier should be treated as Ctrl+Alt+."),included:Rt.uj===Rt.dj.Windows}}};xa.registerConfiguration(Va);var Ra=class{constructor(e){this._actual=e,this._cache=new Map}dumpDebugInfo(){return this._actual.dumpDebugInfo()}resolveKeyboardEvent(e){return this._actual.resolveKeyboardEvent(e)}resolveKeybinding(e){let t=e.getHashCode(),i=this._cache.get(t);if(!i){let i=this._actual.resolveKeybinding(e);return this._cache.set(t,i),i}return i}};(0,Rt.Vk)(),(0,Rt.tO)(),(0,Rt.GT)(),(0,Rt.io)(),(0,Rt.mj)(),(0,Rt.eo)(),(0,Rt.oo)();var Ta=class extends Rt.$a{constructor(e,t){super(Rt.dj.Windows,t),this._mapper=e}_getLabel(e){return e.isDuplicateModifierCase()?"":this._mapper.getUILabelForKeyCode(e.keyCode)}_getUSLabelForKeybinding(e){return e.isDuplicateModifierCase()?"":Rt.XD.toString(e.keyCode)}getUSLabel(){return Rt.no.toLabel(this._os,this._chords,e=>this._getUSLabelForKeybinding(e))}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":this._mapper.getAriaLabelForKeyCode(e.keyCode)}_getElectronAccelerator(e){return this._mapper.getElectronAcceleratorForKeyBinding(e)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";let t=this._mapper.getUserSettingsLabelForKeyCode(e.keyCode);return t&&t.toLowerCase()}_isWYSIWYG(e){return this.__isWYSIWYG(e.keyCode)}__isWYSIWYG(e){return e===Rt.YD.LeftArrow||e===Rt.YD.UpArrow||e===Rt.YD.RightArrow||e===Rt.YD.DownArrow||this._mapper.getAriaLabelForKeyCode(e)===this._mapper.getUserSettingsLabelForKeyCode(e)}_getChordDispatch(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Rt.XD.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode!==Rt.YD.Ctrl||e.shiftKey||e.altKey||e.metaKey?e.keyCode!==Rt.YD.Shift||e.ctrlKey||e.altKey||e.metaKey?e.keyCode!==Rt.YD.Alt||e.ctrlKey||e.shiftKey||e.metaKey?e.keyCode!==Rt.YD.Meta||e.ctrlKey||e.shiftKey||e.altKey?null:"meta":"alt":"shift":"ctrl"}static getProducedCharCode(e,t){return t?e.ctrlKey&&e.shiftKey&&e.altKey?t.withShiftAltGr:e.ctrlKey&&e.altKey?t.withAltGr:e.shiftKey?t.withShift:t.value:null}static getProducedChar(e,t){let i=this.getProducedCharCode(e,t);return null===i||0===i.length?" --- ":"  "+i+"  "}},La=class{constructor(e,t,i){this._isUSStandard=e,this._mapAltGrToCtrlAlt=i,this._keyCodeToLabel=[],this._scanCodeToKeyCode=[],this._keyCodeToLabel=[],this._keyCodeExists=[],this._keyCodeToLabel[Rt.YD.Unknown]=Rt.XD.toString(Rt.YD.Unknown);for(let n=Rt.$D.None;n<Rt.$D.MAX_VALUE;n++){let e=Rt.KD[n];e!==Rt.YD.DependsOnKbLayout&&(this._scanCodeToKeyCode[n]=e,this._keyCodeToLabel[e]=Rt.XD.toString(e),this._keyCodeExists[e]=!0)}let o=[],s=!1;for(let n in this._codeInfo=[],t)if(t.hasOwnProperty(n)){let e=Rt.eO.toEnum(n);if(e===Rt.$D.None)continue;let i=t[n],r=Rt.KD[e];if(r!==Rt.YD.DependsOnKbLayout){let t=Rt.QD[i.vkey]||Rt.YD.Unknown;if(t===Rt.YD.Unknown||r===t||e!==Rt.$D.NumpadComma)continue}let a=i.value,d=i.withShift,l=i.withAltGr,c=i.withShiftAltGr,h=Rt.QD[i.vkey]||Rt.YD.Unknown,u={scanCode:e,keyCode:h,value:a,withShift:d,withAltGr:l,withShiftAltGr:c};if(this._codeInfo[e]=u,this._scanCodeToKeyCode[e]=h,h===Rt.YD.Unknown)continue;if(this._keyCodeExists[h]=!0,0===a.length)this._keyCodeToLabel[h]=null;else if(a.length>1)this._keyCodeToLabel[h]=a;else{let e=a.charCodeAt(0);if(e>=Rt.Bk.a&&e<=Rt.Bk.z){let t=Rt.Bk.A+(e-Rt.Bk.a);o[t]=!0,s=!0,this._keyCodeToLabel[h]=String.fromCharCode(Rt.Bk.A+(e-Rt.Bk.a))}else e>=Rt.Bk.A&&e<=Rt.Bk.Z?(o[e]=!0,s=!0,this._keyCodeToLabel[h]=a):this._keyCodeToLabel[h]=a}}let r=(e,t)=>{o[e]||(this._keyCodeToLabel[t]=String.fromCharCode(e))};if(r(Rt.Bk.A,Rt.YD.KeyA),r(Rt.Bk.B,Rt.YD.KeyB),r(Rt.Bk.C,Rt.YD.KeyC),r(Rt.Bk.D,Rt.YD.KeyD),r(Rt.Bk.E,Rt.YD.KeyE),r(Rt.Bk.F,Rt.YD.KeyF),r(Rt.Bk.G,Rt.YD.KeyG),r(Rt.Bk.H,Rt.YD.KeyH),r(Rt.Bk.I,Rt.YD.KeyI),r(Rt.Bk.J,Rt.YD.KeyJ),r(Rt.Bk.K,Rt.YD.KeyK),r(Rt.Bk.L,Rt.YD.KeyL),r(Rt.Bk.M,Rt.YD.KeyM),r(Rt.Bk.N,Rt.YD.KeyN),r(Rt.Bk.O,Rt.YD.KeyO),r(Rt.Bk.P,Rt.YD.KeyP),r(Rt.Bk.Q,Rt.YD.KeyQ),r(Rt.Bk.R,Rt.YD.KeyR),r(Rt.Bk.S,Rt.YD.KeyS),r(Rt.Bk.T,Rt.YD.KeyT),r(Rt.Bk.U,Rt.YD.KeyU),r(Rt.Bk.V,Rt.YD.KeyV),r(Rt.Bk.W,Rt.YD.KeyW),r(Rt.Bk.X,Rt.YD.KeyX),r(Rt.Bk.Y,Rt.YD.KeyY),r(Rt.Bk.Z,Rt.YD.KeyZ),!s){let e=(e,t)=>{this._keyCodeToLabel[e]=String.fromCharCode(t)};e(Rt.YD.Semicolon,Rt.Bk.Semicolon),e(Rt.YD.Equal,Rt.Bk.Equals),e(Rt.YD.Comma,Rt.Bk.Comma),e(Rt.YD.Minus,Rt.Bk.Dash),e(Rt.YD.Period,Rt.Bk.Period),e(Rt.YD.Slash,Rt.Bk.Slash),e(Rt.YD.Backquote,Rt.Bk.BackTick),e(Rt.YD.BracketLeft,Rt.Bk.OpenSquareBracket),e(Rt.YD.Backslash,Rt.Bk.Backslash),e(Rt.YD.BracketRight,Rt.Bk.CloseSquareBracket),e(Rt.YD.Quote,Rt.Bk.SingleQuote)}}dumpDebugInfo(){let e=[],t=[Rt.$D.ArrowUp,Rt.$D.Numpad0],i=0;e.push("-----------------------------------------------------------------------------------------------------------------------------------------");for(let o=Rt.$D.None;o<Rt.$D.MAX_VALUE;o++){if(Rt.KD[o]!==Rt.YD.DependsOnKbLayout&&-1===t.indexOf(o))continue;i%6==0&&(e.push("|       HW Code combination      |  Key  |    KeyCode combination    |          UI label         |        User settings       | WYSIWYG |"),e.push("-----------------------------------------------------------------------------------------------------------------------------------------")),i++;let s=this._codeInfo[o],r=Rt.eO.toString(o);for(let t of[0,2,5,7]){let i=!!(1&t),n=!!(2&t),a=!!(4&t),d=new Rt.WT(i,n,a,!1,o),l=this._resolveChord(d),c=l?Rt.XD.toString(l.keyCode):null,h=l?new Ta(this,[l]):null,u="".concat(i?"Ctrl+":"").concat(n?"Shift+":"").concat(a?"Alt+":"").concat(r),g=h?h.getAriaLabel():null,p=g?g.replace(/Control\+/,"Ctrl+"):null,b=h?h.getUserSettingsLabel():null,m=Ta.getProducedChar(d,s),v=c?"".concat(i?"Ctrl+":"").concat(n?"Shift+":"").concat(a?"Alt+":"").concat(c):null,C=h&&h.isWYSIWYG()?"       ":"   NO  ";e.push("| ".concat(this._leftPad(u,30)," | ").concat(m," | ").concat(this._leftPad(v,25)," | ").concat(this._leftPad(p,25)," |  ").concat(this._leftPad(b,25)," | ").concat(C," |"))}e.push("-----------------------------------------------------------------------------------------------------------------------------------------")}return e.join("\n")}_leftPad(e,t){for(null===e&&(e="null");e.length<t;)e=" "+e;return e}getUILabelForKeyCode(e){return this._getLabelForKeyCode(e)}getAriaLabelForKeyCode(e){return this._getLabelForKeyCode(e)}getUserSettingsLabelForKeyCode(e){return this._isUSStandard?Rt.XD.toUserSettingsUS(e):Rt.XD.toUserSettingsGeneral(e)}getElectronAcceleratorForKeyBinding(e){return Rt.XD.toElectronAccelerator(e.keyCode)}_getLabelForKeyCode(e){return this._keyCodeToLabel[e]||Rt.XD.toString(Rt.YD.Unknown)}resolveKeyboardEvent(e){let t=e.ctrlKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,i=e.altKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,o=new Rt.HT(t,e.shiftKey,i,e.metaKey,e.keyCode);return new Ta(this,[o])}_resolveChord(e){if(!e)return null;if(e instanceof Rt.HT)return this._keyCodeExists[e.keyCode]?e:null;let t=this._scanCodeToKeyCode[e.scanCode]||Rt.YD.Unknown;return t!==Rt.YD.Unknown&&this._keyCodeExists[t]?new Rt.HT(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t):null}resolveKeybinding(e){let t=(0,Rt.so)(e.chords.map(e=>this._resolveChord(e)));return t.length>0?[new Ta(this,t)]:[]}};(0,Rt.Vk)(),(0,Rt.tO)(),(0,Rt.GT)(),(0,Rt.mj)(),(0,Rt.eo)();var Wa=[],Fa=class extends Rt.$a{constructor(e,t,i){super(t,i),this._mapper=e}_getLabel(e){return this._mapper.getUILabelForScanCodeChord(e)}_getAriaLabel(e){return this._mapper.getAriaLabelForScanCodeChord(e)}_getElectronAccelerator(e){return this._mapper.getElectronAcceleratorLabelForScanCodeChord(e)}_getUserSettingsLabel(e){return this._mapper.getUserSettingsLabelForScanCodeChord(e)}_isWYSIWYG(e){if(!e||Rt.KD[e.scanCode]!==Rt.YD.DependsOnKbLayout)return!0;let t=this._mapper.getAriaLabelForScanCodeChord(e),i=this._mapper.getUserSettingsLabelForScanCodeChord(e);return!t&&!i||!(!t||!i)&&t.toLowerCase()===i.toLowerCase()}_getChordDispatch(e){return this._mapper.getDispatchStrForScanCodeChord(e)}_getSingleModifierChordDispatch(e){return e.scanCode!==Rt.$D.ControlLeft&&e.scanCode!==Rt.$D.ControlRight||e.shiftKey||e.altKey||e.metaKey?e.scanCode!==Rt.$D.AltLeft&&e.scanCode!==Rt.$D.AltRight||e.ctrlKey||e.shiftKey||e.metaKey?e.scanCode!==Rt.$D.ShiftLeft&&e.scanCode!==Rt.$D.ShiftRight||e.ctrlKey||e.altKey||e.metaKey?e.scanCode!==Rt.$D.MetaLeft&&e.scanCode!==Rt.$D.MetaRight||e.ctrlKey||e.shiftKey||e.altKey?null:"meta":"shift":"alt":"ctrl"}},Ga=class{constructor(e,t,i,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.scanCode=o}toString(){return"".concat(this.ctrlKey?"Ctrl+":"").concat(this.shiftKey?"Shift+":"").concat(this.altKey?"Alt+":"").concat(Rt.eO.toString(this.scanCode))}equals(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.scanCode===e.scanCode}getProducedCharCode(e){return e?this.ctrlKey&&this.shiftKey&&this.altKey?e.withShiftAltGr:this.ctrlKey&&this.altKey?e.withAltGr:this.shiftKey?e.withShift:e.value:""}getProducedChar(e){let t=Pa.getCharCode(this.getProducedCharCode(e));return 0===t?" --- ":t>=Rt.Bk.U_Combining_Grave_Accent&&t<=Rt.Bk.U_Combining_Latin_Small_Letter_X?"U+"+t.toString(16):"  "+String.fromCharCode(t)+"  "}},Za=class{constructor(e,t,i,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.keyCode=o}toString(){return"".concat(this.ctrlKey?"Ctrl+":"").concat(this.shiftKey?"Shift+":"").concat(this.altKey?"Alt+":"").concat(Rt.XD.toString(this.keyCode))}},Na=class{constructor(){this._scanCodeToKeyCode=[],this._keyCodeToScanCode=[],this._scanCodeToKeyCode=[],this._keyCodeToScanCode=[]}registrationComplete(){this._moveToEnd(Rt.$D.IntlHash),this._moveToEnd(Rt.$D.IntlBackslash)}_moveToEnd(e){for(let t=0;t<8;t++){let i=this._scanCodeToKeyCode[(e<<3)+t];if(i)for(let t=0,o=i.length;t<o;t++){let o=this._keyCodeToScanCode[i[t]];if(1!==o.length)for(let t=0,i=o.length;t<i;t++){let s=o[t];if(s>>>3===e){for(let e=t+1;e<i;e++)o[e-1]=o[e];o[i-1]=s}}}}}registerIfUnknown(e,t){if(t.keyCode===Rt.YD.Unknown)return;let i=this._encodeScanCodeCombo(e),o=this._encodeKeyCodeCombo(t),s=t.keyCode>=Rt.YD.Digit0&&t.keyCode<=Rt.YD.Digit9,r=t.keyCode>=Rt.YD.KeyA&&t.keyCode<=Rt.YD.KeyZ,n=this._scanCodeToKeyCode[i];if(s||r){if(n)for(let a=0,d=n.length;a<d;a++)if(n[a]===o)return}else if(n&&0!==n.length)return;this._scanCodeToKeyCode[i]=this._scanCodeToKeyCode[i]||[],this._scanCodeToKeyCode[i].unshift(o),this._keyCodeToScanCode[o]=this._keyCodeToScanCode[o]||[],this._keyCodeToScanCode[o].unshift(i)}lookupKeyCodeCombo(e){let t=this._encodeKeyCodeCombo(e),i=this._keyCodeToScanCode[t];if(!i||0===i.length)return[];let o=[];for(let s=0,r=i.length;s<r;s++){let e=i[s];o[s]=new Ga(!!(1&e),!!(2&e),!!(4&e),e>>>3)}return o}lookupScanCodeCombo(e){let t=this._encodeScanCodeCombo(e),i=this._scanCodeToKeyCode[t];if(!i||0===i.length)return[];let o=[];for(let s=0,r=i.length;s<r;s++){let e=i[s];o[s]=new Za(!!(1&e),!!(2&e),!!(4&e),e>>>3)}return o}guessStableKeyCode(e){if(e>=Rt.$D.Digit1&&e<=Rt.$D.Digit0)switch(e){case Rt.$D.Digit1:return Rt.YD.Digit1;case Rt.$D.Digit2:return Rt.YD.Digit2;case Rt.$D.Digit3:return Rt.YD.Digit3;case Rt.$D.Digit4:return Rt.YD.Digit4;case Rt.$D.Digit5:return Rt.YD.Digit5;case Rt.$D.Digit6:return Rt.YD.Digit6;case Rt.$D.Digit7:return Rt.YD.Digit7;case Rt.$D.Digit8:return Rt.YD.Digit8;case Rt.$D.Digit9:return Rt.YD.Digit9;case Rt.$D.Digit0:return Rt.YD.Digit0}let t=this.lookupScanCodeCombo(new Ga(!1,!1,!1,e)),i=this.lookupScanCodeCombo(new Ga(!1,!0,!1,e));if(1===t.length&&1===i.length){let e=t[0].shiftKey,o=t[0].keyCode,s=i[0].shiftKey;if(o===i[0].keyCode&&e!==s)return o}return Rt.YD.DependsOnKbLayout}_encodeScanCodeCombo(e){return this._encode(e.ctrlKey,e.shiftKey,e.altKey,e.scanCode)}_encodeKeyCodeCombo(e){return this._encode(e.ctrlKey,e.shiftKey,e.altKey,e.keyCode)}_encode(e,t,i,o){return((e?1:0)|(t?1:0)<<1|(i?1:0)<<2|o<<3)>>>0}},Pa=class e{constructor(t,i,o,s){this._isUSStandard=t,this._mapAltGrToCtrlAlt=o,this._OS=s,this._scanCodeToLabel=[],this._scanCodeToDispatch=[],this._codeInfo=[],this._scanCodeKeyCodeMapper=new Na,this._scanCodeToLabel=[],this._scanCodeToDispatch=[];let r=(e,t,i,o,s,r,n,a)=>{this._scanCodeKeyCodeMapper.registerIfUnknown(new Ga(!!e,!!t,!!i,o),new Za(!!s,!!r,!!n,a))},n=(e,t,i,o,s)=>{for(let n=e;n<=1;n++)for(let e=t;e<=1;e++)for(let t=i;t<=1;t++)r(n,e,t,o,n,e,t,s)};for(let e=Rt.$D.None;e<Rt.$D.MAX_VALUE;e++)this._scanCodeToLabel[e]=null;for(let e=Rt.$D.None;e<Rt.$D.MAX_VALUE;e++)this._scanCodeToDispatch[e]=null;for(let e=Rt.$D.None;e<Rt.$D.MAX_VALUE;e++){let t=Rt.KD[e];t!==Rt.YD.DependsOnKbLayout&&(n(0,0,0,e,t),this._scanCodeToLabel[e]=Rt.XD.toString(t),t===Rt.YD.Unknown||(0,Rt.nO)(t)?this._scanCodeToDispatch[e]=null:this._scanCodeToDispatch[e]="[".concat(Rt.eO.toString(e),"]"))}let a={};{let t=[];for(let s in i)if(i.hasOwnProperty(s)){let o=Rt.eO.toEnum(s);if(o===Rt.$D.None||Rt.KD[o]!==Rt.YD.DependsOnKbLayout)continue;let r=i[s],n=e.getCharCode(r.value);if(n>=Rt.Bk.a&&n<=Rt.Bk.z){let e=Rt.Bk.A+(n-Rt.Bk.a);t[e]=!0}}let o=(e,i,o,s)=>{t[e]||(a[Rt.eO.toString(i)]={value:o,withShift:s,withAltGr:"",withShiftAltGr:""})};o(Rt.Bk.A,Rt.$D.KeyA,"a","A"),o(Rt.Bk.B,Rt.$D.KeyB,"b","B"),o(Rt.Bk.C,Rt.$D.KeyC,"c","C"),o(Rt.Bk.D,Rt.$D.KeyD,"d","D"),o(Rt.Bk.E,Rt.$D.KeyE,"e","E"),o(Rt.Bk.F,Rt.$D.KeyF,"f","F"),o(Rt.Bk.G,Rt.$D.KeyG,"g","G"),o(Rt.Bk.H,Rt.$D.KeyH,"h","H"),o(Rt.Bk.I,Rt.$D.KeyI,"i","I"),o(Rt.Bk.J,Rt.$D.KeyJ,"j","J"),o(Rt.Bk.K,Rt.$D.KeyK,"k","K"),o(Rt.Bk.L,Rt.$D.KeyL,"l","L"),o(Rt.Bk.M,Rt.$D.KeyM,"m","M"),o(Rt.Bk.N,Rt.$D.KeyN,"n","N"),o(Rt.Bk.O,Rt.$D.KeyO,"o","O"),o(Rt.Bk.P,Rt.$D.KeyP,"p","P"),o(Rt.Bk.Q,Rt.$D.KeyQ,"q","Q"),o(Rt.Bk.R,Rt.$D.KeyR,"r","R"),o(Rt.Bk.S,Rt.$D.KeyS,"s","S"),o(Rt.Bk.T,Rt.$D.KeyT,"t","T"),o(Rt.Bk.U,Rt.$D.KeyU,"u","U"),o(Rt.Bk.V,Rt.$D.KeyV,"v","V"),o(Rt.Bk.W,Rt.$D.KeyW,"w","W"),o(Rt.Bk.X,Rt.$D.KeyX,"x","X"),o(Rt.Bk.Y,Rt.$D.KeyY,"y","Y"),o(Rt.Bk.Z,Rt.$D.KeyZ,"z","Z")}let d=[],l=0;for(let c in i)if(i.hasOwnProperty(c)){let t=Rt.eO.toEnum(c);if(t===Rt.$D.None||Rt.KD[t]!==Rt.YD.DependsOnKbLayout)continue;this._codeInfo[t]=i[c];let o=a[c]||i[c],s=e.getCharCode(o.value),r={scanCode:t,value:s,withShift:e.getCharCode(o.withShift),withAltGr:e.getCharCode(o.withAltGr),withShiftAltGr:e.getCharCode(o.withShiftAltGr)};if(d[l++]=r,this._scanCodeToDispatch[t]="[".concat(Rt.eO.toString(t),"]"),s>=Rt.Bk.a&&s<=Rt.Bk.z){let e=Rt.Bk.A+(s-Rt.Bk.a);this._scanCodeToLabel[t]=String.fromCharCode(e)}else s>=Rt.Bk.A&&s<=Rt.Bk.Z||s?this._scanCodeToLabel[t]=String.fromCharCode(s):this._scanCodeToLabel[t]=null}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=t.withShiftAltGr;if(o===t.withAltGr||o===t.withShift||o===t.value)continue;let s=e._charCodeToKb(o);if(!s)continue;let n=s.shiftKey,a=s.keyCode;r(1,1,1,i,0,n?1:0,0,a)}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=t.withAltGr;if(o===t.withShift||o===t.value)continue;let s=e._charCodeToKb(o);if(!s)continue;let n=s.shiftKey,a=s.keyCode;r(1,0,1,i,0,n?1:0,0,a)}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=t.withShift;if(o===t.value)continue;let s=e._charCodeToKb(o);if(!s)continue;let n=s.shiftKey,a=s.keyCode;n?(r(0,1,0,i,0,1,0,a),r(0,1,1,i,0,1,1,a),r(1,1,0,i,1,1,0,a),r(1,1,1,i,1,1,1,a)):(r(0,1,0,i,0,0,0,a),r(0,1,0,i,0,1,0,a),r(0,1,1,i,0,0,1,a),r(0,1,1,i,0,1,1,a),r(1,1,0,i,1,0,0,a),r(1,1,0,i,1,1,0,a),r(1,1,1,i,1,0,1,a),r(1,1,1,i,1,1,1,a))}for(let c=d.length-1;c>=0;c--){let t=d[c],i=t.scanCode,o=e._charCodeToKb(t.value);if(!o)continue;let s=o.shiftKey,n=o.keyCode;s?(r(0,0,0,i,0,1,0,n),r(0,0,1,i,0,1,1,n),r(1,0,0,i,1,1,0,n),r(1,0,1,i,1,1,1,n)):(r(0,0,0,i,0,0,0,n),r(0,0,1,i,0,0,1,n),r(0,1,0,i,0,1,0,n),r(0,1,1,i,0,1,1,n),r(1,0,0,i,1,0,0,n),r(1,0,1,i,1,0,1,n),r(1,1,0,i,1,1,0,n),r(1,1,1,i,1,1,1,n))}n(0,0,0,Rt.$D.Digit1,Rt.YD.Digit1),n(0,0,0,Rt.$D.Digit2,Rt.YD.Digit2),n(0,0,0,Rt.$D.Digit3,Rt.YD.Digit3),n(0,0,0,Rt.$D.Digit4,Rt.YD.Digit4),n(0,0,0,Rt.$D.Digit5,Rt.YD.Digit5),n(0,0,0,Rt.$D.Digit6,Rt.YD.Digit6),n(0,0,0,Rt.$D.Digit7,Rt.YD.Digit7),n(0,0,0,Rt.$D.Digit8,Rt.YD.Digit8),n(0,0,0,Rt.$D.Digit9,Rt.YD.Digit9),n(0,0,0,Rt.$D.Digit0,Rt.YD.Digit0),this._scanCodeKeyCodeMapper.registrationComplete()}dumpDebugInfo(){let e=[],t=[Rt.$D.ArrowUp,Rt.$D.Numpad0],i=0;e.push("isUSStandard: ".concat(this._isUSStandard)),e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");for(let o=Rt.$D.None;o<Rt.$D.MAX_VALUE;o++){if(Rt.KD[o]!==Rt.YD.DependsOnKbLayout&&-1===t.indexOf(o))continue;i%4==0&&(e.push("|       HW Code combination      |  Key  |    KeyCode combination    | Pri |          UI label         |         User settings          |    Electron accelerator   |       Dispatching string       | WYSIWYG |"),e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------")),i++;let s=this._codeInfo[o];for(let t=0;t<8;t++){let i=new Ga(!!(1&t),!!(2&t),!!(4&t),o),r=this.resolveKeyboardEvent({_standardKeyboardEventBrand:!0,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,altKey:i.altKey,metaKey:!1,altGraphKey:!1,keyCode:Rt.YD.DependsOnKbLayout,code:Rt.eO.toString(o)}),n=i.toString(),a=i.getProducedChar(s),d=r.getAriaLabel(),l=d?d.replace(/Control\+/,"Ctrl+"):null,c=r.getUserSettingsLabel(),h=r.getElectronAccelerator(),u=r.getDispatchChords()[0],g=r&&r.isWYSIWYG()?"       ":"   NO  ",p=this._scanCodeKeyCodeMapper.lookupScanCodeCombo(i);if(0===p.length)e.push("| ".concat(this._leftPad(n,30)," | ").concat(a," | ").concat(this._leftPad("",25)," | ").concat(this._leftPad("",3)," | ").concat(this._leftPad(l,25)," | ").concat(this._leftPad(c,30)," | ").concat(this._leftPad(h,25)," | ").concat(this._leftPad(u,30)," | ").concat(g," |"));else for(let t=0,o=p.length;t<o;t++){let o,s=p[t],r=this._scanCodeKeyCodeMapper.lookupKeyCodeCombo(s);if(1===r.length)o="";else{let e=-1;for(let t=0;t<r.length;t++)if(r[t].equals(i)){e=t+1;break}o=String(e)}let d=s.toString();0===t?e.push("| ".concat(this._leftPad(n,30)," | ").concat(a," | ").concat(this._leftPad(d,25)," | ").concat(this._leftPad(o,3)," | ").concat(this._leftPad(l,25)," | ").concat(this._leftPad(c,30)," | ").concat(this._leftPad(h,25)," | ").concat(this._leftPad(u,30)," | ").concat(g," |")):e.push("| ".concat(this._leftPad("",30)," |       | ").concat(this._leftPad(d,25)," | ").concat(this._leftPad(o,3)," | ").concat(this._leftPad("",25)," | ").concat(this._leftPad("",30)," | ").concat(this._leftPad("",25)," | ").concat(this._leftPad("",30)," |         |"))}}e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------")}return e.join("\n")}_leftPad(e,t){for(null===e&&(e="null");e.length<t;)e=" "+e;return e}keyCodeChordToScanCodeChord(e){if(e.keyCode===Rt.YD.Enter)return[new Rt.WT(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,Rt.$D.Enter)];let t=this._scanCodeKeyCodeMapper.lookupKeyCodeCombo(new Za(e.ctrlKey,e.shiftKey,e.altKey,e.keyCode)),i=[];for(let o=0,s=t.length;o<s;o++){let s=t[o];i[o]=new Rt.WT(s.ctrlKey,s.shiftKey,s.altKey,e.metaKey,s.scanCode)}return i}getUILabelForScanCodeChord(e){if(!e)return null;if(e.isDuplicateModifierCase())return"";if(this._OS===Rt.dj.Macintosh)switch(e.scanCode){case Rt.$D.ArrowLeft:return"\u2190";case Rt.$D.ArrowUp:return"\u2191";case Rt.$D.ArrowRight:return"\u2192";case Rt.$D.ArrowDown:return"\u2193"}return this._scanCodeToLabel[e.scanCode]}getAriaLabelForScanCodeChord(e){return e?e.isDuplicateModifierCase()?"":this._scanCodeToLabel[e.scanCode]:null}getDispatchStrForScanCodeChord(e){let t=this._scanCodeToDispatch[e.scanCode];if(!t)return null;let i="";return e.ctrlKey&&(i+="ctrl+"),e.shiftKey&&(i+="shift+"),e.altKey&&(i+="alt+"),e.metaKey&&(i+="meta+"),i+=t,i}getUserSettingsLabelForScanCodeChord(e){if(!e)return null;if(e.isDuplicateModifierCase())return"";let t=Rt.KD[e.scanCode];if(t!==Rt.YD.DependsOnKbLayout)return Rt.XD.toUserSettingsUS(t).toLowerCase();let i=this._scanCodeKeyCodeMapper.guessStableKeyCode(e.scanCode);if(i!==Rt.YD.DependsOnKbLayout){let t=this.keyCodeChordToScanCodeChord(new Rt.HT(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,i));for(let o=0,s=t.length;o<s;o++)if(t[o].scanCode===e.scanCode)return Rt.XD.toUserSettingsUS(i).toLowerCase()}return this._scanCodeToDispatch[e.scanCode]}getElectronAcceleratorLabelForScanCodeChord(e){if(!e)return null;let t=Rt.KD[e.scanCode];if(t!==Rt.YD.DependsOnKbLayout)return Rt.XD.toElectronAccelerator(t);let i=this._scanCodeKeyCodeMapper.guessStableKeyCode(e.scanCode);return(this._OS!==Rt.dj.Linux||this._isUSStandard||i!==Rt.YD.Semicolon&&i!==Rt.YD.Equal&&i!==Rt.YD.Comma&&i!==Rt.YD.Minus&&i!==Rt.YD.Period&&i!==Rt.YD.Slash&&i!==Rt.YD.Backquote&&i!==Rt.YD.BracketLeft&&i!==Rt.YD.Backslash&&i!==Rt.YD.BracketRight)&&i!==Rt.YD.DependsOnKbLayout?Rt.XD.toElectronAccelerator(i):null}_toResolvedKeybinding(e){if(0===e.length)return[];let t=[];return this._generateResolvedKeybindings(e,0,[],t),t}_generateResolvedKeybindings(e,t,i,o){let s=e[t],r=t===e.length-1;for(let n=0,a=s.length;n<a;n++){let a=[...i,s[n]];r?o.push(new Fa(this,this._OS,a)):this._generateResolvedKeybindings(e,t+1,a,o)}}resolveKeyboardEvent(e){let t=Rt.eO.toEnum(e.code);t===Rt.$D.NumpadEnter&&(t=Rt.$D.Enter);let i=e.keyCode;if(i===Rt.YD.LeftArrow||i===Rt.YD.UpArrow||i===Rt.YD.RightArrow||i===Rt.YD.DownArrow||i===Rt.YD.Delete||i===Rt.YD.Insert||i===Rt.YD.Home||i===Rt.YD.End||i===Rt.YD.PageDown||i===Rt.YD.PageUp||i===Rt.YD.Backspace){let e=Rt.qD[i];e!==Rt.$D.DependsOnKbLayout&&(t=e)}else if((t===Rt.$D.Numpad1||t===Rt.$D.Numpad2||t===Rt.$D.Numpad3||t===Rt.$D.Numpad4||t===Rt.$D.Numpad5||t===Rt.$D.Numpad6||t===Rt.$D.Numpad7||t===Rt.$D.Numpad8||t===Rt.$D.Numpad9||t===Rt.$D.Numpad0||t===Rt.$D.NumpadDecimal)&&i>=0){let e=Rt.qD[i];e!==Rt.$D.DependsOnKbLayout&&(t=e)}let o=e.ctrlKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,s=e.altKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,r=new Rt.WT(o,e.shiftKey,s,e.metaKey,t);return new Fa(this,this._OS,[r])}_resolveChord(e){return e?e instanceof Rt.WT?[e]:this.keyCodeChordToScanCodeChord(e):[]}resolveKeybinding(e){let t=e.chords.map(e=>this._resolveChord(e));return this._toResolvedKeybinding(t)}static _redirectCharCode(e){switch(e){case Rt.Bk.U_IDEOGRAPHIC_FULL_STOP:return Rt.Bk.Period;case Rt.Bk.U_LEFT_CORNER_BRACKET:return Rt.Bk.OpenSquareBracket;case Rt.Bk.U_RIGHT_CORNER_BRACKET:return Rt.Bk.CloseSquareBracket;case Rt.Bk.U_LEFT_BLACK_LENTICULAR_BRACKET:return Rt.Bk.OpenSquareBracket;case Rt.Bk.U_RIGHT_BLACK_LENTICULAR_BRACKET:return Rt.Bk.CloseSquareBracket;case Rt.Bk.U_FULLWIDTH_SEMICOLON:return Rt.Bk.Semicolon;case Rt.Bk.U_FULLWIDTH_COMMA:return Rt.Bk.Comma}return e}static _charCodeToKb(e){return(e=this._redirectCharCode(e))<Wa.length?Wa[e]:null}static getCharCode(e){if(0===e.length)return 0;let t=e.charCodeAt(0);switch(t){case Rt.Bk.U_Combining_Grave_Accent:return Rt.Bk.U_GRAVE_ACCENT;case Rt.Bk.U_Combining_Acute_Accent:return Rt.Bk.U_ACUTE_ACCENT;case Rt.Bk.U_Combining_Circumflex_Accent:return Rt.Bk.U_CIRCUMFLEX;case Rt.Bk.U_Combining_Tilde:return Rt.Bk.U_SMALL_TILDE;case Rt.Bk.U_Combining_Macron:return Rt.Bk.U_MACRON;case Rt.Bk.U_Combining_Overline:return Rt.Bk.U_OVERLINE;case Rt.Bk.U_Combining_Breve:return Rt.Bk.U_BREVE;case Rt.Bk.U_Combining_Dot_Above:return Rt.Bk.U_DOT_ABOVE;case Rt.Bk.U_Combining_Diaeresis:return Rt.Bk.U_DIAERESIS;case Rt.Bk.U_Combining_Ring_Above:return Rt.Bk.U_RING_ABOVE;case Rt.Bk.U_Combining_Double_Acute_Accent:return Rt.Bk.U_DOUBLE_ACUTE_ACCENT}return t}};(function(){function e(e,t,i){for(let o=Wa.length;o<e;o++)Wa[o]=null;Wa[e]={keyCode:t,shiftKey:i}}for(let t=Rt.Bk.A;t<=Rt.Bk.Z;t++)e(t,Rt.YD.KeyA+(t-Rt.Bk.A),!0);for(let t=Rt.Bk.a;t<=Rt.Bk.z;t++)e(t,Rt.YD.KeyA+(t-Rt.Bk.a),!1);e(Rt.Bk.Semicolon,Rt.YD.Semicolon,!1),e(Rt.Bk.Colon,Rt.YD.Semicolon,!0),e(Rt.Bk.Equals,Rt.YD.Equal,!1),e(Rt.Bk.Plus,Rt.YD.Equal,!0),e(Rt.Bk.Comma,Rt.YD.Comma,!1),e(Rt.Bk.LessThan,Rt.YD.Comma,!0),e(Rt.Bk.Dash,Rt.YD.Minus,!1),e(Rt.Bk.Underline,Rt.YD.Minus,!0),e(Rt.Bk.Period,Rt.YD.Period,!1),e(Rt.Bk.GreaterThan,Rt.YD.Period,!0),e(Rt.Bk.Slash,Rt.YD.Slash,!1),e(Rt.Bk.QuestionMark,Rt.YD.Slash,!0),e(Rt.Bk.BackTick,Rt.YD.Backquote,!1),e(Rt.Bk.Tilde,Rt.YD.Backquote,!0),e(Rt.Bk.OpenSquareBracket,Rt.YD.BracketLeft,!1),e(Rt.Bk.OpenCurlyBrace,Rt.YD.BracketLeft,!0),e(Rt.Bk.Backslash,Rt.YD.Backslash,!1),e(Rt.Bk.Pipe,Rt.YD.Backslash,!0),e(Rt.Bk.CloseSquareBracket,Rt.YD.BracketRight,!1),e(Rt.Bk.CloseCurlyBrace,Rt.YD.BracketRight,!0),e(Rt.Bk.SingleQuote,Rt.YD.Quote,!1),e(Rt.Bk.DoubleQuote,Rt.YD.Quote,!0)})(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.im)(),(0,Rt.mj)(),(0,Tt.Dn)(),(0,Rt.bs)(),(0,Rt.Iw)(),(0,Rt.Co)(),(0,Rt.qj)(),(0,Rt.Ml)(),(0,Rt.vb)(),(0,Rt.I_)(),(0,Rt.s_)(),(0,Rt.Rd)(),(0,Rt.wb)(),(0,Rt.Wo)(),(0,Rt.Kb)();var Ja=class extends Rt.CA{get activeKeymap(){return this._activeKeymapInfo}get keymapInfos(){return this._keymapInfos}get activeKeyboardLayout(){var e,t;return this._initialized&&null!==(e=null===(t=this._activeKeymapInfo)||void 0===t?void 0:t.layout)&&void 0!==e?e:null}get activeKeyMapping(){var e,t;return this._initialized&&null!==(e=null===(t=this._activeKeymapInfo)||void 0===t?void 0:t.mapping)&&void 0!==e?e:null}get keyboardLayouts(){return this._keymapInfos.map(e=>e.layout)}constructor(e){super(),this._configurationService=e,this._onDidChangeKeyboardMapper=new Rt.uA,this.onDidChangeKeyboardMapper=this._onDidChangeKeyboardMapper.event,this.keyboardLayoutMapAllowed=void 0!==navigator.keyboard,this._keyboardMapper=null,this._initialized=!1,this._keymapInfos=[],this._mru=[],this._activeKeymapInfo=null,navigator.keyboard&&navigator.keyboard.addEventListener&&navigator.keyboard.addEventListener("layoutchange",()=>{this._getBrowserKeyMapping().then(e=>{this.isKeyMappingActive(e)||this.setLayoutFromBrowserAPI()})}),this._register(this._configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("keyboard")&&(this._keyboardMapper=null,this._onDidChangeKeyboardMapper.fire())}))}registerKeyboardLayout(e){this._keymapInfos.push(e),this._mru=this._keymapInfos}removeKeyboardLayout(e){let t=this._mru.indexOf(e);this._mru.splice(t,1),t=this._keymapInfos.indexOf(e),this._keymapInfos.splice(t,1)}getMatchedKeymapInfo(e){if(!e)return null;let t=this.getUSStandardLayout();if(t){let i=t.getScore(e);if(0===i)return{result:t,score:0};let o=t;for(let t=0;t<this._mru.length;t++){let s=this._mru[t].getScore(e);if(s>i){if(0===s)return{result:this._mru[t],score:0};i=s,o=this._mru[t]}}return{result:o,score:i}}for(let i=0;i<this._mru.length;i++)if(this._mru[i].fuzzyEqual(e))return{result:this._mru[i],score:0};return null}getUSStandardLayout(){let e=this._mru.filter(e=>e.layout.isUSStandard);return e.length?e[0]:null}isKeyMappingActive(e){return this._activeKeymapInfo&&e&&this._activeKeymapInfo.fuzzyEqual(e)}setUSKeyboardLayout(){this._activeKeymapInfo=this.getUSStandardLayout()}setActiveKeyMapping(e){let t=!1,i=this.getMatchedKeymapInfo(e);if(i&&(this._activeKeymapInfo?e&&i.result.getScore(e)>this._activeKeymapInfo.getScore(e)&&(this._activeKeymapInfo=i.result,t=!0):(this._activeKeymapInfo=i.result,t=!0)),this._activeKeymapInfo||(this._activeKeymapInfo=this.getUSStandardLayout(),t=!0),!this._activeKeymapInfo||!t)return;let o=this._mru.indexOf(this._activeKeymapInfo);this._mru.splice(o,1),this._mru.unshift(this._activeKeymapInfo),this._setKeyboardData(this._activeKeymapInfo)}setActiveKeymapInfo(e){this._activeKeymapInfo=e;let t=this._mru.indexOf(this._activeKeymapInfo);0!==t&&(this._mru.splice(t,1),this._mru.unshift(this._activeKeymapInfo),this._setKeyboardData(this._activeKeymapInfo))}setLayoutFromBrowserAPI(){this._updateKeyboardLayoutAsync(this._initialized)}_updateKeyboardLayoutAsync(e,t){e&&this._getBrowserKeyMapping(t).then(e=>{this.isKeyMappingActive(e)||this.setActiveKeyMapping(e)})}getKeyboardMapper(){let e=function(e){let t=e.getValue("keyboard");return{dispatch:"keyCode"===(null===t||void 0===t?void 0:t.dispatch)?Aa.KeyCode:Aa.Code,mapAltGrToCtrlAlt:!(null===t||void 0===t||!t.mapAltGrToCtrlAlt)}}(this._configurationService);return e.dispatch!==Aa.KeyCode&&this._initialized&&this._activeKeymapInfo?(this._keyboardMapper||(this._keyboardMapper=new Ra(Ba._createKeyboardMapper(this._activeKeymapInfo,e.mapAltGrToCtrlAlt))),this._keyboardMapper):new Tt.En(e.mapAltGrToCtrlAlt,Rt.uj)}validateCurrentKeyboardMapping(e){this._initialized&&(this._validateCurrentKeyboardMapping(e)||this._updateKeyboardLayoutAsync(!0,e))}setKeyboardLayout(e){let t=this.keymapInfos.filter(t=>Ea(t.layout)===e);t.length>0&&this.setActiveKeymapInfo(t[0])}_setKeyboardData(e){this._initialized=!0,this._keyboardMapper=null,this._onDidChangeKeyboardMapper.fire()}static _createKeyboardMapper(e,t){let i=e.mapping,o=!!e.layout.isUSStandard;return Rt.uj===Rt.dj.Windows?new La(o,i,t):0===Object.keys(i).length?new Tt.En(t,Rt.uj):new Pa(o,i,t,Rt.uj)}_validateCurrentKeyboardMapping(e){if(!this._initialized)return!0;let t=e,i=this._activeKeymapInfo;if(!i||"Dead"===t.browserEvent.key||t.browserEvent.isComposing)return!0;let o=i.mapping[t.code];if(!o)return!1;if(""===o.value)return(e.ctrlKey||e.metaKey)&&setTimeout(()=>{this._getBrowserKeyMapping().then(e=>{this.isKeyMappingActive(e)||this.setLayoutFromBrowserAPI()})},350),!0;let s=t.altKey&&t.shiftKey?o.withShiftAltGr:t.altKey?o.withAltGr:t.shiftKey?o.withShift:o.value,r=t.altKey&&t.shiftKey&&o.withShiftAltGrIsDeadKey||t.altKey&&o.withAltGrIsDeadKey||t.shiftKey&&o.withShiftIsDeadKey||o.valueIsDeadKey;return!(r&&"Dead"!==t.browserEvent.key||!r&&t.browserEvent.key!==s)}async _getBrowserKeyMapping(e){if(this.keyboardLayoutMapAllowed)try{return await navigator.keyboard.getLayoutMap().then(e=>{let t={};for(let i of e)t[i[0]]={value:i[1],withShift:"",withAltGr:"",withShiftAltGr:""};return t})}catch(t){this.keyboardLayoutMapAllowed=!1}if(e&&!e.shiftKey&&!e.altKey&&!e.metaKey&&!e.metaKey){let t={},i=e;return t[i.browserEvent.code]={value:i.browserEvent.key,withShift:"",withAltGr:"",withShiftAltGr:""},this.getMatchedKeymapInfo(t)?t:null}return null}},Ba=class extends Ja{constructor(e,t,o,s){super(e),function(e){switch(e){case"./keyboardLayouts/layout.contribution.darwin.js":return i.e(3895).then(i.bind(i,3895)).then(e=>{var t;return null!==(t=e.default)&&void 0!==t?t:e});case"./keyboardLayouts/layout.contribution.linux.js":return i.e(8376).then(i.bind(i,8376)).then(e=>{var t;return null!==(t=e.default)&&void 0!==t?t:e});case"./keyboardLayouts/layout.contribution.win.js":return i.e(5052).then(i.bind(i,5052)).then(e=>{var t;return null!==(t=e.default)&&void 0!==t?t:e});default:return new Promise(function(t,i){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,Error("Unknown variable dynamic import: "+e)))})}}("./keyboardLayouts/layout.contribution.".concat(Rt.kj?"win":Rt.Cj?"darwin":"linux",".js")).then(e=>{let t=e.KeyboardLayoutContribution.INSTANCE.layoutInfos;this._keymapInfos.push(...t.map(e=>new Da(e.layout,e.secondaryLayouts,e.mapping,e.isUserKeyboardLayout))),this._mru=this._keymapInfos,this._initialized=!0,this.setLayoutFromBrowserAPI()})}},Oa=class extends Rt.CA{get keyboardLayout(){return this._keyboardLayout}constructor(e,t){super(),this.keyboardLayoutResource=e,this.fileService=t,this._onDidChange=this._register(new Rt.uA),this.onDidChange=this._onDidChange.event,this._keyboardLayout=null,this.reloadConfigurationScheduler=this._register(new Rt.Sw(()=>this.reload().then(e=>{e&&this._onDidChange.fire()}),50)),this._register(Rt.dA.filter(this.fileService.onDidFilesChange,e=>e.contains(this.keyboardLayoutResource))(()=>this.reloadConfigurationScheduler.schedule()))}async initialize(){await this.reload()}async reload(){let e=this._keyboardLayout;try{let e=(0,Rt.wo)((await this.fileService.readFile(this.keyboardLayoutResource)).value.toString());if("object"===(0,Rt.So)(e)){let t=e.layout,i=e.rawMapping;this._keyboardLayout=Da.createKeyboardLayoutFromDebugInfo(t,i,!0)}else this._keyboardLayout=null}catch(t){this._keyboardLayout=null}return!e||!(0,Rt.Gj)(e,this._keyboardLayout)}},Ka=class extends Rt.CA{constructor(e,t,i,o,s,r){super(),this.configurationService=r,this._onDidChangeKeyboardLayout=new Rt.uA,this.onDidChangeKeyboardLayout=this._onDidChangeKeyboardLayout.event;let n=r.getValue("keyboard").layout;this._keyboardLayoutMode=null!==n&&void 0!==n?n:"autodetect",this._factory=new Ba(r,i,o,s),this._register(this._factory.onDidChangeKeyboardMapper(()=>{this._onDidChangeKeyboardLayout.fire()})),n&&"autodetect"!==n&&this._factory.setKeyboardLayout(n),this._register(r.onDidChangeConfiguration(e=>{if(e.affectsConfiguration("keyboard.layout")){let e=r.getValue("keyboard").layout;this._keyboardLayoutMode=e,"autodetect"===e?this._factory.setLayoutFromBrowserAPI():this._factory.setKeyboardLayout(e)}})),this._userKeyboardLayout=new Oa(e.keyboardLayoutResource,t),this._userKeyboardLayout.initialize().then(()=>{this._userKeyboardLayout.keyboardLayout&&(this._factory.registerKeyboardLayout(this._userKeyboardLayout.keyboardLayout),this.setUserKeyboardLayoutIfMatched())}),this._register(this._userKeyboardLayout.onDidChange(()=>{let e=this._factory.keymapInfos.filter(e=>e.isUserKeyboardLayout);e.length?this._userKeyboardLayout.keyboardLayout?e[0].update(this._userKeyboardLayout.keyboardLayout):this._factory.removeKeyboardLayout(e[0]):this._userKeyboardLayout.keyboardLayout&&this._factory.registerKeyboardLayout(this._userKeyboardLayout.keyboardLayout),this.setUserKeyboardLayoutIfMatched()}))}setUserKeyboardLayoutIfMatched(){let e=this.configurationService.getValue("keyboard").layout;e&&this._userKeyboardLayout.keyboardLayout&&Ea(this._userKeyboardLayout.keyboardLayout.layout)===e&&this._factory.activeKeymap&&(this._userKeyboardLayout.keyboardLayout.equal(this._factory.activeKeymap)||this._factory.setActiveKeymapInfo(this._userKeyboardLayout.keyboardLayout))}getKeyboardMapper(){return this._factory.getKeyboardMapper()}getCurrentKeyboardLayout(){return this._factory.activeKeyboardLayout}getAllKeyboardLayouts(){return this._factory.keyboardLayouts}getRawKeyboardMapping(){return this._factory.activeKeyMapping}validateCurrentKeyboardMapping(e){"autodetect"===this._keyboardLayoutMode&&this._factory.validateCurrentKeyboardMapping(e)}};Ka=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.jl),(0,Rt.Fb)(1,Rt.ys),(0,Rt.Fb)(2,Rt.Ld),(0,Rt.Fb)(3,Rt.Uo),(0,Rt.Fb)(4,Rt.Cb),(0,Rt.Fb)(5,Rt.o_)],Ka);var Ma=Rt._b.as(Rt.E_.Configuration),ja={id:"keyboard",order:15,type:"object",title:(0,Rt.Ij)(14135,"Keyboard"),properties:{"keyboard.layout":{type:"string",default:"autodetect",description:(0,Rt.Ij)(14136,"Control the keyboard layout used in web.")}}};Ma.registerConfiguration(ja),(0,Rt.Ib)(),(0,Rt.Iw)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.Sb)(),(0,Rt.Kb)(),(0,Rt.im)(),(0,Rt.nb)(),(0,Nt.Ot)();var Qa=class extends Rt.CA{constructor(e,t,i){super(),this._instantiationService=e,this._extensionService=t,this._logService=i,this._extensionHostIsReady=!1,this._onWillExecuteCommand=this._register(new Rt.uA),this.onWillExecuteCommand=this._onWillExecuteCommand.event,this._onDidExecuteCommand=new Rt.uA,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._extensionService.whenInstalledExtensionsRegistered().then(e=>this._extensionHostIsReady=e),this._starActivation=null}_activateStar(){return this._starActivation||(this._starActivation=(0,Rt.Bw)([this._extensionService.activateByEvent("*"),(0,Rt.Gw)(3e4)])),(0,Rt.Rw)(this._starActivation)}async executeCommand(e){this._logService.trace("CommandService#executeCommand",e);let t="onCommand:".concat(e);for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return Rt.xb.getCommand(e)?this._extensionService.activationEventIsDone(t)?this._tryExecuteCommand(e,o):this._extensionHostIsReady?(await this._extensionService.activateByEvent(t),this._tryExecuteCommand(e,o)):(this._extensionService.activateByEvent(t),this._tryExecuteCommand(e,o)):(await Promise.all([this._extensionService.activateByEvent(t),(0,Rt.Bw)([this._activateStar(),Rt.dA.toPromise(Rt.dA.filter(Rt.xb.onDidRegisterCommand,t=>t===e))])]),this._tryExecuteCommand(e,o))}_tryExecuteCommand(e,t){let i=Rt.xb.getCommand(e);if(!i)return Promise.reject(Error("command '".concat(e,"' not found")));try{this._onWillExecuteCommand.fire({commandId:e,args:t});let o=this._instantiationService.invokeFunction(i.handler,...t);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(o)}catch(e){return Promise.reject(e)}}dispose(){var e;super.dispose(),null===(e=this._starActivation)||void 0===e||e.cancel()}};Qa=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Nt.Dt),(0,Rt.Fb)(2,Rt.eb)],Qa),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.Ad)(),(0,Mt.c)(),(0,Rt.wb)(),(0,Tt.un)(),(0,Rt.PA)(),(0,Rt.zl)(),(0,Rt.qx)(),(0,Rt.qg)(),(0,Rt.gA)(),(0,Rt.pb)(class e extends Rt.ob{constructor(){super({id:"workbench.action.toggleKeybindingsLog",title:(0,Rt.Lj)(8502,"Toggle Keyboard Shortcuts Troubleshooting"),category:Mt.s.Developer,f1:!0})}run(t){if(t.get(Rt.kd).toggleLogging()&&t.get(Rt.Cb).executeCommand(Tt.dn),e.disposable)return e.disposable.dispose(),void(e.disposable=void 0);let i=t.get(Rt.Rl),o=new Rt.EA,s=i.activeContainer,r=(0,Rt.dx)(s,(0,Rt.Zb)(".focus-troubleshooting-marker"));o.add((0,Rt.zA)(()=>r.remove())),(0,Rt.Wg)(".focus-troubleshooting-marker","\n\t\t\tposition: fixed;\n\t\t\tpointer-events: none;\n\t\t\tz-index: 100000;\n\t\t\tbackground-color: rgba(255, 0, 0, 0.2);\n\t\t\tborder: 2px solid rgba(255, 0, 0, 0.8);\n\t\t\tborder-radius: 2px;\n\t\t\tdisplay: none;\n\t\t",(0,Rt.Gg)(void 0,void 0,o));let n=o.add(new Rt.uA);function a(e,t){t.add((0,Rt.ox)(e,"keydown",e=>n.fire(e),!0))}for(let{window:e,disposables:d}of(0,Rt.Ux)())a(e,d);o.add((0,Rt.pS)(e=>{let{window:t,disposables:i}=e;return a(t,i)})),o.add(i.onDidChangeActiveContainer(()=>{i.activeContainer.appendChild(r)})),o.add(n.event(e=>{let t=e.target;if(t){let e=(0,Rt.jx)(t);r.style.top="".concat(e.top,"px"),r.style.left="".concat(e.left,"px"),r.style.width="".concat(e.width,"px"),r.style.height="".concat(e.height,"px"),r.style.display="block",setTimeout(()=>{r.style.display="none"},800)}})),e.disposable=o}}),(0,Rt.Co)(),(0,Rt.CD)(),(0,Rt.xD)();var Ya=class{static hasOpenBrace(e){for(;e.scan()!==Rt.yo.EOF;)if(e.getToken()===Rt.yo.OpenBraceToken)return!0;return!1}static offsetToPosition(e,t){let i=0,o=e.getEOL().length,s=e.getLineCount();for(let r=1;r<=s;r++){let s=i+(e.getLineLength(r)+o);if(s>t)return new Rt.SD(r,t-i+1);i=s}return new Rt.SD(s,e.getLineMaxColumn(s))}static insertSnippet(e,t){let i,o=e.getValueLengthInRange(new Rt.bD(1,1,t.lineNumber,t.column));!function(e){e[e.INVALID=0]="INVALID",e[e.AFTER_OBJECT=1]="AFTER_OBJECT",e[e.BEFORE_OBJECT=2]="BEFORE_OBJECT"}(i||(i={}));let s=i.INVALID,r=-1,n=i.INVALID,a=(0,Rt.bo)(e.getValue()),d=0,l=0,c=(e,t)=>{t!==i.INVALID&&1===d&&0===l?(s=t,r=e,n=t):s!==i.INVALID&&(s=i.INVALID,r=a.getTokenOffset())};for(;a.scan()!==Rt.yo.EOF;){let t=a.getPosition(),h=!1;switch(a.getToken()){case Rt.yo.OpenBracketToken:h=!0,d++,c(t,i.BEFORE_OBJECT);break;case Rt.yo.CloseBracketToken:h=!0,d--,c(t,i.INVALID);break;case Rt.yo.CommaToken:h=!0,c(t,i.BEFORE_OBJECT);break;case Rt.yo.OpenBraceToken:h=!0,l++,c(t,i.INVALID);break;case Rt.yo.CloseBraceToken:h=!0,l--,c(t,i.AFTER_OBJECT);break;case Rt.yo.Trivia:case Rt.yo.LineBreakTrivia:h=!0}if(t>=o&&(s!==i.INVALID||-1!==r)){let o,d;return s===i.INVALID?(o=r,d=n):(o=h?t:a.getTokenOffset(),d=s),d===i.AFTER_OBJECT?{position:this.offsetToPosition(e,o),prepend:",",append:""}:(a.setPosition(o),{position:this.offsetToPosition(e,o),prepend:"",append:this.hasOpenBrace(a)?",":""})}}let h=e.getLineCount();return{position:new Rt.SD(h,e.getLineMaxColumn(h)),prepend:"\n[",append:"]"}}};(0,Rt.gD)(),(0,Rt.Fj)(),(0,Rt.q)();var Ha=(0,Rt.J)("settings-folder-dropdown",Rt.mD.chevronDown,(0,Rt.Ij)(9932,"Icon for the folder dropdown button in the split JSON Settings editor."));(0,Rt.J)("settings-more-action",Rt.mD.gear,(0,Rt.Ij)(9933,"Icon for the 'more actions' action in the Settings UI.")),(0,Rt.J)("keybindings-record-keys",Rt.mD.recordKeys,(0,Rt.Ij)(9934,"Icon for the 'record keys' action in the keybinding UI.")),(0,Rt.J)("keybindings-sort",Rt.mD.sortPrecedence,(0,Rt.Ij)(9935,"Icon for the 'sort by precedence' toggle in the keybinding UI.")),(0,Rt.J)("keybindings-edit",Rt.mD.edit,(0,Rt.Ij)(9936,"Icon for the edit action in the keybinding UI.")),(0,Rt.J)("keybindings-add",Rt.mD.add,(0,Rt.Ij)(9937,"Icon for the add action in the keybinding UI.")),(0,Rt.J)("settings-edit",Rt.mD.edit,(0,Rt.Ij)(9938,"Icon for the edit action in the Settings UI.")),(0,Rt.J)("settings-remove",Rt.mD.close,(0,Rt.Ij)(9939,"Icon for the remove action in the Settings UI.")),(0,Rt.J)("settings-discard",Rt.mD.discard,(0,Rt.Ij)(9940,"Icon for the discard action in the Settings UI.")),(0,Rt.J)("preferences-clear-input",Rt.mD.clearAll,(0,Rt.Ij)(9941,"Icon for clear input in the Settings and keybinding UI.")),(0,Rt.J)("preferences-ai-results",Rt.mD.sparkle,(0,Rt.Ij)(9942,"Icon for showing AI results in the Settings UI.")),(0,Rt.J)("preferences-filter",Rt.mD.filter,(0,Rt.Ij)(9943,"Icon for the button that suggests filters for the Settings UI.")),(0,Rt.J)("preferences-open-settings",Rt.mD.goToFile,(0,Rt.Ij)(9944,"Icon for open settings commands.")),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.zT)(),(0,Rt.zr)(),(0,Rt.Hi)(),(0,Rt.da)(),(0,Rt.qp)(),(0,Rt.Mb)(),(0,Rt.gA)(),(0,Rt.Ic)(),(0,Rt.tO)(),(0,Rt.PA)(),(0,Rt.yT)(),(0,Rt.iT)(),(0,Rt.Db)(),(0,Rt.TD)(),(0,Gt.o)(),(0,Rt.lv)(),(0,Rt.uy)(),(0,Rt.Fj)(),(0,Rt.Q_)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Wt.Yh)(),(0,Wt.Np)(),(0,Rt.cr)(),(0,Rt.Kb)(),(0,Rt.Ad)(),(0,Rt.Xa)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.ss)(),(0,Rt.za)(),(0,Pt.k)();var Xa=class extends Rt.Vi{constructor(e,t,i,o){super(null,e),this.contextService=t,this.contextMenuService=i,this.hoverService=o,this._folderSettingCounts=new Map;let s=this.contextService.getWorkspace();this._folder=1===s.folders.length?s.folders[0]:null,this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.onWorkspaceFoldersChanged()))}get folder(){return this._folder}set folder(e){this._folder=e,this.update()}setCount(e,t){let i=this.contextService.getWorkspaceFolder(e);if(!i)throw Error("unknown folder");let o=i.uri;this._folderSettingCounts.set(o.toString(),t),this.update()}render(e){this.element=e,this.container=e,this.labelElement=(0,Rt.Zb)(".action-title"),this.detailsElement=(0,Rt.Zb)(".action-details"),this.dropDownElement=(0,Rt.Zb)(".dropdown-icon.hide"+Rt.Eb.asCSSSelector(Ha)),this.anchorElement=(0,Rt.Zb)("a.action-label.folder-settings",{role:"button","aria-haspopup":"true",tabindex:"0"},this.labelElement,this.detailsElement,this.dropDownElement),this.anchorElementHover=this._register(this.hoverService.setupManagedHover((0,Rt.ua)("mouse"),this.anchorElement,"")),this._register((0,Rt.ox)(this.anchorElement,Rt.tx.MOUSE_DOWN,e=>Rt.ex.stop(e))),this._register((0,Rt.ox)(this.anchorElement,Rt.tx.CLICK,e=>this.onClick(e))),this._register((0,Rt.ox)(this.container,Rt.tx.KEY_UP,e=>this.onKeyUp(e))),(0,Rt.dx)(this.container,this.anchorElement),this.update()}onKeyUp(e){switch(new Rt.RT(e).keyCode){case Rt.YD.Enter:case Rt.YD.Space:return void this.onClick(e)}}onClick(e){Rt.ex.stop(e,!0),!this.folder||this._action.checked?this.showMenu():this._action.run(this._folder)}updateEnabled(){this.update()}updateChecked(){this.update()}onWorkspaceFoldersChanged(){let e=this._folder,t=this.contextService.getWorkspace();e&&(this._folder=t.folders.filter(t=>(0,Rt.oT)(t.uri,e.uri))[0]||t.folders[0]),this._folder=this._folder?this._folder:1===t.folders.length?t.folders[0]:null,this.update(),this._action.checked&&this._action.run(this._folder)}update(){let e=0;this._folderSettingCounts.forEach(t=>e+=t);let t=this.contextService.getWorkspace();if(this._folder){this.labelElement.textContent=this._folder.name,this.anchorElementHover.update(this._folder.name);let i=this.labelWithCount(this._action.label,e);this.detailsElement.textContent=i,this.dropDownElement.classList.toggle("hide",1===t.folders.length||!this._action.checked)}else{let t=this.labelWithCount(this._action.label,e);this.labelElement.textContent=t,this.detailsElement.textContent="",this.anchorElementHover.update(this._action.label),this.dropDownElement.classList.remove("hide")}this.anchorElement.classList.toggle("checked",this._action.checked),this.container.classList.toggle("disabled",!this._action.enabled)}showMenu(){this.contextMenuService.showContextMenu({getAnchor:()=>this.container,getActions:()=>this.getDropdownMenuActions(),getActionViewItem:()=>{},onHide:()=>{this.anchorElement.blur()}})}getDropdownMenuActions(){let e=[],t=this.contextService.getWorkspace().folders;return this.contextService.getWorkbenchState()===Rt.rs.WORKSPACE&&t.length>0&&e.push(...t.map((e,t)=>{let i=this._folderSettingCounts.get(e.uri.toString());return{id:"folderSettingsTarget"+t,label:this.labelWithCount(e.name,i),tooltip:this.labelWithCount(e.name,i),checked:!!this.folder&&(0,Rt.oT)(this.folder.uri,e.uri),enabled:!0,class:void 0,run:()=>this._action.run(e)}})),e}labelWithCount(e,t){return t&&(e+=" (".concat(t,")")),e}};Xa=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ra),(0,Rt.Fb)(2,Rt.Sl),(0,Rt.Fb)(3,Rt.sr)],Xa);var Ua=class extends Rt.Kp{constructor(e,t,i,o,s,r,n){super(),this.contextService=i,this.instantiationService=o,this.environmentService=s,this.labelService=r,this.languageService=n,this._settingsTarget=null,this._onDidTargetChange=this._register(new Rt.uA),this.onDidTargetChange=this._onDidTargetChange.event,this.options=null!==t&&void 0!==t?t:{},this.create(e),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onWorkbenchStateChanged())),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.update()))}resetLabels(){let e=this.environmentService.remoteAuthority,t=e&&this.labelService.getHostLabel(Rt.vT.vscodeRemote,e);this.userLocalSettings.label=(0,Rt.Ij)(9964,"User"),this.userRemoteSettings.label=(0,Rt.Ij)(9965,"Remote")+(t?" [".concat(t,"]"):""),this.workspaceSettings.label=(0,Rt.Ij)(9966,"Workspace"),this.folderSettingsAction.label=(0,Rt.Ij)(9967,"Folder")}create(e){let t=(0,Rt.dx)(e,(0,Rt.Zb)(".settings-tabs-widget"));this.settingsSwitcherBar=this._register(new Rt.Lr(t,{orientation:Rt.Rr.HORIZONTAL,focusOnlyEnabledItems:!0,ariaLabel:(0,Rt.Ij)(9968,"Settings Switcher"),ariaRole:"tablist",actionViewItemProvider:(e,t)=>"folderSettings"===e.id?this.folderSettings:void 0})),this.userLocalSettings=this._register(new Rt.Ob("userSettings","",".settings-tab",!0,()=>this.updateTarget(Rt.X_.USER_LOCAL))),this.userLocalSettings.tooltip=(0,Rt.Ij)(9964,"User"),this.userRemoteSettings=this._register(new Rt.Ob("userSettingsRemote","",".settings-tab",!0,()=>this.updateTarget(Rt.X_.USER_REMOTE)));let i=this.environmentService.remoteAuthority,o=i&&this.labelService.getHostLabel(Rt.vT.vscodeRemote,i);this.userRemoteSettings.tooltip=(0,Rt.Ij)(9965,"Remote")+(o?" [".concat(o,"]"):""),this.workspaceSettings=this._register(new Rt.Ob("workspaceSettings","",".settings-tab",!1,()=>this.updateTarget(Rt.X_.WORKSPACE))),this.folderSettingsAction=this._register(new Rt.Ob("folderSettings","",".settings-tab",!1,async e=>{this.updateTarget((0,Rt.hs)(e)?e.uri:Rt.X_.USER_LOCAL)})),this.folderSettings=this._register(this.instantiationService.createInstance(Xa,this.folderSettingsAction)),this.resetLabels(),this.update(),this.settingsSwitcherBar.push([this.userLocalSettings,this.userRemoteSettings,this.workspaceSettings,this.folderSettingsAction])}get settingsTarget(){return this._settingsTarget}set settingsTarget(e){this._settingsTarget=e,this.userLocalSettings.checked=Rt.X_.USER_LOCAL===this.settingsTarget,this.userRemoteSettings.checked=Rt.X_.USER_REMOTE===this.settingsTarget,this.workspaceSettings.checked=Rt.X_.WORKSPACE===this.settingsTarget,this.settingsTarget instanceof Rt.wD?(this.folderSettings.action.checked=!0,this.folderSettings.folder=this.contextService.getWorkspaceFolder(this.settingsTarget)):this.folderSettings.action.checked=!1}setResultCount(e,t){if(e===Rt.X_.WORKSPACE){let e=(0,Rt.Ij)(9966,"Workspace");t&&(e+=" (".concat(t,")")),this.workspaceSettings.label=e}else if(e===Rt.X_.USER_LOCAL){let e=(0,Rt.Ij)(9964,"User");t&&(e+=" (".concat(t,")")),this.userLocalSettings.label=e}else e instanceof Rt.wD&&this.folderSettings.setCount(e,t)}updateLanguageFilterIndicators(e){if(this.resetLabels(),e){let t=this.languageService.getLanguageName(e);if(t){let e=" [".concat(t,"]");this.userLocalSettings.label+=e,this.userRemoteSettings.label+=e,this.workspaceSettings.label+=e,this.folderSettingsAction.label+=e}}}onWorkbenchStateChanged(){this.folderSettings.folder=null,this.update(),this.settingsTarget===Rt.X_.WORKSPACE&&this.contextService.getWorkbenchState()===Rt.rs.WORKSPACE&&this.updateTarget(Rt.X_.USER_LOCAL)}updateTarget(e){return this.settingsTarget===e||e instanceof Rt.wD&&this.settingsTarget instanceof Rt.wD&&(0,Rt.oT)(this.settingsTarget,e)||(this.settingsTarget=e,this._onDidTargetChange.fire(this.settingsTarget)),Promise.resolve(void 0)}async update(){this.settingsSwitcherBar.domNode.classList.toggle("empty-workbench",this.contextService.getWorkbenchState()===Rt.rs.EMPTY),this.userRemoteSettings.enabled=!(!this.options.enableRemoteSettings||!this.environmentService.remoteAuthority),this.workspaceSettings.enabled=this.contextService.getWorkbenchState()!==Rt.rs.EMPTY,this.folderSettings.action.enabled=this.contextService.getWorkbenchState()===Rt.rs.WORKSPACE&&this.contextService.getWorkspace().folders.length>0,this.workspaceSettings.tooltip=(0,Rt.Ij)(9966,"Workspace")}};Ua=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Ra),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Pt.O),(0,Rt.Fb)(5,Rt.Ya),(0,Rt.Fb)(6,Rt.cv)],Ua);var za,qa,$a=class extends Rt.Kp{get onDidChange(){return this._onDidChange.event}get onFocus(){return this._onFocus.event}constructor(e,t,i,o,s,r){super(),this.options=t,this.contextViewService=i,this.instantiationService=o,this.contextKeyService=s,this.keybindingService=r,this._onDidChange=this._register(new Rt.uA),this._onFocus=this._register(new Rt.uA),this.create(e)}create(e){this.domNode=(0,Rt.dx)(e,(0,Rt.Zb)("div.settings-header-widget")),this.createSearchContainer((0,Rt.dx)(this.domNode,(0,Rt.Zb)("div.settings-search-container"))),this.controlsDiv=(0,Rt.dx)(this.domNode,(0,Rt.Zb)("div.settings-search-controls")),this.options.showResultCount&&(this.countElement=(0,Rt.dx)(this.controlsDiv,(0,Rt.Zb)(".settings-count-widget")),this.countElement.style.backgroundColor=(0,Rt.kg)(Rt.fg),this.countElement.style.color=(0,Rt.kg)(Rt.pg),this.countElement.style.border="1px solid ".concat((0,Rt.kg)(Rt._g))),this.inputBox.inputElement.setAttribute("aria-live",this.options.ariaLive||"off"),this.options.ariaLabelledBy&&this.inputBox.inputElement.setAttribute("aria-labelledBy",this.options.ariaLabelledBy);let t=this._register((0,Rt.AS)(this.inputBox.inputElement));this._register(t.onDidFocus(()=>this._onFocus.fire()));let i=this.options.focusKey;i&&(this._register(t.onDidFocus(()=>i.set(!0))),this._register(t.onDidBlur(()=>i.set(!1))))}createSearchContainer(e){this.searchContainer=e;let t=(0,Rt.dx)(this.searchContainer,(0,Rt.Zb)("div.settings-search-input"));this.inputBox=this._register(this.createInputBox(t)),this._register(this.inputBox.onDidChange(e=>this._onDidChange.fire(e)))}createInputBox(e){return new Wt.Jh(e,this.contextViewService,(0,xt.A)((0,xt.A)({},this.options),{},{showHistoryHint:()=>(0,Wt.Pp)(this.keybindingService)}),this.contextKeyService)}showMessage(e){this.countElement&&e!==this.countElement.textContent&&(this.countElement.textContent=e,this.inputBox.inputElement.setAttribute("aria-label",e),this.inputBox.inputElement.style.paddingRight=this.getControlsWidth()+"px")}layout(e){var t,i;e.width<400?(null!==(t=this.countElement)&&void 0!==t&&t.classList.add("hide"),this.inputBox.inputElement.style.paddingRight="0px"):(null!==(i=this.countElement)&&void 0!==i&&i.classList.remove("hide"),this.inputBox.inputElement.style.paddingRight=this.getControlsWidth()+"px")}getControlsWidth(){return(this.countElement?(0,Rt.zx)(this.countElement):0)+20}focus(){this.inputBox.focus(),this.getValue()&&this.inputBox.select()}hasFocus(){return this.inputBox.hasFocus()}clear(){this.inputBox.value=""}getValue(){return this.inputBox.value}setValue(e){return this.inputBox.value=e}dispose(){var e;null!==(e=this.options.focusKey)&&void 0!==e&&e.set(!1),super.dispose()}};$a=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Cl),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Rt.yb),(0,Rt.Fb)(5,Rt.kd)],$a),(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.mj)(),(0,Rt.PA)(),(0,Rt.gA)(),(0,Rt.vn)(),(0,Rt.qp)(),(0,Rt.tO)(),(0,Rt.qx)(),(0,Rt.r_)(),(0,Rt.zT)(),(0,Rt.Xb)(),(0,Rt.Ad)(),(0,Rt.wl)(),(0,Rt.Kb)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.pv)(),(0,Rt.Iw)(),(0,Rt.bb)(),(0,Rt.Mi)(),(0,Rt.mE)({});var ed=class extends $a{constructor(e,t,i,o,s,r){super(e,t,i,o,s,r),this.recordDisposables=this._register(new Rt.EA),this._onKeybinding=this._register(new Rt.uA),this.onKeybinding=this._onKeybinding.event,this._onEnter=this._register(new Rt.uA),this.onEnter=this._onEnter.event,this._onEscape=this._register(new Rt.uA),this.onEscape=this._onEscape.event,this._onBlur=this._register(new Rt.uA),this.onBlur=this._onBlur.event,this._register((0,Rt.zA)(()=>this.stopRecordingKeys())),this._chords=null,this._inputValue=""}clear(){this._chords=null,super.clear()}startRecordingKeys(){this.recordDisposables.add((0,Rt.ox)(this.inputBox.inputElement,Rt.tx.KEY_DOWN,e=>this._onKeyDown(new Rt.RT(e)))),this.recordDisposables.add((0,Rt.ox)(this.inputBox.inputElement,Rt.tx.BLUR,()=>this._onBlur.fire())),this.recordDisposables.add((0,Rt.ox)(this.inputBox.inputElement,Rt.tx.INPUT,()=>{this.setInputValue(this._inputValue)}))}stopRecordingKeys(){this._chords=null,this.recordDisposables.clear()}setInputValue(e){this._inputValue=e,this.inputBox.value=this._inputValue}_onKeyDown(e){e.preventDefault(),e.stopPropagation(),this.options.recordEnter||!e.equals(Rt.YD.Enter)?e.equals(Rt.YD.Escape)?this._onEscape.fire():this.printKeybinding(e):this._onEnter.fire()}printKeybinding(e){let t=this.keybindingService.resolveKeyboardEvent(e),i="code: ".concat(e.browserEvent.code,", keyCode: ").concat(e.browserEvent.keyCode,", key: ").concat(e.browserEvent.key," => UI: ").concat(t.getAriaLabel(),", user settings: ").concat(t.getUserSettingsLabel(),", dispatch: ").concat(t.getDispatchChords()[0]),o=this.options;this._chords||(this._chords=[]),this._chords.length>0&&null===this._chords[this._chords.length-1].getDispatchChords()[0]?this._chords[this._chords.length-1]=t:(2===this._chords.length&&(this._chords=[]),this._chords.push(t));let s=this._chords.map(e=>e.getUserSettingsLabel()||"").join(" ");this.setInputValue(o.quoteRecordedKeys?'"'.concat(s,'"'):s),this.inputBox.inputElement.title=i,this._onKeybinding.fire(this._chords)}};ed=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Cl),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Rt.yb),(0,Rt.Fb)(5,Rt.kd)],ed);var td=(z=class extends Rt.Kp{constructor(e,t){super(),this.instantiationService=t,this._keybindingDisposables=this._register(new Rt.EA),this._chords=null,this._isVisible=!1,this._onHide=this._register(new Rt.uA),this._onDidChange=this._register(new Rt.uA),this.onDidChange=this._onDidChange.event,this._onShowExistingKeybindings=this._register(new Rt.uA),this.onShowExistingKeybidings=this._onShowExistingKeybindings.event,this._domNode=(0,Rt.Yb)((0,Rt.gx)("div")),this._domNode.setDisplay("none"),this._domNode.setClassName("defineKeybindingWidget"),this._domNode.setWidth(za.WIDTH),this._domNode.setHeight(za.HEIGHT);let i=(0,Rt.Ij)(9834,"Press desired key combination and then press ENTER.");(0,Rt.dx)(this._domNode.domNode,(0,Rt.Zb)(".message",void 0,i)),this._domNode.domNode.style.backgroundColor=(0,Rt.kg)(Rt.tg),this._domNode.domNode.style.color=(0,Rt.kg)(Rt.rg),this._domNode.domNode.style.boxShadow="0 2px 8px ".concat((0,Rt.kg)(Rt.dg)),this._keybindingInputWidget=this._register(this.instantiationService.createInstance(ed,this._domNode.domNode,{ariaLabel:i,history:new Set([]),inputBoxStyles:Rt.Ti})),this._keybindingInputWidget.startRecordingKeys(),this._register(this._keybindingInputWidget.onKeybinding(e=>this.onKeybinding(e))),this._register(this._keybindingInputWidget.onEnter(()=>this.hide())),this._register(this._keybindingInputWidget.onEscape(()=>this.clearOrHide())),this._register(this._keybindingInputWidget.onBlur(()=>this.onCancel())),this._outputNode=(0,Rt.dx)(this._domNode.domNode,(0,Rt.Zb)(".output")),this._showExistingKeybindingsNode=(0,Rt.dx)(this._domNode.domNode,(0,Rt.Zb)(".existing")),e&&(0,Rt.dx)(e,this._domNode.domNode)}get domNode(){return this._domNode.domNode}define(){return this._keybindingInputWidget.clear(),Rt.yw.withAsyncBody(async e=>{this._isVisible||(this._isVisible=!0,this._domNode.setDisplay("block"),this._chords=null,this._keybindingInputWidget.setInputValue(""),(0,Rt.fx)(this._outputNode),(0,Rt.fx)(this._showExistingKeybindingsNode),await(0,Rt.Gw)(0),this._keybindingInputWidget.focus());let t=this._onHide.event(()=>{e(this.getUserSettingsLabel()),t.dispose()})})}layout(e){let t=Math.round((e.height-za.HEIGHT)/2);this._domNode.setTop(t);let i=Math.round((e.width-za.WIDTH)/2);this._domNode.setLeft(i)}printExisting(e){if(e>0){let t=(0,Rt.Zb)("span.existingText"),i=1===e?(0,Rt.Ij)(9835,"1 existing command has this keybinding",e):(0,Rt.Ij)(9836,"{0} existing commands have this keybinding",e);(0,Rt.dx)(t,(0,Rt.bx)(i)),(0,Rt.n_)(i),this._showExistingKeybindingsNode.appendChild(t),t.onmousedown=e=>{e.preventDefault()},t.onmouseup=e=>{e.preventDefault()},t.onclick=()=>{this._onShowExistingKeybindings.fire(this.getUserSettingsLabel())}}}onKeybinding(e){var t,i;if(this._keybindingDisposables.clear(),this._chords=e,(0,Rt.fx)(this._outputNode),(0,Rt.fx)(this._showExistingKeybindingsNode),this._keybindingDisposables.add(new Rt._n(this._outputNode,Rt.uj,Rt.Ei)).set(null!==(t=null===(i=this._chords)||void 0===i?void 0:i[0])&&void 0!==t?t:void 0),this._chords)for(let s=1;s<this._chords.length;s++)this._outputNode.appendChild((0,Rt.bx)((0,Rt.Ij)(9837,"chord to"))),this._keybindingDisposables.add(new Rt._n(this._outputNode,Rt.uj,Rt.Ei)).set(this._chords[s]);let o=this.getUserSettingsLabel();o&&this._onDidChange.fire(o)}getUserSettingsLabel(){let e=null;return this._chords&&(e=this._chords.map(e=>e.getUserSettingsLabel()).join(" ")),e}onCancel(){this._chords=null,this.hide()}clearOrHide(){null===this._chords?this.hide():(this._chords=null,this._keybindingInputWidget.clear(),(0,Rt.fx)(this._outputNode),(0,Rt.fx)(this._showExistingKeybindingsNode))}hide(){this._domNode.setDisplay("none"),this._isVisible=!1,this._onHide.fire()}},{_:za=z},{_:z.WIDTH=400},{_:z.HEIGHT=110},z);td=za=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub)],td);var id,od,sd=(q=class extends Rt.CA{constructor(e,t){super(),this._editor=e,this._widget=this._register(t.createInstance(td,null)),this._editor.addOverlayWidget(this)}getId(){return qa.ID}getDomNode(){return this._widget.domNode}getPosition(){return{preference:null}}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}start(){this._editor.hasModel()&&this._editor.revealPositionInCenterIfOutsideViewport(this._editor.getPosition(),Rt.fv.Smooth);let e=this._editor.getLayoutInfo();return this._widget.layout(new Rt.Qb(e.width,e.height)),this._widget.define()}},{_:qa=q},{_:q.ID="editor.contrib.defineKeybindingWidget"},q);sd=qa=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub)],sd),(0,Pt.en)(),function(e){e.Null="null",e.Enum="enum",e.String="string",e.MultilineString="multiline-string",e.Integer="integer",e.Number="number",e.Boolean="boolean",e.Array="array",e.Exclude="exclude",e.Include="include",e.Complex="complex",e.NullableInteger="nullable-integer",e.NullableNumber="nullable-number",e.Object="object",e.BooleanObject="boolean-object",e.LanguageTag="language-tag",e.ExtensionToggle="extension-toggle",e.ComplexObject="complex-object"}(id||(id={})),function(e){e[e.None=0]="None",e[e.LanguageTagSettingMatch=1]="LanguageTagSettingMatch",e[e.RemoteMatch=2]="RemoteMatch",e[e.NonContiguousQueryInSettingId=4]="NonContiguousQueryInSettingId",e[e.DescriptionOrValueMatch=8]="DescriptionOrValueMatch",e[e.NonContiguousWordsInSettingsLabel=16]="NonContiguousWordsInSettingsLabel",e[e.ContiguousWordsInSettingsLabel=32]="ContiguousWordsInSettingsLabel",e[e.ContiguousQueryInSettingId=64]="ContiguousQueryInSettingId",e[e.AllWordsInSettingsLabel=128]="AllWordsInSettingsLabel",e[e.ExactMatch=256]="ExactMatch"}(od||(od={})),od.AllWordsInSettingsLabel,od.ContiguousWordsInSettingsLabel,od.NonContiguousWordsInSettingsLabel,od.NonContiguousQueryInSettingId,od.ContiguousQueryInSettingId;(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.Iw)(),(0,Rt.Ic)(),(0,Rt.PA)(),(0,Rt.Ad)(),(0,Rt.Kb)(),(0,Rt.xD)(),(0,Rt.Wy)(),(0,Wt.Vh)(),(0,Rt.Co)(),(0,Rt.dp)(),(0,Rt.np)(),(0,Rt.uy)(),(0,Rt.nM)(),(0,Rt.iT)(),(0,Wt.A_)();var rd,nd=(0,Rt.Ij)(9871,"You won't be able to produce this key combination under your current keyboard layout."),ad=class extends Rt.CA{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._userDataProfileService=i,this._keybindingDecorationRenderer=this._register(new Rt.OA),this._defineWidget=this._register(this._instantiationService.createInstance(sd,this._editor)),this._register(this._editor.onDidChangeModel(e=>this._update())),this._update()}_update(){this._keybindingDecorationRenderer.value=ld(this._editor,this._userDataProfileService)?this._instantiationService.createInstance(dd,this._editor):void 0}showDefineKeybindingWidget(){ld(this._editor,this._userDataProfileService)&&this._defineWidget.start().then(e=>this._onAccepted(e))}_onAccepted(e){if(this._editor.focus(),e&&this._editor.hasModel()){var t;new RegExp(/\\/g).test(e)&&(e=e.slice(0,-1)+"\\\\");let i=["{",'\t"key": '+JSON.stringify(e)+",",'\t"command": "${1:commandId}",','\t"when": "${2:editorTextFocus}"',"}$0"].join("\n"),o=Ya.insertSnippet(this._editor.getModel(),this._editor.getPosition());i=o.prepend+i+o.append,this._editor.setPosition(o.position),null===(t=Wt.Bh.get(this._editor))||void 0===t||t.insert(i,{overwriteBefore:0,overwriteAfter:0})}}};ad=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Wt.k_)],ad);var dd=rd=class extends Rt.CA{constructor(e,t){super(),this._editor=e,this._keybindingService=t,this._dec=this._editor.createDecorationsCollection(),this._updateDecorations=this._register(new Rt.Sw(()=>this._updateDecorationsNow(),500));let i=(0,Rt.$j)(this._editor.getModel());this._register(i.onDidChangeContent(()=>this._updateDecorations.schedule())),this._register(this._keybindingService.onDidUpdateKeybindings(()=>this._updateDecorations.schedule())),this._register({dispose:()=>{this._dec.clear(),this._updateDecorations.cancel()}}),this._updateDecorations.schedule()}_updateDecorationsNow(){let e=(0,Rt.$j)(this._editor.getModel()),t=[],i=(0,Rt.To)(e.getValue());if(i&&Array.isArray(i.children))for(let o=0,s=i.children.length;o<s;o++){let s=i.children[o],r=this._getDecorationForEntry(e,s);null!==r&&t.push(r)}this._dec.set(t)}_getDecorationForEntry(e,t){if(!Array.isArray(t.children))return null;for(let i=0,o=t.children.length;i<o;i++){let o=t.children[i];if("property"!==o.type||!Array.isArray(o.children)||2!==o.children.length||"key"!==o.children[0].value)continue;let s=o.children[1];if("string"!==s.type)continue;let r=this._keybindingService.resolveUserBinding(s.value);if(0===r.length)return this._createDecoration(!0,null,null,e,s);let n=r[0],a=null;if(n instanceof Ta&&(a=n.getUSLabel()),!n.isWYSIWYG()){let t=n.getLabel();return"string"==typeof t&&s.value.toLowerCase()===t.toLowerCase()?null:this._createDecoration(!1,n.getLabel(),a,e,s)}if(/abnt_|oem_/.test(s.value))return this._createDecoration(!1,n.getLabel(),a,e,s);let d=n.getUserSettingsLabel();return"string"!=typeof d||rd._userSettingsFuzzyEquals(s.value,d)?null:this._createDecoration(!1,n.getLabel(),a,e,s)}return null}static _userSettingsFuzzyEquals(e,t){if((e=e.trim().toLowerCase())===(t=t.trim().toLowerCase()))return!0;let i=oa.parseKeybinding(e),o=oa.parseKeybinding(t);return null===i&&null===o||!(!i||!o)&&i.equals(o)}_createDecoration(e,t,i,o,s){let r,n,a;e?(r=(new Rt.Pc).appendText(nd),n="keybindingError",a=(0,Rt.pp)(Rt.rp)):(r=i&&t!==i?new Rt.Pc((0,Rt.Ij)(9872,"**{0}** for your current keyboard layout (**{1}** for US standard).",t,i)):new Rt.Pc((0,Rt.Ij)(9873,"**{0}** for your current keyboard layout.",t)),n="keybindingInfo",a=(0,Rt.pp)(Rt.ip));let d=o.getPositionAt(s.offset),l=o.getPositionAt(s.offset+s.length);return{range:new Rt.bD(d.lineNumber,d.column,l.lineNumber,l.column),options:{description:"keybindings-widget",stickiness:Rt.ly.NeverGrowsWhenTypingAtEdges,className:n,hoverMessage:r,overviewRuler:{color:a,position:Rt.ay.Right}}}}};function ld(e,t){let i=e.getModel();return!!i&&(0,Rt.oT)(i.uri,t.currentProfile.keybindingsResource)}dd=rd=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.kd)],dd),(0,Rt.Jy)("editor.contrib.defineKeybinding",ad,Rt.Ly.AfterFirstRender),(0,Rt.qj)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.wb)(),(0,Rt.nb)(),(0,Rt.Rd)(),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"runCommands",title:(0,Rt.Lj)(6279,"Run Commands"),f1:!1,metadata:{description:(0,Rt.Ij)(6280,"Run several commands"),args:[{name:"args",schema:{type:"object",required:["commands"],properties:{commands:{type:"array",description:(0,Rt.Ij)(6281,"Commands to run"),items:{anyOf:[{$ref:"vscode://schemas/keybindings#/definitions/commandNames"},{type:"string"},{type:"object",required:["command"],properties:{command:{anyOf:[{$ref:"vscode://schemas/keybindings#/definitions/commandNames"},{type:"string"}]}},$ref:"vscode://schemas/keybindings#/definitions/commandsSchemas"}]}}}}}]}})}async run(e,t){let i=e.get(Rt.Ld);if(!this._isCommandArgs(t))return void i.error((0,Rt.Ij)(6282,"'runCommands' has received an argument with incorrect type. Please, review the argument passed to the command."));if(0===t.commands.length)return void i.warn((0,Rt.Ij)(6283,"'runCommands' has not received commands to run. Did you forget to pass commands in the 'runCommands' argument?"));let o=e.get(Rt.Cb),s=e.get(Rt.eb),r=0;try{for(;r<t.commands.length;++r){let e=t.commands[r];s.debug("runCommands: executing ".concat(r,"-th command: ").concat((0,Rt.Xj)(e))),await this._runCommand(o,e),s.debug("runCommands: executed ".concat(r,"-th command"))}}catch(e){s.debug("runCommands: executing ".concat(r,"-th command resulted in an error: ").concat(e instanceof Error?e.message:(0,Rt.Xj)(e))),i.error(e)}}_isCommandArgs(e){if(!e||"object"!=typeof e||!("commands"in e)||!Array.isArray(e.commands))return!1;for(let t of e.commands)if("string"!=typeof t&&("object"!=typeof t||"string"!=typeof t.command))return!1;return!0}_runCommand(e,t){let i,o;return"string"==typeof t?i=t:(i=t.command,o=t.args),void 0===o?e.executeCommand(i):Array.isArray(o)?e.executeCommand(i,...o):e.executeCommand(i,o)}}),(0,Rt.Ib)(),(0,Rt.sm)(),(0,Rt.Ad)(),(0,Rt.XC)(),(0,Kt.o)(),(0,Tt.Zn)(),(0,Rt.bs)(),(0,Rt.wb)(),(0,Rt.PA)(),(0,Rt.kc)(),(0,Rt.bb)(),(0,Rt.Qo)(),(0,Rt.ab)(),(0,Rt.Rd)(),(0,Wt.A_)(),(0,Lt.F)(),(0,Nt.Ot)(),(0,Rt.nb)(),(0,Rt.yT)(),(0,Rt.TD)(),(0,Nt.a)(),(0,Tt.xt)(),(0,Tt.n)(),Rt.wD.from({scheme:Rt.vT.vscodeUserData,path:"/User/keybindings.json"});var cd=class extends fa{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u){super(i,o,s,r,n,a,d,l,c,h,u),this.shouldUseGlobalKeybindings=e,this._lockKeyCodesOverride=t,this.keybindingProviders=[],this.authorizedContainers=[]}registerKeybindingProvider(e){this.keybindingProviders.push(e),this.updateResolver();let t=new Rt.EA;return t.add(e.onDidChangeKeybindings(()=>{this.updateResolver()})),t.add((0,Rt.zA)(()=>{let t=this.keybindingProviders.indexOf(e);t>=0&&(this.keybindingProviders.splice(t,1),this.updateResolver())})),t}_getResolver(){return super._getResolver()}registerContainer(e){let t=new Rt.EA;return t.add(super.registerContainer(e)),this.authorizedContainers.push(e),t.add((0,Rt.zA)(()=>{this.authorizedContainers=this.authorizedContainers.filter(t=>t!=e)})),t}_dispatch(e,t){return!(!this.shouldUseGlobalKeybindings()&&this.authorizedContainers.every(t=>!t.contains(e.target)))&&super._dispatch(e,t)}getUserKeybindingItems(){return[...super.getUserKeybindingItems(),...this.keybindingProviders.flatMap(e=>e.provideKeybindings())]}lockKeyCodes(e){this._lockKeyCodesOverride(e,e=>super.lockKeyCodes(e))}};function hd(){let{shouldUseGlobalKeybindings:e=()=>!1,lockKeyCodesOverride:t=(e,t)=>{t(e)}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,xt.A)((0,xt.A)({},(0,Nt.r)()),{},{[Rt.kd.toString()]:new Rt.om(cd,[e,t],!1),[Tt.Xn.toString()]:new Rt.om(Ka,[],!0),[Rt.Cb.toString()]:new Rt.om(Qa,[],!0)})}function ud(e){return"".concat(e,".hidden")}cd=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.yb),(0,Rt.Fb)(3,Rt.Cb),(0,Rt.Fb)(4,Rt.ib),(0,Rt.Fb)(5,Rt.Ld),(0,Rt.Fb)(6,Wt.k_),(0,Rt.Fb)(7,Lt.P),(0,Rt.Fb)(8,Nt.Dt),(0,Rt.Fb)(9,Rt.ys),(0,Rt.Fb)(10,Rt.Zo),(0,Rt.Fb)(11,Rt.eb),(0,Rt.Fb)(12,Tt.Xn)],cd),(0,Rt.Ib)(),(0,Wt.Df)(),(0,Rt.bb)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.vb)(),(0,Rt.PA)(),(0,Rt.gA)(),(0,Rt.Kb)(),(0,Rt.TD)(),(0,Rt.WM)(),(0,Rt.nM)(),(0,Rt.iT)(),(0,Rt.Db)(),(0,Rt.nb)(),(0,Rt.QA)(),(0,Rt.Mk)(),(0,Tt.un)();var gd=class extends Rt.CA{constructor(e,t,i,o){super(),this.viewContainerName=t,this.storageService=i,this._onDidChangeStoredState=this._register(new Rt.uA),this.onDidChangeStoredState=this._onDidChangeStoredState.event,this.logger=new Rt.jk(()=>o.createLogger(Wt.bf,{name:Wt.xf,group:Tt.fn})),this.globalViewsStateStorageId=ud(e),this.workspaceViewsStateStorageId=e,this._register(this.storageService.onDidChangeValue(Rt.Go.PROFILE,this.globalViewsStateStorageId,this._store)(()=>this.onDidStorageChange())),this.state=this.initialize()}set(e,t){this.state.set(e,t)}get(e){return this.state.get(e)}updateState(e){this.updateWorkspaceState(e),this.updateGlobalState(e)}updateWorkspaceState(e){let t=this.getStoredWorkspaceState();for(let i of e){let e=this.get(i.id);e&&(t[i.id]={collapsed:!!e.collapsed,isHidden:!e.visibleWorkspace,size:e.size,order:i.workspace&&e?e.order:void 0})}Object.keys(t).length>0?this.storageService.store(this.workspaceViewsStateStorageId,JSON.stringify(t),Rt.Go.WORKSPACE,Rt.Ko.MACHINE):this.storageService.remove(this.workspaceViewsStateStorageId,Rt.Go.WORKSPACE)}updateGlobalState(e){let t=this.getStoredGlobalState();for(let i of e){let e=this.get(i.id);t.set(i.id,{id:i.id,isHidden:!(!e||!i.canToggleVisibility)&&!e.visibleGlobal,order:!i.workspace&&e?e.order:void 0})}this.setStoredGlobalState(t)}onDidStorageChange(){if(this.globalViewsStatesValue!==this.getStoredGlobalViewsStatesValue()){this._globalViewsStatesValue=void 0;let e=this.getStoredGlobalState(),t=this.getStoredWorkspaceState(),i=[];for(let[o,s]of e){let e=this.get(o);if(e)e.visibleGlobal!==!s.isHidden&&(s.isHidden||this.logger.value.trace("View visibility state changed: ".concat(o," is now visible"),this.viewContainerName),i.push({id:o,visible:!s.isHidden}));else{let e=t[o];this.set(o,{active:!1,visibleGlobal:!s.isHidden,visibleWorkspace:(0,Rt.fM)(null===e||void 0===e?void 0:e.isHidden)?void 0:!(null!==e&&void 0!==e&&e.isHidden),collapsed:null===e||void 0===e?void 0:e.collapsed,order:null===e||void 0===e?void 0:e.order,size:null===e||void 0===e?void 0:e.size})}}if(i.length){this._onDidChangeStoredState.fire(i);for(let e of i){let t=this.get(e.id);t&&(t.visibleGlobal=e.visible)}}}}initialize(){let e=new Map,t=this.getStoredWorkspaceState();for(let n of Object.keys(t)){let i=t[n];e.set(n,{active:!1,visibleGlobal:void 0,visibleWorkspace:(0,Rt.fM)(i.isHidden)?void 0:!i.isHidden,collapsed:i.collapsed,order:i.order,size:i.size})}let i=this.storageService.get(this.globalViewsStateStorageId,Rt.Go.WORKSPACE,"[]"),{state:o}=this.parseStoredGlobalState(i);if(o.size>0){for(let{id:t,isHidden:i}of o.values()){let o=e.get(t);o?(0,Rt.fM)(o.visibleWorkspace)&&(o.visibleWorkspace=!i):e.set(t,{active:!1,collapsed:void 0,visibleGlobal:void 0,visibleWorkspace:!i})}this.storageService.remove(this.globalViewsStateStorageId,Rt.Go.WORKSPACE)}let{state:s,hasDuplicates:r}=this.parseStoredGlobalState(this.globalViewsStatesValue);r&&this.setStoredGlobalState(s);for(let{id:n,isHidden:a,order:d}of s.values()){let t=e.get(n);t?(t.visibleGlobal=!a,(0,Rt.fM)(d)||(t.order=d)):e.set(n,{active:!1,visibleGlobal:!a,order:d,collapsed:void 0,visibleWorkspace:void 0})}return e}getStoredWorkspaceState(){return JSON.parse(this.storageService.get(this.workspaceViewsStateStorageId,Rt.Go.WORKSPACE,"{}"))}getStoredGlobalState(){return this.parseStoredGlobalState(this.globalViewsStatesValue).state}setStoredGlobalState(e){this.globalViewsStatesValue=JSON.stringify([...e.values()])}parseStoredGlobalState(e){let t=JSON.parse(e),i=!1;return{state:t.reduce((e,t)=>("string"==typeof t?(i||(i=e.has(t)),e.set(t,{id:t,isHidden:!0})):(i||(i=e.has(t.id)),e.set(t.id,t)),e),new Map),hasDuplicates:i}}get globalViewsStatesValue(){return this._globalViewsStatesValue||(this._globalViewsStatesValue=this.getStoredGlobalViewsStatesValue()),this._globalViewsStatesValue}set globalViewsStatesValue(e){this.globalViewsStatesValue!==e&&(this._globalViewsStatesValue=e,this.setStoredGlobalViewsStatesValue(e))}getStoredGlobalViewsStatesValue(){return this.storageService.get(this.globalViewsStateStorageId,Rt.Go.PROFILE,"[]")}setStoredGlobalViewsStatesValue(e){this.storageService.store(this.globalViewsStateStorageId,e,Rt.Go.PROFILE,Rt.Ko.USER)}};gd=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Uo),(0,Rt.Fb)(3,Rt.tb)],gd);var pd,bd=class extends Rt.CA{get title(){return this._title}get icon(){return this._icon}get keybindingId(){return this._keybindingId}get allViewDescriptors(){return this.viewDescriptorItems.map(e=>e.viewDescriptor)}get activeViewDescriptors(){return this.viewDescriptorItems.filter(e=>e.state.active).map(e=>e.viewDescriptor)}get visibleViewDescriptors(){return this.viewDescriptorItems.filter(e=>this.isViewDescriptorVisible(e)).map(e=>e.viewDescriptor)}constructor(e,t,i,o){if(super(),this.viewContainer=e,this.contextKeyService=i,this.contextKeys=new Rt.HA,this.viewDescriptorItems=[],this._onDidChangeContainerInfo=this._register(new Rt.uA),this.onDidChangeContainerInfo=this._onDidChangeContainerInfo.event,this._onDidChangeAllViewDescriptors=this._register(new Rt.uA),this.onDidChangeAllViewDescriptors=this._onDidChangeAllViewDescriptors.event,this._onDidChangeActiveViewDescriptors=this._register(new Rt.uA),this.onDidChangeActiveViewDescriptors=this._onDidChangeActiveViewDescriptors.event,this._onDidAddVisibleViewDescriptors=this._register(new Rt.uA),this.onDidAddVisibleViewDescriptors=this._onDidAddVisibleViewDescriptors.event,this._onDidRemoveVisibleViewDescriptors=this._register(new Rt.uA),this.onDidRemoveVisibleViewDescriptors=this._onDidRemoveVisibleViewDescriptors.event,this._onDidMoveVisibleViewDescriptors=this._register(new Rt.uA),this.onDidMoveVisibleViewDescriptors=this._onDidMoveVisibleViewDescriptors.event,this._onDidChangeEnablement=this._register(new Rt.uA),this.onDidChangeEnablement=this._onDidChangeEnablement.event,e.when){let t=new Rt.HA;for(let i of e.when.keys())t.add(i);this._register(Rt.dA.filter(i.onDidChangeContext,e=>e.affectsSome(t))(()=>this._onDidChangeEnablement.fire()))}this.logger=new Rt.jk(()=>o.createLogger(Wt.bf,{name:Wt.xf,group:Tt.fn})),this._register(Rt.dA.filter(i.onDidChangeContext,e=>e.affectsSome(this.contextKeys))(()=>this.onDidChangeContext())),this.viewDescriptorsState=this._register(t.createInstance(gd,e.storageId||"".concat(e.id,".state"),"string"==typeof e.title?e.title:e.title.original)),this._register(this.viewDescriptorsState.onDidChangeStoredState(e=>this.updateVisibility(e))),this.updateContainerInfo()}updateContainerInfo(){var e,t,i,o,s,r;let n=this.viewContainer.alwaysUseContainerInfo||0===this.visibleViewDescriptors.length||this.visibleViewDescriptors.some(e=>Rt._b.as(Wt.gf.ViewsRegistry).getViewContainer(e.id)===this.viewContainer),a=n?"string"==typeof this.viewContainer.title?this.viewContainer.title:this.viewContainer.title.value:(null===(e=this.visibleViewDescriptors[0])||void 0===e?void 0:e.containerTitle)||(null===(t=this.visibleViewDescriptors[0])||void 0===t||null===(t=t.name)||void 0===t?void 0:t.value)||"",d=!1;this._title!==a&&(this._title=a,d=!0);let l=n?this.viewContainer.icon:(null===(i=this.visibleViewDescriptors[0])||void 0===i?void 0:i.containerIcon)||Wt.Ef,c=!1;this.isEqualIcon(l)||(this._icon=l,c=!0);let h=null!==(o=null===(s=this.viewContainer.openCommandActionDescriptor)||void 0===s?void 0:s.id)&&void 0!==o?o:null===(r=this.activeViewDescriptors.find(e=>e.openCommandActionDescriptor))||void 0===r||null===(r=r.openCommandActionDescriptor)||void 0===r?void 0:r.id,u=!1;this._keybindingId!==h&&(this._keybindingId=h,u=!0),(d||c||u)&&this._onDidChangeContainerInfo.fire({title:d,icon:c,keybindingId:u})}isEqualIcon(e){return Rt.wD.isUri(e)?Rt.wD.isUri(this._icon)&&(0,Rt.oT)(e,this._icon):Rt.Eb.isThemeIcon(e)?Rt.Eb.isThemeIcon(this._icon)&&Rt.Eb.isEqual(e,this._icon):e===this._icon}isVisible(e){let t=this.viewDescriptorItems.find(t=>t.viewDescriptor.id===e);if(!t)throw Error("Unknown view ".concat(e));return this.isViewDescriptorVisible(t)}setVisible(e,t){this.updateVisibility([{id:e,visible:t}])}updateVisibility(e){let t=(0,Rt.AM)(e.filter(e=>{let{visible:t}=e;return!t}).map(e=>{let{id:t}=e;return this.findAndIgnoreIfNotFound(t)})),i=[];for(let{viewDescriptorItem:s,visibleIndex:r}of t)this.updateViewDescriptorItemVisibility(s,!1)&&i.push({viewDescriptor:s.viewDescriptor,index:r});i.length&&this.broadCastRemovedVisibleViewDescriptors(i);let o=[];for(let{id:s,visible:r}of e){if(!r)continue;let e=this.findAndIgnoreIfNotFound(s);if(!e)continue;let{viewDescriptorItem:t,visibleIndex:i}=e;this.updateViewDescriptorItemVisibility(t,!0)&&o.push({index:i,viewDescriptor:t.viewDescriptor,size:t.state.size,collapsed:!!t.state.collapsed})}o.length&&this.broadCastAddedVisibleViewDescriptors(o)}updateViewDescriptorItemVisibility(e,t){return!(!e.viewDescriptor.canToggleVisibility||this.isViewDescriptorVisibleWhenActive(e)===t)&&(e.viewDescriptor.workspace?e.state.visibleWorkspace=t:(e.state.visibleGlobal=t,t&&this.logger.value.trace("Showing view ".concat(e.viewDescriptor.id," in the container ").concat(this.viewContainer.id))),this.isViewDescriptorVisible(e)===t)}isCollapsed(e){return!!this.find(e).viewDescriptorItem.state.collapsed}setCollapsed(e,t){let{viewDescriptorItem:i}=this.find(e);i.state.collapsed!==t&&(i.state.collapsed=t),this.viewDescriptorsState.updateState(this.allViewDescriptors)}getSize(e){return this.find(e).viewDescriptorItem.state.size}setSizes(e){for(let{id:t,size:i}of e){let{viewDescriptorItem:e}=this.find(t);e.state.size!==i&&(e.state.size=i)}this.viewDescriptorsState.updateState(this.allViewDescriptors)}move(e,t){let i=this.viewDescriptorItems.findIndex(t=>t.viewDescriptor.id===e),o=this.viewDescriptorItems.findIndex(e=>e.viewDescriptor.id===t),s=this.viewDescriptorItems[i],r=this.viewDescriptorItems[o];(0,Rt.ZM)(this.viewDescriptorItems,i,o);for(let n=0;n<this.viewDescriptorItems.length;n++)this.viewDescriptorItems[n].state.order=n;this.broadCastMovedViewDescriptors({index:i,viewDescriptor:s.viewDescriptor},{index:o,viewDescriptor:r.viewDescriptor})}add(e){let t=[];for(let s of e){let e=s.viewDescriptor;if(e.when)for(let t of e.when.keys())this.contextKeys.add(t);let i=this.viewDescriptorsState.get(e.id);if(i){if(e.workspace)i.visibleWorkspace=(0,Rt.pM)(s.visible)?(0,Rt.pM)(i.visibleWorkspace)?!e.hideByDefault:i.visibleWorkspace:s.visible;else{let t=i.visibleGlobal;i.visibleGlobal=(0,Rt.pM)(s.visible)?(0,Rt.pM)(i.visibleGlobal)?!e.hideByDefault:i.visibleGlobal:s.visible,i.visibleGlobal&&!t&&this.logger.value.trace("Added view ".concat(e.id," in the container ").concat(this.viewContainer.id," and showing it."),"".concat(t),"".concat(e.hideByDefault),"".concat(s.visible))}i.collapsed=(0,Rt.pM)(s.collapsed)?(0,Rt.pM)(i.collapsed)?!!e.collapsed:i.collapsed:s.collapsed}else i={active:!1,visibleGlobal:(0,Rt.pM)(s.visible)?!e.hideByDefault:s.visible,visibleWorkspace:(0,Rt.pM)(s.visible)?!e.hideByDefault:s.visible,collapsed:(0,Rt.pM)(s.collapsed)?!!e.collapsed:s.collapsed};this.viewDescriptorsState.set(e.id,i),i.active=this.contextKeyService.contextMatchesRules(e.when),t.push({viewDescriptor:e,state:i})}this.viewDescriptorItems.push(...t),this.viewDescriptorItems.sort(this.compareViewDescriptors.bind(this)),this._onDidChangeAllViewDescriptors.fire({added:t.map(e=>{let{viewDescriptor:t}=e;return t}),removed:[]});let i=[];for(let s of t)s.state.active&&i.push({viewDescriptorItem:s,visible:this.isViewDescriptorVisible(s)});i.length&&this._onDidChangeActiveViewDescriptors.fire({added:i.map(e=>{let{viewDescriptorItem:t}=e;return t.viewDescriptor}),removed:[]});let o=[];for(let{viewDescriptorItem:s,visible:r}of i)if(r&&this.isViewDescriptorVisible(s)){let{visibleIndex:e}=this.find(s.viewDescriptor.id);o.push({index:e,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}remove(e){let t=[],i=[],o=[],s=[];for(let r of e){if(r.when)for(let t of r.when.keys())this.contextKeys.delete(t);let e=this.viewDescriptorItems.findIndex(e=>e.viewDescriptor.id===r.id);if(-1!==e){t.push(r);let n=this.viewDescriptorItems[e];if(n.state.active&&o.push(n.viewDescriptor),this.isViewDescriptorVisible(n)){let{visibleIndex:e}=this.find(n.viewDescriptor.id);s.push({index:e,viewDescriptor:n.viewDescriptor})}i.push(n)}}i.forEach(e=>this.viewDescriptorItems.splice(this.viewDescriptorItems.indexOf(e),1)),this.broadCastRemovedVisibleViewDescriptors(s),o.length&&this._onDidChangeActiveViewDescriptors.fire({added:[],removed:o}),t.length&&this._onDidChangeAllViewDescriptors.fire({added:[],removed:t})}onDidChangeContext(){let e=[],t=[];for(let s of this.viewDescriptorItems){let i=s.state.active,o=this.contextKeyService.contextMatchesRules(s.viewDescriptor.when);i!==o&&(o?e.push({item:s,visibleWhenActive:this.isViewDescriptorVisibleWhenActive(s)}):t.push(s))}let i=[];for(let s of t)if(this.isViewDescriptorVisible(s)){let{visibleIndex:e}=this.find(s.viewDescriptor.id);i.push({index:e,viewDescriptor:s.viewDescriptor})}t.forEach(e=>e.state.active=!1),e.forEach(e=>{let{item:t}=e;return t.state.active=!0}),this.broadCastRemovedVisibleViewDescriptors(i),(e.length||t.length)&&this._onDidChangeActiveViewDescriptors.fire({added:e.map(e=>{let{item:t}=e;return t.viewDescriptor}),removed:t.map(e=>e.viewDescriptor)});let o=[];for(let{item:s,visibleWhenActive:r}of e)if(r&&this.isViewDescriptorVisible(s)){let{visibleIndex:e}=this.find(s.viewDescriptor.id);o.push({index:e,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}broadCastAddedVisibleViewDescriptors(e){e.length&&(this._onDidAddVisibleViewDescriptors.fire(e.sort((e,t)=>e.index-t.index)),this.updateState("Added views:".concat(e.map(e=>e.viewDescriptor.id).join(",")," in ").concat(this.viewContainer.id)))}broadCastRemovedVisibleViewDescriptors(e){e.length&&(this._onDidRemoveVisibleViewDescriptors.fire(e.sort((e,t)=>t.index-e.index)),this.updateState("Removed views:".concat(e.map(e=>e.viewDescriptor.id).join(",")," from ").concat(this.viewContainer.id)))}broadCastMovedViewDescriptors(e,t){this._onDidMoveVisibleViewDescriptors.fire({from:e,to:t}),this.updateState("Moved view ".concat(e.viewDescriptor.id," to ").concat(t.viewDescriptor.id," in ").concat(this.viewContainer.id))}updateState(e){this.logger.value.trace(e),this.viewDescriptorsState.updateState(this.allViewDescriptors),this.updateContainerInfo()}isViewDescriptorVisible(e){return!!e.state.active&&this.isViewDescriptorVisibleWhenActive(e)}isViewDescriptorVisibleWhenActive(e){return e.viewDescriptor.workspace?!!e.state.visibleWorkspace:!!e.state.visibleGlobal}find(e){let t=this.findAndIgnoreIfNotFound(e);if(t)return t;throw Error("view descriptor ".concat(e," not found"))}findAndIgnoreIfNotFound(e){for(let t=0,i=0;t<this.viewDescriptorItems.length;t++){let o=this.viewDescriptorItems[t];if(o.viewDescriptor.id===e)return{index:t,visibleIndex:i,viewDescriptorItem:o};this.isViewDescriptorVisible(o)&&i++}}compareViewDescriptors(e,t){return e.viewDescriptor.id===t.viewDescriptor.id?0:this.getViewOrder(e)-this.getViewOrder(t)||this.getGroupOrderResult(e.viewDescriptor,t.viewDescriptor)}getViewOrder(e){let t="number"==typeof e.state.order?e.state.order:e.viewDescriptor.order;return"number"==typeof t?t:Number.MAX_VALUE}getGroupOrderResult(e,t){return e.group&&t.group&&e.group!==t.group?e.group<t.group?-1:1:0}};function md(e){return"".concat(e,".state")}bd=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Rt.yb),(0,Rt.Fb)(3,Rt.tb)],bd),(0,Rt.Ib)(),(0,Wt.Df)(),(0,Rt.Kb)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Nt.Ot)(),(0,Rt.vb)(),(0,Rt.PA)(),(0,Wt.L)(),(0,Rt.sm)(),(0,Rt.im)(),(0,Rt.gA)(),(0,Rt.ab)(),(0,Rt.hp)(),(0,Rt.db)(),(0,Rt.Fj)(),(0,Rt.nb)(),(0,Rt.Mk)(),(0,Wt.E_)(),(0,Tt.un)();var vd=($=class extends Rt.CA{get viewContainers(){return this.viewContainersRegistry.all}constructor(e,t,i,o,s,r){super(),this.instantiationService=e,this.contextKeyService=t,this.storageService=i,this.extensionService=o,this.telemetryService=s,this._onDidChangeContainer=this._register(new Rt.uA),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeLocation=this._register(new Rt.uA),this.onDidChangeLocation=this._onDidChangeLocation.event,this._onDidChangeContainerLocation=this._register(new Rt.uA),this.onDidChangeContainerLocation=this._onDidChangeContainerLocation.event,this.viewContainerModels=this._register(new Rt.wA),this.viewsVisibilityActionDisposables=this._register(new Rt.wA),this.canRegisterViewsVisibilityActions=!1,this._onDidChangeViewContainers=this._register(new Rt.uA),this.onDidChangeViewContainers=this._onDidChangeViewContainers.event,this.logger=new Rt.jk(()=>r.createLogger(Wt.bf,{name:Wt.xf,group:Tt.fn})),this.activeViewContextKeys=new Map,this.movableViewContextKeys=new Map,this.defaultViewLocationContextKeys=new Map,this.defaultViewContainerLocationContextKeys=new Map,this.viewContainersRegistry=Rt._b.as(Wt.gf.ViewContainersRegistry),this.viewsRegistry=Rt._b.as(Wt.gf.ViewsRegistry),this.migrateToViewsCustomizationsStorage(),this.viewContainersCustomLocations=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),this.viewDescriptorsCustomLocations=new Map(Object.entries(this.viewCustomizations.viewLocations)),this.viewContainerBadgeEnablementStates=new Map(Object.entries(this.viewCustomizations.viewContainerBadgeEnablementStates)),this.viewContainers.forEach(e=>this.onDidRegisterViewContainer(e)),this._register(this.viewsRegistry.onViewsRegistered(e=>this.onDidRegisterViews(e))),this._register(this.viewsRegistry.onViewsDeregistered(e=>{let{views:t,viewContainer:i}=e;return this.onDidDeregisterViews(t,i)})),this._register(this.viewsRegistry.onDidChangeContainer(e=>{let{views:t,from:i,to:o}=e;return this.onDidChangeDefaultContainer(t,i,o)})),this._register(this.viewContainersRegistry.onDidRegister(e=>{let{viewContainer:t}=e;this.onDidRegisterViewContainer(t),this._onDidChangeViewContainers.fire({added:[{container:t,location:this.getViewContainerLocation(t)}],removed:[]})})),this._register(this.viewContainersRegistry.onDidDeregister(e=>{let{viewContainer:t,viewContainerLocation:i}=e;this.onDidDeregisterViewContainer(t),this._onDidChangeViewContainers.fire({removed:[{container:t,location:i}],added:[]})})),this._register(this.storageService.onDidChangeValue(Rt.Go.PROFILE,pd.VIEWS_CUSTOMIZATIONS,this._store)(()=>this.onDidStorageChange())),this.extensionService.whenInstalledExtensionsRegistered().then(()=>this.whenExtensionsRegistered())}migrateToViewsCustomizationsStorage(){if(this.storageService.get(pd.VIEWS_CUSTOMIZATIONS,Rt.Go.PROFILE))return;let e=this.storageService.get("views.cachedViewContainerLocations",Rt.Go.PROFILE),t=this.storageService.get("views.cachedViewPositions",Rt.Go.PROFILE);if(!e&&!t)return;let i=e?JSON.parse(e):[],o=t?JSON.parse(t):[],s={viewContainerLocations:i.reduce((e,t)=>{let[i,o]=t;return e[i]=o,e},{}),viewLocations:o.reduce((e,t)=>{let[i,{containerId:o}]=t;return e[i]=o,e},{}),viewContainerBadgeEnablementStates:{}};this.storageService.store(pd.VIEWS_CUSTOMIZATIONS,JSON.stringify(s),Rt.Go.PROFILE,Rt.Ko.USER),this.storageService.remove("views.cachedViewContainerLocations",Rt.Go.PROFILE),this.storageService.remove("views.cachedViewPositions",Rt.Go.PROFILE)}registerGroupedViews(e){for(let[t,i]of e.entries()){let e=this.viewContainersRegistry.get(t);if(!e||!this.viewContainerModels.has(e)){if(this.isGeneratedContainerId(t)){let e=this.viewContainersCustomLocations.get(t);void 0!==e&&this.registerGeneratedViewContainer(e,t)}continue}let o=i.filter(t=>0===this.getViewContainerModel(e).allViewDescriptors.filter(e=>e.id===t.id).length);this.addViews(e,o)}}deregisterGroupedViews(e){for(let[t,i]of e.entries()){let e=this.viewContainersRegistry.get(t);!e||!this.viewContainerModels.has(e)||this.removeViews(e,i)}}moveOrphanViewsToDefaultLocation(){for(let[e,t]of this.viewDescriptorsCustomLocations.entries()){if(this.viewContainersRegistry.get(t))continue;let i=this.viewsRegistry.getViewContainer(e),o=this.getViewDescriptorById(e);i&&o&&this.addViews(i,[o])}}whenExtensionsRegistered(){this.moveOrphanViewsToDefaultLocation();for(let e of[...this.viewContainersCustomLocations.keys()])this.cleanUpGeneratedViewContainer(e);this.saveViewCustomizations();for(let[e,t]of this.viewContainerModels)this.registerViewsVisibilityActions(e,t);this.canRegisterViewsVisibilityActions=!0}onDidRegisterViews(e){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(e=>{let{views:t,viewContainer:i}=e,o=this.regroupViews(i.id,t);this.registerGroupedViews(o),t.forEach(e=>this.getOrCreateMovableViewContextKey(e).set(!!e.canMoveView))})})}isGeneratedContainerId(e){return e.startsWith(pd.COMMON_CONTAINER_ID_PREFIX)}onDidDeregisterViews(e,t){let i=this.regroupViews(t.id,e);this.deregisterGroupedViews(i),this.contextKeyService.bufferChangeEvents(()=>{e.forEach(e=>this.getOrCreateMovableViewContextKey(e).set(!1))})}regroupViews(e,t){let i=new Map;for(let s of t){var o;let t=null!==(o=this.viewDescriptorsCustomLocations.get(s.id))&&void 0!==o?o:e,r=i.get(t);r||i.set(t,r=[]),r.push(s)}return i}getViewDescriptorById(e){return this.viewsRegistry.getView(e)}getViewLocationById(e){let t=this.getViewContainerByViewId(e);return null===t?null:this.getViewContainerLocation(t)}getViewContainerByViewId(e){var t;let i=this.viewDescriptorsCustomLocations.get(e);return i?null!==(t=this.viewContainersRegistry.get(i))&&void 0!==t?t:null:this.getDefaultContainerById(e)}getViewContainerLocation(e){var t;return null!==(t=this.viewContainersCustomLocations.get(e.id))&&void 0!==t?t:this.getDefaultViewContainerLocation(e)}getDefaultViewContainerLocation(e){return this.viewContainersRegistry.getViewContainerLocation(e)}getDefaultContainerById(e){var t;return null!==(t=this.viewsRegistry.getViewContainer(e))&&void 0!==t?t:null}getViewContainerModel(e){return this.getOrRegisterViewContainerModel(e)}getViewContainerById(e){return this.viewContainersRegistry.get(e)||null}getViewContainersByLocation(e){return this.viewContainers.filter(t=>this.getViewContainerLocation(t)===e)}getDefaultViewContainer(e){return this.viewContainersRegistry.getDefaultViewContainer(e)}moveViewContainerToLocation(e,t,i,o){this.logger.value.trace("moveViewContainerToLocation: viewContainer:".concat(e.id," location:").concat(t," reason:").concat(o)),this.moveViewContainerToLocationWithoutSaving(e,t,i),this.saveViewCustomizations()}getViewContainerBadgeEnablementState(e){var t;return null===(t=this.viewContainerBadgeEnablementStates.get(e))||void 0===t||t}setViewContainerBadgeEnablementState(e,t){this.viewContainerBadgeEnablementStates.set(e,t),this.saveViewCustomizations()}moveViewToLocation(e,t,i){this.logger.value.trace("moveViewToLocation: view:".concat(e.id," location:").concat(t," reason:").concat(i));let o=this.registerGeneratedViewContainer(t);this.moveViewsToContainer([e],o)}moveViewsToContainer(e,t,i,o){if(!e.length)return;this.logger.value.trace("moveViewsToContainer: views:".concat(e.map(e=>e.id).join(",")," viewContainer:").concat(t.id," reason:").concat(o));let s=this.getViewContainerByViewId(e[0].id),r=t;s&&r&&s!==r&&(this.moveViewsWithoutSaving(e,s,r,i),this.cleanUpGeneratedViewContainer(s.id),this.saveViewCustomizations(),this.reportMovedViews(e,s,r))}reset(){for(let e of this.viewContainers){let t=this.getViewContainerModel(e);for(let e of t.allViewDescriptors){let t=this.getDefaultContainerById(e.id),i=this.getViewContainerByViewId(e.id);i&&t&&i!==t&&this.moveViewsWithoutSaving([e],i,t)}let i=this.getDefaultViewContainerLocation(e),o=this.getViewContainerLocation(e);null!==i&&o!==i&&this.moveViewContainerToLocationWithoutSaving(e,i),this.cleanUpGeneratedViewContainer(e.id)}this.viewContainersCustomLocations.clear(),this.viewDescriptorsCustomLocations.clear(),this.saveViewCustomizations()}isViewContainerRemovedPermanently(e){return this.isGeneratedContainerId(e)&&!this.viewContainersCustomLocations.has(e)}onDidChangeDefaultContainer(e,t,i){let o=e.filter(e=>!this.viewDescriptorsCustomLocations.has(e.id)||!this.viewContainers.includes(t)&&this.viewDescriptorsCustomLocations.get(e.id)===t.id);o.length&&this.moveViewsWithoutSaving(o,t,i)}reportMovedViews(e,t,i){let o=e=>e.id.startsWith(pd.COMMON_CONTAINER_ID_PREFIX)?"custom":e.extensionId?"extension":e.id,s=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i),n=e.length,a=o(t),d=o(i),l=s===Wt.Sf.Panel?"panel":"sidebar",c=r===Wt.Sf.Panel?"panel":"sidebar";this.telemetryService.publicLog2("viewDescriptorService.moveViews",{viewCount:n,fromContainer:a,toContainer:d,fromLocation:l,toLocation:c})}moveViewsWithoutSaving(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Wt.Tf.Expand;this.removeViews(t,e),this.addViews(i,e,o);let s=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i);s!==r&&this._onDidChangeLocation.fire({views:e,from:s,to:r}),this._onDidChangeContainer.fire({views:e,from:t,to:i})}moveViewContainerToLocationWithoutSaving(e,t,i){let o=this.getViewContainerLocation(e),s=t;if(o!==s){let t=this.isGeneratedContainerId(e.id),r=s===this.getDefaultViewContainerLocation(e);t||!r?this.viewContainersCustomLocations.set(e.id,s):this.viewContainersCustomLocations.delete(e.id),this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t||r),e.requestedIndex=i,this._onDidChangeContainerLocation.fire({viewContainer:e,from:o,to:s});let n=this.getViewsByContainer(e);this._onDidChangeLocation.fire({views:n,from:o,to:s})}}cleanUpGeneratedViewContainer(e){var t;if(!this.isGeneratedContainerId(e))return;let i=this.getViewContainerById(e);i&&(null===(t=this.getViewContainerModel(i))||void 0===t?void 0:t.allViewDescriptors.length)||[...this.viewDescriptorsCustomLocations.values()].includes(e)||(i&&this.viewContainersRegistry.deregisterViewContainer(i),this.viewContainersCustomLocations.delete(e),this.viewContainerBadgeEnablementStates.delete(e),this.storageService.remove(ud((null===i||void 0===i?void 0:i.storageId)||md(e)),Rt.Go.PROFILE))}registerGeneratedViewContainer(e,t){let i=t||this.generateContainerId(e),o=this.viewContainersRegistry.registerViewContainer({id:i,ctorDescriptor:new Rt.om(Wt.P,[i,{mergeViewWithContainerWhenSingleView:!0}]),title:{value:(0,Rt.Ij)(14610,"User View Container"),original:"User View Container"},icon:e===Wt.Sf.Sidebar?Wt.Ef:void 0,storageId:md(i),hideIfEmpty:!0},e,{doNotRegisterOpenCommand:!0});return this.viewContainersCustomLocations.get(o.id)!==e&&this.viewContainersCustomLocations.set(o.id,e),this.getOrCreateDefaultViewContainerLocationContextKey(o).set(!0),o}onDidStorageChange(){JSON.stringify(this.viewCustomizations)!==this.getStoredViewCustomizationsValue()&&this.onDidViewCustomizationsStorageChange()}onDidViewCustomizationsStorageChange(){this._viewCustomizations=void 0;let e=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),t=new Map(Object.entries(this.viewCustomizations.viewLocations)),i=[],o=[];for(let[s,r]of e.entries()){let e=this.getViewContainerById(s);e?r!==this.getViewContainerLocation(e)&&i.push([e,r]):this.isGeneratedContainerId(s)&&this.registerGeneratedViewContainer(r,s)}for(let s of this.viewContainers)if(!e.has(s.id)){let e=this.getViewContainerLocation(s),t=this.getDefaultViewContainerLocation(s);e!==t&&i.push([s,t])}for(let[s,r]of t.entries()){let e=this.getViewDescriptorById(s);if(e){let t=this.getViewContainerByViewId(s),i=this.viewContainersRegistry.get(r);t&&i&&i!==t&&o.push({views:[e],from:t,to:i})}}for(let s of this.viewContainers){let e=this.getViewContainerModel(s);for(let i of e.allViewDescriptors)if(!t.has(i.id)){let e=this.getViewContainerByViewId(i.id),t=this.getDefaultContainerById(i.id);e&&t&&e!==t&&o.push({views:[i],from:e,to:t})}}for(let[s,r]of i)this.moveViewContainerToLocationWithoutSaving(s,r);for(let{views:s,from:r,to:n}of o)this.moveViewsWithoutSaving(s,r,n,Wt.Tf.Default);this.viewContainersCustomLocations=e,this.viewDescriptorsCustomLocations=t}generateContainerId(e){return"".concat(pd.COMMON_CONTAINER_ID_PREFIX,".").concat((0,Wt.Cf)(e),".").concat((0,Rt.mp)())}saveViewCustomizations(){let e={viewContainerLocations:{},viewLocations:{},viewContainerBadgeEnablementStates:{}};for(let[i,o]of this.viewContainersCustomLocations){let t=this.getViewContainerById(i);t&&!this.isGeneratedContainerId(i)&&o===this.getDefaultViewContainerLocation(t)||(e.viewContainerLocations[i]=o)}for(let[i,o]of this.viewDescriptorsCustomLocations){var t;let s=this.getViewContainerById(o);s&&(null===(t=this.getDefaultContainerById(i))||void 0===t?void 0:t.id)===s.id||(e.viewLocations[i]=o)}for(let[i,o]of this.viewContainerBadgeEnablementStates)!1===o&&(e.viewContainerBadgeEnablementStates[i]=o);this.viewCustomizations=e}get viewCustomizations(){var e,t,i;return this._viewCustomizations||(this._viewCustomizations=JSON.parse(this.getStoredViewCustomizationsValue()),this._viewCustomizations.viewContainerLocations=null!==(e=this._viewCustomizations.viewContainerLocations)&&void 0!==e?e:{},this._viewCustomizations.viewLocations=null!==(t=this._viewCustomizations.viewLocations)&&void 0!==t?t:{},this._viewCustomizations.viewContainerBadgeEnablementStates=null!==(i=this._viewCustomizations.viewContainerBadgeEnablementStates)&&void 0!==i?i:{}),this._viewCustomizations}set viewCustomizations(e){let t=JSON.stringify(e);JSON.stringify(this.viewCustomizations)!==t&&(this._viewCustomizations=e,this.setStoredViewCustomizationsValue(t))}getStoredViewCustomizationsValue(){return this.storageService.get(pd.VIEWS_CUSTOMIZATIONS,Rt.Go.PROFILE,"{}")}setStoredViewCustomizationsValue(e){this.storageService.store(pd.VIEWS_CUSTOMIZATIONS,e,Rt.Go.PROFILE,Rt.Ko.USER)}getViewsByContainer(e){let t=this.viewsRegistry.getViews(e).filter(t=>{var i;return(null!==(i=this.viewDescriptorsCustomLocations.get(t.id))&&void 0!==i?i:e.id)===e.id});for(let[i,o]of this.viewDescriptorsCustomLocations.entries()){if(o!==e.id||this.viewsRegistry.getViewContainer(i)===e)continue;let s=this.getViewDescriptorById(i);s&&t.push(s)}return t}onDidRegisterViewContainer(e){let t=!!this.isGeneratedContainerId(e.id)||this.getViewContainerLocation(e)===this.getDefaultViewContainerLocation(e);this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t),this.getOrRegisterViewContainerModel(e)}getOrRegisterViewContainerModel(e){var t;let i=null===(t=this.viewContainerModels.get(e))||void 0===t?void 0:t.viewContainerModel;if(!i){let t=new Rt.EA;i=t.add(this.instantiationService.createInstance(bd,e)),this.onDidChangeActiveViews({added:i.activeViewDescriptors,removed:[]}),i.onDidChangeActiveViewDescriptors(e=>this.onDidChangeActiveViews(e),this,t),this.onDidChangeVisibleViews({added:[...i.visibleViewDescriptors],removed:[]}),i.onDidAddVisibleViewDescriptors(e=>this.onDidChangeVisibleViews({added:e.map(e=>{let{viewDescriptor:t}=e;return t}),removed:[]}),this,t),i.onDidRemoveVisibleViewDescriptors(e=>this.onDidChangeVisibleViews({added:[],removed:e.map(e=>{let{viewDescriptor:t}=e;return t})}),this,t),t.add((0,Rt.zA)(()=>this.viewsVisibilityActionDisposables.deleteAndDispose(e))),t.add(this.registerResetViewContainerAction(e));let o={viewContainerModel:i,disposables:t,dispose:()=>t.dispose()};this.viewContainerModels.set(e,o),this.onDidRegisterViews([{views:this.viewsRegistry.getViews(e),viewContainer:e}]);let s=this.getViewsByContainer(e).filter(t=>this.getDefaultContainerById(t.id)!==e);s.length&&(this.addViews(e,s),this.contextKeyService.bufferChangeEvents(()=>{s.forEach(e=>this.getOrCreateMovableViewContextKey(e).set(!!e.canMoveView))})),this.canRegisterViewsVisibilityActions&&this.registerViewsVisibilityActions(e,o)}return i}onDidDeregisterViewContainer(e){this.viewContainerModels.deleteAndDispose(e),this.viewsVisibilityActionDisposables.deleteAndDispose(e)}onDidChangeActiveViews(e){let{added:t,removed:i}=e;this.contextKeyService.bufferChangeEvents(()=>{t.forEach(e=>this.getOrCreateActiveViewContextKey(e).set(!0)),i.forEach(e=>this.getOrCreateActiveViewContextKey(e).set(!1))})}onDidChangeVisibleViews(e){let{added:t,removed:i}=e;this.contextKeyService.bufferChangeEvents(()=>{t.forEach(e=>this.getOrCreateVisibleViewContextKey(e).set(!0)),i.forEach(e=>this.getOrCreateVisibleViewContextKey(e).set(!1))})}registerViewsVisibilityActions(e,t){let{viewContainerModel:i,disposables:o}=t;this.viewsVisibilityActionDisposables.deleteAndDispose(e),this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(i)),o.add(Rt.dA.any(i.onDidChangeActiveViewDescriptors,i.onDidAddVisibleViewDescriptors,i.onDidRemoveVisibleViewDescriptors,i.onDidMoveVisibleViewDescriptors)(t=>{this.viewsVisibilityActionDisposables.deleteAndDispose(e),this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(i))}))}registerViewsVisibilityActionsForContainer(e){let t=new Rt.EA;return e.activeViewDescriptors.forEach((i,o)=>{i.remoteAuthority||(t.add((0,Rt.pb)(class extends Wt.F{constructor(){super({id:"".concat(i.id,".toggleVisibility"),viewPaneContainerId:e.viewContainer.id,precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?Rt.PO.true():Rt.PO.false(),toggled:Rt.PO.has("".concat(i.id,".visible")),title:i.name,metadata:{description:(0,Rt.Lj)(14611,"Toggles the visibility of the {0} view if the view container it is located in is visible",i.name.value)},menu:[{id:Wt.I,when:Rt.PO.equals("viewContainer",e.viewContainer.id),order:o},{id:Rt.sb.ViewContainerTitleContext,when:Rt.PO.equals("viewContainer",e.viewContainer.id),order:o,group:"1_toggleVisibility"},{id:Rt.sb.ViewTitleContext,when:Rt.PO.or(...e.visibleViewDescriptors.map(e=>Rt.PO.equals("view",e.id))),order:o,group:"2_toggleVisibility"}]})}async runInViewPaneContainer(e,t){t.toggleViewVisibility(i.id)}})),t.add((0,Rt.pb)(class extends Wt.F{constructor(){super({id:"".concat(i.id,".removeView"),viewPaneContainerId:e.viewContainer.id,title:(0,Rt.Ij)(14612,"Hide '{0}'",i.name.value),metadata:{description:(0,Rt.Lj)(14613,"Hides the {0} view if it is visible and the view container it is located in is visible",i.name.value)},precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?Rt.PO.true():Rt.PO.false(),menu:[{id:Rt.sb.ViewTitleContext,when:Rt.PO.and(Rt.PO.equals("view",i.id),Rt.PO.has("".concat(i.id,".visible"))),group:"1_hide",order:1}]})}async runInViewPaneContainer(e,t){var o;(null===(o=t.getView(i.id))||void 0===o?void 0:o.isVisible())&&t.toggleViewVisibility(i.id)}})))}),t}registerResetViewContainerAction(e){let t=this;return(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"".concat(e.id,".resetViewContainerLocation"),title:(0,Rt.Lj)(14614,"Reset Location"),menu:[{id:Rt.sb.ViewContainerTitleContext,group:"1_viewActions",when:Rt.PO.or(Rt.PO.and(Rt.PO.equals("viewContainer",e.id),Rt.PO.equals("".concat(e.id,".defaultViewContainerLocation"),!1)))}]})}run(i){t.moveViewContainerToLocation(e,t.getDefaultViewContainerLocation(e),void 0,this.desc.id),i.get(Wt.T_).openViewContainer(e.id,!0)}})}addViews(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wt.Tf.Default;this.contextKeyService.bufferChangeEvents(()=>{t.forEach(t=>{let i=this.getDefaultContainerById(t.id)===e;this.getOrCreateDefaultViewLocationContextKey(t).set(i),i?this.viewDescriptorsCustomLocations.delete(t.id):this.viewDescriptorsCustomLocations.set(t.id,e.id)})}),this.getViewContainerModel(e).add(t.map(e=>({viewDescriptor:e,collapsed:i===Wt.Tf.Default&&void 0,visible:i!==Wt.Tf.Default||void 0})))}removeViews(e,t){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(t=>{this.viewDescriptorsCustomLocations.get(t.id)===e.id&&this.viewDescriptorsCustomLocations.delete(t.id),this.getOrCreateDefaultViewLocationContextKey(t).set(!1)})}),this.getViewContainerModel(e).remove(t)}getOrCreateActiveViewContextKey(e){let t="".concat(e.id,".active"),i=this.activeViewContextKeys.get(t);return i||(i=new Rt.FO(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateVisibleViewContextKey(e){let t="".concat(e.id,".visible"),i=this.activeViewContextKeys.get(t);return i||(i=new Rt.FO(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateMovableViewContextKey(e){let t="".concat(e.id,".canMove"),i=this.movableViewContextKeys.get(t);return i||(i=new Rt.FO(t,!1).bindTo(this.contextKeyService),this.movableViewContextKeys.set(t,i)),i}getOrCreateDefaultViewLocationContextKey(e){let t="".concat(e.id,".defaultViewLocation"),i=this.defaultViewLocationContextKeys.get(t);return i||(i=new Rt.FO(t,!1).bindTo(this.contextKeyService),this.defaultViewLocationContextKeys.set(t,i)),i}getOrCreateDefaultViewContainerLocationContextKey(e){let t="".concat(e.id,".defaultViewContainerLocation"),i=this.defaultViewContainerLocationContextKeys.get(t);return i||(i=new Rt.FO(t,!1).bindTo(this.contextKeyService),this.defaultViewContainerLocationContextKeys.set(t,i)),i}},{_:pd=$},{_:$.VIEWS_CUSTOMIZATIONS="views.customizations"},{_:$.COMMON_CONTAINER_ID_PREFIX="workbench.views.service"},$);vd=pd=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Rt.yb),(0,Rt.Fb)(2,Rt.Uo),(0,Rt.Fb)(3,Nt.Dt),(0,Rt.Fb)(4,Rt.ib),(0,Rt.Fb)(5,Rt.tb)],vd),(0,Rt.Ib)(),(0,Rt.wa)(),(0,Rt.WM)(),(0,Rt.PA)(),(0,Rt.iT)(),(0,Rt.TD)(),(0,Rt.s_)(),(0,Rt.$p)(),(0,Pt.en)(),(0,Pt.G)(),(0,Rt.yT)(),(0,Lt.a)(),(0,Rt.Kb)(),(0,Rt.Sc)(),(0,Rt.Fj)(),(0,Rt.Ud)(),(0,Rt.Rd)(),(0,Rt.im)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Nt.Ot)(),(0,Rt.nb)(),(0,Pt.Ot)(),(0,Rt.gA)(),(0,Rt.qd)();var Cd,wd=(ee=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a){super(),this.editorGroupService=e,this.instantiationService=t,this.configurationService=i,this.quickInputService=o,this.notificationService=s,this.storageService=r,this.extensionService=n,this.logService=a,this._onDidChangeEditorRegistrations=this._register(new Rt.fA),this.onDidChangeEditorRegistrations=this._onDidChangeEditorRegistrations.event,this._editors=new Map,this._flattenedEditors=new Map,this._shouldReFlattenEditors=!0,this.cache=new Set(JSON.parse(this.storageService.get(Cd.cacheStorageID,Rt.Go.PROFILE,JSON.stringify([])))),this.storageService.remove(Cd.cacheStorageID,Rt.Go.PROFILE),this._register(this.storageService.onWillSaveState(()=>{this.cacheEditors()})),this._register(this.extensionService.onDidRegisterExtensions(()=>{this.cache=void 0}))}resolveUntypedInputAndGroup(e,t){let i=e,o=this.instantiationService.invokeFunction(zt.a,i,t);if(o instanceof Promise)return o.then(e=>{let[t,o]=e;return[i,t,o]});{let[e,t]=o;return[i,e,t]}}async resolveEditor(e,t){var i,o,s,r;if(this._flattenedEditors=this._flattenEditorsMap(),(0,Pt.pn)(e))return this.doResolveSideBySideEditor(e,t);let n,a=this.resolveUntypedInputAndGroup(e,t);if(n=a instanceof Promise?await a:a,!n)return Lt.n.NONE;let[d,l,c]=n;c&&(d.options=(0,xt.A)((0,xt.A)({},d.options),{},{activation:c}));let h=Pt.Ht.getCanonicalUri(d,{supportSideBySide:Pt.Jt.PRIMARY});if(this.cache&&h&&this.resourceMatchesCache(h)&&await this.extensionService.whenInstalledExtensionsRegistered(),void 0===h)h=Rt.wD.from({scheme:Rt.vT.untitled});else if(void 0===h.scheme||null===h)return Lt.n.NONE;if((null===(i=d.options)||void 0===i?void 0:i.override)===Rt.Xp.PICK){let e=await this.doPickEditor(d);if(!e)return Lt.n.ABORT;d.options=e}let{editor:u,conflictingDefault:g}=this.getEditor(h,null===(o=d.options)||void 0===o?void 0:o.override);if(!u&&(null!==(s=d.options)&&void 0!==s&&s.override||(0,Pt.in)(e)))return Lt.n.NONE;if(!u){let e=this.getEditor(h,Pt.Ft.id);if(u=null===e||void 0===e?void 0:e.editor,g=null===e||void 0===e?void 0:e.conflictingDefault,!u)return Lt.n.NONE}if((0,Pt.ln)(d)&&void 0===(null===(r=d.options)||void 0===r?void 0:r.override)){let e=Pt.Ht.getCanonicalUri(d,{supportSideBySide:Pt.Jt.SECONDARY});e||(e=Rt.wD.from({scheme:Rt.vT.untitled}));let{editor:t}=this.getEditor(e,void 0);if(!t||u.editorInfo.id!==t.editorInfo.id){let{editor:e,conflictingDefault:t}=this.getEditor(h,Pt.Ft.id);u=e,g=t}if(!u)return Lt.n.NONE}if(d.options=(0,xt.A)({override:u.editorInfo.id},d.options),void 0===u.editorFactoryObject.createDiffEditorInput&&(0,Pt.ln)(d))return Lt.n.NONE;let p=await this.doResolveEditor(d,l,u);return g&&p&&await this.doHandleConflictingDefaults(h,u.editorInfo.label,d,p.editor,l),p?(p.editor.editorId!==u.editorInfo.id&&this.logService.warn("Editor ID Mismatch: ".concat(p.editor.editorId," !== ").concat(u.editorInfo.id,". This will cause bugs. Please ensure editorInput.editorId matches the registered id")),(0,xt.A)((0,xt.A)({},p),{},{group:l})):Lt.n.ABORT}async doResolveSideBySideEditor(e,t){var i,o;let s=await this.resolveEditor(e.primary,t);if(!(0,Pt.an)(s))return Lt.n.NONE;let r=await this.resolveEditor(e.secondary,null!==(i=s.group)&&void 0!==i?i:t);return(0,Pt.an)(r)?{group:null!==(o=s.group)&&void 0!==o?o:r.group,editor:this.instantiationService.createInstance(Pt.Et,e.label,e.description,r.editor,s.editor),options:e.options}:Lt.n.NONE}bufferChangeEvents(e){this._onDidChangeEditorRegistrations.pause();try{e()}finally{this._onDidChangeEditorRegistrations.resume()}}registerEditor(e,t,i,o){let s=this._editors.get(e);void 0===s&&(s=new Map,this._editors.set(e,s));let r=s.get(t.id);void 0===r&&(r=[]);let n=(0,Rt.GM)(r,{globPattern:e,editorInfo:t,options:i,editorFactoryObject:o});return s.set(t.id,r),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire(),(0,Rt.zA)(()=>{var e;n(),r&&0===r.length&&null!==(e=s)&&void 0!==e&&e.delete(t.id),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire()})}getAssociationsForResource(e){let t=this.getAllUserAssociations().filter(t=>t.filenamePattern&&(0,Lt.i)(t.filenamePattern,e));t=t.sort((e,t)=>{var i,o,s,r;return(null!==(i=null===(o=t.filenamePattern)||void 0===o?void 0:o.length)&&void 0!==i?i:0)-(null!==(s=null===(r=e.filenamePattern)||void 0===r?void 0:r.length)&&void 0!==s?s:0)});let i=this._registeredEditors;return t.filter(e=>i.find(t=>t.editorInfo.id===e.viewType))}getAllUserAssociations(){var e,t,i;let o=this.configurationService.inspect("workbench.editorAssociations")||{},s=null!==(e=o.defaultValue)&&void 0!==e?e:{},r=null!==(t=o.workspaceValue)&&void 0!==t?t:{},n=null!==(i=o.userValue)&&void 0!==i?i:{},a=(0,xt.A)({},r);for(let[l,c]of Object.entries((0,xt.A)((0,xt.A)({},s),n)))void 0===a[l]&&(a[l]=c);let d=[];for(let[l,c]of Object.entries(a)){let e={filenamePattern:l,viewType:c};d.push(e)}return d}_flattenEditorsMap(){if(!this._shouldReFlattenEditors)return this._flattenedEditors;this._shouldReFlattenEditors=!1;let e=new Map;for(let[t,i]of this._editors){let o=[];for(let e of i.values()){let t;for(let i of e)t||(t={editorInfo:i.editorInfo,globPattern:i.globPattern,options:{},editorFactoryObject:{}}),t.options=(0,xt.A)((0,xt.A)({},t.options),i.options),t.editorFactoryObject=(0,xt.A)((0,xt.A)({},t.editorFactoryObject),i.editorFactoryObject);t&&o.push(t)}e.set(t,o)}return e}get _registeredEditors(){return Array.from(this._flattenedEditors.values()).flat()}updateUserAssociations(e,t){let i={viewType:t,filenamePattern:e},o=this.getAllUserAssociations(),s=Object.create(null);for(let r of[...o,i])r.filenamePattern&&(s[r.filenamePattern]=r.viewType);this.configurationService.updateValue(Lt.r,s)}findMatchingEditors(e){let t=this.getAssociationsForResource(e),i=[];for(let[o,s]of this._flattenedEditors)for(let r of s)(t.find(e=>e.viewType===r.editorInfo.id)&&r.editorInfo.priority!==Lt.t.exclusive||(0,Lt.i)(o,e))&&i.push(r);return i.sort((e,t)=>(0,Lt.o)(t.editorInfo.priority)===(0,Lt.o)(e.editorInfo.priority)&&"string"==typeof t.globPattern&&"string"==typeof e.globPattern?t.globPattern.length-e.globPattern.length:(0,Lt.o)(t.editorInfo.priority)-(0,Lt.o)(e.editorInfo.priority))}getEditors(e){if(this._flattenedEditors=this._flattenEditorsMap(),Rt.wD.isUri(e)){let t=this.findMatchingEditors(e);return t.find(e=>e.editorInfo.priority===Lt.t.exclusive)?[]:t.map(e=>e.editorInfo)}return(0,Rt.LM)(this._registeredEditors.map(e=>e.editorInfo),e=>e.id)}getEditor(e,t){var i,o;let s=(t,i)=>t.find(t=>{var o;return void 0===(null===(o=t.options)||void 0===o?void 0:o.canSupportResource)?t.editorInfo.id===i:t.editorInfo.id===i&&t.options.canSupportResource(e)});if(t&&t!==Rt.Xp.EXCLUSIVE_ONLY){return{editor:s(this._registeredEditors,t),conflictingDefault:!1}}let r=this.findMatchingEditors(e),n=this.getAssociationsForResource(e),a=t===Rt.Xp.EXCLUSIVE_ONLY?Lt.t.exclusive:Lt.t.builtin,d=r.filter(e=>(0,Lt.o)(e.editorInfo.priority)>=(0,Lt.o)(a)&&e.editorInfo.id!==Pt.Ft.id);if(0===d.length)return{editor:n[0]&&a!==Lt.t.exclusive?s(r,n[0].viewType):void 0,conflictingDefault:!1};let l=d[0].editorInfo.priority===Lt.t.exclusive?d[0].editorInfo.id:(null===(i=n[0])||void 0===i?void 0:i.viewType)||(null===(o=d.find(t=>{var i;return!(null!==(i=t.options)&&void 0!==i&&i.canSupportResource)||t.options.canSupportResource(e)}))||void 0===o?void 0:o.editorInfo.id)||d[0].editorInfo.id,c=!1;return d=d.filter(e=>e.editorInfo.priority!==Lt.t.exclusive).filter(t=>{var i;return!(null!==(i=t.options)&&void 0!==i&&i.canSupportResource)||t.options.canSupportResource(e)}),0===n.length&&d.length>1&&(c=!0),{editor:s(r,l),conflictingDefault:c}}async doResolveEditor(e,t,i){var o,s,r;let n=e.options,a=Pt.Ht.getCanonicalUri(e,{supportSideBySide:Pt.Jt.PRIMARY});if(n&&void 0===n.activation&&(n=(0,xt.A)((0,xt.A)({},n),{},{activation:n.preserveFocus?Rt.Jp.RESTORE:void 0})),(0,Pt.dn)(e)){var d;if(!i.editorFactoryObject.createMergeEditorInput)return;let o=await i.editorFactoryObject.createMergeEditorInput(e,t);return{editor:o.editor,options:null!==(d=o.options)&&void 0!==d?d:n}}if((0,Pt.ln)(e)){var l;if(!i.editorFactoryObject.createDiffEditorInput)return;let o=await i.editorFactoryObject.createDiffEditorInput(e,t);return{editor:o.editor,options:null!==(l=o.options)&&void 0!==l?l:n}}if((0,Pt.fn)(e)){var c;if(!i.editorFactoryObject.createMultiDiffEditorInput)return;let o=await i.editorFactoryObject.createMultiDiffEditorInput(e,t);return{editor:o.editor,options:null!==(c=o.options)&&void 0!==c?c:n}}if((0,Pt.pn)(e))throw Error("Untyped side by side editor input not supported here.");if((0,Pt.gn)(e)){var h;if(!i.editorFactoryObject.createUntitledEditorInput)return;let o=await i.editorFactoryObject.createUntitledEditorInput(e,t);return{editor:o.editor,options:null!==(h=o.options)&&void 0!==h?h:n}}if(void 0===a)throw Error("Undefined resource on non untitled editor input.");if("function"==typeof(null===(o=i.options)||void 0===o?void 0:o.singlePerResource)?i.options.singlePerResource():null===(s=i.options)||void 0===s?void 0:s.singlePerResource){let e=this.findExistingEditorsForResource(a,i.editorInfo.id);if(e.length){let i=await this.moveExistingEditorForResource(e,t);return i?{editor:i,options:n}:void 0}}if(!i.editorFactoryObject.createEditorInput)return;let u=await i.editorFactoryObject.createEditorInput(e,t);return n=null!==(r=u.options)&&void 0!==r?r:n,{editor:u.editor,options:n}}async moveExistingEditorForResource(e,t){let i=e[0];for(let{editor:o,group:s}of e)if(o!==i.editor&&!await s.closeEditor(o))return;if(t.id===i.group.id||i.group.moveEditor(i.editor,t))return i.editor}findExistingEditorsForResource(e,t){let i=[],o=(0,Rt.LM)([...this.editorGroupService.groups]);for(let s of o)for(let o of s.editors)(0,Rt.oT)(o.resource,e)&&o.editorId===t&&i.push({editor:o,group:s});return i}async doHandleConflictingDefaults(e,t,i,o,s){var r;let n=this.findMatchingEditors(e),a=JSON.parse(this.storageService.get(Cd.conflictingDefaultsStorageID,Rt.Go.PROFILE,"{}")),d="*".concat((0,Rt.nT)(e)),l=()=>{a[d]=[],n.forEach(e=>a[d].push(e.editorInfo.id)),this.storageService.store(Cd.conflictingDefaultsStorageID,JSON.stringify(a),Rt.Go.PROFILE,Rt.Ko.MACHINE)};if(null!==(r=a[d])&&void 0!==r&&r.find(e=>e===o.editorId))return;let c=this.notificationService.prompt(Rt.Kd.Warning,(0,Rt.Ij)(13882,"There are multiple default editors available for the resource."),[{label:(0,Rt.Ij)(13883,"Configure Default"),run:async()=>{var e;let t=await this.doPickEditor(i,!0);if(!t)return;i.options=t;let r=await this.resolveEditor(i,s);r===Lt.n.ABORT||r===Lt.n.NONE||s.replaceEditors([{editor:o,replacement:r.editor,options:null!==(e=r.options)&&void 0!==e?e:t}])}},{label:(0,Rt.Ij)(13884,"Keep {0}",t),run:l}]).onDidClose(()=>{l(),c.dispose()})}mapEditorsToQuickPickEntry(e,t){var i,o,s;let r=this.editorGroupService.activeGroup.findEditors(e).at(0),n=e.scheme===Rt.vT.untitled?this._registeredEditors.filter(e=>e.editorInfo.priority!==Lt.t.exclusive):this.findMatchingEditors(e);n=(0,Rt.LM)(n,e=>e.editorInfo.id);let a=null===(i=this.getAssociationsForResource(e)[0])||void 0===i?void 0:i.viewType;n=n.sort((e,t)=>e.editorInfo.id===Pt.Ft.id?-1:t.editorInfo.id===Pt.Ft.id?1:(0,Lt.o)(t.editorInfo.priority)-(0,Lt.o)(e.editorInfo.priority));let d=[],l=(0,Rt.Ij)(13885,"Active"),c=(0,Rt.Ij)(13886,"Default"),h=(0,Rt.Ij)(13887,"Active and Default"),u=a;if(!u&&n.length>2&&(null===(o=n[1])||void 0===o?void 0:o.editorInfo.priority)!==Lt.t.option&&(u=null===(s=n[1])||void 0===s?void 0:s.editorInfo.id),u||(u=Pt.Ft.id),n.forEach(e=>{var t,i;let o=null!==(t=null===r||void 0===r?void 0:r.editorId)&&void 0!==t?t:Pt.Ft.id,s=!!r&&e.editorInfo.id===o,n=e.editorInfo.id===u,a={id:e.editorInfo.id,label:e.editorInfo.label,description:s&&n?h:s?l:n?c:void 0,detail:null!==(i=e.editorInfo.detail)&&void 0!==i?i:e.editorInfo.priority};d.push(a)}),!t&&""!==(0,Rt.nT)(e)){d.push({type:"separator"});let t={id:Cd.configureDefaultID,label:(0,Rt.Ij)(13888,"Configure default editor for '{0}'...","*".concat((0,Rt.nT)(e)))};d.push(t)}return d}async doPickEditor(e,t){var i;let o=Pt.Ht.getOriginalUri(e,{supportSideBySide:Pt.Jt.PRIMARY});void 0===o&&(o=Rt.wD.from({scheme:Rt.vT.untitled}));let s=this.mapEditorsToQuickPickEntry(o,t),r=new Rt.EA,n=r.add(this.quickInputService.createQuickPick({useSeparators:!0}));n.placeholder=t?(0,Rt.Ij)(13889,"Select new default editor for '{0}'","*".concat((0,Rt.nT)(o))):(0,Rt.Ij)(13890,"Select editor for '{0}'",(0,Rt.Xw)(o)),n.canAcceptInBackground=!0,n.items=s;let a=n.items.find(e=>"item"===e.type);a&&(n.selectedItems=[a]);let d=await new Promise(e=>{r.add(n.onDidAccept(i=>{var s;let r;1===n.selectedItems.length&&(r={item:n.selectedItems[0],keyMods:n.keyMods,openInBackground:i.inBackground}),o&&t&&null!==(s=r)&&void 0!==s&&s.item.id&&this.updateUserAssociations("*".concat((0,Rt.nT)(o)),r.item.id),e(r)})),r.add(n.onDidHide(()=>{r.dispose(),e(void 0)})),r.add(n.onDidTriggerItemButton(t=>{var i;e({item:t.item,openInBackground:!1}),o&&(null===(i=t.item)||void 0===i?void 0:i.id)&&this.updateUserAssociations("*".concat((0,Rt.nT)(o)),t.item.id)})),n.show()});if(n.dispose(),d)return d.item.id===Cd.configureDefaultID?this.doPickEditor(e,!0):(0,xt.A)((0,xt.A)({},e.options),{},{override:d.item.id,preserveFocus:d.openInBackground||(null===(i=e.options)||void 0===i?void 0:i.preserveFocus)})}cacheEditors(){let e=new Set;for(let[i,o]of this._flattenedEditors)o.find(e=>e.editorInfo.priority!==Lt.t.option&&e.editorInfo.id!==Pt.Ft.id)&&((0,Rt.Ta)(i)?e.add("".concat(i.pattern)):e.add(i));let t=this.getAllUserAssociations();for(let i of t)i.filenamePattern&&e.add(i.filenamePattern);this.storageService.store(Cd.cacheStorageID,JSON.stringify(Array.from(e)),Rt.Go.PROFILE,Rt.Ko.MACHINE)}resourceMatchesCache(e){if(!this.cache)return!1;for(let t of this.cache)if((0,Lt.i)(t,e))return!0;return!1}},{_:Cd=ee},{_:ee.configureDefaultID="promptOpenWith.configureDefault"},{_:ee.cacheStorageID="editorOverrideService.cache"},{_:ee.conflictingDefaultsStorageID="editorOverrideService.conflictingDefaults"},ee);wd=Cd=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.W),(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Rt.o_),(0,Rt.Fb)(3,Rt.xc),(0,Rt.Fb)(4,Rt.Ld),(0,Rt.Fb)(5,Rt.Uo),(0,Rt.Fb)(6,Nt.Dt),(0,Rt.Fb)(7,Rt.eb)],wd),(0,Rt.Ib)(),(0,Rt.TD)(),(0,Rt.Kb)(),(0,Nt.u)(),(0,Rt.s_)(),(0,Rt.gA)(),(0,Rt.QA)(),(0,Rt.yT)(),(0,Rt.PA)(),(0,Rt.im)();var yd,fd=(te=class extends Rt.CA{constructor(e,t){super(),this.instantiationService=e,this.configurationService=t,this._onDidSave=this._register(new Rt.uA),this.onDidSave=this._onDidSave.event,this._onDidChangeDirty=this._register(new Rt.uA),this.onDidChangeDirty=this._onDidChangeDirty.event,this._onDidChangeEncoding=this._register(new Rt.uA),this.onDidChangeEncoding=this._onDidChangeEncoding.event,this._onDidCreate=this._register(new Rt.uA),this.onDidCreate=this._onDidCreate.event,this._onWillDispose=this._register(new Rt.uA),this.onWillDispose=this._onWillDispose.event,this._onDidChangeLabel=this._register(new Rt.uA),this.onDidChangeLabel=this._onDidChangeLabel.event,this.mapResourceToModel=new Rt.qA}get(e){return this.mapResourceToModel.get(e)}getValue(e){var t;return null===(t=this.get(e))||void 0===t||null===(t=t.textEditorModel)||void 0===t?void 0:t.getValue()}async resolve(e){let t=this.doCreateOrGet(e);return await t.resolve(),t}create(e){return this.doCreateOrGet(e)}doCreateOrGet(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.create(null),t=this.massageOptions(e);return t.untitledResource&&this.mapResourceToModel.has(t.untitledResource)?this.mapResourceToModel.get(t.untitledResource):this.doCreate(t)}massageOptions(e){var t;let i=Object.create(null);if(e.associatedResource?(i.untitledResource=Rt.wD.from({scheme:Rt.vT.untitled,authority:e.associatedResource.authority,fragment:e.associatedResource.fragment,path:e.associatedResource.path,query:e.associatedResource.query}),i.associatedResource=e.associatedResource):(null===(t=e.untitledResource)||void 0===t?void 0:t.scheme)===Rt.vT.untitled&&(i.untitledResource=e.untitledResource),e.languageId)i.languageId=e.languageId;else if(!i.associatedResource){var o;let e=this.configurationService.getValue();(null===(o=e.files)||void 0===o?void 0:o.defaultLanguage)&&(i.languageId=e.files.defaultLanguage)}return i.encoding=e.encoding,i.initialValue=e.initialValue,i}doCreate(e){let t=e.untitledResource;if(!t){let e=1;do{t=Rt.wD.from({scheme:Rt.vT.untitled,path:"Untitled-".concat(e)}),e++}while(this.mapResourceToModel.has(t))}let i=this._register(this.instantiationService.createInstance(Nt.l,t,!!e.associatedResource,e.initialValue,e.languageId,e.encoding));return this.registerModel(i),i}registerModel(e){let t=new Rt.EA;t.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),t.add(e.onDidChangeName(()=>this._onDidChangeLabel.fire(e))),t.add(e.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(e))),t.add(e.onWillDispose(()=>this._onWillDispose.fire(e))),Rt.dA.once(e.onWillDispose)(()=>{this.mapResourceToModel.delete(e.resource),t.dispose()}),this.mapResourceToModel.set(e.resource,e),this._onDidCreate.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e)}isUntitledWithAssociatedResource(e){return e.scheme===Rt.vT.untitled&&e.path.length>1&&!yd.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(e.path)}canDispose(e){return!!e.isDisposed()||this.doCanDispose(e)}async doCanDispose(e){return!e.isDirty()||(await Rt.dA.toPromise(e.onDidChangeDirty),this.canDispose(e))}notifyDidSave(e,t){this._onDidSave.fire({source:e,target:t})}},{_:yd=te},{_:te.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/},te);fd=yd=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Rt.o_)],fd),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.TD)(),(0,Pt.en)(),(0,Pt.At)(),(0,Tt.s)(),(0,Tt.kn)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.za)(),(0,Rt.PA)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.gA)(),(0,Rt.s_)(),(0,Pt.G)(),(0,Wt.Gd)(),(0,Rt.Kb)(),(0,Nt.Q)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.WM)(),(0,Rt.im)(),(0,Rt.qx)(),(0,Wt.Dx)(),(0,Rt.yT)(),(0,Rt.xN)(),(0,Pt.o)(),(0,Pt.j)(),(0,Rt.Qo)(),(0,Pt.L)(),(0,Pt.z)(),(0,Rt.kp)(),(0,Rt.nb)(),(0,Rt.gE)();var Sd,Id,kd=(ie=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a,d,l,c){super(),this.editorService=e,this.editorGroupService=t,this.contextService=i,this.storageService=o,this.configurationService=s,this.fileService=r,this.workspacesService=n,this.instantiationService=a,this.layoutService=d,this.contextKeyService=l,this.logService=c,this.activeEditorListeners=this._register(new Rt.EA),this.lastActiveEditor=void 0,this._onDidChangeEditorNavigationStack=this._register(new Rt.uA),this.onDidChangeEditorNavigationStack=this._onDidChangeEditorNavigationStack.event,this.defaultScopedEditorNavigationStack=void 0,this.editorGroupScopedNavigationStacks=new Map,this.editorScopedNavigationStacks=new Map,this.editorNavigationScope=Tt.o.DEFAULT,this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0,this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0,this.navigatingInRecentlyUsedEditorsStack=!1,this.navigatingInRecentlyUsedEditorsInGroupStack=!1,this.recentlyClosedEditors=[],this.ignoreEditorCloseEvent=!1,this.history=void 0,this.editorHistoryListeners=this._register(new Rt.wA),this.resourceExcludeMatcher=this._register(new Rt.rx(Rt.vE,()=>{let e=this._register(this.instantiationService.createInstance(Pt.a,e=>(0,Wt.Hd)(e?this.configurationService.getValue({resource:e}):this.configurationService.getValue())||Object.create(null),e=>e.affectsConfiguration("files.exclude")||e.affectsConfiguration("search.exclude")));return this._register(e.onExpressionChange(()=>this.removeExcludedFromHistory())),e})),this.editorHelper=this.instantiationService.createInstance(xd),this.canNavigateBackContextKey=new Rt.FO("canNavigateBack",!1,(0,Rt.Ij)(14102,"Whether it is possible to navigate back in editor history")).bindTo(this.contextKeyService),this.canNavigateForwardContextKey=new Rt.FO("canNavigateForward",!1,(0,Rt.Ij)(14103,"Whether it is possible to navigate forward in editor history")).bindTo(this.contextKeyService),this.canNavigateBackInNavigationsContextKey=new Rt.FO("canNavigateBackInNavigationLocations",!1,(0,Rt.Ij)(14104,"Whether it is possible to navigate back in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInNavigationsContextKey=new Rt.FO("canNavigateForwardInNavigationLocations",!1,(0,Rt.Ij)(14105,"Whether it is possible to navigate forward in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateToLastNavigationLocationContextKey=new Rt.FO("canNavigateToLastNavigationLocation",!1,(0,Rt.Ij)(14106,"Whether it is possible to navigate to the last editor navigation location")).bindTo(this.contextKeyService),this.canNavigateBackInEditsContextKey=new Rt.FO("canNavigateBackInEditLocations",!1,(0,Rt.Ij)(14107,"Whether it is possible to navigate back in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInEditsContextKey=new Rt.FO("canNavigateForwardInEditLocations",!1,(0,Rt.Ij)(14108,"Whether it is possible to navigate forward in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateToLastEditLocationContextKey=new Rt.FO("canNavigateToLastEditLocation",!1,(0,Rt.Ij)(14109,"Whether it is possible to navigate to the last editor edit location")).bindTo(this.contextKeyService),this.canReopenClosedEditorContextKey=new Rt.FO("canReopenClosedEditor",!1,(0,Rt.Ij)(14110,"Whether it is possible to reopen the last closed editor")).bindTo(this.contextKeyService),this.registerListeners(),this.editorService.activeEditorPane&&this.onDidActiveEditorChange()}registerListeners(){this.registerMouseNavigationListener(),this._register(this.editorService.onDidActiveEditorChange(()=>this.onDidActiveEditorChange())),this._register(this.editorService.onDidOpenEditorFail(e=>this.remove(e.editor))),this._register(this.editorService.onDidCloseEditor(e=>this.onDidCloseEditor(e))),this._register(this.editorService.onDidMostRecentlyActiveEditorsChange(()=>this.handleEditorEventInRecentEditorsStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>this.onDidRemoveGroup(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidFilesChange(e))),this._register(this.storageService.onWillSaveState(()=>this.saveState())),this.registerEditorNavigationScopeChangeListener(),this._register(this.onDidChangeEditorNavigationStack(()=>this.updateContextKeys())),this._register(this.editorGroupService.onDidChangeActiveGroup(()=>this.updateContextKeys()))}onDidCloseEditor(e){this.handleEditorCloseEventInHistory(e),this.handleEditorCloseEventInReopen(e)}registerMouseNavigationListener(){let e=this._register(new Rt.EA),t=()=>{e.clear(),this.configurationService.getValue(Sd.MOUSE_NAVIGATION_SETTING)&&this._register(Rt.dA.runAndSubscribe(this.layoutService.onDidAddContainer,t=>{let{container:i,disposables:o}=t,s=o.add(new Rt.EA);s.add((0,Rt.ox)(i,Rt.tx.MOUSE_DOWN,e=>this.onMouseDownOrUp(e,!0))),s.add((0,Rt.ox)(i,Rt.tx.MOUSE_UP,e=>this.onMouseDownOrUp(e,!1))),e.add(s)},{container:this.layoutService.mainContainer,disposables:this._store}))};this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Sd.MOUSE_NAVIGATION_SETTING)&&t()})),t()}onMouseDownOrUp(e,t){switch(e.button){case 3:Rt.ex.stop(e),t&&this.goBack();break;case 4:Rt.ex.stop(e),t&&this.goForward()}}onDidRemoveGroup(e){this.handleEditorGroupRemoveInNavigationStacks(e)}onDidActiveEditorChange(){let e=this.editorGroupService.activeGroup,t=e.activeEditorPane;if(!this.lastActiveEditor||!this.editorHelper.matchesEditorIdentifier(this.lastActiveEditor,t)){if(this.lastActiveEditor=null!==t&&void 0!==t&&t.input?{editor:t.input,groupId:t.group.id}:void 0,this.activeEditorListeners.clear(),null!==t&&void 0!==t&&t.group.isTransient(t.input)){var i;this.logService.trace("[History]: ignoring transient editor change until becoming non-transient (editor: ".concat(null===(i=t.input)||void 0===i||null===(i=i.resource)||void 0===i?void 0:i.toString(),"})"));let o=e.onDidModelChange(i=>{i.kind===Pt.Wt.EDITOR_TRANSIENT&&i.editor===t.input&&!t.group.isTransient(t.input)&&(o.dispose(),this.handleActiveEditorChange(e,t))});this.activeEditorListeners.add(o)}else this.handleActiveEditorChange(e,t);(0,Pt.cn)(t)&&this.activeEditorListeners.add(t.onDidChangeSelection(i=>{var o;t.group.isTransient(t.input)?this.logService.trace("[History]: ignoring transient editor selection change (editor: ".concat(null===(o=t.input)||void 0===o||null===(o=o.resource)||void 0===o?void 0:o.toString(),"})")):this.handleActiveEditorSelectionChangeEvent(e,t,i)})),this.updateContextKeys()}}onDidFilesChange(e){e instanceof Rt.js?e.gotDeleted()&&this.remove(e):e.isOperation(Rt.Ns.DELETE)?this.remove(e):e.isOperation(Rt.Ns.MOVE)&&e.target.isFile&&this.move(e)}handleActiveEditorChange(e,t){this.handleActiveEditorChangeInHistory(t),this.handleActiveEditorChangeInNavigationStacks(e,t)}handleActiveEditorSelectionChangeEvent(e,t,i){this.handleActiveEditorSelectionChangeInNavigationStacks(e,t,i)}move(e){this.moveInHistory(e),this.moveInEditorNavigationStacks(e)}remove(e){this.removeFromHistory(e),this.removeFromEditorNavigationStacks(e),this.removeFromRecentlyClosedEditors(e),this.removeFromRecentlyOpened(e)}removeFromRecentlyOpened(e){let t;(0,Pt.rn)(e)?t=Pt.Ht.getOriginalUri(e):e instanceof Rt.js||(t=e.resource),t&&this.workspacesService.removeRecentlyOpened([t])}clear(){this.clearRecentlyOpened(),this.clearEditorNavigationStacks(),this.recentlyClosedEditors=[],this.updateContextKeys()}updateContextKeys(){this.contextKeyService.bufferChangeEvents(()=>{let e=this.getStack();this.canNavigateBackContextKey.set(e.canGoBack(Tt.a.NONE)),this.canNavigateForwardContextKey.set(e.canGoForward(Tt.a.NONE)),this.canNavigateBackInNavigationsContextKey.set(e.canGoBack(Tt.a.NAVIGATION)),this.canNavigateForwardInNavigationsContextKey.set(e.canGoForward(Tt.a.NAVIGATION)),this.canNavigateToLastNavigationLocationContextKey.set(e.canGoLast(Tt.a.NAVIGATION)),this.canNavigateBackInEditsContextKey.set(e.canGoBack(Tt.a.EDITS)),this.canNavigateForwardInEditsContextKey.set(e.canGoForward(Tt.a.EDITS)),this.canNavigateToLastEditLocationContextKey.set(e.canGoLast(Tt.a.EDITS)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)})}registerEditorNavigationScopeChangeListener(){let e=()=>{this.disposeEditorNavigationStacks();let e=this.configurationService.getValue(Sd.NAVIGATION_SCOPE_SETTING);this.editorNavigationScope="editorGroup"===e?Tt.o.EDITOR_GROUP:"editor"===e?Tt.o.EDITOR:Tt.o.DEFAULT};this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Sd.NAVIGATION_SCOPE_SETTING)&&e()})),e()}getStack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.editorGroupService.activeGroup,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.activeEditor;switch(this.editorNavigationScope){case Tt.o.EDITOR:{var i;if(!t)return new Ad;let o=this.editorScopedNavigationStacks.get(e.id);o||(o=new Map,this.editorScopedNavigationStacks.set(e.id,o));let s=null===(i=o.get(t))||void 0===i?void 0:i.stack;if(!s){let e=new Rt.EA;s=e.add(this.instantiationService.createInstance(Ed,Tt.o.EDITOR)),e.add(s.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),o.set(t,{stack:s,disposable:e})}return s}case Tt.o.EDITOR_GROUP:{var o;let t=null===(o=this.editorGroupScopedNavigationStacks.get(e.id))||void 0===o?void 0:o.stack;if(!t){let i=new Rt.EA;t=i.add(this.instantiationService.createInstance(Ed,Tt.o.EDITOR_GROUP)),i.add(t.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),this.editorGroupScopedNavigationStacks.set(e.id,{stack:t,disposable:i})}return t}case Tt.o.DEFAULT:return this.defaultScopedEditorNavigationStack||(this.defaultScopedEditorNavigationStack=this._register(this.instantiationService.createInstance(Ed,Tt.o.DEFAULT)),this._register(this.defaultScopedEditorNavigationStack.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire()))),this.defaultScopedEditorNavigationStack}}goForward(e){return this.getStack().goForward(e)}goBack(e){return this.getStack().goBack(e)}goPrevious(e){return this.getStack().goPrevious(e)}goLast(e){return this.getStack().goLast(e)}handleActiveEditorChangeInNavigationStacks(e,t){this.getStack(e,null===t||void 0===t?void 0:t.input).handleActiveEditorChange(t)}handleActiveEditorSelectionChangeInNavigationStacks(e,t,i){this.getStack(e,t.input).handleActiveEditorSelectionChange(t,i)}handleEditorCloseEventInHistory(e){let t=this.editorScopedNavigationStacks.get(e.groupId);if(t){let i=t.get(e.editor);i&&(i.disposable.dispose(),t.delete(e.editor)),0===t.size&&this.editorScopedNavigationStacks.delete(e.groupId)}}handleEditorGroupRemoveInNavigationStacks(e){var t;null===(t=this.defaultScopedEditorNavigationStack)||void 0===t||t.remove(e.id);let i=this.editorGroupScopedNavigationStacks.get(e.id);i&&(i.disposable.dispose(),this.editorGroupScopedNavigationStacks.delete(e.id))}clearEditorNavigationStacks(){this.withEachEditorNavigationStack(e=>e.clear())}removeFromEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.remove(e))}moveInEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.move(e))}withEachEditorNavigationStack(e){this.defaultScopedEditorNavigationStack&&e(this.defaultScopedEditorNavigationStack);for(let[,t]of this.editorGroupScopedNavigationStacks)e(t.stack);for(let[,t]of this.editorScopedNavigationStacks)for(let[,i]of t)e(i.stack)}disposeEditorNavigationStacks(){var e;null!==(e=this.defaultScopedEditorNavigationStack)&&void 0!==e&&e.dispose(),this.defaultScopedEditorNavigationStack=void 0;for(let[,t]of this.editorGroupScopedNavigationStacks)t.disposable.dispose();this.editorGroupScopedNavigationStacks.clear();for(let[,t]of this.editorScopedNavigationStacks)for(let[,e]of t)e.disposable.dispose();this.editorScopedNavigationStacks.clear()}openNextRecentlyUsedEditor(e){let[t,i]=this.ensureRecentlyUsedStack(e=>e-1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}openPreviouslyUsedEditor(e){let[t,i]=this.ensureRecentlyUsedStack(e=>e+1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}async doNavigateInRecentlyUsedEditorsStack(e,t){if(e){var i;let o="number"!=typeof t||!this.editorGroupService.getGroup(t);o?this.navigatingInRecentlyUsedEditorsStack=!0:this.navigatingInRecentlyUsedEditorsInGroupStack=!0;let s=null!==(i=this.editorGroupService.getGroup(e.groupId))&&void 0!==i?i:this.editorGroupService.activeGroup;try{await s.openEditor(e.editor)}finally{o?this.navigatingInRecentlyUsedEditorsStack=!1:this.navigatingInRecentlyUsedEditorsInGroupStack=!1}}}ensureRecentlyUsedStack(e,t){let i,o,s="number"==typeof t?this.editorGroupService.getGroup(t):void 0;s?(i=this.recentlyUsedEditorsInGroupStack||s.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE).map(e=>({groupId:s.id,editor:e})),o=this.recentlyUsedEditorsInGroupStackIndex):(i=this.recentlyUsedEditorsStack||this.editorService.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE),o=this.recentlyUsedEditorsStackIndex);let r=e(o);return r<0?r=0:r>i.length-1&&(r=i.length-1),s?(this.recentlyUsedEditorsInGroupStack=i,this.recentlyUsedEditorsInGroupStackIndex=r):(this.recentlyUsedEditorsStack=i,this.recentlyUsedEditorsStackIndex=r),[i,r]}handleEditorEventInRecentEditorsStack(){this.navigatingInRecentlyUsedEditorsStack||(this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0),this.navigatingInRecentlyUsedEditorsInGroupStack||(this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0)}handleEditorCloseEventInReopen(e){if(this.ignoreEditorCloseEvent)return;let{editor:t,context:i}=e;if(i===Pt.It.REPLACE||i===Pt.It.MOVE||!t.canReopen())return;let o=t.toUntyped();if(!o)return;let s=[],r=Pt.Ht.getOriginalUri(t,{supportSideBySide:Pt.Jt.BOTH});Rt.wD.isUri(r)?s.push(r):r&&s.push(...(0,Rt.AM)([r.primary,r.secondary])),this.removeFromRecentlyClosedEditors(t),this.recentlyClosedEditors.push({editorId:t.editorId,editor:o,resource:Pt.Ht.getOriginalUri(t),associatedResources:s,index:e.index,sticky:e.sticky}),this.recentlyClosedEditors.length>Sd.MAX_RECENTLY_CLOSED_EDITORS&&this.recentlyClosedEditors.shift(),this.canReopenClosedEditorContextKey.set(!0)}async reopenLastClosedEditor(){let e,t=this.recentlyClosedEditors.pop();return t&&(e=this.doReopenLastClosedEditor(t)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0),e}async doReopenLastClosedEditor(e){let t,i={pinned:!0,sticky:e.sticky,index:e.index,ignoreError:!0};if((e.sticky&&!this.editorGroupService.activeGroup.isSticky(e.index)||!e.sticky&&this.editorGroupService.activeGroup.isSticky(e.index))&&(i.index=void 0),!this.editorGroupService.activeGroup.contains(e.editor)){this.ignoreEditorCloseEvent=!0;try{t=await this.editorService.openEditor((0,xt.A)((0,xt.A)({},e.editor),{},{options:(0,xt.A)((0,xt.A)({},e.editor.options),i)}))}finally{this.ignoreEditorCloseEvent=!1}}t||((0,Rt.nN)(this.recentlyClosedEditors,e),this.reopenLastClosedEditor())}removeFromRecentlyClosedEditors(e){this.recentlyClosedEditors=this.recentlyClosedEditors.filter(t=>!(!(0,Pt.rn)(e)||t.editorId===e.editorId)||!(t.resource&&this.editorHelper.matchesFile(t.resource,e)||t.associatedResources.some(t=>this.editorHelper.matchesFile(t,e)))),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)}handleActiveEditorChangeInHistory(e){let t=null===e||void 0===e?void 0:e.input;!t||t.isDisposed()||!this.includeInHistory(t)||(this.removeFromHistory(t),this.addToHistory(t))}addToHistory(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.ensureHistoryLoaded(this.history);let i=this.editorHelper.preferResourceEditorInput(e);i&&(t?this.history.unshift(i):this.history.push(i),this.history.length>Sd.MAX_HISTORY_ITEMS&&this.editorHelper.clearOnEditorDispose(this.history.pop(),this.editorHistoryListeners),(0,Pt.rn)(e)&&this.editorHelper.onEditorDispose(e,()=>this.updateHistoryOnEditorDispose(i),this.editorHistoryListeners))}updateHistoryOnEditorDispose(e){if((0,Pt.rn)(e))if((0,Pt.mn)(e)){let t=[],i=e.primary.matches(e.secondary)?[e.primary]:[e.primary,e.secondary];for(let e of i){let i=this.editorHelper.preferResourceEditorInput(e);(0,Pt.un)(i)&&this.includeInHistory(i)&&t.push(i)}this.replaceInHistory(e,...t)}else this.removeFromHistory(e);else this.includeInHistory(e)||this.removeFromHistory(e)}includeInHistory(e){return!!(0,Pt.rn)(e)||!this.resourceExcludeMatcher.value.matches(e.resource)}removeExcludedFromHistory(){this.ensureHistoryLoaded(this.history),this.history=this.history.filter(e=>{let t=this.includeInHistory(e);return t||this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t})}moveInHistory(e){e.isOperation(Rt.Ns.MOVE)&&this.removeFromHistory(e)&&this.addToHistory({resource:e.target.resource})}removeFromHistory(e){let t=!1;return this.ensureHistoryLoaded(this.history),this.history=this.history.filter(i=>{let o=this.editorHelper.matchesEditor(e,i);return o&&(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t=!0),!o}),t}replaceInHistory(e){this.ensureHistoryLoaded(this.history);let t=!1,i=[];for(var o=arguments.length,s=new Array(o>1?o-1:0),r=1;r<o;r++)s[r-1]=arguments[r];for(let n of this.history)this.editorHelper.matchesEditor(e,n)?(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t||(i.push(...s),t=!0)):s.some(e=>this.editorHelper.matchesEditor(e,n))||i.push(n);t||i.push(...s),this.history=i}clearRecentlyOpened(){this.history=[],this.editorHistoryListeners.clearAndDisposeAll()}getHistory(){return this.ensureHistoryLoaded(this.history),this.history}ensureHistoryLoaded(e){this.history||(this.history=[],this.editorGroupService.isReady?this.loadHistory():(async()=>{await this.editorGroupService.whenReady,this.loadHistory()})())}loadHistory(){this.history=[];let e=this.loadHistoryFromStorage(),t=[...this.editorService.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE)].reverse(),i=new Set;for(let{editor:s}of t)if(this.includeInHistory(s)){if(s.resource){let e="".concat(s.resource.toString(),"/").concat(s.editorId);if(i.has(e))continue;i.add(e)}this.addToHistory(s)}for(let s of e){var o;let e="".concat(s.resource.toString(),"/").concat(null===(o=s.options)||void 0===o?void 0:o.override);!i.has(e)&&this.includeInHistory(s)&&(i.add(e),this.addToHistory(s,!1))}}loadHistoryFromStorage(){let e=[],t=this.storageService.get(Sd.HISTORY_STORAGE_KEY,Rt.Go.WORKSPACE);if(t)try{let i=JSON.parse(t);for(let t of i)if(t.editor&&t.editor.resource)try{e.push((0,xt.A)((0,xt.A)({},t.editor),{},{resource:"string"==typeof t.editor.resource?Rt.wD.parse(t.editor.resource):Rt.wD.from(t.editor.resource)}))}catch(e){(0,Rt.CN)(e)}}catch(e){(0,Rt.CN)(e)}return e}saveState(){if(!this.history)return;let e=[];for(let t of this.history)(0,Pt.rn)(t)||!(0,Pt.un)(t)||e.push({editor:(0,xt.A)((0,xt.A)({},t),{},{resource:t.resource.toString()})});this.storageService.store(Sd.HISTORY_STORAGE_KEY,JSON.stringify(e),Rt.Go.WORKSPACE,Rt.Ko.MACHINE)}getLastActiveWorkspaceRoot(e,t){let i=this.contextService.getWorkspace().folders;if(0!==i.length){if(1===i.length){let o=i[0].uri;return e&&o.scheme!==e||t&&o.authority!==t?void 0:o}for(let i of this.getHistory()){if((0,Pt.rn)(i)||e&&i.resource.scheme!==e||t&&i.resource.authority!==t)continue;let o=this.contextService.getWorkspaceFolder(i.resource);if(o)return o.uri}for(let o of i){let i=o.uri;if((!e||i.scheme===e)&&(!t||i.authority===t))return i}}}getLastActiveFile(e,t){for(let i of this.getHistory()){let o;if(o=(0,Pt.rn)(i)?Pt.Ht.getOriginalUri(i,{filterByScheme:e}):i.resource,o&&o.scheme===e&&(!t||o.authority===t))return o}}dispose(){super.dispose();for(let[,e]of this.editorGroupScopedNavigationStacks)e.disposable.dispose();for(let[,e]of this.editorScopedNavigationStacks)for(let[,t]of e)t.disposable.dispose();for(let[,e]of this.editorHistoryListeners)e.dispose()}},{_:Sd=ie},{_:ie.MOUSE_NAVIGATION_SETTING="workbench.editor.mouseBackForwardToNavigate"},{_:ie.NAVIGATION_SCOPE_SETTING="workbench.editor.navigationScope"},{_:ie.MAX_RECENTLY_CLOSED_EDITORS=20},{_:ie.MAX_HISTORY_ITEMS=200},{_:ie.HISTORY_STORAGE_KEY="history.entries"},ie);kd=Sd=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.kt),(0,Rt.Fb)(1,Pt.W),(0,Rt.Fb)(2,Rt.Ra),(0,Rt.Fb)(3,Rt.Uo),(0,Rt.Fb)(4,Rt.o_),(0,Rt.Fb)(5,Rt.ys),(0,Rt.Fb)(6,Wt.Ex),(0,Rt.Fb)(7,Rt.Ub),(0,Rt.Fb)(8,Nt.Z),(0,Rt.Fb)(9,Rt.yb),(0,Rt.Fb)(10,Rt.eb)],kd),(0,Rt.am)(Tt.On,kd,Rt.nm.Eager);var _d=class{constructor(e,t,i){this.editorIdentifier=e,this.selection=t,this.reason=i}justifiesNewNavigationEntry(e){if(this.editorIdentifier.groupId!==e.editorIdentifier.groupId||!this.editorIdentifier.editor.matches(e.editorIdentifier.editor)||!this.selection||!e.selection)return!0;let t=this.selection.compare(e.selection);return t===Pt.Vt.SIMILAR&&(e.reason===Pt.Bt.NAVIGATION||e.reason===Pt.Bt.JUMP)||t===Pt.Vt.DIFFERENT}},Ed=class extends Rt.CA{constructor(e,t){super(),this.scope=e,this.instantiationService=t,this.selectionsStack=this._register(this.instantiationService.createInstance(Dd,Tt.a.NONE,this.scope)),this.editsStack=this._register(this.instantiationService.createInstance(Dd,Tt.a.EDITS,this.scope)),this.navigationsStack=this._register(this.instantiationService.createInstance(Dd,Tt.a.NAVIGATION,this.scope)),this.stacks=[this.selectionsStack,this.editsStack,this.navigationsStack],this.onDidChange=Rt.dA.any(this.selectionsStack.onDidChange,this.editsStack.onDidChange,this.navigationsStack.onDidChange)}canGoForward(e){return this.getStack(e).canGoForward()}goForward(e){return this.getStack(e).goForward()}canGoBack(e){return this.getStack(e).canGoBack()}goBack(e){return this.getStack(e).goBack()}goPrevious(e){return this.getStack(e).goPrevious()}canGoLast(e){return this.getStack(e).canGoLast()}goLast(e){return this.getStack(e).goLast()}getStack(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt.a.NONE){case Tt.a.NONE:return this.selectionsStack;case Tt.a.EDITS:return this.editsStack;case Tt.a.NAVIGATION:return this.navigationsStack}}handleActiveEditorChange(e){this.selectionsStack.notifyNavigation(e)}handleActiveEditorSelectionChange(e,t){let i=this.selectionsStack.current;this.selectionsStack.notifyNavigation(e,t),t.reason===Pt.Bt.EDIT?this.editsStack.notifyNavigation(e,t):(t.reason===Pt.Bt.NAVIGATION||t.reason===Pt.Bt.JUMP)&&!this.selectionsStack.isNavigating()&&(t.reason===Pt.Bt.JUMP&&!this.navigationsStack.isNavigating()&&i&&this.navigationsStack.addOrReplace(i.groupId,i.editor,i.selection),this.navigationsStack.notifyNavigation(e,t))}clear(){for(let e of this.stacks)e.clear()}remove(e){for(let t of this.stacks)t.remove(e)}move(e){for(let t of this.stacks)t.move(e)}};Ed=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub)],Ed);var Ad=class{constructor(){this.onDidChange=Rt.dA.None}canGoForward(){return!1}async goForward(){}canGoBack(){return!1}async goBack(){}async goPrevious(){}canGoLast(){return!1}async goLast(){}handleActiveEditorChange(){}handleActiveEditorSelectionChange(){}clear(){}remove(){}move(){}dispose(){}},Dd=(oe=class extends Rt.CA{get current(){return this.stack[this.index]}set current(e){e&&(this.stack[this.index]=e)}constructor(e,t,i,o,s,r){super(),this.filter=e,this.scope=t,this.editorService=o,this.editorGroupService=s,this.logService=r,this._onDidChange=this._register(new Rt.uA),this.onDidChange=this._onDidChange.event,this.mapEditorToDisposable=this._register(new Rt.wA),this.mapGroupToDisposable=this._register(new Rt.wA),this.stack=[],this.index=-1,this.previousIndex=-1,this.navigating=!1,this.currentSelectionState=void 0,this.editorHelper=i.createInstance(xd),this.registerListeners()}registerListeners(){this._register(this.onDidChange(()=>this.traceStack())),this._register(this.logService.onDidChangeLogLevel(()=>this.traceStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>{this.mapGroupToDisposable.deleteAndDispose(e.id)}))}traceStack(){if(this.logService.getLevel()!==Rt.Cp.Trace)return;let e=[];for(let s of this.stack){var t,i,o;"function"==typeof(null===(t=s.selection)||void 0===t?void 0:t.log)?e.push("- group: ".concat(s.groupId,", editor: ").concat(null===(i=s.editor.resource)||void 0===i?void 0:i.toString(),", selection: ").concat(s.selection.log())):e.push("- group: ".concat(s.groupId,", editor: ").concat(null===(o=s.editor.resource)||void 0===o?void 0:o.toString(),", selection: <none>"))}0===e.length?this.trace("index: ".concat(this.index,", navigating: ").concat(this.isNavigating(),": <empty>")):this.trace("index: ".concat(this.index,", navigating: ").concat(this.isNavigating(),"\n").concat(e.join("\n"),"\n\t\t\t"))}trace(e){var t;let i,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;if(this.logService.getLevel()===Rt.Cp.Trace){switch(this.filter){case Tt.a.NONE:i="global";break;case Tt.a.EDITS:i="edits";break;case Tt.a.NAVIGATION:i="navigation"}switch(this.scope){case Tt.o.DEFAULT:o="default";break;case Tt.o.EDITOR_GROUP:o="editorGroup";break;case Tt.o.EDITOR:o="editor"}null===s?this.logService.trace("[History stack ".concat(i,"-").concat(o,"]: ").concat(e)):this.logService.trace("[History stack ".concat(i,"-").concat(o,"]: ").concat(e," (editor: ").concat(null===s||void 0===s||null===(t=s.resource)||void 0===t?void 0:t.toString(),", event: ").concat(this.traceEvent(r),")"))}}traceEvent(e){if(!e)return"<none>";switch(e.reason){case Pt.Bt.EDIT:return"edit";case Pt.Bt.NAVIGATION:return"navigation";case Pt.Bt.JUMP:return"jump";case Pt.Bt.PROGRAMMATIC:return"programmatic";case Pt.Bt.USER:return"user"}}registerGroupListeners(e){if(!this.mapGroupToDisposable.has(e)){let t=this.editorGroupService.getGroup(e);t&&this.mapGroupToDisposable.set(e,t.onWillMoveEditor(e=>this.onWillMoveEditor(e)))}}onWillMoveEditor(e){if(this.trace("onWillMoveEditor()",e.editor),this.scope!==Tt.o.EDITOR_GROUP)for(let t of this.stack)t.groupId===e.groupId&&this.editorHelper.matchesEditor(e.editor,t.editor)&&(t.groupId=e.target)}notifyNavigation(e,t){this.trace("notifyNavigation()",null===e||void 0===e?void 0:e.input,t);let i=(0,Pt.cn)(e),o=(null===e||void 0===e?void 0:e.input)&&!e.input.isDisposed();this.navigating?(this.trace("notifyNavigation() ignoring (navigating)",null===e||void 0===e?void 0:e.input,t),i&&o?(this.trace("notifyNavigation() updating current selection state",null===e||void 0===e?void 0:e.input,t),this.currentSelectionState=new _d({groupId:e.group.id,editor:e.input},e.getSelection(),null===t||void 0===t?void 0:t.reason)):(this.trace("notifyNavigation() dropping current selection state",null===e||void 0===e?void 0:e.input,t),this.currentSelectionState=void 0)):(this.trace("notifyNavigation() not ignoring",null===e||void 0===e?void 0:e.input,t),i&&o?this.onSelectionAwareEditorNavigation(e.group.id,e.input,e.getSelection(),t):(this.currentSelectionState=void 0,o&&this.onNonSelectionAwareEditorNavigation(e.group.id,e.input)))}onSelectionAwareEditorNavigation(e,t,i,o){var s;if((null===(s=this.current)||void 0===s?void 0:s.groupId)===e&&!i&&this.editorHelper.matchesEditor(this.current.editor,t))return;this.trace("onSelectionAwareEditorNavigation()",t,o);let r=new _d({groupId:e,editor:t},i,null===o||void 0===o?void 0:o.reason);!this.currentSelectionState||this.currentSelectionState.justifiesNewNavigationEntry(r)?this.doAdd(e,t,r.selection):this.doReplace(e,t,r.selection),this.currentSelectionState=r}onNonSelectionAwareEditorNavigation(e,t){var i;(null===(i=this.current)||void 0===i?void 0:i.groupId)===e&&this.editorHelper.matchesEditor(this.current.editor,t)||(this.trace("onNonSelectionAwareEditorNavigation()",t),this.doAdd(e,t))}doAdd(e,t,i){this.navigating||this.addOrReplace(e,t,i)}doReplace(e,t,i){this.navigating||this.addOrReplace(e,t,i,!0)}addOrReplace(e,t,i,o){this.registerGroupListeners(e);let s=!1;this.current&&(o||this.shouldReplaceStackEntry(this.current,{groupId:e,editor:t,selection:i}))&&(s=!0);let r=this.editorHelper.preferResourceEditorInput(t);if(!r)return;s?this.trace("replace()",r):this.trace("add()",r);let n={groupId:e,editor:r,selection:i},a=[];if(s)this.current&&a.push(this.current),this.current=n;else{if(this.stack.length>this.index+1){for(let e=this.index+1;e<this.stack.length;e++)a.push(this.stack[e]);this.stack=this.stack.slice(0,this.index+1)}this.stack.splice(this.index+1,0,n),this.stack.length>Id.MAX_STACK_SIZE?(a.push(this.stack.shift()),this.previousIndex>=0&&this.previousIndex--):this.setIndex(this.index+1,!0)}for(let d of a)this.editorHelper.clearOnEditorDispose(d.editor,this.mapEditorToDisposable);(0,Pt.rn)(r)&&this.editorHelper.onEditorDispose(r,()=>this.remove(r),this.mapEditorToDisposable),this._onDidChange.fire()}shouldReplaceStackEntry(e,t){return!(e.groupId!==t.groupId||!this.editorHelper.matchesEditor(e.editor,t.editor))&&(!e.selection||!!t.selection&&e.selection.compare(t.selection)===Pt.Vt.IDENTICAL)}move(e){if(e.isOperation(Rt.Ns.MOVE))for(let t of this.stack)this.editorHelper.matchesEditor(e,t.editor)&&(t.editor={resource:e.target.resource})}remove(e){let t=this.stack.length;this.stack=this.stack.filter(t=>{let i="number"==typeof e?t.groupId===e:this.editorHelper.matchesEditor(e,t.editor);return i&&this.editorHelper.clearOnEditorDispose(t.editor,this.mapEditorToDisposable),!i}),t!==this.stack.length&&(this.flatten(),this.index=this.stack.length-1,this.previousIndex=-1,"number"==typeof e&&this.mapGroupToDisposable.deleteAndDispose(e),this._onDidChange.fire())}flatten(){let e,t=[];for(let i of this.stack)e&&this.shouldReplaceStackEntry(i,e)||(e=i,t.push(i));this.stack=t}clear(){this.index=-1,this.previousIndex=-1,this.stack.splice(0),this.mapEditorToDisposable.clearAndDisposeAll(),this.mapGroupToDisposable.clearAndDisposeAll()}dispose(){this.clear(),super.dispose()}canGoForward(){return this.stack.length>this.index+1}async goForward(){if(!await this.maybeGoCurrent()&&this.canGoForward())return this.setIndex(this.index+1),this.navigate()}canGoBack(){return this.index>0}async goBack(){if(!await this.maybeGoCurrent()&&this.canGoBack())return this.setIndex(this.index-1),this.navigate()}async goPrevious(){if(!await this.maybeGoCurrent())return-1===this.previousIndex?this.goBack():(this.setIndex(this.previousIndex),this.navigate())}canGoLast(){return this.stack.length>0}async goLast(){if(this.canGoLast())return this.setIndex(this.stack.length-1),this.navigate()}async maybeGoCurrent(){return this.filter!==Tt.a.NONE&&!this.isCurrentSelectionActive()&&(await this.navigate(),!0)}isCurrentSelectionActive(){var e;if(null===(e=this.current)||void 0===e||!e.selection)return!1;let t=this.editorService.activeEditorPane;if(!(0,Pt.cn)(t)||t.group.id!==this.current.groupId||!t.input||!this.editorHelper.matchesEditor(t.input,this.current.editor))return!1;let i=t.getSelection();return!!i&&i.compare(this.current.selection)===Pt.Vt.IDENTICAL}setIndex(e,t){this.previousIndex=this.index,this.index=e,t||this._onDidChange.fire()}async navigate(){this.navigating=!0;try{this.current&&await this.doNavigate(this.current)}finally{this.navigating=!1}}doNavigate(e){let t=Object.create(null);return e.selection&&(t=e.selection.restore(t)),(0,Pt.rn)(e.editor)?this.editorService.openEditor(e.editor,t,e.groupId):this.editorService.openEditor((0,xt.A)((0,xt.A)({},e.editor),{},{options:(0,xt.A)((0,xt.A)({},e.editor.options),t)}),e.groupId)}isNavigating(){return this.navigating}},{_:Id=oe},{_:oe.MAX_STACK_SIZE=50},oe);Dd=Id=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Pt.kt),(0,Rt.Fb)(4,Pt.W),(0,Rt.Fb)(5,Rt.eb)],Dd);var xd=class{constructor(e,t,i,o){this.uriIdentityService=e,this.lifecycleService=t,this.fileService=i,this.pathService=o}preferResourceEditorInput(e){let t=Pt.Ht.getOriginalUri(e);if((null===t||void 0===t?void 0:t.scheme)===Rt.vT.file||(null===t||void 0===t?void 0:t.scheme)===Rt.vT.vscodeRemote||(null===t||void 0===t?void 0:t.scheme)===Rt.vT.vscodeUserData||(null===t||void 0===t?void 0:t.scheme)===this.pathService.defaultUriScheme){if((0,Pt.rn)(e)){let t=e.toUntyped();if((0,Pt.un)(t))return t}return e}return(0,Pt.rn)(e)?e:void 0}matchesEditor(e,t){return e instanceof Rt.js||e instanceof Rt.Fs?!(0,Pt.rn)(t)&&(e instanceof Rt.js?e.contains(t.resource,Rt.As.DELETED):this.matchesFile(t.resource,e)):(0,Pt.rn)(e)?(0,Pt.rn)(t)?e.matches(t):this.matchesFile(t.resource,e):(0,Pt.rn)(t)?this.matchesFile(e.resource,t):e&&t&&this.uriIdentityService.extUri.isEqual(e.resource,t.resource)}matchesFile(e,t){if(t instanceof Rt.js)return t.contains(e,Rt.As.DELETED);if(t instanceof Rt.Fs)return this.uriIdentityService.extUri.isEqualOrParent(e,t.resource);if((0,Pt.rn)(t)){let i=t.resource;return!(!i||this.lifecycleService.phase>=Pt.M.Restored&&!this.fileService.hasProvider(i))&&this.uriIdentityService.extUri.isEqual(i,e)}return this.uriIdentityService.extUri.isEqual(null===t||void 0===t?void 0:t.resource,e)}matchesEditorIdentifier(e,t){return!(null===t||void 0===t||!t.group||e.groupId!==t.group.id)&&(!!t.input&&e.editor.matches(t.input))}onEditorDispose(e,t,i){let o=Rt.dA.once(e.onWillDispose)(()=>t()),s=i.get(e);s||(s=new Rt.EA,i.set(e,s)),s.add(o)}clearOnEditorDispose(e,t){(0,Pt.rn)(e)&&t.deleteAndDispose(e)}};xd=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Zo),(0,Rt.Fb)(1,Pt.R),(0,Rt.Fb)(2,Rt.ys),(0,Rt.Fb)(3,Pt.A)],xd);(0,Rt.WM)(),(0,Rt.Fj)(),(0,Rt.IO)(),(0,Lt.a)();var Vd,Rd=new Rt.FO("activeCustomEditorId","",{type:"string",description:(0,Rt.Ij)(6430,"The viewType of the currently active custom editor.")}),Td=new Rt.FO("focusedCustomEditorIsEditable",!1);!function(e){e.default="default",e.builtin="builtin",e.option="option"}(Vd||(Vd={}));var Ld=class{constructor(e){this.id=e.id,this.displayName=e.displayName,this.providerDisplayName=e.providerDisplayName,this.priority=e.priority,this.selector=e.selector}matches(e){return this.selector.some(t=>t.filenamePattern&&(0,Lt.i)(t.filenamePattern,e))}},Wd=class{constructor(e){this.allEditors=(0,Rt.LM)(e,e=>e.id)}get length(){return this.allEditors.length}get defaultEditor(){return this.allEditors.find(e=>{switch(e.priority){case Lt.t.default:case Lt.t.builtin:return this.allEditors.every(t=>t===e||function(e,t){return(0,Lt.o)(e.priority)<(0,Lt.o)(t.priority)}(t,e));default:return!1}})}get bestAvailableEditor(){return Array.from(this.allEditors).sort((e,t)=>(0,Lt.o)(e.priority)-(0,Lt.o)(t.priority))[0]}};(0,Rt.tj)();var Fd=class{constructor(){this._references=new Map}async getAllModels(e){let t="".concat(e.toString(),"@@@"),i=[];for(let[o,s]of this._references)o.startsWith(t)&&s.model&&i.push(await s.model);return i}async get(e,t){var i;let o=this.key(e,t);return null===(i=this._references.get(o))||void 0===i?void 0:i.model}tryRetain(e,t){let i=this.key(e,t),o=this._references.get(i);if(o)return o.counter++,o.model.then(e=>({object:e,dispose:(0,Rt.ej)(()=>{--o.counter<=0&&(o.model.then(e=>e.dispose()),this._references.delete(i))})}))}add(e,t,i){let o=this.key(e,t);if(this._references.get(o))throw Error("Model already exists");return this._references.set(o,{viewType:t,model:i,counter:0}),this.tryRetain(e,t)}disposeAllModelsForView(e){for(let[t,i]of this._references)i.viewType===e&&(i.model.then(e=>e.dispose()),this._references.delete(t))}key(e,t){return"".concat(e.toString(),"@@@").concat(t)}};(0,Rt.WM)(),(0,Rt.PA)(),(0,Rt.Fj)(),(0,Rt.sm)(),(0,Rt.vb)(),(0,Qt.n)(),(0,Qt.a)(),(0,Yt.n)();var Gd=Object.freeze({viewType:"viewType",displayName:"displayName",selector:"selector",priority:"priority"}),Zd={type:"object",required:[Gd.viewType,Gd.displayName,Gd.selector],additionalProperties:!1,properties:{[Gd.viewType]:{type:"string",markdownDescription:(0,Rt.Ij)(6432,"Identifier for the custom editor. This must be unique across all custom editors, so we recommend including your extension id as part of `viewType`. The `viewType` is used when registering custom editors with `vscode.registerCustomEditorProvider` and in the `onCustomEditor:${id}` [activation event](https://code.visualstudio.com/api/references/activation-events).")},[Gd.displayName]:{type:"string",description:(0,Rt.Ij)(6433,"Human readable name of the custom editor. This is displayed to users when selecting which editor to use.")},[Gd.selector]:{type:"array",description:(0,Rt.Ij)(6434,"Set of globs that the custom editor is enabled for."),items:{type:"object",defaultSnippets:[{body:{filenamePattern:"$1"}}],additionalProperties:!1,properties:{filenamePattern:{type:"string",description:(0,Rt.Ij)(6435,"Glob that the custom editor is enabled for.")}}}},[Gd.priority]:{type:"string",markdownDeprecationMessage:(0,Rt.Ij)(6436,"Controls if the custom editor is enabled automatically when the user opens a file. This may be overridden by users using the `workbench.editorAssociations` setting."),enum:[Vd.default,Vd.option],markdownEnumDescriptions:[(0,Rt.Ij)(6437,"The editor is automatically used when the user opens a resource, provided that no other default custom editors are registered for that resource."),(0,Rt.Ij)(6438,"The editor is not automatically used when the user opens a resource, but a user can switch to the editor using the `Reopen With` command.")],default:Vd.default}}},Nd=Qt.i.registerExtensionPoint({extensionPoint:"customEditors",deps:[Yt.r],jsonSchema:{description:(0,Rt.Ij)(6439,"Contributed custom editors."),type:"array",defaultSnippets:[{body:[{[Gd.viewType]:"$1",[Gd.displayName]:"$2",[Gd.selector]:[{filenamePattern:"$3"}]}]}],items:Zd},activationEventsGenerator:function*(e){for(let t of e){let e=t[Gd.viewType];e&&(yield"onCustomEditor:".concat(e))}}}),Pd=class extends Rt.CA{constructor(){super(...arguments),this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.customEditors)}render(e){var t;let i=(null===(t=e.contributes)||void 0===t?void 0:t.customEditors)||[];return i.length?{data:{headers:[(0,Rt.Ij)(6440,"View Type"),(0,Rt.Ij)(6441,"Priority"),(0,Rt.Ij)(6442,"Filename Pattern")],rows:i.map(e=>{var t;return[e.viewType,null!==(t=e.priority)&&void 0!==t?t:"",(0,Rt.AM)(e.selector.map(e=>e.filenamePattern)).join(", ")]})},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}};Rt._b.as(Qt.t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"customEditors",label:(0,Rt.Ij)(6443,"Custom Editors"),access:{canToggle:!1},renderer:new Rt.om(Pd)}),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.Fj)(),(0,Rt.Jo)(),(0,Lt.C)(),(0,Lt.a)();var Jd=(se=class e extends Rt.CA{constructor(t){super(),this._editors=new Map,this._onChange=this._register(new Rt.uA),this.onChange=this._onChange.event,this._memento=new Lt.S(e.CUSTOM_EDITORS_STORAGE_ID,t);let i=this._memento.getMemento(Rt.Go.PROFILE,Rt.Ko.MACHINE);for(let o of i[e.CUSTOM_EDITORS_ENTRY_ID]||[])this.add(new Ld(o));this._register(Nd.setHandler(e=>{this.update(e)}))}update(t){this._editors.clear();for(let e of t)for(let t of e.value)this.add(new Ld({id:t.viewType,displayName:t.displayName,providerDisplayName:e.description.isBuiltin?(0,Rt.Ij)(6429,"Built-in"):e.description.displayName||e.description.identifier.value,selector:t.selector||[],priority:Bd(t,e.description)}));this._memento.getMemento(Rt.Go.PROFILE,Rt.Ko.MACHINE)[e.CUSTOM_EDITORS_ENTRY_ID]=Array.from(this._editors.values()),this._memento.saveMemento(),this._onChange.fire()}[Symbol.iterator](){return this._editors.values()}get(e){return this._editors.get(e)}getContributedEditors(e){return Array.from(this._editors.values()).filter(t=>t.matches(e))}add(e){this._editors.has(e.id)?console.error("Custom editor with id '".concat(e.id,"' already registered")):this._editors.set(e.id,e)}},{_:se.CUSTOM_EDITORS_STORAGE_ID="customEditors"},{_:se.CUSTOM_EDITORS_ENTRY_ID="editors"},se);function Bd(e,t){switch(e.priority){case Vd.default:return Lt.t.default;case Vd.option:return Lt.t.option;case Vd.builtin:return t.isBuiltin?Lt.t.builtin:Lt.t.default;default:return Lt.t.default}}(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.WM)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.yT)(),(0,Rt.iT)(),(0,Rt.nM)(),(0,Rt.TD)(),(0,Rt.Wy)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.Kb)(),(0,Rt.vb)(),(0,Rt.Wo)(),(0,Rt.Qo)(),(0,Pt.en)(),(0,Pt.it)(),(0,Pt.G)(),(0,Lt.a)(),(0,Lt.L)(),(0,Pt.At)(),(0,Wt.qi)(),(0,Rt.mE)({});var Od=class extends Rt.CA{constructor(e,t,i,o,s,r,n){super(),this.editorService=i,this.editorGroupService=o,this.instantiationService=s,this.uriIdentityService=r,this.editorResolverService=n,this._untitledCounter=0,this._editorResolverDisposables=this._register(new Rt.EA),this._editorCapabilities=new Map,this._onDidChangeEditorTypes=this._register(new Rt.uA),this.onDidChangeEditorTypes=this._onDidChangeEditorTypes.event,this._fileEditorFactory=Rt._b.as(Pt.Rt.EditorFactory).getFileEditorFactory(),this._models=new Fd,this._contributedEditors=this._register(new Jd(t)),this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this._register(this._contributedEditors.onChange(()=>{this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this._onDidChangeEditorTypes.fire()}));let a={contextKey:Rd,getGroupContextKeyValue:e=>this.getActiveCustomEditorId(e),onDidChange:this.onDidChangeEditorTypes},d={contextKey:Td,getGroupContextKeyValue:e=>this.getCustomEditorIsEditable(e),onDidChange:this.onDidChangeEditorTypes};this._register(this.editorGroupService.registerContextKeyProvider(a)),this._register(this.editorGroupService.registerContextKeyProvider(d)),this._register(e.onDidRunOperation(e=>{e.isOperation(Rt.Ns.MOVE)&&this.handleMovedFileInOpenedFileEditors(e.resource,this.uriIdentityService.asCanonicalUri(e.target.resource))})),this._register(Rt.Uy.addImplementation(105,"custom-editor",()=>this.withActiveCustomEditor(e=>e.undo()))),this._register(Rt.Vy.addImplementation(105,"custom-editor",()=>this.withActiveCustomEditor(e=>e.redo())))}getEditorTypes(){return[...this._contributedEditors]}withActiveCustomEditor(e){let t=this.editorService.activeEditor;return t instanceof Wt.Ki&&(e(t)||!0)}registerContributionPoints(){this._editorResolverDisposables.clear();for(let e of this._contributedEditors)for(let t of e.selector)t.filenamePattern&&this._editorResolverDisposables.add(this.editorResolverService.registerEditor(t.filenamePattern,{id:e.id,label:e.displayName,detail:e.providerDisplayName,priority:e.priority},{singlePerResource:()=>{var t,i;return!(null!==(t=null===(i=this.getCustomEditorCapabilities(e.id))||void 0===i?void 0:i.supportsMultipleEditorsPerDocument)&&void 0!==t&&t)}},{createEditorInput:(t,i)=>{let{resource:o}=t;return{editor:Wt.Ki.create(this.instantiationService,{resource:o,viewType:e.id,webviewTitle:void 0,iconPath:void 0},i.id)}},createUntitledEditorInput:(t,i)=>{let{resource:o}=t;return{editor:Wt.Ki.create(this.instantiationService,{resource:null!==o&&void 0!==o?o:Rt.wD.from({scheme:Rt.vT.untitled,authority:"Untitled-".concat(this._untitledCounter++)}),viewType:e.id,webviewTitle:void 0,iconPath:void 0},i.id)}},createDiffEditorInput:(t,i)=>({editor:this.createDiffEditorInput(t,e.id,i)})}))}createDiffEditorInput(e,t,i){let o=Wt.Ki.create(this.instantiationService,{resource:(0,Rt.$j)(e.modified.resource),viewType:t,webviewTitle:void 0,iconPath:void 0},i.id,{customClasses:"modified"}),s=Wt.Ki.create(this.instantiationService,{resource:(0,Rt.$j)(e.original.resource),viewType:t,webviewTitle:void 0,iconPath:void 0},i.id,{customClasses:"original"});return this.instantiationService.createInstance(Pt.nt,e.label,e.description,s,o,!0)}get models(){return this._models}getCustomEditor(e){return this._contributedEditors.get(e)}getContributedCustomEditors(e){return new Wd(this._contributedEditors.getContributedEditors(e))}getUserConfiguredCustomEditors(e){return new Wd((0,Rt.AM)(this.editorResolverService.getAssociationsForResource(e).map(e=>this._contributedEditors.get(e.viewType))))}getAllCustomEditors(e){return new Wd([...this.getUserConfiguredCustomEditors(e).allEditors,...this.getContributedCustomEditors(e).allEditors])}registerCustomEditorCapabilities(e,t){if(this._editorCapabilities.has(e))throw Error("Capabilities for ".concat(e," already set"));return this._editorCapabilities.set(e,t),(0,Rt.zA)(()=>{this._editorCapabilities.delete(e)})}getCustomEditorCapabilities(e){return this._editorCapabilities.get(e)}getActiveCustomEditorId(e){var t;let i=e.activeEditorPane;return null!==i&&void 0!==i&&null!==(t=i.input)&&void 0!==t&&t.resource&&(null===i||void 0===i?void 0:i.input)instanceof Wt.Ki?i.input.viewType:""}getCustomEditorIsEditable(e){var t;let i=e.activeEditorPane;return!(null===i||void 0===i||null===(t=i.input)||void 0===t||!t.resource)&&(null===i||void 0===i?void 0:i.input)instanceof Wt.Ki}async handleMovedFileInOpenedFileEditors(e,t){if((0,Rt.nT)(e).toLowerCase()===(0,Rt.nT)(t).toLowerCase())return;let i=this.getAllCustomEditors(t);if(!i.allEditors.some(e=>e.priority!==Lt.t.option))return;let o=new Map;for(let s of this.editorGroupService.groups)for(let e of s.editors)if(this._fileEditorFactory.isFileEditor(e)&&!(e instanceof Wt.Ki)&&(0,Rt.oT)(e.resource,t)){let t=o.get(s.id);t||(t=[],o.set(s.id,t)),t.push(e)}if(o.size)for(let[s,r]of o)this.editorService.replaceEditors(r.map(e=>{let o;if(i.defaultEditor){let e=i.defaultEditor.id;o=Wt.Ki.create(this.instantiationService,{resource:t,viewType:e,webviewTitle:void 0,iconPath:void 0},s)}else o={resource:t,options:{override:Pt.Ft.id}};return{editor:e,replacement:o,options:{preserveFocus:!0}}}),s)}};Od=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.ys),(0,Rt.Fb)(1,Rt.Uo),(0,Rt.Fb)(2,Pt.kt),(0,Rt.Fb)(3,Pt.W),(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.Zo),(0,Rt.Fb)(6,Lt.I)],Od),(0,Rt.Ib)(),(0,Lt.Fi)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.EO)(),(0,Rt.Zk)(),(0,Rt.s_)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.wm)(),(0,Ht.n)();var Kd,Md=class extends Rt.CA{constructor(e,t){super(),this._themeService=e,this._configurationService=t,this._cachedWebViewThemeData=void 0,this._onThemeDataChanged=this._register(new Rt.uA),this.onThemeDataChanged=this._onThemeDataChanged.event,this._register(this._themeService.onDidColorThemeChange(()=>{this._reset()}));let i=["editor.fontFamily","editor.fontWeight","editor.fontSize","editor.fontLigatures","accessibility.underlineLinks"];this._register(this._configurationService.onDidChangeConfiguration(e=>{i.some(t=>e.affectsConfiguration(t))&&this._reset()}))}getTheme(){return this._themeService.getColorTheme()}getWebviewThemeData(){if(!this._cachedWebViewThemeData){let e=this._configurationService.getValue("editor"),t=e.fontFamily||Rt.Jk.fontFamily,i=e.fontWeight||Rt.Jk.fontWeight,o=e.fontSize||Rt.Jk.fontSize,s=(new Rt.sO).validate(e.fontLigatures),r=this._configurationService.getValue("accessibility.underlineLinks"),n=this._themeService.getColorTheme(),a=(0,Rt.Ng)().getColors().reduce((e,t)=>{let i=n.getColor(t.id);return i&&(e["vscode-"+t.id.replace(".","-")]=i.toString()),e},{});this._cachedWebViewThemeData={styles:(0,xt.A)((0,xt.A)({"vscode-font-family":Lt.Ni,"vscode-font-weight":"normal","vscode-font-size":"13px","vscode-editor-font-family":t,"vscode-editor-font-weight":i,"vscode-editor-font-size":o+"px","text-link-decoration":r?"underline":"none"},a),{},{"vscode-editor-font-feature-settings":s}),activeTheme:Kd.fromTheme(n),themeLabel:n.label,themeId:n.settingsId}}return this._cachedWebViewThemeData}_reset(){this._cachedWebViewThemeData=void 0,this._onThemeDataChanged.fire()}};Md=(0,Rt.Pb)([(0,Rt.Fb)(0,Ht.t),(0,Rt.Fb)(1,Rt.o_)],Md),function(e){e.light="vscode-light",e.dark="vscode-dark",e.highContrast="vscode-high-contrast",e.highContrastLight="vscode-high-contrast-light"}(Kd||(Kd={})),function(e){e.fromTheme=function(t){switch(t.type){case Rt.Sm.LIGHT:return e.light;case Rt.Sm.DARK:return e.dark;case Rt.Sm.HIGH_CONTRAST_DARK:return e.highContrast;case Rt.Sm.HIGH_CONTRAST_LIGHT:return e.highContrastLight}}}(Kd||(Kd={})),(0,Rt.yT)(),(0,Rt.TD)(),(0,Wt.uv)();var jd=class{constructor(e,t,i){this._getExtensionLocation=e,this._getMappings=t,this.tunnelService=i,this._tunnels=new Map}async getRedirect(e,t){let i=Rt.wD.parse(t),o=(0,Wt.lv)(i);if(o)for(let s of this._getMappings())if(s.webviewPort===o.port){let t=this._getExtensionLocation();if(t&&t.scheme===Rt.vT.vscodeRemote){let t=e&&await this.getOrCreateTunnel(e,s.extensionHostPort);if(t)return t.tunnelLocalPort===s.webviewPort?void 0:encodeURI(i.with({authority:"127.0.0.1:".concat(t.tunnelLocalPort)}).toString(!0))}if(s.webviewPort!==s.extensionHostPort)return encodeURI(i.with({authority:"".concat(o.address,":").concat(s.extensionHostPort)}).toString(!0))}}async dispose(){for(let e of this._tunnels.values())await e.dispose();this._tunnels.clear()}async getOrCreateTunnel(e,t){let i,o=this._tunnels.get(t);return o||("string"==typeof await this.tunnelService.openTunnel({getAddress:async()=>e},void 0,t)&&(i=void 0),i&&this._tunnels.set(t,i),i)}};(0,Rt.av)(),(0,Rt.AD)();var Qd,Yd=new Map([[".svg","image/svg+xml"],[".txt",Rt.rv.text],[".css","text/css"],[".js","application/javascript"],[".cjs","application/javascript"],[".mjs","application/javascript"],[".json","application/json"],[".html","text/html"],[".htm","text/html"],[".xhtml","application/xhtml+xml"],[".oft","font/otf"],[".xml","application/xml"],[".wasm","application/wasm"]]);async function Hd(e,t,i,o,s){let r=function(e,t){for(let i of t)if(Xd(i,e))return Ud(e)}(e,t.roots);if(o.trace("Webview.loadLocalResource - trying to load resource. requestUri=".concat(e,", resourceToLoad=").concat(r)),!r)return o.trace("Webview.loadLocalResource - access denied. requestUri=".concat(e,", resourceToLoad=").concat(r)),Qd.AccessDenied;let n=function(e){let t=(0,Rt.kD)(e.fsPath).toLowerCase();return Yd.get(t)||(0,Rt.iv)(e.fsPath)||Rt.rv.unknown}(e);try{let a=await i.readFileStream(r,{etag:t.ifNoneMatch},s);return o.trace("Webview.loadLocalResource - Loaded. requestUri=".concat(e,", resourceToLoad=").concat(r)),new Qd.StreamSuccess(a.value,a.etag,a.mtime,n)}catch(t){var a;return t instanceof Rt.Ps&&t.fileOperationResult===Rt.Is.FILE_NOT_MODIFIED_SINCE?(o.trace("Webview.loadLocalResource - not modified. requestUri=".concat(e,", resourceToLoad=").concat(r)),new Qd.NotModified(n,null===(a=t.options)||void 0===a?void 0:a.mtime)):(o.error("Webview.loadLocalResource - Error using fileReader. requestUri=".concat(e,", resourceToLoad=").concat(r)),Qd.Failed)}}function Xd(e,t){if(e.scheme!==t.scheme)return!1;let i=(0,Rt.ND)(t.fsPath),o=(0,Rt.ND)(e.fsPath+(e.fsPath.endsWith(Rt.LD)?"":Rt.LD));return(0,Rt.kT)(e.fsPath)&&(0,Rt.kT)(t.fsPath)&&(o=o.toLowerCase(),i=i.toLowerCase()),i.startsWith(o)}function Ud(e){return e.scheme===Rt.vT.vscodeRemote?Rt.wD.from({scheme:Rt.vT.vscodeRemote,authority:e.authority,path:"/vscode-resource",query:JSON.stringify({requestResourcePath:e.path})}):e}(0,Rt.ET)(),(0,Rt.yT)(),(0,Rt.AD)(),(0,Rt.TD)(),(0,Rt.ac)(),function(e){let t;!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed",e[e.AccessDenied=2]="AccessDenied",e[e.NotModified=3]="NotModified"}(t=e.Type||(e.Type={}));e.StreamSuccess=class{constructor(e,i,o,s){this.stream=e,this.etag=i,this.mtime=o,this.mimeType=s,this.type=t.Success}},e.Failed={type:t.Failed},e.AccessDenied={type:t.AccessDenied};e.NotModified=class{constructor(e,i){this.mimeType=e,this.mtime=i,this.type=t.NotModified}}}(Qd||(Qd={})),(0,Rt.fE)(),(0,Rt.Fj)(),(0,Rt.qx)(),(0,Rt.qp)(),(0,Rt.Iw)(),(0,Rt.tO)(),(0,Tt.rn)(),(0,Wt.Mp)(),(0,Wt.Yh)(),(0,Rt.q)(),(0,Rt.dp)(),(0,Rt.ok)(),(0,Wt.Np)(),(0,Rt.r_)(),(0,Rt.Mi)(),(0,Rt.en)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.mE)({});var zd=(0,Rt.Ij)(6165,"Find"),qd=(0,Rt.Ij)(6166,"Find"),$d=(0,Rt.Ij)(6167,"Previous Match"),el=(0,Rt.Ij)(6168,"Next Match"),tl=(0,Rt.Ij)(6169,"Close"),il=310,ol=class extends Rt.Kp{constructor(e,t,i,o,s){var r;super(),this._keybindingService=s,this._isVisible=!1,this._foundMatch=!1,this._width=0,this.state=this._register(new Tt.nn),this._matchesLimit=null!==(r=e.matchesLimit)&&void 0!==r?r:2**53-1,this._findInput=this._register(new Wt.qh(null,t,{label:zd,placeholder:qd,validation:e=>{if(0===e.length||!this._findInput.getRegex())return null;try{return new RegExp(e),null}catch(e){return this._foundMatch=!1,this.updateButtons(this._foundMatch),{content:e.message}}},showCommonFindToggles:e.showCommonFindToggles,appendCaseSensitiveLabel:e.appendCaseSensitiveActionId?this._getKeybinding(e.appendCaseSensitiveActionId):void 0,appendRegexLabel:e.appendRegexActionId?this._getKeybinding(e.appendRegexActionId):void 0,appendWholeWordsLabel:e.appendWholeWordsActionId?this._getKeybinding(e.appendWholeWordsActionId):void 0,showHistoryHint:()=>(0,Wt.Pp)(s),inputBoxStyles:Rt.Ti,toggleStyles:Rt.Ai},i)),this._updateHistoryDelayer=this._register(new Rt.mw(500)),this._register(this._findInput.onInput(async t=>{(!e.checkImeCompletionState||!this._findInput.isImeSessionInProgress)&&(this._foundMatch=this._onInputChanged(),e.showResultCount&&await this.updateResultCount(),this.updateButtons(this._foundMatch),this.focusFindBox(),this._delayedUpdateHistory())})),this._findInput.setRegex(!!this.state.isRegex),this._findInput.setCaseSensitive(!!this.state.matchCase),this._findInput.setWholeWords(!!this.state.wholeWord),this._register(this._findInput.onDidOptionChange(()=>{this.state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this.state.onFindReplaceStateChange(()=>{this._findInput.setRegex(this.state.isRegex),this._findInput.setWholeWords(this.state.wholeWord),this._findInput.setCaseSensitive(this.state.matchCase),this.findFirst()}));let n={groupId:"simple-find-widget"};this.prevBtn=this._register(new Wt.kp({label:$d+(e.previousMatchActionId?this._getKeybinding(e.previousMatchActionId):""),icon:Wt.jp,hoverLifecycleOptions:n,onTrigger:()=>{this.find(!0)}},o)),this.nextBtn=this._register(new Wt.kp({label:el+(e.nextMatchActionId?this._getKeybinding(e.nextMatchActionId):""),icon:Wt.Ap,hoverLifecycleOptions:n,onTrigger:()=>{this.find(!1)}},o));let a=this._register(new Wt.kp({label:tl+(e.closeWidgetActionId?this._getKeybinding(e.closeWidgetActionId):""),icon:Rt.Z,hoverLifecycleOptions:n,onTrigger:()=>{this.hide()}},o));this._innerDomNode=(0,Rt.gx)("div"),this._innerDomNode.classList.add("simple-find-part"),this._innerDomNode.appendChild(this._findInput.domNode),this._innerDomNode.appendChild(this.prevBtn.domNode),this._innerDomNode.appendChild(this.nextBtn.domNode),this._innerDomNode.appendChild(a.domNode),this._domNode=(0,Rt.gx)("div"),this._domNode.classList.add("simple-find-part-wrapper"),this._domNode.appendChild(this._innerDomNode),this.onkeyup(this._innerDomNode,e=>{if(e.equals(Rt.YD.Escape))return this.hide(),void e.preventDefault()}),this._focusTracker=this._register((0,Rt.AS)(this._innerDomNode)),this._register(this._focusTracker.onDidFocus(this._onFocusTrackerFocus.bind(this))),this._register(this._focusTracker.onDidBlur(this._onFocusTrackerBlur.bind(this))),this._findInputFocusTracker=this._register((0,Rt.AS)(this._findInput.domNode)),this._register(this._findInputFocusTracker.onDidFocus(this._onFindInputFocusTrackerFocus.bind(this))),this._register(this._findInputFocusTracker.onDidBlur(this._onFindInputFocusTrackerBlur.bind(this))),this._register((0,Rt.ox)(this._innerDomNode,"click",e=>{e.stopPropagation()})),(null===e||void 0===e?void 0:e.showResultCount)&&(this._domNode.classList.add("result-count"),this._matchesCount=(0,Rt.gx)("div"),this._matchesCount.className="matchesCount",this._findInput.domNode.insertAdjacentElement("afterend",this._matchesCount),this._register(this._findInput.onDidChange(async()=>{await this.updateResultCount()})),this._register(this._findInput.onDidOptionChange(async()=>{this._foundMatch=this._onInputChanged(),await this.updateResultCount(),this.focusFindBox(),this._delayedUpdateHistory()})));let d=null===e||void 0===e?void 0:e.initialWidth;if(d&&(d=d<il?il:d,this._domNode.style.width="".concat(d,"px")),null!==e&&void 0!==e&&e.enableSash){let e=null!==d&&void 0!==d?d:il,t=e,i=this._register(new Rt.Qt(this._innerDomNode,this,{orientation:Rt.Xt.VERTICAL,size:1}));this._register(i.onDidStart(()=>{t=parseFloat((0,Rt.Ox)(this._domNode).width)})),this._register(i.onDidChange(i=>{let o=t+i.startX-i.currentX;o<e||(this._domNode.style.width="".concat(o,"px"))})),this._register(i.onDidReset(t=>{parseFloat((0,Rt.Ox)(this._domNode).width)===e?this._domNode.style.width="100%":this._domNode.style.width="".concat(e,"px")}))}}getVerticalSashLeft(e){return 0}get inputValue(){return this._findInput.getValue()}get focusTracker(){return this._focusTracker}_getKeybinding(e){var t;let i=null===(t=this._keybindingService)||void 0===t?void 0:t.lookupKeybinding(e);return i?" (".concat(i.getLabel(),")"):""}dispose(){var e;super.dispose(),null===(e=this._domNode)||void 0===e||e.remove()}isVisible(){return this._isVisible}getDomNode(){return this._domNode}getFindInputDomNode(){return this._findInput.domNode}reveal(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this._findInput.setValue(e),this._isVisible?this._findInput.select():(this._isVisible=!0,this.updateResultCount(),this.layout(),setTimeout(()=>{this._innerDomNode.classList.toggle("suppress-transition",!t),this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false"),this._findInput.select(),t||setTimeout(()=>{this._innerDomNode.classList.remove("suppress-transition")},0)},0))}show(e){e&&!this._isVisible&&this._findInput.setValue(e),this._isVisible=!0,this.layout(),setTimeout(()=>{this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false")},0)}hide(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isVisible&&(this._innerDomNode.classList.toggle("suppress-transition",!e),this._innerDomNode.classList.remove("visible-transition"),this._innerDomNode.setAttribute("aria-hidden","true"),setTimeout(()=>{this._isVisible=!1,this.updateButtons(this._foundMatch),this._innerDomNode.classList.remove("visible","suppress-transition")},e?200:0))}layout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._width;if(this._width=e,this._isVisible&&this._matchesCount){let t=!1;411>=e&&(t=!0),this._innerDomNode.classList.toggle("reduced-find-widget",t)}}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this))}_updateHistory(){this._findInput.inputBox.addToHistory()}_getRegexValue(){return this._findInput.getRegex()}_getWholeWordValue(){return this._findInput.getWholeWords()}_getCaseSensitiveValue(){return this._findInput.getCaseSensitive()}updateButtons(e){let t=this.inputValue.length>0;this.prevBtn.setEnabled(this._isVisible&&t&&e),this.nextBtn.setEnabled(this._isVisible&&t&&e)}focusFindBox(){this.nextBtn.focus(),this._findInput.inputBox.focus()}async updateResultCount(){if(!this._matchesCount)return void this.updateButtons(this._foundMatch);let e=await this._getResultCount();this._matchesCount.textContent="";let t=this.inputValue.length>0&&0===(null===e||void 0===e?void 0:e.resultCount);this._matchesCount.classList.toggle("no-results",t);let i="";if(null!==e&&void 0!==e&&e.resultCount){let t=String(e.resultCount);e.resultCount>=this._matchesLimit&&(t+="+");let o=String(e.resultIndex+1);"0"===o&&(o="?"),i=(0,Rt.$O)(Wt.Dp,o,t)}else i=Wt.Op;(0,Rt.a_)(this._announceSearchResults(i,this.inputValue)),this._matchesCount.appendChild((0,Rt.bx)(i)),this._foundMatch=!!e&&e.resultCount>0,this.updateButtons(this._foundMatch)}changeState(e){this.state.change(e,!1)}_announceSearchResults(e,t){return t?e===Wt.Op?""===t?(0,Rt.Ij)(6171,"{0} found",e):(0,Rt.Ij)(6172,"{0} found for '{1}'",e,t):(0,Rt.Ij)(6173,"{0} found for '{1}'",e,t):(0,Rt.Ij)(6170,"Enter search input")}},sl=(0,Rt.Rg)("simpleFindWidget.sashBorder",{dark:"#454545",light:"#C8C8C8",hcDark:"#6FC3DF",hcLight:"#0F4A85"},(0,Rt.Ij)(6174,"Border color of the sash border."));(0,Rt.fp)((e,t)=>{let i=e.getColor(sl);t.addRule(".monaco-workbench .simple-find-part .monaco-sash { background-color: ".concat(i,"; border-color: ").concat(i," }"))}),(0,Rt.Ib)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Rt.cr)(),(0,Rt.Ad)(),(0,Wt.pt)();var rl,nl=class extends ol{async _getResultCount(e){}constructor(e,t,i,o,s){super({showCommonFindToggles:!1,checkImeCompletionState:e.checkImeCompletionState,enableSash:!0},t,i,o,s),this._delegate=e,this._findWidgetFocused=Wt.lt.bindTo(i),this._register(e.hasFindResult(e=>{this.updateButtons(e),this.focusFindBox()})),this._register(e.onDidStopFind(()=>{this.updateButtons(!1)}))}find(e){let t=this.inputValue;t&&this._delegate.find(t,e)}hide(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super.hide(e),this._delegate.stopFind(!0),this._delegate.focus()}_onInputChanged(){let e=this.inputValue;return e?this._delegate.updateFind(e):this._delegate.stopFind(!1),!1}_onFocusTrackerFocus(){this._findWidgetFocused.set(!0)}_onFocusTrackerBlur(){this._findWidgetFocused.reset()}_onFindInputFocusTrackerFocus(){}_onFindInputFocusTrackerBlur(){}findFirst(){}};nl=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Cl),(0,Rt.Fb)(2,Rt.yb),(0,Rt.Fb)(3,Rt.sr),(0,Rt.Fb)(4,Rt.kd)],nl),(0,Rt.Ib)(),(0,Rt.eE)(),(0,Rt.qx)(),(0,Rt.IT)(),(0,Rt.Iw)(),(0,Rt.XC)(),(0,Rt.zk)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.yT)(),(0,Rt.PS)(),(0,Rt.TD)(),(0,Rt.hp)(),(0,Rt.Fj)(),(0,Rt.$g)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.wl)(),(0,Rt.bs)(),(0,Rt.Kb)(),(0,Rt.nb)(),(0,Rt.Rd)(),(0,Wt.Zx)(),(0,Wt.Fx)(),(0,Pt.k)(),(0,Ut.r)(),(0,Wt.pt)(),(0,Rt.XS)(),function(e){let t;!function(e){e[e.Initializing=0]="Initializing",e[e.Ready=1]="Ready"}(t=e.Type||(e.Type={}));e.Initializing=class{constructor(e){this.pendingMessages=e,this.type=t.Initializing}},e.Ready={type:t.Ready}}(rl||(rl={}));var al=class extends Rt.CA{get window(){var e;return"number"==typeof this._windowId?null===(e=(0,Rt.Vx)(this._windowId))||void 0===e?void 0:e.window:void 0}get platform(){return"browser"}get element(){return this._element}get isFocused(){if(!this._focused||!this.window)return!1;let e=(0,Rt.Tx)(this.window.document);return!(e&&e!==this.element)}constructor(e,t,i,o,s,r,n,a,d,l,c,h){var u;super(),this.webviewThemeDataProvider=t,this._environmentService=r,this._fileService=n,this._logService=a,this._remoteAuthorityResolverService=d,this._tunnelService=l,this._accessibilityService=h,this.id=(0,Rt.mp)(),this._windowId=void 0,this._expectedServiceWorkerVersion=4,this._state=new rl.Initializing([]),this._resourceLoadingCts=this._register(new Rt.Lk),this._focusDelayer=this._register(new Rt.Dw(50)),this._onDidHtmlChange=this._register(new Rt.uA),this.onDidHtmlChange=this._onDidHtmlChange.event,this._messageHandlers=new Map,this.checkImeCompletionState=!0,this.intrinsicContentSize=(0,Rt.ZS)("WebviewIntrinsicContentSize",void 0),this._disposed=!1,this._onMissingCsp=this._register(new Rt.uA),this.onMissingCsp=this._onMissingCsp.event,this._onDidClickLink=this._register(new Rt.uA),this.onDidClickLink=this._onDidClickLink.event,this._onMessage=this._register(new Rt.uA),this.onMessage=this._onMessage.event,this._onDidScroll=this._register(new Rt.uA),this.onDidScroll=this._onDidScroll.event,this._onDidWheel=this._register(new Rt.uA),this.onDidWheel=this._onDidWheel.event,this._onDidUpdateState=this._register(new Rt.uA),this.onDidUpdateState=this._onDidUpdateState.event,this._onDidFocus=this._register(new Rt.uA),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Rt.uA),this.onDidBlur=this._onDidBlur.event,this._onFatalError=this._register(new Rt.uA),this.onFatalError=this._onFatalError.event,this._onDidDispose=this._register(new Rt.uA),this.onDidDispose=this._onDidDispose.event,this._hasAlertedAboutMissingCsp=!1,this._hasFindResult=this._register(new Rt.uA),this.hasFindResult=this._hasFindResult.event,this._onDidStopFind=this._register(new Rt.uA),this.onDidStopFind=this._onDidStopFind.event,this.providedViewType=e.providedViewType,this.origin=null!==(u=e.origin)&&void 0!==u?u:this.id,this._options=e.options,this.extension=e.extension,this._content={html:"",title:e.title,options:e.contentOptions,state:void 0},this._portMappingManager=this._register(new jd(()=>{var e;return null===(e=this.extension)||void 0===e?void 0:e.location},()=>this._content.options.portMapping||[],this._tunnelService)),this._element=this._createElement(e.options,e.contentOptions),this._register(this.on("no-csp-found",()=>{this.handleNoCspFound()})),this._register(this.on("did-click-link",e=>{let{uri:t}=e;this._onDidClickLink.fire(t)})),this._register(this.on("onmessage",e=>{let{message:t,transfer:i}=e;this._onMessage.fire({message:t,transfer:i})})),this._register(this.on("did-scroll",e=>{let{scrollYPercentage:t}=e;this._onDidScroll.fire({scrollYPercentage:t})})),this._register(this.on("do-reload",()=>{this.reload()})),this._register(this.on("do-update-state",e=>{this.state=e,this._onDidUpdateState.fire(e)})),this._register(this.on("did-focus",()=>{this.handleFocusChange(!0)})),this._register(this.on("did-blur",()=>{this.handleFocusChange(!1)})),this._register(this.on("did-scroll-wheel",e=>{this._onDidWheel.fire(e)})),this._register(this.on("did-find",e=>{let{didFind:t}=e;this._hasFindResult.fire(t)})),this._register(this.on("fatal-error",e=>{s.error((0,Rt.Ij)(13157,"Error loading webview: {0}",e.message)),this._onFatalError.fire({message:e.message})})),this._register(this.on("did-keydown",e=>{this.handleKeyEvent("keydown",e)})),this._register(this.on("did-keyup",e=>{this.handleKeyEvent("keyup",e)})),this._register(this.on("did-context-menu",e=>{if(!this.element||!this._contextKeyService)return;let t=this.element.getBoundingClientRect(),i=this._contextKeyService.createOverlay([...Object.entries(e.context),["webviewId",this.providedViewType]]);o.showContextMenu({menuId:Rt.sb.WebviewContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:i,getActionsContext:()=>(0,xt.A)((0,xt.A)({},e.context),{},{webview:this.providedViewType}),getAnchor:()=>({x:t.x+e.clientX,y:t.y+e.clientY})}),this._send("set-context-menu-visible",{visible:!0})})),this._register(this.on("load-resource",async e=>{try{let t=(0,Ut.n)(e.authority),i=Rt.wD.from({scheme:e.scheme,authority:t,path:decodeURIComponent(e.path),query:e.query?decodeURIComponent(e.query):e.query});this.loadResource(e.id,i,e.ifNoneMatch)}catch(t){this._send("did-load-resource",{id:e.id,status:404,path:e.path})}})),this._register(this.on("load-localhost",e=>{this.localLocalhost(e.id,e.origin)})),this._register(Rt.dA.runAndSubscribe(t.onThemeDataChanged,()=>this.style())),this._register(h.onDidChangeReducedMotion(()=>this.style())),this._register(h.onDidChangeScreenReaderOptimized(()=>this.style())),this._register(o.onDidHideContextMenu(()=>this._send("set-context-menu-visible",{visible:!1}))),this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._register(i.onDidChangeConfiguration(e=>{e.affectsConfiguration("window.confirmBeforeClose")&&(this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._send("set-confirm-before-close",this._confirmBeforeClose))})),this._register(this.on("drag-start",()=>{this._startBlockingIframeDragEvents()})),this._register(this.on("drag",e=>{this.handleDragEvent("drag",e)})),this._register(this.on("updated-intrinsic-content-size",e=>{this.intrinsicContentSize.set({width:e.width,height:e.height},void 0,void 0)})),e.options.enableFindWidget&&(this._webviewFindWidget=this._register(c.createInstance(nl,this)))}dispose(){var e;if(this._disposed=!0,null!==(e=this.element)&&void 0!==e&&e.remove(),this._element=void 0,this._messagePort=void 0,this._state.type===rl.Type.Initializing){for(let e of this._state.pendingMessages)e.resolve(!1);this._state.pendingMessages=[]}this._onDidDispose.fire(),this._resourceLoadingCts.dispose(!0),super.dispose()}setContextKeyService(e){this._contextKeyService=e}postMessage(e,t){return this._send("message",{message:e,transfer:t})}async _send(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this._state.type===rl.Type.Initializing){let{promise:o,resolve:s}=(0,Rt.zw)();return this._state.pendingMessages.push({channel:e,data:t,transferable:i,resolve:s}),o}return this.doPostMessage(e,t,i)}_createElement(e,t){let i=(0,Rt.gx)("iframe");i.name=this.id,i.className="webview ".concat(e.customClasses||""),i.sandbox.add("allow-scripts","allow-same-origin","allow-forms","allow-pointer-lock","allow-downloads");let o=["cross-origin-isolated","autoplay","local-network-access"];return Rt.rE||o.push("clipboard-read","clipboard-write"),i.setAttribute("allow",o.join("; ")),i.style.border="none",i.style.width="100%",i.style.height="100%",i.focus=()=>{this._doFocus()},i}_initElement(e,t,i,o){var s;let r={id:this.id,parentId:o.vscodeWindowId.toString(),origin:this.origin,swVersion:String(this._expectedServiceWorkerVersion),extensionId:null!==(s=null===t||void 0===t?void 0:t.id.value)&&void 0!==s?s:"",platform:this.platform,"vscode-resource-base-authority":Ut.a,parentOrigin:o.origin};this._options.disableServiceWorker&&(r.disableServiceWorker="true"),this._environmentService.remoteAuthority&&(r.remoteAuthority=this._environmentService.remoteAuthority),i.purpose&&(r.purpose=i.purpose),r.serviceWorkerUri=Rt.gT.asBrowserUri("vs/workbench/contrib/webview/browser/pre/service-worker.js").toString(!0),r.fakeHtmlUri=Rt.gT.asBrowserUri("vs/workbench/contrib/webview/browser/pre/fake.html").toString(!0),Rt.hT.addSearchParam(r,!0,!0);let n=new URLSearchParams(r).toString();this.perfMark("init/set-src");let a=Rt.gT.asBrowserUri("vs/workbench/contrib/webview/browser/pre/index.html");this.element.setAttribute("src","".concat(a.toString(!0),"?").concat(n))}mountTo(e,t){if(this.element){this._windowId=t.vscodeWindowId,this._encodedWebviewOriginPromise=(0,Rt.LT)(t.origin,this.origin).then(e=>this._encodedWebviewOrigin=e),this._encodedWebviewOriginPromise.then(e=>{this._disposed||this._initElement(e,this.extension,this._options,t)}),this._registerMessageHandler(t),this._webviewFindWidget&&e.appendChild(this._webviewFindWidget.getDomNode());for(let t of[Rt.tx.MOUSE_DOWN,Rt.tx.MOUSE_MOVE,Rt.tx.DROP])this._register((0,Rt.ox)(e,t,()=>{this._stopBlockingIframeDragEvents()}));for(let i of[e,t])this._register((0,Rt.ox)(i,Rt.tx.DRAG_END,()=>{this._stopBlockingIframeDragEvents()}));e.id=this.id,this.perfMark("mounted"),e.appendChild(this.element)}}_registerMessageHandler(e){let t=this._register((0,Rt.ox)(e,"message",e=>{var i;if(this._encodedWebviewOrigin&&(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.target)===this.id&&"webview-ready"===e.data.channel){var o;if(this._messagePort)return;this.perfMark("webview-ready"),this._logService.trace("Webview(".concat(this.id,"): webview ready")),this._messagePort=e.ports[0],this._messagePort.onmessage=e=>{let t=this._messageHandlers.get(e.data.channel);t?null===t||void 0===t||t.forEach(t=>t(e.data.data,e)):console.log("No handlers found for '".concat(e.data.channel,"'"))},null!==(o=this.element)&&void 0!==o&&o.classList.add("ready"),this._state.type===rl.Type.Initializing&&this._state.pendingMessages.forEach(e=>{let{channel:t,data:i,resolve:o}=e;return o(this.doPostMessage(t,i))}),this._state=rl.Ready,t.dispose()}}))}perfMark(e){performance.mark("webview/webviewElement/".concat(e),{detail:{id:this.id}})}_startBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="none")}_stopBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="auto")}webviewContentEndpoint(e){let t=this._environmentService.webviewExternalEndpoint;if(!t)throw Error("'webviewExternalEndpoint' has not been configured. Webviews will not work!");let i=t.replace("{{uuid}}",e);return"/"===i[i.length-1]?i.slice(0,i.length-1):i}doPostMessage(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return!(!this.element||!this._messagePort)&&(this._messagePort.postMessage({channel:e,args:t},i),!0)}on(e,t){let i=this._messageHandlers.get(e);return i||(i=new Set,this._messageHandlers.set(e,i)),i.add(t),(0,Rt.zA)(()=>{var i;null===(i=this._messageHandlers.get(e))||void 0===i||i.delete(t)})}handleNoCspFound(){var e;this._hasAlertedAboutMissingCsp||(this._hasAlertedAboutMissingCsp=!0,(null===(e=this.extension)||void 0===e?void 0:e.id)&&this._environmentService.isExtensionDevelopment&&this._onMissingCsp.fire(this.extension.id))}reload(){this.doUpdateContent(this._content)}reinitializeAfterDismount(){this._state=new rl.Initializing([]),this._messagePort=void 0,this.mountTo(this.element.parentElement,(0,Rt.Bx)(this.element)),this.reload()}setHtml(e){this.doUpdateContent((0,xt.A)((0,xt.A)({},this._content),{},{html:e})),this._onDidHtmlChange.fire(e)}setTitle(e){this._content=(0,xt.A)((0,xt.A)({},this._content),{},{title:e}),this._send("set-title",e)}set contentOptions(e){this._logService.debug("Webview(".concat(this.id,"): will update content options")),(0,Wt.ft)(e,this._content.options)?this._logService.debug("Webview(".concat(this.id,"): skipping content options update")):this.doUpdateContent((0,xt.A)((0,xt.A)({},this._content),{},{options:e}))}set localResourcesRoot(e){this._content=(0,xt.A)((0,xt.A)({},this._content),{},{options:(0,xt.A)((0,xt.A)({},this._content.options),{},{localResourceRoots:e})})}set state(e){this._content=(0,xt.A)((0,xt.A)({},this._content),{},{state:e})}set initialScrollProgress(e){this._send("initial-scroll-position",e)}doUpdateContent(e){var t;this._logService.debug("Webview(".concat(this.id,"): will update content")),this._content=e;let i=!!this._content.options.allowScripts;this.perfMark("set-content"),this._send("content",{contents:this._content.html,title:this._content.title,options:{allowMultipleAPIAcquire:!!this._content.options.allowMultipleAPIAcquire,allowScripts:i,allowForms:null!==(t=this._content.options.allowForms)&&void 0!==t?t:i},state:this._content.state,cspSource:Ut.i,confirmBeforeClose:this._confirmBeforeClose})}style(){let{styles:e,activeTheme:t,themeLabel:i,themeId:o}=this.webviewThemeDataProvider.getWebviewThemeData();this._options.transformCssVariables&&(e=this._options.transformCssVariables(e));let s=this._accessibilityService.isMotionReduced(),r=this._accessibilityService.isScreenReaderOptimized();this._send("styles",{styles:e,activeTheme:t,themeId:o,themeLabel:i,reduceMotion:s,screenReader:r})}handleFocusChange(e){this._focused=e,e?this._onDidFocus.fire():this._onDidBlur.fire()}handleKeyEvent(e,t){var i;let o=new KeyboardEvent(e,t);Object.defineProperty(o,"target",{get:()=>this.element}),null===(i=this.window)||void 0===i||i.dispatchEvent(o)}handleDragEvent(e,t){var i;let o=new DragEvent(e,t);Object.defineProperty(o,"target",{get:()=>this.element}),null===(i=this.window)||void 0===i||i.dispatchEvent(o)}windowDidDragStart(){this._startBlockingIframeDragEvents()}windowDidDragEnd(){this._stopBlockingIframeDragEvents()}selectAll(){this.execCommand("selectAll")}copy(){this.execCommand("copy")}paste(){this.execCommand("paste")}cut(){this.execCommand("cut")}undo(){this.execCommand("undo")}redo(){this.execCommand("redo")}execCommand(e){this.element&&this._send("execCommand",e)}async loadResource(e,t,i){try{let o=await Hd(t,{ifNoneMatch:i,roots:this._content.options.localResourceRoots||[]},this._fileService,this._logService,this._resourceLoadingCts.token);switch(o.type){case Qd.Type.Success:{let i=await this.streamToBuffer(o.stream);return this._send("did-load-resource",{id:e,status:200,path:t.path,mime:o.mimeType,data:i,etag:o.etag,mtime:o.mtime},[i])}case Qd.Type.NotModified:return this._send("did-load-resource",{id:e,status:304,path:t.path,mime:o.mimeType,mtime:o.mtime});case Qd.Type.AccessDenied:return this._send("did-load-resource",{id:e,status:401,path:t.path})}}catch(o){}return this._send("did-load-resource",{id:e,status:404,path:t.path})}async streamToBuffer(e){return(await(0,Rt.$C)(e)).buffer.buffer}async localLocalhost(e,t){let i=this._environmentService.remoteAuthority,o=i?await this._remoteAuthorityResolverService.resolveAuthority(i):void 0,s=o?await this._portMappingManager.getRedirect(o.authority,t):void 0;return this._send("did-load-localhost",{id:e,origin:t,location:s})}focus(){this._doFocus(),this.handleFocusChange(!0)}_doFocus(){if(this.element){try{var e;null===(e=this.element.contentWindow)||void 0===e||e.focus()}catch(t){}this._focusDelayer.trigger(async()=>{if(this.isFocused&&this.element){var e;if(this.window){var t;let e=(0,Rt.Tx)(null===(t=this.window)||void 0===t?void 0:t.document);if(e&&e!==this.element&&"BODY"!==(null===e||void 0===e?void 0:e.tagName))return}null!==(e=this.window)&&void 0!==e&&null!==(e=e.document.body)&&void 0!==e&&e.focus(),this._send("focus",void 0)}})}}find(e,t){this.element&&this._send("find",{value:e,previous:t})}updateFind(e){!e||!this.element||this._send("find",{value:e})}stopFind(e){this.element&&(this._send("find-stop",{clearSelection:!e}),this._onDidStopFind.fire())}showFind(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this._webviewFindWidget)||void 0===e||e.reveal(void 0,t)}hideFind(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this._webviewFindWidget)||void 0===e||e.hide(t)}runFindAction(e){var t;null===(t=this._webviewFindWidget)||void 0===t||t.find(e)}};al=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.o_),(0,Rt.Fb)(3,Rt.Sl),(0,Rt.Fb)(4,Rt.Ld),(0,Rt.Fb)(5,Pt.O),(0,Rt.Fb)(6,Rt.ys),(0,Rt.Fb)(7,Rt.eb),(0,Rt.Fb)(8,Wt.Xx),(0,Rt.Fb)(9,Wt.Px),(0,Rt.Fb)(10,Rt.Ub),(0,Rt.Fb)(11,Rt.Qg)],al),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Xb)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.PS)(),(0,Rt.hp)(),(0,Rt.bb)(),(0,Nt.Q)(),(0,Wt.pt)(),(0,Wt.ey)(),(0,Rt.XS)(),(0,Rt.uC)();var dl=class extends Rt.CA{get window(){return(0,Rt.Vx)(this._windowId,!0).window}constructor(e,t,i,o){var s;super(),this._layoutService=t,this._webviewService=i,this._baseContextKeyService=o,this._isFirstLoad=!0,this._firstLoadPendingMessages=new Set,this._webview=this._register(new Rt.OA),this._webviewEvents=this._register(new Rt.EA),this._html="",this._initialScrollProgress=0,this._state=void 0,this._owner=void 0,this._windowId=void 0,this._scopedContextKeyService=this._register(new Rt.OA),this._shouldShowFindWidgetOnRestore=!1,this._isDisposed=!1,this._onDidDispose=this._register(new Rt.uA),this.onDidDispose=this._onDidDispose.event,this._onDidFocus=this._register(new Rt.uA),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Rt.uA),this.onDidBlur=this._onDidBlur.event,this._onDidClickLink=this._register(new Rt.uA),this.onDidClickLink=this._onDidClickLink.event,this._onDidScroll=this._register(new Rt.uA),this.onDidScroll=this._onDidScroll.event,this._onDidUpdateState=this._register(new Rt.uA),this.onDidUpdateState=this._onDidUpdateState.event,this._onMessage=this._register(new Rt.uA),this.onMessage=this._onMessage.event,this._onMissingCsp=this._register(new Rt.uA),this.onMissingCsp=this._onMissingCsp.event,this._onDidWheel=this._register(new Rt.uA),this.onDidWheel=this._onDidWheel.event,this._onFatalError=this._register(new Rt.uA),this.onFatalError=this._onFatalError.event,this.intrinsicContentSize=(0,Rt.ZS)("WebviewIntrinsicContentSize",void 0),this.providedViewType=e.providedViewType,this.origin=null!==(s=e.origin)&&void 0!==s?s:(0,Rt.mp)(),this._title=e.title,this._extension=e.extension,this._options=e.options,this._contentOptions=e.contentOptions}get isFocused(){var e;return!(null===(e=this._webview.value)||void 0===e||!e.isFocused)}dispose(){var e;this._isDisposed=!0,null!==(e=this._container)&&void 0!==e&&e.domNode.remove(),this._container=void 0;for(let t of this._firstLoadPendingMessages)t.resolve(!1);this._firstLoadPendingMessages.clear(),this._onDidDispose.fire(),super.dispose()}get container(){if(this._isDisposed)throw Error("OverlayWebview has been disposed");if(!this._container){let e=(0,Rt.gx)("div");e.style.position="absolute",e.style.overflow="hidden",this._container=new Rt.Jb(e),this._container.setVisibility("hidden"),this._layoutService.getContainer(this.window).appendChild(e)}return this._container.domNode}claim(e,t,i){var o;if(this._isDisposed)return;let s=this._owner;if(this._windowId!==t.vscodeWindowId&&(this.release(s),this._webview.clear(),this._webviewEvents.clear(),null!==(o=this._container)&&void 0!==o&&o.domNode.remove(),this._container=void 0),this._owner=e,this._windowId=t.vscodeWindowId,this._show(t),s!==e){var r,n,a,d;let e=i||this._baseContextKeyService;this._scopedContextKeyService.clear(),this._scopedContextKeyService.value=e.createScoped(this.container);let t=null===(r=this._findWidgetVisible)||void 0===r?void 0:r.get();null!==(n=this._findWidgetVisible)&&void 0!==n&&n.reset(),this._findWidgetVisible=Wt.ut.bindTo(e),this._findWidgetVisible.set(!!t),null!==(a=this._findWidgetEnabled)&&void 0!==a&&a.reset(),this._findWidgetEnabled=Wt.ct.bindTo(e),this._findWidgetEnabled.set(!!this.options.enableFindWidget),null===(d=this._webview.value)||void 0===d||d.setContextKeyService(this._scopedContextKeyService.value)}}release(e){var t;this._owner===e&&(this._scopedContextKeyService.clear(),this._owner=void 0,this._container&&this._container.setVisibility("hidden"),this._options.retainContextWhenHidden?(this._shouldShowFindWidgetOnRestore=!(null===(t=this._findWidgetVisible)||void 0===t||!t.get()),this.hideFind(!1)):(this._webview.clear(),this._webviewEvents.clear()))}layoutWebviewOverElement(e,t,i){if(!this._container||!this._container.domNode.parentElement)return;let o=this._layoutService.whenContainerStylesLoaded(this.window);o?o.then(()=>this.doLayoutWebviewOverElement(e,t,i)):this.doLayoutWebviewOverElement(e,t,i)}doLayoutWebviewOverElement(e,t,i){if(!this._container||!this._container.domNode.parentElement)return;let o=e.getBoundingClientRect(),s=this._container.domNode.parentElement.getBoundingClientRect(),r=(s.height-this._container.domNode.parentElement.clientHeight)/2,n=(s.width-this._container.domNode.parentElement.clientWidth)/2;if(this._container.setTop(o.top-s.top-r),this._container.setLeft(o.left-s.left-n),this._container.setWidth(t?t.width:o.width),this._container.setHeight(t?t.height:o.height),i){let{top:e,left:t,right:s,bottom:r}=function(e,t){let i=t.getBoundingClientRect();return{top:Math.max(i.top-e.top,0),right:Math.max(e.width-(e.right-i.right),0),bottom:Math.max(e.height-(e.bottom-i.bottom),0),left:Math.max(i.left-e.left,0)}}(o,i);this._container.domNode.style.clipPath="polygon(".concat(t,"px ").concat(e,"px, ").concat(s,"px ").concat(e,"px, ").concat(s,"px ").concat(r,"px, ").concat(t,"px ").concat(r,"px)")}}_show(e){var t;if(this._isDisposed)throw Error("OverlayWebview is disposed");if(!this._webview.value){var i;let t=this._webviewService.createWebviewElement({providedViewType:this.providedViewType,origin:this.origin,title:this._title,options:this._options,contentOptions:this._contentOptions,extension:this.extension});this._webview.value=t,t.state=this._state,this._scopedContextKeyService.value&&this._webview.value.setContextKeyService(this._scopedContextKeyService.value),this._html&&t.setHtml(this._html),this._options.tryRestoreScrollPosition&&(t.initialScrollProgress=this._initialScrollProgress),null!==(i=this._findWidgetEnabled)&&void 0!==i&&i.set(!!this.options.enableFindWidget),t.mountTo(this.container,e),this._webviewEvents.clear(),this._webviewEvents.add(t.onDidFocus(()=>{this._onDidFocus.fire()})),this._webviewEvents.add(t.onDidBlur(()=>{this._onDidBlur.fire()})),this._webviewEvents.add(t.onDidClickLink(e=>{this._onDidClickLink.fire(e)})),this._webviewEvents.add(t.onMessage(e=>{this._onMessage.fire(e)})),this._webviewEvents.add(t.onMissingCsp(e=>{this._onMissingCsp.fire(e)})),this._webviewEvents.add(t.onDidWheel(e=>{this._onDidWheel.fire(e)})),this._webviewEvents.add(t.onFatalError(e=>{this._onFatalError.fire(e)})),this._webviewEvents.add((0,Rt.iC)(e=>{this.intrinsicContentSize.set(e.readObservable(t.intrinsicContentSize),void 0,void 0)})),this._webviewEvents.add(t.onDidScroll(e=>{this._initialScrollProgress=e.scrollYPercentage,this._onDidScroll.fire(e)})),this._webviewEvents.add(t.onDidUpdateState(e=>{this._state=e,this._onDidUpdateState.fire(e)})),this._isFirstLoad&&this._firstLoadPendingMessages.forEach(async e=>{e.resolve(await t.postMessage(e.message,e.transfer))}),this._isFirstLoad=!1,this._firstLoadPendingMessages.clear()}this.options.retainContextWhenHidden&&this._shouldShowFindWidgetOnRestore&&(this.showFind(!1),this._shouldShowFindWidgetOnRestore=!1),null===(t=this._container)||void 0===t||t.setVisibility("visible")}setHtml(e){this._html=e,this._withWebview(t=>t.setHtml(e))}setTitle(e){this._title=e,this._withWebview(t=>t.setTitle(e))}get initialScrollProgress(){return this._initialScrollProgress}set initialScrollProgress(e){this._initialScrollProgress=e,this._withWebview(t=>t.initialScrollProgress=e)}get state(){return this._state}set state(e){this._state=e,this._withWebview(t=>t.state=e)}get extension(){return this._extension}set extension(e){this._extension=e,this._withWebview(t=>t.extension=e)}get options(){return this._options}set options(e){this._options=(0,xt.A)({customClasses:this._options.customClasses},e)}get contentOptions(){return this._contentOptions}set contentOptions(e){this._contentOptions=e,this._withWebview(t=>t.contentOptions=e)}set localResourcesRoot(e){this._withWebview(t=>t.localResourcesRoot=e)}async postMessage(e,t){if(this._webview.value)return this._webview.value.postMessage(e,t);if(this._isFirstLoad){let i,o=new Promise(e=>i=e);return this._firstLoadPendingMessages.add({message:e,transfer:t,resolve:i}),o}return!1}focus(){var e;null===(e=this._webview.value)||void 0===e||e.focus()}reload(){var e;null===(e=this._webview.value)||void 0===e||e.reload()}selectAll(){var e;null===(e=this._webview.value)||void 0===e||e.selectAll()}copy(){var e;null===(e=this._webview.value)||void 0===e||e.copy()}paste(){var e;null===(e=this._webview.value)||void 0===e||e.paste()}cut(){var e;null===(e=this._webview.value)||void 0===e||e.cut()}undo(){var e;null===(e=this._webview.value)||void 0===e||e.undo()}redo(){var e;null===(e=this._webview.value)||void 0===e||e.redo()}showFind(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._webview.value&&(this._webview.value.showFind(t),null===(e=this._findWidgetVisible)||void 0===e||e.set(!0))}hideFind(){var e,t;let i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null!==(e=this._findWidgetVisible)&&void 0!==e&&e.reset(),null===(t=this._webview.value)||void 0===t||t.hideFind(i)}runFindAction(e){var t;null===(t=this._webview.value)||void 0===t||t.runFindAction(e)}_withWebview(e){this._webview.value&&e(this._webview.value)}windowDidDragStart(){var e;null===(e=this._webview.value)||void 0===e||e.windowDidDragStart()}windowDidDragEnd(){var e;null===(e=this._webview.value)||void 0===e||e.windowDidDragEnd()}setContextKeyService(e){var t;null===(t=this._webview.value)||void 0===t||t.setContextKeyService(e)}};dl=(0,Rt.Pb)([(0,Rt.Fb)(1,Nt.Z),(0,Rt.Fb)(2,Wt.$v),(0,Rt.Fb)(3,Rt.yb)],dl),(0,Rt.Ib)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.Kb)();var ll=class extends Rt.CA{constructor(e){super(),this._instantiationService=e,this._webviews=new Set,this._onDidChangeActiveWebview=this._register(new Rt.uA),this.onDidChangeActiveWebview=this._onDidChangeActiveWebview.event,this._webviewThemeDataProvider=this._instantiationService.createInstance(Md)}get activeWebview(){return this._activeWebview}_updateActiveWebview(e){e!==this._activeWebview&&(this._activeWebview=e,this._onDidChangeActiveWebview.fire(e))}get webviews(){return this._webviews.values()}createWebviewElement(e){let t=this._instantiationService.createInstance(al,e,this._webviewThemeDataProvider);return this.registerNewWebview(t),t}createWebviewOverlay(e){let t=this._instantiationService.createInstance(dl,e);return this.registerNewWebview(t),t}registerNewWebview(e){this._webviews.add(e);let t=new Rt.EA;t.add(e.onDidFocus(()=>{this._updateActiveWebview(e)}));let i=()=>{this._activeWebview===e&&this._updateActiveWebview(void 0)};t.add(e.onDidBlur(i)),t.add(e.onDidDispose(()=>{i(),t.dispose(),this._webviews.delete(e)}))}};ll=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub)],ll),(0,Rt.Iw)(),(0,Rt.zk)(),(0,Rt.gA)(),(0,Rt.PA)();var cl,hl=class extends Rt.CA{constructor(){super(...arguments),this._resolvers=new Map,this._awaitingRevival=new Map,this._onNewResolverRegistered=this._register(new Rt.uA),this.onNewResolverRegistered=this._onNewResolverRegistered.event}register(e,t){if(this._resolvers.has(e))throw Error("View resolver already registered for ".concat(e));this._resolvers.set(e,t),this._onNewResolverRegistered.fire({viewType:e});let i=this._awaitingRevival.get(e);return i&&t.resolve(i.webview,Rt.Ik.None).then(()=>{this._awaitingRevival.delete(e),i.resolve()}),(0,Rt.zA)(()=>{this._resolvers.delete(e)})}resolve(e,t,i){let o=this._resolvers.get(e);if(!o){if(this._awaitingRevival.has(e))throw Error("View already awaiting revival");let{promise:i,resolve:o}=(0,Rt.zw)();return this._awaitingRevival.set(e,{webview:t,resolve:o}),i}return o.resolve(t,i)}};(0,Rt.fE)(),(0,Rt.Fj)(),(0,Rt.qx)(),(0,Rt.zT)(),(0,Rt.zr)(),(0,Rt.Qn)(),(0,Rt.Bn)(),(0,Rt.jn)(),(0,Rt.Mb)(),(0,Rt.gD)(),(0,Rt.Db)(),(0,Rt.tO)(),(0,Pt.ot)(),(0,Rt.PA)(),(0,Rt.mj)(),(0,Rt.Ri)(),(0,Rt.mE)({}),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(cl||(cl={}));var ul=class extends Rt.CA{constructor(e,t,i,o){if(super(),this.container=e,this.message=t,this.options=o,this.modalElement=this.container.appendChild((0,Rt.Zb)(".monaco-dialog-modal-block.dimmed")),this._register((0,Rt.lx)(this.modalElement,Rt.tx.CLICK,e=>{e.target===this.modalElement&&this.element.focus()})),this.shadowElement=this.modalElement.appendChild((0,Rt.Zb)(".dialog-shadow")),this.element=this.shadowElement.appendChild((0,Rt.Zb)(".monaco-dialog-box")),o.alignment===cl.Vertical&&this.element.classList.add("align-vertical"),o.extraClasses&&this.element.classList.add(...o.extraClasses),this.element.setAttribute("role","dialog"),this.element.tabIndex=-1,(0,Rt.Kx)(this.element),this.options.renderFooter){this.footerContainer=this.element.appendChild((0,Rt.Zb)(".dialog-footer-row"));let e=this.footerContainer.appendChild((0,Rt.Zb)("#monaco-dialog-footer.dialog-footer"));this.options.renderFooter(e);for(let t of this.footerContainer.querySelectorAll("a"))t.tabIndex=0}this.buttonStyles=o.buttonStyles,Array.isArray(i)&&i.length>0?this.buttons=i:this.options.disableDefaultAction?this.buttons=[]:this.buttons=[(0,Rt.Ij)(3,"OK")],this.buttonsContainer=this.element.appendChild((0,Rt.Zb)(".dialog-buttons-row")).appendChild((0,Rt.Zb)(".dialog-buttons"));let s=this.element.appendChild((0,Rt.Zb)(".dialog-message-row"));if(this.iconElement=s.appendChild((0,Rt.Zb)("#monaco-dialog-icon.dialog-icon")),this.iconElement.setAttribute("aria-label",this.getIconAriaLabel()),this.messageContainer=s.appendChild((0,Rt.Zb)(".dialog-message-container")),this.options.detail||this.options.renderBody){this.messageContainer.appendChild((0,Rt.Zb)(".dialog-message")).appendChild((0,Rt.Zb)("#monaco-dialog-message-text.dialog-message-text")).innerText=this.message}if(this.messageDetailElement=this.messageContainer.appendChild((0,Rt.Zb)("#monaco-dialog-message-detail.dialog-message-detail")),this.options.detail||!this.options.renderBody?this.messageDetailElement.innerText=this.options.detail?this.options.detail:t:this.messageDetailElement.style.display="none",this.options.renderBody){let e=this.messageContainer.appendChild((0,Rt.Zb)("#monaco-dialog-message-body.dialog-message-body"));this.options.renderBody(e);for(let t of this.messageContainer.querySelectorAll("a"))t.tabIndex=0}if(this.options.inputs?this.inputs=this.options.inputs.map(e=>{var t;let i=this.messageContainer.appendChild((0,Rt.Zb)(".dialog-message-input")),s=this._register(new Rt.kn(i,void 0,{placeholder:e.placeholder,type:null!==(t=e.type)&&void 0!==t?t:"text",inputBoxStyles:o.inputBoxStyles}));return e.value&&(s.value=e.value),s}):this.inputs=[],this.options.checkboxLabel){let e=this.messageContainer.appendChild((0,Rt.Zb)(".dialog-checkbox-row")),t=this.checkbox=this._register(new Rt.Rn(this.options.checkboxLabel,!!this.options.checkboxChecked,o.checkboxStyles));e.appendChild(t.domNode);let i=e.appendChild((0,Rt.Zb)(".dialog-checkbox-message"));i.innerText=this.options.checkboxLabel,this._register((0,Rt.ox)(i,Rt.tx.CLICK,()=>t.checked=!t.checked))}this.toolbarContainer=this.element.appendChild((0,Rt.Zb)(".dialog-toolbar-row")).appendChild((0,Rt.Zb)(".dialog-toolbar")),this.applyStyles()}getIconAriaLabel(){let e=(0,Rt.Ij)(4,"Info");switch(this.options.type){case"error":e=(0,Rt.Ij)(5,"Error");break;case"warning":e=(0,Rt.Ij)(6,"Warning");break;case"pending":e=(0,Rt.Ij)(7,"In Progress")}return e}updateMessage(e){this.messageDetailElement.innerText=e}async show(){return this.focusToReturn=(0,Rt.Tx)(this.container.ownerDocument),new Promise(e=>{var t;(0,Rt.fx)(this.buttonsContainer);let i=()=>{e({button:this.options.cancelId||0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0})};this._register((0,Rt.zA)(i));let o=this.buttonBar=this._register(new Rt.Jn(this.buttonsContainer,{alignment:(null===(t=this.options)||void 0===t?void 0:t.alignment)===cl.Vertical?Rt.Yn.Vertical:Rt.Yn.Horizontal})),s=this.rearrangeButtons(this.buttons,this.options.cancelId),r=t=>{e({button:s[t].index,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(e=>e.value):void 0})};s.forEach((e,t)=>{var i,n,a;let d,l=0===s[t].index,c=null===(i=this.options.buttonOptions)||void 0===i?void 0:i[null===(n=s[t])||void 0===n?void 0:n.index];if(l&&null!==(a=this.options)&&void 0!==a&&a.primaryButtonDropdown){let e=(0,Rt.zi)(this.options.primaryButtonDropdown.actions)?this.options.primaryButtonDropdown.actions.getActions():this.options.primaryButtonDropdown.actions;d=this._register(o.addButtonWithDropdown((0,xt.A)((0,xt.A)((0,xt.A)({},this.options.primaryButtonDropdown),this.buttonStyles),{},{dropdownLayer:2600,actions:e.map(e=>(0,Rt.Nb)((0,xt.A)((0,xt.A)({},e),{},{run:async()=>{await e.run(),r(t)}})))})))}else d=null!==c&&void 0!==c&&c.sublabel?this._register(o.addButtonWithDescription((0,xt.A)({secondary:!l},this.buttonStyles))):this._register(o.addButton((0,xt.A)({secondary:!l},this.buttonStyles)));null!==c&&void 0!==c&&c.styleButton&&c.styleButton(d),d.label=(0,Pt.st)(s[t].label,!0),d instanceof Rt.Xn&&null!==c&&void 0!==c&&c.sublabel&&(d.description=null===c||void 0===c?void 0:c.sublabel),this._register(d.onDidClick(e=>{e&&Rt.ex.stop(e),r(t)}))});let n=(0,Rt.Bx)(this.container);this._register((0,Rt.ox)(n,"keydown",t=>{let i=new Rt.RT(t);var o,r;if(i.equals(Rt.ZD.Alt)&&i.preventDefault(),i.equals(Rt.YD.Enter))return void(this.inputs.some(e=>e.hasFocus())&&(Rt.ex.stop(t),e({button:null!==(o=null===(r=s.find(e=>e.index!==this.options.cancelId))||void 0===r?void 0:r.index)&&void 0!==o?o:0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(e=>e.value):void 0})));if(Rt.Cj&&i.equals(Rt.ZD.CtrlCmd|Rt.YD.KeyD)){Rt.ex.stop(t);let i=s.find(e=>1===e.index&&e.index!==this.options.cancelId);return void(i&&e({button:i.index,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(e=>e.value):void 0}))}if(i.equals(Rt.YD.Space))return;let n=!1;if(i.equals(Rt.YD.Tab)||i.equals(Rt.YD.RightArrow)||i.equals(Rt.ZD.Shift|Rt.YD.Tab)||i.equals(Rt.YD.LeftArrow)){let e=[],t=-1;if(this.messageContainer){let i=this.messageContainer.querySelectorAll("a");for(let o of i)e.push(o),(0,Rt.Yx)(o)&&(t=e.length-1)}for(let i of this.inputs)e.push(i),i.hasFocus()&&(t=e.length-1);if(this.checkbox&&(e.push(this.checkbox),this.checkbox.hasFocus()&&(t=e.length-1)),this.buttonBar)for(let i of this.buttonBar.buttons)i instanceof Rt.Zn?(e.push(i.primaryButton),i.primaryButton.hasFocus()&&(t=e.length-1),e.push(i.dropdownButton),i.dropdownButton.hasFocus()&&(t=e.length-1)):(e.push(i),i.hasFocus()&&(t=e.length-1));if(this.footerContainer){let i=this.footerContainer.querySelectorAll("a");for(let o of i)e.push(o),(0,Rt.Yx)(o)&&(t=e.length-1)}if(i.equals(Rt.YD.Tab)||i.equals(Rt.YD.RightArrow))e[(t+1)%e.length].focus();else{-1===t&&(t=e.length);let i=t-1;-1===i&&(i=e.length-1),e[i].focus()}n=!0}n?Rt.ex.stop(t,!0):this.options.keyEventProcessor&&this.options.keyEventProcessor(i)},!0)),this._register((0,Rt.ox)(n,"keyup",e=>{Rt.ex.stop(e,!0);let t=new Rt.RT(e);!this.options.disableCloseAction&&t.equals(Rt.YD.Escape)&&i()},!0)),this._register((0,Rt.ox)(this.element,"focusout",e=>{e.relatedTarget&&this.element&&((0,Rt.Xx)(e.relatedTarget,this.element)||(this.focusToReturn=e.relatedTarget,e.target&&(e.target.focus(),Rt.ex.stop(e,!0))))},!1));let a="codicon-modifier-spin";if(this.iconElement.classList.remove(...Rt.Eb.asClassNameArray(Rt.mD.dialogError),...Rt.Eb.asClassNameArray(Rt.mD.dialogWarning),...Rt.Eb.asClassNameArray(Rt.mD.dialogInfo),...Rt.Eb.asClassNameArray(Rt.mD.loading),a),this.options.icon)this.iconElement.classList.add(...Rt.Eb.asClassNameArray(this.options.icon));else switch(this.options.type){case"error":this.iconElement.classList.add(...Rt.Eb.asClassNameArray(Rt.mD.dialogError));break;case"warning":this.iconElement.classList.add(...Rt.Eb.asClassNameArray(Rt.mD.dialogWarning));break;case"pending":this.iconElement.classList.add(...Rt.Eb.asClassNameArray(Rt.mD.loading),a);break;case"none":this.iconElement.classList.add("no-codicon");break;default:this.iconElement.classList.add(...Rt.Eb.asClassNameArray(Rt.mD.dialogInfo))}if(!this.options.disableCloseAction&&!this.options.disableCloseButton){let t=this._register(new Rt.Lr(this.toolbarContainer,{})),i=this._register(new Rt.Ob("dialog.close",(0,Rt.Ij)(8,"Close Dialog"),Rt.Eb.asClassName(Rt.mD.dialogClose),!0,async()=>{e({button:this.options.cancelId||0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0})}));t.push(i,{icon:!0,label:!1})}this.applyStyles(),this.element.setAttribute("aria-modal","true"),this.element.setAttribute("aria-labelledby","monaco-dialog-icon monaco-dialog-message-text"),this.element.setAttribute("aria-describedby","monaco-dialog-icon monaco-dialog-message-text monaco-dialog-message-detail monaco-dialog-message-body monaco-dialog-footer"),(0,Rt.DS)(this.element),this.inputs.length>0?(this.inputs[0].focus(),this.inputs[0].select()):s.forEach((e,t)=>{0===e.index&&o.buttons[t].focus()})})}applyStyles(){let e,t=this.options.dialogStyles,i=t.dialogForeground,o=t.dialogBackground,s=t.dialogShadow?"0 0px 8px ".concat(t.dialogShadow):"",r=t.dialogBorder?"1px solid ".concat(t.dialogBorder):"",n=t.textLinkForeground;if(this.shadowElement.style.boxShadow=s,this.element.style.color=null!==i&&void 0!==i?i:"",this.element.style.backgroundColor=null!==o&&void 0!==o?o:"",this.element.style.border=r,n)for(let l of[...this.messageContainer.getElementsByTagName("a"),...null!==(a=null===(d=this.footerContainer)||void 0===d?void 0:d.getElementsByTagName("a"))&&void 0!==a?a:[]]){var a,d;l.style.color=n}switch(this.options.type){case"none":break;case"error":e=t.errorIconForeground;break;case"warning":e=t.warningIconForeground;break;default:e=t.infoIconForeground}e&&(this.iconElement.style.color=e)}dispose(){super.dispose(),this.modalElement&&(this.modalElement=void this.modalElement.remove()),this.focusToReturn&&(0,Rt.Xx)(this.focusToReturn,this.container.getRootNode())&&(this.focusToReturn.focus(),this.focusToReturn=void 0)}rearrangeButtons(e,t){let i=e.map((e,t)=>({label:e,index:t}));if(e.length<2||this.options.alignment===cl.Vertical)return i;if(Rt.Cj||Rt.xj){if("number"==typeof t&&i[t]){let e=i.splice(t,1)[0];i.splice(1,0,e)}i.reverse()}else if(Rt.kj&&"number"==typeof t&&i[t]){let e=i.splice(t,1)[0];i.push(e)}return i}};(0,Rt.qx)(),(0,Rt.gE)(),(0,Rt._y)(),(0,Rt.Fj)(),(0,Rt.kc)(),(0,Rt.Mi)();var gl=["workbench.action.quit","workbench.action.reloadWindow","copy","cut","editor.action.selectAll","editor.action.clipboardCopyAction","editor.action.clipboardCutAction","editor.action.clipboardPasteAction"];(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.PA)(),(0,Nt.gt)(),(0,Rt.Kb)(),(0,Wt.Sx)(),(0,Wt.vx)(),(0,Rt.Iw)(),(0,Tt.dt)(),(0,Tt.zn)(),(0,Rt.Ud)(),(0,Rt.Rd)(),(0,Rt.Mb)(),(0,Rt.gA)(),(0,Rt.im)(),(0,Rt.zl)(),(0,Rt.Ad)(),(0,Rt.lr)(),(0,Wt.Df)(),(0,Wt.fx)(),(0,Wt.E_)(),(0,Nt.wt)(),(0,Rt.Hc)(),(0,Wt.M_)(),(0,Rt.qd)(),(0,Rt.mE)({});var pl=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a,d){super(),this.activityService=e,this.paneCompositeService=t,this.viewDescriptorService=i,this.viewsService=o,this.notificationService=s,this.statusbarService=r,this.layoutService=n,this.keybindingService=a,this.userActivityService=d,this.windowProgressStack=[],this.windowProgressStatusEntry=void 0}async withProgress(e,t,i){let{location:o}=e,s=async e=>{let i=this.userActivityService.markActive({extendOnly:!0,whenHeldFor:15e3});try{return await t(e)}finally{i.dispose()}},r=t=>{let i=this.viewDescriptorService.getViewContainerById(t);if(i){let o=this.viewDescriptorService.getViewContainerLocation(i);if(null!==o)return this.withPaneCompositeProgress(t,o,s,(0,xt.A)((0,xt.A)({},e),{},{location:t}))}if(null!==this.viewDescriptorService.getViewDescriptorById(t))return this.withViewProgress(t,s,(0,xt.A)((0,xt.A)({},e),{},{location:t}));throw Error("Bad progress location: ".concat(t))};if("string"==typeof o)return r(o);switch(o){case Nt.mt.Notification:{let t=e.priority;return t!==Rt.Vd.URGENT&&(this.notificationService.getFilter()===Rt.Hd.ERROR||(0,Rt.Wd)(e.source)&&this.notificationService.getFilter(e.source)===Rt.Hd.ERROR)&&(t=Rt.Vd.SILENT),this.withNotificationProgress((0,xt.A)((0,xt.A)({},e),{},{location:o,priority:t}),s,i)}case Nt.mt.Window:{let t=e.type;return e.command?this.withWindowProgress((0,xt.A)((0,xt.A)({},e),{},{location:o,type:t}),s):this.withNotificationProgress((0,xt.A)((0,xt.A)({delay:150},e),{},{priority:Rt.Vd.SILENT,location:Nt.mt.Notification,type:t}),s,i)}case Nt.mt.Explorer:return this.withPaneCompositeProgress("workbench.view.explorer",Wt.Sf.Sidebar,s,(0,xt.A)((0,xt.A)({},e),{},{location:o}));case Nt.mt.Scm:return r("workbench.scm");case Nt.mt.Extensions:return this.withPaneCompositeProgress("workbench.view.extensions",Wt.Sf.Sidebar,s,(0,xt.A)((0,xt.A)({},e),{},{location:o}));case Nt.mt.Dialog:return this.withDialogProgress(e,s,i);default:throw Error("Bad progress location: ".concat(o))}}withWindowProgress(e,t){let i=[e,new Nt.pt(()=>this.updateWindowProgress())],o=t(i[1]),s=setTimeout(()=>{s=void 0,this.windowProgressStack.unshift(i),this.updateWindowProgress(),Promise.all([(0,Rt.Gw)(150),o]).finally(()=>{let e=this.windowProgressStack.indexOf(i);this.windowProgressStack.splice(e,1),this.updateWindowProgress()})},150);return o.finally(()=>clearTimeout(s))}updateWindowProgress(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<this.windowProgressStack.length){var i;let e,o,[s,r]=this.windowProgressStack[t],n=s.title,a=null===(i=r.value)||void 0===i?void 0:i.message,d=s.command,l=s.source&&"string"!=typeof s.source?s.source.label:s.source;if(n&&a)e=(0,Rt.Ij)(14237,"{0}: {1}",n,a),o=l?(0,Rt.Ij)(14238,"[{0}] {1}: {2}",l,n,a):e;else if(n)e=n,o=l?(0,Rt.Ij)(14239,"[{0}]: {1}",l,n):e;else{if(!a)return void this.updateWindowProgress(t+1);e=a,o=l?(0,Rt.Ij)(14239,"[{0}]: {1}",l,a):e}let c={name:(0,Rt.Ij)(14240,"Progress Message"),text:e,showProgress:s.type||!0,ariaLabel:e,tooltip:(0,Rt.Gc)(o).trim(),command:d};this.windowProgressStatusEntry?this.windowProgressStatusEntry.update(c):this.windowProgressStatusEntry=this.statusbarService.addEntry(c,"status.progress",Wt.bx.LEFT,-Number.MAX_VALUE)}else null!==(e=this.windowProgressStatusEntry)&&void 0!==e&&e.dispose(),this.windowProgressStatusEntry=void 0}withNotificationProgress(e,t,i){let o,s,r,n=new class extends Rt.CA{get step(){return this._step}get done(){return this._done}constructor(){super(),this._onDidReport=this._register(new Rt.uA),this.onDidReport=this._onDidReport.event,this._onWillDispose=this._register(new Rt.uA),this.onWillDispose=this._onWillDispose.event,this._step=void 0,this._done=!1,this.promise=t(this),this.promise.finally(()=>{this.dispose()})}report(e){this._step=e,this._onDidReport.fire(e)}cancel(e){null!==i&&void 0!==i&&i(e),this.dispose()}dispose(){this._done=!0,this._onWillDispose.fire(),super.dispose()}},a=()=>{let t=new Rt.pw;return this.withWindowProgress({location:Nt.mt.Window,title:e.title?(0,Rt.ur)(e.title).toString():void 0,command:"notifications.showList",type:e.type},e=>{function i(t){t.message&&e.report({message:(0,Rt.ur)(t.message).toString()})}n.step&&i(n.step);let o=n.onDidReport(e=>i(e));return t.p.finally(()=>o.dispose()),Rt.dA.once(n.onWillDispose)(()=>t.complete()),t.p}),(0,Rt.zA)(()=>t.complete())},d=(t,i,o)=>{let s=new Rt.EA,r=e.primaryActions?Array.from(e.primaryActions):[],d=e.secondaryActions?Array.from(e.secondaryActions):[];if(e.buttons&&e.buttons.forEach((e,t)=>{let i=new class extends Rt.Ob{constructor(){super("progress.button.".concat(e),e,void 0,!0)}async run(){n.cancel(t)}};s.add(i),r.push(i)}),e.cancellable){let t=new class extends Rt.Ob{constructor(){super("progress.cancel","string"==typeof e.cancellable?e.cancellable:(0,Rt.Ij)(14241,"Cancel"),void 0,!0)}async run(){n.cancel()}};s.add(t),r.push(t)}let l,c=this.notificationService.notify({severity:Rt.Kd.Info,message:(0,Rt.Gc)(t),source:e.source,actions:{primary:r,secondary:d},progress:"number"==typeof o&&o>=0?{total:100,worked:o}:{infinite:!0},priority:i}),h=e=>{(0,Rt.MA)(l),!e&&!n.done&&(l=a())};return s.add(c.onDidChangeVisibility(h)),i===Rt.Vd.SILENT&&h(!1),Rt.dA.once(c.onDidClose)(()=>{s.dispose(),(0,Rt.MA)(l)}),c},l=t=>{r=null!==t&&void 0!==t&&t.message&&e.title?"".concat(e.title,": ").concat(t.message):e.title||(null===t||void 0===t?void 0:t.message),!o&&r&&("number"==typeof e.delay&&e.delay>0?void 0===s&&(s=setTimeout(()=>o=d(r,e.priority,null===t||void 0===t?void 0:t.increment),e.delay)):o=d(r,e.priority,null===t||void 0===t?void 0:t.increment)),o&&(r&&o.updateMessage(r),"number"==typeof(null===t||void 0===t?void 0:t.increment)&&((e,t)=>{"number"==typeof t&&t>=0?(e.progress.total(100),e.progress.worked(t)):e.progress.infinite()})(o,t.increment))};l(n.step);let c=n.onDidReport(e=>l(e));return Rt.dA.once(n.onWillDispose)(()=>c.dispose()),(async()=>{try{"number"==typeof e.delay&&e.delay>0?await n.promise:await Promise.all([(0,Rt.Gw)(800),n.promise])}finally{var t;clearTimeout(s),null===(t=o)||void 0===t||t.close()}})(),n.promise}withPaneCompositeProgress(e,t,i,o){let s=this.paneCompositeService.getProgressIndicator(e,t),r=s?this.withCompositeProgress(s,i,o):i({report:()=>{}});return t===Wt.Sf.Sidebar&&this.showOnActivityBar(e,o,r),r}withViewProgress(e,t,i){var o;let s=this.viewsService.getViewProgressIndicator(e),r=s?this.withCompositeProgress(s,t,i):t({report:()=>{}}),n=null===(o=this.viewDescriptorService.getViewContainerByViewId(e))||void 0===o?void 0:o.id;return void 0===n||this.showOnActivityBar(n,i,r),r}showOnActivityBar(e,t,i){let o,s=setTimeout(()=>{s=void 0;let t=this.activityService.showViewContainerActivity(e,{badge:new Tt.ut(()=>"")}),i=Date.now();o={dispose(){let e=Date.now()-i;e<300?setTimeout(()=>t.dispose(),300-e):t.dispose()}}},t.delay||300);i.finally(()=>{clearTimeout(s),(0,Rt.MA)(o)})}withCompositeProgress(e,t,i){let o;function s(t){var s,n;let a,d;return void 0!==t&&("number"==typeof t?a=t:"number"==typeof t.increment&&(a=null!==(s=t.total)&&void 0!==s?s:100,d=t.increment)),"number"==typeof a?(o||(o=e.show(a,i.delay),r.catch(()=>{}).finally(()=>{var e;return null===(e=o)||void 0===e?void 0:e.done()})),"number"==typeof d&&o.worked(d)):(null!==(n=o)&&void 0!==n&&n.done(),e.showWhile(r,i.delay)),o}let r=t({report:e=>{s(e)}});return s(i.total),r}withDialogProgress(e,t,i){var o;let s,r,n=new Rt.EA,a=!1,d=t=>{let o=e.buttons||[];return e.sticky||o.push(e.cancellable?"boolean"==typeof e.cancellable?(0,Rt.Ij)(14241,"Cancel"):e.cancellable:(0,Rt.Ij)(14242,"Dismiss")),s=new ul(this.layoutService.activeContainer,t,o,function(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gl;return(0,xt.A)({keyEventProcessor:e=>{let s=t.softDispatch(e,i.activeContainer);s.kind===Rt.Oc.KbFound&&s.commandId&&(o.includes(s.commandId)||Rt.ex.stop(e,!0))},buttonStyles:Rt.xi,checkboxStyles:Rt.Si,inputBoxStyles:Rt.Ti,dialogStyles:Rt.wi},e)}({type:"pending",detail:e.detail,cancelId:o.length-1,disableCloseAction:e.sticky,disableDefaultAction:e.sticky},this.keybindingService,this.layoutService)),n.add(s),s.show().then(e=>{a||null!==i&&void 0!==i&&i(e.button),(0,Rt.MA)(s)}),s},l=null!==(o=e.delay)&&void 0!==o?o:0,c=n.add(new Rt.Sw(()=>{l=0,r&&!s?s=d(r):r&&s.updateMessage(r)},0)),h=function(e){r=e,c.isScheduled()||c.schedule(l)},u=t({report:e=>{h(e.message)}});return u.finally(()=>{a=!0,(0,Rt.MA)(n)}),e.title&&h(e.title),u}};pl=(0,Rt.Pb)([(0,Rt.Fb)(0,Tt.Rn),(0,Rt.Fb)(1,Nt.Ct),(0,Rt.Fb)(2,Wt.dx),(0,Rt.Fb)(3,Wt.T_),(0,Rt.Fb)(4,Rt.Ld),(0,Rt.Fb)(5,Wt._x),(0,Rt.Fb)(6,Rt.Rl),(0,Rt.Fb)(7,Rt.kd),(0,Rt.Fb)(8,Wt.j_)],pl),(0,Rt.Ib)(),(0,Rt.gA)(),(0,Rt.nM)(),(0,Rt.im)(),(0,Rt.Kb)(),(0,Wt.Df)(),(0,Rt.PA)();var bl=class extends Rt.CA{constructor(e){super(),this.paneCompositeParts=new Map;let t=e.createInstance(zn),i=e.createInstance(ea),o=e.createInstance(ci);this.paneCompositeParts.set(Wt.Sf.Panel,t),this.paneCompositeParts.set(Wt.Sf.Sidebar,i),this.paneCompositeParts.set(Wt.Sf.AuxiliaryBar,o);let s=this._register(new Rt.EA);this.onDidPaneCompositeOpen=Rt.dA.any(...Wt.wf.map(e=>Rt.dA.map(this.paneCompositeParts.get(e).onDidPaneCompositeOpen,t=>({composite:t,viewContainerLocation:e}),s))),this.onDidPaneCompositeClose=Rt.dA.any(...Wt.wf.map(e=>Rt.dA.map(this.paneCompositeParts.get(e).onDidPaneCompositeClose,t=>({composite:t,viewContainerLocation:e}),s)))}openPaneComposite(e,t,i){return this.getPartByLocation(t).openPaneComposite(e,i)}getActivePaneComposite(e){return this.getPartByLocation(e).getActivePaneComposite()}getPaneComposite(e,t){return this.getPartByLocation(t).getPaneComposite(e)}getPaneComposites(e){return this.getPartByLocation(e).getPaneComposites()}getPinnedPaneCompositeIds(e){return this.getPartByLocation(e).getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(e){return this.getPartByLocation(e).getVisiblePaneCompositeIds()}getPaneCompositeIds(e){return this.getPartByLocation(e).getPaneCompositeIds()}getProgressIndicator(e,t){return this.getPartByLocation(t).getProgressIndicator(e)}hideActivePaneComposite(e){this.getPartByLocation(e).hideActivePaneComposite()}getLastActivePaneCompositeId(e){return this.getPartByLocation(e).getLastActivePaneCompositeId()}getPartByLocation(e){return(0,Rt.$j)(this.paneCompositeParts.get(e))}};bl=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub)],bl),(0,Rt.Fj)();var ml={open:(0,Rt.Ij)(1956,"open"),close:(0,Rt.Ij)(1957,"close"),find:(0,Rt.Ij)(1958,"find")};(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.gE)(),(0,Rt.WM)(),(0,Rt.mj)(),(0,Rt.Ml)(),(0,Rt.bs)(),(0,Wt.Md)(),(0,Rt.nb)(),(0,Rt.vb)(),(0,Pt.b)(),(0,Pt.L)(),(0,Pt.z)();var vl=class{constructor(e,t,i,o){this.fileService=e,this.environmentService=t,this.lifecycleService=i,this.logService=o}async getLogs(){return(0,Wt.jd)(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(Pt.M.Restored),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await Rt._b.as(Pt.v.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){let i=Rt.vE.document.querySelector(e);if(!i)return Promise.reject(Error("Element not found: ".concat(e)));let o=i;o.value=t;let s=new Event("input",{bubbles:!0,cancelable:!0});o.dispatchEvent(s)}async isActiveElement(e){if(Rt.vE.document.querySelector(e)!==Rt.vE.document.activeElement){let t=[],i=Rt.vE.document.activeElement;for(;i;){let e=i.tagName,o=i.id?"#".concat(i.id):"",s=(0,Rt.AM)(i.className.split(/\s+/g).map(e=>e.trim())).map(e=>".".concat(e)).join("");t.unshift("".concat(e).concat(o).concat(s)),i=i.parentElement}throw Error("Active element not found. Current active element is '".concat(t.join(" > "),"'. Looking for ").concat(e))}return!0}async getElements(e,t){let i=Rt.vE.document.querySelectorAll(e),o=[];for(let s=0;s<i.length;s++){let e=i.item(s);o.push(this.serializeElement(e,t))}return o}serializeElement(e,t){let i=Object.create(null);for(let n=0;n<e.attributes.length;n++){let t=e.attributes.item(n);t&&(i[t.name]=t.value)}let o=[];if(t)for(let n=0;n<e.children.length;n++){let t=e.children.item(n);t&&o.push(this.serializeElement(t,!0))}let{left:s,top:r}=(0,Rt.Lx)(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:i,children:o,left:s,top:r}}async getElementXY(e,t,i){let o="number"==typeof t&&"number"==typeof i?{x:t,y:i}:void 0;return this._getElementXY(e,o)}async typeInEditor(e,t){let i=Rt.vE.document.querySelector(e);if(!i)throw Error("Editor not found: ".concat(e));if((0,Rt.rS)(i)){let o=i.editContext;if(!o)throw Error("Edit context not found: ".concat(e));let s=o.selectionStart,r=o.selectionEnd,n=new TextUpdateEvent("textupdate",{updateRangeStart:s,updateRangeEnd:r,text:t,selectionStart:s+t.length,selectionEnd:s+t.length,compositionStart:0,compositionEnd:0});o.dispatchEvent(n)}else if((0,Rt.oS)(i)){let e=i.selectionStart,o=e+t.length,s=i.value;i.value=s.substr(0,e)+t+s.substr(e),i.setSelectionRange(o,o);let r=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(r)}}async getEditorSelection(e){let t=Rt.vE.document.querySelector(e);if(!t)throw Error("Editor not found: ".concat(e));if((0,Rt.rS)(t)){let i=t.editContext;if(!i)throw Error("Edit context not found: ".concat(e));return{selectionStart:i.selectionStart,selectionEnd:i.selectionEnd}}if((0,Rt.oS)(t))return{selectionStart:t.selectionStart,selectionEnd:t.selectionEnd};throw Error("Unknown type of element: ".concat(e))}async getTerminalBuffer(e){let t=Rt.vE.document.querySelector(e);if(!t)throw Error("Terminal not found: ".concat(e));let i=t.xterm;if(!i)throw Error("Xterm not found: ".concat(e));let o=[];for(let s=0;s<i.buffer.active.length;s++)o.push(i.buffer.active.getLine(s).translateToString(!0));return o}async writeInTerminal(e,t){let i=Rt.vE.document.querySelector(e);if(!i)throw Error("Element not found: ".concat(e));let o=i.xterm;if(!o)throw Error("Xterm not found: ".concat(e));o.input(t)}getLocaleInfo(){return Promise.resolve({language:Rt.Aj,locale:Rt.jj})}getLocalizedStrings(){return Promise.resolve({open:ml.open,close:ml.close,find:ml.find})}async _getElementXY(e,t){let i=Rt.vE.document.querySelector(e);if(!i)return Promise.reject(Error("Element not found: ".concat(e)));let o,s,{left:r,top:n}=(0,Rt.Lx)(i),{width:a,height:d}=(0,Rt.Dx)(i);return t?(o=r+t.x,s=n+t.y):(o=r+a/2,s=n+d/2),o=Math.round(o),s=Math.round(s),{x:o,y:s}}};vl=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.ys),(0,Rt.Fb)(1,Rt.jl),(0,Rt.Fb)(2,Pt.R),(0,Rt.Fb)(3,Rt.eb)],vl),(0,Rt.Ib)(),(0,Rt.eE)(),(0,Rt.qx)(),(0,Rt.Rp)(),(0,Rt.Iw)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.yT)(),(0,Rt.mj)(),(0,Rt.qd)(),(0,Rt.TD)(),(0,Rt.Fj)(),(0,Rt.Sb)(),(0,Rt.Ll)(),(0,Rt.Kb)(),(0,Rt.Xa)(),(0,Rt.br)(),(0,Nt.Ut)(),(0,Mt.n)(),(0,Nt.Q)(),(0,Pt.L)(),(0,Pt.z)(),(0,Lt.F)(),(0,Rt.gE)(),(0,Rt.tj)(),(0,Rt.s_)(),(0,Pt.k)(),(0,Rt.Ic)(),(0,Rt.wl)();var Cl,wl=(re=class extends Rt.CA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{getWindowsCount:Rt.Wx,getWindows:Rt.Ux},i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;super(),this.hostService=i,this.environmentService=o,this.contextMenuService=s,this.layoutService=r,this.enableWindowFocusOnElementFocus(e),this.enableMultiWindowAwareTimeout(e,t),this.registerFullScreenListeners(e.vscodeWindowId),this.registerContextMenuListeners(e)}enableWindowFocusOnElementFocus(e){let t=e.HTMLElement.prototype.focus,i=this;e.HTMLElement.prototype.focus=function(e){i.onElementFocus((0,Rt.Bx)(this)),t.apply(this,[e])}}onElementFocus(e){let t=(0,Rt.Ex)();t!==e&&t.document.hasFocus()&&(e.focus(),!this.environmentService.extensionTestsLocationURI&&!e.document.hasFocus()&&this.hostService.focus(e))}enableMultiWindowAwareTimeout(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{getWindowsCount:Rt.Wx,getWindows:Rt.Ux};function i(e){return e===Rt.vE?window:e}let o=i(e).setTimeout;Object.defineProperty(i(e),"vscodeOriginalSetTimeout",{get:()=>o});let s=i(e).clearTimeout;Object.defineProperty(i(e),"vscodeOriginalClearTimeout",{get:()=>s}),i(e).setTimeout=function(s){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,a=new Array(n>2?n-2:0),d=2;d<n;d++)a[d-2]=arguments[d];if(1===t.getWindowsCount()||"string"==typeof s||0===r)return o.apply(this,[s,r,...a]);let l=new Set,c=Cl.TIMEOUT_HANDLES++;Cl.TIMEOUT_DISPOSABLES.set(c,l);let h=(0,Rt.ej)(s,()=>{(0,Rt.MA)(l),Cl.TIMEOUT_DISPOSABLES.delete(c)});for(let{window:o,disposables:g}of t.getWindows()){var u;if((0,Rt._E)(o)&&"hidden"===o.document.visibilityState)continue;let t=!1,s=null===(u=i(e).vscodeOriginalSetTimeout)||void 0===u?void 0:u.apply(this,[function(){t||h(...arguments)},r,...a]),n=(0,Rt.zA)(()=>{var o;t=!0,null!==(o=i(e).vscodeOriginalClearTimeout)&&void 0!==o&&o.apply(this,[s]),l.delete(n)});g.add(n),l.add(n)}return c},i(e).clearTimeout=function(e){let t="number"==typeof e?Cl.TIMEOUT_DISPOSABLES.get(e):void 0;t?((0,Rt.MA)(t),Cl.TIMEOUT_DISPOSABLES.delete(e)):s.apply(this,[e])}}static async confirmOnShutdown(e,t){let i=e.get(Rt.Fl),o=e.get(Rt.o_),s=t===Pt.P.QUIT?Rt.Cj?(0,Rt.Ij)(3709,"Are you sure you want to quit?"):(0,Rt.Ij)(3710,"Are you sure you want to exit?"):(0,Rt.Ij)(3711,"Are you sure you want to close the window?"),r=t===Pt.P.QUIT?Rt.Cj?(0,Rt.Ij)(3712,"&&Quit"):(0,Rt.Ij)(3713,"&&Exit"):(0,Rt.Ij)(3714,"&&Close Window"),n=await i.confirm({message:s,primaryButton:r,checkbox:{label:(0,Rt.Ij)(3715,"Do not ask me again")}});return n.confirmed&&n.checkboxChecked&&await o.updateValue("window.confirmBeforeClose","never"),n.confirmed}registerFullScreenListeners(e){this._register(this.hostService.onDidChangeFullScreen(t=>{let{windowId:i,fullscreen:o}=t;if(i===e){let t=(0,Rt.Vx)(e);t&&(0,Rt.dE)(o,t.window)}}))}registerContextMenuListeners(e){if(e!==Rt.vE)return;let t=e=>this.layoutService.activeContainer.classList.toggle("context-menu-visible",e);this._register(this.contextMenuService.onDidShowContextMenu(()=>t(!0))),this._register(this.contextMenuService.onDidHideContextMenu(()=>t(!1)))}},{_:Cl=re},{_:re.TIMEOUT_HANDLES=-(2**53-1)},{_:re.TIMEOUT_DISPOSABLES=new Map},re);wl=Cl=(0,Rt.Pb)([(0,Rt.Fb)(2,Lt.P),(0,Rt.Fb)(3,Pt.O),(0,Rt.Fb)(4,Rt.Sl),(0,Rt.Fb)(5,Nt.Z)],wl);var yl,fl,Sl=class extends wl{constructor(e,t,i,o,s,r,n,a,d,l){super(Rt.vE,void 0,d,r,l,n),this.openerService=e,this.lifecycleService=t,this.dialogService=i,this.labelService=o,this.productService=s,this.browserEnvironmentService=r,this.instantiationService=a,this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));let e=Rt.bj&&Rt.vE.visualViewport?Rt.vE.visualViewport:Rt.vE;this._register((0,Rt.ox)(e,Rt.tx.RESIZE,()=>{this.layoutService.layout(),Rt.bj&&Rt.vE.scrollTo(0,0)})),this._register((0,Rt.ox)(this.layoutService.mainContainer,Rt.tx.WHEEL,e=>e.preventDefault(),{passive:!1})),this._register((0,Rt.ox)(this.layoutService.mainContainer,Rt.tx.CONTEXT_MENU,e=>Rt.ex.stop(e,!0))),this._register((0,Rt.ox)(this.layoutService.mainContainer,Rt.tx.DROP,e=>Rt.ex.stop(e,!0)))}onWillShutdown(){Rt.dA.toPromise(Rt.dA.any(Rt.dA.once(new Rt.Lp(Rt.vE.document.body,Rt.tx.KEY_DOWN,!0).event),Rt.dA.once(new Rt.Lp(Rt.vE.document.body,Rt.tx.MOUSE_DOWN,!0).event))).then(async()=>{await(0,Rt.Gw)(3e3),await this.dialogService.prompt({type:Rt.Kd.Error,message:(0,Rt.Ij)(3716,"An unexpected error occurred that requires a reload of this page."),detail:(0,Rt.Ij)(3717,"The workbench was unexpectedly disposed while running."),buttons:[{label:(0,Rt.Ij)(3718,"&&Reload"),run:()=>Rt.vE.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&function(e){Object.assign(Rt.vE,{driver:e.createInstance(vl)})}(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async e=>{var t;let i=!1;if(null!==(t=this.browserEnvironmentService.options)&&void 0!==t&&t.openerAllowedExternalUrlPrefixes)for(let o of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(e.startsWith(o)){i=!0;break}if((0,Rt.bT)(e,Rt.vT.http)||(0,Rt.bT)(e,Rt.vT.https))Rt.aE?(0,Rt.NS)(e,!i)||await this.dialogService.prompt({type:Rt.Kd.Warning,message:(0,Rt.Ij)(3719,"The browser blocked opening a new tab or window. Press 'Retry' to try again."),custom:{markdownDetails:[{markdown:new Rt.Pc((0,Rt.Ij)(3720,"Please allow pop-ups for this website in your [browser settings]({0}).","https://aka.ms/allow-vscode-popup"),!0)}]},buttons:[{label:(0,Rt.Ij)(3721,"&&Retry"),run:()=>i?(0,Rt.MS)(e):(0,Rt.jS)(e)}],cancelButton:!0}):i?(0,Rt.MS)(e):(0,Rt.jS)(e);else{let t=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>Rt.vE.location.href=e)};t();let i=async()=>{let e,{downloadUrl:o}=this.productService,s=[{label:(0,Rt.Ij)(3722,"&&Try Again"),run:()=>t()}];void 0===o?e=(0,Rt.Ij)(3725,"We launched {0} on your computer.\n\nIf {1} did not launch, try again below.",this.productService.nameLong,this.productService.nameLong):(e=(0,Rt.Ij)(3723,"We launched {0} on your computer.\n\nIf {1} did not launch, try again or install it below.",this.productService.nameLong,this.productService.nameLong),s.push({label:(0,Rt.Ij)(3724,"&&Install"),run:async()=>{await this.openerService.open(Rt.wD.parse(o)),i()}})),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:Rt.Kd.Info,message:(0,Rt.Ij)(3726,"All done. You can close this tab now."),detail:e,buttons:s,cancelButton:!0}))};(0,Rt.bT)(e,this.productService.urlProtocol)&&await i()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:Rt.vT.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){Rt.xb.registerCommand("workbench.experimental.requestUsbDevice",async(e,t)=>async function(e){var t;let i=navigator.usb;if(!i)return;let o=await i.requestDevice({filters:null!==(t=null===e||void 0===e?void 0:e.filters)&&void 0!==t?t:[]});return o?{deviceClass:o.deviceClass,deviceProtocol:o.deviceProtocol,deviceSubclass:o.deviceSubclass,deviceVersionMajor:o.deviceVersionMajor,deviceVersionMinor:o.deviceVersionMinor,deviceVersionSubminor:o.deviceVersionSubminor,manufacturerName:o.manufacturerName,productId:o.productId,productName:o.productName,serialNumber:o.serialNumber,usbVersionMajor:o.usbVersionMajor,usbVersionMinor:o.usbVersionMinor,usbVersionSubminor:o.usbVersionSubminor,vendorId:o.vendorId}:void 0}(t)),Rt.xb.registerCommand("workbench.experimental.requestSerialPort",async(e,t)=>async function(e){var t;let i=navigator.serial;if(!i)return;let o=await i.requestPort({filters:null!==(t=null===e||void 0===e?void 0:e.filters)&&void 0!==t?t:[]});if(!o)return;let s=o.getInfo();return{usbVendorId:s.usbVendorId,usbProductId:s.usbProductId}}(t)),Rt.xb.registerCommand("workbench.experimental.requestHidDevice",async(e,t)=>async function(e){var t;let i=navigator.hid;if(!i)return;let o=await i.requestDevice({filters:null!==(t=null===e||void 0===e?void 0:e.filters)&&void 0!==t?t:[]});if(!o.length)return;let s=o[0];return{opened:s.opened,vendorId:s.vendorId,productId:s.productId,productName:s.productName,collections:s.collections}}(t))}};Sl=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.yr),(0,Rt.Fb)(1,Pt.R),(0,Rt.Fb)(2,Rt.Fl),(0,Rt.Fb)(3,Rt.Ya),(0,Rt.Fb)(4,Nt.Ht),(0,Rt.Fb)(5,Mt.t),(0,Rt.Fb)(6,Nt.Z),(0,Rt.Fb)(7,Rt.Ub),(0,Rt.Fb)(8,Lt.P),(0,Rt.Fb)(9,Rt.Sl)],Sl),(0,Rt.Ib)(),(0,Rt.eE)(),(0,Rt.qx)(),(0,Rt.qg)(),(0,Rt.gE)(),(0,Rt.WM)(),(0,Rt.Iw)(),(0,Rt.xN)(),(0,Rt.gA)(),(0,Rt.Ic)(),(0,Rt.PA)(),(0,Rt.yc)(),(0,Rt.mj)(),(0,Rt.qd)(),(0,Rt.Fj)(),(0,Rt.s_)(),(0,Rt.wl)(),(0,Rt.Ll)(),(0,Rt.im)(),(0,Rt.ab)(),(0,Rt.hi)(),(0,Pt.k)(),(0,Lt.F)(),(0,Nt.Q)(),(0,Rt.Kb)(),function(e){e[e.Maximized=0]="Maximized",e[e.Normal=1]="Normal",e[e.Fullscreen=2]="Fullscreen"}(fl||(fl={}));var Il=new Rt.Qb(Rt.ei.width,Rt.ei.height),kl=class extends wl{constructor(e,t,i,o,s,r,n,a){super(e,void 0,s,r,n,a),this.window=e,this.container=t,this.configurationService=o,this._onWillLayout=this._register(new Rt.uA),this.onWillLayout=this._onWillLayout.event,this._onDidLayout=this._register(new Rt.uA),this.onDidLayout=this._onDidLayout.event,this._onBeforeUnload=this._register(new Rt.uA),this.onBeforeUnload=this._onBeforeUnload.event,this._onUnload=this._register(new Rt.uA),this.onUnload=this._onUnload.event,this._onWillDispose=this._register(new Rt.uA),this.onWillDispose=this._onWillDispose.event,this.compact=!1,this.whenStylesHaveLoaded=i.wait().then(()=>{}),this.registerListeners()}updateOptions(e){this.compact=e.compact}registerListeners(){this._register((0,Rt.ox)(this.window,Rt.tx.BEFORE_UNLOAD,e=>this.handleBeforeUnload(e))),this._register((0,Rt.ox)(this.window,Rt.tx.UNLOAD,()=>this.handleUnload())),this._register((0,Rt.ox)(this.window,"unhandledrejection",e=>{(0,Rt.CN)(e.reason),e.preventDefault()})),this._register((0,Rt.ox)(this.window,Rt.tx.RESIZE,()=>this.layout())),this._register((0,Rt.ox)(this.container,Rt.tx.SCROLL,()=>this.container.scrollTop=0)),Rt.Dj?(this._register((0,Rt.ox)(this.container,Rt.tx.DROP,e=>Rt.ex.stop(e,!0))),this._register((0,Rt.ox)(this.container,Rt.tx.WHEEL,e=>e.preventDefault(),{passive:!1})),this._register((0,Rt.ox)(this.container,Rt.tx.CONTEXT_MENU,e=>Rt.ex.stop(e,!0)))):(this._register((0,Rt.ox)(this.window.document.body,Rt.tx.DRAG_OVER,e=>Rt.ex.stop(e))),this._register((0,Rt.ox)(this.window.document.body,Rt.tx.DROP,e=>Rt.ex.stop(e)))),this._register((0,Rt.ox)(window,Rt.tx.UNLOAD,()=>{var e;null===(e=this.window)||void 0===e||e.close()}))}handleBeforeUnload(e){let t;if(this._onBeforeUnload.fire({veto(e){e&&(t=e)}}),t)return void this.handleVetoBeforeClose(e,t);let i=this.configurationService.getValue("window.confirmBeforeClose");("always"===i||"keyboardOnly"===i&&Rt.nx.getInstance().isModifierPressed)&&this.confirmBeforeClose(e)}handleVetoBeforeClose(e,t){this.preventUnload(e)}preventUnload(e){e.preventDefault(),e.returnValue=(0,Rt.Ij)(13741,"Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(e){this.preventUnload(e)}handleUnload(){this._onUnload.fire()}layout(){let e=(0,Rt.Dx)(this.window.document.body,Il,this.container);this._onWillLayout.fire(e),this._onDidLayout.fire(e)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:(0,Rt.$T)(this.window),compact:this.compact}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};kl=(0,Rt.Pb)([(0,Rt.Fb)(3,Rt.o_),(0,Rt.Fb)(4,Lt.P),(0,Rt.Fb)(5,Pt.O),(0,Rt.Fb)(6,Rt.Sl),(0,Rt.Fb)(7,Nt.Z)],kl);var _l=(ne=class extends Rt.CA{constructor(e,t,i,o,s,r,n){super(),this.layoutService=e,this.dialogService=t,this.configurationService=i,this.telemetryService=o,this.hostService=s,this.environmentService=r,this.contextMenuService=n,this._onDidOpenAuxiliaryWindow=this._register(new Rt.uA),this.onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event,this.windows=new Map}async open(e){var t;(0,Rt.bc)("code/auxiliaryWindow/willOpen");let i=await this.openWindow(e);if(!i)throw Error((0,Rt.Ij)(13742,"Unable to open a new window."));(0,Rt.hE)(i,await this.resolveWindowId(i));let o=new Rt.EA,{container:s,stylesLoaded:r}=this.createContainer(i,o,e),n=this.createAuxiliaryWindow(i,s,r);n.updateOptions({compact:null!==(t=null===e||void 0===e?void 0:e.compact)&&void 0!==t&&t});let a=new Rt.EA;this.windows.set(i.vscodeWindowId,n),a.add((0,Rt.zA)(()=>this.windows.delete(i.vscodeWindowId)));let d=new Rt.EA;return Rt.dA.once(n.onWillDispose)(()=>{i.close(),o.dispose(),a.dispose(),d.dispose()}),a.add((0,Rt._S)(i)),this._onDidOpenAuxiliaryWindow.fire({window:n,disposables:d}),(0,Rt.bc)("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!(null===e||void 0===e||!e.bounds)}),n}createAuxiliaryWindow(e,t,i){return new kl(e,t,i,this.configurationService,this.hostService,this.environmentService,this.contextMenuService,this.layoutService)}async openWindow(e){var t,i,o,s,r,n,a,d;let l=(0,Rt.Ex)(),c=l.screenX,h=l.screenY,u=l.outerWidth,g=l.outerHeight,p=Rt.ei,b=Math.max(null!==(t=null===e||void 0===e||null===(i=e.bounds)||void 0===i?void 0:i.width)&&void 0!==t?t:p.width,Rt.ci.WIDTH),m=Math.max(null!==(o=null===e||void 0===e||null===(s=e.bounds)||void 0===s?void 0:s.height)&&void 0!==o?o:p.height,Rt.ci.HEIGHT),v={x:null!==(r=null===e||void 0===e||null===(n=e.bounds)||void 0===n?void 0:n.x)&&void 0!==r?r:Math.max(c+u/2-b/2,0),y:null!==(a=null===e||void 0===e||null===(d=e.bounds)||void 0===d?void 0:d.y)&&void 0!==a?a:Math.max(h+g/2-m/2,0),width:b,height:m};(null===e||void 0===e||!e.bounds)&&v.x===c&&v.y===h&&(v=(0,xt.A)((0,xt.A)({},v),{},{x:v.x+30,y:v.y+30}));let C=(0,Rt.AM)(["popup=yes","left=".concat(v.x),"top=".concat(v.y),"width=".concat(v.width),"height=".concat(v.height),null!==e&&void 0!==e&&e.nativeTitlebar?"window-native-titlebar=yes":void 0,null!==e&&void 0!==e&&e.disableFullscreen?"window-disable-fullscreen=yes":void 0,null!==e&&void 0!==e&&e.alwaysOnTop?"window-always-on-top=yes":void 0,(null===e||void 0===e?void 0:e.mode)===fl.Maximized?"window-maximized=yes":void 0,(null===e||void 0===e?void 0:e.mode)===fl.Fullscreen?"window-fullscreen=yes":void 0]),w=Rt.vE.open(Rt.yj?"":"about:blank",void 0,C.join(","));return!w&&Rt.Dj?(await this.dialogService.prompt({type:Rt.Kd.Warning,message:(0,Rt.Ij)(13743,"The browser blocked opening a new window. Press 'Retry' to try again."),custom:{markdownDetails:[{markdown:new Rt.Pc((0,Rt.Ij)(13744,"Please allow pop-ups for this website in your [browser settings]({0}).","https://aka.ms/allow-vscode-popup"),!0)}]},buttons:[{label:(0,Rt.Ij)(13745,"&&Retry"),run:()=>this.openWindow(e)}],cancelButton:!0})).result:null===w||void 0===w?void 0:w.window}async resolveWindowId(e){return yl.WINDOW_IDS++}createContainer(e,t,i){this.applyMeta(e);let{stylesLoaded:o}=this.applyCSS(e,t);return{stylesLoaded:o,container:this.applyHTML(e,t)}}applyMeta(e){for(let i of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){let t=Rt.vE.document.querySelector(i);if(t){let o=(0,Rt.yx)(e.document.head);if((0,Rt.mx)(t,o),'meta[http-equiv="Content-Security-Policy"]'===i){let e=o.getAttribute("content");e&&o.setAttribute("content",e.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}let t=Rt.vE.document.querySelector('link[rel="icon"]');t&&(0,Rt.mx)(t,(0,Rt.vx)(e.document.head))}applyCSS(e,t){(0,Rt.bc)("code/auxiliaryWindow/willApplyCSS");let i=new e.CSSStyleSheet;i.insertRule("body {\n\theight: 100%;\n\twidth: 100%;\n\tmargin: 0;\n\tpadding: 0;\n\toverflow: hidden;\n\tfont-size: 11px;\n\tuser-select: none;\n\t-webkit-user-select: none;\n}"),e.document.adoptedStyleSheets=[...e.document.adoptedStyleSheets,i,...(null!==Rt.Zg&&void 0!==Rt.Zg?Rt.Zg:Rt.vE.document).adoptedStyleSheets.map(t=>{let i=new e.CSSStyleSheet;for(let e of t.cssRules)i.insertRule(e.cssText);return i})];let o=new Map,s=new Rt.fw;s.wait().then(()=>(0,Rt.bc)("code/auxiliaryWindow/didLoadCSSStyles"));let r=t.add(new Rt.EA),n=0;function a(){0===--n&&(r.dispose(),s.open())}function d(t){if((0,Rt.Jg)(t))return;let i=e.document.head.appendChild(t.cloneNode(!0));"link"===t.tagName.toLowerCase()&&(n++,r.add((0,Rt.ox)(i,"load",a)),r.add((0,Rt.ox)(i,"error",a))),o.set(t,i)}n++;try{for(let e of Rt.vE.document.head.querySelectorAll('link[rel="stylesheet"], style'))d(e)}finally{a()}return t.add((0,Rt.Ug)(e)),t.add(Rt.ES.observe(Rt.vE.document.head,t,{childList:!0,subtree:!0})(e=>{for(let i of e)if("childList"===i.type&&"title"!==i.target.nodeName.toLowerCase()&&"script"!==i.target.nodeName.toLowerCase()&&"meta"!==i.target.nodeName.toLowerCase()){for(let e of i.addedNodes)if(!(0,Rt.iS)(e)||"style"!==e.tagName.toLowerCase()&&"link"!==e.tagName.toLowerCase()){if(e.nodeType===Node.TEXT_NODE&&e.parentNode){let t=o.get(e.parentNode);t&&(t.textContent=e.textContent)}}else d(e);for(let e of i.removedNodes){var t;let i=o.get(e);i&&(null!==(t=i.parentNode)&&void 0!==t&&t.removeChild(i),o.delete(e))}}})),(0,Rt.bc)("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:s}}applyHTML(e,t){(0,Rt.bc)("code/auxiliaryWindow/willApplyHTML");let i=(0,Rt.Zb)("div",{role:"application"});return(0,Rt.hS)(i,0,0,0,0,"relative"),i.style.display="flex",i.style.height="100%",i.style.flexDirection="column",e.document.body.append(i),t.add((0,Rt.kS)(Rt.vE.document.documentElement,e.document.documentElement)),t.add((0,Rt.kS)(Rt.vE.document.body,e.document.body)),t.add((0,Rt.kS)(this.layoutService.mainContainer,i,["class"])),(0,Rt.bc)("code/auxiliaryWindow/didApplyHTML"),i}getWindow(e){return this.windows.get(e)}},{_:yl=ne},{_:ne.WINDOW_IDS=(0,Rt.Hx)(Rt.vE)+1},ne);_l=yl=(0,Rt.Pb)([(0,Rt.Fb)(0,Nt.Z),(0,Rt.Fb)(1,Rt.Fl),(0,Rt.Fb)(2,Rt.o_),(0,Rt.Fb)(3,Rt.ib),(0,Rt.Fb)(4,Lt.P),(0,Rt.Fb)(5,Pt.O),(0,Rt.Fb)(6,Rt.Sl)],_l),(0,Rt.Ib)(),(0,Nt.Ot)(),(0,Rt.wl)(),(0,Wt.fx)(),(0,Rt.ab)(),(0,Rt.$d)(),(0,Rt.Kb)(),(0,Rt.Wo)(),(0,Rt.za)(),(0,Wt.L)(),(0,Rt.s_)(),(0,Nt.Q)(),(0,Rt.nb)();var El=class extends Wt.P{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u){super(e,{mergeViewWithContainerWhenSingleView:!1},n,i,o,d,s,l,a,r,c,h,u),this.constantViewDescriptors=new Map,this.allViews=new Map,this._register(t(e=>{this.filterValue=e,this.onFilterChanged(e)})),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>{this.updateAllViews(this.viewContainerModel.activeViewDescriptors)}))}updateAllViews(e){e.forEach(e=>{let t=this.getFilterOn(e);t&&(this.allViews.has(t)||this.allViews.set(t,new Map),this.allViews.get(t).set(e.id,e),this.filterValue&&!this.filterValue.includes(t)&&this.panes.find(t=>t.id===e.id)&&this.viewContainerModel.setVisible(e.id,!1))})}addConstantViewDescriptors(e){e.forEach(e=>this.constantViewDescriptors.set(e.id,e))}onFilterChanged(e){0===this.allViews.size&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),this.getViewsNotForTarget(e).forEach(e=>this.viewContainerModel.setVisible(e.id,!1)),this.getViewsForTarget(e).forEach(e=>this.viewContainerModel.setVisible(e.id,!0))}getViewsForTarget(e){let t=[];for(let i=0;i<e.length;i++)this.allViews.has(e[i])&&t.push(...Array.from(this.allViews.get(e[i]).values()));return t}getViewsNotForTarget(e){let t=this.allViews.keys(),i=t.next(),o=[];for(;!i.done;){let s=!1;e.forEach(e=>{i.value===e&&(s=!0)}),s||(o=o.concat(this.getViewsForTarget([i.value]))),i=t.next()}return o}onDidAddViewDescriptors(e){let t=super.onDidAddViewDescriptors(e);for(let i=0;i<e.length;i++)this.constantViewDescriptors.has(e[i].viewDescriptor.id)&&t[i].setExpanded(!1);return 0===this.allViews.size&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),t}openView(e,t){let i=super.openView(e,t);if(i){var o;let t=Array.from(this.allViews.entries()).find(t=>t[1].has(e));t&&(null===(o=this.filterValue)||void 0===o||!o.includes(t[0]))&&this.setFilter(t[1].get(e))}return i}};El=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.o_),(0,Rt.Fb)(3,Nt.Z),(0,Rt.Fb)(4,Rt.ib),(0,Rt.Fb)(5,Rt.Uo),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.Qd),(0,Rt.Fb)(8,Rt.Sl),(0,Rt.Fb)(9,Nt.Dt),(0,Rt.Fb)(10,Rt.Ra),(0,Rt.Fb)(11,Wt.dx),(0,Rt.Fb)(12,Rt.eb)],El),(0,Rt.Ib)(),(0,Rt.PA)(),(0,Wt.Df)(),(0,Wt.fx)(),(0,Nt.ir)(),(0,Rt.vb)(),(0,Rt.Wo)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.gA)(),(0,Rt.nM)(),(0,Rt.db)(),(0,Rt.Fj)(),(0,Rt.gb)(),(0,Rt.im)(),(0,Rt.Kb)(),(0,Rt.ab)(),(0,Rt.$d)(),(0,Rt.wl)(),(0,Nt.Ot)(),(0,Rt.za)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Rt.TD)(),(0,Mt.c)(),(0,Pt.G)(),(0,Nt.wt)(),(0,Pt.At)(),(0,Wt.E_)();var Al=class extends Rt.CA{constructor(e,t,i,o,s){super(),this.viewDescriptorService=e,this.paneCompositeService=t,this.contextKeyService=i,this.layoutService=o,this.editorService=s,this._onDidChangeViewVisibility=this._register(new Rt.uA),this.onDidChangeViewVisibility=this._onDidChangeViewVisibility.event,this._onDidChangeViewContainerVisibility=this._register(new Rt.uA),this.onDidChangeViewContainerVisibility=this._onDidChangeViewContainerVisibility.event,this._onDidChangeFocusedView=this._register(new Rt.uA),this.onDidChangeFocusedView=this._onDidChangeFocusedView.event,this.viewContainerDisposables=this._register(new Rt.wA),this.viewDisposable=new Map,this.enabledViewContainersContextKeys=new Map,this.visibleViewContextKeys=new Map,this.viewPaneContainers=new Map,this._register((0,Rt.zA)(()=>{this.viewDisposable.forEach(e=>e.dispose()),this.viewDisposable.clear()})),this.viewDescriptorService.viewContainers.forEach(e=>this.onDidRegisterViewContainer(e,this.viewDescriptorService.getViewContainerLocation(e))),this._register(this.viewDescriptorService.onDidChangeViewContainers(e=>{let{added:t,removed:i}=e;return this.onDidChangeContainers(t,i)})),this._register(this.viewDescriptorService.onDidChangeContainerLocation(e=>{let{viewContainer:t,from:i,to:o}=e;return this.onDidChangeContainerLocation(t,i,o)})),this._register(this.paneCompositeService.onDidPaneCompositeOpen(e=>this._onDidChangeViewContainerVisibility.fire({id:e.composite.getId(),visible:!0,location:e.viewContainerLocation}))),this._register(this.paneCompositeService.onDidPaneCompositeClose(e=>this._onDidChangeViewContainerVisibility.fire({id:e.composite.getId(),visible:!1,location:e.viewContainerLocation}))),this.focusedViewContextKey=Nt.yn.bindTo(i)}onViewsAdded(e){for(let t of e)this.onViewsVisibilityChanged(t,t.isBodyVisible())}onViewsVisibilityChanged(e,t){this.getOrCreateActiveViewContextKey(e).set(t),this._onDidChangeViewVisibility.fire({id:e.id,visible:t})}onViewsRemoved(e){for(let t of e)this.onViewsVisibilityChanged(t,!1)}getOrCreateActiveViewContextKey(e){let t=(0,Nt.rr)(e.id),i=this.visibleViewContextKeys.get(t);return i||(i=new Rt.FO(t,!1).bindTo(this.contextKeyService),this.visibleViewContextKeys.set(t,i)),i}onDidChangeContainers(e,t){for(let{container:i,location:o}of t)this.onDidDeregisterViewContainer(i,o);for(let{container:i,location:o}of e)this.onDidRegisterViewContainer(i,o)}onDidRegisterViewContainer(e,t){this.registerPaneComposite(e,t);let i=new Rt.EA,o=this.viewDescriptorService.getViewContainerModel(e);this.onViewDescriptorsAdded(o.allViewDescriptors,e),i.add(o.onDidChangeAllViewDescriptors(t=>{let{added:i,removed:o}=t;this.onViewDescriptorsAdded(i,e),this.onViewDescriptorsRemoved(o)})),this.updateViewContainerEnablementContextKey(e),i.add(o.onDidChangeActiveViewDescriptors(()=>this.updateViewContainerEnablementContextKey(e))),i.add(this.registerOpenViewContainerAction(e)),this.viewContainerDisposables.set(e.id,i)}onDidDeregisterViewContainer(e,t){this.deregisterPaneComposite(e,t),this.viewContainerDisposables.deleteAndDispose(e.id)}onDidChangeContainerLocation(e,t,i){this.deregisterPaneComposite(e,t),this.registerPaneComposite(e,i),this.layoutService.isVisible(Vl(i))&&1===this.viewDescriptorService.getViewContainersByLocation(i).filter(e=>this.isViewContainerActive(e.id)).length&&this.openViewContainer(e.id)}onViewDescriptorsAdded(e,t){if(null!==this.viewDescriptorService.getViewContainerLocation(t))for(let i of e){let e=new Rt.EA;e.add(this.registerOpenViewAction(i)),e.add(this.registerFocusViewAction(i,t.title)),e.add(this.registerResetViewLocationAction(i)),this.viewDisposable.set(i,e)}}onViewDescriptorsRemoved(e){for(let t of e){let e=this.viewDisposable.get(t);e&&(e.dispose(),this.viewDisposable.delete(t))}}updateViewContainerEnablementContextKey(e){let t=this.enabledViewContainersContextKeys.get(e.id);t||(t=this.contextKeyService.createKey(Dl(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,t)),t.set(!(e.hideIfEmpty&&0===this.viewDescriptorService.getViewContainerModel(e).activeViewDescriptors.length))}async openComposite(e,t,i){return this.paneCompositeService.openPaneComposite(e,t,i)}getComposite(e,t){return this.paneCompositeService.getPaneComposite(e,t)}isViewContainerVisible(e){var t;let i=this.viewDescriptorService.getViewContainerById(e);if(!i)return!1;let o=this.viewDescriptorService.getViewContainerLocation(i);return null!==o&&(null===(t=this.paneCompositeService.getActivePaneComposite(o))||void 0===t?void 0:t.getId())===e}isViewContainerActive(e){let t=this.viewDescriptorService.getViewContainerById(e);return!(!t||!this.contextKeyService.contextMatchesRules(t.when))&&(!t.hideIfEmpty||this.viewDescriptorService.getViewContainerModel(t).activeViewDescriptors.length>0)}getVisibleViewContainer(e){var t;let i=null===(t=this.paneCompositeService.getActivePaneComposite(e))||void 0===t?void 0:t.getId();return i?this.viewDescriptorService.getViewContainerById(i):null}getActiveViewPaneContainerWithId(e){let t=this.viewDescriptorService.getViewContainerById(e);return t?this.getActiveViewPaneContainer(t):null}async openViewContainer(e,t){let i=this.viewDescriptorService.getViewContainerById(e);if(i){let o=this.viewDescriptorService.getViewContainerLocation(i);if(null!==o)return await this.paneCompositeService.openPaneComposite(e,o,t)||null}return null}async closeViewContainer(e){let t=this.viewDescriptorService.getViewContainerById(e);if(t){let e=this.viewDescriptorService.getViewContainerLocation(t),i=null!==e&&this.paneCompositeService.getActivePaneComposite(e);if(null!==e)return i?this.layoutService.setPartHidden(!0,Vl(e)):void 0}}isViewVisible(e){var t;return(null===(t=this.getActiveViewWithId(e))||void 0===t?void 0:t.isBodyVisible())||!1}getActiveViewWithId(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){let i=this.getActiveViewPaneContainer(t);if(i)return i.getView(e)}return null}getViewWithId(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){let i=this.viewPaneContainers.get(t.id);if(i)return i.getView(e)}return null}getFocusedView(){var e;let t=null!==(e=this.contextKeyService.getContextKeyValue(Nt.yn.key))&&void 0!==e?e:"";return this.viewDescriptorService.getViewDescriptorById(t.toString())}getFocusedViewName(){var e,t,i,o;let s=null!==(e=this.editorService.activeTextEditorControl)&&void 0!==e&&e.hasTextFocus()?(0,Rt.Ij)(14615,"Text Editor"):void 0;return null!==(t=null!==(i=null===(o=this.getFocusedView())||void 0===o||null===(o=o.name)||void 0===o?void 0:o.value)&&void 0!==i?i:s)&&void 0!==t?t:""}async openView(e,t){let i=this.viewDescriptorService.getViewContainerByViewId(e);if(!i||!this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.some(t=>t.id===e))return null;let o=this.viewDescriptorService.getViewContainerLocation(i),s=this.getComposite(i.id,o);if(s){let i=await this.openComposite(s.id,o);if(null!==i&&void 0!==i&&i.openView)return i.openView(e,t)||null;t&&(null===i||void 0===i||i.focus())}return null}closeView(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){let i=this.getActiveViewPaneContainer(t);if(i){let o=i.getView(e);if(o)if(1===i.views.length){let i=this.viewDescriptorService.getViewContainerLocation(t);i===Wt.Sf.Sidebar?this.layoutService.setPartHidden(!0,Nt.I.SIDEBAR_PART):(i===Wt.Sf.Panel||i===Wt.Sf.AuxiliaryBar)&&this.paneCompositeService.hideActivePaneComposite(i),this.focusedViewContextKey.get()===e&&this.focusedViewContextKey.reset()}else o.setExpanded(!1)}}}getActiveViewPaneContainer(e){let t=this.viewDescriptorService.getViewContainerLocation(e);if(null===t)return null;let i=this.paneCompositeService.getActivePaneComposite(t);return(null===i||void 0===i?void 0:i.getId())===e.id&&i.getViewPaneContainer()||null}getViewProgressIndicator(e){let t=this.viewDescriptorService.getViewContainerByViewId(e);if(!t)return;let i=this.viewPaneContainers.get(t.id);if(!i)return;let o=i.getView(e);return o?i.isViewMergedWithContainer()?this.getViewContainerProgressIndicator(t):o.getProgressIndicator():void 0}getViewContainerProgressIndicator(e){let t=this.viewDescriptorService.getViewContainerLocation(e);if(null!==t)return this.paneCompositeService.getProgressIndicator(e.id,t)}registerOpenViewContainerAction(e){let t=new Rt.EA;if(e.openCommandActionDescriptor){var i,o;let{id:s,mnemonicTitle:r,keybindings:n,order:a}=null!==(i=e.openCommandActionDescriptor)&&void 0!==i?i:{id:e.id},d=null!==(o=e.openCommandActionDescriptor.title)&&void 0!==o?o:e.title,l=this;if(t.add((0,Rt.pb)(class extends Rt.ob{constructor(){super({id:s,get title(){let t=l.viewDescriptorService.getViewContainerLocation(e),i="string"==typeof d?d:d.value,o="string"==typeof d?d:d.original;return t===Wt.Sf.Sidebar?{value:(0,Rt.Ij)(14616,"Show {0}",i),original:"Show ".concat(o)}:{value:(0,Rt.Ij)(14617,"Toggle {0}",i),original:"Toggle ".concat(o)}},category:Mt.s.View,precondition:Rt.PO.has(Dl(e.id)),keybinding:n?(0,xt.A)((0,xt.A)({},n),{},{weight:Rt.mb.WorkbenchContrib}):void 0,f1:!0})}async run(t){let i=t.get(Pt.W),o=t.get(Wt.dx),s=t.get(Nt.Z),r=t.get(Wt.T_),n=o.getViewContainerLocation(e);switch(n){case Wt.Sf.AuxiliaryBar:case Wt.Sf.Sidebar:{let t=n===Wt.Sf.Sidebar?Nt.I.SIDEBAR_PART:Nt.I.AUXILIARYBAR_PART;r.isViewContainerVisible(e.id)&&s.hasFocus(t)?i.activeGroup.focus():await r.openViewContainer(e.id,!0);break}case Wt.Sf.Panel:r.isViewContainerVisible(e.id)&&s.hasFocus(Nt.I.PANEL_PART)?r.closeViewContainer(e.id):await r.openViewContainer(e.id,!0)}}})),r){let i=this.viewDescriptorService.getDefaultViewContainerLocation(e);t.add(Rt.lb.appendMenuItem(Rt.sb.MenubarViewMenu,{command:{id:s,title:r},group:i===Wt.Sf.Sidebar?"3_sidebar":i===Wt.Sf.AuxiliaryBar?"4_auxbar":"5_panel",when:Rt.PO.has(Dl(e.id)),order:null!==a&&void 0!==a?a:Number.MAX_VALUE}))}}return t}registerOpenViewAction(e){var t,i,o,s,r;let n=new Rt.EA,a=null!==(t=null===(i=e.openCommandActionDescriptor)||void 0===i?void 0:i.title)&&void 0!==t?t:e.name,d=null!==(o=null===(s=e.openCommandActionDescriptor)||void 0===s?void 0:s.id)&&void 0!==o?o:"".concat(e.id,".open"),l=this;if(n.add((0,Rt.pb)(class extends Rt.ob{constructor(){var t;super({id:d,get title(){let t=l.viewDescriptorService.getViewLocationById(e.id),i="string"==typeof a?a:a.value,o="string"==typeof a?a:a.original;return t===Wt.Sf.Sidebar?{value:(0,Rt.Ij)(14616,"Show {0}",i),original:"Show ".concat(o)}:{value:(0,Rt.Ij)(14617,"Toggle {0}",i),original:"Toggle ".concat(o)}},category:Mt.s.View,precondition:Rt.PO.has("".concat(e.id,".active")),keybinding:null!==(t=e.openCommandActionDescriptor)&&void 0!==t&&t.keybindings?(0,xt.A)((0,xt.A)({},e.openCommandActionDescriptor.keybindings),{},{weight:Rt.mb.WorkbenchContrib}):void 0,f1:!!e.openCommandActionDescriptor||void 0,metadata:{description:(0,Rt.Ij)(14618,"Opens view {0}",e.name.value),args:[{name:"options",schema:{type:"object",properties:{preserveFocus:{type:"boolean",default:!1,description:(0,Rt.Ij)(14619,"Whether to preserve the existing focus when opening the view.")}}}}]}})}async run(t,i){let o=t.get(Pt.W),s=t.get(Wt.dx),r=t.get(Nt.Z),n=t.get(Wt.T_),a=t.get(Rt.yb);if(Nt.yn.getValue(a)!==e.id||null!==i&&void 0!==i&&i.preserveFocus)await n.openView(e.id,!(null!==i&&void 0!==i&&i.preserveFocus));else{let t=s.getViewLocationById(e.id);s.getViewLocationById(e.id)===Wt.Sf.Sidebar?o.activeGroup.focus():null!==t&&r.setPartHidden(!0,Vl(t))}}})),null!==(r=e.openCommandActionDescriptor)&&void 0!==r&&r.mnemonicTitle){let t=this.viewDescriptorService.getDefaultContainerById(e.id);if(t){var c;let i=this.viewDescriptorService.getDefaultViewContainerLocation(t);n.add(Rt.lb.appendMenuItem(Rt.sb.MenubarViewMenu,{command:{id:d,title:e.openCommandActionDescriptor.mnemonicTitle},group:i===Wt.Sf.Sidebar?"3_sidebar":i===Wt.Sf.AuxiliaryBar?"4_auxbar":"5_panel",when:Rt.PO.has("".concat(e.id,".active")),order:null!==(c=e.openCommandActionDescriptor.order)&&void 0!==c?c:Number.MAX_VALUE}))}}return n}registerFocusViewAction(e,t){return(0,Rt.pb)(class extends Rt.ob{constructor(){var i,o,s,r,n;let a=(0,Rt.Lj)(14620,"Focus on {0} View",e.name.value);super({id:e.focusCommand?e.focusCommand.id:"".concat(e.id,".focus"),title:a,category:t,menu:[{id:Rt.sb.CommandPalette,when:e.when}],keybinding:{when:Rt.PO.has("".concat(e.id,".active")),weight:Rt.mb.WorkbenchContrib,primary:null===(i=e.focusCommand)||void 0===i||null===(i=i.keybindings)||void 0===i?void 0:i.primary,secondary:null===(o=e.focusCommand)||void 0===o||null===(o=o.keybindings)||void 0===o?void 0:o.secondary,linux:null===(s=e.focusCommand)||void 0===s||null===(s=s.keybindings)||void 0===s?void 0:s.linux,mac:null===(r=e.focusCommand)||void 0===r||null===(r=r.keybindings)||void 0===r?void 0:r.mac,win:null===(n=e.focusCommand)||void 0===n||null===(n=n.keybindings)||void 0===n?void 0:n.win},metadata:{description:a.value,args:[{name:"focusOptions",description:"Focus Options",schema:{type:"object",properties:{preserveFocus:{type:"boolean",default:!1}}}}]}})}run(t,i){t.get(Wt.T_).openView(e.id,!(null!==i&&void 0!==i&&i.preserveFocus))}})}registerResetViewLocationAction(e){return(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"".concat(e.id,".resetViewLocation"),title:(0,Rt.Lj)(14621,"Reset Location"),menu:[{id:Rt.sb.ViewTitleContext,when:Rt.PO.or(Rt.PO.and(Rt.PO.equals("view",e.id),Rt.PO.equals("".concat(e.id,".defaultViewLocation"),!1))),group:"1_hide",order:2}]})}run(t){let i=t.get(Wt.dx),o=i.getDefaultContainerById(e.id),s=i.getViewContainerModel(o);if(o.hideIfEmpty&&0===s.visibleViewDescriptors.length){let e=i.getDefaultViewContainerLocation(o);i.moveViewContainerToLocation(o,e,void 0,this.desc.id)}i.moveViewsToContainer([e],o,void 0,this.desc.id),t.get(Wt.T_).openView(e.id,!0)}})}registerPaneComposite(e,t){let i=this,o=class extends qt{constructor(t,i,o,s,r,n,a){super(e.id,t,o,s,r,n,a,i)}createViewPaneContainer(o){let s=this._register(new Rt.EA),r=i.createViewPaneContainer(o,e,t,s,this.instantiationService);return r instanceof El||s.add(Rt.dA.any(r.onDidAddViews,r.onDidRemoveViews,r.onTitleAreaUpdate)(()=>{this.updateTitleArea()})),r}};o=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.ib),(0,Rt.Fb)(1,Rt.Ra),(0,Rt.Fb)(2,Rt.Uo),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Rt.Qd),(0,Rt.Fb)(5,Rt.Sl),(0,Rt.Fb)(6,Nt.Dt)],o),Rt._b.as(xl(t)).registerPaneComposite($t.create(o,e.id,"string"==typeof e.title?e.title:e.title.value,(0,Rt.uM)(e.icon)?e.icon:void 0,e.order,e.requestedIndex,e.icon instanceof Rt.wD?e.icon:void 0))}deregisterPaneComposite(e,t){Rt._b.as(xl(t)).deregisterPaneComposite(e.id)}createViewPaneContainer(e,t,i,o,s){let r=s.createInstance(t.ctorDescriptor.ctor,...t.ctorDescriptor.staticArguments||[]);return this.viewPaneContainers.set(r.getId(),r),o.add((0,Rt.zA)(()=>this.viewPaneContainers.delete(r.getId()))),o.add(r.onDidAddViews(e=>this.onViewsAdded(e))),o.add(r.onDidChangeViewVisibility(e=>this.onViewsVisibilityChanged(e,e.isBodyVisible()))),o.add(r.onDidRemoveViews(e=>this.onViewsRemoved(e))),o.add(r.onDidFocusView(e=>{this.focusedViewContextKey.get()!==e.id&&(this.focusedViewContextKey.set(e.id),this._onDidChangeFocusedView.fire())})),o.add(r.onDidBlurView(e=>{this.focusedViewContextKey.get()===e.id&&(this.focusedViewContextKey.reset(),this._onDidChangeFocusedView.fire())})),r}};function Dl(e){return"viewContainer.".concat(e,".enabled")}function xl(e){switch(e){case Wt.Sf.AuxiliaryBar:return ii;case Wt.Sf.Panel:return ti;case Wt.Sf.Sidebar:default:return ei}}function Vl(e){switch(e){case Wt.Sf.AuxiliaryBar:return Nt.I.AUXILIARYBAR_PART;case Wt.Sf.Panel:return Nt.I.PANEL_PART;case Wt.Sf.Sidebar:default:return Nt.I.SIDEBAR_PART}}Al=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.dx),(0,Rt.Fb)(1,Nt.Ct),(0,Rt.Fb)(2,Rt.yb),(0,Rt.Fb)(3,Nt.Z),(0,Rt.Fb)(4,Pt.kt)],Al),(0,Rt.Kb)(),(0,Tt.f)(),(0,Rt.im)();var Rl=class{constructor(){this.onWillInstantiateEditorPane=Tt.u.onWillInstantiateEditorPane}didInstantiateEditorPane(e){return Tt.u.didInstantiateEditorPane(e)}};(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.im)(),(0,Rt.db)(),(0,Rt.Kb)();var Tl=class{constructor(){this._providers=new Map,this._onDidChange=new Rt.uA,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}register(e,t,i,o){let s=this._makeKey(e,t);if(this._providers.has(s))throw Error("A provider for the command ".concat(t," and menu ").concat(e," is already registered."));this._providers.set(s,i);let r=null===o||void 0===o?void 0:o(()=>{this._onDidChange.fire(e)});return(0,Rt.zA)(()=>{null!==r&&void 0!==r&&r.dispose(),this._providers.delete(s)})}lookUp(e,t){return this._providers.get(this._makeKey(e,t))}_makeKey(e,t){return"".concat(e.id,"/").concat(t instanceof Rt.sb?t.id:t)}};(0,Rt.Ib)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.s_)(),(0,Nt.vt)(),(0,Rt.Vu)(),(0,Rt.vd)(),(0,Rt.Kb)(),(0,Rt.nb)(),(0,Rt.zk)(),(0,Pt.D)(),(0,Rt.yT)();var Ll,Wl=class{constructor(){this.uris=[]}async perform(){return this}toString(){return"(noop)"}},Fl=class{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="rename"}},Gl=Ll=class{constructor(e,t,i,o){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o}get uris(){return this._edits.flatMap(e=>[e.newUri,e.oldUri])}async perform(e){let t=[],i=[];for(let o of this._edits)void 0===o.options.overwrite&&o.options.ignoreIfExists&&await this._fileService.exists(o.newUri)||(t.push({file:{source:o.oldUri,target:o.newUri},overwrite:o.options.overwrite}),i.push(new Fl(o.oldUri,o.newUri,o.options)));return 0===t.length?new Wl:(await this._workingCopyFileService.move(t,e,this._undoRedoInfo),new Ll(i,{isUndoing:!0},this._workingCopyFileService,this._fileService))}toString(){return"(rename ".concat(this._edits.map(e=>"".concat(e.oldUri," to ").concat(e.newUri)).join(", "),")")}};Gl=Ll=(0,Rt.Pb)([(0,Rt.Fb)(2,Nt._t),(0,Rt.Fb)(3,Rt.ys)],Gl);var Zl=class{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="copy"}},Nl=class{constructor(e,t,i,o,s){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._instaService=s}get uris(){return this._edits.flatMap(e=>[e.newUri,e.oldUri])}async perform(e){let t=[];for(let s of this._edits)void 0===s.options.overwrite&&s.options.ignoreIfExists&&await this._fileService.exists(s.newUri)||t.push({file:{source:s.oldUri,target:s.newUri},overwrite:s.options.overwrite});if(0===t.length)return new Wl;let i=await this._workingCopyFileService.copy(t,e,this._undoRedoInfo),o=[];for(let s=0;s<i.length;s++){let e=i[s],t=this._edits[s];o.push(new Bl(e.resource,(0,xt.A)({recursive:!0,folder:this._edits[s].options.folder||e.isDirectory},t.options),!1))}return this._instaService.createInstance(Ol,o,{isUndoing:!0})}toString(){return"(copy ".concat(this._edits.map(e=>"".concat(e.oldUri," to ").concat(e.newUri)).join(", "),")")}};Nl=(0,Rt.Pb)([(0,Rt.Fb)(2,Nt._t),(0,Rt.Fb)(3,Rt.ys),(0,Rt.Fb)(4,Rt.Ub)],Nl);var Pl=class{constructor(e,t,i){this.newUri=e,this.options=t,this.contents=i,this.type="create"}},Jl=class{constructor(e,t,i,o,s,r){this._edits=e,this._undoRedoInfo=t,this._fileService=i,this._workingCopyFileService=o,this._instaService=s,this._textFileService=r}get uris(){return this._edits.map(e=>e.newUri)}async perform(e){let t=[],i=[],o=[];for(let s of this._edits)if(s.newUri.scheme!==Rt.vT.untitled&&(void 0!==s.options.overwrite||!s.options.ignoreIfExists||!await this._fileService.exists(s.newUri))){if(s.options.folder)t.push({resource:s.newUri});else{let e=void 0===s.contents?await this._textFileService.getEncodedReadable(s.newUri):s.contents;i.push({resource:s.newUri,contents:e,overwrite:s.options.overwrite})}o.push(new Bl(s.newUri,s.options,!s.options.folder&&!s.contents))}return 0===t.length&&0===i.length?new Wl:(await this._workingCopyFileService.createFolder(t,e,this._undoRedoInfo),await this._workingCopyFileService.create(i,e,this._undoRedoInfo),this._instaService.createInstance(Ol,o,{isUndoing:!0}))}toString(){return"(create ".concat(this._edits.map(e=>{var t;return e.options.folder?"folder ".concat(e.newUri):"file ".concat(e.newUri," with ").concat((null===(t=e.contents)||void 0===t?void 0:t.byteLength)||0," bytes")}).join(", "),")")}};Jl=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.ys),(0,Rt.Fb)(3,Nt._t),(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Pt.E)],Jl);var Bl=class{constructor(e,t,i){this.oldUri=e,this.options=t,this.undoesCreate=i,this.type="delete"}},Ol=class{constructor(e,t,i,o,s,r,n){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._configurationService=s,this._instaService=r,this._logService=n}get uris(){return this._edits.map(e=>e.oldUri)}async perform(e){let t=[],i=[];for(let r of this._edits){var o;let n;try{n=await this._fileService.resolve(r.oldUri,{resolveMetadata:!0})}catch(s){if(!r.options.ignoreIfNotExists)throw Error("".concat(r.oldUri," does not exist and can not be deleted"));continue}t.push({resource:r.oldUri,recursive:r.options.recursive,useTrash:!r.options.skipTrashBin&&this._fileService.hasCapability(r.oldUri,Rt.Rs.Trash)&&this._configurationService.getValue("files.enableTrash")});let a,d=!1;if(!r.undoesCreate&&!r.options.folder&&(d="number"==typeof r.options.maxSize&&n.size>r.options.maxSize,!d))try{a=await this._fileService.readFile(r.oldUri)}catch(e){this._logService.error(e)}d||i.push(new Pl(r.oldUri,r.options,null===(o=a)||void 0===o?void 0:o.value))}return 0===t.length||(await this._workingCopyFileService.delete(t,e,this._undoRedoInfo),0===i.length)?new Wl:this._instaService.createInstance(Jl,i,{isUndoing:!0})}toString(){return"(delete ".concat(this._edits.map(e=>e.oldUri).join(", "),")")}};Ol=(0,Rt.Pb)([(0,Rt.Fb)(2,Nt._t),(0,Rt.Fb)(3,Rt.ys),(0,Rt.Fb)(4,Rt.o_),(0,Rt.Fb)(5,Rt.Ub),(0,Rt.Fb)(6,Rt.eb)],Ol);var Kl=class{constructor(e,t,i,o){this.label=e,this.code=t,this.operations=i,this.confirmBeforeUndo=o,this.type=Rt.zu.Workspace,this.resources=i.flatMap(e=>e.uris)}async undo(){await this._reverse()}async redo(){await this._reverse()}async _reverse(){for(let e=0;e<this.operations.length;e++){let t=await this.operations[e].perform(Rt.Ik.None);this.operations[e]=t}}toString(){return this.operations.map(e=>String(e)).join(", ")}},Ml=class{constructor(e,t,i,o,s,r,n,a,d,l){this._label=e,this._code=t,this._undoRedoGroup=i,this._undoRedoSource=o,this._confirmBeforeUndo=s,this._progress=r,this._token=n,this._edits=a,this._instaService=d,this._undoRedoService=l}async apply(){let e=[],t={undoRedoGroupId:this._undoRedoGroup.id},i=[];for(let h of this._edits){var o,s,r,n,a,d;!h.newResource||!h.oldResource||null!==(o=h.options)&&void 0!==o&&o.copy?h.newResource&&h.oldResource&&null!==(r=h.options)&&void 0!==r&&r.copy?i.push(new Zl(h.newResource,h.oldResource,null!==(n=h.options)&&void 0!==n?n:{})):!h.newResource&&h.oldResource?i.push(new Bl(h.oldResource,null!==(a=h.options)&&void 0!==a?a:{},!1)):h.newResource&&!h.oldResource&&i.push(new Pl(h.newResource,null!==(d=h.options)&&void 0!==d?d:{},await h.options.contents)):i.push(new Fl(h.newResource,h.oldResource,null!==(s=h.options)&&void 0!==s?s:{}))}if(0===i.length)return[];let l=[];l[0]=[i[0]];for(let h=1;h<i.length;h++){let e=i[h],t=l.at(-1);(null===t||void 0===t?void 0:t[0].type)===e.type?t.push(e):l.push([e])}for(let h of l){if(this._token.isCancellationRequested)break;let i;switch(h[0].type){case"rename":i=this._instaService.createInstance(Gl,h,t);break;case"copy":i=this._instaService.createInstance(Nl,h,t);break;case"delete":i=this._instaService.createInstance(Ol,h,t);break;case"create":i=this._instaService.createInstance(Jl,h,t)}if(i){let t=await i.perform(this._token);e.push(t)}this._progress.report(void 0)}let c=new Kl(this._label,this._code,e,this._confirmBeforeUndo);return this._undoRedoService.pushElement(c,this._undoRedoGroup,this._undoRedoSource),c.resources}};Ml=(0,Rt.Pb)([(0,Rt.Fb)(8,Rt.Ub),(0,Rt.Fb)(9,Rt._d)],Ml),(0,Rt.Ib)(),(0,Rt.PA)(),(0,Rt.pD)(),(0,Rt.xD)(),(0,Rt.Rb)(),(0,Wt.mC)(),(0,Rt.vd)(),(0,Rt.Ru)(),(0,Rt.QA)(),(0,Rt.Bb)(),(0,Rt.Io)(),(0,Wt.Vh)(),(0,Wt.Zh)();var jl=class{constructor(e){this._modelReference=e,this.model=this._modelReference.object.textEditorModel,this._edits=[]}dispose(){this._modelReference.dispose()}isNoOp(){return!(this._edits.length>0||void 0!==this._newEol&&this._newEol!==this.model.getEndOfLineSequence())}addEdit(e){this._expectedModelVersionId=e.versionId;let t,{textEdit:i}=e;"number"==typeof i.eol&&(this._newEol=i.eol),!i.range&&!i.text||Rt.bD.isEmpty(i.range)&&!i.text||(t=i.range?Rt.bD.lift(i.range):this.model.getFullModelRange(),this._edits.push((0,xt.A)((0,xt.A)({},Rt.fD.replaceMove(t,i.text)),{},{insertAsSnippet:i.insertAsSnippet,keepWhitespace:i.keepWhitespace})))}validate(){return void 0===this._expectedModelVersionId||this.model.getVersionId()===this._expectedModelVersionId?{canApply:!0}:{canApply:!1,reason:this.model.uri}}getBeforeCursorState(){return null}apply(e){this._edits.length>0&&(this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((e,t)=>Rt.bD.compareRangesUsingStarts(e.range,t.range)),this.model.pushEditOperations(null,this._edits,()=>null,void 0,e)),void 0!==this._newEol&&this.model.pushEOL(this._newEol)}_transformSnippetStringToInsertText(e){if(!e.insertAsSnippet||!e.text)return e;let t=Wt.Xh.asInsertText(e.text);return(0,xt.A)((0,xt.A)({},e),{},{insertAsSnippet:!1,text:t})}},Ql=class extends jl{constructor(e,t){super(e),this._editor=t}getBeforeCursorState(){return this._canUseEditor()?this._editor.getSelections():null}apply(e){if(this._canUseEditor()){if(this._edits.length>0){let t=Wt.Bh.get(this._editor);if(t&&this._edits.some(e=>e.insertAsSnippet)){let e=[];for(let t of this._edits)t.range&&null!==t.text&&e.push({range:Rt.bD.lift(t.range),template:t.insertAsSnippet?t.text:Wt.Xh.escape(t.text),keepWhitespace:t.keepWhitespace});t.apply(e,{undoStopBefore:!1,undoStopAfter:!1})}else this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((e,t)=>Rt.bD.compareRangesUsingStarts(e.range,t.range)),this._editor.executeEdits(e,this._edits)}void 0!==this._newEol&&this._editor.hasModel()&&this._editor.getModel().pushEOL(this._newEol)}else super.apply()}_canUseEditor(){var e;return(null===(e=this._editor)||void 0===e||null===(e=e.getModel())||void 0===e?void 0:e.uri.toString())===this.model.uri.toString()}},Yl=class{constructor(e,t,i,o,s,r,n,a,d,l,c,h){this._label=e,this._code=t,this._editor=i,this._undoRedoGroup=o,this._undoRedoSource=s,this._progress=r,this._token=n,this._editorWorker=d,this._modelService=l,this._textModelResolverService=c,this._undoRedoService=h,this._edits=new Rt.qA;for(let u of a){let e=this._edits.get(u.resource);e||(e=[],this._edits.set(u.resource,e)),e.push(u)}}_validateBeforePrepare(){for(let e of this._edits.values())for(let t of e)if("number"==typeof t.versionId){let e=this._modelService.getModel(t.resource);if(e&&e.getVersionId()!==t.versionId)throw Error("".concat(e.uri.toString()," has changed in the meantime"))}}async _createEditsTasks(){let e=[],t=[];for(let[i,o]of this._edits){let s=this._textModelResolverService.createModelReference(i).then(async t=>{var i;let s,r=!1;if((null===(i=this._editor)||void 0===i||null===(i=i.getModel())||void 0===i?void 0:i.uri.toString())===t.object.textEditorModel.uri.toString()?(s=new Ql(t,this._editor),r=!0):s=new jl(t),e.push(s),!r)return void o.forEach(s.addEdit,s);let n=async(e,i)=>{let r=o.slice(e,i),n=await this._editorWorker.computeMoreMinimalEdits(t.object.textEditorModel.uri,r.map(e=>e.textEdit),!1);n?n.forEach(e=>s.addEdit(new Rt.Fo(t.object.textEditorModel.uri,e,void 0,void 0))):r.forEach(s.addEdit,s)},a=0,d=0;for(;d<o.length;d++)(o[d].textEdit.insertAsSnippet||o[d].metadata)&&(await n(a,d),s.addEdit(o[d]),a=d+1);await n(a,d)});t.push(s)}return await Promise.all(t),e}_validateTasks(e){for(let t of e){let e=t.validate();if(!e.canApply)return e}return{canApply:!0}}async apply(e){this._validateBeforePrepare();let t=await this._createEditsTasks();try{if(this._token.isCancellationRequested)return[];let i=[],o=this._validateTasks(t);if(!o.canApply)throw Error("".concat(o.reason.toString()," has changed in the meantime"));if(1===t.length){let o=t[0];if(!o.isNoOp()){let t=new Rt.Lu(this._label,this._code,o.model,o.getBeforeCursorState());this._undoRedoService.pushElement(t,this._undoRedoGroup,this._undoRedoSource),o.apply(e),t.close(),i.push(o.model.uri)}this._progress.report(void 0)}else{let e=new Rt.Iu(this._label,this._code,t.map(e=>new Rt.Lu(this._label,this._code,e.model,e.getBeforeCursorState())));this._undoRedoService.pushElement(e,this._undoRedoGroup,this._undoRedoSource);for(let o of t)o.apply(),this._progress.report(void 0),i.push(o.model.uri);e.close()}return i}finally{(0,Rt.MA)(t)}}};Yl=(0,Rt.Pb)([(0,Rt.Fb)(8,Wt.pC),(0,Rt.Fb)(9,Rt.zb),(0,Rt.Fb)(10,Rt.Lb),(0,Rt.Fb)(11,Rt._d)],Yl),(0,Rt.Ib)(),(0,Rt.nM)(),(0,Rt.Io)(),(0,Rt.Vu)(),(0,Rt.vd)();var Hl=class e extends Rt.No{static is(t){return t instanceof e||(0,Rt.lM)(t)&&!(!t.undo||!t.redo)}static lift(t){return t instanceof e?t:new e(t.resource,t.undo,t.redo,t.metadata)}constructor(e,t,i,o){super(o),this.resource=e,this.undo=t,this.redo=i}},Xl=class{constructor(e,t,i,o,s,r){this._undoRedoGroup=e,this._undoRedoSource=t,this._progress=i,this._token=o,this._edits=s,this._undoRedoService=r}async apply(){let e=[];for(let i of this._edits){var t;if(this._token.isCancellationRequested)break;await i.redo(),this._undoRedoService.pushElement({type:Rt.zu.Resource,resource:i.resource,label:(null===(t=i.metadata)||void 0===t?void 0:t.label)||"Custom Edit",code:"paste",undo:i.undo,redo:i.redo},this._undoRedoGroup,this._undoRedoSource),this._progress.report(void 0),e.push(i.resource)}return e}};Xl=(0,Rt.Pb)([(0,Rt.Fb)(5,Rt._d)],Xl),(0,Rt.Ib)(),(0,Rt.zk)(),(0,Rt.PA)(),(0,Rt.xA)(),(0,Rt.QA)(),(0,Gt.o)(),(0,Rt.Io)(),(0,Rt.Kb)(),(0,Rt.EO)(),(0,Rt.Fj)(),(0,Rt.s_)(),(0,Rt.I_)(),(0,Rt.Ll)(),(0,Rt.im)(),(0,Rt.nb)(),(0,Nt.gt)(),(0,Rt.vb)(),(0,Rt.Vu)(),(0,Wt.id)(),(0,Pt.At)(),(0,Pt.L)(),(0,Pt.z)(),(0,Pt.C)(),(0,Rt.mj)();var Ul=class{constructor(e,t,i,o,s,r,n,a,d,l,c){this._label=e,this._code=t,this._editor=i,this._progress=o,this._token=s,this._edits=r,this._undoRedoGroup=n,this._undoRedoSource=a,this._confirmBeforeUndo=d,this._instaService=l,this._logService=c}ariaMessage(){let e=new Rt.qA,t=new Rt.qA,i=0;for(let s of this._edits){var o;s instanceof Rt.Fo?(i+=1,t.set(s.resource,!0)):s instanceof Rt.Po&&e.set(null!==(o=s.oldResource)&&void 0!==o?o:s.newResource,!0)}return 0===this._edits.length?(0,Rt.Ij)(4506,"Made no edits"):0===e.size?i>1&&t.size>1?(0,Rt.Ij)(4507,"Made {0} text edits in {1} files",i,t.size):(0,Rt.Ij)(4508,"Made {0} text edits in one file",i):(0,Rt.Ij)(4509,"Made {0} text edits in {1} files, also created or deleted {2} files",i,t.size,e.size)}async perform(e){if(0===this._edits.length)return[];let t=[1];for(let n=1;n<this._edits.length;n++)Object.getPrototypeOf(this._edits[n-1])===Object.getPrototypeOf(this._edits[n])?t[t.length-1]++:t.push(1);let i=this._edits.length>1?0:void 0;this._progress.report({increment:i,total:100});let o={report:e=>this._progress.report({increment:100/this._edits.length})},s=[],r=0;for(let n of t){if(this._token.isCancellationRequested)break;let t=this._edits.slice(r,r+n);t[0]instanceof Rt.Po?s.push(await this._performFileEdits(t,this._undoRedoGroup,this._undoRedoSource,this._confirmBeforeUndo,o)):t[0]instanceof Rt.Fo?s.push(await this._performTextEdits(t,this._undoRedoGroup,this._undoRedoSource,o,e)):t[0]instanceof Wt.rd?s.push(await this._performCellEdits(t,this._undoRedoGroup,this._undoRedoSource,o)):t[0]instanceof Hl?s.push(await this._performOpaqueEdits(t,this._undoRedoGroup,this._undoRedoSource,o)):console.log("UNKNOWN EDIT"),r+=n}return s.flat()}async _performFileEdits(e,t,i,o,s){return this._logService.debug("_performFileEdits",JSON.stringify(e)),await this._instaService.createInstance(Ml,this._label||(0,Rt.Ij)(4510,"Workspace Edit"),this._code||"undoredo.workspaceEdit",t,i,o,s,this._token,e).apply()}async _performTextEdits(e,t,i,o,s){return this._logService.debug("_performTextEdits",JSON.stringify(e)),await this._instaService.createInstance(Yl,this._label||(0,Rt.Ij)(4510,"Workspace Edit"),this._code||"undoredo.workspaceEdit",this._editor,t,i,o,this._token,e).apply(s)}async _performCellEdits(e,t,i,o){return this._logService.debug("_performCellEdits",JSON.stringify(e)),await this._instaService.createInstance(Wt.nd,t,i,o,this._token,e).apply()}async _performOpaqueEdits(e,t,i,o){return this._logService.debug("_performOpaqueEdits",JSON.stringify(e)),await this._instaService.createInstance(Xl,t,i,o,this._token,e).apply()}};Ul=(0,Rt.Pb)([(0,Rt.Fb)(9,Rt.Ub),(0,Rt.Fb)(10,Rt.eb)],Ul);var zl=class{constructor(e,t,i,o,s,r,n){this._instaService=e,this._logService=t,this._editorService=i,this._lifecycleService=o,this._dialogService=s,this._workingCopyService=r,this._configService=n,this._activeUndoRedoGroups=new Rt.bA}setPreviewHandler(e){return this._previewHandler=e,(0,Rt.zA)(()=>{this._previewHandler===e&&(this._previewHandler=void 0)})}hasPreviewHandler(){return!!this._previewHandler}async apply(e,t){var i,o;let s=function(e){return e.map(e=>{if(Rt.Fo.is(e))return Rt.Fo.lift(e);if(Rt.Po.is(e))return Rt.Po.lift(e);if(Wt.rd.is(e))return Wt.rd.lift(e);if(Hl.is(e))return Hl.lift(e);throw Error("Unsupported edit")})}(Array.isArray(e)?e:e.edits);if(0===s.length)return{ariaSummary:(0,Rt.Ij)(4511,"Made no edits"),isApplied:!1};this._previewHandler&&((null===t||void 0===t?void 0:t.showPreview)||s.some(e=>{var t;return null===(t=e.metadata)||void 0===t?void 0:t.needsConfirmation}))&&(s=await this._previewHandler(s,t));let r=null===t||void 0===t?void 0:t.editor;if(!r){let e=this._editorService.activeTextEditorControl;(0,Gt.s)(e)?r=e:(0,Gt.l)(e)&&(r=e.getModifiedEditor())}r&&r.getOption(Rt.lO.readOnly)&&(r=void 0);let n,a=()=>{};if("number"==typeof(null===t||void 0===t?void 0:t.undoRedoGroupId))for(let u of this._activeUndoRedoGroups)if(u.id===t.undoRedoGroupId){n=u;break}n||(n=new Rt.Bu,a=this._activeUndoRedoGroups.push(n));let d,l=(null===t||void 0===t?void 0:t.quotableLabel)||(null===t||void 0===t?void 0:t.label),c=this._instaService.createInstance(Ul,l,null===t||void 0===t?void 0:t.code,r,null!==(i=null===t||void 0===t?void 0:t.progress)&&void 0!==i?i:Nt.pt.None,null!==(o=null===t||void 0===t?void 0:t.token)&&void 0!==o?o:Rt.Ik.None,s,n,null===t||void 0===t?void 0:t.undoRedoSource,!(null===t||void 0===t||!t.confirmBeforeUndo));try{d=this._lifecycleService.onBeforeShutdown(e=>e.veto(this._shouldVeto(l,e.reason),"veto.blukEditService"));let e=await c.perform(null===t||void 0===t?void 0:t.reason);return null!==t&&void 0!==t&&t.respectAutoSaveConfig&&!0===this._configService.getValue(ql)&&e.length>1&&await this._saveAll(e),{ariaSummary:c.ariaMessage(),isApplied:s.length>0}}catch(e){throw this._logService.error(e),e}finally{var h;null!==(h=d)&&void 0!==h&&h.dispose(),a()}}async _saveAll(e){let t=new Rt.JA(e),i=this._workingCopyService.dirtyWorkingCopies.map(async e=>{t.has(e.resource)&&await e.save()}),o=await Promise.allSettled(i);for(let s of o)"rejected"===s.status&&this._logService.warn(s.reason)}async _shouldVeto(e,t){let i;switch(t){case Pt.P.CLOSE:i=(0,Rt.Ij)(4512,"Are you sure you want to close the window?");break;case Pt.P.LOAD:i=(0,Rt.Ij)(4513,"Are you sure you want to change the workspace?");break;case Pt.P.RELOAD:i=(0,Rt.Ij)(4514,"Are you sure you want to reload the window?");break;default:i=Rt.Cj?(0,Rt.Ij)(4515,"Are you sure you want to quit?"):(0,Rt.Ij)(4516,"Are you sure you want to exit?")}return!(await this._dialogService.confirm({message:i,detail:(0,Rt.Ij)(4517,"'{0}' is in progress.",e||(0,Rt.Ij)(4518,"File operation"))})).confirmed}};zl=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Rt.eb),(0,Rt.Fb)(2,Pt.kt),(0,Rt.Fb)(3,Pt.R),(0,Rt.Fb)(4,Rt.Fl),(0,Rt.Fb)(5,Pt.S),(0,Rt.Fb)(6,Rt.o_)],zl);var ql="files.refactoring.autoSave";Rt._b.as(Rt.E_.Configuration).registerConfiguration({id:"files",properties:{[ql]:{description:(0,Rt.Ij)(4519,"Controls if files that were part of a refactoring are saved automatically"),default:!0,type:"boolean"}}});(0,Rt.Ib)(),(0,Rt.bs)(),(0,Rt.Bb)(),(0,Rt.QA)(),(0,Rt.PA)(),(0,Rt.gA)(),(0,Rt.Io)(),(0,Wt.id)(),(0,Rt.nb)();var $l=class{constructor(e,t,i,o){this._conflicts=new Rt.qA,this._disposables=new Rt.EA,this._onDidConflict=new Rt.uA,this.onDidConflict=this._onDidConflict.event;let s=new Rt.qA;for(let n of e)if(n instanceof Rt.Fo){if(s.set(n.resource,!0),"number"==typeof n.versionId){let e=i.getModel(n.resource);e&&e.getVersionId()!==n.versionId&&(this._conflicts.set(n.resource,!0),this._onDidConflict.fire(this))}}else n instanceof Rt.Po?n.newResource?s.set(n.newResource,!0):n.oldResource&&s.set(n.oldResource,!0):n instanceof Wt.rd?s.set(n.resource,!0):o.warn("UNKNOWN edit type",n);this._disposables.add(t.onDidFilesChange(e=>{for(let t of s.keys())if(!i.getModel(t)&&e.contains(t)){this._conflicts.set(t,!0),this._onDidConflict.fire(this);break}}));let r=e=>{s.has(e.uri)&&(this._conflicts.set(e.uri,!0),this._onDidConflict.fire(this))};for(let n of i.getModels())this._disposables.add(n.onDidChangeContent(()=>r(n)))}dispose(){this._disposables.dispose(),this._onDidConflict.dispose()}list(){return[...this._conflicts.keys()]}hasConflicts(){return this._conflicts.size>0}};$l=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ys),(0,Rt.Fb)(2,Rt.zb),(0,Rt.Fb)(3,Rt.eb)],$l),(0,Rt.Ib)(),(0,Rt.Rb)(),(0,Rt.TD)(),(0,Rt.lv)(),(0,Rt.Bb)(),(0,Rt.lu)(),(0,Rt.PA)(),(0,Rt.WM)(),(0,Rt.xD)(),(0,Rt.pD)(),(0,Rt.Kb)(),(0,Rt.bs)(),(0,Rt.gA)(),(0,Rt.QA)(),(0,Rt.Fj)(),(0,Rt.iT)(),(0,Rt.Io)(),(0,Rt.gD)(),(0,Rt.hp)(),(0,Wt.Zh)(),(0,Rt.qw)(),(0,Rt.yT)();var ec,tc,ic,oc=class{constructor(){this._states=new WeakMap,this._checkedCount=0,this._onDidChange=new Rt.uA,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}get checkedCount(){return this._checkedCount}isChecked(e){var t;return null!==(t=this._states.get(e))&&void 0!==t&&t}updateChecked(e,t){let i=this._states.get(e);i!==t&&(void 0===i?t&&(this._checkedCount+=1):t?this._checkedCount+=1:--this._checkedCount,this._states.set(e,t),this._onDidChange.fire(e))}},sc=class{constructor(e,t){this.parent=e,this.textEdit=t}};!function(e){e[e.TextEdit=1]="TextEdit",e[e.Create=2]="Create",e[e.Delete=4]="Delete",e[e.Rename=8]="Rename"}(ic||(ic={}));var rc=class{constructor(e,t){this.uri=e,this.parent=t,this.type=0,this.textEdits=[],this.originalEdits=new Map}addEdit(e,t,i){this.type|=t,this.originalEdits.set(e,i),i instanceof Rt.Fo?this.textEdits.push(new sc(this,i)):t===ic.Rename&&(this.newUri=i.newResource)}needsConfirmation(){for(let[,e]of this.originalEdits)if(!this.parent.checked.isChecked(e))return!0;return!1}},nc=(ae=class e{static keyOf(e){return(null===e||void 0===e?void 0:e.label)||"<default>"}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e._defaultMetadata;this.metadata=t,this.operationByResource=new Map}get fileOperations(){return this.operationByResource.values()}},{_:ae._defaultMetadata=Object.freeze({label:(0,Rt.Ij)(4536,"Other"),icon:Rt.mD.symbolFile,needsConfirmation:!1})},ae),ac=ec=class{static async create(e,t){return await e.get(Rt.Ub).createInstance(ec,t)._init()}constructor(e,t,i){this._bulkEdit=e,this._fileService=t,this.checked=new oc,this.fileOperations=[],this.categories=[],this.conflicts=i.createInstance($l,e)}dispose(){this.checked.dispose(),this.conflicts.dispose()}async _init(){let e=new Map,t=new Map,i=new Rt.qA;for(let l=0;l<this._bulkEdit.length;l++){var o;let c,h,u=this._bulkEdit[l];if(this.checked.updateChecked(u,!(null!==(o=u.metadata)&&void 0!==o&&o.needsConfirmation)),u instanceof Rt.Fo)h=ic.TextEdit,c=u.resource;else{if(!(u instanceof Rt.Po))continue;if(u.newResource&&u.oldResource){var s,r;if(h=ic.Rename,c=u.oldResource,void 0===(null===(s=u.options)||void 0===s?void 0:s.overwrite)&&null!==(r=u.options)&&void 0!==r&&r.ignoreIfExists&&await this._fileService.exists(c))continue;i.set(u.newResource,c)}else if(u.oldResource){var n;if(h=ic.Delete,c=u.oldResource,null!==(n=u.options)&&void 0!==n&&n.ignoreIfNotExists&&!await this._fileService.exists(c))continue}else{if(!u.newResource)continue;var a,d;if(h=ic.Create,c=u.newResource,void 0===(null===(a=u.options)||void 0===a?void 0:a.overwrite)&&null!==(d=u.options)&&void 0!==d&&d.ignoreIfExists&&await this._fileService.exists(c))continue}}let g=(e,t)=>{let o=Rt.$w.getComparisonKey(e,!0),s=t.get(o);!s&&i.has(e)&&(e=i.get(e),o=Rt.$w.getComparisonKey(e,!0),s=t.get(o)),s||(s=new rc(e,this),t.set(o,s)),s.addEdit(l,h,u)};g(c,e);let p=nc.keyOf(u.metadata),b=t.get(p);b||(b=new nc(u.metadata),t.set(p,b)),g(c,b.operationByResource)}e.forEach(e=>this.fileOperations.push(e)),t.forEach(e=>this.categories.push(e));for(let l of this.fileOperations)if(l.type!==ic.TextEdit){let e=!0;for(let t of l.originalEdits.values())t instanceof Rt.Po&&e&&(e=this.checked.isChecked(t));if(!e)for(let t of l.originalEdits.values())this.checked.updateChecked(t,e)}return this.categories.sort((e,t)=>e.metadata.needsConfirmation===t.metadata.needsConfirmation?e.metadata.label.localeCompare(t.metadata.label):e.metadata.needsConfirmation?-1:1),this}getWorkspaceEdit(){let e=[],t=!0;for(let i=0;i<this._bulkEdit.length;i++){let o=this._bulkEdit[i];this.checked.isChecked(o)?e[i]=o:t=!1}return t?this._bulkEdit:((0,Rt.jM)(e),e)}async getFileEditOperation(e){let t=await e.options.contents;if(t)return Rt.fD.replaceMove(Rt.bD.lift({startLineNumber:0,startColumn:0,endLineNumber:Number.MAX_VALUE,endColumn:0}),t.toString())}async getFileEdits(e){for(let t of this.fileOperations)if(t.uri.toString()===e.toString()){let e=[],i=!1;for(let o of t.originalEdits.values())o instanceof Rt.Po?e.push(this.getFileEditOperation(o)):o instanceof Rt.Fo?this.checked.isChecked(o)&&e.push(Promise.resolve(Rt.fD.replaceMove(Rt.bD.lift(o.textEdit.range),o.textEdit.insertAsSnippet?Wt.Xh.asInsertText(o.textEdit.text):o.textEdit.text))):this.checked.isChecked(o)||(i=!0);return i?[]:(await Promise.all(e)).filter(e=>void 0!==e).sort((e,t)=>Rt.bD.compareRangesUsingStarts(e.range,t.range))}return[]}getUriOfEdit(e){for(let t of this.fileOperations)for(let i of t.originalEdits.values())if(i===e)return t.uri;throw Error("invalid edit")}};ac=ec=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ys),(0,Rt.Fb)(2,Rt.Ub)],ac);var dc=(de=class{static fromPreviewUri(e){return Rt.wD.parse(e.query)}constructor(e,t,i,o){this._operations=e,this._languageService=t,this._modelService=i,this._textModelResolverService=o,this._disposables=new Rt.EA,this._modelPreviewEdits=new Map,this._instanceId=(0,Rt.mp)(),this._disposables.add(this._textModelResolverService.registerTextModelContentProvider(tc.Schema,this)),this._ready=this._init()}dispose(){this._disposables.dispose()}asPreviewUri(e){let t=e.scheme===Rt.vT.untitled?"/".concat(e.path):e.path;return Rt.wD.from({scheme:tc.Schema,authority:this._instanceId,path:t,query:e.toString()})}async _init(){for(let e of this._operations.fileOperations)await this._applyTextEditsToPreviewModel(e.uri);this._disposables.add(Rt.dA.debounce(this._operations.checked.onDidChange,(e,t)=>t,Rt.Kw)(e=>{let t=this._operations.getUriOfEdit(e);this._applyTextEditsToPreviewModel(t)}))}async _applyTextEditsToPreviewModel(e){let t=await this._getOrCreatePreviewModel(e),i=this._modelPreviewEdits.get(t.id);i&&t.applyEdits(i);let o=await this._operations.getFileEdits(e),s=t.applyEdits(o,!0);this._modelPreviewEdits.set(t.id,s)}async _getOrCreatePreviewModel(e){let t=this.asPreviewUri(e),i=this._modelService.getModel(t);if(!i){try{let o=await this._textModelResolverService.createModelReference(e),s=o.object.textEditorModel;i=this._modelService.createModel((0,Rt.ou)(s.createSnapshot()),this._languageService.createById(s.getLanguageId()),t),o.dispose()}catch(o){i=this._modelService.createModel("",this._languageService.createByFilepathOrFirstLine(t),t)}queueMicrotask(async()=>{this._disposables.add(await this._textModelResolverService.createModelReference(i.uri))})}return i}async provideTextContent(e){return e.toString()===tc.emptyPreview.toString()?this._modelService.createModel("",null,e):(await this._ready,this._modelService.getModel(e))}},{_:tc=de},{_:de.Schema="vscode-bulkeditpreview-editor"},{_:de.emptyPreview=Rt.wD.from({scheme:de.Schema,fragment:"empty"})},de);dc=tc=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.cv),(0,Rt.Fb)(2,Rt.zb),(0,Rt.Fb)(3,Rt.Lb)],dc),(0,Rt.Ib)(),(0,Rt.Rb)(),(0,Rt.Qc)(),(0,Rt.Cn)(),(0,Rt.xD)(),(0,Rt.qx)(),(0,Rt.PA)(),(0,Rt.lu)(),(0,Rt.ac)(),(0,Rt.Fj)(),(0,Rt.Xa)(),(0,Rt.xn)(),(0,Rt.iT)(),(0,Rt.$d)(),(0,Rt.Db)(),(0,Rt.ok)(),(0,Rt.TD)(),(0,Rt.Io)(),(0,Rt.C_)(),(0,Wt.Zh)(),(0,Rt.Kb)(),(0,Rt.Xl)();var lc,cc,hc,uc=class{constructor(e,t){this.parent=e,this.category=t}isChecked(){let e=this.parent,t=!0;for(let i of this.category.fileOperations)for(let o of i.originalEdits.values())t&&(t=e.checked.isChecked(o));return t}setChecked(e){let t=this.parent;for(let i of this.category.fileOperations)for(let o of i.originalEdits.values())t.checked.updateChecked(o,e)}},gc=class{constructor(e,t){this.parent=e,this.edit=t}isChecked(){let e=this.parent instanceof uc?this.parent.parent:this.parent,t=!0;this.edit.type===ic.TextEdit&&(t=!this.edit.textEdits.every(t=>!e.checked.isChecked(t.textEdit)));for(let i of this.edit.originalEdits.values())i instanceof Rt.Po&&t&&(t=e.checked.isChecked(i));if(this.parent instanceof uc&&this.edit.type===ic.TextEdit)for(let i of e.categories)for(let o of i.fileOperations)if(o.uri.toString()===this.edit.uri.toString())for(let i of o.originalEdits.values())i instanceof Rt.Po&&t&&(t=e.checked.isChecked(i));return t}setChecked(e){let t=this.parent instanceof uc?this.parent.parent:this.parent;for(let i of this.edit.originalEdits.values())t.checked.updateChecked(i,e);if(this.parent instanceof uc&&this.edit.type!==ic.TextEdit)for(let i of t.categories)for(let o of i.fileOperations)if(o.uri.toString()===this.edit.uri.toString())for(let i of o.originalEdits.values())t.checked.updateChecked(i,e)}isDisabled(){if(this.parent instanceof uc&&this.edit.type===ic.TextEdit){let e=this.parent.parent,t=!0;for(let i of e.categories)for(let o of i.fileOperations)if(o.uri.toString()===this.edit.uri.toString())for(let i of o.originalEdits.values())i instanceof Rt.Po&&t&&(t=e.checked.isChecked(i));return!t}return!1}},pc=class{constructor(e,t,i,o,s,r,n){this.parent=e,this.idx=t,this.edit=i,this.prefix=o,this.selecting=s,this.inserting=r,this.suffix=n}isChecked(){let e=this.parent.parent;return e instanceof uc&&(e=e.parent),e.checked.isChecked(this.edit.textEdit)}setChecked(e){let t=this.parent.parent;if(t instanceof uc&&(t=t.parent),t.checked.updateChecked(this.edit.textEdit,e),e)for(let i of this.parent.edit.originalEdits.values())i instanceof Rt.Po&&t.checked.updateChecked(i,e)}isDisabled(){return this.parent.isDisabled()}},bc=class{constructor(e,t){this._textModelService=e,this._instantiationService=t,this.groupByFile=!0}hasChildren(e){return e instanceof gc?e.edit.textEdits.length>0:!(e instanceof pc)}async getChildren(e){if(e instanceof ac)return this.groupByFile?e.fileOperations.map(t=>new gc(e,t)):e.categories.map(t=>new uc(e,t));if(e instanceof uc)return Array.from(e.category.fileOperations,t=>new gc(e,t));if(e instanceof gc&&e.edit.textEdits.length>0){let i,o;try{let t=await this._textModelService.createModelReference(e.edit.uri);i=t.object.textEditorModel,o=t}catch(t){i=this._instantiationService.createInstance(Rt.iu,"",Rt.S_,Rt.iu.DEFAULT_CREATION_OPTIONS,null),o=i}let s=e.edit.textEdits.map((t,o)=>{let s=i.validateRange(t.textEdit.textEdit.range),r=i.tokenization.getLineTokens(s.startLineNumber),n=23;for(let e=r.findTokenIndexAtOffset(s.startColumn-1)-1;n<50&&e>=0;e--)n=s.startColumn-r.getStartOffset(e);let a=i.tokenization.getLineTokens(s.endLineNumber),d=0;for(let e=a.findTokenIndexAtOffset(s.endColumn-1);d<50&&e<a.getCount();e++)d+=a.getEndOffset(e)-a.getStartOffset(e);return new pc(e,o,t,i.getValueInRange(new Rt.bD(s.startLineNumber,s.startColumn-n,s.startLineNumber,s.startColumn)),i.getValueInRange(s),t.textEdit.textEdit.insertAsSnippet?Wt.Xh.asInsertText(t.textEdit.textEdit.text):t.textEdit.textEdit.text,i.getValueInRange(new Rt.bD(s.endLineNumber,s.endColumn,s.endLineNumber,s.endColumn+d)))});return o.dispose(),s}return[]}};bc=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Lb),(0,Rt.Fb)(1,Rt.Ub)],bc);var mc=class{compare(e,t){return e instanceof gc&&t instanceof gc?vc(e.edit,t.edit):e instanceof pc&&t instanceof pc?Rt.bD.compareRangesUsingStarts(e.edit.textEdit.textEdit.range,t.edit.textEdit.textEdit.range):0}};function vc(e,t){return(0,Rt.UO)(e.uri.toString(),t.uri.toString())}var Cc=class{constructor(e){this._labelService=e}getWidgetAriaLabel(){return(0,Rt.Ij)(4537,"Bulk Edit")}getRole(e){return"checkbox"}getAriaLabel(e){if(e instanceof gc){if(e.edit.textEdits.length>0)return e.edit.type&ic.Rename&&e.edit.newUri?(0,Rt.Ij)(4538,"Renaming {0} to {1}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0})):e.edit.type&ic.Create?(0,Rt.Ij)(4539,"Creating {0}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0})):e.edit.type&ic.Delete?(0,Rt.Ij)(4540,"Deleting {0}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0})):(0,Rt.Ij)(4541,"{0}, making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0}));if(e.edit.type&ic.Rename&&e.edit.newUri)return(0,Rt.Ij)(4542,"Renaming {0} to {1}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0}));if(e.edit.type&ic.Create)return(0,Rt.Ij)(4543,"Creating {0}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}));if(e.edit.type&ic.Delete)return(0,Rt.Ij)(4544,"Deleting {0}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}))}if(e instanceof pc){if(e.selecting.length>0&&e.inserting.length>0)return(0,Rt.Ij)(4545,"line {0}, replacing {1} with {2}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting,e.inserting);if(e.selecting.length>0&&0===e.inserting.length)return(0,Rt.Ij)(4546,"line {0}, removing {1}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting);if(0===e.selecting.length&&e.inserting.length>0)return(0,Rt.Ij)(4547,"line {0}, inserting {1}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting)}return null}};Cc=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ya)],Cc);var wc=class{getId(e){return e instanceof gc?e.edit.uri+(e.parent instanceof uc?JSON.stringify(e.parent.category.metadata):""):e instanceof pc?e.parent.edit.uri.toString()+e.idx:JSON.stringify(e.category.metadata)}},yc=class{constructor(e){e.classList.add("category"),this.icon=(0,Rt.gx)("div"),e.appendChild(this.icon),this.label=new Rt.bn(e)}},fc=(le=class{constructor(e){this._themeService=e,this.templateId=lc.id}renderTemplate(e){return new yc(e)}renderElement(e,t,i){i.icon.style.setProperty("--background-dark",null),i.icon.style.setProperty("--background-light",null),i.icon.style.color="";let{metadata:o}=e.element.category;if(Rt.Eb.isThemeIcon(o.iconPath)){var s,r;let e=Rt.Eb.asClassName(o.iconPath);i.icon.className=e?"theme-icon ".concat(e):"",i.icon.style.color=o.iconPath.color&&null!==(s=null===(r=this._themeService.getColorTheme().getColor(o.iconPath.color.id))||void 0===r?void 0:r.toString())&&void 0!==s?s:""}else Rt.wD.isUri(o.iconPath)?(i.icon.className="uri-icon",i.icon.style.setProperty("--background-dark",(0,Rt.Gl)(o.iconPath)),i.icon.style.setProperty("--background-light",(0,Rt.Gl)(o.iconPath))):o.iconPath&&(i.icon.className="uri-icon",i.icon.style.setProperty("--background-dark",(0,Rt.Gl)(o.iconPath.dark)),i.icon.style.setProperty("--background-light",(0,Rt.Gl)(o.iconPath.light)));i.label.setLabel(o.label,o.description,{descriptionMatches:(0,Rt.Yc)(e.filterData)})}disposeTemplate(e){e.label.dispose()}},{_:lc=le},{_:le.id="CategoryElementRenderer"},le);fc=lc=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Qd)],fc);var Sc=class{constructor(e,t,i){this._labelService=i,this._disposables=new Rt.EA,this._localDisposables=new Rt.EA,this._checkbox=(0,Rt.gx)("input"),this._checkbox.className="edit-checkbox",this._checkbox.type="checkbox",this._checkbox.setAttribute("role","checkbox"),e.appendChild(this._checkbox),this._label=t.create(e,{supportHighlights:!0}),this._details=(0,Rt.gx)("span"),this._details.className="details",e.appendChild(this._details)}dispose(){this._localDisposables.dispose(),this._disposables.dispose(),this._label.dispose()}set(e,t){if(this._localDisposables.clear(),this._checkbox.checked=e.isChecked(),this._checkbox.disabled=e.isDisabled(),this._localDisposables.add((0,Rt.ox)(this._checkbox,"change",()=>{e.setChecked(this._checkbox.checked)})),e.edit.type&ic.Rename&&e.edit.newUri)this._label.setResource({resource:e.edit.uri,name:(0,Rt.Ij)(4548,"{0} \u2192 {1}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0}))},{fileDecorations:{colors:!0,badges:!1}}),this._details.innerText=(0,Rt.Ij)(4549,"(renaming)");else{let i={matches:(0,Rt.Yc)(t),fileKind:Rt.Ms.FILE,fileDecorations:{colors:!0,badges:!1},extraClasses:[]};e.edit.type&ic.Create?this._details.innerText=(0,Rt.Ij)(4550,"(creating)"):e.edit.type&ic.Delete?(this._details.innerText=(0,Rt.Ij)(4551,"(deleting)"),i.extraClasses.push("delete")):this._details.innerText="",this._label.setFile(e.edit.uri,i)}}};Sc=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Ya)],Sc);var Ic=(ce=class{constructor(e,t){this._resourceLabels=e,this._labelService=t,this.templateId=cc.id}renderTemplate(e){return new Sc(e,this._resourceLabels,this._labelService)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}},{_:cc=ce},{_:ce.id="FileElementRenderer"},ce);Ic=cc=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ya)],Ic);var kc=class{constructor(e,t){this._themeService=t,this._disposables=new Rt.EA,this._localDisposables=new Rt.EA,e.classList.add("textedit"),this._checkbox=(0,Rt.gx)("input"),this._checkbox.className="edit-checkbox",this._checkbox.type="checkbox",this._checkbox.setAttribute("role","checkbox"),e.appendChild(this._checkbox),this._icon=(0,Rt.gx)("div"),e.appendChild(this._icon),this._label=this._disposables.add(new Rt.Sn(e))}dispose(){this._localDisposables.dispose(),this._disposables.dispose()}set(e){this._localDisposables.clear(),this._localDisposables.add((0,Rt.ox)(this._checkbox,"change",t=>{e.setChecked(this._checkbox.checked),t.preventDefault()})),e.parent.isChecked(),this._checkbox.checked=e.isChecked(),this._checkbox.disabled=e.isDisabled();let t="";t+=e.prefix,t+=e.selecting,t+=e.inserting,t+=e.suffix;let i,o={start:e.prefix.length,end:e.prefix.length+e.selecting.length,extraClasses:["remove"]},s={start:o.end,end:o.end+e.inserting.length,extraClasses:["insert"]},{metadata:r}=e.edit.textEdit;r&&r.description?i=(0,Rt.Ij)(4552,"{0} - {1}",r.label,r.description):r&&(i=r.label);let n=null===r||void 0===r?void 0:r.iconPath;if(n)if(this._icon.style.display="block",this._icon.style.setProperty("--background-dark",null),this._icon.style.setProperty("--background-light",null),Rt.Eb.isThemeIcon(n)){var a,d;let e=Rt.Eb.asClassName(n);this._icon.className=e?"theme-icon ".concat(e):"",this._icon.style.color=n.color&&null!==(a=null===(d=this._themeService.getColorTheme().getColor(n.color.id))||void 0===d?void 0:d.toString())&&void 0!==a?a:""}else Rt.wD.isUri(n)?(this._icon.className="uri-icon",this._icon.style.setProperty("--background-dark",(0,Rt.Gl)(n)),this._icon.style.setProperty("--background-light",(0,Rt.Gl)(n))):(this._icon.className="uri-icon",this._icon.style.setProperty("--background-dark",(0,Rt.Gl)(n.dark)),this._icon.style.setProperty("--background-light",(0,Rt.Gl)(n.light)));else this._icon.style.display="none";this._label.set(t,[o,s],i,!0),this._icon.title=i||""}};kc=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Qd)],kc);var _c=(he=class{constructor(e){this._themeService=e,this.templateId=hc.id}renderTemplate(e){return new kc(e,this._themeService)}renderElement(e,t,i){let{element:o}=e;i.set(o)}disposeTemplate(e){}},{_:hc=he},{_:he.id="TextEditElementRenderer"},he);_c=hc=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Qd)],_c);var Ec,Ac,Dc=class{getHeight(){return 23}getTemplateId(e){return e instanceof gc?Ic.id:e instanceof pc?_c.id:fc.id}},xc=class{getKeyboardNavigationLabel(e){return e instanceof gc?(0,Rt.Xw)(e.edit.uri):e instanceof uc?e.category.metadata.label:void 0}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Qn)(),(0,Rt.Fk)(),(0,Rt.PA)(),(0,Rt.TD)(),(0,Rt.Rb)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Rt.Ll)(),(0,Rt.cr)(),(0,Rt.Kb)(),(0,Rt.Ad)(),(0,Rt.Xa)(),(0,Rt.Ct)(),(0,Rt.br)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.Mi)(),(0,Rt.$d)(),(0,Wt.ot)(),(0,Wt.Q)(),(0,Wt.fx)(),(0,Lt.U)(),(0,Pt.At)(),(0,Rt.qx)(),(0,Rt.mE)({}),function(e){e.Data="data",e.Message="message"}(Ac||(Ac={}));var Vc,Rc=(ue=class extends Wt.Y{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b){super((0,xt.A)((0,xt.A)({},e),{},{titleMenuId:Rt.sb.BulkEditTitle}),c,h,u,d,l,t,g,p,b),this._instaService=t,this._editorService=i,this._labelService=o,this._textModelService=s,this._dialogService=r,this._contextMenuService=n,this._storageService=a,this._treeViewStates=new Map,this._disposables=new Rt.EA,this._sessionDisposables=new Rt.EA,this._computeResourceDiffEditorInputs=new Rt.Pk(async e=>{let t=new Rt.Nk(async e=>{let t=e.uri,i=this._currentProvider.asPreviewUri(t);if(e.type&ic.Delete)return{original:{resource:Rt.wD.revive(i)},modified:{resource:void 0},goToFileResource:e.uri};{let e;try{(await this._textModelService.createModelReference(t)).dispose(),e=t}catch(o){e=dc.emptyPreview}return{original:{resource:Rt.wD.revive(e)},modified:{resource:Rt.wD.revive(i)},goToFileResource:e}}}),i=e.slice().sort(vc),o=[];for(let s of i)o.push(await t.get(s));return{resources:o,getResourceDiffEditorInputIdOfOperation:async e=>{let i=await t.get(e);return{original:i.original.resource,modified:i.modified.resource}}}}),this.element.classList.add("bulk-edit-panel","show-file-icons"),this._ctxHasCategories=Ec.ctxHasCategories.bindTo(d),this._ctxGroupByFile=Ec.ctxGroupByFile.bindTo(d),this._ctxHasCheckedChanges=Ec.ctxHasCheckedChanges.bindTo(d)}dispose(){this._tree.dispose(),this._disposables.dispose(),super.dispose()}renderBody(e){super.renderBody(e);let t=this._instaService.createInstance(Wt.at,{onDidChangeVisibility:this.onDidChangeBodyVisibility});this._disposables.add(t);let i=(0,Rt.gx)("div");i.className="content",e.appendChild(i);let o=(0,Rt.gx)("div");i.appendChild(o),this._treeDataSource=this._instaService.createInstance(bc),this._treeDataSource.groupByFile=this._storageService.getBoolean(Ec._memGroupByFile,Rt.Go.PROFILE,!0),this._ctxGroupByFile.set(this._treeDataSource.groupByFile),this._tree=this._instaService.createInstance(Rt.it,this.id,o,new Dc,[this._instaService.createInstance(_c),this._instaService.createInstance(Ic,t),this._instaService.createInstance(fc)],this._treeDataSource,{accessibilityProvider:this._instaService.createInstance(Cc),identityProvider:new wc,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,keyboardNavigationLabelProvider:new xc,sorter:new mc,selectionNavigation:!0}),this._disposables.add(this._tree.onContextMenu(this._onContextMenu,this)),this._disposables.add(this._tree.onDidOpen(e=>this._openElementInMultiDiffEditor(e)));let s=(0,Rt.gx)("div");s.className="buttons",i.appendChild(s);let r=new Rt.Jn(s);this._disposables.add(r);let n=r.addButton((0,xt.A)({supportIcons:!0},Rt.xi));n.label=(0,Rt.Ij)(4531,"Apply"),n.onDidClick(()=>this.accept(),this,this._disposables);let a=r.addButton((0,xt.A)((0,xt.A)({},Rt.xi),{},{secondary:!0}));a.label=(0,Rt.Ij)(4532,"Discard"),a.onDidClick(()=>this.discard(),this,this._disposables),this._message=(0,Rt.gx)("span"),this._message.className="message",this._message.innerText=(0,Rt.Ij)(4533,"Invoke a code action, like rename, to see a preview of its changes here."),e.appendChild(this._message),this._setState(Ac.Message)}layoutBody(e,t){super.layoutBody(e,t);let i=e-50;this._tree.getHTMLElement().parentElement.style.height="".concat(i,"px"),this._tree.layout(i,t)}_setState(e){this.element.dataset.state=e}async setInput(e,t){this._setState(Ac.Data),this._sessionDisposables.clear(),this._treeViewStates.clear(),this._currentResolve&&(this._currentResolve=void this._currentResolve(void 0));let i=await this._instaService.invokeFunction(ac.create,e);this._currentProvider=this._instaService.createInstance(dc,i),this._sessionDisposables.add(this._currentProvider),this._sessionDisposables.add(i);let o=i.categories.length>1;return this._ctxHasCategories.set(o),this._treeDataSource.groupByFile=!o||this._treeDataSource.groupByFile,this._ctxHasCheckedChanges.set(i.checked.checkedCount>0),this._currentInput=i,new Promise(e=>{t.onCancellationRequested(()=>e(void 0)),this._currentResolve=e,this._setTreeInput(i),this._sessionDisposables.add(i.checked.onDidChange(()=>{this._tree.updateChildren(),this._ctxHasCheckedChanges.set(i.checked.checkedCount>0)}))})}hasInput(){return!!this._currentInput}async _setTreeInput(e){let t=this._treeViewStates.get(this._treeDataSource.groupByFile);if(await this._tree.setInput(e,t),this._tree.domFocus(),t)return;let i=[...this._tree.getNode(e).children].slice(0,10);for(;i.length>0;){let{element:e}=i.shift();e instanceof gc&&await this._tree.expand(e,!0),e instanceof uc&&(await this._tree.expand(e,!0),i.push(...this._tree.getNode(e).children))}}accept(){var e;let t,i=null===(e=this._currentInput)||void 0===e?void 0:e.conflicts.list();i&&0!==i.length?(t=1===i.length?(0,Rt.Ij)(4534,"Cannot apply refactoring because '{0}' has changed in the meantime.",this._labelService.getUriLabel(i[0],{relative:!0})):(0,Rt.Ij)(4535,"Cannot apply refactoring because {0} other files have changed in the meantime.",i.length),this._dialogService.warn(t).finally(()=>this._done(!1))):this._done(!0)}discard(){this._done(!1)}_done(e){var t,i;null!==(t=this._currentResolve)&&void 0!==t&&t.call(this,e?null===(i=this._currentInput)||void 0===i?void 0:i.getWorkspaceEdit():void 0),this._currentInput=void 0,this._setState(Ac.Message),this._sessionDisposables.clear()}toggleChecked(){let[e]=this._tree.getFocus();((e instanceof gc||e instanceof pc)&&!e.isDisabled()||e instanceof uc)&&e.setChecked(!e.isChecked())}groupByFile(){this._treeDataSource.groupByFile||this.toggleGrouping()}groupByType(){this._treeDataSource.groupByFile&&this.toggleGrouping()}toggleGrouping(){let e=this._tree.getInput();if(e){let t=this._tree.getViewState();this._treeViewStates.set(this._treeDataSource.groupByFile,t),this._treeDataSource.groupByFile=!this._treeDataSource.groupByFile,this._setTreeInput(e),this._storageService.store(Ec._memGroupByFile,this._treeDataSource.groupByFile,Rt.Go.PROFILE,Rt.Ko.USER),this._ctxGroupByFile.set(this._treeDataSource.groupByFile)}}async _openElementInMultiDiffEditor(e){var t,i;let o,s,r=null===(t=this._currentInput)||void 0===t?void 0:t.fileOperations;if(!r)return;if(e.element instanceof pc)s=e.element.parent,o=e.element.edit.textEdit.textEdit.range;else{if(!(e.element instanceof gc))return;s=e.element,o=null===(i=e.element.edit.textEdits[0])||void 0===i?void 0:i.textEdit.textEdit.range}let n=await this._computeResourceDiffEditorInputs.get(r),a=await n.getResourceDiffEditorInputIdOfOperation(s.edit),d=(0,xt.A)((0,xt.A)({},e.editorOptions),{},{viewState:{revealData:{resource:a,range:o}}}),l=Rt.wD.from({scheme:Ec.Schema}),c="Refactor Preview";this._editorService.openEditor({multiDiffSource:l,label:c,options:d,isTransient:!0,description:c,resources:n.resources},e.sideBySide?-2:-1)}_onContextMenu(e){this._contextMenuService.showContextMenu({menuId:Rt.sb.BulkEditContext,contextKeyService:this.contextKeyService,getAnchor:()=>e.anchor})}},{_:Ec=ue},{_:ue.ID="refactorPreview"},{_:ue.Schema="vscode-bulkeditpreview-multieditor"},{_:ue.ctxHasCategories=new Rt.FO("refactorPreview.hasCategories",!1)},{_:ue.ctxGroupByFile=new Rt.FO("refactorPreview.groupByFile",!0)},{_:ue.ctxHasCheckedChanges=new Rt.FO("refactorPreview.hasCheckedChanges",!0)},{_:ue._memGroupByFile="".concat(ue.ID,".groupByFile")},ue);async function Tc(e){let t=await e.openView(Rc.ID,!0);if(t instanceof Rc)return t}Rc=Ec=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Pt.kt),(0,Rt.Fb)(3,Rt.Ya),(0,Rt.Fb)(4,Rt.Lb),(0,Rt.Fb)(5,Rt.Fl),(0,Rt.Fb)(6,Rt.Sl),(0,Rt.Fb)(7,Rt.Uo),(0,Rt.Fb)(8,Rt.yb),(0,Rt.Fb)(9,Wt.dx),(0,Rt.Fb)(10,Rt.kd),(0,Rt.Fb)(11,Rt.Sl),(0,Rt.Fb)(12,Rt.o_),(0,Rt.Fb)(13,Rt.yr),(0,Rt.Fb)(14,Rt.Qd),(0,Rt.Fb)(15,Rt.sr)],Rc),(0,Rt.Ib)(),(0,Rt.vb)(),(0,Pt.b)(),(0,Rt.Mo)(),(0,Wt.Df)(),(0,Wt.E_)(),(0,Nt.ir)(),(0,Rt.Fj)(),(0,Wt.L)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Pt.G)(),(0,Rt.gb)(),(0,Rt.tO)(),(0,Rt.Ct)(),(0,Rt.sm)(),(0,Rt.db)(),(0,Pt.en)(),(0,Rt.zk)(),(0,Rt.Ll)(),(0,Rt.qd)(),(0,Rt.gD)(),(0,Rt.q)(),(0,Nt.wt)();var Lc=class{constructor(e,t){var i;this._paneCompositeService=e,this._editorGroupsService=t,this._activePanel=null===(i=e.getActivePaneComposite(Wt.Sf.Panel))||void 0===i?void 0:i.getId()}async restore(e,t){if(e&&("string"==typeof this._activePanel?await this._paneCompositeService.openPaneComposite(this._activePanel,Wt.Sf.Panel):this._paneCompositeService.hideActivePaneComposite(Wt.Sf.Panel)),t)for(let o of this._editorGroupsService.groups){let e=[];for(let t of o.editors){var i;(null===(i=Pt.Ht.getCanonicalUri(t,{supportSideBySide:Pt.Jt.PRIMARY}))||void 0===i?void 0:i.scheme)===Rc.Schema&&e.push(t)}e.length&&o.closeEditors(e,{preserveFocus:!0})}}};Lc=(0,Rt.Pb)([(0,Rt.Fb)(0,Nt.Ct),(0,Rt.Fb)(1,Pt.W)],Lc);var Wc=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Rt.Lk;this.uxState=e,this.cts=t}},Fc=(ge=class{constructor(e,t,i,o,s,r){this._paneCompositeService=e,this._viewsService=t,this._editorGroupsService=i,this._dialogService=o,s.setPreviewHandler(e=>this._previewEdit(e)),this._ctxEnabled=Vc.ctxEnabled.bindTo(r)}async _previewEdit(e){var t,i;this._ctxEnabled.set(!0);let o,s=null!==(t=null===(i=this._activeSession)||void 0===i?void 0:i.uxState)&&void 0!==t?t:new Lc(this._paneCompositeService,this._editorGroupsService),r=await Tc(this._viewsService);if(!r)return this._ctxEnabled.set(!1),e;if(r.hasInput()){let{confirmed:e}=await this._dialogService.confirm({type:Rt.Kd.Info,message:(0,Rt.Ij)(4520,"Another refactoring is being previewed."),detail:(0,Rt.Ij)(4521,"Press 'Continue' to discard the previous refactoring and continue with the current refactoring."),primaryButton:(0,Rt.Ij)(4522,"&&Continue")});if(!e)return[]}this._activeSession?(await this._activeSession.uxState.restore(!1,!0),this._activeSession.cts.dispose(!0),o=new Wc(s)):o=new Wc(s),this._activeSession=o;try{var n;return null!==(n=await r.setInput(e,o.cts.token))&&void 0!==n?n:[]}finally{this._activeSession===o&&(await this._activeSession.uxState.restore(!0,!0),this._activeSession.cts.dispose(),this._ctxEnabled.set(!1),this._activeSession=void 0)}}},{_:Vc=ge},{_:ge.ID="workbench.contrib.bulkEditPreview"},{_:ge.ctxEnabled=new Rt.FO("refactorPreview.enabled",!1)},ge);Fc=Vc=(0,Rt.Pb)([(0,Rt.Fb)(0,Nt.Ct),(0,Rt.Fb)(1,Wt.T_),(0,Rt.Fb)(2,Pt.W),(0,Rt.Fb)(3,Rt.Fl),(0,Rt.Fb)(4,Rt.jo),(0,Rt.Fb)(5,Rt.yb)],Fc),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"refactorPreview.apply",title:(0,Rt.Lj)(4523,"Apply Refactoring"),category:(0,Rt.Lj)(4524,"Refactor Preview"),icon:Rt.mD.check,precondition:Rt.PO.and(Fc.ctxEnabled,Rc.ctxHasCheckedChanges),menu:[{id:Rt.sb.BulkEditContext,order:1}],keybinding:{weight:Rt.mb.EditorContrib-10,when:Rt.PO.and(Fc.ctxEnabled,Nt.yn.isEqualTo(Rc.ID)),primary:Rt.ZD.CtrlCmd+Rt.YD.Enter}})}async run(e){var t;null===(t=await Tc(e.get(Wt.T_)))||void 0===t||t.accept()}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"refactorPreview.discard",title:(0,Rt.Lj)(4525,"Discard Refactoring"),category:(0,Rt.Lj)(4524,"Refactor Preview"),icon:Rt.mD.clearAll,precondition:Fc.ctxEnabled,menu:[{id:Rt.sb.BulkEditContext,order:2}]})}async run(e){var t;null===(t=await Tc(e.get(Wt.T_)))||void 0===t||t.discard()}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"refactorPreview.toggleCheckedState",title:(0,Rt.Lj)(4526,"Toggle Change"),category:(0,Rt.Lj)(4524,"Refactor Preview"),precondition:Fc.ctxEnabled,keybinding:{weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.Space},menu:{id:Rt.sb.BulkEditContext,group:"navigation"}})}async run(e){var t;null===(t=await Tc(e.get(Wt.T_)))||void 0===t||t.toggleChecked()}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"refactorPreview.groupByFile",title:(0,Rt.Lj)(4527,"Group Changes By File"),category:(0,Rt.Lj)(4524,"Refactor Preview"),icon:Rt.mD.ungroupByRefType,precondition:Rt.PO.and(Rc.ctxHasCategories,Rc.ctxGroupByFile.negate(),Fc.ctxEnabled),menu:[{id:Rt.sb.BulkEditTitle,when:Rt.PO.and(Rc.ctxHasCategories,Rc.ctxGroupByFile.negate()),group:"navigation",order:3}]})}async run(e){var t;null===(t=await Tc(e.get(Wt.T_)))||void 0===t||t.groupByFile()}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"refactorPreview.groupByType",title:(0,Rt.Lj)(4528,"Group Changes By Type"),category:(0,Rt.Lj)(4524,"Refactor Preview"),icon:Rt.mD.groupByRefType,precondition:Rt.PO.and(Rc.ctxHasCategories,Rc.ctxGroupByFile,Fc.ctxEnabled),menu:[{id:Rt.sb.BulkEditTitle,when:Rt.PO.and(Rc.ctxHasCategories,Rc.ctxGroupByFile),group:"navigation",order:3}]})}async run(e){var t;null===(t=await Tc(e.get(Wt.T_)))||void 0===t||t.groupByType()}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"refactorPreview.toggleGrouping",title:(0,Rt.Lj)(4528,"Group Changes By Type"),category:(0,Rt.Lj)(4524,"Refactor Preview"),icon:Rt.mD.listTree,toggled:Rc.ctxGroupByFile.negate(),precondition:Rt.PO.and(Rc.ctxHasCategories,Fc.ctxEnabled),menu:[{id:Rt.sb.BulkEditContext,order:3}]})}async run(e){var t;null===(t=await Tc(e.get(Wt.T_)))||void 0===t||t.toggleGrouping()}}),(0,Pt.x)(Fc.ID,Fc,Pt.y.BlockRestore);var Gc=(0,Rt.J)("refactor-preview-view-icon",Rt.mD.lightbulb,(0,Rt.Ij)(4529,"View icon of the refactor preview view.")),Zc=Rt._b.as(Wt.gf.ViewContainersRegistry).registerViewContainer({id:Rc.ID,title:(0,Rt.Lj)(4530,"Refactor Preview"),hideIfEmpty:!0,ctorDescriptor:new Rt.om(Wt.P,[Rc.ID,{mergeViewWithContainerWhenSingleView:!0}]),icon:Gc,storageId:Rc.ID},Wt.Sf.Panel);Rt._b.as(Wt.gf.ViewsRegistry).registerViews([{id:Rc.ID,name:(0,Rt.Lj)(4530,"Refactor Preview"),when:Fc.ctxEnabled,ctorDescriptor:new Rt.om(Rc),containerIcon:Gc}],Zc),(0,Rt.r)(),(0,Rt.sm)(),(0,Rt.Mo)();(0,Wt.Ft)(),(0,Rt.zk)(),(0,Rt.Qc)(),(0,Rt.xn)(),(0,Rt.nD)(),(0,Rt.ok)(),(0,Rt.xD)(),(0,Rt.Fj)(),(0,Rt.Db)(),(0,Rt.qx)();var Nc,Pc,Jc=class{constructor(e,t,i,o){this.item=e,this.locations=t,this.model=i,this.parent=o}static compare(e,t){let i=(0,Rt.UO)(e.item.uri.toString(),t.item.uri.toString());return 0===i&&(i=Rt.bD.compareRangesUsingStarts(e.item.range,t.item.range)),i}},Bc=class{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof Wt.Nt)return e.roots.map(t=>new Jc(t,void 0,e,void 0));let{model:t,item:i}=e;return this.getDirection()===Wt.Mt.CallsFrom?(await t.resolveOutgoingCalls(i,Rt.Ik.None)).map(o=>new Jc(o.to,o.fromRanges.map(e=>({range:e,uri:i.uri})),t,e)):(await t.resolveIncomingCalls(i,Rt.Ik.None)).map(i=>new Jc(i.from,i.fromRanges.map(e=>({range:e,uri:i.from.uri})),t,e))}},Oc=class{compare(e,t){return Jc.compare(e,t)}},Kc=class{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}},Mc=class{constructor(e,t){this.icon=e,this.label=t}},jc=(pe=class e{constructor(){this.templateId=e.id}renderTemplate(e){e.classList.add("callhierarchy-element");let t=(0,Rt.gx)("div");return e.appendChild(t),new Mc(t,new Rt.bn(e,{supportHighlights:!0}))}renderElement(e,t,i){var o;let{element:s,filterData:r}=e,n=null===(o=s.item.tags)||void 0===o?void 0:o.includes(Rt.XE.Deprecated);i.icon.className="",i.icon.classList.add("inline",...Rt.Eb.asClassNameArray(Rt.YE.toIcon(s.item.kind))),i.label.setLabel(s.item.name,s.item.detail,{labelEscapeNewLines:!0,matches:(0,Rt.Yc)(r),strikethrough:n})}disposeTemplate(e){e.label.dispose()}},{_:pe.id="CallRenderer"},pe),Qc=class{getHeight(e){return 22}getTemplateId(e){return jc.id}},Yc=class{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return(0,Rt.Ij)(4570,"Call Hierarchy")}getAriaLabel(e){return this.getDirection()===Wt.Mt.CallsFrom?(0,Rt.Ij)(4571,"calls from {0}",e.item.name):(0,Rt.Ij)(4572,"callers of {0}",e.item.name)}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Kb)(),(0,Wt.Ft)(),(0,Rt.Ct)(),(0,Rt.Fj)(),(0,Rt.pv)(),(0,Rt.xD)(),(0,Rt.Yt)(),(0,Rt.qx)(),(0,Rt.gA)(),(0,Pt.At)(),(0,Lt.tr)(),(0,Rt.Rb)(),(0,Rt.PA)(),(0,Rt.uy)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.Ev)(),(0,Rt.gn)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.bb)(),(0,Rt.Xr)(),(0,Wt.HS)(),(0,Wt.RS)(),(0,Rt.en)(),(0,Rt.mE)({}),function(e){e.Loading="loading",e.Message="message",e.Data="data"}(Pc||(Pc={}));var Hc=class{static store(e,t){t.store("callHierarchyPeekLayout",JSON.stringify(e),Rt.Go.PROFILE,Rt.Ko.MACHINE)}static retrieve(e){let t=e.get("callHierarchyPeekLayout",Rt.Go.PROFILE,"{}"),i={ratio:.7,height:17};try{return(0,xt.A)((0,xt.A)({},i),JSON.parse(t))}catch(o){return i}}constructor(e,t){this.ratio=e,this.height=t}},Xc=class extends Rt.it{},Uc=(be=class extends Wt.VS{constructor(e,t,i,o,s,r,n,a,d,l,c){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},c),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=r,this._textModelService=n,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=c,this._treeViewStates=new Map,this._previewDisposable=new Rt.EA,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){Hc.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){let t=e.getColor(Wt.US)||Rt.Sv.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(Wt.KS)||Rt.Sv.transparent,primaryHeadingColor:e.getColor(Wt.qS),secondaryHeadingColor:e.getColor(Wt.JS)})}_fillHead(e){super._fillHead(e,!0);let t=this._menuService.createMenu(Nc.TitleMenu,this._contextKeyService),i=()=>{let e=(0,Rt.Jr)(t.getActions());this._actionbarWidget.clear(),this._actionbarWidget.push(e,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=Hc.retrieve(this._storageService),this._dim=new Rt.Qb(0,0),this._parent=e,e.classList.add("call-hierarchy");let t=(0,Rt.gx)("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;let i=(0,Rt.gx)("div");i.classList.add("results"),e.appendChild(i),this._splitView=new Rt.Jt(i,{orientation:Rt.Xt.HORIZONTAL});let o=(0,Rt.gx)("div");o.classList.add("editor"),i.appendChild(o),this._editor=this._instantiationService.createInstance(Lt.$n,o,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor);let s=(0,Rt.gx)("div");s.classList.add("tree"),i.appendChild(s);let r={sorter:new Oc,accessibilityProvider:new Yc(()=>this._direction),identityProvider:new Kc(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:Wt.GS}};this._tree=this._instantiationService.createInstance(Xc,"CallHierarchyPeek",s,new Qc,[this._instantiationService.createInstance(jc)],this._instantiationService.createInstance(Bc,()=>this._direction),r),this._splitView.addView({onDidChange:Rt.dA.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:e})}},Rt.qt.Distribute),this._splitView.addView({onDidChange:Rt.dA.None,element:s,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._tree.layout(this._dim.height,e)}},Rt.qt.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(e=>{let{event:t,target:i}=e;if(2!==t.detail)return;let[o]=this._tree.getFocus();o&&(this.dispose(),this._editorService.openEditor({resource:o.item.uri,options:{selection:i.range}}))})),this._disposables.add(this._tree.onMouseDblClick(e=>{e.target!==Rt.mn.Twistie&&e.element&&(this.dispose(),this._editorService.openEditor({resource:e.element.item.uri,options:{selection:e.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(e=>{let[t]=e.elements;t&&(0,Rt.cS)(e.browserEvent)&&(this.dispose(),this._editorService.openEditor({resource:t.item.uri,options:{selection:t.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){let[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();let t,i={description:"call-hierarchy-decoration",stickiness:Rt.ly.NeverGrowsWhenTypingAtEdges,className:"call-decoration",overviewRuler:{color:(0,Rt.pp)(Wt.WS),position:Rt.ay.Center}};t=this._direction===Wt.Mt.CallsFrom?e.parent?e.parent.item.uri:e.model.root.uri:e.item.uri;let o=await this._textModelService.createModelReference(t);this._editor.setModel(o.object.textEditorModel);let s,r=[],n=e.locations;n||(n=[{uri:e.item.uri,range:e.item.selectionRange}]);for(let d of n)d.uri.toString()===t.toString()&&(r.push({range:d.range,options:i}),s=s?Rt.bD.plusRange(d.range,s):d.range);if(s){this._editor.revealRangeInCenter(s,Rt.fv.Immediate);let e=this._editor.createDecorationsCollection(r);this._previewDisposable.add((0,Rt.zA)(()=>e.clear()))}this._previewDisposable.add(o);let a=this._direction===Wt.Mt.CallsFrom?(0,Rt.Ij)(4565,"Calls from '{0}'",e.model.root.name):(0,Rt.Ij)(4566,"Callers of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state=Pc.Loading,this.setTitle((0,Rt.Ij)(4567,"Loading...")),this._show()}showMessage(e){this._parent.dataset.state=Pc.Message,this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();let t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);let i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),0===i.children.length?this.showMessage(this._direction===Wt.Mt.CallsFrom?(0,Rt.Ij)(4568,"No calls from '{0}'",e.root.name):(0,Rt.Ij)(4569,"No callers of '{0}'",e.root.name)):(this._parent.dataset.state=Pc.Data,(!t||0===this._tree.getFocus().length)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){let t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,Rt.fv.Smooth),super.show(Rt.bD.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new Rt.Qb(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}},{_:Nc=be},{_:be.TitleMenu=new Rt.sb("callhierarchy/title")},be);Uc=Nc=(0,Rt.Pb)([(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Wt.LS),(0,Rt.Fb)(5,Pt.kt),(0,Rt.Fb)(6,Rt.Lb),(0,Rt.Fb)(7,Rt.Uo),(0,Rt.Fb)(8,Rt.Zr),(0,Rt.Fb)(9,Rt.yb),(0,Rt.Fb)(10,Rt.Ub)],Uc),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Wt.Ft)(),(0,Rt.zk)(),(0,Rt.Kb)(),(0,Rt.gA)(),(0,Rt.Wy)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.PA)(),(0,Rt.gb)(),(0,Rt.tO)(),(0,Lt.Ki)(),(0,Wt.HS)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.Hb)(),(0,Rt.xD)(),(0,Rt.db)(),(0,Rt.gD)(),(0,Rt.q)(),(0,Rt.xN)();var zc,qc=new Rt.FO("editorHasCallHierarchyProvider",!1,(0,Rt.Ij)(4553,"Whether a call hierarchy provider is available")),$c=new Rt.FO("callHierarchyVisible",!1,(0,Rt.Ij)(4554,"Whether call hierarchy peek is currently showing")),eh=new Rt.FO("callHierarchyDirection",void 0,{type:"string",description:(0,Rt.Ij)(4555,"Whether call hierarchy shows incoming or outgoing calls")});var th=(me=class{static get(e){return e.getContribution(zc.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._dispoables=new Rt.EA,this._sessionDisposables=new Rt.EA,this._ctxIsVisible=$c.bindTo(this._contextKeyService),this._ctxHasProvider=qc.bindTo(this._contextKeyService),this._ctxDirection=eh.bindTo(this._contextKeyService),this._dispoables.add(Rt.dA.any(e.onDidChangeModel,e.onDidChangeModelLanguage,Wt.Pt.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&Wt.Pt.has(e.getModel()))})),this._dispoables.add(this._sessionDisposables)}dispose(){this._ctxHasProvider.reset(),this._ctxIsVisible.reset(),this._dispoables.dispose()}async startCallHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;let e=this._editor.getModel(),t=this._editor.getPosition();if(!Wt.Pt.has(e))return;let i=new Rt.Lk,o=Wt.Nt.create(e,t,i.token),s=function(e){return e===Wt.Mt.CallsFrom||e===Wt.Mt.CallsTo?e:Wt.Mt.CallsTo}(this._storageService.get(zc._StorageDirection,Rt.Go.PROFILE,Wt.Mt.CallsTo));this._showCallHierarchyWidget(t,s,o,i)}async startCallHierarchyFromCallHierarchy(){var e;if(!this._widget)return;let t=this._widget.getModel(),i=this._widget.getFocused();if(!i||!t)return;let o=await this._editorService.openCodeEditor({resource:i.item.uri},this._editor);if(!o)return;let s=t.fork(i.item);this._sessionDisposables.clear(),null===(e=zc.get(o))||void 0===e||e._showCallHierarchyWidget(Rt.bD.lift(s.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(s),new Rt.Lk)}_showCallHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),Rt.dA.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endCallHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(Uc,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endCallHierarchy(),this._storageService.store(zc._StorageDirection,this._widget.direction,Rt.Go.PROFILE,Rt.Ko.USER)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(e=>{o.token.isCancellationRequested||(e?(this._sessionDisposables.add(e),this._widget.showModel(e)):this._widget.showMessage((0,Rt.Ij)(4556,"No results")))}).catch(e=>{(0,Rt.SN)(e)?this.endCallHierarchy():this._widget.showMessage((0,Rt.Ij)(4557,"Failed to show call hierarchy"))})}showOutgoingCalls(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(Wt.Mt.CallsFrom),this._ctxDirection.set(Wt.Mt.CallsFrom)}showIncomingCalls(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(Wt.Mt.CallsTo),this._ctxDirection.set(Wt.Mt.CallsTo)}endCallHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}},{_:zc=me},{_:me.Id="callHierarchy"},{_:me._StorageDirection="callHierarchy/defaultDirection"},me);th=zc=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.yb),(0,Rt.Fb)(2,Rt.Uo),(0,Rt.Fb)(3,Rt.Vb),(0,Rt.Fb)(4,Rt.Ub)],th),(0,Rt.Jy)(th.Id,th,Rt.Ly.Eager),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.showCallHierarchy",title:(0,Rt.Lj)(4558,"Peek Call Hierarchy"),menu:{id:Rt.sb.EditorContextPeek,group:"navigation",order:1e3,when:Rt.PO.and(qc,Wt.zS.notInPeekEditor,Lt.Gi.isInEmbeddedEditor.toNegated())},keybinding:{when:Lt.Gi.editorTextFocus,weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift+Rt.ZD.Alt+Rt.YD.KeyH},precondition:Rt.PO.and(qc,Wt.zS.notInPeekEditor),f1:!0})}async runEditorCommand(e,t){var i;return null===(i=th.get(t))||void 0===i?void 0:i.startCallHierarchyFromEditor()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.showIncomingCalls",title:(0,Rt.Lj)(4559,"Show Incoming Calls"),icon:(0,Rt.J)("callhierarchy-incoming",Rt.mD.callIncoming,(0,Rt.Ij)(4560,"Icon for incoming calls in the call hierarchy view.")),precondition:Rt.PO.and($c,eh.isEqualTo(Wt.Mt.CallsFrom)),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift+Rt.ZD.Alt+Rt.YD.KeyH},menu:{id:Uc.TitleMenu,when:eh.isEqualTo(Wt.Mt.CallsFrom),order:1}})}runEditorCommand(e,t){var i;return null===(i=th.get(t))||void 0===i?void 0:i.showIncomingCalls()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.showOutgoingCalls",title:(0,Rt.Lj)(4561,"Show Outgoing Calls"),icon:(0,Rt.J)("callhierarchy-outgoing",Rt.mD.callOutgoing,(0,Rt.Ij)(4562,"Icon for outgoing calls in the call hierarchy view.")),precondition:Rt.PO.and($c,eh.isEqualTo(Wt.Mt.CallsTo)),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift+Rt.ZD.Alt+Rt.YD.KeyH},menu:{id:Uc.TitleMenu,when:eh.isEqualTo(Wt.Mt.CallsTo),order:1}})}runEditorCommand(e,t){var i;return null===(i=th.get(t))||void 0===i?void 0:i.showOutgoingCalls()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.refocusCallHierarchy",title:(0,Rt.Lj)(4563,"Refocus Call Hierarchy"),precondition:$c,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift+Rt.YD.Enter}})}async runEditorCommand(e,t){var i;return null===(i=th.get(t))||void 0===i?void 0:i.startCallHierarchyFromCallHierarchy()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.closeCallHierarchy",title:(0,Rt.Ij)(4564,"Close"),icon:Rt.mD.close,precondition:$c,keybinding:{weight:Rt.mb.WorkbenchContrib+10,primary:Rt.YD.Escape,when:Rt.PO.not("config.editor.stablePeek")},menu:{id:Uc.TitleMenu,order:1e3}})}runEditorCommand(e,t){var i;return null===(i=th.get(t))||void 0===i?void 0:i.endCallHierarchy()}});(0,Wt.jt)(),(0,Rt.zk)(),(0,Rt.Qc)(),(0,Rt.xn)(),(0,Rt.nD)(),(0,Rt.ok)(),(0,Rt.xD)(),(0,Rt.Fj)(),(0,Rt.Db)(),(0,Rt.qx)();var ih,oh,sh=class{constructor(e,t,i){this.item=e,this.model=t,this.parent=i}static compare(e,t){let i=(0,Rt.UO)(e.item.uri.toString(),t.item.uri.toString());return 0===i&&(i=Rt.bD.compareRangesUsingStarts(e.item.range,t.item.range)),i}},rh=class{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof Wt.kt)return e.roots.map(t=>new sh(t,e,void 0));let{model:t,item:i}=e;return this.getDirection()===Wt.Ot.Supertypes?(await t.provideSupertypes(i,Rt.Ik.None)).map(i=>new sh(i,t,e)):(await t.provideSubtypes(i,Rt.Ik.None)).map(i=>new sh(i,t,e))}},nh=class{compare(e,t){return sh.compare(e,t)}},ah=class{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}},dh=class{constructor(e,t){this.icon=e,this.label=t}},lh=(ve=class e{constructor(){this.templateId=e.id}renderTemplate(e){e.classList.add("typehierarchy-element");let t=(0,Rt.gx)("div");return e.appendChild(t),new dh(t,new Rt.bn(e,{supportHighlights:!0}))}renderElement(e,t,i){var o;let{element:s,filterData:r}=e,n=null===(o=s.item.tags)||void 0===o?void 0:o.includes(Rt.XE.Deprecated);i.icon.classList.add("inline",...Rt.Eb.asClassNameArray(Rt.YE.toIcon(s.item.kind))),i.label.setLabel(s.item.name,s.item.detail,{labelEscapeNewLines:!0,matches:(0,Rt.Yc)(r),strikethrough:n})}disposeTemplate(e){e.label.dispose()}},{_:ve.id="TypeRenderer"},ve),ch=class{getHeight(e){return 22}getTemplateId(e){return lh.id}},hh=class{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return(0,Rt.Ij)(12855,"Type Hierarchy")}getAriaLabel(e){return this.getDirection()===Wt.Ot.Supertypes?(0,Rt.Ij)(12856,"supertypes of {0}",e.item.name):(0,Rt.Ij)(12857,"subtypes of {0}",e.item.name)}};(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Yt)(),(0,Rt.gn)(),(0,Rt.Ev)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Lt.tr)(),(0,Rt.xD)(),(0,Rt.pv)(),(0,Rt.uy)(),(0,Rt.Rb)(),(0,Rt.Fj)(),(0,Rt.Xr)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.bb)(),(0,Rt.Kb)(),(0,Rt.Ct)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Wt.jt)(),(0,Pt.At)(),(0,Wt.HS)(),(0,Wt.RS)(),(0,Rt.en)(),(0,Rt.mE)({}),function(e){e.Loading="loading",e.Message="message",e.Data="data"}(oh||(oh={}));var uh=class{static store(e,t){t.store("typeHierarchyPeekLayout",JSON.stringify(e),Rt.Go.PROFILE,Rt.Ko.MACHINE)}static retrieve(e){let t=e.get("typeHierarchyPeekLayout",Rt.Go.PROFILE,"{}"),i={ratio:.7,height:17};try{return(0,xt.A)((0,xt.A)({},i),JSON.parse(t))}catch(o){return i}}constructor(e,t){this.ratio=e,this.height=t}},gh=class extends Rt.it{},ph=(Ce=class extends Wt.VS{constructor(e,t,i,o,s,r,n,a,d,l,c){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},c),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=r,this._textModelService=n,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=c,this._treeViewStates=new Map,this._previewDisposable=new Rt.EA,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){uh.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){let t=e.getColor(Wt.US)||Rt.Sv.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(Wt.KS)||Rt.Sv.transparent,primaryHeadingColor:e.getColor(Wt.qS),secondaryHeadingColor:e.getColor(Wt.JS)})}_fillHead(e){super._fillHead(e,!0);let t=this._menuService.createMenu(ih.TitleMenu,this._contextKeyService),i=()=>{let e=(0,Rt.Jr)(t.getActions());this._actionbarWidget.clear(),this._actionbarWidget.push(e,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=uh.retrieve(this._storageService),this._dim=new Rt.Qb(0,0),this._parent=e,e.classList.add("type-hierarchy");let t=(0,Rt.gx)("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;let i=(0,Rt.gx)("div");i.classList.add("results"),e.appendChild(i),this._splitView=new Rt.Jt(i,{orientation:Rt.Xt.HORIZONTAL});let o=(0,Rt.gx)("div");o.classList.add("editor"),i.appendChild(o),this._editor=this._instantiationService.createInstance(Lt.$n,o,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor);let s=(0,Rt.gx)("div");s.classList.add("tree"),i.appendChild(s);let r={sorter:new nh,accessibilityProvider:new hh(()=>this._direction),identityProvider:new ah(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:Wt.GS}};this._tree=this._instantiationService.createInstance(gh,"TypeHierarchyPeek",s,new ch,[this._instantiationService.createInstance(lh)],this._instantiationService.createInstance(rh,()=>this._direction),r),this._splitView.addView({onDidChange:Rt.dA.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:e})}},Rt.qt.Distribute),this._splitView.addView({onDidChange:Rt.dA.None,element:s,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._dim.height&&this._tree.layout(this._dim.height,e)}},Rt.qt.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(e=>{let{event:t,target:i}=e;if(2!==t.detail)return;let[o]=this._tree.getFocus();o&&(this.dispose(),this._editorService.openEditor({resource:o.item.uri,options:{selection:i.range}}))})),this._disposables.add(this._tree.onMouseDblClick(e=>{e.target!==Rt.mn.Twistie&&e.element&&(this.dispose(),this._editorService.openEditor({resource:e.element.item.uri,options:{selection:e.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(e=>{let[t]=e.elements;t&&(0,Rt.cS)(e.browserEvent)&&(this.dispose(),this._editorService.openEditor({resource:t.item.uri,options:{selection:t.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){let[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();let t,i={description:"type-hierarchy-decoration",stickiness:Rt.ly.NeverGrowsWhenTypingAtEdges,className:"type-decoration",overviewRuler:{color:(0,Rt.pp)(Wt.WS),position:Rt.ay.Center}};t=this._direction===Wt.Ot.Supertypes?e.parent?e.parent.item.uri:e.model.root.uri:e.item.uri;let o=await this._textModelService.createModelReference(t);this._editor.setModel(o.object.textEditorModel);let s,r=[],n={uri:e.item.uri,range:e.item.selectionRange};if(n.uri.toString()===t.toString()&&(r.push({range:n.range,options:i}),s=s?Rt.bD.plusRange(n.range,s):n.range),s){this._editor.revealRangeInCenter(s,Rt.fv.Immediate);let e=this._editor.createDecorationsCollection(r);this._previewDisposable.add((0,Rt.zA)(()=>e.clear()))}this._previewDisposable.add(o);let a=this._direction===Wt.Ot.Supertypes?(0,Rt.Ij)(12850,"Supertypes of '{0}'",e.model.root.name):(0,Rt.Ij)(12851,"Subtypes of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state=oh.Loading,this.setTitle((0,Rt.Ij)(12852,"Loading...")),this._show()}showMessage(e){this._parent.dataset.state=oh.Message,this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();let t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);let i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),0===i.children.length?this.showMessage(this._direction===Wt.Ot.Supertypes?(0,Rt.Ij)(12853,"No supertypes of '{0}'",e.root.name):(0,Rt.Ij)(12854,"No subtypes of '{0}'",e.root.name)):(this._parent.dataset.state=oh.Data,(!t||0===this._tree.getFocus().length)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){let t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,Rt.fv.Smooth),super.show(Rt.bD.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new Rt.Qb(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}},{_:ih=Ce},{_:Ce.TitleMenu=new Rt.sb("typehierarchy/title")},Ce);ph=ih=(0,Rt.Pb)([(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Wt.LS),(0,Rt.Fb)(5,Pt.kt),(0,Rt.Fb)(6,Rt.Lb),(0,Rt.Fb)(7,Rt.Uo),(0,Rt.Fb)(8,Rt.Zr),(0,Rt.Fb)(9,Rt.yb),(0,Rt.Fb)(10,Rt.Ub)],ph),(0,Rt.Ib)(),(0,Rt.zk)(),(0,Rt.gD)(),(0,Rt.xN)(),(0,Rt.gA)(),(0,Rt.tO)(),(0,Rt.PA)(),(0,Rt.Wy)(),(0,Rt.Hb)(),(0,Rt.xD)(),(0,Wt.HS)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.Kb)(),(0,Rt.gb)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Wt.jt)();var bh,mh=new Rt.FO("editorHasTypeHierarchyProvider",!1,(0,Rt.Ij)(12840,"Whether a type hierarchy provider is available")),vh=new Rt.FO("typeHierarchyVisible",!1,(0,Rt.Ij)(12841,"Whether type hierarchy peek is currently showing")),Ch=new Rt.FO("typeHierarchyDirection",void 0,{type:"string",description:(0,Rt.Ij)(12842,"whether type hierarchy shows super types or subtypes")});var wh=(we=class{static get(e){return e.getContribution(bh.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._disposables=new Rt.EA,this._sessionDisposables=new Rt.EA,this._ctxHasProvider=mh.bindTo(this._contextKeyService),this._ctxIsVisible=vh.bindTo(this._contextKeyService),this._ctxDirection=Ch.bindTo(this._contextKeyService),this._disposables.add(Rt.dA.any(e.onDidChangeModel,e.onDidChangeModelLanguage,Wt.At.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&Wt.At.has(e.getModel()))})),this._disposables.add(this._sessionDisposables)}dispose(){this._disposables.dispose()}async startTypeHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;let e=this._editor.getModel(),t=this._editor.getPosition();if(!Wt.At.has(e))return;let i=new Rt.Lk,o=Wt.kt.create(e,t,i.token),s=function(e){return e===Wt.Ot.Subtypes||e===Wt.Ot.Supertypes?e:Wt.Ot.Subtypes}(this._storageService.get(bh._storageDirectionKey,Rt.Go.PROFILE,Wt.Ot.Subtypes));this._showTypeHierarchyWidget(t,s,o,i)}_showTypeHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),Rt.dA.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endTypeHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(ph,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endTypeHierarchy(),this._storageService.store(bh._storageDirectionKey,this._widget.direction,Rt.Go.PROFILE,Rt.Ko.USER)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(e=>{o.token.isCancellationRequested||(e?(this._sessionDisposables.add(e),this._widget.showModel(e)):this._widget.showMessage((0,Rt.Ij)(12843,"No results")))}).catch(e=>{(0,Rt.SN)(e)?this.endTypeHierarchy():this._widget.showMessage((0,Rt.Ij)(12844,"Failed to show type hierarchy"))})}async startTypeHierarchyFromTypeHierarchy(){var e;if(!this._widget)return;let t=this._widget.getModel(),i=this._widget.getFocused();if(!i||!t)return;let o=await this._editorService.openCodeEditor({resource:i.item.uri},this._editor);if(!o)return;let s=t.fork(i.item);this._sessionDisposables.clear(),null===(e=bh.get(o))||void 0===e||e._showTypeHierarchyWidget(Rt.bD.lift(s.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(s),new Rt.Lk)}showSupertypes(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(Wt.Ot.Supertypes),this._ctxDirection.set(Wt.Ot.Supertypes)}showSubtypes(){var e;null!==(e=this._widget)&&void 0!==e&&e.updateDirection(Wt.Ot.Subtypes),this._ctxDirection.set(Wt.Ot.Subtypes)}endTypeHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}},{_:bh=we},{_:we.Id="typeHierarchy"},{_:we._storageDirectionKey="typeHierarchy/defaultDirection"},we);wh=bh=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.yb),(0,Rt.Fb)(2,Rt.Uo),(0,Rt.Fb)(3,Rt.Vb),(0,Rt.Fb)(4,Rt.Ub)],wh),(0,Rt.Jy)(wh.Id,wh,Rt.Ly.Eager),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.showTypeHierarchy",title:(0,Rt.Lj)(12845,"Peek Type Hierarchy"),menu:{id:Rt.sb.EditorContextPeek,group:"navigation",order:1e3,when:Rt.PO.and(mh,Wt.zS.notInPeekEditor)},precondition:Rt.PO.and(mh,Wt.zS.notInPeekEditor),f1:!0})}async runEditorCommand(e,t){var i;return null===(i=wh.get(t))||void 0===i?void 0:i.startTypeHierarchyFromEditor()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.showSupertypes",title:(0,Rt.Lj)(12846,"Show Supertypes"),icon:Rt.mD.typeHierarchySuper,precondition:Rt.PO.and(vh,Ch.isEqualTo(Wt.Ot.Subtypes)),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift+Rt.ZD.Alt+Rt.YD.KeyH},menu:{id:ph.TitleMenu,when:Ch.isEqualTo(Wt.Ot.Subtypes),order:1}})}runEditorCommand(e,t){var i;return null===(i=wh.get(t))||void 0===i?void 0:i.showSupertypes()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.showSubtypes",title:(0,Rt.Lj)(12847,"Show Subtypes"),icon:Rt.mD.typeHierarchySub,precondition:Rt.PO.and(vh,Ch.isEqualTo(Wt.Ot.Supertypes)),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift+Rt.ZD.Alt+Rt.YD.KeyH},menu:{id:ph.TitleMenu,when:Ch.isEqualTo(Wt.Ot.Supertypes),order:1}})}runEditorCommand(e,t){var i;return null===(i=wh.get(t))||void 0===i?void 0:i.showSubtypes()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.refocusTypeHierarchy",title:(0,Rt.Lj)(12848,"Refocus Type Hierarchy"),precondition:vh,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift+Rt.YD.Enter}})}async runEditorCommand(e,t){var i;return null===(i=wh.get(t))||void 0===i?void 0:i.startTypeHierarchyFromTypeHierarchy()}}),(0,Rt.pb)(class extends Rt.Fy{constructor(){super({id:"editor.closeTypeHierarchy",title:(0,Rt.Ij)(12849,"Close"),icon:Rt.mD.close,precondition:vh,keybinding:{weight:Rt.mb.WorkbenchContrib+10,primary:Rt.YD.Escape,when:Rt.PO.not("config.editor.stablePeek")},menu:{id:ph.TitleMenu,order:1e3}})}runEditorCommand(e,t){var i;return null===(i=wh.get(t))||void 0===i?void 0:i.endTypeHierarchy()}});(0,Rt.Mb)(),(0,Rt.Fj)();var yh=class extends Rt.Ob{constructor(e,t){super("vs.tree.collapse",(0,Rt.Ij)(42,"Collapse All"),"collapse-all",t),this.viewer=e}async run(){this.viewer.collapseAll(),this.viewer.setSelection([]),this.viewer.setFocus([])}};(0,Rt.qx)(),(0,Rt.Bn)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.Fj)(),(0,Rt.Mi)();var fh,Sh=class extends Rt.CA{constructor(){super(...arguments),this._onDidChangeCheckboxState=this._register(new Rt.uA),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event}setCheckboxState(e){this._onDidChangeCheckboxState.fire([e])}},Ih=(ye=class e extends Rt.CA{constructor(e,t,i,o){super(),this.checkboxStateHandler=t,this.hoverDelegate=i,this.hoverService=o,this.checkboxContainer=e}render(e){e.checkbox&&(this.toggle?this.toggle.checked=e.checkbox.isChecked:this.createCheckbox(e))}createCheckbox(t){t.checkbox&&(this.toggle=new Rt.Rn("",t.checkbox.isChecked,(0,xt.A)((0,xt.A)({},Rt.Si),{},{size:15})),this.setHover(t.checkbox),this.setAccessibilityInformation(t.checkbox),this.toggle.domNode.classList.add(e.checkboxClass),this.toggle.domNode.tabIndex=1,(0,Rt.dx)(this.checkboxContainer,this.toggle.domNode),this.registerListener(t))}registerListener(e){this.toggle&&(this._register({dispose:()=>this.removeCheckbox()}),this._register(this.toggle),this._register(this.toggle.onChange(()=>{this.setCheckbox(e)})))}setHover(e){this.toggle&&(this.hover?this.hover.update(e.tooltip):this.hover=this._register(this.hoverService.setupManagedHover(this.hoverDelegate,this.toggle.domNode,this.checkboxHoverContent(e))))}setCheckbox(e){this.toggle&&e.checkbox&&(e.checkbox.isChecked=this.toggle.checked,this.setHover(e.checkbox),this.setAccessibilityInformation(e.checkbox),this.checkboxStateHandler.setCheckboxState(e))}checkboxHoverContent(e){return e.tooltip?e.tooltip:e.isChecked?(0,Rt.Ij)(3688,"Checked"):(0,Rt.Ij)(3689,"Unchecked")}setAccessibilityInformation(e){this.toggle&&e.accessibilityInformation&&(this.toggle.setTitle(e.accessibilityInformation.label),e.accessibilityInformation.role&&(this.toggle.domNode.role=e.accessibilityInformation.role))}removeCheckbox(){let e=this.checkboxContainer.children;for(let t of e)t.remove()}},{_:ye.checkboxClass="custom-view-tree-node-item-checkbox"},ye);(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.ha)(),(0,Rt.qx)(),(0,Rt.Xl)(),(0,Rt.Ki)(),(0,Rt.zr)(),(0,Rt.Hi)(),(0,Rt.gn)(),(0,Rt.Mb)(),(0,Rt.Iw)(),(0,Rt.zk)(),(0,Rt.gD)(),(0,Rt.xN)(),(0,Rt.gA)(),(0,Rt.Qc)(),(0,Rt.Ic)(),(0,Rt.PA)(),(0,Rt.av)(),(0,Rt.yT)(),(0,Rt.iT)(),(0,Rt.ok)(),(0,Rt.nM)(),(0,Rt.TD)(),(0,Rt.hp)(),(0,Wt.sh)(),(0,Rt.Fj)(),(0,Rt.Xr)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.Sb)(),(0,Rt.wb)(),(0,Rt.s_)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Rt.ac)(),(0,Rt.Kb)(),(0,Rt.Ad)(),(0,Rt.Xa)(),(0,Rt.Ct)(),(0,Rt.nb)(),(0,Rt.Rd)(),(0,Rt.br)(),(0,Rt.Ja)(),(0,Rt.vb)(),(0,Rt.ab)(),(0,Rt.wm)(),(0,Rt.dp)(),(0,Rt.$d)(),(0,Rt.Db)(),(0,Wt.W)(),(0,Wt.ot)(),(0,Wt.Q)(),(0,Wt.Df)(),(0,Wt.fx)(),(0,Tt.dt)(),(0,Tt.zn)(),(0,Nt.Ot)(),(0,Rt.ar)(),(0,Rt.cr)(),(0,Wt.rh)(),(0,Wt.Xm)(),(0,Rt.mj)(),(0,Ot.nt)(),(0,Wt.sC)(),(0,Wt._m)(),(0,Rt.dl)(),(0,Rt.lr)(),(0,Rt.Qn)(),(0,Rt.Mi)(),(0,Tt.Vn)(),(0,Rt.mE)({});var kh=class extends Wt.Y{constructor(e,t,i,o,s,r,n,a,d,l,c,h){super((0,xt.A)((0,xt.A)({},e),{},{titleMenuId:Rt.sb.ViewTitle,donotForwardArgs:!1}),t,i,o,s,r,n,a,d,c,h);let{treeView:u}=Rt._b.as(Wt.gf.ViewsRegistry).getView(e.id);this.treeView=u,this._register(this.treeView.onDidChangeActions(()=>this.updateActions(),this)),this._register(this.treeView.onDidChangeTitle(e=>this.updateTitle(e))),this._register(this.treeView.onDidChangeDescription(e=>this.updateTitleDescription(e))),this._register((0,Rt.zA)(()=>{this._container&&this.treeView.container&&this._container===this.treeView.container&&this.treeView.setVisibility(!1)})),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.treeView.onDidChangeWelcomeState(()=>this._onDidChangeViewWelcomeState.fire())),e.title!==this.treeView.title&&this.updateTitle(this.treeView.title),e.titleDescription!==this.treeView.description&&this.updateTitleDescription(this.treeView.description),this._actionRunner=this._register(new Ph(l,()=>this.treeView.getSelection())),this.updateTreeVisibility()}focus(){super.focus(),this.treeView.focus()}renderBody(e){this._container=e,super.renderBody(e),this.renderTreeView(e)}shouldShowWelcome(){return(void 0===this.treeView.dataProvider||!!this.treeView.dataProvider.isTreeEmpty)&&(void 0===this.treeView.message||""===this.treeView.message)}layoutBody(e,t){super.layoutBody(e,t),this.layoutTreeView(e,t)}getOptimalWidth(){return this.treeView.getOptimalWidth()}renderTreeView(e){this.treeView.show(e)}layoutTreeView(e,t){this.treeView.layout(e,t)}updateTreeVisibility(){this.treeView.setVisibility(this.isBodyVisible())}getActionRunner(){return this._actionRunner}getActionsContext(){return{$treeViewId:this.id,$focusedTreeItem:!0,$selectedTreeItems:!0}}};kh=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.kd),(0,Rt.Fb)(2,Rt.Sl),(0,Rt.Fb)(3,Rt.o_),(0,Rt.Fb)(4,Rt.yb),(0,Rt.Fb)(5,Wt.dx),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.yr),(0,Rt.Fb)(8,Rt.Qd),(0,Rt.Fb)(9,Rt.Ld),(0,Rt.Fb)(10,Rt.sr),(0,Rt.Fb)(11,Tt.Bn)],kh);var _h=class{constructor(){this.label={label:"root"},this.handle="0",this.parentHandle=void 0,this.collapsibleState=Wt.yf.Expanded,this.children=void 0}};function Eh(e){var t;let i=Rt.xb.getCommand(e);if(i)return null===(t=Rt.lb.getCommand(i.id))||void 0===t?void 0:t.precondition}function Ah(e,t){let i=Eh(e.originalId?e.originalId:e.id);return!i||t.contextMatchesRules(i)}function Dh(e){return!!e&&"string"!=typeof e&&!!e.element&&!!e.disposables}var xh=(0,Rt.Ij)(3690,"There is no data provider registered that can provide view data."),Vh=new Rt.FO("customTreeView",!1),Rh=class extends Rt.it{},Th=class extends Rt.CA{get onDidExpandItem(){return this._onDidExpandItem.event}get onDidCollapseItem(){return this._onDidCollapseItem.event}get onDidChangeSelectionAndFocus(){return this._onDidChangeSelectionAndFocus.event}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}get onDidChangeActions(){return this._onDidChangeActions.event}get onDidChangeWelcomeState(){return this._onDidChangeWelcomeState.event}get onDidChangeTitle(){return this._onDidChangeTitle.event}get onDidChangeDescription(){return this._onDidChangeDescription.event}get onDidChangeCheckboxState(){return this._onDidChangeCheckboxState.event}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super(),this.id=e,this._title=t,this.themeService=i,this.instantiationService=o,this.commandService=s,this.configurationService=r,this.progressService=n,this.contextMenuService=a,this.keybindingService=d,this.notificationService=l,this.viewDescriptorService=c,this.hoverService=h,this.contextKeyService=u,this.activityService=g,this.logService=p,this.openerService=b,this.markdownRendererService=m,this.isVisible=!1,this._hasIconForParentNode=!1,this._hasIconForLeafNode=!1,this.focused=!1,this._canSelectMany=!1,this._manuallyManageCheckboxes=!1,this.elementsToRefresh=[],this.lastSelection=[],this._onDidExpandItem=this._register(new Rt.uA),this._onDidCollapseItem=this._register(new Rt.uA),this._onDidChangeSelectionAndFocus=this._register(new Rt.uA),this._onDidChangeVisibility=this._register(new Rt.uA),this._onDidChangeActions=this._register(new Rt.uA),this._onDidChangeWelcomeState=this._register(new Rt.uA),this._onDidChangeTitle=this._register(new Rt.uA),this._onDidChangeDescription=this._register(new Rt.uA),this._onDidChangeCheckboxState=this._register(new Rt.uA),this._onDidCompleteRefresh=this._register(new Rt.uA),this._isInitialized=!1,this._activity=this._register(new Rt.OA),this.activated=!1,this.treeDisposables=this._register(new Rt.EA),this._height=0,this._width=0,this.refreshing=!1,this.root=new _h,this.lastActive=this.root}initialize(){this._isInitialized||(this._isInitialized=!0,this.contextKeyService.bufferChangeEvents(()=>{this.initializeShowCollapseAllAction(),this.initializeCollapseAllToggle(),this.initializeShowRefreshAction()}),this.treeViewDnd=this.instantiationService.createInstance(Oh,this.id),this._dragAndDropController&&(this.treeViewDnd.controller=this._dragAndDropController),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorer.decorations")&&this.doRefresh([this.root])})),this._register(this.viewDescriptorService.onDidChangeLocation(e=>{var t;let{views:i,from:o,to:s}=e;i.some(e=>e.id===this.id)&&(null===(t=this.tree)||void 0===t||t.updateOptions({overrideStyles:(0,Wt.Z)(this.viewLocation).listOverrideStyles}))})),this.registerActions(),this.create())}get viewContainer(){return this.viewDescriptorService.getViewContainerByViewId(this.id)}get viewLocation(){return this.viewDescriptorService.getViewLocationById(this.id)}get dragAndDropController(){return this._dragAndDropController}set dragAndDropController(e){this._dragAndDropController=e,this.treeViewDnd&&(this.treeViewDnd.controller=e)}get dataProvider(){return this._dataProvider}set dataProvider(e){if(e){this.visible&&this.activate();let t=this;this._dataProvider=new class{constructor(){this._isEmpty=!0,this._onDidChangeEmpty=new Rt.uA,this.onDidChangeEmpty=this._onDidChangeEmpty.event}get isTreeEmpty(){return this._isEmpty}async getChildren(e){var t;return null===(t=await this.getChildrenBatch(e?[e]:void 0))||void 0===t?void 0:t[0]}updateEmptyState(e,t){if(1===e.length&&e[0]instanceof _h){let e=this._isEmpty;this._isEmpty=0===t.length||0===t[0].length,e!==this._isEmpty&&this._onDidChangeEmpty.fire()}}findCheckboxesUpdated(e,i){if(0===i.length)return[];let o=[];for(let n=0;n<e.length;n++){let a=e[n],d=i[n];for(let e of d){var s,r;e.parent=a,!t.manuallyManageCheckboxes&&!0===(null===a||void 0===a||null===(s=a.checkbox)||void 0===s?void 0:s.isChecked)&&!1===(null===(r=e.checkbox)||void 0===r?void 0:r.isChecked)&&(e.checkbox.isChecked=!0,o.push(e))}}return o}async getChildrenBatch(i){var o;let s,r=[];if(null!==(o=i)&&void 0!==o&&o.every(e=>!!e.children))s=i.map(e=>e.children);else{null!==i&&void 0!==i||(i=[t.root]);let o=await(1===i.length&&i[0]instanceof _h?Fh(e,void 0):Fh(e,i));for(let e=0;e<i.length;e++){i[e].children=o?o[e]:void 0}s=null!==o&&void 0!==o?o:[],r=this.findCheckboxesUpdated(i,s)}return this.updateEmptyState(i,s),r.length>0&&t._onDidChangeCheckboxState.fire(r),s}},this._dataProvider.onDidChangeEmpty&&this._register(this._dataProvider.onDidChangeEmpty(()=>{this.updateCollapseAllToggle(),this._onDidChangeWelcomeState.fire()})),this.updateMessage(),this.refresh()}else this._dataProvider=void 0,this.treeDisposables.clear(),this.activated=!1,this.updateMessage();this._onDidChangeWelcomeState.fire()}get message(){return this._message}set message(e){this._message=e,this.updateMessage(),this._onDidChangeWelcomeState.fire()}get title(){return this._title}set title(e){this._title=e,this.tree&&(this.tree.ariaLabel=this._title),this._onDidChangeTitle.fire(this._title)}get description(){return this._description}set description(e){this._description=e,this._onDidChangeDescription.fire(this._description)}get badge(){return this._badge}set badge(e){var t,i;if((null===(t=this._badge)||void 0===t?void 0:t.value)!==(null===e||void 0===e?void 0:e.value)||(null===(i=this._badge)||void 0===i?void 0:i.tooltip)!==(null===e||void 0===e?void 0:e.tooltip))if(this._badge=e,e){let t={badge:new Tt.lt(e.value,()=>e.tooltip),priority:50};this._activity.value=this.activityService.showViewActivity(this.id,t)}else this._activity.clear()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){var t;let i=this._canSelectMany;this._canSelectMany=e,this._canSelectMany!==i&&(null===(t=this.tree)||void 0===t||t.updateOptions({multipleSelectionSupport:this.canSelectMany}))}get manuallyManageCheckboxes(){return this._manuallyManageCheckboxes}set manuallyManageCheckboxes(e){this._manuallyManageCheckboxes=e}get hasIconForParentNode(){return this._hasIconForParentNode}get hasIconForLeafNode(){return this._hasIconForLeafNode}get visible(){return this.isVisible}initializeShowCollapseAllAction(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.collapseAllContext||(this.collapseAllContext=(this.collapseAllContextKey=new Rt.FO("treeView.".concat(this.id,".enableCollapseAll"),e,(0,Rt.Ij)(3691,"Whether the tree view with id {0} enables collapse all.",this.id)),this.collapseAllContextKey.bindTo(this.contextKeyService))),!0}get showCollapseAllAction(){var e;return this.initializeShowCollapseAllAction(),!(null===(e=this.collapseAllContext)||void 0===e||!e.get())}set showCollapseAllAction(e){var t;this.initializeShowCollapseAllAction(e),null===(t=this.collapseAllContext)||void 0===t||t.set(e)}initializeShowRefreshAction(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.refreshContext||(this.refreshContext=(this.refreshContextKey=new Rt.FO("treeView.".concat(this.id,".enableRefresh"),e,(0,Rt.Ij)(3692,"Whether the tree view with id {0} enables refresh.",this.id)),this.refreshContextKey.bindTo(this.contextKeyService)))}get showRefreshAction(){var e;return this.initializeShowRefreshAction(),!(null===(e=this.refreshContext)||void 0===e||!e.get())}set showRefreshAction(e){var t;this.initializeShowRefreshAction(e),null===(t=this.refreshContext)||void 0===t||t.set(e)}registerActions(){let e=this;this._register((0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.actions.treeView.".concat(e.id,".refresh"),title:(0,Rt.Ij)(3693,"Refresh"),menu:{id:Rt.sb.ViewTitle,when:Rt.PO.and(Rt.PO.equals("view",e.id),e.refreshContextKey),group:"navigation",order:2**53-1-1},icon:Rt.mD.refresh})}async run(){return e.refresh()}})),this._register((0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.actions.treeView.".concat(e.id,".collapseAll"),title:(0,Rt.Ij)(3694,"Collapse All"),menu:{id:Rt.sb.ViewTitle,when:Rt.PO.and(Rt.PO.equals("view",e.id),e.collapseAllContextKey),group:"navigation",order:2**53-1},precondition:e.collapseAllToggleContextKey,icon:Rt.mD.collapseAll})}async run(){if(e.tree)return new yh(e.tree,!0).run()}}))}setVisibility(e){this.initialize(),e=!!e,this.isVisible!==e&&(this.isVisible=e,this.tree&&(this.isVisible?(0,Rt.DS)(this.tree.getHTMLElement()):(0,Rt.Kx)(this.tree.getHTMLElement()),this.isVisible&&this.elementsToRefresh.length&&this.dataProvider&&(this.doRefresh(this.elementsToRefresh),this.elementsToRefresh=[])),(0,Rt.Pj)(()=>{this.dataProvider&&this._onDidChangeVisibility.fire(this.isVisible)}),this.visible&&this.activate())}focus(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.tree&&this.root.children&&this.root.children.length>0){let i=null!==t&&void 0!==t?t:this.tree.getSelection()[0];i&&e&&this.tree.reveal(i,.5),this.tree.domFocus()}else this.tree&&this.treeContainer&&!this.treeContainer.classList.contains("hide")?this.tree.domFocus():this.domNode.focus()}show(e){this._container=e,(0,Rt.dx)(e,this.domNode)}create(){this.domNode=(0,Rt.Zb)(".tree-explorer-viewlet-tree-view"),this.messageElement=(0,Rt.dx)(this.domNode,(0,Rt.Zb)(".message")),this.updateMessage(),this.treeContainer=(0,Rt.dx)(this.domNode,(0,Rt.Zb)(".customview-tree")),this.treeContainer.classList.add("file-icon-themable-tree","show-file-icons");let e=this._register((0,Rt.AS)(this.domNode));this._register(e.onDidFocus(()=>this.focused=!0)),this._register(e.onDidBlur(()=>this.focused=!1))}createTree(){this.treeDisposables.clear();let e=Rt.Wr.bind(void 0,this.instantiationService),t=this.treeDisposables.add(this.instantiationService.createInstance(Jh,this.id));this.treeLabels=this.treeDisposables.add(this.instantiationService.createInstance(Wt.at,this));let i=this.instantiationService.createInstance(Gh,this,e=>this.progressService.withProgress({location:this.id},()=>e)),o=this.treeDisposables.add(new Nh(this.themeService,this.logService)),s=this.treeDisposables.add(new Sh),r=this.treeDisposables.add(this.instantiationService.createInstance(Zh,this.id,t,this.treeLabels,e,o,s,()=>this.manuallyManageCheckboxes));this.treeDisposables.add(r.onDidChangeCheckboxState(e=>this._onDidChangeCheckboxState.fire(e)));let n=this._title;this.tree=this.treeDisposables.add(this.instantiationService.createInstance(Rh,this.id,this.treeContainer,new Wh,[r],i,{identityProvider:new Lh,accessibilityProvider:{getAriaLabel(e){if(e.accessibilityInformation)return e.accessibilityInformation.label;if((0,Rt.uM)(e.tooltip))return e.tooltip;{if(e.resourceUri&&!e.label)return null;let t="";if(e.label){t+=((0,Rt.Rc)(e.label.label)?e.label.label.value:e.label.label)+" "}return e.description&&(t+=e.description),t}},getRole(e){var t,i;return null!==(t=null===(i=e.accessibilityInformation)||void 0===i?void 0:i.role)&&void 0!==t?t:"treeitem"},getWidgetAriaLabel:()=>n},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.label?(0,Rt.Rc)(e.label.label)?e.label.label.value:e.label.label:e.resourceUri?(0,Rt.Xw)(Rt.wD.revive(e.resourceUri)):void 0},expandOnlyOnTwistieClick:e=>!!e.command||!!e.checkbox||"doubleClick"===this.configurationService.getValue("workbench.tree.expandMode"),collapseByDefault:e=>e.collapsibleState!==Wt.yf.Expanded,multipleSelectionSupport:this.canSelectMany,dnd:this.treeViewDnd,overrideStyles:(0,Wt.Z)(this.viewLocation).listOverrideStyles})),this.treeDisposables.add(r.onDidChangeMenuContext(e=>e.forEach(e=>{var t;return null===(t=this.tree)||void 0===t?void 0:t.rerender(e)}))),this.treeDisposables.add(this.tree),t.setContextKeyService(this.tree.contextKeyService),o.tree=this.tree;let a=this.treeDisposables.add(new Ph(this.notificationService,()=>this.tree.getSelection()));r.actionRunner=a,this.tree.contextKeyService.createKey(this.id,!0),Vh.bindTo(this.tree.contextKeyService).set(!0),this.treeDisposables.add(this.tree.onContextMenu(e=>this.onContextMenu(t,e,a))),this.treeDisposables.add(this.tree.onDidChangeSelection(e=>{var t,i;this.lastSelection=e.elements,this.lastActive=null!==(t=null===(i=this.tree)||void 0===i?void 0:i.getFocus()[0])&&void 0!==t?t:this.lastActive,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive})})),this.treeDisposables.add(this.tree.onDidChangeFocus(e=>{var t,i;e.elements.length&&e.elements[0]!==this.lastActive&&(this.lastActive=e.elements[0],this.lastSelection=null!==(t=null===(i=this.tree)||void 0===i?void 0:i.getSelection())&&void 0!==t?t:this.lastSelection,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive}))})),this.treeDisposables.add(this.tree.onDidChangeCollapseState(e=>{if(!e.node.element)return;let t=Array.isArray(e.node.element.element)?e.node.element.element[0]:e.node.element.element;e.node.collapsed?this._onDidCollapseItem.fire(t):this._onDidExpandItem.fire(t)})),this.tree.setInput(this.root).then(()=>this.updateContentAreas()),this.treeDisposables.add(this.tree.onDidOpen(async e=>{if(!e.browserEvent||e.browserEvent.target&&e.browserEvent.target.classList.contains(Ih.checkboxClass))return;let t=this.tree.getSelection(),i=await this.resolveCommand(1===t.length?t[0]:void 0);if(i&&Ah(i,this.contextKeyService)){let t=i.arguments||[];("_workbench.open"===i.id||"_workbench.diff"===i.id)&&(t=[...t,e]);try{await this.commandService.executeCommand(i.id,...t)}catch(e){this.notificationService.error(e)}}})),this.treeDisposables.add(t.onDidChange(e=>{var t,i;(null===(t=this.tree)||void 0===t?void 0:t.hasNode(e))&&(null===(i=this.tree)||void 0===i||i.rerender(e))}))}async resolveCommand(e){let t=null===e||void 0===e?void 0:e.command;return e&&!t&&e instanceof Wt.vf&&e.hasResolve&&(await e.resolve(Rt.Ik.None),t=e.command),t}onContextMenu(e,t,i){this.hoverService.hideHover();let o=t.element;if(null===o)return;let s=t.browserEvent;s.preventDefault(),s.stopPropagation(),this.tree.setFocus([o]);let r=this.canSelectMany?this.getSelection():[];r.find(e=>e.handle===o.handle)||(r=[o]);let n=e.getResourceContextActions(r);n.length&&this.contextMenuService.showContextMenu({getAnchor:()=>t.anchor,getActions:()=>n,getActionViewItem:e=>{let t=this.keybindingService.lookupKeybinding(e.id);if(t)return new Rt.Bi(e,e,{label:!0,keybinding:t.getLabel()})},onHide:e=>{e&&this.tree.domFocus()},getActionsContext:()=>({$treeViewId:this.id,$treeItemHandle:o.handle}),actionRunner:i})}updateMessage(){this._message?this.showMessage(this._message):this.dataProvider?this.hideMessage():this.showMessage(xh),this.updateContentAreas()}processMessage(e,t){let i=e.value.split("\n"),o=[],s=!1;for(let n of i){let i=(0,Rt.ur)(n);if(1===i.nodes.length&&"string"!=typeof i.nodes[0]){let e=i.nodes[0],r=(0,Rt.gx)("div");r.classList.add("button-container");let n=new Rt.qn(r,(0,xt.A)({title:e.title,secondary:s,supportIcons:!0},Rt.xi));n.label=e.label,n.onDidClick(t=>{this.openerService.open(e.href,{allowCommands:!0})},null,t);let a=Rt.wD.parse(e.href);if(a.scheme===Rt.vT.command){let e=Eh(a.path);e&&(n.enabled=this.contextKeyService.contextMatchesRules(e),t.add(this.contextKeyService.onDidChangeContext(t=>{t.affectsSome(new Set(e.keys()))&&(n.enabled=this.contextKeyService.contextMatchesRules(e))})))}t.add(n),s=!0,o.push(r)}else{s=!1;let i=this.markdownRendererService.render(new Rt.Pc(n,{isTrusted:e.isTrusted,supportThemeIcons:e.supportThemeIcons,supportHtml:e.supportHtml}));o.push(i.element),t.add(i)}}let r=(0,Rt.gx)("div");r.classList.add("rendered-message");for(let n of o)(0,Rt.iS)(n)?r.appendChild(n):r.appendChild(n.element);return r}showMessage(e){if(Dh(this._messageValue)&&this._messageValue.disposables.dispose(),(0,Rt.Rc)(e)){let t=new Rt.EA;this._messageValue={element:this.processMessage(e,t),disposables:t}}else this._messageValue=e;this.messageElement&&(this.messageElement.classList.remove("hide"),this.resetMessageElement(),"string"!=typeof this._messageValue||(0,Rt.lk)(this._messageValue)?Dh(this._messageValue)&&this.messageElement.appendChild(this._messageValue.element):this.messageElement.textContent=this._messageValue,this.layout(this._height,this._width))}hideMessage(){var e;this.resetMessageElement(),null!==(e=this.messageElement)&&void 0!==e&&e.classList.add("hide"),this.layout(this._height,this._width)}resetMessageElement(){this.messageElement&&(0,Rt.fx)(this.messageElement)}layout(e,t){if(e&&t&&this.messageElement&&this.treeContainer){var i;this._height=e,this._width=t;let o=e-(0,Rt.Rx)(this.messageElement);this.treeContainer.style.height=o+"px",null===(i=this.tree)||void 0===i||i.layout(o,t)}}getOptimalWidth(){if(this.tree){let e=this.tree.getHTMLElement();return(0,Rt.Px)(e,[].slice.call(e.querySelectorAll(".outline-item-label > a")))}return 0}updateCheckboxes(e){return Kh(e)}async refresh(e,t){if(this.dataProvider&&this.tree){this.refreshing&&await Rt.dA.toPromise(this._onDidCompleteRefresh.event),e||(e=[this.root],this.elementsToRefresh=[]);for(let t of e)t.children=void 0;if(this.isVisible){let i=this.updateCheckboxes(null!==t&&void 0!==t?t:[]);return this.doRefresh(e.concat(i))}if(this.elementsToRefresh.length){let t=new Set;this.elementsToRefresh.forEach(e=>t.add(e.handle));for(let i of e)t.has(i.handle)||this.elementsToRefresh.push(i)}else this.elementsToRefresh.push(...e)}}async expand(e){let t=this.tree;if(t)try{e=Array.isArray(e)?e:[e];for(let i of e)await t.expand(i,!1)}catch(i){}}isCollapsed(e){var t;return!(null===(t=this.tree)||void 0===t||!t.isCollapsed(e))}setSelection(e){var t;null===(t=this.tree)||void 0===t||t.setSelection(e)}getSelection(){var e,t;return null!==(e=null===(t=this.tree)||void 0===t?void 0:t.getSelection())&&void 0!==e?e:[]}setFocus(e){this.tree&&(e?(this.focus(!0,e),this.tree.setFocus([e])):0===this.tree.getFocus().length&&this.tree.setFocus([]))}async reveal(e){if(this.tree)return this.tree.reveal(e)}async doRefresh(e){let t=this.tree;if(t&&this.visible){this.refreshing=!0;let i=t.getSelection();try{await Promise.all(e.map(e=>t.updateChildren(e,!0,!0)))}catch(e){this.logService.error(e)}let o=t.getSelection();(i.length!==o.length||i.some((e,t)=>e.handle!==o[t].handle))&&(this.lastSelection=o,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive})),this.refreshing=!1,this._onDidCompleteRefresh.fire(),this.updateContentAreas(),this.focused&&this.focus(!1),this.updateCollapseAllToggle()}}initializeCollapseAllToggle(){this.collapseAllToggleContext||(this.collapseAllToggleContext=(this.collapseAllToggleContextKey=new Rt.FO("treeView.".concat(this.id,".toggleCollapseAll"),!1,(0,Rt.Ij)(3695,"Whether collapse all is toggled for the tree view with id {0}.",this.id)),this.collapseAllToggleContextKey.bindTo(this.contextKeyService)))}updateCollapseAllToggle(){var e;this.showCollapseAllAction&&(this.initializeCollapseAllToggle(),null===(e=this.collapseAllToggleContext)||void 0===e||e.set(!!this.root.children&&this.root.children.length>0&&this.root.children.some(e=>e.collapsibleState!==Wt.yf.None)))}updateContentAreas(){let e=!this.root.children||0===this.root.children.length;this._messageValue&&e&&!this.refreshing&&this.treeContainer?(this.dragAndDropController||this.treeContainer.classList.add("hide"),this.domNode.setAttribute("tabindex","0")):this.treeContainer&&(this.treeContainer.classList.remove("hide"),this.domNode===(0,Rt.Tx)()&&this.focus(),this.domNode.removeAttribute("tabindex"))}get container(){return this._container}};Th=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Qd),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Rt.Cb),(0,Rt.Fb)(5,Rt.o_),(0,Rt.Fb)(6,Rt.qa),(0,Rt.Fb)(7,Rt.Sl),(0,Rt.Fb)(8,Rt.kd),(0,Rt.Fb)(9,Rt.Ld),(0,Rt.Fb)(10,Wt.dx),(0,Rt.Fb)(11,Rt.sr),(0,Rt.Fb)(12,Rt.yb),(0,Rt.Fb)(13,Tt.Rn),(0,Rt.Fb)(14,Rt.eb),(0,Rt.Fb)(15,Rt.yr),(0,Rt.Fb)(16,Rt.ul)],Th);var Lh=class{getId(e){return e.handle}},Wh=class{getHeight(e){return Zh.ITEM_HEIGHT}getTemplateId(e){return Zh.TREE_TEMPLATE_ID}};async function Fh(e,t){return e.getChildrenBatch?e.getChildrenBatch(t):t?Promise.all(t.map(t=>e.getChildren(t).then(e=>null!==e&&void 0!==e?e:[]))):[await e.getChildren()].filter(e=>void 0!==e)}var Gh=class{constructor(e,t){this.treeView=e,this.withProgress=t}hasChildren(e){return!!this.treeView.dataProvider&&e.collapsibleState!==Wt.yf.None}async getChildren(e){let t=this.treeView.dataProvider;if(!t)return[];void 0===this.batch?(this.batch=[e],this.batchPromise=void 0):this.batch.push(e);let i=this.batch.length-1;return new Promise((e,o)=>{setTimeout(async()=>{let s=this.batch;this.batch=void 0,this.batchPromise||(this.batchPromise=this.withProgress(Fh(t,s)));try{let t=await this.batchPromise;e(t&&i<t.length?t[i]:[])}catch(e){e.message.startsWith("Bad progress location:")||o(e)}},0)})}},Zh=(fe=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u){super(),this.treeViewId=e,this.menus=t,this.labels=i,this.actionViewItemProvider=o,this.aligner=s,this.checkboxStateHandler=r,this.manuallyManageCheckboxes=n,this.themeService=a,this.configurationService=d,this.labelService=l,this.contextKeyService=c,this.hoverService=h,this._onDidChangeCheckboxState=this._register(new Rt.uA),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeMenuContext=this._register(new Rt.uA),this.onDidChangeMenuContext=this._onDidChangeMenuContext.event,this._hasCheckbox=!1,this._renderedElements=new Map,this._hoverDelegate=this._register(u.createInstance(Rt.ir,"mouse",void 0,{})),this._register(this.themeService.onDidFileIconThemeChange(()=>this.rerender())),this._register(this.themeService.onDidColorThemeChange(()=>this.rerender())),this._register(r.onDidChangeCheckboxState(e=>{this.updateCheckboxes(e)})),this._register(this.contextKeyService.onDidChangeContext(e=>this.onDidChangeContext(e)))}get templateId(){return fh.TREE_TEMPLATE_ID}set actionRunner(e){this._actionRunner=e}renderTemplate(e){e.classList.add("custom-view-tree-node-item");let t=(0,Rt.dx)(e,(0,Rt.Zb)("")),i=this.labels.create(e,{supportHighlights:!0,hoverDelegate:this._hoverDelegate});return{resourceLabel:i,icon:(0,Rt.gS)(i.element,(0,Rt.Zb)(".custom-view-tree-node-item-icon")),checkboxContainer:t,actionBar:new Rt.Lr((0,Rt.dx)(i.element,(0,Rt.Zb)(".actions")),{actionViewItemProvider:this.actionViewItemProvider}),container:e}}getHover(e,t,i){return i instanceof Wt.vf&&i.hasResolve?{markdown:"string"==typeof i.tooltip?i.tooltip:e=>new Promise(t=>{i.resolve(e).then(()=>t(i.tooltip))}),markdownNotSupportedFallback:t?void 0:e?(0,Rt.Rc)(e)?e.value:e:""}:t&&!i.tooltip?void 0:void 0===i.tooltip?(0,Rt.Rc)(e)?{markdown:e,markdownNotSupportedFallback:e.value}:e:(0,Rt.uM)(i.tooltip)?""===i.tooltip?void 0:i.tooltip:{markdown:i.tooltip,markdownNotSupportedFallback:t?void 0:(0,Rt.qi)(i.tooltip)}}processLabel(e,t){if(!(0,Rt.Rc)(e))return{label:e};let i=e.value.trim(),o=!1,s=!1,r=!1;function n(e){if(t)for(let i of t)i.start-=e,i.end-=e}let a=[{open:"~~",close:"~~",mark:()=>{r=!0}},{open:"**",close:"**",mark:()=>{o=!0}},{open:"*",close:"*",mark:()=>{s=!0}},{open:"_",close:"_",mark:()=>{s=!0}}];function d(){let e=!1;for(let o of a)if(i.startsWith(o.open)&&i.endsWith(o.close)){if(null!==t&&void 0!==t&&t.some(e=>e.start<o.open.length||e.end>i.length-o.close.length))return!1;o.mark(),i=i.substring(o.open.length,i.length-o.close.length),n(o.open.length),e=!0}return e}for(let l=0;l<10&&d();l++);return{label:i,bold:o,italic:s,strikethrough:r,supportIcons:e.supportThemeIcons}}renderElement(e,t,i){var o;let s=e.element,r=s.resourceUri?Rt.wD.revive(s.resourceUri):null,n=s.label?s.label:r?{label:(0,Rt.Xw)(r)}:void 0,a=(0,Rt.uM)(s.description)?s.description:r&&!0===s.description?this.labelService.getUriLabel((0,Rt.Qw)(r),{relative:!0}):void 0,d=n?(0,Rt.Rc)(n.label)?n.label.value:n.label:void 0,l=null!==n&&void 0!==n&&n.highlights&&d?n.highlights.map(e=>{let[t,i]=e;if(t<0&&(t=d.length+t),i<0&&(i=d.length+i),t>=d.length||i>d.length)return{start:0,end:0};if(t>i){let e=t;t=i,i=e}return{start:t,end:i}}):void 0,{label:c,bold:h,italic:u,strikethrough:g,supportIcons:p}=this.processLabel(null===n||void 0===n?void 0:n.label,l),b=(0,Rt.Tm)(this.themeService.getColorTheme().type)?s.iconDark:s.icon,m=b?Rt.wD.revive(b):void 0,v=this.getHover(null===n||void 0===n?void 0:n.label,r,s);i.actionBar.clear(),i.icon.style.color="";let C=!0;if(s.command&&(C=Ah(s.command,this.contextKeyService)),this.renderCheckbox(s,i),r){let t=this.configurationService.getValue("explorer.decorations"),o=r||Rt.wD.parse("missing:_icon_resource");i.resourceLabel.setResource({name:c,description:a,resource:o},{fileKind:this.getFileKind(s),title:v,hideIcon:this.shouldHideResourceLabelIcon(m,s.themeIcon),fileDecorations:t,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:l||(0,Rt.Yc)(e.filterData),bold:h,italic:u,strikethrough:g,disabledCommand:!C,labelEscapeNewLines:!0,forceLabel:!!s.label,supportIcons:p})}else i.resourceLabel.setResource({name:c,description:a},{title:v,hideIcon:!0,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:l||(0,Rt.Yc)(e.filterData),bold:h,italic:u,strikethrough:g,disabledCommand:!C,labelEscapeNewLines:!0,supportIcons:p});if(m)i.icon.className="custom-view-tree-node-item-icon",i.icon.style.backgroundImage=(0,Rt.Gl)(m);else{var w,y;let e;this.shouldShowThemeIcon(!!r,s.themeIcon)&&(e=Rt.Eb.asClassName(s.themeIcon),s.themeIcon.color&&(i.icon.style.color=null!==(w=null===(y=this.themeService.getColorTheme().getColor(s.themeIcon.color.id))||void 0===y?void 0:y.toString())&&void 0!==w?w:"")),i.icon.className=e?"custom-view-tree-node-item-icon ".concat(e):"",i.icon.style.backgroundImage=""}C||(i.icon.className=i.icon.className+" disabled",i.container.parentElement&&(i.container.parentElement.className=i.container.parentElement.className+" disabled")),i.actionBar.context={$treeViewId:this.treeViewId,$treeItemHandle:s.handle};let f=this.menus.getResourceActions([s]);i.actionBar.push(f,{icon:!0,label:!1}),this._actionRunner&&(i.actionBar.actionRunner=this._actionRunner),this.setAlignment(i.container,s);let S=null!==(o=this._renderedElements.get(e.element.handle))&&void 0!==o?o:[];this._renderedElements.set(e.element.handle,[...S,{original:e,rendered:i}])}rerender(){let e=new Set(this._renderedElements.keys());for(let i of e){var t;let e=null!==(t=this._renderedElements.get(i))&&void 0!==t?t:[];for(let t of e)this.disposeElement(t.original,0,t.rendered),this.renderElement(t.original,0,t.rendered)}}renderCheckbox(e,t){e.checkbox?(this._hasCheckbox||(this._hasCheckbox=!0,this.rerender()),t.checkbox||(t.checkbox=new Ih(t.checkboxContainer,this.checkboxStateHandler,this._hoverDelegate,this.hoverService)),t.checkbox.render(e)):t.checkbox&&(t.checkbox=void t.checkbox.dispose())}setAlignment(e,t){e.parentElement.classList.toggle("align-icon-with-twisty",this.aligner.alignIconWithTwisty(t))}shouldHideResourceLabelIcon(e,t){return!!e||!!t&&!this.isFileKindThemeIcon(t)}shouldShowThemeIcon(e,t){return!!t&&!(e&&this.isFileKindThemeIcon(t))}isFileKindThemeIcon(e){return Rt.Eb.isFile(e)||Rt.Eb.isFolder(e)}getFileKind(e){if(e.themeIcon)switch(e.themeIcon.id){case Rt.sp.id:return Rt.Ms.FILE;case Rt.cp.id:return Rt.Ms.FOLDER}return e.collapsibleState===Wt.yf.Collapsed||e.collapsibleState===Wt.yf.Expanded?Rt.Ms.FOLDER:Rt.Ms.FILE}onDidChangeContext(e){let t=e.affectsSome(this.menus.getEntireMenuContexts()),i=[];for(let[o,s]of this._renderedElements)for(let r of s)(t||e.affectsSome(this.menus.getElementOverlayContexts(r.original.element)))&&i.push(r.original.element);i.length&&this._onDidChangeMenuContext.fire(i)}updateCheckboxes(e){let t=[];t=this.manuallyManageCheckboxes()?e:Kh(e),t.forEach(e=>{let t=this._renderedElements.get(e.handle);t&&t.forEach(t=>{var i;return null===(i=t.rendered.checkbox)||void 0===i?void 0:i.render(e)})}),this._onDidChangeCheckboxState.fire(t)}disposeElement(e,t,i){var o,s;let r=null!==(o=this._renderedElements.get(e.element.handle))&&void 0!==o?o:[],n=r.findIndex(e=>i===e.rendered);1===r.length?this._renderedElements.delete(e.element.handle):r.length>0&&r.splice(n,1),null!==(s=i.checkbox)&&void 0!==s&&s.dispose(),i.checkbox=void 0}disposeTemplate(e){e.resourceLabel.dispose(),e.actionBar.dispose()}},{_:fh=fe},{_:fe.ITEM_HEIGHT=22},{_:fe.TREE_TEMPLATE_ID="treeExplorer"},fe);Zh=fh=(0,Rt.Pb)([(0,Rt.Fb)(7,Rt.Qd),(0,Rt.Fb)(8,Rt.o_),(0,Rt.Fb)(9,Rt.Ya),(0,Rt.Fb)(10,Rt.yb),(0,Rt.Fb)(11,Rt.sr),(0,Rt.Fb)(12,Rt.Ub)],Zh);var Nh=class extends Rt.CA{constructor(e,t){super(),this.themeService=e,this.logService=t}set tree(e){this._tree=e}alignIconWithTwisty(e){if(e.collapsibleState!==Wt.yf.None||!this.hasIconOrCheckbox(e))return!1;if(this._tree){let i,o=this._tree.getInput();try{i=this._tree.getParentElement(e)||o}catch(t){return this.logService.error("[TreeView] Failed to resolve parent for ".concat(e.handle),t),!1}return this.hasIconOrCheckbox(i)?!!i.children&&i.children.some(e=>e.collapsibleState!==Wt.yf.None&&!this.hasIconOrCheckbox(e)):!!i.children&&i.children.every(e=>e.collapsibleState===Wt.yf.None||!this.hasIconOrCheckbox(e))}return!1}hasIconOrCheckbox(e){return this.hasIcon(e)||!!e.checkbox}hasIcon(e){if((0,Rt.Tm)(this.themeService.getColorTheme().type)?e.iconDark:e.icon)return!0;if(e.resourceUri||e.themeIcon){let t=this.themeService.getFileIconTheme();return(e.themeIcon?e.themeIcon.id===Rt.cp.id:e.collapsibleState!==Wt.yf.None)?t.hasFileIcons&&t.hasFolderIcons:t.hasFileIcons}return!1}},Ph=class extends Rt.kb{constructor(e,t){super(),this.getSelectedResources=t,this._register(this.onDidRun(t=>{t.error&&!(0,Rt.SN)(t.error)&&e.error((0,Rt.Ij)(3696,"Error running command {1}: {0}. This is likely caused by the extension that contributes {1}.",t.error.message,t.action.id))}))}async runAction(e,t){let i,o=this.getSelectedResources(),s=!1;o.length>1&&(i=o.map(e=>((e.handle===t.$treeItemHandle||t.$selectedTreeItems)&&(s=!0),{$treeViewId:t.$treeViewId,$treeItemHandle:e.handle}))),!s&&i&&(i=void 0),await e.run(t,i)}},Jh=class{constructor(e,t){this.id=e,this.menuService=t,this._onDidChange=new Rt.uA,this.onDidChange=this._onDidChange.event}getResourceActions(e){return this.getActions(this.getMenuId(),e).primary}getResourceContextActions(e){return this.getActions(this.getMenuId(),e).secondary}setContextKeyService(e){this.contextKeyService=e}filterNonUniversalActions(e,t){let i=new Set(t.map(e=>e.id));for(let o of e){let e=o.keys();for(let t of e)i.has(t)||o.delete(t)}}buildMenu(e){let t=[];for(let i of e)i.size>0&&(t.length&&t.push(new Rt.Ab),t.push(...i.values()));return t}createGroups(e){let t=[],i=new Map;for(let o of e)o instanceof Rt.Ab?(t.push(i),i=new Map):i.set(o.id,o);return t.push(i),t}getElementOverlayContexts(e){return new Map([["view",this.id],["viewItem",e.contextValue]])}getEntireMenuContexts(){return this.menuService.getMenuContexts(this.getMenuId())}getMenuId(){return Rt.sb.ViewItemContext}getActions(e,t){if(!this.contextKeyService)return{primary:[],secondary:[]};let i=[],o=[];for(let s=0;s<t.length;s++){let r=t[s],n=this.contextKeyService.createOverlay(this.getElementOverlayContexts(r)),a=(0,Rt.qr)(this.menuService.getMenuActions(e,n,{shouldForwardArgs:!0}),"inline");0===s?(i=this.createGroups(a.primary),o=this.createGroups(a.secondary)):(this.filterNonUniversalActions(i,a.primary),this.filterNonUniversalActions(o,a.secondary))}return{primary:this.buildMenu(i),secondary:this.buildMenu(o)}}dispose(){this.contextKeyService=void 0}};Jh=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Zr)],Jh);var Bh=class extends Th{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C,w){super(e,t,o,s,r,n,a,d,l,c,h,g,u,b,v,C,w),this.extensionId=i,this.extensionService=p,this.telemetryService=m}activate(){this.activated||(this.activated=(this.telemetryService.publicLog2("Extension:ViewActivate",{extensionId:new Ot.Q(this.extensionId),id:this.id}),this.createTree(),this.progressService.withProgress({location:this.id},()=>this.extensionService.activateByEvent("onView:".concat(this.id))).then(()=>(0,Rt.Gw)(2e3)).then(()=>{this.updateMessage()}),!0))}};Bh=(0,Rt.Pb)([(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.Cb),(0,Rt.Fb)(6,Rt.o_),(0,Rt.Fb)(7,Rt.qa),(0,Rt.Fb)(8,Rt.Sl),(0,Rt.Fb)(9,Rt.kd),(0,Rt.Fb)(10,Rt.Ld),(0,Rt.Fb)(11,Wt.dx),(0,Rt.Fb)(12,Rt.yb),(0,Rt.Fb)(13,Rt.sr),(0,Rt.Fb)(14,Nt.Dt),(0,Rt.Fb)(15,Tt.Rn),(0,Rt.Fb)(16,Rt.ib),(0,Rt.Fb)(17,Rt.eb),(0,Rt.Fb)(18,Rt.yr),(0,Rt.Fb)(19,Rt.ul)],Bh);var Oh=class{constructor(e,t,i,o,s){this.treeId=e,this.labelService=t,this.instantiationService=i,this.treeViewsDragAndDropService=o,this.logService=s,this.treeItemsTransfer=Wt.eh.getInstance(),this.treeMimeType="application/vnd.code.tree.".concat(e.toLowerCase())}set controller(e){this.dndController=e}handleDragAndLog(e,t,i,o){return e.handleDrag(t,i,o).then(t=>{if(t){let i=[];for(let o of t)o[0]!==this.treeMimeType&&e.dragMimeTypes.findIndex(e=>e===o[0])<0&&i.push(o[0]);i.length&&this.logService.warn("Drag and drop controller for tree ".concat(this.treeId," adds the following data transfer types but does not declare them in dragMimeTypes: ").concat(i.join(", ")))}return t})}addExtensionProvidedTransferTypes(e,t){var i;if(!e.dataTransfer||!this.dndController)return;let o=(0,Rt.mp)();this.dragCancellationToken=new Rt.Lk,this.treeViewsDragAndDropService.addDragOperationTransfer(o,this.handleDragAndLog(this.dndController,t,o,this.dragCancellationToken.token)),this.treeItemsTransfer.setData([new Wt.hm(o)],Wt.hm.prototype),e.dataTransfer.clearData(Rt.rv.text),this.dndController.dragMimeTypes.find(e=>e===Rt.rv.uriList)&&null!==(i=e.dataTransfer)&&void 0!==i&&i.setData(Rt.pa.RESOURCES,""),this.dndController.dragMimeTypes.forEach(t=>{var i;null===(i=e.dataTransfer)||void 0===i||i.setData(t,"")})}addResourceInfoToTransfer(e,t){if(t.length&&e.dataTransfer){this.instantiationService.invokeFunction(i=>(0,Wt.U)(i,t,e));let i=t.filter(e=>e.scheme===Rt.vT.file).map(e=>e.fsPath);i.length&&e.dataTransfer.setData(Wt.Qm.FILES,JSON.stringify(i))}}onDragStart(e,t){if(t.dataTransfer){let i=e.getData(),o=[],s={id:this.treeId,itemHandles:[]};i.forEach(e=>{s.itemHandles.push(e.handle),e.resourceUri&&o.push(Rt.wD.revive(e.resourceUri))}),this.addResourceInfoToTransfer(t,o),this.addExtensionProvidedTransferTypes(t,s.itemHandles),t.dataTransfer.setData(this.treeMimeType,JSON.stringify(s))}}debugLog(e){e.size?this.logService.debug("TreeView dragged mime types: ".concat(Array.from(e).join(", "))):this.logService.debug("TreeView dragged with no supported mime types.")}onDragOver(e,t,i,o,s){let r=(0,Wt.Zm)(s.dataTransfer),n=new Set(Array.from(r,e=>e[0]));if(s.dataTransfer)for(let d of s.dataTransfer.items)if("file"===d.kind||d.type===Rt.pa.RESOURCES.toLowerCase()){n.add(Rt.rv.uriList);break}this.debugLog(n);let a=this.dndController;return!(!a||!s.dataTransfer||0===a.dropMimeTypes.length)&&(!!Array.from(n).some((e,t)=>e===this.treeMimeType||a.dropMimeTypes.indexOf(e)>=0)&&{accept:!0,bubble:Rt.pn.Down,autoExpand:!0})}getDragURI(e){return this.dndController?e.resourceUri?Rt.wD.revive(e.resourceUri).toString():e.handle:null}getDragLabel(e){if(!this.dndController)return;if(e.length>1)return String(e.length);let t=e[0];return t.label?(0,Rt.Rc)(t.label.label)?t.label.label.value:t.label.label:t.resourceUri?this.labelService.getUriLabel(Rt.wD.revive(t.resourceUri)):void 0}async drop(e,t,i,o,s){var r,n;let a,d,l=this.dndController;if(!s.dataTransfer||!l)return;this.treeItemsTransfer.hasData(Wt.hm.prototype)&&(d=this.treeItemsTransfer.getData(Wt.hm.prototype)[0].identifier);let c=(0,Wt.Zm)(s.dataTransfer,!0),h=new Wt.oh;for(let[p,b]of c)if((p===this.treeMimeType||l.dropMimeTypes.includes(p)||b.asFile()&&l.dropMimeTypes.includes(Rt.pa.FILES.toLowerCase()))&&(h.append(p,b),p===this.treeMimeType))try{a=JSON.parse(await b.asString())}catch(g){}let u=await this.treeViewsDragAndDropService.removeDragOperationTransfer(d);if(u)for(let[p,b]of u)h.append(p,b);return l.handleDrop(h,t,Rt.Ik.None,d,null===(r=a)||void 0===r?void 0:r.id,null===(n=a)||void 0===n?void 0:n.itemHandles)}onDragEnd(e){var t,i;"none"===(null===(t=e.dataTransfer)||void 0===t?void 0:t.dropEffect)&&(null===(i=this.dragCancellationToken)||void 0===i||i.cancel())}dispose(){}};function Kh(e){let t=[];for(let i of e)if(void 0!==i.checkbox){let e=i=>{for(let s of null!==(o=i.children)&&void 0!==o?o:[]){var o;void 0!==s.checkbox&&void 0!==i.checkbox&&s.checkbox.isChecked!==i.checkbox.isChecked&&(s.checkbox.isChecked=i.checkbox.isChecked,t.push(s),e(s))}};e(i);let o=new Set,s=e=>{var i;if(void 0!==(null===(i=e.parent)||void 0===i?void 0:i.checkbox)&&e.parent.children){if(o.has(e.parent))return;o.add(e.parent);let i=!1,r=!1;for(let t of e.parent.children){if(i&&r)break;void 0!==t.checkbox&&(t.checkbox.isChecked?r=!0:i=!0)}r&&!i&&!0!==e.parent.checkbox.isChecked?(e.parent.checkbox.isChecked=!0,t.push(e.parent),s(e.parent)):i&&!1!==e.parent.checkbox.isChecked&&(e.parent.checkbox.isChecked=!1,t.push(e.parent),s(e.parent))}};s(i)}return e.concat(t)}Oh=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ya),(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Wt.oC),(0,Rt.Fb)(4,Rt.eb)],Oh);(0,Rt.Fj)(),(0,Rt.gD)(),(0,Rt.q)(),(0,Rt.J)("remote-explorer-get-started",Rt.mD.star,(0,Rt.Ij)(10268,"Getting started icon in the remote explorer view.")),(0,Rt.J)("remote-explorer-documentation",Rt.mD.book,(0,Rt.Ij)(10269,"Documentation icon in the remote explorer view.")),(0,Rt.J)("remote-explorer-feedback",Rt.mD.twitter,(0,Rt.Ij)(10270,"Feedback icon in the remote explorer view.")),(0,Rt.J)("remote-explorer-review-issues",Rt.mD.issues,(0,Rt.Ij)(10271,"Review issue icon in the remote explorer view.")),(0,Rt.J)("remote-explorer-report-issues",Rt.mD.comment,(0,Rt.Ij)(10272,"Report issue icon in the remote explorer view.")),(0,Rt.J)("remote-explorer-view-icon",Rt.mD.remoteExplorer,(0,Rt.Ij)(10273,"View icon of the remote explorer view."));var Mh=(0,Rt.J)("ports-view-icon",Rt.mD.plug,(0,Rt.Ij)(10274,"View icon of the remote ports view."));(0,Rt.J)("ports-view-icon",Rt.mD.plug,(0,Rt.Ij)(10275,"Icon representing a remote port."));var jh,Qh=(0,Rt.J)("private-ports-view-icon",Rt.mD.lock,(0,Rt.Ij)(10276,"Icon representing a private remote port.")),Yh=(0,Rt.J)("ports-forward-icon",Rt.mD.plus,(0,Rt.Ij)(10277,"Icon for the forward action.")),Hh=(0,Rt.J)("ports-stop-forward-icon",Rt.mD.x,(0,Rt.Ij)(10278,"Icon for the stop forwarding action.")),Xh=(0,Rt.J)("ports-open-browser-icon",Rt.mD.globe,(0,Rt.Ij)(10279,"Icon for the open browser action.")),Uh=(0,Rt.J)("ports-open-preview-icon",Rt.mD.openPreview,(0,Rt.Ij)(10280,"Icon for the open preview action.")),zh=(0,Rt.J)("ports-copy-address-icon",Rt.mD.clippy,(0,Rt.Ij)(10281,"Icon for the copy local address action.")),qh=(0,Rt.J)("ports-label-icon",Rt.mD.tag,(0,Rt.Ij)(10282,"Icon for the label port action.")),$h=(0,Rt.J)("ports-forwarded-without-process-icon",Rt.mD.circleOutline,(0,Rt.Ij)(10283,"Icon for forwarded ports that don't have a running process.")),eu=(0,Rt.J)("ports-forwarded-with-process-icon",Rt.mD.circleFilled,(0,Rt.Ij)(10284,"Icon for forwarded ports that do have a running process."));(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.qx)(),(0,Wt.fx)(),(0,Wt.E_)(),(0,Rt.Ad)(),(0,Rt.wl)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Rt.Q_)(),(0,Rt.s_)(),(0,Rt.Kb)(),(0,Rt.br)(),(0,Rt.Sc)(),(0,Rt.Sb)(),(0,Rt.wb)(),(0,Rt.gA)(),(0,Pt.k)(),(0,Rt.PA)(),(0,Rt.zr)(),(0,Rt.xn)(),(0,Rt.Mb)(),(0,Rt.db)(),(0,Rt.Qr)(),(0,Rt.Xr)(),(0,Wt.X_)(),(0,Wt.R_)(),(0,Rt.w)(),(0,Rt.Ud)(),(0,Rt.Rd)(),(0,Rt.jn)(),(0,Rt.tj)(),(0,Rt.tO)(),(0,Rt.$d)(),(0,Rt.Db)(),(0,Wt.Q)(),(0,Rt.TD)(),(0,Wt.uv)(),(0,Wt.Fx)(),(0,Rt.sm)(),(0,Rt.gb)(),(0,Rt.Hi)(),(0,Wt.Eb)(),(0,Rt.zk)(),(0,Rt.mj)(),(0,Rt.Ct)(),(0,Rt.Qn)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.Ic)(),(0,Lt.Xn)(),(0,Rt.gD)(),(0,Rt.Mi)(),(0,Wt.rv)(),(0,Rt.da)(),(0,Rt.cr)(),(0,Rt.qd)(),(0,Rt.mE)({});var tu=new Rt.FO("openPreviewEnabled",!1),iu=class{constructor(e){this.remoteExplorerService=e,this.headerRowHeight=22}getHeight(e){return e.tunnelType!==Wt.Y_.Add||this.remoteExplorerService.getEditableData(void 0)?22:30}},ou=class{constructor(e,t){this.remoteExplorerService=e,this.tunnelService=t,this._candidates=new Map,this.input={label:(0,Rt.Ij)(10314,"Add Port"),icon:void 0,tunnelType:Wt.Y_.Add,hasRunningProcess:!1,remoteHost:"",remotePort:0,processDescription:"",tooltipPostfix:"",iconTooltip:"",portTooltip:"",processTooltip:"",originTooltip:"",privacyTooltip:"",source:{source:Wt.ev.User,description:""},protocol:Wt.cv.Http,privacy:{id:Wt.sv.Private,themeIcon:Qh.id,label:(0,Rt.Ij)(10315,"Private")},strip:()=>{}},this.model=e.tunnelModel,this.onForwardedPortsChanged=Rt.dA.any(this.model.onForwardPort,this.model.onClosePort,this.model.onPortName,this.model.onCandidatesChanged)}get all(){let e=[];return this._candidates=new Map,this.model.candidates.forEach(e=>{this._candidates.set((0,Wt.iv)(e.host,e.port),e)}),(this.model.forwarded.size>0||this.remoteExplorerService.getEditableData(void 0))&&e.push(...this.forwarded),this.model.detected.size>0&&e.push(...this.detected),e.push(this.input),e}addProcessInfoFromCandidate(e){let t=(0,Wt.iv)(e.remoteHost,e.remotePort);this._candidates.has(t)&&(e.processDescription=this._candidates.get(t).detail)}get forwarded(){return Array.from(this.model.forwarded.values()).map(e=>{let t=uu.createFromTunnel(this.remoteExplorerService,this.tunnelService,e);return this.addProcessInfoFromCandidate(t),t}).sort((e,t)=>e.remotePort===t.remotePort?e.remoteHost<t.remoteHost?-1:1:e.remotePort<t.remotePort?-1:1)}get detected(){return Array.from(this.model.detected.values()).map(e=>{let t=uu.createFromTunnel(this.remoteExplorerService,this.tunnelService,e,Wt.Y_.Detected,!1);return this.addProcessInfoFromCandidate(t),t})}isEmpty(){return 0===this.detected.length&&(0===this.forwarded.length||1===this.forwarded.length&&this.forwarded[0].tunnelType===Wt.Y_.Add&&!this.remoteExplorerService.getEditableData(void 0))}};function su(e){return{label:"",tunnel:e,editId:Wt.J_.None,tooltip:""}}ou=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.L_),(0,Rt.Fb)(1,Wt.Px)],ou);var ru=class{constructor(){this.label="",this.tooltip="",this.weight=1,this.minimumWidth=40,this.maximumWidth=40,this.templateId="actionbar"}project(e){if(e.tunnelType===Wt.Y_.Add)return su(e);let t=e.processDescription?eu:$h,i="";return e instanceof uu&&(i="".concat(e.iconTooltip," ").concat(e.tooltipPostfix)),{label:"",icon:t,tunnel:e,editId:Wt.J_.None,tooltip:i}}},nu=class{constructor(){this.label=(0,Rt.Ij)(10316,"Port"),this.tooltip=(0,Rt.Ij)(10317,"The label and remote port number of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){let t=e.tunnelType===Wt.Y_.Add,i=e.label,o="";return o=e instanceof uu&&!t?"".concat(e.portTooltip," ").concat(e.tooltipPostfix):i,{label:i,tunnel:e,menuId:Rt.sb.TunnelPortInline,editId:e.tunnelType===Wt.Y_.Add?Wt.J_.New:Wt.J_.Label,tooltip:o}}},au=class e{constructor(){this.label=(0,Rt.Ij)(10318,"Forwarded Address"),this.tooltip=(0,Rt.Ij)(10319,"The address that the forwarded port is available at."),this.weight=1,this.templateId="actionbar"}project(t){var i;if(t.tunnelType===Wt.Y_.Add)return su(t);let o=null!==(i=t.localAddress)&&void 0!==i?i:"",s=o;return t instanceof uu&&(s=t.tooltipPostfix),{label:o,menuId:Rt.sb.TunnelLocalAddressInline,tunnel:t,editId:Wt.J_.LocalPort,tooltip:s,markdownTooltip:o?e.getHoverText(o):void 0}}static getHoverText(e){return function(t){let i="";i="ctrlCmd"===t.getValue("editor").multiCursorModifier?Rt.Cj?(0,Rt.Ij)(10320,"option + click"):(0,Rt.Ij)(10321,"alt + click"):Rt.Cj?(0,Rt.Ij)(10322,"cmd + click"):(0,Rt.Ij)(10323,"ctrl + click");let o=new Rt.Pc("",!0),s=e.startsWith("http")?e:"http://".concat(e);return o.appendLink(s,"Follow link").appendMarkdown(" (".concat(i,")"))}}},du=class{constructor(){this.label=(0,Rt.Ij)(10324,"Running Process"),this.tooltip=(0,Rt.Ij)(10325,"The command line of the process that is using the port."),this.weight=2,this.templateId="actionbar"}project(e){var t;return e.tunnelType===Wt.Y_.Add?su(e):{label:null!==(t=e.processDescription)&&void 0!==t?t:"",tunnel:e,editId:Wt.J_.None,tooltip:e instanceof uu?e.processTooltip:""}}},lu=class{constructor(){this.label=(0,Rt.Ij)(10326,"Origin"),this.tooltip=(0,Rt.Ij)(10327,"The source that a forwarded port originates from. Can be an extension, user forwarded, statically forwarded, or automatically forwarded."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===Wt.Y_.Add)return su(e);let t=e.source.description,i="".concat(e instanceof uu?e.originTooltip:"",". ").concat(e instanceof uu?e.tooltipPostfix:"");return{label:t,menuId:Rt.sb.TunnelOriginInline,tunnel:e,editId:Wt.J_.None,tooltip:i}}},cu=class{constructor(){this.label=(0,Rt.Ij)(10328,"Visibility"),this.tooltip=(0,Rt.Ij)(10329,"The availability of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){var t;if(e.tunnelType===Wt.Y_.Add)return su(e);let i=null===(t=e.privacy)||void 0===t?void 0:t.label,o="";return e instanceof uu&&(o="".concat(e.privacy.label," ").concat(e.tooltipPostfix)),{label:i,tunnel:e,icon:{id:e.privacy.themeIcon},editId:Wt.J_.None,tooltip:o}}},hu=class extends Rt.CA{constructor(e,t,i,o,s,r,n){super(),this.instantiationService=e,this.contextKeyService=t,this.menuService=i,this.contextViewService=o,this.remoteExplorerService=s,this.commandService=r,this.configurationService=n,this.templateId="actionbar",this._hoverDelegate=(0,Rt.ua)("mouse")}set actionRunner(e){this._actionRunner=e}renderTemplate(e){let t=(0,Rt.dx)(e,(0,Rt.Zb)(".ports-view-actionbar-cell")),i=(0,Rt.dx)(t,(0,Rt.Zb)(".ports-view-actionbar-cell-icon"));return{label:new Rt.bn(t,{supportHighlights:!0,hoverDelegate:this._hoverDelegate}),icon:i,actionBar:new Rt.Lr((0,Rt.dx)(t,(0,Rt.Zb)(".actions")),{actionViewItemProvider:Rt.Wr.bind(void 0,this.instantiationService),hoverDelegate:this._hoverDelegate}),container:t,elementDisposable:Rt.CA.None}}renderElement(e,t,i){let o;i.actionBar.clear(),i.icon.className="ports-view-actionbar-cell-icon",i.icon.style.display="none",i.label.setLabel(""),i.label.element.style.display="none",i.container.style.height="22px",i.button&&(i.button.element.style.display="none",i.button.dispose()),i.container.style.paddingLeft="0px",i.elementDisposable.dispose(),e.editId===Wt.J_.New&&(o=this.remoteExplorerService.getEditableData(void 0))?this.renderInputBox(i.container,o):(o=this.remoteExplorerService.getEditableData(e.tunnel,e.editId),o?this.renderInputBox(i.container,o):e.tunnel.tunnelType===Wt.Y_.Add&&e.menuId===Rt.sb.TunnelPortInline?this.renderButton(e,i):this.renderActionBarItem(e,i))}renderButton(e,t){t.container.style.paddingLeft="7px",t.container.style.height="28px",t.button=this._register(new Rt.qn(t.container,Rt.xi)),t.button.label=e.label,t.button.element.title=e.tooltip,this._register(t.button.onDidClick(()=>{this.commandService.executeCommand(xu.INLINE_ID)}))}tunnelContext(e){let t;return e instanceof uu&&(t=e.strip()),t||(t={tunnelType:e.tunnelType,remoteHost:e.remoteHost,remotePort:e.remotePort,localAddress:e.localAddress,protocol:e.protocol,localUri:e.localUri,localPort:e.localPort,name:e.name,closeable:e.closeable,source:e.source,privacy:e.privacy,processDescription:e.processDescription,label:e.label}),t}renderActionBarItem(e,t){t.label.element.style.display="flex",t.label.setLabel(e.label,void 0,{title:e.markdownTooltip?{markdown:e.markdownTooltip(this.configurationService),markdownNotSupportedFallback:e.tooltip}:e.tooltip,extraClasses:e.menuId===Rt.sb.TunnelLocalAddressInline?["ports-view-actionbar-cell-localaddress"]:void 0}),t.actionBar.context=this.tunnelContext(e.tunnel),t.container.style.paddingLeft="10px";let i=[["view",Wt.q_],[gu.key,e.tunnel.tunnelType],[pu.key,e.tunnel.closeable],[bu.key,e.tunnel.privacy.id],[vu.key,e.tunnel.protocol]],o=this.contextKeyService.createOverlay(i),s=new Rt.EA;if(t.elementDisposable=s,e.menuId){let i=(0,Rt.Jr)(s.add(this.menuService.createMenu(e.menuId,o)).getActions({shouldForwardArgs:!0}));if(i){let e=i.filter(e=>e.id.toLowerCase().indexOf("label")>=0);e.length>1&&(e.sort((e,t)=>e.label.length-t.label.length),e.pop(),i=i.filter(t=>e.indexOf(t)<0)),t.actionBar.push(i,{icon:!0,label:!1}),this._actionRunner&&(t.actionBar.actionRunner=this._actionRunner)}}e.icon&&(t.icon.className="ports-view-actionbar-cell-icon ".concat(Rt.Eb.asClassName(e.icon)),t.icon.title=e.tooltip,t.icon.style.display="inline")}renderInputBox(e,t){this.inputDone&&(this.inputDone=void this.inputDone(!1,!1)),e.style.paddingLeft="5px";let i=t.startingValue||"",o=new Rt.kn(e,this.contextViewService,{ariaLabel:(0,Rt.Ij)(10330,"Press Enter to confirm or Escape to cancel."),validationOptions:{validation:e=>{let i=t.validationMessage(e);return i?{content:i.content,formatContent:!0,type:i.severity===Rt.Kd.Error?Rt.An.ERROR:Rt.An.INFO}:null}},placeholder:t.placeholder||"",inputBoxStyles:Rt.Ti});o.value=i,o.focus(),o.select({start:0,end:t.startingValue?t.startingValue.length:0});let s=(0,Rt.ej)(async(e,i)=>{(0,Rt.MA)(r),this.inputDone&&(this.inputDone=void 0),o.element.style.display="none";let s=o.value;if(i)return t.onFinish(s,e)});this.inputDone=s;let r=[o,(0,Rt.lx)(o.inputElement,Rt.tx.KEY_DOWN,async e=>e.equals(Rt.YD.Enter)?(e.stopPropagation(),o.validate()===Rt.An.ERROR?s(!1,!0):s(!0,!0)):e.equals(Rt.YD.Escape)?(e.preventDefault(),e.stopPropagation(),s(!1,!0)):void 0),(0,Rt.ox)(o.inputElement,Rt.tx.BLUR,()=>s(o.validate()!==Rt.An.ERROR,!0))];return(0,Rt.zA)(()=>{s(!1,!1)})}disposeElement(e,t,i){i.elementDisposable.dispose()}disposeTemplate(e){var t;e.label.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose(),null===(t=e.button)||void 0===t||t.dispose()}};hu=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Rt.yb),(0,Rt.Fb)(2,Rt.Zr),(0,Rt.Fb)(3,Rt.Cl),(0,Rt.Fb)(4,Wt.L_),(0,Rt.Fb)(5,Rt.Cb),(0,Rt.Fb)(6,Rt.o_)],hu);var uu=class e{static createFromTunnel(t,i,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Wt.Y_.Forwarded,r=arguments.length>4?arguments[4]:void 0;return new e(s,o.remoteHost,o.remotePort,o.source,!!o.hasRunningProcess,o.protocol,o.localUri,o.localAddress,o.localPort,void 0===r?o.closeable:r,o.name,o.runningProcess,o.pid,o.privacy,t,i)}strip(){return new e(this.tunnelType,this.remoteHost,this.remotePort,this.source,this.hasRunningProcess,this.protocol,this.localUri,this.localAddress,this.localPort,this.closeable,this.name,this.runningProcess,this.pid,this._privacy)}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b){this.tunnelType=e,this.remoteHost=t,this.remotePort=i,this.source=o,this.hasRunningProcess=s,this.protocol=r,this.localUri=n,this.localAddress=a,this.localPort=d,this.closeable=l,this.name=c,this.runningProcess=h,this.pid=u,this._privacy=g,this.remoteExplorerService=p,this.tunnelService=b}get label(){if(this.tunnelType===Wt.Y_.Add&&this.name)return this.name;let e=(0,Wt.fv)(this.remoteHost)||(0,Wt.dv)(this.remoteHost)?"".concat(this.remotePort):"".concat(this.remoteHost,":").concat(this.remotePort);return this.name?"".concat(this.name," (").concat(e,")"):e}set processDescription(e){this.runningProcess=e}get processDescription(){var e;let t="";return this.runningProcess?(t=this.pid&&null!==(e=this.remoteExplorerService)&&void 0!==e&&e.namedProcesses.has(this.pid)?this.remoteExplorerService.namedProcesses.get(this.pid):this.runningProcess.replace(/\0/g," ").trim(),this.pid&&(t+=" (".concat(this.pid,")"))):this.hasRunningProcess&&(t=(0,Rt.Ij)(10331,"Process information unavailable")),t}get tooltipPostfix(){let e;return e=this.localAddress?(0,Rt.Ij)(10332,"Remote port {0}:{1} forwarded to local address {2}. ",this.remoteHost,this.remotePort,this.localAddress):(0,Rt.Ij)(10333,"Remote port {0}:{1} not forwarded. ",this.remoteHost,this.remotePort),e}get iconTooltip(){return this.tunnelType===Wt.Y_.Add?this.label:"".concat(this.processDescription?(0,Rt.Ij)(10334,"Port has running process."):(0,Rt.Ij)(10335,"No running process."))}get portTooltip(){return this.tunnelType===Wt.Y_.Add?"":"".concat(this.name?(0,Rt.Ij)(10336,"Port labeled {0}. ",this.name):"")}get processTooltip(){var e;return null!==(e=this.processDescription)&&void 0!==e?e:""}get originTooltip(){return this.source.description}get privacy(){var e,t,i;return null!==(e=this.tunnelService)&&void 0!==e&&e.privacyOptions?null!==(t=null===(i=this.tunnelService)||void 0===i?void 0:i.privacyOptions.find(e=>e.id===this._privacy))&&void 0!==t?t:{id:"",themeIcon:Rt.mD.question.id,label:(0,Rt.Ij)(10337,"Unknown")}:{id:Wt.sv.Private,themeIcon:Qh.id,label:(0,Rt.Ij)(10315,"Private")}}},gu=new Rt.FO("tunnelType",Wt.Y_.Add,!0),pu=new Rt.FO("tunnelCloseable",!1,!0),bu=new Rt.FO("tunnelPrivacy",void 0,!0),mu=new Rt.FO("tunnelPrivacyEnabled",!1,!0),vu=new Rt.FO("tunnelProtocol",Wt.cv.Http,!0),Cu=new Rt.FO("tunnelViewFocus",!1,(0,Rt.Ij)(10338,"Whether the Ports view has focus.")),wu="tunnelViewSelection",yu=new Rt.FO(wu,void 0,!0),fu="tunnelViewMultiSelection",Su=new Rt.FO(fu,void 0,!0),Iu=new Rt.FO("portChangable",!1,!0),ku=new Rt.FO("protocolChangable",!0,!0),_u=(Se=class extends Wt.Y{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super(t,i,o,r,s,a,n,d,u,p),this.viewModel=e,this.quickInputService=l,this.commandService=c,this.menuService=h,this.remoteExplorerService=g,this.tunnelService=b,this.contextViewService=m,this.tableDisposables=this._register(new Rt.EA),this.isEditing=!1,this.titleActions=[],this.lastFocus=[],this.height=0,this.width=0,this.tunnelTypeContext=gu.bindTo(s),this.tunnelCloseableContext=pu.bindTo(s),this.tunnelPrivacyContext=bu.bindTo(s),this.tunnelPrivacyEnabledContext=mu.bindTo(s),this.tunnelPrivacyEnabledContext.set(b.canChangePrivacy),this.protocolChangableContextKey=ku.bindTo(s),this.protocolChangableContextKey.set(b.canChangeProtocol),this.tunnelProtocolContext=vu.bindTo(s),this.tunnelViewFocusContext=Cu.bindTo(s),this.tunnelViewSelectionContext=yu.bindTo(s),this.tunnelViewMultiSelectionContext=Su.bindTo(s),this.portChangableContextKey=Iu.bindTo(s);let v=this.contextKeyService.createOverlay([["view",jh.ID]]),C=this._register(this.menuService.createMenu(Rt.sb.TunnelTitle,v)),w=()=>{this.titleActions=(0,Rt.Jr)(C.getActions()),this.updateActions()};this._register(C.onDidChange(w)),w(),this._register((0,Rt.zA)(()=>{this.titleActions=[]})),this.registerPrivacyActions(),this._register(Rt.dA.once(this.tunnelService.onAddedTunnelProvider)(()=>{var e;let t=!1;!1===this.tunnelPrivacyEnabledContext.get()&&(this.tunnelPrivacyEnabledContext.set(b.canChangePrivacy),t=!0),!0===this.protocolChangableContextKey.get()&&(this.protocolChangableContextKey.set(b.canChangeProtocol),t=!0),t&&(w(),this.registerPrivacyActions(),this.createTable(),null===(e=this.table)||void 0===e||e.layout(this.height,this.width))}))}registerPrivacyActions(){for(let e of this.tunnelService.privacyOptions){let t="remote.tunnel.privacy".concat(e.id);Rt.xb.registerCommand(t,Gu.handler(e.id)),Rt.lb.appendMenuItem(Rt.sb.TunnelPrivacy,{order:0,command:{id:t,title:e.label,toggled:bu.isEqualTo(e.id)}})}}get portCount(){return this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size}createTable(){if(!this.panelContainer)return;this.tableDisposables.clear(),(0,Rt.fx)(this.panelContainer);let e=(0,Rt.dx)(this.panelContainer,(0,Rt.Zb)(".customview-tree"));e.classList.add("ports-view"),e.classList.add("file-icon-themable-tree","show-file-icons");let t=new hu(this.instantiationService,this.contextKeyService,this.menuService,this.contextViewService,this.remoteExplorerService,this.commandService,this.configurationService),i=[new ru,new nu,new au,new du];this.tunnelService.canChangePrivacy&&i.push(new cu),i.push(new lu),this.table=this.instantiationService.createInstance(Rt.ht,"RemoteTunnels",e,new iu(this.remoteExplorerService),i,[t],{keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.label},multipleSelectionSupport:!0,accessibilityProvider:{getAriaLabel:e=>e instanceof uu?"".concat(e.tooltipPostfix," ").concat(e.portTooltip," ").concat(e.iconTooltip," ").concat(e.processTooltip," ").concat(e.originTooltip," ").concat(this.tunnelService.canChangePrivacy?e.privacy.label:""):e.label,getWidgetAriaLabel:()=>(0,Rt.Ij)(10340,"Tunnel View")},openOnSingleClick:!0});let o=this.tableDisposables.add(new Rt.kb);t.actionRunner=o,this.tableDisposables.add(this.table),this.tableDisposables.add(this.table.onContextMenu(e=>this.onContextMenu(e,o))),this.tableDisposables.add(this.table.onMouseDblClick(e=>this.onMouseDblClick(e))),this.tableDisposables.add(this.table.onDidChangeFocus(e=>this.onFocusChanged(e))),this.tableDisposables.add(this.table.onDidChangeSelection(e=>this.onSelectionChanged(e))),this.tableDisposables.add(this.table.onDidFocus(()=>this.tunnelViewFocusContext.set(!0))),this.tableDisposables.add(this.table.onDidBlur(()=>this.tunnelViewFocusContext.set(!1)));let s=()=>{var e;return null===(e=this.table)||void 0===e?void 0:e.splice(0,1/0,this.viewModel.all)};s();let r=this.portCount;this.tableDisposables.add(Rt.dA.debounce(this.viewModel.onForwardedPortsChanged,(e,t)=>t,50)(()=>{let e=this.portCount;(0===r||0===e)&&r!==e&&this._onDidChangeViewWelcomeState.fire(),r=e,s()})),this.tableDisposables.add(this.table.onMouseClick(e=>{if(this.hasOpenLinkModifier(e.browserEvent)&&this.table){let t=this.table.getSelectedElements();(0===t.length||1===t.length&&t[0]===e.element)&&this.commandService.executeCommand(Ru.ID,e.element)}})),this.tableDisposables.add(this.table.onDidOpen(e=>{var t;!e.element||e.element.tunnelType!==Wt.Y_.Forwarded||"dblclick"===(null===(t=e.browserEvent)||void 0===t?void 0:t.type)&&this.commandService.executeCommand(Eu.ID)})),this.tableDisposables.add(this.remoteExplorerService.onDidChangeEditable(t=>{var i,o;this.isEditing=!!this.remoteExplorerService.getEditableData(null===t||void 0===t?void 0:t.tunnel,null===t||void 0===t?void 0:t.editId),this._onDidChangeViewWelcomeState.fire(),this.isEditing||e.classList.remove("highlight"),s(),this.isEditing?(e.classList.add("highlight"),t||null===(i=this.table)||void 0===i||i.reveal(this.table.indexOf(this.viewModel.input))):(t&&t.tunnel.tunnelType!==Wt.Y_.Add&&null!==(o=this.table)&&void 0!==o&&o.setFocus(this.lastFocus),this.focus())}))}renderBody(e){super.renderBody(e),this.panelContainer=(0,Rt.dx)(e,(0,Rt.Zb)(".tree-explorer-viewlet-tree-view")),this.createTable()}shouldShowWelcome(){return this.viewModel.isEmpty()&&!this.isEditing}focus(){var e;super.focus(),null===(e=this.table)||void 0===e||e.domFocus()}onFocusChanged(e){e.indexes.length>0&&e.elements.length>0&&(this.lastFocus=[...e.indexes]);let t=e.elements,i=t&&t.length?t[0]:void 0;i?(this.tunnelViewSelectionContext.set((0,Wt.iv)(i.remoteHost,i.remotePort)),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set((i.protocol,Wt.cv.Https,Wt.cv.Https)),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.reset(),this.tunnelViewSelectionContext.reset(),this.tunnelCloseableContext.reset(),this.tunnelPrivacyContext.reset(),this.tunnelProtocolContext.reset(),this.portChangableContextKey.reset())}hasOpenLinkModifier(e){let t=!1;return t="ctrlCmd"===this.configurationService.getValue("editor").multiCursorModifier?e.altKey:Rt.Cj?e.metaKey:e.ctrlKey,t}onSelectionChanged(e){let t=e.elements;t.length>1?this.tunnelViewMultiSelectionContext.set(t.map(e=>(0,Wt.iv)(e.remoteHost,e.remotePort))):this.tunnelViewMultiSelectionContext.set(void 0)}onContextMenu(e,t){var i,o;if(void 0!==e.element&&!(e.element instanceof uu))return;e.browserEvent.preventDefault(),e.browserEvent.stopPropagation();let s=e.element;s?(null!==(i=this.table)&&void 0!==i&&i.setFocus([this.table.indexOf(s)]),this.tunnelTypeContext.set(s.tunnelType),this.tunnelCloseableContext.set(!!s.closeable),this.tunnelPrivacyContext.set(s.privacy.id),this.tunnelProtocolContext.set(s.protocol),this.portChangableContextKey.set(!!s.localPort)):(this.tunnelTypeContext.set(Wt.Y_.Add),this.tunnelCloseableContext.set(!1),this.tunnelPrivacyContext.set(void 0),this.tunnelProtocolContext.set(void 0),this.portChangableContextKey.set(!1)),this.contextMenuService.showContextMenu({menuId:Rt.sb.TunnelContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:null===(o=this.table)||void 0===o?void 0:o.contextKeyService,getAnchor:()=>e.anchor,getActionViewItem:e=>{let t=this.keybindingService.lookupKeybinding(e.id);if(t)return new Rt.Bi(e,e,{label:!0,keybinding:t.getLabel()})},onHide:e=>{var t;e&&(null===(t=this.table)||void 0===t||t.domFocus())},getActionsContext:()=>null===s||void 0===s?void 0:s.strip(),actionRunner:t})}onMouseDblClick(e){e.element||this.commandService.executeCommand(xu.INLINE_ID)}layoutBody(e,t){var i;this.height=e,this.width=t,super.layoutBody(e,t),null===(i=this.table)||void 0===i||i.layout(e,t)}},{_:jh=Se},{_:Se.ID=Wt.q_},{_:Se.TITLE=(0,Rt.Lj)(10339,"Ports")},Se);_u=jh=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.kd),(0,Rt.Fb)(3,Rt.Sl),(0,Rt.Fb)(4,Rt.yb),(0,Rt.Fb)(5,Rt.o_),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Wt.dx),(0,Rt.Fb)(8,Rt.yr),(0,Rt.Fb)(9,Rt.xc),(0,Rt.Fb)(10,Rt.Cb),(0,Rt.Fb)(11,Rt.Zr),(0,Rt.Fb)(12,Rt.Qd),(0,Rt.Fb)(13,Wt.L_),(0,Rt.Fb)(14,Rt.sr),(0,Rt.Fb)(15,Wt.Px),(0,Rt.Fb)(16,Rt.Cl)],_u);var Eu,Au=class{constructor(e,t){this.id=_u.ID,this.name=_u.TITLE,this.canToggleVisibility=!0,this.hideByDefault=!1,this.group="details@0",this.order=-500,this.canMoveView=!0,this.containerIcon=Mh,this.ctorDescriptor=new Rt.om(_u,[e]),this.remoteAuthority=t.remoteAuthority?t.remoteAuthority.split("+")[0]:void 0}};function Du(e){return e&&e.tunnelType&&e.remoteHost&&e.source}!function(e){e.ID="remote.tunnel.label",e.LABEL=(0,Rt.Ij)(10341,"Set Port Label"),e.COMMAND_ID_KEYWORD="label",e.handler=function(){return async(e,t)=>{let i,o=e.get(Wt.L_);if(Du(t))i=t;else{let t=e.get(Rt.yb).getContextKeyValue(wu),s=t?o.tunnelModel.forwarded.get(t):void 0;if(s){let t=e.get(Wt.Px);i=uu.createFromTunnel(o,t,s)}}if(i){let e=i;return new Promise(t=>{let i=e.name?e.name:"".concat(e.remotePort);o.setEditable(e,Wt.J_.Label,{onFinish:async(s,r)=>{s=s.trim(),o.setEditable(e,Wt.J_.Label,null);let n=r&&s!==i;n&&await o.tunnelModel.name(e.remoteHost,e.remotePort,s),t(n?{port:e.remotePort,label:s}:void 0)},validationMessage:()=>null,placeholder:(0,Rt.Ij)(10342,"Port label"),startingValue:i})})}}}}(Eu||(Eu={}));var xu,Vu,Ru,Tu,Lu,Wu,Fu,Gu,Zu,Nu=(0,Rt.Ij)(10343,"Forwarded port should be a number or a host:port."),Pu=65536,Ju=(0,Rt.Ij)(10344,"Port number must be \u2265 0 and < {0}.",Pu),Bu=(0,Rt.Ij)(10345,"May Require Sudo"),Ou=(0,Rt.Ij)(10346,"Port is already forwarded");function Ku(e,t,i){let o=e.map(e=>{let o=uu.createFromTunnel(t,i,e);return{label:o.label,description:o.processDescription,tunnel:o}});return 0===o.length&&o.push({label:(0,Rt.Ij)(10352,"No ports currently forwarded. Try running the {0} command",xu.LABEL.value)}),o}!function(e){e.INLINE_ID="remote.tunnel.forwardInline",e.COMMANDPALETTE_ID="remote.tunnel.forwardCommandPalette",e.LABEL=(0,Rt.Lj)(10347,"Forward a Port"),e.TREEITEM_LABEL=(0,Rt.Ij)(10348,"Forward Port");let t=(0,Rt.Ij)(10349,"Port number or address (eg. 3000 or 10.10.10.10:2000).");function i(e,t,i,o){let s=(0,Wt.ov)(i);return s?s.port>=Pu?{content:Ju,severity:Rt.Kd.Error}:o&&t.isPortPrivileged(s.port)?{content:Bu,severity:Rt.Kd.Info}:(0,Wt.av)(e.tunnelModel.forwarded,s.host,s.port)?{content:Ou,severity:Rt.Kd.Error}:null:{content:Nu,severity:Rt.Kd.Error}}function o(e,t,i,o){t?"string"==typeof t&&e.warn((0,Rt.Ij)(10351,"Unable to forward {0}:{1}. {2}",i,o,t)):e.warn((0,Rt.Ij)(10350,"Unable to forward {0}:{1}. The host may not be available or that remote port may already be forwarded",i,o))}e.inlineHandler=function(){return async(e,s)=>{let r=e.get(Wt.L_),n=e.get(Rt.Ld),a=e.get(Wt.Px);r.setEditable(void 0,Wt.J_.New,{onFinish:async(e,t)=>{let i;r.setEditable(void 0,Wt.J_.New,null),t&&(i=(0,Wt.ov)(e))&&r.forward({remote:{host:i.host,port:i.port},elevateIfNeeded:!0}).then(e=>o(n,e,i.host,i.port))},validationMessage:e=>i(r,a,e,a.canElevate),placeholder:t})}},e.commandPaletteHandler=function(){return async(e,s)=>{let r=e.get(Wt.L_),n=e.get(Rt.Ld),a=e.get(Wt.T_),d=e.get(Rt.xc),l=e.get(Wt.Px);await a.openView(_u.ID,!0);let c,h=await d.input({prompt:t,validateInput:e=>Promise.resolve(i(r,l,e,l.canElevate))});h&&(c=(0,Wt.ov)(h))&&r.forward({remote:{host:c.host,port:c.port},elevateIfNeeded:!0}).then(e=>o(n,e,c.host,c.port))}}}(xu||(xu={})),function(e){e.INLINE_ID="remote.tunnel.closeInline",e.COMMANDPALETTE_ID="remote.tunnel.closeCommandPalette",e.LABEL=(0,Rt.Lj)(10353,"Stop Forwarding Port"),e.inlineHandler=function(){return async(e,t)=>{let i=e.get(Rt.yb),o=e.get(Wt.L_),s=[],r=i.getContextKeyValue(fu);if(r)r.forEach(e=>{var t;let i=o.tunnelModel.forwarded.get(e);i&&(null===(t=s)||void 0===t||t.push(i))});else if(Du(t))s=[t];else{let e=i.getContextKeyValue(wu),t=e?o.tunnelModel.forwarded.get(e):void 0;t&&(s=[t])}if(s&&0!==s.length)return Promise.all(s.map(e=>o.close({host:e.remoteHost,port:e.remotePort},Wt.$_.User)))}},e.commandPaletteHandler=function(){return async e=>{let t=e.get(Rt.xc),i=e.get(Wt.L_),o=e.get(Wt.Px),s=e.get(Rt.Cb),r=Ku(Array.from(i.tunnelModel.forwarded.values()).filter(e=>e.closeable),i,o),n=await t.pick(r,{placeHolder:(0,Rt.Ij)(10354,"Choose a port to stop forwarding")});n&&n.tunnel?await i.close({host:n.tunnel.remoteHost,port:n.tunnel.remotePort},Wt.$_.User):n&&await s.executeCommand(xu.COMMANDPALETTE_ID)}}}(Vu||(Vu={})),function(e){function t(e,t,i){let o=e.forwarded.get(i)||e.detected.get(i);return o?t.open(o.localUri,{allowContributedOpeners:!1}):Promise.resolve()}e.ID="remote.tunnel.open",e.LABEL=(0,Rt.Ij)(10355,"Open in Browser"),e.handler=function(){return async(e,i)=>{let o;if(Du(i)?o=(0,Wt.iv)(i.remoteHost,i.remotePort):(0,Wt.pv)(i)&&(o=(0,Wt.iv)(i.tunnelRemoteHost,i.tunnelRemotePort)),o){return t(e.get(Wt.L_).tunnelModel,e.get(Rt.yr),o)}}},e.run=t}(Ru||(Ru={})),function(e){async function t(e,t,i,o){let s=e.forwarded.get(o)||e.detected.get(o);if(s){let e=s.remoteHost.includes(":")?"[".concat(s.remoteHost,"]"):s.remoteHost,o=Rt.wD.parse("http://".concat(e,":").concat(s.remotePort)),r=await i.getOpener(s.localUri,{sourceUri:o},Rt.Ik.None);return r?r.openExternalUri(s.localUri,{sourceUri:o},Rt.Ik.None):t.open(s.localUri)}return Promise.resolve()}e.ID="remote.tunnel.openPreview",e.LABEL=(0,Rt.Ij)(10356,"Preview in Editor"),e.handler=function(){return async(e,i)=>{let o;if(Du(i)?o=(0,Wt.iv)(i.remoteHost,i.remotePort):(0,Wt.pv)(i)&&(o=(0,Wt.iv)(i.tunnelRemoteHost,i.tunnelRemotePort)),o){return t(e.get(Wt.L_).tunnelModel,e.get(Rt.yr),e.get(Wt.Tb),o)}}},e.run=t}(Tu||(Tu={})),function(e){e.ID="remote.tunnel.openCommandPalette",e.LABEL=(0,Rt.Ij)(10357,"Open Port in Browser"),e.handler=function(){return async(e,t)=>{let i=e.get(Wt.L_),o=e.get(Wt.Px),s=i.tunnelModel,r=e.get(Rt.xc),n=e.get(Rt.yr),a=e.get(Rt.Cb),d=[...s.forwarded,...s.detected].map(e=>{let t=uu.createFromTunnel(i,o,e[1]);return{label:t.label,description:t.processDescription,tunnel:t}});0===d.length?d.push({label:(0,Rt.Ij)(10358,"No ports currently forwarded. Open the Ports view to get started.")}):d.push({label:(0,Rt.Ij)(10359,"Open the Ports view...")});let l=await r.pick(d,{placeHolder:(0,Rt.Ij)(10360,"Choose the port to open")});return l&&l.tunnel?Ru.run(s,n,(0,Wt.iv)(l.tunnel.remoteHost,l.tunnel.remotePort)):l?a.executeCommand("".concat(Wt.q_,".focus")):void 0}}}(Lu||(Lu={})),function(e){async function t(e,t,i){let o=e.tunnelModel.address(i.remoteHost,i.remotePort);o&&await t.writeText(o.toString())}e.INLINE_ID="remote.tunnel.copyAddressInline",e.COMMANDPALETTE_ID="remote.tunnel.copyAddressCommandPalette",e.INLINE_LABEL=(0,Rt.Ij)(10361,"Copy Local Address"),e.COMMANDPALETTE_LABEL=(0,Rt.Ij)(10362,"Copy Forwarded Port Address"),e.inlineHandler=function(){return async(e,i)=>{let o,s=e.get(Wt.L_);if(Du(i))o=i;else{let t=e.get(Rt.yb).getContextKeyValue(wu);o=t?s.tunnelModel.forwarded.get(t):void 0}if(o)return t(s,e.get(Rt.C),o)}},e.commandPaletteHandler=function(){return async(e,i)=>{let o=e.get(Rt.xc),s=e.get(Wt.L_),r=e.get(Wt.Px),n=e.get(Rt.Cb),a=e.get(Rt.C),d=Array.from(s.tunnelModel.forwarded.values()).concat(Array.from(s.tunnelModel.detected.values())),l=await o.pick(Ku(d,s,r),{placeHolder:(0,Rt.Ij)(10363,"Choose a forwarded port")});l&&l.tunnel?await t(s,a,l.tunnel):l&&await n.executeCommand(xu.COMMANDPALETTE_ID)}}}(Wu||(Wu={})),function(e){e.ID="remote.tunnel.changeLocalPort",e.LABEL=(0,Rt.Ij)(10364,"Change Local Address Port"),e.handler=function(){return async(e,t)=>{let i,o=e.get(Wt.L_),s=e.get(Rt.Ld),r=e.get(Wt.Px);if(Du(t))i=t;else{let t=e.get(Rt.yb).getContextKeyValue(wu),s=t?o.tunnelModel.forwarded.get(t):void 0;if(s){let t=e.get(Wt.Px);i=uu.createFromTunnel(o,t,s)}}if(i){let e=i;o.setEditable(e,Wt.J_.LocalPort,{onFinish:async(t,i)=>{if(o.setEditable(e,Wt.J_.LocalPort,null),i){var r;await o.close({host:e.remoteHost,port:e.remotePort},Wt.$_.Other);let i=Number(t),n=await o.forward({remote:{host:e.remoteHost,port:e.remotePort},local:i,name:e.name,elevateIfNeeded:!0,source:e.source});n&&"string"!=typeof n&&n.tunnelLocalPort!==i&&s.warn((0,Rt.Ij)(10366,"The local port {0} is not available. Port number {1} has been used instead",t,null!==(r=n.tunnelLocalPort)&&void 0!==r?r:n.localAddress))}},validationMessage:e=>function(e,t,i){return t.match(/^[0-9]+$/)?Number(t)>=Pu?{content:Ju,severity:Rt.Kd.Error}:i&&e.isPortPrivileged(Number(t))?{content:Bu,severity:Rt.Kd.Info}:null:{content:(0,Rt.Ij)(10365,"Local port should be a number."),severity:Rt.Kd.Error}}(r,e,r.canElevate),placeholder:(0,Rt.Ij)(10367,"New local port")})}}}}(Fu||(Fu={})),function(e){e.handler=function(e){return async(t,i)=>{if(Du(i)){let o=t.get(Wt.L_);return await o.close({host:i.remoteHost,port:i.remotePort},Wt.$_.Other),o.forward({remote:{host:i.remoteHost,port:i.remotePort},local:i.localPort,name:i.name,elevateIfNeeded:!0,privacy:e,source:i.source})}}}}(Gu||(Gu={})),function(e){async function t(e,t,i,o){if(Du(e)){let s={protocol:t},r=o.remoteAuthority?Rt.X_.USER_REMOTE:Rt.X_.USER_LOCAL;return i.tunnelModel.configPortsAttributes.addAttributes(e.remotePort,s,r)}}e.ID_HTTP="remote.tunnel.setProtocolHttp",e.ID_HTTPS="remote.tunnel.setProtocolHttps",e.LABEL_HTTP=(0,Rt.Ij)(10368,"HTTP"),e.LABEL_HTTPS=(0,Rt.Ij)(10369,"HTTPS"),e.handlerHttp=function(){return async(e,i)=>t(i,Wt.cv.Http,e.get(Wt.L_),e.get(Pt.O))},e.handlerHttps=function(){return async(e,i)=>t(i,Wt.cv.Https,e.get(Wt.L_),e.get(Pt.O))}}(Zu||(Zu={}));var Mu=gu.isEqualTo(Wt.Y_.Forwarded),ju=Rt.PO.or(Mu,gu.isEqualTo(Wt.Y_.Detected)),Qu=Su.isEqualTo(void 0);Rt.hb.registerCommandAndKeybindingRule({id:Eu.ID,weight:Rt.mb.WorkbenchContrib+10,when:Rt.PO.and(Cu,Mu,Qu),primary:Rt.YD.F2,mac:{primary:Rt.YD.Enter},handler:Eu.handler()}),Rt.xb.registerCommand(xu.INLINE_ID,xu.inlineHandler()),Rt.xb.registerCommand(xu.COMMANDPALETTE_ID,xu.commandPaletteHandler()),Rt.hb.registerCommandAndKeybindingRule({id:Vu.INLINE_ID,weight:Rt.mb.WorkbenchContrib+10,when:Rt.PO.and(pu,Cu),primary:Rt.YD.Delete,mac:{primary:Rt.ZD.CtrlCmd|Rt.YD.Backspace,secondary:[Rt.YD.Delete]},handler:Vu.inlineHandler()}),Rt.xb.registerCommand(Vu.COMMANDPALETTE_ID,Vu.commandPaletteHandler()),Rt.xb.registerCommand(Ru.ID,Ru.handler()),Rt.xb.registerCommand(Tu.ID,Tu.handler()),Rt.xb.registerCommand(Lu.ID,Lu.handler()),Rt.hb.registerCommandAndKeybindingRule({id:Wu.INLINE_ID,weight:Rt.mb.WorkbenchContrib+10,when:Rt.PO.and(Cu,ju,Qu),primary:Rt.ZD.CtrlCmd|Rt.YD.KeyC,handler:Wu.inlineHandler()}),Rt.xb.registerCommand(Wu.COMMANDPALETTE_ID,Wu.commandPaletteHandler()),Rt.xb.registerCommand(Fu.ID,Fu.handler()),Rt.xb.registerCommand(Zu.ID_HTTP,Zu.handlerHttp()),Rt.xb.registerCommand(Zu.ID_HTTPS,Zu.handlerHttps()),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:Vu.COMMANDPALETTE_ID,title:Vu.LABEL},when:Wt.nv}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:xu.COMMANDPALETTE_ID,title:xu.LABEL},when:Wt.nv}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:Wu.COMMANDPALETTE_ID,title:Wu.COMMANDPALETTE_LABEL},when:Wt.nv}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:Lu.ID,title:Lu.LABEL},when:Wt.nv}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"._open",order:0,command:{id:Ru.ID,title:Ru.LABEL},when:Rt.PO.and(ju,Qu)}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"._open",order:1,command:{id:Tu.ID,title:Tu.LABEL},when:Rt.PO.and(ju,Qu)}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"0_manage",order:1,command:{id:Eu.ID,title:Eu.LABEL,icon:qh},when:Rt.PO.and(Mu,Qu)}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"2_localaddress",order:0,command:{id:Wu.INLINE_ID,title:Wu.INLINE_LABEL},when:Rt.PO.and(ju,Qu)}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"2_localaddress",order:1,command:{id:Fu.ID,title:Fu.LABEL},when:Rt.PO.and(Mu,Iu,Qu)}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"2_localaddress",order:2,submenu:Rt.sb.TunnelPrivacy,title:(0,Rt.Ij)(10370,"Port Visibility"),when:Rt.PO.and(Mu,mu)}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"2_localaddress",order:3,submenu:Rt.sb.TunnelProtocol,title:(0,Rt.Ij)(10371,"Change Port Protocol"),when:Rt.PO.and(Mu,Qu,ku)}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"3_forward",order:0,command:{id:Vu.INLINE_ID,title:Vu.LABEL},when:pu}),Rt.lb.appendMenuItem(Rt.sb.TunnelContext,{group:"3_forward",order:1,command:{id:xu.INLINE_ID,title:xu.LABEL}}),Rt.lb.appendMenuItem(Rt.sb.TunnelProtocol,{order:0,command:{id:Zu.ID_HTTP,title:Zu.LABEL_HTTP,toggled:vu.isEqualTo(Wt.cv.Http)}}),Rt.lb.appendMenuItem(Rt.sb.TunnelProtocol,{order:1,command:{id:Zu.ID_HTTPS,title:Zu.LABEL_HTTPS,toggled:vu.isEqualTo(Wt.cv.Https)}}),Rt.lb.appendMenuItem(Rt.sb.TunnelPortInline,{group:"0_manage",order:0,command:{id:xu.INLINE_ID,title:xu.TREEITEM_LABEL,icon:Yh},when:gu.isEqualTo(Wt.Y_.Candidate)}),Rt.lb.appendMenuItem(Rt.sb.TunnelPortInline,{group:"0_manage",order:4,command:{id:Eu.ID,title:Eu.LABEL,icon:qh},when:Mu}),Rt.lb.appendMenuItem(Rt.sb.TunnelPortInline,{group:"0_manage",order:5,command:{id:Vu.INLINE_ID,title:Vu.LABEL,icon:Hh},when:pu}),Rt.lb.appendMenuItem(Rt.sb.TunnelLocalAddressInline,{order:-1,command:{id:Wu.INLINE_ID,title:Wu.INLINE_LABEL,icon:zh},when:ju}),Rt.lb.appendMenuItem(Rt.sb.TunnelLocalAddressInline,{order:0,command:{id:Ru.ID,title:Ru.LABEL,icon:Xh},when:ju}),Rt.lb.appendMenuItem(Rt.sb.TunnelLocalAddressInline,{order:1,command:{id:Tu.ID,title:Tu.LABEL,icon:Uh},when:ju}),(0,Rt.Rg)("ports.iconRunningProcessForeground",Lt._n,(0,Rt.Ij)(10372,"The color of the icon for a port that has an associated running process.")),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.ok)();var Yu=(Ie=class e extends Rt.CA{constructor(e,t){super(),this._onDidMatchLocalUrl=new Rt.uA,this.onDidMatchLocalUrl=this._onDidMatchLocalUrl.event,this.listeners=new Map,this.replPositions=new Map,e.instances.forEach(e=>{this.registerTerminalInstance(e)}),this._register(e.onDidCreateInstance(e=>{this.registerTerminalInstance(e)})),this._register(e.onDidDisposeInstance(e=>{var t;null!==(t=this.listeners.get(e))&&void 0!==t&&t.dispose(),this.listeners.delete(e)})),this._register(t.onDidNewSession(e=>{(!e.parentSession||e.parentSession&&e.hasSeparateRepl())&&this.listeners.set(e.getId(),e.onDidChangeReplElements(()=>{this.processNewReplElements(e)}))})),this._register(t.onDidEndSession(e=>{var t;let{session:i}=e;this.listeners.has(i.getId())&&(null!==(t=this.listeners.get(i.getId()))&&void 0!==t&&t.dispose(),this.listeners.delete(i.getId()))}))}registerTerminalInstance(t){e.excludeTerminals.includes(t.title)||this.listeners.set(t,t.onData(e=>{this.processData(e)}))}processNewReplElements(e){let t=this.replPositions.get(e.getId()),i=e.getReplElements();if(this.replPositions.set(e.getId(),{position:i.length-1,tail:i[i.length-1]}),!t&&i.length>0)i.forEach(e=>this.processData(e.toString()));else if(t&&i.length-1!==t.position)for(let o=i.length-1;o>=0;o--){let e=i[o];if(e===t.tail)break;this.processData(e.toString())}}dispose(){super.dispose();let e=this.listeners.values();for(let t of e)t.dispose()}processData(t){let i=(t=(0,Rt.Ck)(t)).match(e.localUrlRegex)||[];if(i&&i.length>0)i.forEach(i=>{let o;try{o=new URL(i)}catch(s){}if(o){let s=i.match(e.extractPortRegex),r=parseFloat(o.port?o.port:s?s[2]:"NaN");if(!isNaN(r)&&Number.isInteger(r)&&r>0&&r<=65535){let e=o.hostname;if("0.0.0.0"!==e&&"127.0.0.1"!==e&&(e="localhost"),9229!==r&&t.startsWith("Debugger listening on"))return;this._onDidMatchLocalUrl.fire({port:r,host:e})}}});else{let i=t.match(e.localPythonServerRegex);i&&3===i.length&&this._onDidMatchLocalUrl.fire({host:i[1],port:Number(i[2])})}}},{_:Ie.localUrlRegex=/\b\w{0,20}(?::\/\/)?(?:localhost|127\.0\.0\.1|0\.0\.0\.0|:\d{2,5})[\w\-\.\~:\/\?\#[\]\@!\$&\(\)\*\+\,\;\=]*/gim},{_:Ie.extractPortRegex=/(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d{1,5})/},{_:Ie.localPythonServerRegex=/HTTP\son\s(127\.0\.0\.1|0\.0\.0\.0)\sport\s(\d+)/},{_:Ie.excludeTerminals=["Dev Containers"]},Ie);(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.PA)(),(0,Wt.Df)(),(0,Wt.X_)(),(0,Wt.R_)(),(0,Wt.rv)(),(0,Rt.bb)(),(0,Pt.k)(),(0,Rt.vb)(),(0,Wt.Sx)(),(0,Wt.vx)(),(0,Rt.qd)(),(0,Rt.Q_)(),(0,Rt.Rd)(),(0,Rt.br)(),(0,Wt.ky)(),(0,Wt.Ab)(),(0,Lt.N)(),(0,Rt.mj)(),(0,Wt.uv)(),(0,Wt.Fx)(),(0,Rt.sm)(),(0,Wt.L)(),(0,Tt.dt)(),(0,Tt.zn)(),(0,Rt.gA)(),(0,Wt.Eb)(),(0,Lt.F)(),(0,Rt.I_)(),(0,Rt.nb)(),(0,Rt.Mb)(),(0,jt.i)(),(0,Rt.Jo)(),(0,Rt.Wo)();var Hu="workbench.view.remote",Xu=class extends Rt.CA{constructor(e,t,i,o,s,r){super(),this.contextKeyService=e,this.environmentService=t,this.remoteExplorerService=i,this.tunnelService=o,this.activityService=s,this.statusbarService=r,this.contextKeyListener=this._register(new Rt.OA),this.activityBadge=this._register(new Rt.OA),this.hasPortsInSession=!1,this._register(Rt._b.as(Wt.gf.ViewsRegistry).registerViewWelcomeContent(Wt.q_,{content:this.environmentService.remoteAuthority?(0,Rt.Ij)(10252,"No forwarded ports. Forward a port to access your running services locally.\n[Forward a Port]({0})","command:".concat(xu.INLINE_ID)):(0,Rt.Ij)(10253,"No forwarded ports. Forward a port to access your locally running services over the internet.\n[Forward a Port]({0})","command:".concat(xu.INLINE_ID))})),this.enableBadgeAndStatusBar(),this.enableForwardedPortsFeatures(),this.environmentService.remoteAuthority||this._register(Rt.dA.once(this.tunnelService.onTunnelOpened)(()=>{this.hasPortsInSession=!0}))}async getViewContainer(){return Rt._b.as(Wt.gf.ViewContainersRegistry).registerViewContainer({id:Wt.K_,title:(0,Rt.Lj)(10254,"Ports"),icon:Mh,ctorDescriptor:new Rt.om(Wt.P,[Wt.K_,{mergeViewWithContainerWhenSingleView:!0}]),storageId:Wt.K_,hideIfEmpty:!0,order:5},Wt.Sf.Panel)}async enableForwardedPortsFeatures(){this.contextKeyListener.clear();let e=!!Wt.tv.getValue(this.contextKeyService),t=!!Wt.nv.getValue(this.contextKeyService);if(e||t){t||this.contextKeyService.createKey(Wt.nv.key,!0);let i=await this.getViewContainer(),o=new Au(new ou(this.remoteExplorerService,this.tunnelService),this.environmentService),s=Rt._b.as(Wt.gf.ViewsRegistry);i&&(this.remoteExplorerService.enablePortsFeatures(!e),s.registerViews([o],i))}else this.contextKeyListener.value=this.contextKeyService.onDidChangeContext(e=>{e.affectsSome(new Set([...Wt.tv.keys(),...Wt.nv.keys()]))&&this.enableForwardedPortsFeatures()})}enableBadgeAndStatusBar(){let e=Rt._b.as(Wt.gf.ViewsRegistry).onViewsRegistered(t=>{t.find(e=>e.views.find(e=>"~remote.forwardedPorts"===e.id))&&(this._register(Rt.dA.debounce(this.remoteExplorerService.tunnelModel.onForwardPort,(e,t)=>t,50)(()=>{this.updateActivityBadge(),this.updateStatusBar()})),this._register(Rt.dA.debounce(this.remoteExplorerService.tunnelModel.onClosePort,(e,t)=>t,50)(()=>{this.updateActivityBadge(),this.updateStatusBar()})),this.updateActivityBadge(),this.updateStatusBar(),e.dispose())})}async updateActivityBadge(){this.remoteExplorerService.tunnelModel.forwarded.size>0?this.activityBadge.value=this.activityService.showViewActivity(Wt.q_,{badge:new Tt.lt(this.remoteExplorerService.tunnelModel.forwarded.size,e=>1===e?(0,Rt.Ij)(10255,"1 forwarded port"):(0,Rt.Ij)(10256,"{0} forwarded ports",e))}):this.activityBadge.clear()}updateStatusBar(){!this.environmentService.remoteAuthority&&!this.hasPortsInSession||(this.entryAccessor?this.entryAccessor.update(this.entry):this._register(this.entryAccessor=this.statusbarService.addEntry(this.entry,"status.forwardedPorts",Wt.bx.LEFT,40)))}get entry(){let e,t=this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size,i="".concat(t);if(0===t)e=(0,Rt.Ij)(10257,"No Ports Forwarded");else{let t=Array.from(this.remoteExplorerService.tunnelModel.forwarded.values());t.push(...Array.from(this.remoteExplorerService.tunnelModel.detected.values())),e=(0,Rt.Ij)(10258,"Forwarded Ports: {0}",t.map(e=>e.remotePort).join(", "))}return{name:(0,Rt.Ij)(10259,"Forwarded Ports"),text:"$(radio-tower) ".concat(i),ariaLabel:e,tooltip:e,command:"".concat(Wt.q_,".focus")}}};Xu=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.yb),(0,Rt.Fb)(1,Pt.O),(0,Rt.Fb)(2,Wt.L_),(0,Rt.Fb)(3,Wt.Px),(0,Rt.Fb)(4,Tt.Rn),(0,Rt.Fb)(5,Wt._x)],Xu);var Uu=class{constructor(e,t){this.remoteExplorerService=e,this.logService=t,this.remoteExplorerService.tunnelModel.environmentTunnelsSet?this.restore():Rt.dA.once(this.remoteExplorerService.tunnelModel.onEnvironmentTunnelsSet)(async()=>{await this.restore()})}async restore(){return this.logService.trace("ForwardedPorts: Doing first restore."),this.remoteExplorerService.restore()}};Uu=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.L_),(0,Rt.Fb)(1,Rt.eb)],Uu);var zu=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p){super(),this.terminalService=e,this.notificationService=t,this.openerService=i,this.externalOpenerService=o,this.remoteExplorerService=s,this.contextKeyService=n,this.configurationService=a,this.debugService=d,this.tunnelService=c,this.hostService=h,this.logService=u,this.storageService=g,this.preferencesService=p,r.remoteAuthority&&(a.whenRemoteConfigurationLoaded().then(()=>l.getEnvironment()).then(e=>{this.setup(e),this._register(a.onDidChangeConfiguration(t=>{t.affectsConfiguration("remote.autoForwardPortsSource")?this.setup(e):t.affectsConfiguration("remote.autoForwardPortsFallback")&&!this.portListener&&this.listenForPorts()}))}),this.storageService.getBoolean("processPortForwardingFallback",Rt.Go.WORKSPACE,!0)||this.configurationService.updateValue(Wt.z_,0,Rt.X_.WORKSPACE))}getPortAutoFallbackNumber(){var e;let t=this.configurationService.inspect(Wt.z_);if(void 0!==t.value&&(0===t.value||t.value!==t.defaultValue))return t.value;let i=this.configurationService.inspect(Wt.V_);return"process"===i.applicationValue||"process"===i.userValue||"process"===i.userLocalValue||"process"===i.userRemoteValue||"process"===i.workspaceFolderValue||"process"===i.workspaceValue?0:null!==(e=t.value)&&void 0!==e?e:20}listenForPorts(){var e;let t=this.getPortAutoFallbackNumber();var i;0!==t?this.procForwarder&&!this.portListener&&"process"===this.configurationService.getValue("remote.autoForwardPortsSource")?this.portListener=this._register(this.remoteExplorerService.tunnelModel.onForwardPort(async()=>{var e;(t=this.getPortAutoFallbackNumber(),0!==t)?Array.from(this.remoteExplorerService.tunnelModel.forwarded.values()).filter(e=>e.source.source===Wt.ev.Auto).length>t&&(await this.configurationService.updateValue(Wt.V_,Wt.H_),this.notificationService.notify({message:(0,Rt.Ij)(10260,"Over 20 ports have been automatically forwarded. The `process` based automatic port forwarding has been switched to `hybrid` in settings. Some ports may no longer be detected."),severity:Rt.Kd.Warning,actions:{primary:[(0,Rt.Nb)({id:"switchBack",label:(0,Rt.Ij)(10261,"Undo"),run:async()=>{var e;await this.configurationService.updateValue(Wt.V_,Wt.W_),await this.configurationService.updateValue(Wt.z_,0,Rt.X_.WORKSPACE),null!==(e=this.portListener)&&void 0!==e&&e.dispose(),this.portListener=void 0}}),(0,Rt.Nb)({id:"showPortSourceSetting",label:(0,Rt.Ij)(10262,"Show Setting"),run:async()=>{await this.preferencesService.openSettings({query:"remote.autoForwardPortsSource"})}})]}})):null===(e=this.portListener)||void 0===e||e.dispose()})):(null!==(e=this.portListener)&&void 0!==e&&e.dispose(),this.portListener=void 0):null===(i=this.portListener)||void 0===i||i.dispose()}setup(e){var t,i,o,s;let r=null===(t=this.procForwarder)||void 0===t?void 0:t.forwarded,n=this.outputForwarder||this.procForwarder;if(null!==(i=this.procForwarder)&&void 0!==i&&i.dispose(),this.procForwarder=void 0,null!==(o=this.outputForwarder)&&void 0!==o&&o.dispose(),this.outputForwarder=void 0,(null===e||void 0===e?void 0:e.os)!==Rt.dj.Linux)"output"!==(null===(s=this.configurationService.inspect("remote.autoForwardPortsSource").default)||void 0===s?void 0:s.value)&&Rt._b.as(Rt.E_.Configuration).registerDefaultConfigurations([{overrides:{"remote.autoForwardPortsSource":Wt.U_}}]),this.outputForwarder=this._register(new $u(this.terminalService,this.notificationService,this.openerService,this.externalOpenerService,this.remoteExplorerService,this.configurationService,this.debugService,this.tunnelService,this.hostService,this.logService,this.contextKeyService,()=>!1));else{let e=()=>this.configurationService.getValue(Wt.V_)===Wt.W_;e()?this.procForwarder=this._register(new eg(!1,r,!n,this.configurationService,this.remoteExplorerService,this.notificationService,this.openerService,this.externalOpenerService,this.tunnelService,this.hostService,this.logService,this.contextKeyService)):"hybrid"===this.configurationService.getValue("remote.autoForwardPortsSource")&&(this.procForwarder=this._register(new eg(!0,r,!n,this.configurationService,this.remoteExplorerService,this.notificationService,this.openerService,this.externalOpenerService,this.tunnelService,this.hostService,this.logService,this.contextKeyService))),this.outputForwarder=this._register(new $u(this.terminalService,this.notificationService,this.openerService,this.externalOpenerService,this.remoteExplorerService,this.configurationService,this.debugService,this.tunnelService,this.hostService,this.logService,this.contextKeyService,e))}this.listenForPorts()}};zu=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.Oy),(0,Rt.Fb)(1,Rt.Ld),(0,Rt.Fb)(2,Rt.yr),(0,Rt.Fb)(3,Wt.Tb),(0,Rt.Fb)(4,Wt.L_),(0,Rt.Fb)(5,Pt.O),(0,Rt.Fb)(6,Rt.yb),(0,Rt.Fb)(7,Ut.o),(0,Rt.Fb)(8,Wt.kb),(0,Rt.Fb)(9,Lt.M),(0,Rt.Fb)(10,Wt.Px),(0,Rt.Fb)(11,Lt.P),(0,Rt.Fb)(12,Rt.eb),(0,Rt.Fb)(13,Rt.Uo),(0,Rt.Fb)(14,jt.r)],zu);var qu=(ke=class e extends Rt.CA{constructor(e,t,i,o,s,r,n,a){super(),this.notificationService=e,this.remoteExplorerService=t,this.openerService=i,this.externalOpenerService=o,this.tunnelService=s,this.hostService=r,this.logService=n,this.contextKeyService=a,this.alreadyOpenedOnce=new Set,this.lastNotifyTime=new Date,this.lastNotifyTime.setFullYear(this.lastNotifyTime.getFullYear()-1)}async doAction(t){var i;this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Starting action for ".concat(null===(i=t[0])||void 0===i?void 0:i.tunnelRemotePort)),this.doActionTunnels=t;let o=await this.portNumberHeuristicDelay();if(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Heuristic chose ".concat(null===o||void 0===o?void 0:o.tunnelRemotePort)),o){var s;let t=null===(s=await this.remoteExplorerService.tunnelModel.getAttributes([{port:o.tunnelRemotePort,host:o.tunnelRemoteHost}]))||void 0===s||null===(s=s.get(o.tunnelRemotePort))||void 0===s?void 0:s.onAutoForward;switch(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) onAutoForward action is ".concat(t)),t){case Wt.Q_.OpenBrowserOnce:if(this.alreadyOpenedOnce.has(o.localAddress))break;this.alreadyOpenedOnce.add(o.localAddress);case Wt.Q_.OpenBrowser:{let e=(0,Wt.iv)(o.tunnelRemoteHost,o.tunnelRemotePort);await Ru.run(this.remoteExplorerService.tunnelModel,this.openerService,e);break}case Wt.Q_.OpenPreview:{let e=(0,Wt.iv)(o.tunnelRemoteHost,o.tunnelRemotePort);await Tu.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,e);break}case Wt.Q_.Silent:break;default:{let t=(new Date).getTime()-this.lastNotifyTime.getTime();this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) time elapsed since last notification ".concat(t," ms")),t>e.NOTIFY_COOL_DOWN&&await this.showNotification(o)}}}}hide(e){var t;this.doActionTunnels&&(this.doActionTunnels=this.doActionTunnels.filter(t=>!e.includes(t.tunnelRemotePort))),this.lastShownPort&&e.indexOf(this.lastShownPort)>=0&&(null===(t=this.lastNotification)||void 0===t||t.close())}async portNumberHeuristicDelay(){if(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Starting heuristic delay"),!this.doActionTunnels||0===this.doActionTunnels.length)return;this.doActionTunnels=this.doActionTunnels.sort((e,t)=>e.tunnelRemotePort-t.tunnelRemotePort);let e=this.doActionTunnels.shift();return e.tunnelRemotePort%1e3==0?(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because % 1000: ".concat(e.tunnelRemotePort)),this.newerTunnel=e,e):e.tunnelRemotePort<1e4&&9229!==e.tunnelRemotePort?(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because < 10000: ".concat(e.tunnelRemotePort)),this.newerTunnel=e,e):(this.logService.trace('ForwardedPorts: (OnAutoForwardedAction) Waiting for "better" tunnel than '.concat(e.tunnelRemotePort)),this.newerTunnel=void 0,new Promise(t=>{setTimeout(()=>{var i;this.newerTunnel?t(void 0):null!==(i=this.doActionTunnels)&&void 0!==i&&i.includes(e)?t(e):t(void 0)},3e3)}))}async basicMessage(e){var t;let i=null===(t=await this.remoteExplorerService.tunnelModel.getAttributes([{host:e.tunnelRemoteHost,port:e.tunnelRemotePort}],!1))||void 0===t||null===(t=t.get(e.tunnelRemotePort))||void 0===t?void 0:t.label;return(0,Rt.Ij)(10263,"Your application{0} running on port {1} is available.  ",i?" (".concat(i,")"):"",e.tunnelRemotePort)}linkMessage(){return(0,Rt.Ij)(10264,"[See all forwarded ports]({0})","command:".concat(_u.ID,".focus"))}async showNotification(e){var t;if(!await this.hostService.hadLastFocus())return;null===(t=this.lastNotification)||void 0===t||t.close();let i=await this.basicMessage(e),o=[this.openBrowserChoice(e)];(!Rt.Dj||tu.getValue(this.contextKeyService))&&o.push(this.openPreviewChoice(e)),e.tunnelLocalPort!==e.tunnelRemotePort&&this.tunnelService.canElevate&&this.tunnelService.isPortPrivileged(e.tunnelRemotePort)&&(i+=(0,Rt.Ij)(10265,"You'll need to run as superuser to use port {0} locally.  ",e.tunnelRemotePort),o.unshift(this.elevateChoice(e))),e.privacy===Wt.sv.Private&&Rt.Dj&&this.tunnelService.canChangePrivacy&&o.push(this.makePublicChoice(e)),i+=this.linkMessage(),this.lastNotification=this.notificationService.prompt(Rt.Kd.Info,i,o,{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastShownPort=e.tunnelRemotePort,this.lastNotifyTime=new Date,this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0})}makePublicChoice(e){return{label:(0,Rt.Ij)(10266,"Make Public"),run:async()=>{let t=(0,Wt.av)(this.remoteExplorerService.tunnelModel.forwarded,e.tunnelRemoteHost,e.tunnelRemotePort);return await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},Wt.$_.Other),this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelLocalPort,name:null===t||void 0===t?void 0:t.name,elevateIfNeeded:!0,privacy:Wt.sv.Public,source:null===t||void 0===t?void 0:t.source})}}}openBrowserChoice(e){let t=(0,Wt.iv)(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:Ru.LABEL,run:()=>Ru.run(this.remoteExplorerService.tunnelModel,this.openerService,t)}}openPreviewChoice(e){let t=(0,Wt.iv)(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:Tu.LABEL,run:()=>Tu.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,t)}}elevateChoice(e){return{label:(0,Rt.Ij)(10267,"Use Port {0} as Sudo...",e.tunnelRemotePort),run:async()=>{var t;await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},Wt.$_.Other);let i=await this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelRemotePort,elevateIfNeeded:!0,source:Wt.Z_});!i||"string"==typeof i||(null!==(t=this.lastNotification)&&void 0!==t&&t.close(),this.lastShownPort=i.tunnelRemotePort,this.lastNotification=this.notificationService.prompt(Rt.Kd.Info,await this.basicMessage(i)+this.linkMessage(),[this.openBrowserChoice(i),this.openPreviewChoice(e)],{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0}))}}}},{_:ke.NOTIFY_COOL_DOWN=5e3},ke),$u=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a,d,l,c,h){super(),this.terminalService=e,this.notificationService=t,this.openerService=i,this.externalOpenerService=o,this.remoteExplorerService=s,this.configurationService=r,this.debugService=n,this.tunnelService=a,this.hostService=d,this.logService=l,this.contextKeyService=c,this.privilegedOnly=h,this.notifier=new qu(t,s,i,o,a,d,l,c),this._register(r.onDidChangeConfiguration(e=>{e.affectsConfiguration("remote.autoForwardPorts")&&this.tryStartStopUrlFinder()})),this.portsFeatures=this._register(this.remoteExplorerService.onEnabledPortsFeatures(()=>{this.tryStartStopUrlFinder()})),this.tryStartStopUrlFinder(),"hybrid"===r.getValue("remote.autoForwardPortsSource")&&this._register(this.tunnelService.onTunnelClosed(e=>this.notifier.hide([e.port])))}tryStartStopUrlFinder(){this.configurationService.getValue("remote.autoForwardPorts")?this.startUrlFinder():this.stopUrlFinder()}startUrlFinder(){var e;!this.urlFinder&&this.remoteExplorerService.portsFeaturesEnabled!==Wt.G_.AdditionalFeatures||(null!==(e=this.portsFeatures)&&void 0!==e&&e.dispose(),this.urlFinder=this._register(new Yu(this.terminalService,this.debugService)),this._register(this.urlFinder.onDidMatchLocalUrl(async e=>{var t;if((0,Wt.av)(this.remoteExplorerService.tunnelModel.detected,e.host,e.port))return;let i=null===(t=await this.remoteExplorerService.tunnelModel.getAttributes([e]))||void 0===t?void 0:t.get(e.port);if((null===i||void 0===i?void 0:i.onAutoForward)===Wt.Q_.Ignore||this.privilegedOnly()&&!this.tunnelService.isPortPrivileged(e.port))return;let o=await this.remoteExplorerService.forward({remote:e,source:Wt.Z_},null!==i&&void 0!==i?i:null);o&&"string"!=typeof o&&this.notifier.doAction([o])})))}stopUrlFinder(){this.urlFinder&&(this.urlFinder=void this.urlFinder.dispose())}},eg=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a,d,l,c,h){super(),this.unforwardOnly=e,this.alreadyAutoForwarded=t,this.needsInitialCandidates=i,this.configurationService=o,this.remoteExplorerService=s,this.notificationService=r,this.openerService=n,this.externalOpenerService=a,this.tunnelService=d,this.hostService=l,this.logService=c,this.contextKeyService=h,this.autoForwarded=new Set,this.notifiedOnly=new Set,this.initialCandidates=new Set,this.notifier=new qu(r,s,n,a,d,l,c,h),null!==t&&void 0!==t&&t.forEach(e=>this.autoForwarded.add(e)),this.initialize()}get forwarded(){return this.autoForwarded}async initialize(){this.remoteExplorerService.tunnelModel.environmentTunnelsSet||await new Promise(e=>this.remoteExplorerService.tunnelModel.onEnvironmentTunnelsSet(()=>e())),this._register(this.configurationService.onDidChangeConfiguration(async e=>{e.affectsConfiguration("remote.autoForwardPorts")&&await this.startStopCandidateListener()})),this.portsFeatures=this._register(this.remoteExplorerService.onEnabledPortsFeatures(async()=>{await this.startStopCandidateListener()})),this.startStopCandidateListener()}async startStopCandidateListener(){this.configurationService.getValue("remote.autoForwardPorts")?await this.startCandidateListener():this.stopCandidateListener()}stopCandidateListener(){this.candidateListener&&(this.candidateListener=void this.candidateListener.dispose())}async startCandidateListener(){var e;this.candidateListener||this.remoteExplorerService.portsFeaturesEnabled!==Wt.G_.AdditionalFeatures||(null!==(e=this.portsFeatures)&&void 0!==e&&e.dispose(),await this.setInitialCandidates(),this.configurationService.getValue("remote.autoForwardPorts")&&(this.candidateListener=this._register(this.remoteExplorerService.tunnelModel.onCandidatesChanged(this.handleCandidateUpdate,this))))}async setInitialCandidates(){if(!this.needsInitialCandidates)return void this.logService.debug("ForwardedPorts: (ProcForwarding) Not setting initial candidates");let e=this.remoteExplorerService.tunnelModel.candidatesOrUndefined;e||(await new Promise(e=>this.remoteExplorerService.tunnelModel.onCandidatesChanged(()=>e())),e=this.remoteExplorerService.tunnelModel.candidates);for(let t of e)this.initialCandidates.add((0,Wt.iv)(t.host,t.port));this.logService.debug("ForwardedPorts: (ProcForwarding) Initial candidates set to ".concat(e.map(e=>e.port).join(", ")))}async forwardCandidates(){let e,t=[];this.logService.trace("ForwardedPorts: (ProcForwarding) Attempting to forward ".concat(this.remoteExplorerService.tunnelModel.candidates.length," candidates"));for(let o of this.remoteExplorerService.tunnelModel.candidates){var i;if(!o.detail){this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," missing detail"));continue}e||(e=await this.remoteExplorerService.tunnelModel.getAttributes(this.remoteExplorerService.tunnelModel.candidates));let s=null===(i=e)||void 0===i?void 0:i.get(o.port),r=(0,Wt.iv)(o.host,o.port);if(this.initialCandidates.has(r)&&void 0===(null===s||void 0===s?void 0:s.onAutoForward)||this.notifiedOnly.has(r)||this.autoForwarded.has(r))continue;let n=(0,Wt.av)(this.remoteExplorerService.tunnelModel.forwarded,o.host,o.port);if((0,Wt.av)(this.remoteExplorerService.tunnelModel.detected,o.host,o.port))continue;if((null===s||void 0===s?void 0:s.onAutoForward)===Wt.Q_.Ignore){this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," is ignored"));continue}let a=await this.remoteExplorerService.forward({remote:o,source:Wt.Z_},null!==s&&void 0!==s?s:null);!n&&a?(this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," has been forwarded")),this.autoForwarded.add(r)):a&&(this.logService.trace("ForwardedPorts: (ProcForwarding) Port ".concat(o.port," has been notified")),this.notifiedOnly.add(r)),a&&"string"!=typeof a&&t.push(a)}if(this.logService.trace("ForwardedPorts: (ProcForwarding) Forwarded ".concat(t.length," candidates")),0!==t.length)return t}async handleCandidateUpdate(e){let t,i=[];if(this.unforwardOnly){t=new Map;for(let e of this.remoteExplorerService.tunnelModel.forwarded.entries())e[1].source.source===Wt.ev.Auto&&t.set(e[0],e[1])}else t=new Map(this.autoForwarded.entries());for(let s of e){let e=s[0],o=s[1],r=(0,Wt.av)(t,o.host,o.port);r?("string"==typeof r?this.autoForwarded.delete(e):o={host:r.remoteHost,port:r.remotePort},await this.remoteExplorerService.close(o,Wt.$_.AutoForwardEnd),i.push(o.port)):this.notifiedOnly.delete(e)?i.push(o.port):this.initialCandidates.delete(e)}if(this.unforwardOnly)return;i.length>0&&await this.notifier.hide(i);let o=await this.forwardCandidates();o&&await this.notifier.doAction(o)}};(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.zk)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.bb)(),(0,Rt.wl)(),(0,Rt.Kb)(),(0,Rt.Ad)(),(0,Rt.br)(),(0,Rt.Ja)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.$d)(),(0,Wt.Q)(),(0,Lt.C)(),(0,Wt.fx)(),(0,Wt.E_)(),(0,Wt.pt)(),(0,Wt.ey)(),(0,Wt.ta)(),(0,Wt.Xv)(),(0,Tt.dt)(),(0,Tt.zn)(),(0,Nt.Ot)(),(0,Rt.cr)();var tg,ig="webviewState",og=(_e=class extends Wt.Y{static getOriginStore(e){var t;return null!==(t=this._originStore)&&void 0!==t||(this._originStore=new Wt.st("webviewViews.origins",e)),this._originStore}constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m){super((0,xt.A)((0,xt.A)({},e),{},{titleMenuId:Rt.sb.ViewTitle,showActions:Wt.X.WhenExpanded}),r,o,t,i,l,s,n,d,a),this.activityService=c,this.extensionService=h,this.progressService=u,this.storageService=g,this.viewService=p,this.webviewService=b,this.webviewViewService=m,this._webview=this._register(new Rt.OA),this._webviewDisposables=this._register(new Rt.EA),this._activated=!1,this.activity=this._register(new Rt.OA),this._onDidChangeVisibility=this._register(new Rt.uA),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDispose=this._register(new Rt.uA),this.onDispose=this._onDispose.event,this.extensionId=e.fromExtensionId,this.defaultTitle=this.title,this.memento=new Lt.S("webviewView.".concat(this.id),g),this.viewState=this.memento.getMemento(Rt.Go.WORKSPACE,Rt.Ko.MACHINE),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.webviewViewService.onNewResolverRegistered(e=>{e.viewType===this.id&&this.updateTreeVisibility()})),this.updateTreeVisibility()}dispose(){this._onDispose.fire(),clearTimeout(this._repositionTimeout),super.dispose()}focus(){var e;super.focus(),null===(e=this._webview.value)||void 0===e||e.focus()}renderBody(e){super.renderBody(e),this._container=e,this._rootContainer=void 0,this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{setTimeout(()=>{this.layoutWebview()},0)}),this._register((0,Rt.zA)(()=>{var e;null===(e=this._resizeObserver)||void 0===e||e.disconnect()})),this._resizeObserver.observe(e))}saveState(){this._webview.value&&(this.viewState[ig]=this._webview.value.state),this.memento.saveMemento(),super.saveState()}layoutBody(e,t){super.layoutBody(e,t),this.layoutWebview(new Rt.Qb(t,e))}updateTreeVisibility(){var e,t;this.isBodyVisible()?(this.activate(),null===(e=this._webview.value)||void 0===e||e.claim(this,(0,Rt.Bx)(this.element),void 0)):null===(t=this._webview.value)||void 0===t||t.release(this)}activate(){if(this._activated)return;this._activated=!0;let e=this.extensionId?tg.getOriginStore(this.storageService).getOrigin(this.id,this.extensionId):void 0,t=this.webviewService.createWebviewOverlay({origin:e,providedViewType:this.id,title:this.title,options:{purpose:Wt.dt.WebviewView},contentOptions:{},extension:this.extensionId?{id:this.extensionId}:void 0});t.state=this.viewState[ig],this._webview.value=t,this._container&&this.layoutWebview(),this._webviewDisposables.add((0,Rt.zA)(()=>{var e;null===(e=this._webview.value)||void 0===e||e.release(this)})),this._webviewDisposables.add(t.onDidUpdateState(()=>{this.viewState[ig]=t.state}));for(let o of[Rt.tx.DRAG,Rt.tx.DRAG_END,Rt.tx.DRAG_ENTER,Rt.tx.DRAG_LEAVE,Rt.tx.DRAG_START])this._webviewDisposables.add((0,Rt.ox)(this._webview.value.container,o,e=>{e.preventDefault(),e.stopImmediatePropagation(),this.dropTargetElement.dispatchEvent(new DragEvent(e.type,e))}));this._webviewDisposables.add(new Wt.ea((0,Rt.Bx)(this.element),()=>this._webview.value));let i=this._webviewDisposables.add(new Rt.Lk);this.withProgress(async()=>{await this.extensionService.activateByEvent("onView:".concat(this.id));let e=this,o={webview:t,onDidChangeVisibility:this.onDidChangeBodyVisibility,onDispose:this.onDispose,get title(){return e.setTitle},set title(t){e.updateTitle(t)},get description(){return e.titleDescription},set description(t){e.updateTitleDescription(t)},get badge(){return e.badge},set badge(t){e.updateBadge(t)},dispose:()=>{this._activated=!1,this._webview.clear(),this._webviewDisposables.clear()},show:e=>{this.viewService.openView(this.id,!e)}};await this.webviewViewService.resolve(this.id,o,i.token)})}updateTitle(e){this.setTitle=e,super.updateTitle("string"==typeof e?e:this.defaultTitle)}updateBadge(e){var t,i;if(((null===(t=this.badge)||void 0===t?void 0:t.value)!==(null===e||void 0===e?void 0:e.value)||(null===(i=this.badge)||void 0===i?void 0:i.tooltip)!==(null===e||void 0===e?void 0:e.tooltip))&&(this.badge=e,e)){let t={badge:new Tt.lt(e.value,()=>e.tooltip),priority:150};this.activity.value=this.activityService.showViewActivity(this.id,t)}}async withProgress(e){return this.progressService.withProgress({location:this.id,delay:500},e)}onDidScrollRoot(){this.layoutWebview()}doLayoutWebview(e){let t=this._webview.value;!this._container||!t||((!this._rootContainer||!this._rootContainer.isConnected)&&(this._rootContainer=this.findRootContainer(this._container)),t.layoutWebviewOverElement(this._container,e,this._rootContainer))}layoutWebview(e){this.doLayoutWebview(e),clearTimeout(this._repositionTimeout),this._repositionTimeout=setTimeout(()=>this.doLayoutWebview(e),200)}findRootContainer(e){var t;return null!==(t=(0,Rt.Cx)(e,"monaco-scrollable-element"))&&void 0!==t?t:void 0}},{_:tg=_e},_e);og=tg=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.o_),(0,Rt.Fb)(2,Rt.yb),(0,Rt.Fb)(3,Rt.Sl),(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.kd),(0,Rt.Fb)(6,Rt.yr),(0,Rt.Fb)(7,Rt.sr),(0,Rt.Fb)(8,Rt.Qd),(0,Rt.Fb)(9,Wt.dx),(0,Rt.Fb)(10,Tt.Rn),(0,Rt.Fb)(11,Nt.Dt),(0,Rt.Fb)(12,Rt.qa),(0,Rt.Fb)(13,Rt.Uo),(0,Rt.Fb)(14,Wt.T_),(0,Rt.Fb)(15,Wt.$v),(0,Rt.Fb)(16,Wt.Yv)],og),(0,Rt.Ib)(),(0,Rt.Ic)(),(0,Rt.PA)(),(0,Rt.iT)(),(0,Rt.ok)(),(0,Rt.Db)(),(0,Rt.Fj)(),(0,Rt.IO)(),(0,Nt.gr)(),(0,Rt.sm)(),(0,Rt.Kb)(),(0,Rt.nb)(),(0,Rt.vb)(),(0,Wt.L)(),(0,Pt.b)(),(0,Wt.Df)(),(0,Wt.hf)(),(0,Wt.qg)(),(0,Qt.n)(),(0,Ot.P)(),(0,Qt.a)();var sg,rg,ng={type:"object",properties:{id:{description:(0,Rt.Ij)(2576,"Unique id used to identify the container in which views can be contributed using 'views' contribution point"),type:"string",pattern:"^[a-zA-Z0-9_-]+$"},title:{description:(0,Rt.Ij)(2577,"Human readable string used to render the container"),type:"string"},icon:{description:(0,Rt.Ij)(2578,"Path to the container icon. Icons are 24x24 centered on a 50x40 block and have a fill color of 'rgb(215, 218, 224)' or '#d7dae0'. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"}},required:["id","title","icon"]},ag={description:(0,Rt.Ij)(2579,"Contributes views containers to the editor"),type:"object",properties:{activitybar:{description:(0,Rt.Ij)(2580,"Contribute views containers to Activity Bar"),type:"array",items:ng},panel:{description:(0,Rt.Ij)(2581,"Contribute views containers to Panel"),type:"array",items:ng},secondarySidebar:{description:(0,Rt.Ij)(2582,"Contribute views containers to Secondary Side Bar"),type:"array",items:ng}},additionalProperties:!1};!function(e){e.Tree="tree",e.Webview="webview"}(sg||(sg={})),function(e){e.Visible="visible",e.Hidden="hidden",e.Collapsed="collapsed"}(rg||(rg={}));var dg={type:"object",required:["id","name","icon"],defaultSnippets:[{body:{id:"${1:id}",name:"${2:name}",icon:"${3:icon}"}}],properties:{type:{markdownDescription:(0,Rt.Ij)(2583,"Type of the view. This can either be `tree` for a tree view based view or `webview` for a webview based view. The default is `tree`."),type:"string",enum:["tree","webview"],markdownEnumDescriptions:[(0,Rt.Ij)(2584,"The view is backed by a `TreeView` created by `createTreeView`."),(0,Rt.Ij)(2585,"The view is backed by a `WebviewView` registered by `registerWebviewViewProvider`.")]},id:{markdownDescription:(0,Rt.Ij)(2586,"Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:(0,Rt.Ij)(2587,"The human-readable name of the view. Will be shown"),type:"string"},when:{description:(0,Rt.Ij)(2588,"Condition which must be true to show this view"),type:"string"},icon:{description:(0,Rt.Ij)(2589,"Path to the view icon. View icons are displayed when the name of the view cannot be shown. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"},contextualTitle:{description:(0,Rt.Ij)(2590,"Human-readable context for when the view is moved out of its original location. By default, the view's container name will be used."),type:"string"},visibility:{description:(0,Rt.Ij)(2591,"Initial state of the view when the extension is first installed. Once the user has changed the view state by collapsing, moving, or hiding the view, the initial state will not be used again."),type:"string",enum:["visible","hidden","collapsed"],default:"visible",enumDescriptions:[(0,Rt.Ij)(2592,"The default initial state for the view. In most containers the view will be expanded, however; some built-in containers (explorer, scm, and debug) show all contributed views collapsed regardless of the `visibility`."),(0,Rt.Ij)(2593,"The view will not be shown in the view container, but will be discoverable through the views menu and other view entry points and can be un-hidden by the user."),(0,Rt.Ij)(2594,"The view will show in the view container, but will be collapsed.")]},initialSize:{type:"number",description:(0,Rt.Ij)(2595,"The initial size of the view. The size will behave like the css 'flex' property, and will set the initial size when the view is first shown. In the side bar, this is the height of the view. This value is only respected when the same extension owns both the view and the view container.")},accessibilityHelpContent:{type:"string",markdownDescription:(0,Rt.Ij)(2596,"When the accessibility help dialog is invoked in this view, this content will be presented to the user as a markdown string. Keybindings will be resolved when provided in the format of <keybinding:commandId>. If there is no keybinding, that will be indicated and this command will be included in a quickpick for easy configuration.")}}},lg={type:"object",required:["id","name"],properties:{id:{description:(0,Rt.Ij)(2586,"Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:(0,Rt.Ij)(2587,"The human-readable name of the view. Will be shown"),type:"string"},when:{description:(0,Rt.Ij)(2588,"Condition which must be true to show this view"),type:"string"},group:{description:(0,Rt.Ij)(2597,"Nested group in the viewlet"),type:"string"},remoteName:{description:(0,Rt.Ij)(2598,"The name of the remote type associated with this view"),type:["string","array"],items:{type:"string"}}}},cg={description:(0,Rt.Ij)(2599,"Contributes views to the editor"),type:"object",properties:{explorer:{description:(0,Rt.Ij)(2600,"Contributes views to Explorer container in the Activity bar"),type:"array",items:dg,default:[]},debug:{description:(0,Rt.Ij)(2601,"Contributes views to Debug container in the Activity bar"),type:"array",items:dg,default:[]},scm:{description:(0,Rt.Ij)(2602,"Contributes views to SCM container in the Activity bar"),type:"array",items:dg,default:[]},test:{description:(0,Rt.Ij)(2603,"Contributes views to Test container in the Activity bar"),type:"array",items:dg,default:[]},remote:{description:(0,Rt.Ij)(2604,"Contributes views to Remote container in the Activity bar. To contribute to this container, the 'contribViewsRemote' API proposal must be enabled."),type:"array",items:lg,default:[]}},additionalProperties:{description:(0,Rt.Ij)(2605,"Contributes views to contributed views container"),type:"array",items:dg,default:[]}},hg=Qt.i.registerExtensionPoint({extensionPoint:"viewsContainers",jsonSchema:ag}),ug=Qt.i.registerExtensionPoint({extensionPoint:"views",deps:[hg],jsonSchema:cg,activationEventsGenerator:function*(e){for(let t of e)for(let e of Object.values(t))for(let t of e)t.id&&(yield"onView:".concat(t.id))}}),gg=(Ee=class{constructor(e,t){this.instantiationService=e,this.logService=t,this.viewContainersRegistry=Rt._b.as(Wt.gf.ViewContainersRegistry),this.viewsRegistry=Rt._b.as(Wt.gf.ViewsRegistry),this.handleAndRegisterCustomViewContainers(),this.handleAndRegisterCustomViews()}handleAndRegisterCustomViewContainers(){hg.setHandler((e,t)=>{let{added:i,removed:o}=t;o.length&&this.removeCustomViewContainers(o),i.length&&this.addCustomViewContainers(i,this.viewContainersRegistry.all)})}addCustomViewContainers(e,t){let i=Rt._b.as(Wt.gf.ViewContainersRegistry),o=7+i.all.filter(e=>!!e.extensionId&&i.getViewContainerLocation(e)===Wt.Sf.Sidebar).length,s=5+i.all.filter(e=>!!e.extensionId&&i.getViewContainerLocation(e)===Wt.Sf.Panel).length+1,r=100+i.all.filter(e=>!!e.extensionId&&i.getViewContainerLocation(e)===Wt.Sf.AuxiliaryBar).length+1;for(let{value:n,collector:a,description:d}of e)Object.entries(n).forEach(e=>{let[i,n]=e;if(this.isValidViewsContainer(n,a))switch(i){case"activitybar":o=this.registerCustomViewContainers(n,d,o,t,Wt.Sf.Sidebar);break;case"panel":s=this.registerCustomViewContainers(n,d,s,t,Wt.Sf.Panel);break;case"secondarySidebar":r=this.registerCustomViewContainers(n,d,r,t,Wt.Sf.AuxiliaryBar)}})}removeCustomViewContainers(e){let t=Rt._b.as(Wt.gf.ViewContainersRegistry),i=e.reduce((e,t)=>(e.add(t.description.identifier),e),new Nt.dr);for(let o of t.all)if(o.extensionId&&i.has(o.extensionId)){let e=this.viewsRegistry.getViews(o);e.length&&this.viewsRegistry.moveViews(e,this.getDefaultViewContainer()),this.deregisterCustomViewContainer(o)}}isValidViewsContainer(e,t){if(!Array.isArray(e))return t.error((0,Rt.Ij)(2606,"views containers must be an array")),!1;for(let i of e){if("string"!=typeof i.id&&(0,Rt.lk)(i.id)||!/^[a-z0-9_-]+$/i.test(i.id))return t.error((0,Rt.Ij)(2607,"property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if("string"!=typeof i.title)return t.error((0,Rt.Ij)(2608,"property `{0}` is mandatory and must be of type `string`","title")),!1;if("string"!=typeof i.icon)return t.error((0,Rt.Ij)(2608,"property `{0}` is mandatory and must be of type `string`","icon")),!1;if((0,Rt.lk)(i.title))return t.warn((0,Rt.Ij)(2609,"property `{0}` is mandatory and must be of type `string` with non-empty value","title")),!0}return!0}registerCustomViewContainers(e,t,i,o,s){return e.forEach(e=>{let r=Rt.Eb.fromString(e.icon)||(0,Rt.lT)(t.extensionLocation,e.icon),n="workbench.view.extension.".concat(e.id),a=e.title||n,d=this.registerCustomViewContainer(n,a,r,i++,t.identifier,s);if(o.length){let t=[];for(let i of o)d!==i&&t.push(...this.viewsRegistry.getViews(i).filter(t=>t.originalContainerId===e.id));t.length&&this.viewsRegistry.moveViews(t,d)}}),i}registerCustomViewContainer(e,t,i,o,s,r){let n=this.viewContainersRegistry.get(e);return n||(n=this.viewContainersRegistry.registerViewContainer({id:e,title:{value:t,original:t},extensionId:s,ctorDescriptor:new Rt.om(Wt.P,[e,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,order:o,icon:i},r)),n}deregisterCustomViewContainer(e){this.viewContainersRegistry.deregisterViewContainer(e),Rt._b.as(ei).deregisterPaneComposite(e.id)}handleAndRegisterCustomViews(){ug.setHandler((e,t)=>{let{added:i,removed:o}=t;o.length&&this.removeViews(o),i.length&&this.addViews(i)})}addViews(e){let t=new Set,i=[];for(let o of e){let{value:e,collector:s}=o;Object.entries(e).forEach(e=>{let[r,n]=e;if(!this.isValidViewDescriptors(n,s))return;if("remote"===r&&!(0,Ot.F)(o.description,"contribViewsRemote"))return void s.warn((0,Rt.Ij)(2610,"View container '{0}' requires 'enabledApiProposals: [\"contribViewsRemote\"]' to be added to 'Remote'.",r));if("agentSessions"===r&&!(0,Ot.F)(o.description,"chatSessionsProvider"))return void s.warn((0,Rt.Ij)(2611,"View container '{0}' requires 'enabledApiProposals: [\"chatSessionsProvider\"]'.",r));let a=this.getViewContainer(r);a||s.warn((0,Rt.Ij)(2612,"View container '{0}' does not exist and all views registered to it will be added to 'Explorer'.",r));let d=a||this.getDefaultViewContainer(),l=[];for(let i=0;i<n.length;i++){var c;let e=n[i];if(t.has(e.id)){s.error((0,Rt.Ij)(2613,"Cannot register multiple views with same id `{0}`",e.id));continue}if(null!==this.viewsRegistry.getView(e.id)){s.error((0,Rt.Ij)(2614,"A view with id `{0}` is already registered.",e.id));continue}let h,u=Nt.lr.equals(o.description.identifier,d.extensionId)?i+1:d.viewOrderDelegate?d.viewOrderDelegate.getOrder(e.group):void 0;"string"==typeof e.icon&&(h=Rt.Eb.fromString(e.icon)||(0,Rt.lT)(o.description.extensionLocation,e.icon));let g,p,b=this.convertInitialVisibility(e.visibility),m=this.getViewType(e.type);if(!m){s.error((0,Rt.Ij)(2615,"Unknown view type `{0}`.",e.type));continue}"number"==typeof e.initialSize&&((null===(c=d.extensionId)||void 0===c?void 0:c.value)===o.description.identifier.value?g=e.initialSize:this.logService.warn("".concat(o.description.identifier.value," tried to set the view size of ").concat(e.id," but it was ignored because the view container does not belong to it."))),(0,Ot.F)(o.description,"contribAccessibilityHelpContent")&&e.accessibilityHelpContent&&(p=new Rt.Pc(e.accessibilityHelpContent));let v={type:m,ctorDescriptor:m===sg.Tree?new Rt.om(kh):new Rt.om(og),id:e.id,name:{value:e.name,original:e.name},when:Rt.PO.deserialize(e.when),containerIcon:h||(null===a||void 0===a?void 0:a.icon),containerTitle:e.contextualTitle||a&&("string"==typeof a.title?a.title:a.title.value),canToggleVisibility:!0,canMoveView:(null===a||void 0===a?void 0:a.id)!==Hu,treeView:m===sg.Tree?this.instantiationService.createInstance(Bh,e.id,e.name,o.description.identifier.value):void 0,collapsed:this.showCollapsed(d)||b===rg.Collapsed,order:u,extensionId:o.description.identifier,originalContainerId:r,group:e.group,remoteAuthority:e.remoteName||e.remoteAuthority,virtualWorkspace:e.virtualWorkspace,hideByDefault:b===rg.Hidden,workspace:"workbench.view.remote"===(null===a||void 0===a?void 0:a.id)||void 0,weight:g,accessibilityHelpContent:p};t.add(v.id),l.push(v)}i.push({viewContainer:d,views:l})})}this.viewsRegistry.registerViews2(i)}getViewType(e){return e===sg.Webview?sg.Webview:e&&e!==sg.Tree?void 0:sg.Tree}getDefaultViewContainer(){return this.viewContainersRegistry.get(Xt.c)}removeViews(e){let t=e.reduce((e,t)=>(e.add(t.description.identifier),e),new Nt.dr);for(let i of this.viewContainersRegistry.all){let e=this.viewsRegistry.getViews(i).filter(e=>e.extensionId&&t.has(e.extensionId));if(e.length){this.viewsRegistry.deregisterViews(e,i);for(let t of e){let e=t;e.treeView&&e.treeView.dispose()}}}}convertInitialVisibility(e){if(Object.values(rg).includes(e))return e}isValidViewDescriptors(e,t){if(!Array.isArray(e))return t.error((0,Rt.Ij)(2616,"views must be an array")),!1;for(let i of e){if("string"!=typeof i.id)return t.error((0,Rt.Ij)(2608,"property `{0}` is mandatory and must be of type `string`","id")),!1;if("string"!=typeof i.name)return t.error((0,Rt.Ij)(2608,"property `{0}` is mandatory and must be of type `string`","name")),!1;if(i.when&&"string"!=typeof i.when)return t.error((0,Rt.Ij)(2617,"property `{0}` can be omitted or must be of type `string`","when")),!1;if(i.icon&&"string"!=typeof i.icon)return t.error((0,Rt.Ij)(2617,"property `{0}` can be omitted or must be of type `string`","icon")),!1;if(i.contextualTitle&&"string"!=typeof i.contextualTitle)return t.error((0,Rt.Ij)(2617,"property `{0}` can be omitted or must be of type `string`","contextualTitle")),!1;if(i.visibility&&!this.convertInitialVisibility(i.visibility))return t.error((0,Rt.Ij)(2618,"property `{0}` can be omitted or must be one of {1}","visibility",Object.values(rg).join(", "))),!1}return!0}getViewContainer(e){switch(e){case"explorer":return this.viewContainersRegistry.get(Xt.c);case"debug":return this.viewContainersRegistry.get(Wt.mf);case"scm":return this.viewContainersRegistry.get(Wt.Kg);case"remote":return this.viewContainersRegistry.get(Hu);default:return this.viewContainersRegistry.get("workbench.view.extension.".concat(e))}}showCollapsed(e){switch(e.id){case Xt.c:case Wt.Kg:case Wt.mf:return!0}return!1}},{_:Ee.ID="workbench.contrib.viewsExtensionHandler"},Ee);gg=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Rt.eb)],gg);var pg=class extends Rt.CA{constructor(){super(...arguments),this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.viewsContainers)}render(e){var t;let i=(null===(t=e.contributes)||void 0===t?void 0:t.viewsContainers)||{},o=Object.keys(i).reduce((e,t)=>{let o=i[t];return e.push(...o.map(e=>(0,xt.A)((0,xt.A)({},e),{},{location:t}))),e},[]);return o.length?{data:{headers:[(0,Rt.Ij)(2619,"ID"),(0,Rt.Ij)(2620,"Title"),(0,Rt.Ij)(2621,"Where")],rows:o.sort((e,t)=>e.id.localeCompare(t.id)).map(e=>[e.id,e.title,e.location])},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}},bg=class extends Rt.CA{constructor(){super(...arguments),this.type="table"}shouldRender(e){var t;return!(null===(t=e.contributes)||void 0===t||!t.views)}render(e){var t;let i=(null===(t=e.contributes)||void 0===t?void 0:t.views)||{},o=Object.keys(i).reduce((e,t)=>{let o=i[t];return e.push(...o.map(e=>(0,xt.A)((0,xt.A)({},e),{},{location:t}))),e},[]);return o.length?{data:{headers:[(0,Rt.Ij)(2622,"ID"),(0,Rt.Ij)(2623,"Name"),(0,Rt.Ij)(2621,"Where")],rows:o.sort((e,t)=>e.id.localeCompare(t.id)).map(e=>[e.id,e.name,e.location])},dispose:()=>{}}:{data:{headers:[],rows:[]},dispose:()=>{}}}};Rt._b.as(Qt.t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"viewsContainers",label:(0,Rt.Ij)(2624,"View Containers"),access:{canToggle:!1},renderer:new Rt.om(pg)}),Rt._b.as(Qt.t.ExtensionFeaturesRegistry).registerExtensionFeature({id:"views",label:(0,Rt.Ij)(2625,"Views"),access:{canToggle:!1},renderer:new Rt.om(bg)}),(0,Pt.x)(gg.ID,gg,Pt.y.BlockStartup),(0,Rt.Fj)(),(0,Rt.nM)(),(0,Zt.h)(),(0,Rt.bb)(),(0,Rt.iT)(),(0,Lt.mi)(),(0,Rt.pv)();var mg=class extends Ho{constructor(){super(...arguments),this.editorControl=void 0}get scopedContextKeyService(){var e;return null===(e=this.editorControl)||void 0===e?void 0:e.invokeWithinContext(e=>e.get(Rt.yb))}getTitle(){return this.input?this.input.getName():(0,Rt.Ij)(3508,"Text Editor")}createEditorControl(e,t){this.editorControl=this._register(this.instantiationService.createInstance(Lt.pi,e,t,this.getCodeEditorWidgetOptions()))}getCodeEditorWidgetOptions(){return Object.create(null)}updateEditorControlOptions(e){var t;null===(t=this.editorControl)||void 0===t||t.updateOptions(e)}getMainControl(){return this.editorControl}getControl(){return this.editorControl}computeEditorViewState(e){var t;if(!this.editorControl)return;let i=this.editorControl.getModel();if(!i)return;let o=i.uri;return o&&(0,Rt.oT)(o,e)&&null!==(t=this.editorControl.saveViewState())&&void 0!==t?t:void 0}setOptions(e){super.setOptions(e),e&&(0,Zt.m)(e,(0,Rt.$j)(this.editorControl),Rt.fv.Smooth)}focus(){var e;super.focus(),null===(e=this.editorControl)||void 0===e||e.focus()}hasFocus(){var e;return(null===(e=this.editorControl)||void 0===e?void 0:e.hasTextFocus())||super.hasFocus()}setEditorVisible(e){var t,i;super.setEditorVisible(e),e?null===(t=this.editorControl)||void 0===t||t.onVisible():null===(i=this.editorControl)||void 0===i||i.onHide()}layout(e){var t;null===(t=this.editorControl)||void 0===t||t.layout(e)}};(0,Rt.Ib)(),(0,Rt.nM)(),(0,Pt.en)(),(0,Zt.h)(),(0,Lt._)(),(0,Pt.yt)(),(0,Rt.ab)(),(0,Rt.Wo)(),(0,Rt._v)(),(0,Rt.Kb)(),(0,Rt.$d)(),(0,Rt.pv)(),(0,Pt.G)(),(0,Pt.At)(),(0,Rt.Bb)(),(0,Rt.lv)(),(0,Rt.C_)(),(0,Rt.EO)(),(0,Rt.uy)(),(0,Rt.bs)();var vg,Cg=class extends mg{constructor(e,t,i,o,s,r,n,a,d,l){super(e,t,i,o,s,r,n,d,a,l)}async setInput(e,t,i,o){await super.setInput(e,t,i,o);let s=await e.resolve();if(o.isCancellationRequested)return;if(!(s instanceof Pt.vt))throw Error("Unable to open file as text");let r=(0,Rt.$j)(this.editorControl),n=s.textEditorModel;if(r.setModel(n),!(0,Pt.hn)(null===t||void 0===t?void 0:t.viewState)){let o=this.loadEditorViewState(e,i);o&&(null!==t&&void 0!==t&&t.selection&&(o.cursorState=[]),r.restoreViewState(o))}t&&(0,Zt.m)(t,r,Rt.fv.Immediate),r.updateOptions(this.getReadonlyConfiguration(s.isReadonly()))}revealLastLine(){let e=this.editorControl;if(!e)return;let t=e.getModel();if(t){let i=t.getLineCount();e.revealPosition({lineNumber:i,column:t.getLineMaxColumn(i)},Rt.fv.Smooth)}}clearInput(){var e;super.clearInput(),null===(e=this.editorControl)||void 0===e||e.setModel(null)}tracksEditorViewState(e){return e instanceof zt.l||e instanceof Lt.g}};Cg=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.ib),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Rt.Uo),(0,Rt.Fb)(5,Rt.hv),(0,Rt.Fb)(6,Rt.Qd),(0,Rt.Fb)(7,Pt.W),(0,Rt.Fb)(8,Pt.kt),(0,Rt.Fb)(9,Rt.ys)],Cg);var wg=(Ae=class extends Cg{constructor(e,t,i,o,s,r,n,a,d,l,c){super(vg.ID,e,t,i,o,s,r,a,n,c),this.modelService=d,this.languageService=l}createEditorControl(e,t){super.createEditorControl(e,t);let i=this.editorControl;i&&this._register(i.onDidPaste(e=>this.onDidEditorPaste(e,i)))}onDidEditorPaste(e,t){if(this.input instanceof zt.l&&this.input.hasLanguageSetExplicitly||1!==e.range.startLineNumber||1!==e.range.startColumn||t.getOption(Rt.lO.readOnly))return;let i,o=t.getModel();if(o&&o.getLineCount()===e.range.endLineNumber&&o.getLineMaxColumn(e.range.endLineNumber)===e.range.endColumn&&"plaintext"===o.getLanguageId()){if(e.languageId)i={id:e.languageId,source:"event"};else{var s;let e=null!==(s=this.languageService.guessLanguageIdByFilepathOrFirstLine(o.uri,o.getLineContent(1).substr(0,Rt.iy.FIRST_LINE_DETECTION_LENGTH_LIMIT)))&&void 0!==s?s:void 0;e&&(i={id:e,source:"guess"})}if(i&&"plaintext"!==i.id){this.input instanceof zt.l&&"event"===i.source?this.input.setLanguageId(i.id):o.setLanguage(this.languageService.createById(i.id));let e=this.modelService.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget);o.detectIndentation(e.insertSpaces,e.tabSize)}}}},{_:vg=Ae},{_:Ae.ID="workbench.editors.textResourceEditor"},Ae);wg=vg=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Rt.Uo),(0,Rt.Fb)(4,Rt.hv),(0,Rt.Fb)(5,Rt.Qd),(0,Rt.Fb)(6,Pt.kt),(0,Rt.Fb)(7,Pt.W),(0,Rt.Fb)(8,Rt.zb),(0,Rt.Fb)(9,Rt.cv),(0,Rt.Fb)(10,Rt.ys)],wg),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.gA)(),(0,Rt.Wo)(),(0,Rt.ac)();var yg=class extends Ji{constructor(e,t,i,o,s,r){super(e,t,o,s,r),this.callbacks=i,this._onDidChangeMetadata=this._register(new Rt.uA),this.onDidChangeMetadata=this._onDidChangeMetadata.event,this._onDidOpenInPlace=this._register(new Rt.uA),this.onDidOpenInPlace=this._onDidOpenInPlace.event}getTitle(){return this.input?this.input.getName():(0,Rt.Ij)(3053,"Binary Viewer")}async getContents(e,t){let i=await e.resolve();if(!(i instanceof zt.r))throw Error("Unable to open file as binary");let o=i.getSize();return this.handleMetadataChanged("number"==typeof o?Rt.Ss.formatSize(o):""),{icon:"$(warning)",label:(0,Rt.Ij)(3054,"The file is not displayed in the text editor because it is either binary or uses an unsupported text encoding."),actions:[{label:(0,Rt.Ij)(3055,"Open Anyway"),run:async()=>{await this.callbacks.openInternal(e,t),this._onDidOpenInPlace.fire()}}]}}handleMetadataChanged(e){this.metadata=e,this._onDidChangeMetadata.fire()}getMetadata(){return this.metadata}};yg=(0,Rt.Pb)([(0,Rt.Fb)(5,Rt.Uo)],yg),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Pt.en)(),(0,Rt.ab)(),(0,Rt.$d)(),(0,Rt.Kb)(),(0,Rt.Wo)(),(0,Rt.s_)(),(0,Rt._v)(),(0,Pt.G)(),(0,Pt.At)();var fg=(De=class extends zt.o{constructor(e,t,i,o,s,r,n,a,d){super(e,t,i,o,s,r,n,a,d)}getMetadata(){let e=this.getPrimaryEditorPane(),t=this.getSecondaryEditorPane();if(e instanceof yg&&t instanceof yg)return(0,Rt.Ij)(3052,"{0} \u2194 {1}",t.getMetadata(),e.getMetadata())}},{_:De.ID=Pt.Nt},De);fg=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Rt.Qd),(0,Rt.Fb)(4,Rt.Uo),(0,Rt.Fb)(5,Rt.o_),(0,Rt.Fb)(6,Rt.hv),(0,Rt.Fb)(7,Pt.kt),(0,Rt.Fb)(8,Pt.W)],fg);var Sg;(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.qx)(),(0,Rt.ok)(),(0,Rt.iT)(),(0,Rt.nM)(),(0,Rt.TD)(),(0,Rt.Mb)(),(0,Rt.mj)(),(0,Pt.en)(),(0,Rt.PA)(),(0,Rt.uy)(),(0,Wt.lg)(),(0,Tt.Jt)(),(0,Pt.At)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.Kb)(),(0,Rt.lv)(),(0,Rt.xD)(),(0,Rt.yD)(),(0,Rt.Sb)(),(0,Rt.wb)(),(0,Bt.o)(),(0,Pt.h)(),(0,Pt.D)(),(0,Nt.p)(),(0,Rt.EO)(),(0,Rt._v)(),(0,Rt.Q_)(),(0,Rt.s_)(),(0,Rt.qj)(),(0,Gt.o)(),(0,Rt.yT)(),(0,jt.i)(),(0,Rt.Sc)(),(0,Mt.o)(),(0,Rt.Iw)(),(0,Rt.gA)(),(0,Wt.Sx)(),(0,Wt.vx)(),(0,Rt.Er)(),(0,Rt.Sr)(),(0,Rt.ab)(),(0,Pt.Ot)(),(0,Pt.Ct)(),(0,Pt.xt)(),(0,Rt.IO)(),(0,Rt.db)(),(0,Rt.gb)(),(0,Rt.tO)(),(0,Lt.Ra)(),(0,Pt.G)(),(0,Lt.Pa)(),(0,Rt.Ll)(),(0,Rt.mE)({});var Ig=class{constructor(e,t){this.primary=e,this.secondary=t}getEncoding(){return this.primary.getEncoding()}async setEncoding(e,t){await Rt.yw.settled([this.primary,this.secondary].map(i=>i.setEncoding(e,t)))}},kg=class{constructor(e,t){this.primary=e,this.secondary=t}setLanguageId(e,t){[this.primary,this.secondary].forEach(i=>i.setLanguageId(e,t))}};function _g(e){if(e instanceof zt.l)return e;if(e instanceof Pt.Et){let t=_g(e.primary),i=_g(e.secondary);return t&&i?new Ig(t,i):t}let t=e;return(0,Rt.Zj)(t.setEncoding,t.getEncoding)?t:null}function Eg(e){if(e instanceof zt.l)return e;if(e instanceof Pt.Et){let t=Eg(e.primary),i=Eg(e.secondary);return t&&i?new kg(t,i):t}let t=e;return"function"==typeof t.setLanguageId?t:null}var Ag=class{constructor(){this.indentation=!1,this.selectionStatus=!1,this.languageId=!1,this.languageStatus=!1,this.encoding=!1,this.EOL=!1,this.tabFocusMode=!1,this.inputMode=!1,this.columnSelectionMode=!1,this.metadata=!1}combine(e){this.indentation=this.indentation||e.indentation,this.selectionStatus=this.selectionStatus||e.selectionStatus,this.languageId=this.languageId||e.languageId,this.languageStatus=this.languageStatus||e.languageStatus,this.encoding=this.encoding||e.encoding,this.EOL=this.EOL||e.EOL,this.tabFocusMode=this.tabFocusMode||e.tabFocusMode,this.inputMode=this.inputMode||e.inputMode,this.columnSelectionMode=this.columnSelectionMode||e.columnSelectionMode,this.metadata=this.metadata||e.metadata}hasChanges(){return this.indentation||this.selectionStatus||this.languageId||this.languageStatus||this.encoding||this.EOL||this.tabFocusMode||this.inputMode||this.columnSelectionMode||this.metadata}},Dg=class{get selectionStatus(){return this._selectionStatus}get languageId(){return this._languageId}get encoding(){return this._encoding}get EOL(){return this._EOL}get indentation(){return this._indentation}get tabFocusMode(){return this._tabFocusMode}get inputMode(){return this._inputMode}get columnSelectionMode(){return this._columnSelectionMode}get metadata(){return this._metadata}update(e){let t=new Ag;switch(e.type){case"selectionStatus":this._selectionStatus!==e.selectionStatus&&(this._selectionStatus=e.selectionStatus,t.selectionStatus=!0);break;case"indentation":this._indentation!==e.indentation&&(this._indentation=e.indentation,t.indentation=!0);break;case"languageId":this._languageId!==e.languageId&&(this._languageId=e.languageId,t.languageId=!0);break;case"encoding":this._encoding!==e.encoding&&(this._encoding=e.encoding,t.encoding=!0);break;case"EOL":this._EOL!==e.EOL&&(this._EOL=e.EOL,t.EOL=!0);break;case"tabFocusMode":this._tabFocusMode!==e.tabFocusMode&&(this._tabFocusMode=e.tabFocusMode,t.tabFocusMode=!0);break;case"inputMode":this._inputMode!==e.inputMode&&(this._inputMode=e.inputMode,t.inputMode=!0);break;case"columnSelectionMode":this._columnSelectionMode!==e.columnSelectionMode&&(this._columnSelectionMode=e.columnSelectionMode,t.columnSelectionMode=!0);break;case"metadata":this._metadata!==e.metadata&&(this._metadata=e.metadata,t.metadata=!0)}return t}},xg=class extends Rt.CA{constructor(e){super(),this.configurationService=e,this._onDidChange=this._register(new Rt.uA),this.onDidChange=this._onDidChange.event,this.registerListeners();let t=!0===e.getValue("editor.tabFocusMode");Lt.La.setTabFocusMode(t)}registerListeners(){this._register(Lt.La.onDidChangeTabFocus(e=>this._onDidChange.fire(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>{if(e.affectsConfiguration("editor.tabFocusMode")){let e=!0===this.configurationService.getValue("editor.tabFocusMode");Lt.La.setTabFocusMode(e),this._onDidChange.fire(e)}}))}};xg=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.o_)],xg);var Vg=class extends Rt.CA{constructor(){super(),this._onDidChange=this._register(new Rt.uA),this.onDidChange=this._onDidChange.event,Lt.Na.setInputMode("insert"),this._register(Lt.Na.onDidChangeInputMode(e=>this._onDidChange.fire(e)))}},Rg=(0,Rt.Ij)(3444,"Ln {0}, Col {1} ({2} selected)"),Tg=(0,Rt.Ij)(3445,"Ln {0}, Col {1}"),Lg=(0,Rt.Ij)(3446,"{0} selections ({1} characters selected)"),Wg=(0,Rt.Ij)(3447,"{0} selections"),Fg=(0,Rt.Ij)(3448,"LF"),Gg=(0,Rt.Ij)(3449,"CRLF"),Zg=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a){super(),this.targetWindowId=e,this.editorService=t,this.quickInputService=i,this.languageService=o,this.textFileService=s,this.statusbarService=r,this.configurationService=a,this.tabFocusModeElement=this._register(new Rt.OA),this.inputModeElement=this._register(new Rt.OA),this.columnSelectionModeElement=this._register(new Rt.OA),this.indentationElement=this._register(new Rt.OA),this.selectionElement=this._register(new Rt.OA),this.encodingElement=this._register(new Rt.OA),this.eolElement=this._register(new Rt.OA),this.languageElement=this._register(new Rt.OA),this.metadataElement=this._register(new Rt.OA),this.state=new Dg,this.toRender=void 0,this.activeEditorListeners=this._register(new Rt.EA),this.delayedRender=this._register(new Rt.OA),this.currentMarkerStatus=this._register(n.createInstance(Pg)),this.tabFocusMode=this._register(n.createInstance(xg)),this.inputMode=this._register(n.createInstance(Vg)),this.registerCommands(),this.registerListeners()}registerListeners(){this._register(this.editorService.onDidActiveEditorChange(()=>this.updateStatusBar())),this._register(this.textFileService.untitled.onDidChangeEncoding(e=>this.onResourceEncodingChange(e.resource))),this._register(this.textFileService.files.onDidChangeEncoding(e=>this.onResourceEncodingChange(e.resource))),this._register(Rt.dA.runAndSubscribe(this.tabFocusMode.onDidChange,e=>{void 0===e?this.onTabFocusModeChange(this.configurationService.getValue("editor.tabFocusMode")):this.onTabFocusModeChange(e)})),this._register(Rt.dA.runAndSubscribe(this.inputMode.onDidChange,e=>this.onInputModeChange(null!==e&&void 0!==e?e:"insert")))}registerCommands(){this._register(Rt.xb.registerCommand({id:"changeEditorIndentation".concat(this.targetWindowId),handler:()=>this.showIndentationPicker()}))}async showIndentationPicker(){var e,t;let i=(0,Gt.i)(this.editorService.activeTextEditorControl);if(!i)return this.quickInputService.pick([{label:(0,Rt.Ij)(3450,"No text editor active at this time")}]);if(null!==(e=this.editorService.activeEditor)&&void 0!==e&&e.isReadonly())return this.quickInputService.pick([{label:(0,Rt.Ij)(3451,"The active code editor is read-only.")}]);let o=[(0,Rt.$j)(i.getAction(Tt.Wt.ID)),(0,Rt.$j)(i.getAction(Tt.Gt.ID)),(0,Rt.$j)(i.getAction(Tt.Ht.ID)),(0,Rt.$j)(i.getAction(Tt.Ut.ID)),(0,Rt.$j)(i.getAction(Tt.Kt.ID)),(0,Rt.$j)(i.getAction(Tt.qt.ID)),(0,Rt.$j)(i.getAction(Wt.cg.ID))].map(e=>({id:e.id,label:e.label,detail:Rt.lj.isDefaultVariant()||e.label===e.alias?void 0:e.alias,run:()=>{i.focus(),e.run()}}));return o.splice(3,0,{type:"separator",label:(0,Rt.Ij)(3452,"convert file")}),o.unshift({type:"separator",label:(0,Rt.Ij)(3453,"change view")}),null===(t=await this.quickInputService.pick(o,{placeHolder:(0,Rt.Ij)(3454,"Select Action"),matchOnDetail:!0}))||void 0===t?void 0:t.run()}updateTabFocusModeElement(e){if(e){if(!this.tabFocusModeElement.value){let e=(0,Rt.Ij)(3455,"Tab Moves Focus");this.tabFocusModeElement.value=this.statusbarService.addEntry({name:(0,Rt.Ij)(3456,"Accessibility Mode"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3457,"Disable Accessibility Mode"),command:"editor.action.toggleTabFocusMode",kind:"prominent"},"status.editor.tabFocusMode",Wt.bx.RIGHT,100.7)}}else this.tabFocusModeElement.clear()}updateInputModeElement(e){if("overtype"===e){if(!this.inputModeElement.value){let e=(0,Rt.Ij)(3458,"OVR"),t=(0,Rt.Ij)(3459,"Enable Insert Mode");this.inputModeElement.value=this.statusbarService.addEntry({name:t,text:e,ariaLabel:e,tooltip:t,command:"editor.action.toggleOvertypeInsertMode",kind:"prominent"},"status.editor.inputMode",Wt.bx.RIGHT,100.6)}}else this.inputModeElement.clear()}updateColumnSelectionModeElement(e){if(e){if(!this.columnSelectionModeElement.value){let e=(0,Rt.Ij)(3460,"Column Selection");this.columnSelectionModeElement.value=this.statusbarService.addEntry({name:(0,Rt.Ij)(3461,"Column Selection Mode"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3462,"Disable Column Selection Mode"),command:"editor.action.toggleColumnSelection",kind:"prominent"},"status.editor.columnSelectionMode",Wt.bx.RIGHT,100.8)}}else this.columnSelectionModeElement.clear()}updateSelectionElement(e){var t;if(!e)return void this.selectionElement.clear();if((null===(t=(0,Gt.i)(this.editorService.activeTextEditorControl))||void 0===t||null===(t=t.getModel())||void 0===t||null===(t=t.uri)||void 0===t?void 0:t.scheme)===Rt.vT.vscodeNotebookCell)return void this.selectionElement.clear();let i={name:(0,Rt.Ij)(3463,"Editor Selection"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3464,"Go to Line/Column"),command:"workbench.action.gotoLine"};this.updateElement(this.selectionElement,i,"status.editor.selection",Wt.bx.RIGHT,100.5)}updateIndentationElement(e){var t;if(!e)return void this.indentationElement.clear();if((null===(t=(0,Gt.i)(this.editorService.activeTextEditorControl))||void 0===t||null===(t=t.getModel())||void 0===t||null===(t=t.uri)||void 0===t?void 0:t.scheme)===Rt.vT.vscodeNotebookCell)return void this.indentationElement.clear();let i={name:(0,Rt.Ij)(3465,"Editor Indentation"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3466,"Select Indentation"),command:"changeEditorIndentation".concat(this.targetWindowId)};this.updateElement(this.indentationElement,i,"status.editor.indentation",Wt.bx.RIGHT,100.4)}updateEncodingElement(e){if(!e)return void this.encodingElement.clear();let t={name:(0,Rt.Ij)(3467,"Editor Encoding"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3468,"Select Encoding"),command:"workbench.action.editor.changeEncoding"};this.updateElement(this.encodingElement,t,"status.editor.encoding",Wt.bx.RIGHT,100.3)}updateEOLElement(e){if(!e)return void this.eolElement.clear();let t={name:(0,Rt.Ij)(3469,"Editor End of Line"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3470,"Select End of Line Sequence"),command:"workbench.action.editor.changeEOL"};this.updateElement(this.eolElement,t,"status.editor.eol",Wt.bx.RIGHT,100.2)}updateLanguageIdElement(e){if(!e)return void this.languageElement.clear();let t={name:(0,Rt.Ij)(3471,"Editor Language"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3472,"Select Language Mode"),command:"workbench.action.editor.changeLanguageMode"};this.updateElement(this.languageElement,t,"status.editor.mode",Wt.bx.RIGHT,100.1)}updateMetadataElement(e){if(!e)return void this.metadataElement.clear();let t={name:(0,Rt.Ij)(3473,"File Information"),text:e,ariaLabel:e,tooltip:(0,Rt.Ij)(3474,"File Information")};this.updateElement(this.metadataElement,t,"status.editor.info",Wt.bx.RIGHT,100)}updateElement(e,t,i,o,s){e.value?e.value.update(t):e.value=this.statusbarService.addEntry(t,i,o,s)}updateState(e){let t=this.state.update(e);t.hasChanges()&&(this.toRender?this.toRender.combine(t):(this.toRender=t,this.delayedRender.value=(0,Rt.bS)((0,Rt.Vx)(this.targetWindowId,!0).window,()=>{this.delayedRender.clear();let e=this.toRender;this.toRender=void 0,e&&this.doRenderNow()})))}doRenderNow(){this.updateTabFocusModeElement(!!this.state.tabFocusMode),this.updateInputModeElement(this.state.inputMode),this.updateColumnSelectionModeElement(!!this.state.columnSelectionMode),this.updateIndentationElement(this.state.indentation),this.updateSelectionElement(this.state.selectionStatus),this.updateEncodingElement(this.state.encoding),this.updateEOLElement(this.state.EOL?"\r\n"===this.state.EOL?Gg:Fg:void 0),this.updateLanguageIdElement(this.state.languageId),this.updateMetadataElement(this.state.metadata)}getSelectionLabel(e){if(null!==e&&void 0!==e&&e.selections){if(1===e.selections.length)return e.charactersSelected?(0,Rt.$O)(Rg,e.selections[0].positionLineNumber,e.selections[0].positionColumn,e.charactersSelected):(0,Rt.$O)(Tg,e.selections[0].positionLineNumber,e.selections[0].positionColumn);if(e.charactersSelected)return(0,Rt.$O)(Lg,e.selections.length,e.charactersSelected);if(e.selections.length>0)return(0,Rt.$O)(Wg,e.selections.length)}}updateStatusBar(){var e;let t=this.editorService.activeEditor,i=this.editorService.activeEditorPane,o=i&&null!==(e=(0,Gt.i)(i.getControl()))&&void 0!==e?e:void 0;if(this.onColumnSelectionModeChange(o),this.onSelectionChange(o),this.onLanguageChange(o,t),this.onEOLChange(o),this.onEncodingChange(i,o),this.onIndentationChange(o),this.onMetadataChange(i),this.currentMarkerStatus.update(o),this.activeEditorListeners.clear(),i&&this.activeEditorListeners.add(i.onDidChangeControl(()=>{this.updateStatusBar()})),o)this.activeEditorListeners.add(o.onDidChangeConfiguration(e=>{e.hasChanged(Rt.lO.columnSelection)&&this.onColumnSelectionModeChange(o)})),this.activeEditorListeners.add(Rt.dA.defer(o.onDidChangeCursorPosition)(()=>{this.onSelectionChange(o),this.currentMarkerStatus.update(o)})),this.activeEditorListeners.add(o.onDidChangeModelLanguage(()=>{this.onLanguageChange(o,t)})),this.activeEditorListeners.add(Rt.dA.accumulate(o.onDidChangeModelContent)(e=>{this.onEOLChange(o),this.currentMarkerStatus.update(o);let t=o.getSelections();if(t)for(let i of e)for(let e of i.changes)if(t.some(t=>Rt.bD.areIntersecting(t,e.range))){this.onSelectionChange(o);break}})),this.activeEditorListeners.add(o.onDidChangeModelOptions(()=>{this.onIndentationChange(o)}));else if(i instanceof yg||i instanceof fg){let e=[];if(i instanceof fg){let t=i.getPrimaryEditorPane();t instanceof yg&&e.push(t);let o=i.getSecondaryEditorPane();o instanceof yg&&e.push(o)}else e.push(i);for(let t of e)this.activeEditorListeners.add(t.onDidChangeMetadata(()=>{this.onMetadataChange(i)})),this.activeEditorListeners.add(t.onDidOpenInPlace(()=>{this.updateStatusBar()}))}}onLanguageChange(e,t){let i={type:"languageId",languageId:void 0};if(e&&t&&Eg(t)){let t=e.getModel();if(t){var o;let e=t.getLanguageId();i.languageId=null!==(o=this.languageService.getLanguageName(e))&&void 0!==o?o:void 0}}this.updateState(i)}onIndentationChange(e){let t={type:"indentation",indentation:void 0};if(e){let i=e.getModel();if(i){let e=i.getOptions();t.indentation=e.insertSpaces?e.tabSize===e.indentSize?(0,Rt.Ij)(3475,"Spaces: {0}",e.indentSize):(0,Rt.Ij)(3476,"Spaces: {0} (Tab Size: {1})",e.indentSize,e.tabSize):(0,Rt.Ij)(3477,"Tab Size: {0}",e.tabSize)}}this.updateState(t)}onMetadataChange(e){let t={type:"metadata",metadata:void 0};(e instanceof yg||e instanceof fg)&&(t.metadata=e.getMetadata()),this.updateState(t)}onColumnSelectionModeChange(e){let t={type:"columnSelectionMode",columnSelectionMode:!1};null!==e&&void 0!==e&&e.getOption(Rt.lO.columnSelection)&&(t.columnSelectionMode=!0),this.updateState(t)}onSelectionChange(e){let t=Object.create(null);if(e){t.selections=e.getSelections()||[],t.charactersSelected=0;let i=e.getModel();if(i)for(let e of t.selections)"number"!=typeof t.charactersSelected&&(t.charactersSelected=0),t.charactersSelected+=i.getCharacterCountInRange(e);if(1===t.selections.length){let i=e.getPosition(),o=new Rt._D(t.selections[0].selectionStartLineNumber,t.selections[0].selectionStartColumn,t.selections[0].positionLineNumber,i?e.getStatusbarColumn(i):t.selections[0].positionColumn);t.selections[0]=o}}this.updateState({type:"selectionStatus",selectionStatus:this.getSelectionLabel(t)})}onEOLChange(e){let t={type:"EOL",EOL:void 0};if(e&&!e.getOption(Rt.lO.readOnly)){let i=e.getModel();i&&(t.EOL=i.getEOL())}this.updateState(t)}onEncodingChange(e,t){if(e&&!this.isActiveEditor(e))return;let i={type:"encoding",encoding:void 0};if(e&&null!==t&&void 0!==t&&t.hasModel()){let t=e.input?_g(e.input):null;if(t){let e=t.getEncoding(),o="string"==typeof e?Nt.d[e]:void 0;i.encoding=o?o.labelShort:e}}this.updateState(i)}onResourceEncodingChange(e){let t=this.editorService.activeEditorPane;if(t){let o=Pt.Ht.getCanonicalUri(t.input,{supportSideBySide:Pt.Jt.PRIMARY});if(o&&(0,Rt.oT)(o,e)){var i;let e=null!==(i=(0,Gt.i)(t.getControl()))&&void 0!==i?i:void 0;return this.onEncodingChange(t,e)}}}onTabFocusModeChange(e){let t={type:"tabFocusMode",tabFocusMode:e};this.updateState(t)}onInputModeChange(e){let t={type:"inputMode",inputMode:e};this.updateState(t)}isActiveEditor(e){let t=this.editorService.activeEditorPane;return!!t&&t===e}};Zg=(0,Rt.Pb)([(0,Rt.Fb)(1,Pt.kt),(0,Rt.Fb)(2,Rt.xc),(0,Rt.Fb)(3,Rt.cv),(0,Rt.Fb)(4,Pt.E),(0,Rt.Fb)(5,Wt._x),(0,Rt.Fb)(6,Rt.Ub),(0,Rt.Fb)(7,Rt.o_)],Zg);var Ng=(xe=class extends Rt.CA{constructor(e){super(),this.editorGroupService=e;for(let t of e.parts)this.createEditorStatus(t);this._register(e.onDidCreateAuxiliaryEditorPart(e=>this.createEditorStatus(e)))}createEditorStatus(e){let t=new Rt.EA;Rt.dA.once(e.onWillDispose)(()=>t.dispose());let i=this.editorGroupService.getScopedInstantiationService(e);t.add(i.createInstance(Zg,e.windowId))}},{_:xe.ID="workbench.contrib.editorStatus"},xe);Ng=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.W)],Ng);var Pg=class extends Rt.CA{constructor(e,t,i){super(),this.statusbarService=e,this.markerService=t,this.configurationService=i,this.editor=void 0,this.markers=[],this.currentMarker=null,this.statusBarEntryAccessor=this._register(new Rt.OA),this._register(t.onMarkerChanged(e=>this.onMarkerChanged(e))),this._register(Rt.dA.filter(i.onDidChangeConfiguration,e=>e.affectsConfiguration("problems.showCurrentInStatus"))(()=>this.updateStatus()))}update(e){this.editor=e,this.updateMarkers(),this.updateStatus()}updateStatus(){let e=this.currentMarker;if(this.currentMarker=this.getMarker(),this.hasToUpdateStatus(e,this.currentMarker))if(this.currentMarker){let e=(0,Rt.Ek)(this.currentMarker.message)[0],t="".concat(this.getType(this.currentMarker)," ").concat(e);this.statusBarEntryAccessor.value?this.statusBarEntryAccessor.value.update({name:(0,Rt.Ij)(3478,"Current Problem"),text:t,ariaLabel:t}):this.statusBarEntryAccessor.value=this.statusbarService.addEntry({name:(0,Rt.Ij)(3478,"Current Problem"),text:t,ariaLabel:t},"statusbar.currentProblem",Wt.bx.LEFT)}else this.statusBarEntryAccessor.clear()}hasToUpdateStatus(e,t){return!t||!e||Rt.Cr.makeKey(e)!==Rt.Cr.makeKey(t)}getType(e){switch(e.severity){case Rt.wr.Error:return"$(error)";case Rt.wr.Warning:return"$(warning)";case Rt.wr.Info:return"$(info)"}return""}getMarker(){if(!this.configurationService.getValue("problems.showCurrentInStatus")||!this.editor||!this.editor.getModel())return null;let e=this.editor.getPosition();return e&&this.markers.find(t=>Rt.bD.containsPosition(t,e))||null}onMarkerChanged(e){if(!this.editor)return;let t=this.editor.getModel();t&&(t&&!e.some(e=>(0,Rt.oT)(t.uri,e))||this.updateMarkers())}updateMarkers(){if(!this.editor)return;let e=this.editor.getModel();e&&(e?(this.markers=this.markerService.read({resource:e.uri,severities:Rt.wr.Error|Rt.wr.Warning|Rt.wr.Info}),this.markers.sort(this.compareMarker)):this.markers=[],this.updateStatus())}compareMarker(e,t){let i=(0,Rt.UO)(e.resource.toString(),t.resource.toString());return 0===i&&(i=Rt.wr.compare(e.severity,t.severity)),0===i&&(i=Rt.bD.compareRangesUsingStarts(e,t)),i}};Pg=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt._x),(0,Rt.Fb)(1,Rt.xr),(0,Rt.Fb)(2,Rt.o_)],Pg);var Jg=(Ve=class extends Rt.Ob{constructor(e,t,i){super(Sg.ID,(0,Rt.Ij)(3479,"Search Marketplace Extensions for '{0}'...",e)),this.fileExtension=e,this.commandService=t,this.enabled=i.isEnabled()}async run(){await this.commandService.executeCommand("workbench.extensions.action.showExtensionsForLanguage",this.fileExtension)}},{_:Sg=Ve},{_:Ve.ID="workbench.action.showLanguageExtensions"},Ve);Jg=Sg=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Cb),(0,Rt.Fb)(2,Bt.n)],Jg);var Bg=(Re=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(3480,"Change Language Mode"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.KeyM)},precondition:Rt.PO.not("notebookEditorFocused"),metadata:{description:(0,Rt.Ij)(3481,"Change the language mode of the active text editor."),args:[{name:(0,Rt.Ij)(3482,"The name of the language mode to change to."),constraint:e=>"string"==typeof e}]}})}async run(t,i){var o,s;let r=t.get(Rt.xc),n=t.get(Pt.kt),a=t.get(Rt.cv),d=t.get(Pt.bt),l=t.get(Pt.E),c=t.get(jt.r),h=t.get(Rt.Ub),u=t.get(Rt.o_),g=t.get(Rt.ib),p=(0,Gt.i)(n.activeTextEditorControl);if(!p)return void await r.pick([{label:(0,Rt.Ij)(3450,"No text editor active at this time")}]);let b,m,v=p.getModel(),C=Pt.Ht.getOriginalUri(n.activeEditor,{supportSideBySide:Pt.Jt.PRIMARY});v&&(m=v.getLanguageId(),b=null!==(o=a.getLanguageName(m))&&void 0!==o?o:void 0);let w=!!C;(null===C||void 0===C?void 0:C.scheme)===Rt.vT.untitled&&(null===(s=l.untitled.get(C))||void 0===s||!s.hasAssociatedFilePath)&&(w=!1);let y,f,S,I=a.getSortedRegisteredLanguageNames().map(e=>{let t,{languageName:i,languageId:o}=e,s=a.getExtensions(o).join(" ");return t=b===i?(0,Rt.Ij)(3483,"({0}) - Configured Language",o):(0,Rt.Ij)(3484,"({0})",o),{label:i,meta:s,iconClasses:(0,Mt.a)(o),description:t}});if(I.unshift({type:"separator",label:(0,Rt.Ij)(3485,"languages (identifier)")}),w&&C){let e=(0,Rt.nT)(C)||(0,Rt.Xw)(C);S=h.createInstance(Jg,e),S.enabled&&I.unshift(S),f={label:(0,Rt.Ij)(3486,"Configure '{0}' language based settings...",b)},I.unshift(f),y={label:(0,Rt.Ij)(3487,"Configure File Association for '{0}'...",e)},I.unshift(y)}let k={label:(0,Rt.Ij)(3488,"Auto Detect")};v&&v.getValueLength()>0&&I.unshift(k);let _="string"==typeof i?{label:i}:await r.pick(I,{placeHolder:(0,Rt.Ij)(3489,"Select Language Mode"),matchOnDescription:!0});if(!_)return;if(_===S)return void S.run();if(_===y)return void(C&&this.configureFileAssociation(C,a,r,u));if(_===f)return void c.openUserSettings({jsonEditor:!0,revealSetting:{key:"[".concat(null!==m&&void 0!==m?m:null,"]"),edit:!0}});let E=n.activeEditor;if(E){let t=Eg(E);if(t){let i,o;if(_===k){if(v){let e=Pt.Ht.getOriginalUri(E,{supportSideBySide:Pt.Jt.PRIMARY});if(e){var A;let t=null!==(A=a.guessLanguageIdByFilepathOrFirstLine(e,v.getLineContent(1)))&&void 0!==A?A:void 0;(!t||"unknown"===t)&&(o=await d.detectLanguage(e),t=o),t&&(i=a.createById(t))}}}else{let e=a.getLanguageIdByLanguageName(_.label);i=a.createById(e),C&&d.detectLanguage(C).then(e=>{let t=a.getLanguageIdByLanguageName(_.label)||"unknown";if(e===m&&m!==t){var i;let e=u.getValue("workbench.editor.preferHistoryBasedLanguageDetection")?"history":"classic";g.publicLog2(Pt.St,{currentLanguageId:null!==b&&void 0!==b?b:"unknown",nextLanguageId:_.label,lineCount:null!==(i=null===v||void 0===v?void 0:v.getLineCount())&&void 0!==i?i:-1,modelPreference:e})}})}if(void 0!==i&&(t.setLanguageId(i.languageId,e.ID),(null===C||void 0===C?void 0:C.scheme)===Rt.vT.untitled)){let e=u.getValue("workbench.editor.preferHistoryBasedLanguageDetection")?"history":"classic";g.publicLog2("setUntitledDocumentLanguage",{to:i.languageId,from:null!==m&&void 0!==m?m:"none",modelPreference:e})}}p.focus()}}configureFileAssociation(e,t,i,o){let s=(0,Rt.nT)(e),r=(0,Rt.Xw)(e),n=t.guessLanguageIdByFilepathOrFirstLine(Rt.wD.file(r)),a=t.getSortedRegisteredLanguageNames().map(e=>{let{languageName:t,languageId:i}=e;return{id:i,label:t,iconClasses:(0,Mt.a)(i),description:i===n?(0,Rt.Ij)(3490,"Current Association"):void 0}});setTimeout(async()=>{let e=await i.pick(a,{placeHolder:(0,Rt.Ij)(3491,"Select Language Mode to Associate with '{0}'",s||r)});if(e){var t;let i,n=o.inspect(Rt.ws);i=s&&"."!==r[0]?"*".concat(s):r;let a=Rt.X_.USER;(null===(t=n.workspaceValue)||void 0===t?void 0:t[i])&&(a=Rt.X_.WORKSPACE);let d=(0,Rt.Hj)(a===Rt.X_.WORKSPACE?n.workspaceValue:n.userValue)||Object.create(null);d[i]=e.id,o.updateValue(Rt.ws,d,a)}},50)}},{_:Re.ID="workbench.action.editor.changeLanguageMode"},Re),Og=class extends Rt.ob{constructor(){super({id:"workbench.action.editor.changeEOL",title:(0,Rt.Lj)(3492,"Change End of Line Sequence"),f1:!0})}async run(e){var t,i;let o=e.get(Pt.kt),s=e.get(Rt.xc),r=(0,Gt.i)(o.activeTextEditorControl);if(!r)return void await s.pick([{label:(0,Rt.Ij)(3450,"No text editor active at this time")}]);if(null!==(t=o.activeEditor)&&void 0!==t&&t.isReadonly())return void await s.pick([{label:(0,Rt.Ij)(3451,"The active code editor is read-only.")}]);let n=r.getModel(),a=[{label:Fg,eol:Rt.Qv.LF},{label:Gg,eol:Rt.Qv.CRLF}],d="\n"===(null===(i=n)||void 0===i?void 0:i.getEOL())?0:1,l=await s.pick(a,{placeHolder:(0,Rt.Ij)(3493,"Select End of Line Sequence"),activeItem:a[d]});if(l){var c;let e=(0,Gt.i)(o.activeTextEditorControl);(null===e||void 0===e?void 0:e.hasModel())&&(null===(c=o.activeEditor)||void 0===c||!c.isReadonly())&&(n=e.getModel(),n.pushStackElement(),n.pushEOL(l.eol),n.pushStackElement())}r.focus()}},Kg=class extends Rt.ob{constructor(){super({id:"workbench.action.editor.changeEncoding",title:(0,Rt.Lj)(3494,"Change File Encoding"),f1:!0})}async run(e){let t=e.get(Pt.kt),i=e.get(Rt.xc),o=e.get(Rt.ys),s=e.get(Pt.E),r=e.get(Rt.hv),n=e.get(Rt.Fl),a=(0,Gt.i)(t.activeTextEditorControl);if(!a)return void await i.pick([{label:(0,Rt.Ij)(3450,"No text editor active at this time")}]);let d=t.activeEditorPane;if(!d)return void await i.pick([{label:(0,Rt.Ij)(3450,"No text editor active at this time")}]);let l=_g(d.input);if(!l)return void await i.pick([{label:(0,Rt.Ij)(3495,"No file active at this time")}]);let c,h={label:(0,Rt.Ij)(3496,"Save with Encoding")},u={label:(0,Rt.Ij)(3497,"Reopen with Encoding")};if(!Rt.lj.isDefaultVariant()){let e="Save with Encoding";e!==h.label&&(h.detail=e);let t="Reopen with Encoding";t!==u.label&&(u.detail=t)}if(c=l instanceof zt.l?h:d.input.isReadonly()?u:await i.pick([u,h],{placeHolder:(0,Rt.Ij)(3454,"Select Action"),matchOnDetail:!0}),!c)return;await(0,Rt.Gw)(50);let g,p=Pt.Ht.getOriginalUri(d.input,{supportSideBySide:Pt.Jt.PRIMARY});if(!p||!o.hasProvider(p)&&p.scheme!==Rt.vT.untitled)return;o.hasProvider(p)&&(g=(await s.readStream(p,{autoGuessEncoding:!0,candidateGuessEncodings:r.getValue(p,"files.candidateGuessEncodings")})).encoding);let b,m,v=c===u,C=r.getValue(p,"files.encoding"),w=Object.keys(Nt.d).sort((e,t)=>e===C?-1:t===C?1:Nt.d[e].order-Nt.d[t].order).filter(e=>(e!==g||g===C)&&(!v||!Nt.d[e].encodeOnly)).map((e,t)=>(e===l.getEncoding()?b=t:Nt.d[e].alias===l.getEncoding()&&(m=t),{id:e,label:Nt.d[e].labelLong,description:e})),y=w.slice();g&&C!==g&&Nt.d[g]&&(w.unshift({type:"separator"}),w.unshift({id:g,label:Nt.d[g].labelLong,description:(0,Rt.Ij)(3498,"Guessed from content")}));let f=await i.pick(w,{placeHolder:v?(0,Rt.Ij)(3499,"Select File Encoding to Reopen File"):(0,Rt.Ij)(3500,"Select File Encoding to Save with"),activeItem:y["number"==typeof b?b:"number"==typeof m?m:-1]});if(!f||!t.activeEditorPane)return;let S=_g(t.activeEditorPane.input);if(void 0!==f.id&&S){if(v&&t.activeEditorPane.input.isDirty()){let{confirmed:e}=await n.confirm({message:(0,Rt.Ij)(3501,"Do you want to revert the active text editor and reopen with a different encoding?"),detail:(0,Rt.Ij)(3502,"This will discard any unsaved changes."),primaryButton:(0,Rt.Ij)(3503,"Discard Changes and Reopen")});if(!e)return;await t.activeEditorPane.input.revert(t.activeEditorPane.group.id)}await S.setEncoding(f.id,v?Pt.u.Decode:Pt.u.Encode)}a.focus()}};(0,Rt.Ib)(),(0,Rt.yT)(),(0,Rt.PA)(),(0,Rt.TD)(),(0,Zt.d)(),(0,Rt.iT)(),(0,Rt.C_)(),(0,Pt.k)(),(0,Pt.V)(),(0,Pt.j)(),(0,Pt.l)(),(0,Wt.w_)(),(0,Pt.T)();var Mg=class{constructor(e,t,i){this.filesConfigurationService=e,this.environmentService=t,this.pathService=i}canSerialize(e){return this.filesConfigurationService.isHotExitEnabled&&!e.isDisposed()}serialize(e){if(!this.canSerialize(e))return;let t=e,i=t.resource;t.hasAssociatedFilePath&&(i=(0,Rt.mT)(i,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme));let o,s=t.getLanguageId();"plaintext"===s?t.hasLanguageSetExplicitly&&(o=s):o=s;let r={resourceJSON:i.toJSON(),modeId:o,encoding:t.getEncoding()};return JSON.stringify(r)}deserialize(e,t){return e.invokeFunction(e=>{let i=JSON.parse(t),o=Rt.wD.revive(i.resourceJSON),s=i.modeId,r=i.encoding;return e.get(Zt.u).createTextEditor({resource:o,languageId:s,encoding:r,forceUntitled:!0})})}};Mg=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.B),(0,Rt.Fb)(1,Pt.O),(0,Rt.Fb)(2,Pt.A)],Mg);var jg=(Te=class extends Rt.CA{constructor(e,t,i,o,s){super(),this.environmentService=t,this.pathService=i,this.textEditorService=o,this.untitledTextEditorService=s,this._register(e.registerHandler(this))}handles(e){return e.resource.scheme===Rt.vT.untitled&&""===e.typeId}isOpen(e,t){return!!this.handles(e)&&(t instanceof zt.l&&(0,Rt.oT)(e.resource,t.resource))}createEditor(e){let t;return t=this.untitledTextEditorService.isUntitledWithAssociatedResource(e.resource)?(0,Rt.mT)(e.resource,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme):e.resource,this.textEditorService.createTextEditor({resource:t,forceUntitled:!0})}},{_:Te.ID="workbench.contrib.untitledTextEditorWorkingCopyEditorHandler"},Te);jg=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.C_),(0,Rt.Fb)(1,Pt.O),(0,Rt.Fb)(2,Pt.A),(0,Rt.Fb)(3,Zt.u),(0,Rt.Fb)(4,Pt.w)],jg),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.vb)(),(0,Rt.PA)(),(0,Rt.I_)(),(0,Lt.O)(),(0,Lt.a)(),(0,Lt.L)(),(0,Nt.Ot)(),(0,Rt.WM)(),(0,Rt.gA)(),(0,Pt.k)(),(0,Rt.ac)();var Qg,Yg=(Le=class extends Rt.CA{constructor(e,t,i){super(),this.editorResolverService=e,this.environmentService=i,this.configurationRegistry=Rt._b.as(Rt.E_.Configuration),(async()=>{await t.whenInstalledExtensionsRegistered(),this.updateDynamicEditorConfigurations(),this.registerListeners()})()}registerListeners(){this._register(Rt.dA.debounce(this.editorResolverService.onDidChangeEditorRegistrations,(e,t)=>t)(()=>this.updateDynamicEditorConfigurations()))}updateDynamicEditorConfigurations(){let e=[...this.editorResolverService.getEditors(),...Qg.AUTO_LOCK_EXTRA_EDITORS].filter(e=>!Qg.AUTO_LOCK_REMOVE_EDITORS.has(e.id)),t=this.editorResolverService.getEditors().filter(e=>e.priority!==Lt.t.exclusive).map(e=>e.id),i=Object.create(null);for(let d of e)i[d.id]={type:"boolean",default:Qg.AUTO_LOCK_DEFAULT_ENABLED.has(d.id),description:d.label};let o=Object.create(null);for(let d of e)o[d.id]=Qg.AUTO_LOCK_DEFAULT_ENABLED.has(d.id);let s=this.autoLockConfigurationNode;this.autoLockConfigurationNode=(0,xt.A)((0,xt.A)({},Lt.j),{},{properties:{"workbench.editor.autoLockGroups":{type:"object",description:(0,Rt.Ij)(3402,"If an editor matching one of the listed types is opened as the first in an editor group and more than one group is open, the group is automatically locked. Locked groups will only be used for opening editors when explicitly chosen by a user gesture (for example drag and drop), but not by default. Consequently, the active editor in a locked group is less likely to be replaced accidentally with a different editor."),properties:i,default:o,additionalProperties:!1}}});let r=this.defaultBinaryEditorConfigurationNode;this.defaultBinaryEditorConfigurationNode=(0,xt.A)((0,xt.A)({},Lt.j),{},{properties:{"workbench.editor.defaultBinaryEditor":{type:"string",default:"",enum:[...t,""],description:(0,Rt.Ij)(3403,"The default editor for files detected as binary. If undefined, the user will be presented with a picker.")}}});let n=this.editorAssociationsConfigurationNode;this.editorAssociationsConfigurationNode=(0,xt.A)((0,xt.A)({},Lt.j),{},{properties:{"workbench.editorAssociations":{type:"object",markdownDescription:(0,Rt.Ij)(3404,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),patternProperties:{".*":{type:"string",enum:t}}}}});let a=this.editorLargeFileConfirmationConfigurationNode;this.editorLargeFileConfirmationConfigurationNode=(0,xt.A)((0,xt.A)({},Lt.j),{},{properties:{"workbench.editorLargeFileConfirmation":{type:"number",default:(0,Rt.Js)(this.environmentService.remoteAuthority)/Rt.Ss.MB,minimum:1,scope:Rt.w_.RESOURCE,markdownDescription:(0,Rt.Ij)(3405,"Controls the minimum size of a file in MB before asking for confirmation when opening in the editor. Note that this setting may not apply to all editor types and environments.")}}}),this.configurationRegistry.updateConfigurations({add:[this.autoLockConfigurationNode,this.defaultBinaryEditorConfigurationNode,this.editorAssociationsConfigurationNode,this.editorLargeFileConfirmationConfigurationNode],remove:(0,Rt.AM)([s,r,n,a])})}},{_:Qg=Le},{_:Le.ID="workbench.contrib.dynamicEditorConfigurations"},{_:Le.AUTO_LOCK_DEFAULT_ENABLED=new Set(["terminalEditor","mainThreadWebview-simpleBrowser.view","mainThreadWebview-browserPreview","workbench.editor.processExplorer"])},{_:Le.AUTO_LOCK_EXTRA_EDITORS=[{id:"workbench.input.interactive",label:(0,Rt.Ij)(3398,"Interactive Window"),priority:Lt.t.builtin},{id:"mainThreadWebview-markdown.preview",label:(0,Rt.Ij)(3399,"Markdown Preview"),priority:Lt.t.builtin},{id:"mainThreadWebview-simpleBrowser.view",label:(0,Rt.Ij)(3400,"Simple Browser"),priority:Lt.t.builtin},{id:"mainThreadWebview-browserPreview",label:(0,Rt.Ij)(3401,"Live Preview"),priority:Lt.t.builtin}]},{_:Le.AUTO_LOCK_REMOVE_EDITORS=new Set(["vscode-interactive-input","interactive","vscode.markdown.preview.editor"])},Le);Yg=Qg=(0,Rt.Pb)([(0,Rt.Fb)(0,Lt.I),(0,Rt.Fb)(1,Nt.Dt),(0,Rt.Fb)(2,Pt.O)],Yg),(0,Rt.vb)(),(0,Rt.Fj)(),(0,Tt.f)(),(0,Pt.en)(),(0,Nt.ir)(),(0,Pt.Ot)(),(0,Pt.it)(),(0,Lt._)(),(0,Mt.c)(),(0,Rt.db)(),(0,Rt.sm)(),(0,Rt.tO)(),(0,Tt.Vt)(),(0,Rt.gb)(),(0,Rt.IO)(),(0,Rt.mj)(),(0,Pt.b)(),(0,Rt.vr)(),(0,Rt.yT)(),(0,Rt.gD)(),(0,Rt.q)(),(0,Tt.nt)(),(0,Lt.Ki)(),(0,Lt.Fi)(),(0,Rt.Do)(),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(wg,wg.ID,(0,Rt.Ij)(3117,"Text Editor")),[new Rt.om(zt.l),new Rt.om(Lt.g)]),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(zo,zo.ID,(0,Rt.Ij)(3118,"Text Diff Editor")),[new Rt.om(Pt.nt)]),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(fg,fg.ID,(0,Rt.Ij)(3119,"Binary Diff Editor")),[new Rt.om(Pt.nt)]),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(zt.o,zt.o.ID,(0,Rt.Ij)(3120,"Side by Side Editor")),[new Rt.om(Pt.Et)]),Rt._b.as(Pt.Rt.EditorFactory).registerEditorSerializer(zt.l.ID,Mg),Rt._b.as(Pt.Rt.EditorFactory).registerEditorSerializer(Pt.Et.ID,Pt.Dt),Rt._b.as(Pt.Rt.EditorFactory).registerEditorSerializer(Pt.nt.ID,Pt.rt),(0,Pt.x)(Ng.ID,Ng,Pt.y.BlockRestore),(0,Pt.x)(jg.ID,jg,Pt.y.BlockRestore),(0,Pt.x)(Yg.ID,Yg,Pt.y.BlockRestore);var Hg=Rt._b.as(Rt._r.Quickaccess),Xg="inEditorsPicker",Ug=Rt.PO.and(Tt.Bt,Rt.PO.has(Xg));Hg.registerQuickAccessProvider({ctor:Mo,prefix:Mo.PREFIX,contextKey:Xg,placeholder:(0,Rt.Ij)(3121,"Type the name of an editor to open it."),helpEntries:[{description:(0,Rt.Ij)(3122,"Show Editors in Active Group by Most Recently Used"),commandId:Mr.ID}]}),Hg.registerQuickAccessProvider({ctor:jo,prefix:jo.PREFIX,contextKey:Xg,placeholder:(0,Rt.Ij)(3121,"Type the name of an editor to open it."),helpEntries:[{description:(0,Rt.Ij)(3123,"Show All Opened Editors By Appearance"),commandId:jr.ID}]}),Hg.registerQuickAccessProvider({ctor:Qo,prefix:Qo.PREFIX,contextKey:Xg,placeholder:(0,Rt.Ij)(3121,"Type the name of an editor to open it."),helpEntries:[{description:(0,Rt.Ij)(3124,"Show All Opened Editors By Most Recently Used"),commandId:Qr.ID}]}),(0,Rt.pb)(Bg),(0,Rt.pb)(Og),(0,Rt.pb)(Kg),(0,Rt.pb)(Rr),(0,Rt.pb)(Tr),(0,Rt.pb)(class extends Vr{constructor(){super({id:"workbench.action.nextEditor",title:(0,Rt.Lj)(3295,"Open Next Editor"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.PageDown,mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.RightArrow,secondary:[Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.BracketRight]}},category:Mt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(Pt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;if(o+1<i.length)return{editor:i[o+1],groupId:t.id};let s=new Set,r=e.activeGroup;for(;r&&!s.has(r.id);)if(r=e.findGroup({location:Pt.q.NEXT},r,!0),r){s.add(r.id);let e=r.getEditors(Pt.Ut.SEQUENTIAL);if(e.length>0)return{editor:e[0],groupId:r.id}}}}),(0,Rt.pb)(class extends Vr{constructor(){super({id:"workbench.action.previousEditor",title:(0,Rt.Lj)(3296,"Open Previous Editor"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.PageUp,mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.LeftArrow,secondary:[Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.BracketLeft]}},category:Mt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(Pt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;if(o>0)return{editor:i[o-1],groupId:t.id};let s=new Set,r=e.activeGroup;for(;r&&!s.has(r.id);)if(r=e.findGroup({location:Pt.q.PREVIOUS},r,!0),r){s.add(r.id);let e=r.getEditors(Pt.Ut.SEQUENTIAL);if(e.length>0)return{editor:e[e.length-1],groupId:r.id}}}}),(0,Rt.pb)(class extends Vr{constructor(){super({id:"workbench.action.nextEditorInGroup",title:(0,Rt.Lj)(3297,"Open Next Editor in Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.PageDown),mac:{primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.RightArrow)}},category:Mt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(Pt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;return{editor:o+1<i.length?i[o+1]:i[0],groupId:t.id}}}),(0,Rt.pb)(class extends Vr{constructor(){super({id:"workbench.action.previousEditorInGroup",title:(0,Rt.Lj)(3298,"Open Previous Editor in Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.PageUp),mac:{primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.LeftArrow)}},category:Mt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(Pt.Ut.SEQUENTIAL),o=t.activeEditor?i.indexOf(t.activeEditor):-1;return{editor:o>0?i[o-1]:i[i.length-1],groupId:t.id}}}),(0,Rt.pb)(class extends Vr{constructor(){super({id:"workbench.action.firstEditorInGroup",title:(0,Rt.Lj)(3299,"Open First Editor in Group"),f1:!0,category:Mt.s.View})}navigate(e){let t=e.activeGroup;return{editor:t.getEditors(Pt.Ut.SEQUENTIAL)[0],groupId:t.id}}}),(0,Rt.pb)(class extends Vr{constructor(){super({id:"workbench.action.lastEditorInGroup",title:(0,Rt.Lj)(3300,"Open Last Editor in Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Alt|Rt.YD.Digit0,secondary:[Rt.ZD.CtrlCmd|Rt.YD.Digit9],mac:{primary:Rt.ZD.WinCtrl|Rt.YD.Digit0,secondary:[Rt.ZD.CtrlCmd|Rt.YD.Digit9]}},category:Mt.s.View})}navigate(e){let t=e.activeGroup,i=t.getEditors(Pt.Ut.SEQUENTIAL);return{editor:i[i.length-1],groupId:t.id}}}),(0,Rt.pb)(Xr),(0,Rt.pb)(Ur),(0,Rt.pb)(zr),(0,Rt.pb)(qr),(0,Rt.pb)(Or),(0,Rt.pb)(Kr),(0,Rt.pb)(jr),(0,Rt.pb)(Qr),(0,Rt.pb)(Mr),(0,Rt.pb)(Cr),(0,Rt.pb)(class extends vr{constructor(){super({id:"workbench.action.closeAllGroups",title:(0,Rt.Lj)(3277,"Close All Editor Groups"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.KeyW)},category:Mt.s.View})}get excludeSticky(){return!1}async doCloseAll(e){await super.doCloseAll(e);for(let t of this.groupsToClose(e))e.removeGroup(t)}}),(0,Rt.pb)(mr),(0,Rt.pb)(wr),(0,Rt.pb)(yr),(0,Rt.pb)(br),(0,Rt.pb)(sr),(0,Rt.pb)(class extends or{constructor(){super({id:"workbench.action.splitEditorOrthogonal",title:(0,Rt.Lj)(3253,"Split Editor Orthogonal"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.Backslash)},category:Mt.s.View})}getDirection(e){return(0,Pt.tt)(e)===Pt.K.RIGHT?Pt.K.DOWN:Pt.K.RIGHT}}),(0,Rt.pb)(class extends ir{constructor(){super({id:Rs,title:(0,Rt.Lj)(3254,"Split Editor Left"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.Backslash)},category:Mt.s.View},Rs)}}),(0,Rt.pb)(class extends ir{constructor(){super({id:Ts,title:(0,Rt.Lj)(3255,"Split Editor Right"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.Backslash)},category:Mt.s.View},Ts)}}),(0,Rt.pb)(rr),(0,Rt.pb)(nr),(0,Rt.pb)(ar),(0,Rt.pb)(dr),(0,Rt.pb)(lr),(0,Rt.pb)(Er),(0,Rt.pb)(Ar),(0,Rt.pb)(Dr),(0,Rt.pb)(xr),(0,Rt.pb)(kr),(0,Rt.pb)(_r),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorLeftInGroup",title:(0,Rt.Lj)(3334,"Move Editor Left"),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.PageUp,mac:{primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.LeftArrow)}},f1:!0,category:Mt.s.View},ms,{to:"left"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorRightInGroup",title:(0,Rt.Lj)(3335,"Move Editor Right"),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.PageDown,mac:{primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.RightArrow)}},f1:!0,category:Mt.s.View},ms,{to:"right"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorToStart",title:(0,Rt.Lj)(3336,"Move Editor to Start"),f1:!0,category:Mt.s.View},ms,{to:"first"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorToEnd",title:(0,Rt.Lj)(3337,"Move Editor to End"),f1:!0,category:Mt.s.View},ms,{to:"last"})}}),(0,Rt.pb)(class extends Sr{constructor(){super({id:"workbench.action.moveActiveEditorGroupLeft",title:(0,Rt.Lj)(3280,"Move Editor Group Left"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.LeftArrow)},category:Mt.s.View},Pt.K.LEFT)}}),(0,Rt.pb)(class extends Sr{constructor(){super({id:"workbench.action.moveActiveEditorGroupRight",title:(0,Rt.Lj)(3281,"Move Editor Group Right"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.RightArrow)},category:Mt.s.View},Pt.K.RIGHT)}}),(0,Rt.pb)(class extends Sr{constructor(){super({id:"workbench.action.moveActiveEditorGroupUp",title:(0,Rt.Lj)(3282,"Move Editor Group Up"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.UpArrow)},category:Mt.s.View},Pt.K.UP)}}),(0,Rt.pb)(class extends Sr{constructor(){super({id:"workbench.action.moveActiveEditorGroupDown",title:(0,Rt.Lj)(3283,"Move Editor Group Down"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.DownArrow)},category:Mt.s.View},Pt.K.DOWN)}}),(0,Rt.pb)(class extends Ir{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupLeft",title:(0,Rt.Lj)(3284,"Duplicate Editor Group Left"),f1:!0,category:Mt.s.View},Pt.K.LEFT)}}),(0,Rt.pb)(class extends Ir{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupRight",title:(0,Rt.Lj)(3285,"Duplicate Editor Group Right"),f1:!0,category:Mt.s.View},Pt.K.RIGHT)}}),(0,Rt.pb)(class extends Ir{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupUp",title:(0,Rt.Lj)(3286,"Duplicate Editor Group Up"),f1:!0,category:Mt.s.View},Pt.K.UP)}}),(0,Rt.pb)(class extends Ir{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupDown",title:(0,Rt.Lj)(3287,"Duplicate Editor Group Down"),f1:!0,category:Mt.s.View},Pt.K.DOWN)}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorToPreviousGroup",title:(0,Rt.Lj)(3338,"Move Editor into Previous Group"),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.LeftArrow,mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.WinCtrl|Rt.YD.LeftArrow}},f1:!0,category:Mt.s.View},ms,{to:"previous",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorToNextGroup",title:(0,Rt.Lj)(3339,"Move Editor into Next Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.RightArrow,mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.WinCtrl|Rt.YD.RightArrow}},category:Mt.s.View},ms,{to:"next",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorToFirstGroup",title:(0,Rt.Lj)(3344,"Move Editor into First Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift|Rt.ZD.Alt|Rt.YD.Digit1,mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.WinCtrl|Rt.YD.Digit1}},category:Mt.s.View},ms,{to:"first",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.moveEditorToLastGroup",title:(0,Rt.Lj)(3345,"Move Editor into Last Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.Shift|Rt.ZD.Alt|Rt.YD.Digit9,mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.WinCtrl|Rt.YD.Digit9}},category:Mt.s.View},ms,{to:"last",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:Fs,title:(0,Rt.Lj)(3342,"Move Editor into Left Group"),f1:!0,category:Mt.s.View},Fs)}}),(0,Rt.pb)(class extends ir{constructor(){super({id:Gs,title:(0,Rt.Lj)(3343,"Move Editor into Right Group"),f1:!0,category:Mt.s.View},Gs)}}),(0,Rt.pb)(class extends ir{constructor(){super({id:Ls,title:(0,Rt.Lj)(3340,"Move Editor into Group Above"),f1:!0,category:Mt.s.View},Ls)}}),(0,Rt.pb)(class extends ir{constructor(){super({id:Ws,title:(0,Rt.Lj)(3341,"Move Editor into Group Below"),f1:!0,category:Mt.s.View},Ws)}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.splitEditorToPreviousGroup",title:(0,Rt.Lj)(3346,"Split Editor into Previous Group"),f1:!0,category:Mt.s.View},vs,{to:"previous",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.splitEditorToNextGroup",title:(0,Rt.Lj)(3347,"Split Editor into Next Group"),f1:!0,category:Mt.s.View},vs,{to:"next",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.splitEditorToFirstGroup",title:(0,Rt.Lj)(3352,"Split Editor into First Group"),f1:!0,category:Mt.s.View},vs,{to:"first",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.splitEditorToLastGroup",title:(0,Rt.Lj)(3353,"Split Editor into Last Group"),f1:!0,category:Mt.s.View},vs,{to:"last",by:"group"})}}),(0,Rt.pb)(tn),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.splitEditorToRightGroup",title:(0,Rt.Lj)(3351,"Split Editor into Right Group"),f1:!0,category:Mt.s.View},vs,{to:"right",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.splitEditorToAboveGroup",title:(0,Rt.Lj)(3348,"Split Editor into Group Above"),f1:!0,category:Mt.s.View},vs,{to:"up",by:"group"})}}),(0,Rt.pb)(class extends ir{constructor(){super({id:"workbench.action.splitEditorToBelowGroup",title:(0,Rt.Lj)(3349,"Split Editor into Group Below"),f1:!0,category:Mt.s.View},vs,{to:"down",by:"group"})}}),(0,Rt.pb)(cr),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusFirstEditorGroup",title:(0,Rt.Lj)(3262,"Focus First Editor Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.Digit1},category:Mt.s.View},{location:Pt.q.FIRST})}}),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusLastEditorGroup",title:(0,Rt.Lj)(3263,"Focus Last Editor Group"),f1:!0,category:Mt.s.View},{location:Pt.q.LAST})}}),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusPreviousGroup",title:(0,Rt.Lj)(3265,"Focus Previous Editor Group"),f1:!0,category:Mt.s.View},{location:Pt.q.PREVIOUS})}}),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusNextGroup",title:(0,Rt.Lj)(3264,"Focus Next Editor Group"),f1:!0,category:Mt.s.View},{location:Pt.q.NEXT})}}),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusLeftGroup",title:(0,Rt.Lj)(3266,"Focus Left Editor Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.LeftArrow)},category:Mt.s.View},{direction:Pt.K.LEFT})}}),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusRightGroup",title:(0,Rt.Lj)(3267,"Focus Right Editor Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.RightArrow)},category:Mt.s.View},{direction:Pt.K.RIGHT})}}),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusAboveGroup",title:(0,Rt.Lj)(3268,"Focus Editor Group Above"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.UpArrow)},category:Mt.s.View},{direction:Pt.K.UP})}}),(0,Rt.pb)(class extends hr{constructor(){super({id:"workbench.action.focusBelowGroup",title:(0,Rt.Lj)(3269,"Focus Editor Group Below"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.DownArrow)},category:Mt.s.View},{direction:Pt.K.DOWN})}}),(0,Rt.pb)(class extends hn{constructor(){super({id:"workbench.action.newGroupLeft",title:(0,Rt.Lj)(3362,"New Editor Group to the Left"),f1:!0,category:Mt.s.View},Pt.K.LEFT)}}),(0,Rt.pb)(class extends hn{constructor(){super({id:"workbench.action.newGroupRight",title:(0,Rt.Lj)(3363,"New Editor Group to the Right"),f1:!0,category:Mt.s.View},Pt.K.RIGHT)}}),(0,Rt.pb)(class extends hn{constructor(){super({id:"workbench.action.newGroupAbove",title:(0,Rt.Lj)(3364,"New Editor Group Above"),f1:!0,category:Mt.s.View},Pt.K.UP)}}),(0,Rt.pb)(class extends hn{constructor(){super({id:"workbench.action.newGroupBelow",title:(0,Rt.Lj)(3365,"New Editor Group Below"),f1:!0,category:Mt.s.View},Pt.K.DOWN)}}),(0,Rt.pb)(Lr),(0,Rt.pb)(Wr),(0,Rt.pb)(Fr),(0,Rt.pb)(Gr),(0,Rt.pb)(Zr),(0,Rt.pb)(Nr),(0,Rt.pb)(Pr),(0,Rt.pb)(Jr),(0,Rt.pb)(Br),(0,Rt.pb)(en),(0,Rt.pb)($r),(0,Rt.pb)(on),(0,Rt.pb)(sn),(0,Rt.pb)(rn),(0,Rt.pb)(nn),(0,Rt.pb)(an),(0,Rt.pb)(dn),(0,Rt.pb)(cn),(0,Rt.pb)(ln),(0,Rt.pb)(un),(0,Rt.pb)(gn),(0,Rt.pb)(class extends Yr{constructor(){super({id:"workbench.action.quickOpenPreviousRecentlyUsedEditor",title:(0,Rt.Lj)(3322,"Quick Open Previous Recently Used Editor"),f1:!0,category:Mt.s.View},Qo.PREFIX,void 0)}}),(0,Rt.pb)(class extends Yr{constructor(){super({id:"workbench.action.quickOpenLeastRecentlyUsedEditor",title:(0,Rt.Lj)(3323,"Quick Open Least Recently Used Editor"),f1:!0,category:Mt.s.View},Qo.PREFIX,void 0)}}),(0,Rt.pb)(class extends Yr{constructor(){super({id:"workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup",title:(0,Rt.Lj)(3324,"Quick Open Previous Recently Used Editor in Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.Tab,mac:{primary:Rt.ZD.WinCtrl|Rt.YD.Tab}},precondition:Nt.tn.toNegated(),category:Mt.s.View},Mo.PREFIX,void 0)}}),(0,Rt.pb)(class extends Yr{constructor(){super({id:"workbench.action.quickOpenLeastRecentlyUsedEditorInGroup",title:(0,Rt.Lj)(3325,"Quick Open Least Recently Used Editor in Group"),f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Tab,mac:{primary:Rt.ZD.WinCtrl|Rt.ZD.Shift|Rt.YD.Tab}},precondition:Nt.tn.toNegated(),category:Mt.s.View},Mo.PREFIX,Rt.dr.LAST)}}),(0,Rt.pb)(Hr),(0,Rt.pb)(class extends pn{constructor(){super(Ms,(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3368,"Move Editor into New Window")),{},{mnemonicTitle:(0,Rt.Ij)(3369,"&&Move Editor into New Window")}),void 0,!0)}}),(0,Rt.pb)(class extends pn{constructor(){super(js,(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3370,"Copy Editor into New Window")),{},{mnemonicTitle:(0,Rt.Ij)(3371,"&&Copy Editor into New Window")}),{primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.KeyO),weight:Rt.mb.WorkbenchContrib},!1)}}),(0,Rt.pb)(class extends bn{constructor(){super(Qs,(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3372,"Move Editor Group into New Window")),{},{mnemonicTitle:(0,Rt.Ij)(3373,"&&Move Editor Group into New Window")}),!0)}}),(0,Rt.pb)(class extends bn{constructor(){super(Ys,(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3374,"Copy Editor Group into New Window")),{},{mnemonicTitle:(0,Rt.Ij)(3375,"&&Copy Editor Group into New Window")}),!1)}}),(0,Rt.pb)(mn),(0,Rt.pb)(vn);var zg="workbench.action.quickOpenNavigateNextInEditorPicker";Rt.hb.registerCommandAndKeybindingRule({id:zg,weight:Rt.mb.WorkbenchContrib+50,handler:(0,Tt.zt)(zg,!0),when:Ug,primary:Rt.ZD.CtrlCmd|Rt.YD.Tab,mac:{primary:Rt.ZD.WinCtrl|Rt.YD.Tab}});var qg="workbench.action.quickOpenNavigatePreviousInEditorPicker";function $g(e,t,i,o,s,r){let n={command:{id:e.id,title:e.title,icon:e.icon,toggled:e.toggled,precondition:s},group:"navigation",when:t,order:i};o&&(n.alt={id:o.id,title:o.title,icon:o.icon}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,n),r&&Rt.lb.appendMenuItem(Rt.sb.CompactWindowEditorTitle,n)}Rt.hb.registerCommandAndKeybindingRule({id:qg,weight:Rt.mb.WorkbenchContrib+50,handler:(0,Tt.zt)(qg,!1),when:Ug,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Tab,mac:{primary:Rt.ZD.WinCtrl|Rt.ZD.Shift|Rt.YD.Tab}}),function(){let e={type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right"]},by:{type:"string",enum:["tab","group"]},value:{type:"number"}}};function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.create(null),o=arguments.length>2?arguments[2]:void 0;t.to=t.to||"right",t.by=t.by||"tab",t.value="number"==typeof t.value?t.value:1;let r=o.get(Pt.W).activeGroup,n=r.selectedEditors;if(n.length>0)switch(t.by){case"tab":if(e)return i(t,r,n);break;case"group":return s(e,t,r,n,o)}}function i(e,t,i){var s;let r=e.to;("first"===r||"right"===r||"position"===r&&(null!==(s=e.value)&&void 0!==s?s:1)<t.getIndexOfEditor(i[0]))&&(i=[...i].reverse());for(let n of i)o(e,t,n)}function o(e,t,i){var o,s,r;let n=t.getIndexOfEditor(i);switch(e.to){case"first":n=0;break;case"last":n=t.count-1;break;case"left":n-=null!==(o=e.value)&&void 0!==o?o:1;break;case"right":n+=null!==(s=e.value)&&void 0!==s?s:1;break;case"center":n=Math.round(t.count/2)-1;break;case"position":n=(null!==(r=e.value)&&void 0!==r?r:1)-1}n=n<0?0:n>=t.count?t.count-1:n,t.moveEditor(i,t,{index:n})}function s(e,t,i,o,s){var r;let n,a=s.get(Pt.W),d=s.get(Rt.o_);switch(t.to){case"left":n=a.findGroup({direction:Pt.K.LEFT},i),n||(n=a.addGroup(i,Pt.K.LEFT));break;case"right":n=a.findGroup({direction:Pt.K.RIGHT},i),n||(n=a.addGroup(i,Pt.K.RIGHT));break;case"up":n=a.findGroup({direction:Pt.K.UP},i),n||(n=a.addGroup(i,Pt.K.UP));break;case"down":n=a.findGroup({direction:Pt.K.DOWN},i),n||(n=a.addGroup(i,Pt.K.DOWN));break;case"first":n=a.findGroup({location:Pt.q.FIRST},i);break;case"last":n=a.findGroup({location:Pt.q.LAST},i);break;case"previous":if(n=a.findGroup({location:Pt.q.PREVIOUS},i),!n){let e=(0,Pt.tt)(d)===Pt.K.RIGHT?Pt.K.LEFT:Pt.K.UP;n=a.addGroup(i,e)}break;case"next":n=a.findGroup({location:Pt.q.NEXT},i),n||(n=a.addGroup(i,(0,Pt.tt)(d)));break;case"center":n=a.getGroups(Pt.X.GRID_APPEARANCE)[a.count/2-1];break;case"position":n=a.getGroups(Pt.X.GRID_APPEARANCE)[(null!==(r=t.value)&&void 0!==r?r:1)-1]}if(n){let t=(0,Lt.Q)(i,o);e?i.moveEditors(t,n):i.id!==n.id&&i.copyEditors(t,n),n.focus()}}Rt.hb.registerCommandAndKeybindingRule({id:ms,weight:Rt.mb.WorkbenchContrib,when:Lt.Gi.editorTextFocus,primary:0,handler:(e,i)=>t(!0,i,e),metadata:{description:(0,Rt.Ij)(3380,"Move the active editor by tabs or groups"),args:[{name:(0,Rt.Ij)(3381,"Active editor move argument"),description:(0,Rt.Ij)(3382,"Argument Properties:\n\t* 'to': String value providing where to move.\n\t* 'by': String value providing the unit for move (by tab or by group).\n\t* 'value': Number value providing how many positions or an absolute position to move."),constraint:qs,schema:e}]}}),Rt.hb.registerCommandAndKeybindingRule({id:vs,weight:Rt.mb.WorkbenchContrib,when:Lt.Gi.editorTextFocus,primary:0,handler:(e,i)=>t(!1,i,e),metadata:{description:(0,Rt.Ij)(3383,"Copy the active editor by groups"),args:[{name:(0,Rt.Ij)(3384,"Active editor copy argument"),description:(0,Rt.Ij)(3385,"Argument Properties:\n\t* 'to': String value providing where to copy.\n\t* 'value': Number value providing how many positions or an absolute position to copy."),constraint:qs,schema:e}]}}),[{id:Ls,to:"up"},{id:Ws,to:"down"},{id:Fs,to:"left"},{id:Gs,to:"right"}].forEach(e=>{let{id:t,to:i}=e;Rt.xb.registerCommand(t,function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];let n=(0,zt.t)(o,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));n.groupedEditors.length&&s(!0,{to:i},n.groupedEditors[0].group,n.groupedEditors[0].editors,e)})})}(),function(){function e(e,t){!t||"object"!=typeof t||e.get(Pt.W).applyLayout(t)}Rt.xb.registerCommand(Cs,(t,i)=>{e(t,i)}),Rt.xb.registerCommand({id:"vscode.setEditorLayout",handler:(t,i)=>e(t,i),metadata:{description:"Set the editor layout. Editor layout is represented as a tree of groups in which the first group is the root group of the layout.\n\t\t\t\t\tThe orientation of the first group is 0 (horizontal) by default unless specified otherwise. The other orientations are 1 (vertical).\n\t\t\t\t\tThe orientation of subsequent groups is the opposite of the orientation of the group that contains it.\n\t\t\t\t\tHere are some examples: A layout representing 1 row and 2 columns: { orientation: 0, groups: [{}, {}] }.\n\t\t\t\t\tA layout representing 3 rows and 1 column: { orientation: 1, groups: [{}, {}, {}] }.\n\t\t\t\t\tA layout representing 3 rows and 1 column in which the second row has 2 columns: { orientation: 1, groups: [{}, { groups: [{}, {}] }, {}] }\n\t\t\t\t\t",args:[{name:"args",schema:{type:"object",required:["groups"],properties:{orientation:{type:"number",default:0,description:"The orientation of the root group in the layout. 0 for horizontal, 1 for vertical.",enum:[0,1],enumDescriptions:[(0,Rt.Ij)(3386,"Horizontal"),(0,Rt.Ij)(3387,"Vertical")]},groups:{$ref:"#/definitions/editorGroupsSchema",default:[{},{}]}}}}]}}),Rt.xb.registerCommand({id:"vscode.getEditorLayout",handler:e=>e.get(Pt.W).getLayout(),metadata:{description:"Get Editor Layout",args:[],returns:"An editor layout object, in the same format as vscode.setEditorLayout"}})}(),function(){function e(e,t){let i=e.get(Pt.kt),o=t.length>0&&t[0]instanceof Rt.wD?t[0]:void 0;for(let s of[i.activeEditorPane,...i.visibleEditorPanes])if(s instanceof zo&&(!o||s.input instanceof Pt.nt&&(0,Rt.oT)(s.input.primary.resource,o)))return s}function t(t,i,o){var s;let r=e(t,i);r&&(null===(s=r.getControl())||void 0===s||s.goToDiff(o?"next":"previous"))}let i;function o(t,s,r){var n,a,d;let l=e(t,s);if(l)switch(r){case i.Original:null===(n=l.getControl())||void 0===n||n.getOriginalEditor().focus();break;case i.Modified:null===(a=l.getControl())||void 0===a||a.getModifiedEditor().focus();break;case i.Toggle:return null!==(d=l.getControl())&&void 0!==d&&d.getModifiedEditor().hasWidgetFocus()?o(t,s,i.Original):o(t,s,i.Modified)}}function s(t,i){var o;let s=t.get(Rt.hv),r=null===(o=e(t,i))||void 0===o||null===(o=o.getControl())||void 0===o||null===(o=o.getModifiedEditor())||void 0===o?void 0:o.getModel();if(!r)return;let n="diffEditor.renderSideBySide",a=s.getValue(r.uri,n);s.updateValue(r.uri,n,!a)}function r(t,i){var o;let s=t.get(Rt.hv),r=null===(o=e(t,i))||void 0===o||null===(o=o.getControl())||void 0===o||null===(o=o.getModifiedEditor())||void 0===o?void 0:o.getModel();if(!r)return;let n="diffEditor.ignoreTrimWhitespace",a=s.getValue(r.uri,n);s.updateValue(r.uri,n,!a)}async function n(t,i){let o=t.get(Pt.kt),s=e(t,i),r=null===s||void 0===s?void 0:s.group,n=null===s||void 0===s?void 0:s.input;if(!s||void 0===r||!(n instanceof Pt.nt)||!n.modified.resource)return;let a=n.toUntyped({preserveViewState:r.id,preserveResource:!0});if(a){if(n.modified.isModified()&&0===o.findEditors({resource:n.modified.resource,typeId:n.modified.typeId,editorId:n.modified.editorId}).length){let e=(0,xt.A)({},a.modified);e.options||(e.options={}),e.options.pinned=!0,e.options.inactive=!0,await o.openEditor(e,r)}await o.replaceEditors([{editor:n,replacement:(0,xt.A)((0,xt.A)({},a),{},{original:a.modified,modified:a.original,options:(0,xt.A)((0,xt.A)({},a.options),{},{pinned:!0})})}],r)}}Rt.hb.registerCommandAndKeybindingRule({id:ss,weight:Rt.mb.WorkbenchContrib,when:Lt.Gi.inDiffEditor,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.Shift|Rt.YD.KeyO),handler:async e=>{let t,i=e.get(Pt.kt),o=e.get(Pt.W),s=i.activeEditor,r=i.activeTextEditorControl;if((0,Gt.l)(r)&&s instanceof Pt.nt)return t=r.getOriginalEditor().hasTextFocus()?s.original:s.modified,o.activeGroup.openEditor(t)}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:ss,title:(0,Rt.Lj)(3111,"Open Active Diff Side")}}),Rt.hb.registerCommandAndKeybindingRule({id:$o,weight:Rt.mb.WorkbenchContrib,when:Nt.Xn,primary:Rt.ZD.Alt|Rt.YD.F5,handler:function(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t(e,o,!0)}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:$o,title:(0,Rt.Lj)(3112,"Go to Next Change")}}),Rt.hb.registerCommandAndKeybindingRule({id:es,weight:Rt.mb.WorkbenchContrib,when:Nt.Xn,primary:Rt.ZD.Alt|Rt.ZD.Shift|Rt.YD.F5,handler:function(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t(e,o,!1)}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:es,title:(0,Rt.Lj)(3113,"Go to Previous Change")}}),function(e){e[e.Original=0]="Original",e[e.Modified=1]="Modified",e[e.Toggle=2]="Toggle"}(i||(i={})),Rt.hb.registerCommandAndKeybindingRule({id:qo,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return s(e,i)}}),Rt.hb.registerCommandAndKeybindingRule({id:ts,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return o(e,s,i.Modified)}}),Rt.hb.registerCommandAndKeybindingRule({id:is,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return o(e,s,i.Original)}}),Rt.hb.registerCommandAndKeybindingRule({id:os,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return o(e,s,i.Toggle)}}),Rt.hb.registerCommandAndKeybindingRule({id:rs,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return r(e,i)}}),Rt.hb.registerCommandAndKeybindingRule({id:ns,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return n(e,i)}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:qo,title:(0,Rt.Lj)(3114,"Toggle Inline View"),category:(0,Rt.Ij)(3115,"Compare")},when:Nt.Yn}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:ns,title:(0,Rt.Lj)(3116,"Swap Left and Right Editor Side"),category:(0,Rt.Ij)(3115,"Compare")},when:Rt.PO.and(Nt.Yn,Nt.qt)})}(),function(){function e(e,t,i){return e?[(0,xt.A)((0,xt.A)({},e.editorOptions),null!==t&&void 0!==t?t:Object.create(null)),e.sideBySide?-2:i]:[t,i]}Rt.xb.registerCommand({id:"vscode.open",handler:(e,t)=>{e.get(Rt.Cb).executeCommand(Xs,t)},metadata:{description:"Opens the provided resource in the editor.",args:[{name:"Uri"}]}}),Rt.xb.registerCommand(Xs,async function(t,i,o,s,r){let n=t.get(Pt.kt),a=t.get(Pt.W),d=t.get(Rt.yr),l=t.get(Pt.A),c=t.get(Rt.o_),h=t.get(Pt.w),u="string"==typeof i?i:Rt.wD.from(i,!0),[g,p]=null!==o&&void 0!==o?o:[];if(p||"number"==typeof g||(0,Rt.bT)(u,Rt.vT.untitled)){let t,[i,o]=e(r,p,g),d=Rt.wD.isUri(u)?u:Rt.wD.parse(u);t=h.isUntitledWithAssociatedResource(d)?{resource:d.with({scheme:l.defaultUriScheme}),forceUntitled:!0,options:i,label:s}:{resource:d,options:i,label:s},await n.openEditor(t,(0,Wt.ma)(a,c,o))}else{if((0,Rt.bT)(u,Rt.vT.command))return;await d.open(u,{openToSide:null===r||void 0===r?void 0:r.sideBySide,editorOptions:null===r||void 0===r?void 0:r.editorOptions})}}),Rt.xb.registerCommand({id:"vscode.diff",handler:(e,t,i,o)=>{e.get(Rt.Cb).executeCommand(Us,t,i,o)},metadata:{description:"Opens the provided resources in the diff editor to compare their contents.",args:[{name:"left",description:"Left-hand side resource of the diff editor"},{name:"right",description:"Right-hand side resource of the diff editor"},{name:"title",description:"Human readable title for the diff editor"}]}}),Rt.xb.registerCommand(Us,async function(t,i,o,s,r,n){let a,d,l=t.get(Pt.kt),c=t.get(Pt.W),h=t.get(Rt.o_),[u,g]=null!==r&&void 0!==r?r:[],[p,b]=e(n,g,u);"string"==typeof s?a=s:s&&(a=s.label,d=s.description),await l.openEditor({original:{resource:Rt.wD.from(i,!0)},modified:{resource:Rt.wD.from(o,!0)},label:a,description:d,options:p},(0,Wt.ma)(c,h,b))}),Rt.xb.registerCommand("_workbench.openWith",async(e,t,i,o)=>{let s=e.get(Pt.kt),r=e.get(Pt.W),n=e.get(Rt.o_),[a,d]=null!==o&&void 0!==o?o:[];await s.openEditor({resource:Rt.wD.from(t,!0),options:(0,xt.A)((0,xt.A)({pinned:!0},d),{},{override:i})},(0,Wt.ma)(r,n,a))}),Rt.xb.registerCommand({id:"vscode.changes",handler:(e,t,i)=>{e.get(Rt.Cb).executeCommand("_workbench.changes",t,i)},metadata:{description:"Opens a list of resources in the changes editor to compare their contents.",args:[{name:"title",description:"Human readable title for the diff editor"},{name:"resources",description:"List of resources to open in the changes editor"}]}}),Rt.xb.registerCommand("_workbench.changes",async(e,t,i)=>{let o=e.get(Pt.kt),s=[];for(let[r,n,a]of i)s.push({resource:Rt.wD.revive(r),original:{resource:Rt.wD.revive(n)},modified:{resource:Rt.wD.revive(a)}});await o.openEditor({resources:s,label:t})}),Rt.xb.registerCommand("_workbench.openMultiDiffEditor",async(e,t)=>{var i,o,s;let r=e.get(Pt.kt),n=null===(i=t.resources)||void 0===i?void 0:i.map(e=>({original:{resource:Rt.wD.revive(e.originalUri)},modified:{resource:Rt.wD.revive(e.modifiedUri)}})),a=null!==(o=t.reveal)&&void 0!==o&&o.modifiedUri?Rt.wD.revive(t.reveal.modifiedUri):void 0,d=a&&n?n.find(e=>(0,Rt.oT)(e.modified.resource,a)):void 0;t.reveal&&!d&&console.error("Reveal resource not found");let l={viewState:d?{revealData:{resource:{original:d.original.resource,modified:d.modified.resource},range:null===(s=t.reveal)||void 0===s?void 0:s.range}}:void 0};await r.openEditor({multiDiffSource:t.multiDiffSourceUri?Rt.wD.revive(t.multiDiffSourceUri):void 0,resources:n,label:t.title,options:l})})}(),function(){let e=(e,t)=>{let i=e.get(Pt.kt),o=i.activeEditorPane;if(o&&"number"==typeof t){let e=o.group.getEditorByIndex(t);e&&i.openEditor(e)}};Rt.xb.registerCommand({id:Ks,handler:e});for(let i=0;i<9;i++){let o=i,s=i+1;Rt.hb.registerCommandAndKeybindingRule({id:Ks+s,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:Rt.ZD.Alt|t(s),mac:{primary:Rt.ZD.WinCtrl|t(s)},handler:t=>e(t,o)})}function t(e){switch(e){case 0:return Rt.YD.Digit0;case 1:return Rt.YD.Digit1;case 2:return Rt.YD.Digit2;case 3:return Rt.YD.Digit3;case 4:return Rt.YD.Digit4;case 5:return Rt.YD.Digit5;case 6:return Rt.YD.Digit6;case 7:return Rt.YD.Digit7;case 8:return Rt.YD.Digit8;case 9:return Rt.YD.Digit9}throw Error("invalid index")}}(),function(){function e(e,t){let i,o=e.get(Pt.W),s=e.get(Pt.kt);for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(i=!t&&!n.length&&("keyboard"===o.partOptions.preventPinnedEditorClose||"keyboardAndMouse"===o.partOptions.preventPinnedEditorClose),i){let e=o.activeGroup,t=e.activeEditor;if(t&&e.isSticky(t)){var d;let t=e.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE,{excludeSticky:!0})[0];if(t)return e.openEditor(t);let i=s.getEditors(Pt.Ut.MOST_RECENTLY_ACTIVE,{excludeSticky:!0})[0];if(i)return Promise.resolve(null===(d=o.getGroup(i.groupId))||void 0===d?void 0:d.openEditor(i.editor))}}let l=(0,zt.t)(n,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt)),c=l.preserveFocus;return Promise.all(l.groupedEditors.map(async e=>{let{group:t,editors:o}=e,s=o.filter(e=>!i||!t.isSticky(e));await t.closeEditors(s,{preserveFocus:c})}))}async function t(e,t){for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];let r=e.get(Pt.kt),n=e.get(Lt.I),a=e.get(Rt.ib),d=(0,zt.t)(o,r,e.get(Pt.W),e.get(Rt.wt)),l=new Map;for(let{group:m,editors:v}of d.groupedEditors)for(let e of v){var c,h,u,g,p,b;let i=e.toUntyped();if(!i)return;i.options=(0,xt.A)((0,xt.A)({},null===(c=r.activeEditorPane)||void 0===c?void 0:c.options),{},{override:t});let o=await n.resolveEditor(i,m);if(!(0,Pt.an)(o))return;let s=l.get(m);s||(s=[],l.set(m,s)),s.push({editor:e,replacement:o.editor,forceReplaceDirty:(null===(h=e.resource)||void 0===h?void 0:h.scheme)===Rt.vT.untitled,options:o.options}),a.publicLog2("workbenchEditorReopen",{scheme:null!==(u=null===(g=e.resource)||void 0===g?void 0:g.scheme)&&void 0!==u?u:"",ext:e.resource?(0,Rt.nT)(e.resource):"",from:null!==(p=e.editorId)&&void 0!==p?p:"",to:null!==(b=o.editor.editorId)&&void 0!==b?b:""})}for(let[m,v]of l)await m.replaceEditors(v),await m.openEditor(v[0].replacement)}Rt.hb.registerCommandAndKeybindingRule({id:us,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:Rt.ZD.CtrlCmd|Rt.YD.KeyW,win:{primary:Rt.ZD.CtrlCmd|Rt.YD.F4,secondary:[Rt.ZD.CtrlCmd|Rt.YD.KeyW]},handler:function(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return e(t,!1,...o)}}),Rt.xb.registerCommand(gs,function(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return e(t,!0,...o)}),Rt.hb.registerCommandAndKeybindingRule({id:ls,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.KeyW),handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,zt.t)(i,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));return Promise.all(s.groupedEditors.map(async e=>{let{group:t}=e;await t.closeAllEditors({excludeSticky:!0})}))}}),Rt.hb.registerCommandAndKeybindingRule({id:ps,weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Nt.tn,Nt.kn),primary:Rt.ZD.CtrlCmd|Rt.YD.KeyW,win:{primary:Rt.ZD.CtrlCmd|Rt.YD.F4,secondary:[Rt.ZD.CtrlCmd|Rt.YD.KeyW]},handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(Pt.W),r=(0,zt.t)(i,e.get(Pt.kt),s,e.get(Rt.wt));r.groupedEditors.length&&s.removeGroup(r.groupedEditors[0].group)}}),Rt.hb.registerCommandAndKeybindingRule({id:ds,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.KeyU),handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,zt.t)(i,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));return Promise.all(s.groupedEditors.map(async e=>{let{group:t}=e;await t.closeEditors({savedOnly:!0,excludeSticky:!0},{preserveFocus:s.preserveFocus})}))}}),Rt.hb.registerCommandAndKeybindingRule({id:bs,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,mac:{primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.KeyT},handler:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,zt.t)(i,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));return Promise.all(s.groupedEditors.map(async e=>{let{group:t,editors:i}=e,o=t.getEditors(Pt.Ut.SEQUENTIAL,{excludeSticky:!0}).filter(e=>!i.includes(e));for(let s of i)s&&t.pinEditor(s);await t.closeEditors(o,{preserveFocus:s.preserveFocus})}))}}),Rt.hb.registerCommandAndKeybindingRule({id:hs,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,zt.t)(i,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));if(s.groupedEditors.length){let{group:e,editors:t}=s.groupedEditors[0];e.activeEditor&&e.pinEditor(e.activeEditor),await e.closeEditors({direction:Pt.Pt.RIGHT,except:t[0],excludeSticky:!0},{preserveFocus:s.preserveFocus})}}}),Rt.hb.registerCommandAndKeybindingRule({id:_s,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t(e,Rt.Xp.PICK,...o)}}),Rt.hb.registerCommandAndKeybindingRule({id:"reopenActiveEditorWith",weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e,i){for(var o=arguments.length,s=new Array(o>2?o-2:0),r=2;r<o;r++)s[r-2]=arguments[r];return t(e,null!==i&&void 0!==i?i:Rt.Xp.PICK,...s)}}),Rt.xb.registerCommand(cs,async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=e.get(Pt.W),r=(0,zt.t)(i,e.get(Pt.kt),s,e.get(Rt.wt));if(r.groupedEditors.length){let{group:e}=r.groupedEditors[0];await e.closeAllEditors(),0===e.count&&s.getGroup(e.id)&&s.removeGroup(e)}})}(),function(){function e(e,t){for(var i,o=arguments.length,s=new Array(o>2?o-2:0),r=2;r<o;r++)s[r-2]=arguments[r];let n=null===(i=(0,zt.t)(s,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt)).groupedEditors[0])||void 0===i?void 0:i.group;null===n||void 0===n||n.lock(null!==t&&void 0!==t?t:!n.isLocked)}Rt.hb.registerCommandAndKeybindingRule({id:ws,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.Enter),handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,zt.t)(i,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));for(let{group:r,editors:n}of s.groupedEditors)for(let e of n)r.pinEditor(e)}}),Rt.xb.registerCommand({id:ys,handler:e=>{let t=e.get(Rt.o_),i=!0!==t.getValue("workbench.editor.enablePreview");t.updateValue("workbench.editor.enablePreview",i)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:fs,title:(0,Rt.Lj)(3395,"Toggle Editor Group Lock"),category:Mt.s.View,f1:!0})}async run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];e(t,void 0,...o)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Ss,title:(0,Rt.Lj)(3396,"Lock Editor Group"),category:Mt.s.View,precondition:Nt.nn.toNegated(),f1:!0})}async run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];e(t,!0,...o)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Is,title:(0,Rt.Lj)(3397,"Unlock Editor Group"),precondition:Nt.nn,category:Mt.s.View,f1:!0})}async run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];e(t,!1,...o)}}),Rt.hb.registerCommandAndKeybindingRule({id:Es,weight:Rt.mb.WorkbenchContrib,when:Nt.on.toNegated(),primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.Shift|Rt.YD.Enter),handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,zt.t)(i,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));for(let{group:r,editors:n}of s.groupedEditors)for(let e of n)r.stickEditor(e)}}),Rt.hb.registerCommandAndKeybindingRule({id:As,weight:Rt.mb.WorkbenchContrib,when:Nt.on,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.Shift|Rt.YD.Enter),handler:async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];let s=(0,zt.t)(i,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));for(let{group:r,editors:n}of s.groupedEditors)for(let e of n)r.unstickEditor(e)}}),Rt.hb.registerCommandAndKeybindingRule({id:ks,weight:Rt.mb.WorkbenchContrib,when:void 0,primary:void 0,handler:function(e){for(var t,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];let r=e.get(Pt.W),n=e.get(Rt.xc),a=null===(t=(0,zt.t)(o,e.get(Pt.kt),r,e.get(Rt.wt)).groupedEditors[0])||void 0===t?void 0:t.group;return a&&r.activateGroup(a),n.quickAccess.show(Mo.PREFIX)}})}(),function(){async function e(e,t){let i=e.get(Rt.Ub);if(!t.groupedEditors.length)return;let{group:o,editors:s}=t.groupedEditors[0],r=s[0];r&&await o.replaceEditors([{editor:r,replacement:i.createInstance(Pt.Et,void 0,void 0,r,r),forceReplaceDirty:!0}])}async function t(e){if(!e.groupedEditors.length)return;let{group:t,editors:i}=e.groupedEditors[0],o=i[0];if(!o||!(o instanceof Pt.Et))return;let s,r=t.activeEditorPane;if(r instanceof zt.o&&t.activeEditor===o)for(let n of[r.getPrimaryEditorPane(),r.getSecondaryEditorPane()])if(null!==n&&void 0!==n&&n.hasFocus()){s={viewState:n.getViewState()};break}await t.replaceEditors([{editor:o,replacement:o.primary,options:s}])}(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Ns,title:(0,Rt.Lj)(3388,"Split Editor in Group"),category:Mt.s.View,precondition:Nt.Xt,f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,when:Nt.Xt,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Backslash)}})}run(t){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return e(t,(0,zt.t)(o,t.get(Pt.kt),t.get(Pt.W),t.get(Rt.wt)))}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Ps,title:(0,Rt.Lj)(3389,"Join Editor in Group"),category:Mt.s.View,precondition:Nt.Wn,f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,when:Nt.Wn,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Backslash)}})}run(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return t((0,zt.t)(o,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt)))}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.toggleSplitEditorInGroup",title:(0,Rt.Lj)(3390,"Toggle Split Editor in Group"),category:Mt.s.View,precondition:Rt.PO.or(Nt.Xt,Nt.Wn),f1:!0})}async run(i){for(var o=arguments.length,s=new Array(o>1?o-1:0),r=1;r<o;r++)s[r-1]=arguments[r];let n=(0,zt.t)(s,i.get(Pt.kt),i.get(Pt.W),i.get(Rt.wt));if(!n.groupedEditors.length)return;let{editors:a}=n.groupedEditors[0];a[0]instanceof Pt.Et?await t(n):a[0]&&await e(i,n)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Js,title:(0,Rt.Lj)(3391,"Toggle Layout of Split Editor in Group"),category:Mt.s.View,precondition:Nt.Wn,f1:!0})}async run(e){let t,i=e.get(Rt.o_);return t="horizontal"===i.getValue(zt.o.SIDE_BY_SIDE_LAYOUT_SETTING)?"vertical":"horizontal",i.updateValue(zt.o.SIDE_BY_SIDE_LAYOUT_SETTING,t)}})}(),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Bs,title:(0,Rt.Lj)(3392,"Focus First Side in Active Editor"),category:Mt.s.View,precondition:Rt.PO.or(Nt.Wn,Nt.Yn),f1:!0})}async run(e){var t;let i=e.get(Pt.kt),o=e.get(Rt.Cb),s=i.activeEditorPane;s instanceof zt.o?null===(t=s.getSecondaryEditorPane())||void 0===t||t.focus():s instanceof zo&&await o.executeCommand(is)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Os,title:(0,Rt.Lj)(3393,"Focus Second Side in Active Editor"),category:Mt.s.View,precondition:Rt.PO.or(Nt.Wn,Nt.Yn),f1:!0})}async run(e){var t;let i=e.get(Pt.kt),o=e.get(Rt.Cb),s=i.activeEditorPane;s instanceof zt.o?null===(t=s.getPrimaryEditorPane())||void 0===t||t.focus():s instanceof zo&&await o.executeCommand(ts)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.focusOtherSideEditor",title:(0,Rt.Lj)(3394,"Focus Other Side in Active Editor"),category:Mt.s.View,precondition:Rt.PO.or(Nt.Wn,Nt.Yn),f1:!0})}async run(e){var t,i,o;let s=e.get(Pt.kt),r=e.get(Rt.Cb),n=s.activeEditorPane;n instanceof zt.o?null!==(t=n.getPrimaryEditorPane())&&void 0!==t&&t.hasFocus()?null===(i=n.getSecondaryEditorPane())||void 0===i||i.focus():null===(o=n.getPrimaryEditorPane())||void 0===o||o.focus():n instanceof zo&&await r.executeCommand(os)}}),function(){for(let i=1;i<8;i++)Rt.hb.registerCommandAndKeybindingRule({id:e(i),weight:Rt.mb.WorkbenchContrib,when:void 0,primary:Rt.ZD.CtrlCmd|t(i),handler:e=>{let t=e.get(Pt.W),o=e.get(Rt.o_);if(i>t.count)return;let s=t.getGroups(Pt.X.GRID_APPEARANCE);if(s[i])return s[i].focus();let r=(0,Pt.tt)(o),n=t.findGroup({location:Pt.q.LAST});n&&t.addGroup(n,r).focus()}});function e(e){switch(e){case 1:return"workbench.action.focusSecondEditorGroup";case 2:return"workbench.action.focusThirdEditorGroup";case 3:return"workbench.action.focusFourthEditorGroup";case 4:return"workbench.action.focusFifthEditorGroup";case 5:return"workbench.action.focusSixthEditorGroup";case 6:return"workbench.action.focusSeventhEditorGroup";case 7:return"workbench.action.focusEighthEditorGroup"}throw Error("Invalid index")}function t(e){switch(e){case 1:return Rt.YD.Digit2;case 2:return Rt.YD.Digit3;case 3:return Rt.YD.Digit4;case 4:return Rt.YD.Digit5;case 5:return Rt.YD.Digit6;case 6:return Rt.YD.Digit7;case 7:return Rt.YD.Digit8}throw Error("Invalid index")}}(),[{id:xs,direction:Pt.K.UP},{id:Vs,direction:Pt.K.DOWN},{id:Rs,direction:Pt.K.LEFT},{id:Ts,direction:Pt.K.RIGHT}].forEach(e=>{let{id:t,direction:i}=e;Rt.xb.registerCommand(t,function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),s=1;s<t;s++)o[s-1]=arguments[s];let r=(0,zt.t)(o,e.get(Pt.kt),e.get(Pt.W),e.get(Rt.wt));$s(e.get(Pt.W),i,r)})}),function(){let e=[{id:"workbench.action.focusLeftGroupWithoutWrap",direction:Pt.K.LEFT},{id:"workbench.action.focusRightGroupWithoutWrap",direction:Pt.K.RIGHT},{id:"workbench.action.focusAboveGroupWithoutWrap",direction:Pt.K.UP},{id:"workbench.action.focusBelowGroupWithoutWrap",direction:Pt.K.DOWN}];for(let t of e)Rt.xb.registerCommand(t.id,async e=>{var i;let o=e.get(Pt.W);(null!==(i=o.findGroup({direction:t.direction},o.activeGroup,!1))&&void 0!==i?i:o.activeGroup).focus()})}(),Rt.Cj&&(Rt.lb.appendMenuItem(Rt.sb.TouchBarContext,{command:{id:Tr.ID,title:Tr.LABEL,icon:{dark:Rt.gT.asFileUri("vs/workbench/browser/parts/editor/media/back-tb.png")}},group:"navigation",order:0}),Rt.lb.appendMenuItem(Rt.sb.TouchBarContext,{command:{id:Rr.ID,title:Rr.LABEL,icon:{dark:Rt.gT.asFileUri("vs/workbench/browser/parts/editor/media/forward-tb.png")}},group:"navigation",order:1})),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroup,{command:{id:Ss,title:(0,Rt.Ij)(3125,"Lock Group"),icon:Rt.mD.unlock},group:"navigation",order:10,when:Rt.PO.and(Nt.Sn,Nt.nn.toNegated())}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroup,{command:{id:Is,title:(0,Rt.Ij)(3126,"Unlock Group"),icon:Rt.mD.lock,toggled:Rt.PO.true()},group:"navigation",order:10,when:Nt.nn}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroup,{command:{id:ps,title:(0,Rt.Ij)(3127,"Close Group"),icon:Rt.mD.close},group:"navigation",order:20,when:Rt.PO.or(Nt.Sn,Nt.hn)}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroupContext,{command:{id:xs,title:(0,Rt.Ij)(3128,"Split Up")},group:"2_split",order:10}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroupContext,{command:{id:Vs,title:(0,Rt.Ij)(3129,"Split Down")},group:"2_split",order:20}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroupContext,{command:{id:Rs,title:(0,Rt.Ij)(3130,"Split Left")},group:"2_split",order:30}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroupContext,{command:{id:Ts,title:(0,Rt.Ij)(3131,"Split Right")},group:"2_split",order:40}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroupContext,{command:{id:Hs,title:(0,Rt.Ij)(3132,"New Window")},group:"3_window",order:10}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroupContext,{command:{id:fs,title:(0,Rt.Ij)(3133,"Lock Group"),toggled:Nt.nn},group:"4_lock",order:10,when:Nt.Sn.toNegated()}),Rt.lb.appendMenuItem(Rt.sb.EmptyEditorGroupContext,{command:{id:ps,title:(0,Rt.Ij)(3134,"Close")},group:"5_close",order:10,when:Nt.kn}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{command:{id:xs,title:(0,Rt.Ij)(3128,"Split Up")},group:"2_split",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{command:{id:Vs,title:(0,Rt.Ij)(3129,"Split Down")},group:"2_split",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{command:{id:Rs,title:(0,Rt.Ij)(3130,"Split Left")},group:"2_split",order:30}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{command:{id:Ts,title:(0,Rt.Ij)(3131,"Split Right")},group:"2_split",order:40}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{command:{id:Qs,title:(0,Rt.Ij)(3135,"Move into New Window")},group:"3_window",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{command:{id:Ys,title:(0,Rt.Ij)(3136,"Copy into New Window")},group:"3_window",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{submenu:Rt.sb.EditorTabsBarShowTabsSubmenu,title:(0,Rt.Ij)(3137,"Tab Bar"),group:"4_config",order:10,when:Nt.xn.negate()}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarShowTabsSubmenu,{command:{id:Tt.J.ID,title:(0,Rt.Ij)(3138,"Multiple Tabs"),toggled:Rt.PO.equals("config.workbench.editor.showTabs","multiple")},group:"1_config",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarShowTabsSubmenu,{command:{id:Tt.Y.ID,title:(0,Rt.Ij)(3139,"Single Tab"),toggled:Rt.PO.equals("config.workbench.editor.showTabs","single")},group:"1_config",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarShowTabsSubmenu,{command:{id:Tt.q.ID,title:(0,Rt.Ij)(3140,"Hidden"),toggled:Rt.PO.equals("config.workbench.editor.showTabs","none")},group:"1_config",order:30}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{submenu:Rt.sb.EditorTabsBarShowTabsZenModeSubmenu,title:(0,Rt.Ij)(3137,"Tab Bar"),group:"4_config",order:10,when:Nt.xn}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:Tt.et.ID,title:(0,Rt.Ij)(3138,"Multiple Tabs"),toggled:Rt.PO.equals("config.zenMode.showTabs","multiple")},group:"1_config",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:Tt.tt.ID,title:(0,Rt.Ij)(3139,"Single Tab"),toggled:Rt.PO.equals("config.zenMode.showTabs","single")},group:"1_config",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:Tt.$.ID,title:(0,Rt.Ij)(3140,"Hidden"),toggled:Rt.PO.equals("config.zenMode.showTabs","none")},group:"1_config",order:30}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{submenu:Rt.sb.EditorActionsPositionSubmenu,title:(0,Rt.Ij)(3141,"Editor Actions Position"),group:"4_config",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorActionsPositionSubmenu,{command:{id:Tt.W.ID,title:(0,Rt.Ij)(3137,"Tab Bar"),toggled:Rt.PO.equals("config.workbench.editor.editorActionsLocation","default")},group:"1_config",order:10,when:Rt.PO.equals("config.workbench.editor.showTabs","none").negate()}),Rt.lb.appendMenuItem(Rt.sb.EditorActionsPositionSubmenu,{command:{id:Tt.G.ID,title:(0,Rt.Ij)(3142,"Title Bar"),toggled:Rt.PO.or(Rt.PO.equals("config.workbench.editor.editorActionsLocation","titleBar"),Rt.PO.and(Rt.PO.equals("config.workbench.editor.showTabs","none"),Rt.PO.equals("config.workbench.editor.editorActionsLocation","default")))},group:"1_config",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorActionsPositionSubmenu,{command:{id:Tt.K.ID,title:(0,Rt.Ij)(3143,"Hidden"),toggled:Rt.PO.equals("config.workbench.editor.editorActionsLocation","hidden")},group:"1_config",order:30}),Rt.lb.appendMenuItem(Rt.sb.EditorTabsBarContext,{command:{id:Tt.U.ID,title:(0,Rt.Ij)(3144,"Configure Tabs")},group:"9_configure",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:us,title:(0,Rt.Ij)(3134,"Close")},group:"1_close",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:bs,title:(0,Rt.Ij)(3145,"Close Others"),precondition:Nt.pn.notEqualsTo("1")},group:"1_close",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:hs,title:(0,Rt.Ij)(3146,"Close to the Right"),precondition:Rt.PO.and(Nt.rn.toNegated(),Nt.An.negate())},group:"1_close",order:30,when:Nt.gn}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:ds,title:(0,Rt.Ij)(3147,"Close Saved")},group:"1_close",order:40}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:ls,title:(0,Rt.Ij)(3148,"Close All")},group:"1_close",order:50}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:_s,title:(0,Rt.Ij)(3149,"Reopen Editor With...")},group:"1_open",order:10,when:Nt.Jt}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:ws,title:(0,Rt.Ij)(3150,"Keep Open"),precondition:Nt.in.toNegated()},group:"3_preview",order:10,when:Rt.PO.has("config.workbench.editor.enablePreview")}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:Es,title:(0,Rt.Ij)(3151,"Pin")},group:"3_preview",order:20,when:Nt.on.toNegated()}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:As,title:(0,Rt.Ij)(3152,"Unpin")},group:"3_preview",order:20,when:Nt.on}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:Ds,title:(0,Rt.Ij)(3131,"Split Right")},group:"5_split",order:10,when:Nt.Kn.negate()}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:Ds,title:(0,Rt.Ij)(3129,"Split Down")},group:"5_split",order:10,when:Nt.Kn}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{submenu:Rt.sb.EditorSplitMoveSubmenu,title:(0,Rt.Ij)(3153,"Split & Move"),group:"5_split",order:15}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:Ms,title:(0,Rt.Ij)(3154,"Move into New Window")},group:"7_new_window",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{command:{id:js,title:(0,Rt.Ij)(3155,"Copy into New Window")},group:"7_new_window",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorTitleContext,{submenu:Rt.sb.EditorTitleContextShare,title:(0,Rt.Ij)(3156,"Share"),group:"11_share",order:-1,when:Nt.An.negate()}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:xs,title:(0,Rt.Ij)(3128,"Split Up")},group:"1_split",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Vs,title:(0,Rt.Ij)(3129,"Split Down")},group:"1_split",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Rs,title:(0,Rt.Ij)(3130,"Split Left")},group:"1_split",order:30}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Ts,title:(0,Rt.Ij)(3131,"Split Right")},group:"1_split",order:40}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Ls,title:(0,Rt.Ij)(3157,"Move Above")},group:"2_move",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Ws,title:(0,Rt.Ij)(3158,"Move Below")},group:"2_move",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Fs,title:(0,Rt.Ij)(3159,"Move Left")},group:"2_move",order:30}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Gs,title:(0,Rt.Ij)(3160,"Move Right")},group:"2_move",order:40}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Ns,title:(0,Rt.Ij)(3161,"Split in Group"),precondition:Nt.An.negate()},group:"3_split_in_group",order:10,when:Nt.Xt}),Rt.lb.appendMenuItem(Rt.sb.EditorSplitMoveSubmenu,{command:{id:Ps,title:(0,Rt.Ij)(3162,"Join in Group"),precondition:Nt.An.negate()},group:"3_split_in_group",order:10,when:Nt.Wn}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:qo,title:(0,Rt.Ij)(3163,"Inline View"),toggled:Rt.PO.equals("config.diffEditor.renderSideBySide",!1)},group:"1_diff",order:10,when:Rt.PO.has("isInDiffEditor")}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:ks,title:(0,Rt.Ij)(3164,"Show Opened Editors")},group:"3_open",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:ls,title:(0,Rt.Ij)(3148,"Close All")},group:"5_close",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:ds,title:(0,Rt.Ij)(3147,"Close Saved")},group:"5_close",order:20}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:ys,title:(0,Rt.Ij)(3165,"Enable Preview Editors"),toggled:Rt.PO.has("config.workbench.editor.enablePreview")},group:"7_settings",order:10}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:Zs,title:(0,Rt.Ij)(3166,"Maximize Group")},group:"8_group_operations",order:5,when:Rt.PO.and(Nt.mn.negate(),Nt.hn)}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:Zs,title:(0,Rt.Ij)(3167,"Unmaximize Group")},group:"8_group_operations",order:5,when:Nt.mn}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:fs,title:(0,Rt.Ij)(3168,"Lock Group"),toggled:Nt.nn},group:"8_group_operations",order:10,when:Nt.Sn.toNegated()}),Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:Tt.H.ID,title:(0,Rt.Ij)(3169,"Configure Editors")},group:"9_configure",order:10});var ep=1e5,tp=1e6;$g({id:Ds,title:(0,Rt.Ij)(3170,"Split Editor Right"),icon:Rt.mD.splitHorizontal},Nt.Kn.negate(),ep,{id:Vs,title:(0,Rt.Ij)(3171,"Split Editor Down"),icon:Rt.mD.splitVertical}),$g({id:Ds,title:(0,Rt.Ij)(3171,"Split Editor Down"),icon:Rt.mD.splitVertical},Nt.Kn,ep,{id:Ts,title:(0,Rt.Ij)(3170,"Split Editor Right"),icon:Rt.mD.splitHorizontal}),$g({id:Js,title:(0,Rt.Ij)(3172,"Toggle Layout"),icon:Rt.mD.editorLayout},Nt.Wn,99999),$g({id:us,title:(0,Rt.Ij)(3134,"Close"),icon:Rt.mD.close},Rt.PO.and(Nt.gn.toNegated(),Nt.$t.toNegated(),Nt.on.toNegated()),tp,{id:ls,title:(0,Rt.Ij)(3148,"Close All"),icon:Rt.mD.closeAll}),$g({id:us,title:(0,Rt.Ij)(3134,"Close"),icon:Rt.mD.closeDirty},Rt.PO.and(Nt.gn.toNegated(),Nt.$t,Nt.on.toNegated()),tp,{id:ls,title:(0,Rt.Ij)(3148,"Close All"),icon:Rt.mD.closeAll}),$g({id:As,title:(0,Rt.Ij)(3152,"Unpin"),icon:Rt.mD.pinned},Rt.PO.and(Nt.gn.toNegated(),Nt.$t.toNegated(),Nt.on),tp,{id:us,title:(0,Rt.Ij)(3134,"Close"),icon:Rt.mD.close}),$g({id:As,title:(0,Rt.Ij)(3152,"Unpin"),icon:Rt.mD.pinnedDirty},Rt.PO.and(Nt.gn.toNegated(),Nt.$t,Nt.on),tp,{id:us,title:(0,Rt.Ij)(3134,"Close"),icon:Rt.mD.close}),$g({id:Ss,title:(0,Rt.Ij)(3173,"Lock Group"),icon:Rt.mD.unlock},Rt.PO.and(Nt.Sn,Nt.nn.toNegated()),999999),$g({id:Is,title:(0,Rt.Ij)(3174,"Unlock Group"),icon:Rt.mD.lock,toggled:Rt.PO.true()},Nt.nn,999999);var ip=(0,Rt.J)("diff-editor-previous-change",Rt.mD.arrowUp,(0,Rt.Ij)(3175,"Icon for the previous change action in the diff editor."));$g({id:es,title:(0,Rt.Ij)(3176,"Previous Change"),icon:ip},Nt.Yn,10,void 0,Lt.Gi.hasChanges,!0);var op=(0,Rt.J)("diff-editor-next-change",Rt.mD.arrowDown,(0,Rt.Ij)(3177,"Icon for the next change action in the diff editor."));$g({id:$o,title:(0,Rt.Ij)(3178,"Next Change"),icon:op},Nt.Yn,11,void 0,Lt.Gi.hasChanges,!0),$g({id:ns,title:(0,Rt.Ij)(3179,"Swap Left and Right Side"),icon:Rt.mD.arrowSwap},Rt.PO.and(Nt.Yn,Nt.qt),15,void 0,void 0);var sp=(0,Rt.J)("diff-editor-toggle-whitespace",Rt.mD.whitespace,(0,Rt.Ij)(3180,"Icon for the toggle whitespace action in the diff editor."));Rt.lb.appendMenuItem(Rt.sb.EditorTitle,{command:{id:rs,title:(0,Rt.Ij)(3181,"Show Leading/Trailing Whitespace Differences"),icon:sp,precondition:Nt.Yn,toggled:Rt.PO.equals("config.diffEditor.ignoreTrimWhitespace",!1)},group:"navigation",when:Nt.Yn,order:20}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:ws,title:(0,Rt.Lj)(3182,"Keep Editor"),category:Mt.s.View},when:Rt.PO.has("config.workbench.editor.enablePreview")}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:Es,title:(0,Rt.Lj)(3183,"Pin Editor"),category:Mt.s.View}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:As,title:(0,Rt.Lj)(3184,"Unpin Editor"),category:Mt.s.View}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:us,title:(0,Rt.Lj)(3185,"Close Editor"),category:Mt.s.View}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:gs,title:(0,Rt.Lj)(3186,"Close Pinned Editor"),category:Mt.s.View}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:ls,title:(0,Rt.Lj)(3187,"Close All Editors in Group"),category:Mt.s.View}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:ds,title:(0,Rt.Lj)(3188,"Close Saved Editors in Group"),category:Mt.s.View}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:bs,title:(0,Rt.Lj)(3189,"Close Other Editors in Group"),category:Mt.s.View}}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:hs,title:(0,Rt.Lj)(3190,"Close Editors to the Right in Group"),category:Mt.s.View},when:Nt.rn.toNegated()}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:cs,title:(0,Rt.Lj)(3191,"Close Editor Group"),category:Mt.s.View},when:Nt.kn}),Rt.lb.appendMenuItem(Rt.sb.CommandPalette,{command:{id:_s,title:(0,Rt.Lj)(3149,"Reopen Editor With..."),category:Mt.s.View},when:Nt.Jt}),Rt.lb.appendMenuItem(Rt.sb.MenubarRecentMenu,{group:"1_editor",command:{id:Or.ID,title:(0,Rt.Ij)(3192,"&&Reopen Closed Editor"),precondition:Rt.PO.has("canReopenClosedEditor")},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarRecentMenu,{group:"z_clear",command:{id:Kr.ID,title:(0,Rt.Ij)(3193,"&&Clear Recently Opened...")},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{title:(0,Rt.Ij)(3194,"Share"),submenu:Rt.sb.MenubarShare,group:"45_share",order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarViewMenu,{group:"2_appearance",title:(0,Rt.Ij)(3195,"Editor &&Layout"),submenu:Rt.sb.MenubarLayoutMenu,order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"1_split",command:{id:xs,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3196,"Split Up")),{},{mnemonicTitle:(0,Rt.Ij)(3197,"Split &&Up")})},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"1_split",command:{id:Vs,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3198,"Split Down")),{},{mnemonicTitle:(0,Rt.Ij)(3199,"Split &&Down")})},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"1_split",command:{id:Rs,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3200,"Split Left")),{},{mnemonicTitle:(0,Rt.Ij)(3201,"Split &&Left")})},order:3}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"1_split",command:{id:Ts,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3202,"Split Right")),{},{mnemonicTitle:(0,Rt.Ij)(3203,"Split &&Right")})},order:4}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"2_split_in_group",command:{id:Ns,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3204,"Split in Group")),{},{mnemonicTitle:(0,Rt.Ij)(3205,"Split in &&Group")})},when:Nt.Xt,order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"2_split_in_group",command:{id:Ps,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3206,"Join in Group")),{},{mnemonicTitle:(0,Rt.Ij)(3207,"Join in &&Group")})},when:Nt.Wn,order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"3_new_window",command:{id:Ms,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3208,"Move Editor into New Window")),{},{mnemonicTitle:(0,Rt.Ij)(3209,"&&Move Editor into New Window")})},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"3_new_window",command:{id:js,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3210,"Copy Editor into New Window")),{},{mnemonicTitle:(0,Rt.Ij)(3211,"&&Copy Editor into New Window")})},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:on.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3212,"Single")),{},{mnemonicTitle:(0,Rt.Ij)(3213,"&&Single")})},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:sn.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3214,"Two Columns")),{},{mnemonicTitle:(0,Rt.Ij)(3215,"&&Two Columns")})},order:3}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:rn.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3216,"Three Columns")),{},{mnemonicTitle:(0,Rt.Ij)(3217,"T&&hree Columns")})},order:4}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:nn.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3218,"Two Rows")),{},{mnemonicTitle:(0,Rt.Ij)(3219,"T&&wo Rows")})},order:5}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:an.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3220,"Three Rows")),{},{mnemonicTitle:(0,Rt.Ij)(3221,"Three &&Rows")})},order:6}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:dn.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3222,"Grid (2x2)")),{},{mnemonicTitle:(0,Rt.Ij)(3223,"&&Grid (2x2)")})},order:7}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:cn.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3224,"Two Rows Right")),{},{mnemonicTitle:(0,Rt.Ij)(3225,"Two R&&ows Right")})},order:8}),Rt.lb.appendMenuItem(Rt.sb.MenubarLayoutMenu,{group:"4_layouts",command:{id:ln.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(3226,"Two Columns Bottom")),{},{mnemonicTitle:(0,Rt.Ij)(3227,"Two &&Columns Bottom")})},order:9}),Rt.lb.appendMenuItem(Rt.sb.MenubarGoMenu,{group:"1_history_nav",command:{id:"workbench.action.navigateToLastEditLocation",title:(0,Rt.Ij)(3228,"&&Last Edit Location"),precondition:Rt.PO.has("canNavigateToLastEditLocation")},order:3}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"1_sideBySide",command:{id:Bs,title:(0,Rt.Ij)(3229,"&&First Side in Editor")},when:Rt.PO.or(Nt.Wn,Nt.Yn),order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"1_sideBySide",command:{id:Os,title:(0,Rt.Ij)(3230,"&&Second Side in Editor")},when:Rt.PO.or(Nt.Wn,Nt.Yn),order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"2_any",command:{id:"workbench.action.nextEditor",title:(0,Rt.Ij)(3231,"&&Next Editor")},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"2_any",command:{id:"workbench.action.previousEditor",title:(0,Rt.Ij)(3232,"&&Previous Editor")},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"3_any_used",command:{id:"workbench.action.openNextRecentlyUsedEditor",title:(0,Rt.Ij)(3233,"&&Next Used Editor")},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"3_any_used",command:{id:"workbench.action.openPreviousRecentlyUsedEditor",title:(0,Rt.Ij)(3234,"&&Previous Used Editor")},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"4_group",command:{id:"workbench.action.nextEditorInGroup",title:(0,Rt.Ij)(3235,"&&Next Editor in Group")},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"4_group",command:{id:"workbench.action.previousEditorInGroup",title:(0,Rt.Ij)(3236,"&&Previous Editor in Group")},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"5_group_used",command:{id:"workbench.action.openNextRecentlyUsedEditorInGroup",title:(0,Rt.Ij)(3237,"&&Next Used Editor in Group")},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchEditorMenu,{group:"5_group_used",command:{id:"workbench.action.openPreviousRecentlyUsedEditorInGroup",title:(0,Rt.Ij)(3238,"&&Previous Used Editor in Group")},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarGoMenu,{group:"2_editor_nav",title:(0,Rt.Ij)(3239,"Switch &&Editor"),submenu:Rt.sb.MenubarSwitchEditorMenu,order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFirstEditorGroup",title:(0,Rt.Ij)(3240,"Group &&1")},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusSecondEditorGroup",title:(0,Rt.Ij)(3241,"Group &&2")},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusThirdEditorGroup",title:(0,Rt.Ij)(3242,"Group &&3"),precondition:Nt.kn},order:3}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFourthEditorGroup",title:(0,Rt.Ij)(3243,"Group &&4"),precondition:Nt.kn},order:4}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFifthEditorGroup",title:(0,Rt.Ij)(3244,"Group &&5"),precondition:Nt.kn},order:5}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"2_next_prev",command:{id:"workbench.action.focusNextGroup",title:(0,Rt.Ij)(3245,"&&Next Group"),precondition:Nt.kn},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"2_next_prev",command:{id:"workbench.action.focusPreviousGroup",title:(0,Rt.Ij)(3246,"&&Previous Group"),precondition:Nt.kn},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusLeftGroup",title:(0,Rt.Ij)(3247,"Group &&Left"),precondition:Nt.kn},order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusRightGroup",title:(0,Rt.Ij)(3248,"Group &&Right"),precondition:Nt.kn},order:2}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusAboveGroup",title:(0,Rt.Ij)(3249,"Group &&Above"),precondition:Nt.kn},order:3}),Rt.lb.appendMenuItem(Rt.sb.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusBelowGroup",title:(0,Rt.Ij)(3250,"Group &&Below"),precondition:Nt.kn},order:4}),Rt.lb.appendMenuItem(Rt.sb.MenubarGoMenu,{group:"2_editor_nav",title:(0,Rt.Ij)(3251,"Switch &&Group"),submenu:Rt.sb.MenubarSwitchGroupMenu,order:2}),(0,Rt.Oo)(Lt.Pi),(0,Rt.Ib)(),(0,Rt.TD)(),(0,Nt.gr)(),(0,Wt.$i)(),(0,Wt.Qv)(),(0,Rt.Db)();var rp=(We=class{constructor(e){this._webviewWorkbenchService=e}canSerialize(e){return this._webviewWorkbenchService.shouldPersist(e)}serialize(e){if(!this.canSerialize(e))return;let t=this.toJson(e);try{return JSON.stringify(t)}catch(i){return}}deserialize(e,t){let i=this.fromJson(JSON.parse(t));return this._webviewWorkbenchService.openRevivedWebview({webviewInitInfo:{providedViewType:i.providedId,origin:i.origin,title:i.title,options:i.webviewOptions,contentOptions:i.contentOptions,extension:i.extension},viewType:i.viewType,title:i.title,iconPath:i.iconPath,state:i.state,group:i.group})}fromJson(e){return(0,xt.A)((0,xt.A)({},e),{},{extension:np(e.extensionId,e.extensionLocation),iconPath:ap(e.iconPath),state:lp(e.state),webviewOptions:e.options,contentOptions:cp(e.options)})}toJson(e){var t,i;return{origin:e.webview.origin,viewType:e.viewType,providedId:e.providerId,title:e.getName(),options:(0,xt.A)((0,xt.A)({},e.webview.options),e.webview.contentOptions),extensionLocation:null===(t=e.extension)||void 0===t?void 0:t.location,extensionId:null===(i=e.extension)||void 0===i?void 0:i.id.value,state:e.webview.state,iconPath:e.iconPath?Rt.Eb.isThemeIcon(e.iconPath)?e.iconPath:{light:e.iconPath.light,dark:e.iconPath.dark}:void 0,group:e.group}}},{_:We.ID=Wt.Qi.typeId},We);function np(e,t){if(!e)return;let i=dp(t);return i?{id:new Nt.lr(e),location:i}:void 0}function ap(e){if(!e)return;if(Rt.Eb.isThemeIcon(e))return e;let t=dp(e.light),i=dp(e.dark);return t&&i?{light:t,dark:i}:void 0}function dp(e){if(e)try{return"string"==typeof e?Rt.wD.parse(e):Rt.wD.from(e)}catch(t){return}}function lp(e){return"string"==typeof e?e:void 0}function cp(e){var t;return(0,xt.A)((0,xt.A)({},e),{},{localResourceRoots:null===(t=e.localResourceRoots)||void 0===t?void 0:t.map(e=>dp(e))})}rp=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.Zv)],rp),(0,Rt.Ib)(),(0,Rt.PA)(),(0,Rt.yT)(),(0,Rt.iT)(),(0,Rt.TD)(),(0,Rt.Kb)(),(0,Wt.qi)(),(0,Wt.Mb)(),(0,Wt.od)(),(0,Wt.pt)(),(0,Wt.ey)(),(0,Wt.Qv)(),(0,Nt.bt)(),(0,Wt.w_)();var hp=(Fe=class extends rp{constructor(e,t,i){super(e),this._instantiationService=t,this._webviewService=i}serialize(e){let t=e.isDirty(),i=(0,xt.A)((0,xt.A)({},this.toJson(e)),{},{editorResource:e.resource.toJSON(),dirty:t,backupId:t?e.backupId:void 0});try{return JSON.stringify(i)}catch(o){return}}fromJson(e){return(0,xt.A)((0,xt.A)({},super.fromJson(e)),{},{editorResource:Rt.wD.from(e.editorResource),dirty:e.dirty})}deserialize(e,t){let i=this.fromJson(JSON.parse(t)),o=up(this._webviewService,i),s=this._instantiationService.createInstance(Wt.Ki,{resource:i.editorResource,viewType:i.viewType,webviewTitle:i.title,iconPath:i.iconPath},o,{startsDirty:i.dirty,backupId:i.backupId});return"number"==typeof i.group&&s.updateGroup(i.group),s}},{_:Fe.ID=Wt.Ki.typeId},Fe);function up(e,t){let i=e.createWebviewOverlay({providedViewType:t.viewType,origin:t.origin,title:t.title,options:{purpose:Wt.dt.CustomEditor,enableFindWidget:t.webviewOptions.enableFindWidget,retainContextWhenHidden:t.webviewOptions.retainContextWhenHidden},contentOptions:t.contentOptions,extension:t.extension});return i.state=t.state,i}hp=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.Zv),(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Wt.$v)],hp);var gp=(Ge=class extends Rt.CA{constructor(e,t,i,o,s){super(),this._instantiationService=e,this._workingCopyBackupService=i,this._webviewService=o,this._register(t.registerHandler(this))}handles(e){return e.resource.scheme===Rt.vT.vscodeCustomEditor}isOpen(e,t){if(!this.handles(e))return!1;if("jupyter-notebook-ipynb"===e.resource.authority&&t instanceof Wt.ad)try{let i=JSON.parse(e.resource.query);return(0,Rt.oT)(Rt.wD.from(i),t.resource)}catch(i){return!1}if(!(t instanceof Wt.Ki)||e.resource.authority!==t.viewType.replace(/[^a-z0-9\-_]/gi,"-").toLowerCase())return!1;try{let i=JSON.parse(e.resource.query);return(0,Rt.oT)(Rt.wD.from(i),t.resource)}catch(o){return!1}}async createEditor(e){var t,i;let o=await this._workingCopyBackupService.resolve(e);if(null===o||void 0===o||!o.meta)throw Error("No backup found for custom editor: ".concat(e.resource));let s=o.meta,r=np(null===(t=s.extension)||void 0===t?void 0:t.id,null===(i=s.extension)||void 0===i?void 0:i.location),n=up(this._webviewService,{viewType:s.viewType,origin:s.webview.origin,webviewOptions:s.webview.options,contentOptions:cp(s.webview.options),state:s.webview.state,extension:r,title:s.customTitle}),a=this._instantiationService.createInstance(Wt.Ki,{resource:Rt.wD.revive(s.editorResource),viewType:s.viewType,webviewTitle:s.customTitle,iconPath:ap(s.iconPath)},n,{backupId:s.backupId});return a.updateGroup(0),a}},{_:Ge.ID="workbench.contrib.complexCustomWorkingCopyEditorHandler"},Ge);gp=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ub),(0,Rt.Fb)(1,Wt.C_),(0,Rt.Fb)(2,Nt.yt),(0,Rt.Fb)(3,Wt.$v),(0,Rt.Fb)(4,Wt.jb)],gp),(0,Rt.sm)(),(0,Rt.im)(),(0,Rt.vb)(),(0,Tt.f)(),(0,Pt.b)(),(0,Pt.en)(),(0,Rt.Kb)(),(0,Wt.Zi)(),(0,Wt.qi)(),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(Wt.Xi,Wt.Xi.ID,"Webview Editor"),[new Rt.om(Wt.Ki)]),Rt._b.as(Pt.Rt.EditorFactory).registerEditorSerializer(hp.ID,hp),(0,Pt.x)(gp.ID,gp,Pt.y.BlockStartup),(0,Rt.tO)(),(0,Lt.Ki)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.IO)(),(0,Rt.gb)(),(0,Mt.c)(),(0,Wt.pt)(),(0,Wt.ey)(),(0,Wt.Zi)(),(0,Wt.$i)(),(0,Pt.At)();var pp=Rt.PO.and(Rt.PO.equals("activeEditor",Wt.Xi.ID),Lt.Gi.focus.toNegated()),bp=(Ze=class e extends Rt.ob{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:Rt.PO.and(pp,Wt.ct),primary:Rt.ZD.CtrlCmd|Rt.YD.KeyF,weight:Rt.mb.EditorContrib}})}run(e){var t;null===(t=yp(e))||void 0===t||t.showFind()}},{_:Ze.ID="editor.action.webvieweditor.showFind"},{_:Ze.LABEL=(0,Rt.Ij)(13158,"Show find")},Ze),mp=(Ne=class e extends Rt.ob{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:Rt.PO.and(pp,Wt.ut),primary:Rt.YD.Escape,weight:Rt.mb.EditorContrib}})}run(e){var t;null===(t=yp(e))||void 0===t||t.hideFind()}},{_:Ne.ID="editor.action.webvieweditor.hideFind"},{_:Ne.LABEL=(0,Rt.Ij)(13159,"Stop find")},Ne),vp=(Pe=class e extends Rt.ob{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:Rt.PO.and(pp,Wt.lt),primary:Rt.YD.Enter,weight:Rt.mb.EditorContrib}})}run(e){var t;null===(t=yp(e))||void 0===t||t.runFindAction(!1)}},{_:Pe.ID="editor.action.webvieweditor.findNext"},{_:Pe.LABEL=(0,Rt.Ij)(13160,"Find next")},Pe),Cp=(Je=class e extends Rt.ob{constructor(){super({id:e.ID,title:e.LABEL,keybinding:{when:Rt.PO.and(pp,Wt.lt),primary:Rt.ZD.Shift|Rt.YD.Enter,weight:Rt.mb.EditorContrib}})}run(e){var t;null===(t=yp(e))||void 0===t||t.runFindAction(!0)}},{_:Je.ID="editor.action.webvieweditor.findPrevious"},{_:Je.LABEL=(0,Rt.Ij)(13161,"Find previous")},Je),wp=(Be=class e extends Rt.ob{constructor(){super({id:e.ID,title:e.LABEL,category:Mt.s.Developer,menu:[{id:Rt.sb.CommandPalette}]})}async run(e){let t=e.get(Wt.$v);for(let i of t.webviews)i.reload()}},{_:Be.ID="workbench.action.webview.reloadWebviewAction"},{_:Be.LABEL=(0,Rt.Lj)(13162,"Reload Webviews")},Be);function yp(e){let t=e.get(Pt.kt).activeEditor;return t instanceof Wt.Qi?t.webview:void 0}(0,Rt.Ib)(),(0,Rt.PA)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.sm)(),(0,Rt.im)(),(0,Rt.vb)(),(0,Tt.f)(),(0,Pt.b)(),(0,Pt.en)(),(0,Pt.G)(),(0,Wt.Zi)(),(0,Wt.$i)(),(0,Wt.Yi)(),(0,Rt.Kb)(),(0,Pt.At)(),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(Wt.Xi,Wt.Xi.ID,(0,Rt.Ij)(13164,"webview editor")),[new Rt.om(Wt.Qi)]);var fp=(Oe=class extends Rt.CA{constructor(e,t){super(),this.editorGroupService=t,this._register(e.onWillOpenEditor(e=>{let i=t.getGroup(e.groupId);i&&this.onEditorOpening(e.editor,i)}))}onEditorOpening(e,t){if(!(e instanceof Wt.Qi)||e.typeId!==Wt.Qi.typeId||t.contains(e))return;let i,o=this.editorGroupService.groups;for(let s of o)if(s.contains(e)){i=s;break}i&&i.closeEditor(e)}},{_:Oe.ID="workbench.contrib.webviewPanel"},Oe);fp=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.kt),(0,Rt.Fb)(1,Pt.W)],fp),(0,Pt.x)(fp.ID,fp,Pt.y.BlockStartup),Rt._b.as(Pt.Rt.EditorFactory).registerEditorSerializer(rp.ID,rp),(0,Rt.pb)(bp),(0,Rt.pb)(mp),(0,Rt.pb)(vp),(0,Rt.pb)(Cp),(0,Rt.pb)(wp),(0,Rt.Ib)(),(0,Rt.VA)(),(0,Rt.PA)(),(0,Rt.xA)(),(0,Rt.mj)(),(0,Rt.TD)(),(0,Rt.nD)(),(0,Rt.Fj)(),(0,Rt.s_)(),(0,Rt.nb)(),(0,Rt.br)(),(0,Rt.Sc)(),(0,Wt._t)(),(0,Tt.Et)(),(0,jt.i)();var Sp=class extends Rt.CA{constructor(e,t,i,o,s){super(),this.configurationService=t,this.logService=i,this.preferencesService=o,this.quickInputService=s,this._providers=new Rt.bA,this._register(e.registerExternalOpener(this))}registerExternalOpenerProvider(e){return{dispose:this._providers.push(e)}}async getOpeners(e,t,i,o){let s=await this.getAllOpenersForUri(e);if(0===s.size)return[];if(i.preferredOpenerId){if("default"===i.preferredOpenerId)return[];let e=s.get(i.preferredOpenerId);if(e)return[e]}let r=this.getConfiguredOpenerForUri(s,e);if(r)return"default"===r?[]:[r];let n=[];if(await Promise.all(Array.from(s.values()).map(async e=>{let t;try{t=await e.canOpen(i.sourceUri,o)}catch(e){return void this.logService.error(e)}switch(t){case Rt.PE.Option:case Rt.PE.Default:case Rt.PE.Preferred:n.push({opener:e,priority:t})}})),0===n.length)return[];let a=n.filter(e=>e.priority===Rt.PE.Preferred).at(0);return a?[a.opener]:!t&&n.every(e=>e.priority===Rt.PE.Option)?[]:n.map(e=>e.opener)}async openExternal(e,t,i){let o="string"==typeof e?Rt.wD.parse(e):e,s=await this.getOpeners(o,!1,t,i);return 0!==s.length&&(1===s.length?s[0].openExternalUri(o,t,i):this.showOpenerPrompt(s,o,t,i))}async getOpener(e,t,i){let o=await this.getOpeners(e,!0,t,i);if(o.length>=1)return o[0]}async getAllOpenersForUri(e){let t=new Map;return await Promise.all(Rt.BA.map(this._providers,async i=>{var o,s=!1,r=!1;try{for(var n,a=(0,Vt.A)(i.getOpeners(e));s=!(n=await a.next()).done;s=!1){let e=n.value;t.set(e.id,e)}}catch(d){r=!0,o=d}finally{try{s&&null!=a.return&&await a.return()}finally{if(r)throw o}}})),t}getConfiguredOpenerForUri(e,t){let i=this.configurationService.getValue("workbench.externalUriOpeners")||{};for(let[o,s]of Object.entries(i))if((0,Tt.Dt)(t,o)){if("default"===s)return"default";let t=e.get(s);if(t)return t}}async showOpenerPrompt(e,t,i,o){let s=e.map(e=>({label:e.label,opener:e}));s.push({label:Rt.Dj?(0,Rt.Ij)(7887,"Open in new browser window"):(0,Rt.Ij)(7888,"Open in default browser"),opener:void 0},{type:"separator"},{label:(0,Rt.Ij)(7889,"Configure default opener..."),opener:"configureDefault"});let r=await this.quickInputService.pick(s,{placeHolder:(0,Rt.Ij)(7890,"How would you like to open: {0}",t.toString())});return!r||void 0!==r.opener&&("configureDefault"===r.opener?(await this.preferencesService.openUserSettings({jsonEditor:!0,revealSetting:{key:Wt.gt,edit:!0}}),!0):r.opener.openExternalUri(t,i,o))}};Sp=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.yr),(0,Rt.Fb)(1,Rt.o_),(0,Rt.Fb)(2,Rt.eb),(0,Rt.Fb)(3,jt.r),(0,Rt.Fb)(4,Rt.xc)],Sp),(0,Rt.I_)(),(0,Rt.im)(),(0,Rt.vb)(),(0,Wt._t)(),(0,Rt.Kb)(),Rt._b.as(Rt.E_.Configuration).registerConfiguration(Wt.ht);var Ip;(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Yi)(),(0,Rt.PA)(),(0,Rt.qd)(),(0,Gt.o)(),(0,Rt.Fj)(),(0,Rt.Db)(),(0,Pt.At)(),(0,Jt.n)(),(0,Wt.Sx)(),(0,Wt.vx)(),(0,Rt.lr)(),(0,Wt.Mf)(),(0,Rt.br)(),(0,Rt.Ic)(),(0,Rt.zr)(),(0,Rt.Mb)(),(0,Rt.gD)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.WM)(),(0,Rt.TD)(),(0,Rt.db)(),(0,Mt.c)(),(0,Pt.G)(),(0,Rt.ar)(),(0,Rt.cr)(),(0,Rt.gA)(),(0,Rt.ok)(),(0,Rt.mE)({});var kp=class{constructor(e,t){this.combined=e,this.dedicated=t}isEqual(e){return(0,Rt.RM)(this.combined,e.combined)&&(0,Rt.RM)(this.dedicated,e.dedicated)}},_p=class{constructor(e,t){this._storageService=e,this._key=t}get value(){return this._storageService.getNumber(this._key,Rt.Go.PROFILE,0)}increment(){let e=this.value+1;return this._storageService.store(this._key,e,Rt.Go.PROFILE,Rt.Ko.MACHINE),e}};_p=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Uo)],_p);var Ep=(Ke=class extends Rt.CA{constructor(e){super(),this.editorGroupService=e;for(let t of e.parts)this.createLanguageStatus(t);this._register(e.onDidCreateAuxiliaryEditorPart(e=>this.createLanguageStatus(e)))}createLanguageStatus(e){let t=new Rt.EA;Rt.dA.once(e.onWillDispose)(()=>t.dispose());let i=this.editorGroupService.getScopedInstantiationService(e);t.add(i.createInstance(Ap))}},{_:Ke.Id="status.languageStatus"},Ke);Ep=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.W)],Ep);var Ap=(Me=class{constructor(e,t,i,o,s,r){this._languageStatusService=e,this._statusBarService=t,this._editorService=i,this._hoverService=o,this._openerService=s,this._storageService=r,this._disposables=new Rt.EA,this._dedicated=new Set,this._dedicatedEntries=new Map,this._renderDisposables=new Rt.EA,this._combinedEntryTooltip=(0,Rt.gx)("div"),r.onDidChangeValue(Rt.Go.PROFILE,Ip._keyDedicatedItems,this._disposables)(this._handleStorageChange,this,this._disposables),this._restoreState(),this._interactionCounter=new _p(r,"languageStatus.interactCount"),e.onDidChange(this._update,this,this._disposables),i.onDidActiveEditorChange(this._update,this,this._disposables),this._update(),t.onDidChangeEntryVisibility(e=>{!e.visible&&this._dedicated.has(e.id)&&(this._dedicated.delete(e.id),this._update(),this._storeState())},void 0,this._disposables)}dispose(){var e;this._disposables.dispose(),null!==(e=this._combinedEntry)&&void 0!==e&&e.dispose(),(0,Rt.MA)(this._dedicatedEntries.values()),this._renderDisposables.dispose()}_handleStorageChange(){this._restoreState(),this._update()}_restoreState(){let e=this._storageService.get(Ip._keyDedicatedItems,Rt.Go.PROFILE,"[]");try{let t=JSON.parse(e);this._dedicated=new Set(t)}catch(t){this._dedicated.clear()}}_storeState(){if(0===this._dedicated.size)this._storageService.remove(Ip._keyDedicatedItems,Rt.Go.PROFILE);else{let e=JSON.stringify(Array.from(this._dedicated.keys()));this._storageService.store(Ip._keyDedicatedItems,e,Rt.Go.PROFILE,Rt.Ko.USER)}}_createViewModel(e){if(null===e||void 0===e||!e.hasModel())return new kp([],[]);let t=this._languageStatusService.getLanguageStatus(e.getModel()),i=[],o=[];for(let s of t)this._dedicated.has(s.id)&&o.push(s),i.push(s);return new kp(i,o)}_update(){var e,t;let i=(0,Gt.i)(this._editorService.activeTextEditorControl),o=this._createViewModel(i);if(null!==(e=this._model)&&void 0!==e&&e.isEqual(o))return;if(this._renderDisposables.clear(),this._model=o,null!==i&&void 0!==i&&i.onDidChangeModelLanguage(this._update,this,this._renderDisposables),0===o.combined.length)null!==(t=this._combinedEntry)&&void 0!==t&&t.dispose(),this._combinedEntry=void 0;else{let[e]=o.combined,t=e.severity>=Rt.Kd.Warning,s=Ip._severityToComboCodicon(e.severity),r=!1,n=[];for(let i of o.combined){let e=o.dedicated.includes(i);this._renderStatus(this._combinedEntryTooltip,i,t,e,this._renderDisposables),n.push(Ip._accessibilityInformation(i).label),r||(r=!e&&i.busy)}let a={name:(0,Rt.Ij)(8508,"Editor Language Status"),ariaLabel:(0,Rt.Ij)(8509,"Editor Language Status: {0}",n.join(", next: ")),tooltip:this._combinedEntryTooltip,command:Wt.yx,text:r?"$(loading~spin)":s};this._combinedEntry?this._combinedEntry.update(a):this._combinedEntry=this._statusBarService.addEntry(a,Ip._id,Wt.bx.RIGHT,{location:{id:"status.editor.mode",priority:100.1},alignment:Wt.bx.LEFT,compact:!0});let d=this._interactionCounter.value>=3,l=(0,Rt.Bx)(null===i||void 0===i?void 0:i.getContainerDomNode()),c=l.document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus A>SPAN.codicon"),h=l.document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus");if((0,Rt.iS)(c)&&h){let e="wiggle",i="flash";r?(c.classList.remove(e),h.classList.remove(i)):(c.classList.toggle(e,t||!d),this._renderDisposables.add((0,Rt.ox)(c,"animationend",t=>c.classList.remove(e))),h.classList.toggle(i,t),this._renderDisposables.add((0,Rt.ox)(h,"animationend",e=>h.classList.remove(i))))}if(!d){let e=l.document.querySelector(".monaco-workbench .context-view");if((0,Rt.iS)(e)){let t=new MutationObserver(()=>{l.document.contains(this._combinedEntryTooltip)&&(this._interactionCounter.increment(),t.disconnect())});t.observe(e,{childList:!0,subtree:!0}),this._renderDisposables.add((0,Rt.zA)(()=>t.disconnect()))}}}let s=new Map;for(let r of o.dedicated){let e=Ip._asStatusbarEntry(r),t=this._dedicatedEntries.get(r.id);t?(t.update(e),this._dedicatedEntries.delete(r.id)):t=this._statusBarService.addEntry(e,r.id,Wt.bx.RIGHT,{location:{id:"status.editor.mode",priority:100.1},alignment:Wt.bx.RIGHT}),s.set(r.id,t)}(0,Rt.MA)(this._dedicatedEntries.values()),this._dedicatedEntries=s}_renderStatus(e,t,i,o,s){let r=(0,Rt.gx)("div");r.classList.add("hover-language-status"),e.appendChild(r),s.add((0,Rt.zA)(()=>r.remove()));let n=(0,Rt.gx)("div");n.classList.add("severity","sev".concat(t.severity)),n.classList.toggle("show",i),(0,Rt.dx)(n,...(0,Rt.Zi)(Ip._severityToSingleCodicon(t.severity))),r.appendChild(n);let a=(0,Rt.gx)("div");a.classList.add("element"),r.appendChild(a);let d=(0,Rt.gx)("div");d.classList.add("left"),a.appendChild(d),(0,Rt.dx)(d,...(0,Rt.Zi)(xp("string"==typeof t.label?t.label:t.label.value,t.busy))),this._renderTextPlus(d,t.detail,s);let l=(0,Rt.gx)("div");l.classList.add("right"),a.appendChild(l);let{command:c}=t;c&&s.add(new Wt.jf(l,{label:c.title,title:c.tooltip,href:Rt.wD.from({scheme:"command",path:c.id,query:c.arguments&&JSON.stringify(c.arguments)}).toString()},{hoverDelegate:Rt.or},this._hoverService,this._openerService));let h,u=new Rt.Lr(l,{hoverDelegate:Rt.or}),g=o?(0,Rt.Ij)(8510,"Remove from Status Bar"):(0,Rt.Ij)(8511,"Add to Status Bar");return u.setAriaLabel(g),s.add(u),h=o?new Rt.Ob("unpin",g,Rt.Eb.asClassName(Rt.mD.pinned),!0,()=>{this._dedicated.delete(t.id),this._statusBarService.updateEntryVisibility(t.id,!1),this._update(),this._storeState()}):new Rt.Ob("pin",g,Rt.Eb.asClassName(Rt.mD.pin),!0,()=>{this._dedicated.add(t.id),this._statusBarService.updateEntryVisibility(t.id,!0),this._update(),this._storeState()}),u.push(h,{icon:!0,label:!1}),s.add(h),r}static _severityToComboCodicon(e){switch(e){case Rt.Kd.Error:return"$(bracket-error)";case Rt.Kd.Warning:return"$(bracket-dot)";default:return"$(bracket)"}}static _severityToSingleCodicon(e){switch(e){case Rt.Kd.Error:return"$(error)";case Rt.Kd.Warning:return"$(info)";default:return"$(check)"}}_renderTextPlus(e,t,i){let o=!1;for(let s of(0,Rt.ur)(t).nodes)o||((0,Rt.dx)(e,(0,Rt.Zb)("span.separator")),o=!0),"string"==typeof s?(0,Rt.dx)(e,...(0,Rt.Zi)(s)):i.add(new Wt.jf(e,s,void 0,this._hoverService,this._openerService))}static _accessibilityInformation(e){if(e.accessibilityInfo)return e.accessibilityInfo;let t="string"==typeof e.label?e.label:e.label.value;return e.detail?{label:(0,Rt.Ij)(8512,"{0}, {1}",t,e.detail)}:{label:(0,Rt.Ij)(8513,"{0}",t)}}static _asStatusbarEntry(e){var t,i;let o;e.severity===Rt.Kd.Warning?o="warning":e.severity===Rt.Kd.Error&&(o="error");let s="string"==typeof e.label?e.label:e.label.shortValue;return{name:(0,Rt.Ij)(8514,"{0} (Language Status)",e.name),text:xp(s,e.busy),ariaLabel:Ip._accessibilityInformation(e).label,role:null===(t=e.accessibilityInfo)||void 0===t?void 0:t.role,tooltip:(null===(i=e.command)||void 0===i?void 0:i.tooltip)||new Rt.Pc(e.detail,{isTrusted:!0,supportThemeIcons:!0}),kind:o,command:e.command}}},{_:Ip=Me},{_:Me._id="status.languageStatus"},{_:Me._keyDedicatedItems="languageStatus.dedicated"},Me);Ap=Ip=(0,Rt.Pb)([(0,Rt.Fb)(0,Jt.t),(0,Rt.Fb)(1,Wt._x),(0,Rt.Fb)(2,Pt.kt),(0,Rt.Fb)(3,Rt.sr),(0,Rt.Fb)(4,Rt.yr),(0,Rt.Fb)(5,Rt.Uo)],Ap);var Dp=class extends Rt.ob{constructor(){super({id:"editor.inlayHints.Reset",title:(0,Rt.Lj)(8515,"Reset Language Status Interaction Counter"),category:Mt.s.View,f1:!0})}run(e){e.get(Rt.Uo).remove("languageStatus.interactCount",Rt.Go.PROFILE)}};function xp(e,t){return(0,Rt.hk)([""!==e&&e,t&&"$(loading~spin)"],"\xa0\xa0")}(0,Pt.b)(),(0,Rt.db)(),(0,Pt.x)(Ep.Id,Ep,Pt.y.AfterRestored),(0,Rt.pb)(Dp);(0,Rt.Fj)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.Rg)("mergeEditor.change.background","#9bb95533",(0,Rt.Ij)(9148,"The background color for changes.")),(0,Rt.Rg)("mergeEditor.change.word.background",{dark:"#9ccc2c33",light:"#9ccc2c66",hcDark:"#9ccc2c33",hcLight:"#9ccc2c66"},(0,Rt.Ij)(9149,"The background color for word changes.")),(0,Rt.Rg)("mergeEditor.changeBase.background",{dark:"#4B1818FF",light:"#FFCCCCFF",hcDark:"#4B1818FF",hcLight:"#FFCCCCFF"},(0,Rt.Ij)(9150,"The background color for changes in base.")),(0,Rt.Rg)("mergeEditor.changeBase.word.background",{dark:"#6F1313FF",light:"#FFA3A3FF",hcDark:"#6F1313FF",hcLight:"#FFA3A3FF"},(0,Rt.Ij)(9151,"The background color for word changes in base.")),(0,Rt.Rg)("mergeEditor.conflict.unhandledUnfocused.border",{dark:"#ffa6007a",light:"#ffa600FF",hcDark:"#ffa6007a",hcLight:"#ffa6007a"},(0,Rt.Ij)(9152,"The border color of unhandled unfocused conflicts.")),(0,Rt.Rg)("mergeEditor.conflict.unhandledFocused.border","#ffa600",(0,Rt.Ij)(9153,"The border color of unhandled focused conflicts.")),(0,Rt.Rg)("mergeEditor.conflict.handledUnfocused.border","#86868649",(0,Rt.Ij)(9154,"The border color of handled unfocused conflicts.")),(0,Rt.Rg)("mergeEditor.conflict.handledFocused.border","#c1c1c1cc",(0,Rt.Ij)(9155,"The border color of handled focused conflicts."));var Vp=(0,Rt.Rg)("mergeEditor.conflict.handled.minimapOverViewRuler","#adaca8ee",(0,Rt.Ij)(9156,"The foreground color for changes in input 1.")),Rp=(0,Rt.Rg)("mergeEditor.conflict.unhandled.minimapOverViewRuler","#fcba03FF",(0,Rt.Ij)(9157,"The foreground color for changes in input 1."));(0,Rt.Rg)("mergeEditor.conflictingLines.background","#ffea0047",(0,Rt.Ij)(9158,'The background of the "Conflicting Lines" text.'));(0,Rt.Rg)("mergeEditor.conflict.input1.background",(0,Rt.zg)(Rt.ag,.4),(0,Rt.Ij)(9159,"The background color of decorations in input 1.")),(0,Rt.Rg)("mergeEditor.conflict.input2.background",(0,Rt.zg)(Rt.og,.4),(0,Rt.Ij)(9160,"The background color of decorations in input 2.")),(0,Rt.qx)(),(0,Rt.PA)(),(0,Rt.PS)(),(0,Wt.Gi)(),(0,Rt.KS)(),(0,Lt.Ar)(),(0,Rt.WS)(),(0,Rt.uC)(),(0,Rt.tC)();var Tp=class extends Rt.CA{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=(0,Rt.qS)(this,this._editor.onDidScrollChange,e=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(e=>0===e),this.modelAttached=(0,Rt.qS)(this,this._editor.onDidChangeModel,e=>this._editor.hasModel()),this.editorOnDidChangeViewZones=(0,Lt.jr)("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=(0,Lt.jr)("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=(0,Rt.GS)("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";let o=this._domNode.appendChild((0,Rt.Gx)("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{(0,Rt.rC)(e=>{this.domNodeSizeChanged.trigger(e)})});s.observe(this._domNode),this._register((0,Rt.zA)(()=>s.disconnect())),this._register((0,Rt.iC)(e=>{o.className=this.isScrollTopZero.read(e)?"":"scroll-decoration"})),this._register((0,Rt.iC)(e=>this.render(e)))}dispose(){super.dispose(),(0,Rt.vS)(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);let t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),o=new Set(this.views.keys());if(i.length>0){let s=i[0],r=Wt.Wi.fromLength(s.startLineNumber,s.endLineNumber-s.startLineNumber).deltaEnd(1),n=this.itemProvider.getIntersectingGutterItems(r,e);for(let e of n){if(!e.range.intersectsOrTouches(r))continue;o.delete(e.id);let i=this.views.get(e.id);if(i)i.gutterItemView.update(e);else{let t=(0,Rt.gx)("div");this._domNode.appendChild(t),i=new Lp(this.itemProvider.createView(e,t),t),this.views.set(e.id,i)}let s=e.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(e.range.startLineNumber,!0)-t:this._editor.getBottomForLineNumber(e.range.startLineNumber-1,!1)-t,n=this._editor.getBottomForLineNumber(e.range.endLineNumberExclusive-1,!0)-t-s;i.domNode.style.top="".concat(s,"px"),i.domNode.style.height="".concat(n,"px"),i.gutterItemView.layout(s,n,0,this._domNode.clientHeight)}}for(let s of o){let e=this.views.get(s);e.gutterItemView.dispose(),e.domNode.remove(),this.views.delete(s)}}},Lp=class{constructor(e,t){this.gutterItemView=e,this.domNode=t}};(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.PS)(),(0,Rt.Wy)(),(0,Lt.mi)(),(0,Rt.yD)(),(0,Tt.an)(),(0,Wt.lC)(),(0,Lt.lr)(),(0,Rt.Kb)(),(0,Lt.Z)(),(0,Wt.ji)(),(0,Ft.n)(),(0,Rt.KS)(),(0,Rt.gC)(),(0,Rt.uC)();var Wp=class extends Rt.CA{updateOptions(e){this.editor.updateOptions(e)}constructor(e,t,i){super(),this.instantiationService=e,this.viewModel=t,this.configurationService=i,this.model=this.viewModel.map(e=>null===e||void 0===e?void 0:e.model),this.htmlElements=(0,Rt.Gx)("div.code-view",[(0,Rt.Gx)("div.header@header",[(0,Rt.Gx)("span.title@title"),(0,Rt.Gx)("span.description@description"),(0,Rt.Gx)("span.detail@detail"),(0,Rt.Gx)("span.toolbar@toolbar")]),(0,Rt.Gx)("div.container",[(0,Rt.Gx)("div.gutter@gutterDiv"),(0,Rt.Gx)("div@editor")])]),this._onDidViewChange=new Rt.uA,this.view={element:this.htmlElements.root,minimumWidth:Lt.K.width,maximumWidth:Lt.G.width,minimumHeight:Lt.K.height,maximumHeight:Lt.G.height,onDidChange:this._onDidViewChange.event,layout:(e,t,i,o)=>{(0,Wt.Pi)(this.htmlElements.root,{width:e,height:t,top:i,left:o}),this.editor.layout({width:e-this.htmlElements.gutterDiv.clientWidth,height:t-this.htmlElements.header.clientHeight})}},this.checkboxesVisible=(0,Ft.r)("mergeEditor.showCheckboxes",!1,this.configurationService),this.showDeletionMarkers=(0,Ft.r)("mergeEditor.showDeletionMarkers",!0,this.configurationService),this.useSimplifiedDecorations=(0,Ft.r)("mergeEditor.useSimplifiedDecorations",!1,this.configurationService),this.editor=this.instantiationService.createInstance(Lt.pi,this.htmlElements.editor,{},{contributions:this.getEditorContributions()}),this.isFocused=(0,Rt.qS)(this,Rt.dA.any(this.editor.onDidBlurEditorWidget,this.editor.onDidFocusEditorWidget),()=>this.editor.hasWidgetFocus()),this.cursorPosition=(0,Rt.qS)(this,this.editor.onDidChangeCursorPosition,()=>this.editor.getPosition()),this.selection=(0,Rt.qS)(this,this.editor.onDidChangeCursorSelection,()=>this.editor.getSelections()),this.cursorLineNumber=this.cursorPosition.map(e=>null===e||void 0===e?void 0:e.lineNumber)}getEditorContributions(){return Rt.Ry.getEditorContributions().filter(e=>e.id!==Wt.cC.ID&&e.id!==Tt.in.ID)}};function Fp(e,t){let i=(0,Rt.dC)(i=>{let o=e.viewModel.read(i);if(!o)return[];let s=o.selectionInBase.read(i);return s&&s.sourceEditor!==e?s.rangesInBase.map(e=>t(e,o)):[]});return(0,Rt.iC)(t=>{let o=i.read(t);0!==o.length&&e.editor.setSelections(o.map(e=>new Rt._D(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)))})}var Gp=class extends Rt.CA{constructor(e,t,i){super();let o=i.createInstance(Lt.sr,t,e,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:e=>"primary"===e}});this._store.add(o)}};Gp=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Ub)],Gp),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Yi)(),(0,Rt.xN)(),(0,Rt.PS)(),(0,Rt.uy)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.Kb)(),(0,Wt.ji)(),(0,Rt.gC)(),(0,Rt.uC)();var Zp=class extends Wp{constructor(e,t,i){super(t,e,i),this.decorations=(0,Rt.dC)(this,e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=i.base,s=t.activeModifiedBaseRange.read(e),r=t.showNonConflictingChanges.read(e),n=this.showDeletionMarkers.read(e),a=[];for(let d of i.modifiedBaseRanges.read(e)){let l=d.baseRange;if(!l)continue;let c=i.isHandled(d).read(e);if(!d.isConflicting&&c&&!r)continue;let h=["merge-editor-block"],u=[0,0,0,0];c&&h.push("handled"),d===s&&(h.push("focused"),u=[0,2,0,2]),h.push("base");let g=t.baseShowDiffAgainst.read(e);if(g)for(let e of d.getInputDiffs(g)){let t=e.inputRange.toInclusiveRange();t&&a.push({range:t,options:{className:"merge-editor-diff base",description:"Merge Editor",isWholeLine:!0}});for(let i of e.rangeMappings)(n||!i.inputRange.isEmpty())&&a.push({range:i.inputRange,options:{className:i.inputRange.isEmpty()?"merge-editor-diff-empty-word base":"merge-editor-diff-word base",description:"Merge Editor",showIfCollapsed:!0}})}a.push({range:l.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:h.join(" "),blockPadding:u,blockIsAfterEnd:l.startLineNumber>o.getLineCount(),description:"Merge Editor",minimap:{position:Rt.ny.Gutter,color:{id:c?Vp:Rp}},overviewRuler:d.isConflicting?{position:Rt.ay.Center,color:{id:c?Vp:Rp}}:void 0}})}return a}),this._register(Fp(this,(e,t)=>e)),this._register(t.createInstance(Gp,Rt.sb.MergeBaseToolbar,this.htmlElements.title)),this._register((0,Rt.lC)((e,t)=>{this.checkboxesVisible.read(e)&&t.add(new Tp(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(e,t)=>[],createView:(e,t)=>{throw new Rt.lN}}))})),this._register((0,Rt.iC)(e=>{let t=this.viewModel.read(e);if(!t)return;this.editor.setModel(t.model.base),(0,Rt.vS)(this.htmlElements.title,...(0,Rt.Zi)((0,Rt.Ij)(9179,"Base")));let i,o=t.baseShowDiffAgainst.read(e);if(o){let e=(0,Rt.Ij)(9180,"Comparing with {0}",1===o?t.model.input1.title:t.model.input2.title);i=(0,Rt.Gx)("span",{title:(0,Rt.Ij)(9181,"Differences are highlighted with a background color.")},[e]).root}(0,Rt.vS)(this.htmlElements.description,...i?[i]:[])})),this._register((0,Wt.ki)(this.editor,this.decorations))}};Zp=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Rt.o_)],Zp),(0,Rt.PA)(),(0,Rt.PS)(),(0,Rt.pv)(),(0,Wt.zi)(),(0,Wt.Ii)(),(0,Rt.xN)(),(0,Rt.nM)(),(0,Rt.gC)();var Np=class extends Rt.CA{get model(){var e;return null===(e=this.viewModel.get())||void 0===e?void 0:e.model}get lockResultWithInputs(){return"columns"===this.layout.get().kind}get lockBaseWithInputs(){return"mixed"===this.layout.get().kind&&!this.layout.get().showBaseAtTop}constructor(e,t,i,o,s,r){super(),this.viewModel=e,this.input1View=t,this.input2View=i,this.baseView=o,this.inputResultView=s,this.layout=r,this.reentrancyBarrier=new Wt.Fi,this._isSyncing=!0;let n=(0,Rt.dC)(e=>{let t=this.baseView.read(e),i=[this.input1View,this.input2View,this.inputResultView,t].filter(Rt.aM),o=(e,t,o)=>{this.reentrancyBarrier.runExclusivelyOrSkip(()=>{if(t){let t=e.editor.getScrollLeft();for(let o of i)o!==e&&o.editor.setScrollLeft(t,Rt.fv.Immediate)}if(o){let t=e.editor.getScrollTop();for(let o of i)if(o!==e)if(this._shouldLock(e,o))o.editor.setScrollTop(t,Rt.fv.Immediate);else{let t=this._getMapping(e,o);t&&this._synchronizeScrolling(e.editor,o.editor,t)}}})};for(let s of i)e.store.add(s.editor.onDidScrollChange(e=>{this._isSyncing&&o(s,e.scrollLeftChanged,e.scrollTopChanged)}));return{update:()=>{o(this.inputResultView,!0,!0)}}}).recomputeInitiallyAndOnChange(this._store);this.updateScrolling=()=>{n.get().update()}}stopSync(){this._isSyncing=!1}startSync(){this._isSyncing=!0}_shouldLock(e,t){let i=e=>e===this.input1View||e===this.input2View;return i(e)&&t===this.inputResultView||i(t)&&e===this.inputResultView?this.lockResultWithInputs:i(e)&&t===this.baseView.get()||i(t)&&e===this.baseView.get()?this.lockBaseWithInputs:!(!i(e)||!i(t))}_getMapping(e,t){if(e===this.input1View){var i;if(t===this.input2View)return;if(t===this.inputResultView)return null===(i=this.model)||void 0===i?void 0:i.input1ResultMapping.get();if(t===this.baseView.get()){var o;let e=null===(o=this.model)||void 0===o?void 0:o.baseInput1Diffs.get();return e?new Wt.Li(e,-1).reverse():void 0}}else if(e===this.input2View){var s;if(t===this.input1View)return;if(t===this.inputResultView)return null===(s=this.model)||void 0===s?void 0:s.input2ResultMapping.get();if(t===this.baseView.get()){var r;let e=null===(r=this.model)||void 0===r?void 0:r.baseInput2Diffs.get();return e?new Wt.Li(e,-1).reverse():void 0}}else if(e===this.inputResultView){var n,a,d;if(t===this.input1View)return null===(n=this.model)||void 0===n?void 0:n.resultInput1Mapping.get();if(t===this.input2View)return null===(a=this.model)||void 0===a?void 0:a.resultInput2Mapping.get();if(t===this.baseView.get())return(null===(d=this.model)||void 0===d?void 0:d.resultBaseMapping.get())||void 0}else if(e===this.baseView.get()){var l;if(t===this.input1View){var c;let e=null===(c=this.model)||void 0===c?void 0:c.baseInput1Diffs.get();return e?new Wt.Li(e,-1):void 0}if(t===this.input2View){var h;let e=null===(h=this.model)||void 0===h?void 0:h.baseInput2Diffs.get();return e?new Wt.Li(e,-1):void 0}if(t===this.inputResultView)return(null===(l=this.model)||void 0===l?void 0:l.baseResultMapping.get())||void 0}throw new Rt.lN}_synchronizeScrolling(e,t,i){if(!i)return;let o=e.getVisibleRanges();if(0===o.length)return;let s=o[0].startLineNumber-1,r=i.project(s),n=r.inputRange,a=r.outputRange,d=t.getTopForLineNumber(a.startLineNumber),l=t.getTopForLineNumber(a.endLineNumberExclusive),c=e.getTopForLineNumber(n.startLineNumber),h=e.getTopForLineNumber(n.endLineNumberExclusive),u=d+(l-d)*Math.min((e.getScrollTop()-c)/(h-c),1);t.setScrollTop(u,Rt.fv.Immediate)}};(0,Rt.Ib)(),(0,Rt.RN)(),(0,Rt.PA)(),(0,Rt.PS)(),(0,Rt.xD)(),(0,Rt.pv)(),(0,Rt.Fj)(),(0,Rt.s_)(),(0,Rt.Rd)(),(0,Wt.Gi)(),(0,Ft.n)(),(0,Rt.XS)(),(0,Rt.zS)(),(0,Rt.gC)(),(0,Rt.tC)();var Pp=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a){super(),this.model=e,this.inputCodeEditorView1=t,this.inputCodeEditorView2=i,this.resultCodeEditorView=o,this.baseCodeEditorView=s,this.showNonConflictingChanges=r,this.configurationService=n,this.notificationService=a,this.manuallySetActiveModifiedBaseRange=(0,Rt.ZS)(this,{range:void 0,counter:0}),this.attachedHistory=this._register(new Jp(this.model.resultTextModel)),this.shouldUseAppendInsteadOfAccept=(0,Ft.r)("mergeEditor.shouldUseAppendInsteadOfAccept",!1,this.configurationService),this.counter=0,this.lastFocusedEditor=(0,Rt.RS)(this,(e,t)=>{let i=[this.inputCodeEditorView1,this.inputCodeEditorView2,this.resultCodeEditorView,this.baseCodeEditorView.read(e)].find(t=>t&&t.isFocused.read(e));return i?{view:i,counter:this.counter++}:t||{view:void 0,counter:this.counter++}}),this.baseShowDiffAgainst=(0,Rt.dC)(this,e=>{let t=this.lastFocusedEditor.read(e);return t.view===this.inputCodeEditorView1?1:t.view===this.inputCodeEditorView2?2:void 0}),this.focusedEditorType=(0,Rt.dC)(this,e=>{let t=this.lastFocusedEditor.read(e);if(t.view){if(t.view===this.inputCodeEditorView1)return"input1";if(t.view===this.inputCodeEditorView2)return"input2";if(t.view===this.resultCodeEditorView)return"result";if(t.view===this.baseCodeEditorView.read(e))return"base"}}),this.selectionInBase=(0,Rt.dC)(this,e=>{let t=this.lastFocusedEditor.read(e).view;if(t)return{rangesInBase:(t.selection.read(e)||[]).map(i=>t===this.inputCodeEditorView1?this.model.translateInputRangeToBase(1,i):t===this.inputCodeEditorView2?this.model.translateInputRangeToBase(2,i):t===this.resultCodeEditorView?this.model.translateResultRangeToBase(i):(this.baseCodeEditorView.read(e),i)),sourceEditor:t}}),this.activeModifiedBaseRange=(0,Rt.dC)(this,e=>{let t=this.lastFocusedEditor.read(e),i=this.manuallySetActiveModifiedBaseRange.read(e);if(i.counter>t.counter)return i.range;if(!t.view)return;let o=t.view.cursorLineNumber.read(e);return o?this.model.modifiedBaseRanges.read(e).find(i=>{let s=this.getRangeOfModifiedBaseRange(t.view,i,e);return s.isEmpty?s.startLineNumber===o:s.contains(o)}):void 0}),this._register(o.editor.onDidChangeModelContent(e=>{if(this.model.isApplyingEditInResult||e.isRedoing||e.isUndoing)return;let t=[];for(let o of e.changes){let e=this.model.translateResultRangeToBase(Rt.bD.lift(o.range)),i=this.model.findModifiedBaseRangesInRange(Wt.Wi.fromLength(e.startLineNumber,e.endLineNumber-e.startLineNumber));1===i.length&&(this.model.isHandled(i[0]).get()||t.push(i[0]))}if(0===t.length)return;let i={model:this.model,redo(){(0,Rt.rC)(e=>{for(let i of t)this.model.setHandled(i,!0,e)})},undo(){(0,Rt.rC)(e=>{for(let i of t)this.model.setHandled(i,!1,e)})}};this.attachedHistory.pushAttachedHistoryElement(i),i.redo()}))}getRangeOfModifiedBaseRange(e,t,i){if(e===this.resultCodeEditorView)return this.model.getLineRangeInResult(t.baseRange,i);if(e===this.baseCodeEditorView.get())return t.baseRange;{let i=e===this.inputCodeEditorView1?1:2;return t.getInputRange(i)}}setActiveModifiedBaseRange(e,t){this.manuallySetActiveModifiedBaseRange.set({range:e,counter:this.counter++},t)}setState(e,t,i,o){this.manuallySetActiveModifiedBaseRange.set({range:e,counter:this.counter++},i),this.model.setState(e,t,o,i),this.lastFocusedEditor.clearCache(i)}goToConflict(e){var t;let i=this.lastFocusedEditor.get().view;i||(i=this.resultCodeEditorView);let o=null===(t=i.editor.getPosition())||void 0===t?void 0:t.lineNumber;if(void 0===o)return;let s=e(i,o);if(s){let e=this.getRangeOfModifiedBaseRange(i,s,void 0);i.editor.focus();let t=e.startLineNumber,o=e.endLineNumberExclusive;e.startLineNumber>i.editor.getModel().getLineCount()&&((0,Rt.rC)(e=>{this.setActiveModifiedBaseRange(s,e)}),t=o=i.editor.getModel().getLineCount()),i.editor.setPosition({lineNumber:t,column:i.editor.getModel().getLineFirstNonWhitespaceColumn(t)}),i.editor.revealLinesNearTop(t,o,Rt.fv.Smooth)}}goToNextModifiedBaseRange(e){this.goToConflict((t,i)=>this.model.modifiedBaseRanges.get().find(o=>e(o)&&this.getRangeOfModifiedBaseRange(t,o,void 0).startLineNumber>i)||this.model.modifiedBaseRanges.get().find(t=>e(t)))}goToPreviousModifiedBaseRange(e){this.goToConflict((t,i)=>(0,Rt.NN)(this.model.modifiedBaseRanges.get(),o=>e(o)&&this.getRangeOfModifiedBaseRange(t,o,void 0).endLineNumberExclusive<i)||(0,Rt.NN)(this.model.modifiedBaseRanges.get(),t=>e(t)))}toggleActiveConflict(e){let t=this.activeModifiedBaseRange.get();t?(0,Rt.rC)(i=>{this.setState(t,this.model.getState(t).get().toggle(e),i,e)}):this.notificationService.error((0,Rt.Ij)(9198,"There is currently no conflict focused that can be toggled."))}acceptAll(e){(0,Rt.rC)(t=>{for(let i of this.model.modifiedBaseRanges.get())this.setState(i,this.model.getState(i).get().withInputValue(e,!0),t,e)})}};Pp=(0,Rt.Pb)([(0,Rt.Fb)(6,Rt.o_),(0,Rt.Fb)(7,Rt.Ld)],Pp);var Jp=class extends Rt.CA{constructor(e){super(),this.model=e,this.attachedHistory=[],this.previousAltId=this.model.getAlternativeVersionId(),this._register(e.onDidChangeContent(t=>{let i=e.getAlternativeVersionId();if(t.isRedoing)for(let e of this.attachedHistory)this.previousAltId<e.altId&&e.altId<=i&&e.element.redo();else if(t.isUndoing)for(let e=this.attachedHistory.length-1;e>=0;e--){let t=this.attachedHistory[e];i<t.altId&&t.altId<=this.previousAltId&&t.element.undo()}else for(;this.attachedHistory.length>0&&this.attachedHistory[this.attachedHistory.length-1].altId>this.previousAltId;)this.attachedHistory.pop();this.previousAltId=i}))}pushAttachedHistoryElement(e){this.attachedHistory.push({altId:this.model.getAlternativeVersionId(),element:e})}};(0,Rt.qx)(),(0,Rt.PA)(),(0,Rt.gA)();var Bp=(je=class e extends Rt.CA{constructor(t,i,o,s,r){super(),this.editor=t,this.overlayWidgetId="fixedZoneWidget-".concat(e.counter++),this.widgetDomNode=(0,Rt.Gx)("div.fixed-zone-widget").root,this.overlayWidget={getId:()=>this.overlayWidgetId,getDomNode:()=>this.widgetDomNode,getPosition:()=>null},this.viewZoneId=i.addZone({domNode:(0,Rt.gx)("div"),afterLineNumber:o,heightInPx:s,ordinal:50001,onComputedHeight:e=>{this.widgetDomNode.style.height="".concat(e,"px")},onDomNodeTop:e=>{this.widgetDomNode.style.top="".concat(e,"px")}}),r.push(this.viewZoneId),this._register(Rt.dA.runAndSubscribe(this.editor.onDidLayoutChange,()=>{this.widgetDomNode.style.left=this.editor.getLayoutInfo().contentLeft+"px"})),this.editor.addOverlayWidget(this.overlayWidget),this._register({dispose:()=>{this.editor.removeOverlayWidget(this.overlayWidget)}})}},{_:je.counter=0},je);(0,Rt.qx)(),(0,Rt.qg)(),(0,Rt.Yi)(),(0,Rt.BC)(),(0,Rt.PA)(),(0,Rt.PS)(),(0,Rt.EO)(),(0,Rt.Zk)(),(0,Rt.Fj)(),(0,Wt.Di)(),(0,Rt.uC)(),(0,Rt.gC)(),(0,Rt.tC)();var Op=class extends Rt.CA{constructor(e){super(),this._editor=e,this._register(this._editor.onDidChangeConfiguration(e=>{(e.hasChanged(Rt.lO.fontInfo)||e.hasChanged(Rt.lO.codeLensFontSize)||e.hasChanged(Rt.lO.codeLensFontFamily))&&this._updateLensStyle()})),this._styleClassName="_conflictActionsFactory_"+(0,Rt.zC)(this._editor.getId()).toString(16),this._styleElement=(0,Rt.Gg)((0,Rt.sS)(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,void 0,this._store),this._updateLensStyle()}_updateLensStyle(){var e,t;let{codeLensHeight:i,fontSize:o}=this._getLayoutInfo(),s=this._editor.getOption(Rt.lO.codeLensFontFamily),r=this._editor.getOption(Rt.lO.fontInfo),n="--codelens-font-family".concat(this._styleClassName),a="--codelens-font-features".concat(this._styleClassName),d="\n\t\t.".concat(this._styleClassName," { line-height: ").concat(i,"px; font-size: ").concat(o,"px; padding-right: ").concat(Math.round(.5*o),"px; font-feature-settings: var(").concat(a,") }\n\t\t.monaco-workbench .").concat(this._styleClassName," span.codicon { line-height: ").concat(i,"px; font-size: ").concat(o,"px; }\n\t\t");s&&(d+="".concat(this._styleClassName," { font-family: var(").concat(n,"), ").concat(Rt.Jk.fontFamily,"}")),this._styleElement.textContent=d,null!==(e=this._editor.getContainerDomNode().style)&&void 0!==e&&e.setProperty(n,null!==s&&void 0!==s?s:"inherit"),null===(t=this._editor.getContainerDomNode().style)||void 0===t||t.setProperty(a,r.fontFeatureSettings)}_getLayoutInfo(){let e=Math.max(1.3,this._editor.getOption(Rt.lO.lineHeight)/this._editor.getOption(Rt.lO.fontSize)),t=this._editor.getOption(Rt.lO.codeLensFontSize);return(!t||t<5)&&(t=.9*this._editor.getOption(Rt.lO.fontSize)|0),{fontSize:t,codeLensHeight:t*e|0}}createWidget(e,t,i,o){let s=this._getLayoutInfo();return new jp(this._editor,e,t,s.codeLensHeight+2,this._styleClassName,i,o)}},Kp=class{constructor(e,t){this.viewModel=e,this.modifiedBaseRange=t,this.itemsInput1=this.getItemsInput(1),this.itemsInput2=this.getItemsInput(2),this.resultItems=(0,Rt.dC)(this,e=>{let t=this.viewModel,i=this.modifiedBaseRange,o=t.model.getState(i).read(e),s=t.model,r=[];if(o.kind===Wt.Ei.unrecognized)r.push({text:(0,Rt.Ij)(9161,"Manual Resolution"),tooltip:(0,Rt.Ij)(9162,"This conflict has been resolved manually.")});else if(o.kind===Wt.Ei.base)r.push({text:(0,Rt.Ij)(9163,"No Changes Accepted"),tooltip:(0,Rt.Ij)(9164,"The current resolution of this conflict equals the common ancestor of both the right and left changes.")});else{let e=[];o.includesInput1&&e.push(s.input1.title),o.includesInput2&&e.push(s.input2.title),o.kind===Wt.Ei.both&&2===o.firstInput&&e.reverse(),r.push({text:"".concat(e.join(" + "))})}let n=[];return o.includesInput1&&n.push(Mp((0,Rt.Ij)(9165,"Remove {0}",s.input1.title),async()=>{(0,Rt.rC)(e=>{s.setState(i,o.withInputValue(1,!1),!0,e),s.telemetry.reportRemoveInvoked(1,o.includesInput(2))})},(0,Rt.Ij)(9166,"Remove {0} from the result document.",s.input1.title))),o.includesInput2&&n.push(Mp((0,Rt.Ij)(9165,"Remove {0}",s.input2.title),async()=>{(0,Rt.rC)(e=>{s.setState(i,o.withInputValue(2,!1),!0,e),s.telemetry.reportRemoveInvoked(2,o.includesInput(1))})},(0,Rt.Ij)(9166,"Remove {0} from the result document.",s.input2.title))),o.kind===Wt.Ei.both&&2===o.firstInput&&n.reverse(),r.push(...n),o.kind===Wt.Ei.unrecognized&&r.push(Mp((0,Rt.Ij)(9167,"Reset to base"),async()=>{(0,Rt.rC)(e=>{s.setState(i,Wt.Ti.base,!0,e),s.telemetry.reportResetToBaseInvoked()})},(0,Rt.Ij)(9168,"Reset this conflict to the common ancestor of both the right and left changes."))),r}),this.isEmpty=(0,Rt.dC)(this,e=>this.itemsInput1.read(e).length+this.itemsInput2.read(e).length+this.resultItems.read(e).length===0),this.inputIsEmpty=(0,Rt.dC)(this,e=>this.itemsInput1.read(e).length+this.itemsInput2.read(e).length===0)}getItemsInput(e){return(0,Rt.dC)(t=>{let i=this.viewModel,o=this.modifiedBaseRange;if(!i.model.hasBaseRange(o))return[];let s=i.model.getState(o).read(t),r=i.model.isHandled(o).read(t),n=i.model,a=[],d=1===e?i.model.input1:i.model.input2,l=i.showNonConflictingChanges.read(t);if(!o.isConflicting&&r&&!l)return[];let c=1===e?2:1;if(s.kind!==Wt.Ei.unrecognized&&!s.isInputIncluded(e)){if(s.isInputIncluded(c)&&this.viewModel.shouldUseAppendInsteadOfAccept.read(t))a.push(Mp((0,Rt.Ij)(9174,"Append {0}",d.title),async()=>{(0,Rt.rC)(t=>{n.setState(o,s.withInputValue(e,!0,!1),e,t),n.telemetry.reportAcceptInvoked(e,s.includesInput(c))})},(0,Rt.Ij)(9175,"Append {0} to the result document.",d.title))),o.canBeCombined&&a.push(Mp((0,Rt.Ij)(9176,"Accept Combination",d.title),async()=>{(0,Rt.rC)(t=>{n.setState(o,s.withInputValue(e,!0,!0),e,t),n.telemetry.reportSmartCombinationInvoked(s.includesInput(c))})},(0,Rt.Ij)(9173,"Accept an automatic combination of both sides in the result document.")));else if(a.push(Mp((0,Rt.Ij)(9169,"Accept {0}",d.title),async()=>{(0,Rt.rC)(t=>{n.setState(o,s.withInputValue(e,!0,!1),e,t),n.telemetry.reportAcceptInvoked(e,s.includesInput(c))})},(0,Rt.Ij)(9170,"Accept {0} in the result document.",d.title))),o.canBeCombined){let t=o.isOrderRelevant?(0,Rt.Ij)(9171,"Accept Combination ({0} First)",d.title):(0,Rt.Ij)(9172,"Accept Combination");a.push(Mp(t,async()=>{(0,Rt.rC)(t=>{n.setState(o,Wt.Ti.base.withInputValue(e,!0).withInputValue(c,!0,!0),!0,t),n.telemetry.reportSmartCombinationInvoked(s.includesInput(c))})},(0,Rt.Ij)(9173,"Accept an automatic combination of both sides in the result document.")))}n.isInputHandled(o,e).read(t)||a.push(Mp((0,Rt.Ij)(9177,"Ignore"),async()=>{(0,Rt.rC)(t=>{n.setInputHandled(o,e,!0,t)})},(0,Rt.Ij)(9178,"Don't take this side of the conflict.")))}return a})}};function Mp(e,t,i){return{text:e,action:t,tooltip:i}}var jp=class extends Bp{constructor(e,t,i,o,s,r,n){super(e,t,i,o,n),this._domNode=(0,Rt.Gx)("div.merge-editor-conflict-actions").root,this.widgetDomNode.appendChild(this._domNode),this._domNode.classList.add(s),this._register((0,Rt.iC)(e=>{let t=r.read(e);this.setState(t)}))}setState(e){let t=[],i=!0;for(let o of e){i?i=!1:t.push((0,Rt.Zb)("span",void 0,"\xa0|\xa0"));let e=(0,Rt.Zi)(o.text);o.action?t.push((0,Rt.Zb)("a",{title:o.tooltip,role:"button",onclick:()=>o.action()},...e)):t.push((0,Rt.Zb)("span",{title:o.tooltip},...e))}(0,Rt.vS)(this._domNode,...t)}};function Qp(e){let t=function(e,t){let i=[],o=[];for(let[d,l]of[[0,e],[1,t]])for(let e of l)o.push({input:d,start:!0,inputPos:e.inputRange.getStartPosition(),outputPos:e.outputRange.getStartPosition()}),o.push({input:d,start:!1,inputPos:e.inputRange.getEndPosition(),outputPos:e.outputRange.getEndPosition()});o.sort((0,Rt.NM)(e=>e.inputPos,Rt.SD.compare));let s,r=[void 0,void 0];for(let d of o){if(s&&r.some(e=>!!e)){var n,a;let e=(0,Wt.Hi)(s,d.inputPos);e.isZero()||(i.push({inputPos:s,length:e,output1Pos:r[0],output2Pos:r[1]}),r[n=0]&&(r[n]=(0,Wt.Bi)(r[0],e)),r[a=1]&&(r[a]=(0,Wt.Bi)(r[1],e)))}r[d.input]=d.start?d.outputPos:void 0,s=d.inputPos}return i}(Yp(e.input1Diffs.flatMap(e=>e.rangeMappings),e.baseRange.toExclusiveRange(),e.input1Range.toExclusiveRange()),Yp(e.input2Diffs.flatMap(e=>e.rangeMappings),e.baseRange.toExclusiveRange(),e.input2Range.toExclusiveRange())),i=[];function o(e){return e.every(e=>void 0!==e)}i.push([e.input1Range.startLineNumber-1,e.baseRange.startLineNumber-1,e.input2Range.startLineNumber-1]);for(let a of t){var s,r;let e=[null===(s=a.output1Pos)||void 0===s?void 0:s.lineNumber,a.inputPos.lineNumber,null===(r=a.output2Pos)||void 0===r?void 0:r.lineNumber],t=!0;if(o(e)){let s=!i.some(t=>o(t)&&t.some((t,i)=>void 0!==t&&t===e[i]));s&&(i=i.filter(t=>!t.some((t,i)=>void 0!==t&&t===e[i]))),t=s}else t=!i.some(t=>t.some((t,i)=>void 0!==t&&t===e[i]));t?i.push(e):a.length.isGreaterThan(new Rt.Rv(1,0))&&i.push([a.output1Pos?a.output1Pos.lineNumber+1:void 0,a.inputPos.lineNumber+1,a.output2Pos?a.output2Pos.lineNumber+1:void 0])}let n=[e.input1Range.endLineNumberExclusive,e.baseRange.endLineNumberExclusive,e.input2Range.endLineNumberExclusive];return i=i.filter(e=>e.every((e,t)=>e!==n[t])),i.push(n),(0,Rt.gM)(()=>(0,Rt.vM)(i.map(e=>e[0]).filter(Rt.aM),(e,t)=>e<t)&&(0,Rt.vM)(i.map(e=>e[1]).filter(Rt.aM),(e,t)=>e<=t)&&(0,Rt.vM)(i.map(e=>e[2]).filter(Rt.aM),(e,t)=>e<t)&&i.every(e=>e.filter(Rt.aM).length>=2)),i}function Yp(e,t,i){let o=[],s=t.getStartPosition(),r=i.getStartPosition();for(let a of e){let e=new Wt.Ri(Rt.bD.fromPositions(s,a.inputRange.getStartPosition()),Rt.bD.fromPositions(r,a.outputRange.getStartPosition()));(0,Rt.gM)(()=>(0,Wt.Ui)(e.inputRange).equals((0,Wt.Ui)(e.outputRange))),e.inputRange.isEmpty()||o.push(e),s=a.inputRange.getEndPosition(),r=a.outputRange.getEndPosition()}let n=new Wt.Ri(Rt.bD.fromPositions(s,t.getEndPosition()),Rt.bD.fromPositions(r,i.getEndPosition()));return(0,Rt.gM)(()=>(0,Wt.Ui)(n.inputRange).equals((0,Wt.Ui)(n.outputRange))),n.inputRange.isEmpty()||o.push(n),o}(0,Rt.WM)(),(0,Rt.yM)(),(0,Rt.nM)(),(0,Rt.CD)(),(0,Rt.xD)(),(0,Rt.zv)(),(0,Wt.zi)(),(0,Wt.Vi)(),(0,Rt.qx)(),(0,Rt.WM)(),(0,Wt.Gi)(),(0,Wt.ji)();var Hp=class{constructor(e,t,i){this.input1Editor=e,this.input2Editor=t,this.resultEditor=i,this.conflictActionsFactoryInput1=new Op(this.input1Editor),this.conflictActionsFactoryInput2=new Op(this.input2Editor),this.conflictActionsFactoryResult=new Op(this.resultEditor)}computeViewZones(e,t,i){let o,s,r=0,n=0,a=0,d=0,l=[],c=[],h=[],u=[],g=t.model,p=g.baseResultDiffs.read(e),b=(0,Wt.Mi)(g.modifiedBaseRanges.read(e),p,(e,t)=>e.baseRange.intersectsOrTouches(t.inputRange)?Rt.CM.neitherLessOrGreaterThan:Wt.Wi.compareByStart(e.baseRange,t.inputRange)),m=i.codeLensesVisible,v=i.showNonConflictingChanges;for(let y of b){if(m&&y.left&&(y.left.isConflicting||v||!g.isHandled(y.left).read(e))){var C,w;let o=new Kp(t,y.left);(i.shouldAlignResult||!o.inputIsEmpty.read(e))&&(l.push(new $p(this.conflictActionsFactoryInput1,y.left.input1Range.startLineNumber-1,o.itemsInput1)),c.push(new $p(this.conflictActionsFactoryInput2,y.left.input2Range.startLineNumber-1,o.itemsInput2)),i.shouldAlignBase&&h.push(new qp(y.left.baseRange.startLineNumber-1,16)));let r=y.left.baseRange.startLineNumber+(null!==(C=null===(w=s)||void 0===w?void 0:w.resultingDeltaFromOriginalToModified)&&void 0!==C?C:0)-1;u.push(new $p(this.conflictActionsFactoryResult,r,o.resultItems))}let p,b=y.rights.at(-1);b&&(s=b),y.left?(p=Qp(y.left).map(e=>({input1Line:e[0],baseLine:e[1],input2Line:e[2],resultLine:void 0})),o=y.left,p[p.length-1].resultLine=y.left.baseRange.endLineNumberExclusive+(s?s.resultingDeltaFromOriginalToModified:0)):p=[{baseLine:b.inputRange.endLineNumberExclusive,input1Line:b.inputRange.endLineNumberExclusive+(o?o.input1Range.endLineNumberExclusive-o.baseRange.endLineNumberExclusive:0),input2Line:b.inputRange.endLineNumberExclusive+(o?o.input2Range.endLineNumberExclusive-o.baseRange.endLineNumberExclusive:0),resultLine:b.outputRange.endLineNumberExclusive}];for(let{input1Line:e,baseLine:t,input2Line:o,resultLine:s}of p){if(!i.shouldAlignBase&&(void 0===e||void 0===o))continue;let g=void 0===e?-1:e+r,p=void 0===o?-1:o+n,b=t+a,m=void 0===s?-1:s+d,v=Math.max(i.shouldAlignBase?b:0,g,p,i.shouldAlignResult?m:0);if(void 0!==e){let t=v-g;t>0&&(l.push(new zp(e-1,t)),r+=t)}if(void 0!==o){let e=v-p;e>0&&(c.push(new zp(o-1,e)),n+=e)}if(i.shouldAlignBase){let e=v-b;e>0&&(h.push(new zp(t-1,e)),a+=e)}if(i.shouldAlignResult&&void 0!==s){let e=v-m;e>0&&(u.push(new zp(s-1,e)),d+=e)}}}return new Xp(l,c,h,u)}},Xp=class{constructor(e,t,i,o){this.input1ViewZones=e,this.input2ViewZones=t,this.baseViewZones=i,this.resultViewZones=o}},Up=class{},zp=class extends Up{constructor(e,t){super(),this.afterLineNumber=e,this.heightInLines=t}create(e,t,i){t.push(e.addZone({afterLineNumber:this.afterLineNumber,heightInLines:this.heightInLines,domNode:(0,Rt.Zb)("div.diagonal-fill")}))}},qp=class extends Up{constructor(e,t){super(),this.afterLineNumber=e,this.heightPx=t}create(e,t,i){t.push(e.addZone({afterLineNumber:this.afterLineNumber,heightInPx:this.heightPx,domNode:(0,Rt.Zb)("div.conflict-actions-placeholder")}))}},$p=class extends Up{constructor(e,t,i){super(),this.conflictActionsFactory=e,this.lineNumber=t,this.items=i}create(e,t,i){i.add(this.conflictActionsFactory.createWidget(e,this.lineNumber,this.items,t))}};(0,Rt.Ev)(),(0,Rt.Fj)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Lt.Xn)(),(0,Rt.Rg)("settings.settingsHeaderHoverForeground",(0,Rt.zg)((0,Rt.Rg)("settings.headerForeground",{light:"#444444",dark:"#e7e7e7",hcDark:"#ffffff",hcLight:"#292929"},(0,Rt.Ij)(10153,"The foreground color for a section header or active title.")),.7),(0,Rt.Ij)(10154,"The foreground color for a section header or hovered title.")),(0,Rt.Rg)("settings.modifiedItemIndicator",{light:new Rt.Sv(new Rt.Tv(102,175,224)),dark:new Rt.Sv(new Rt.Tv(12,125,157)),hcDark:new Rt.Sv(new Rt.Tv(0,73,122)),hcLight:new Rt.Sv(new Rt.Tv(102,175,224))},(0,Rt.Ij)(10155,"The color of the modified setting indicator.")),(0,Rt.Rg)("settings.headerBorder",Lt.Mt,(0,Rt.Ij)(10156,"The color of the header container border."));var eb=(0,Rt.Rg)("settings.sashBorder",Lt.Mt,(0,Rt.Ij)(10157,"The color of the Settings editor splitview sash border."));(0,Rt.Rg)("settings.dropdownBackground",Rt.ih,(0,Rt.Ij)(10158,"Settings editor dropdown background.")),(0,Rt.Rg)("settings.dropdownForeground",Rt.oh,(0,Rt.Ij)(10159,"Settings editor dropdown foreground.")),(0,Rt.Rg)("settings.dropdownBorder",Rt.ah,(0,Rt.Ij)(10160,"Settings editor dropdown border.")),(0,Rt.Rg)("settings.dropdownListBorder",Rt.ng,(0,Rt.Ij)(10161,"Settings editor dropdown list border. This surrounds the options and separates the options from the description.")),(0,Rt.Rg)("settings.checkboxBackground",Rt.Jm,(0,Rt.Ij)(10162,"Settings editor checkbox background.")),(0,Rt.Rg)("settings.checkboxForeground",Rt.Xm,(0,Rt.Ij)(10163,"Settings editor checkbox foreground.")),(0,Rt.Rg)("settings.checkboxBorder",Rt.Ym,(0,Rt.Ij)(10164,"Settings editor checkbox border.")),(0,Rt.Rg)("settings.textInputBackground",Rt.th,(0,Rt.Ij)(10165,"Settings editor text input box background.")),(0,Rt.Rg)("settings.textInputForeground",Rt.rh,(0,Rt.Ij)(10166,"Settings editor text input box foreground.")),(0,Rt.Rg)("settings.textInputBorder",Rt.nh,(0,Rt.Ij)(10167,"Settings editor text input box border.")),(0,Rt.Rg)("settings.numberInputBackground",Rt.th,(0,Rt.Ij)(10168,"Settings editor number input box background.")),(0,Rt.Rg)("settings.numberInputForeground",Rt.rh,(0,Rt.Ij)(10169,"Settings editor number input box foreground.")),(0,Rt.Rg)("settings.numberInputBorder",Rt.nh,(0,Rt.Ij)(10170,"Settings editor number input box border.")),(0,Rt.Rg)("settings.focusedRowBackground",{dark:(0,Rt.zg)(Rt.Vm,.6),light:(0,Rt.zg)(Rt.Vm,.6),hcDark:null,hcLight:null},(0,Rt.Ij)(10171,"The background color of a settings row when focused.")),(0,Rt.Rg)("settings.rowHoverBackground",{dark:(0,Rt.zg)(Rt.Vm,.3),light:(0,Rt.zg)(Rt.Vm,.3),hcDark:null,hcLight:null},(0,Rt.Ij)(10172,"The background color of a settings row when hovered.")),(0,Rt.Rg)("settings.focusedRowBorder",Rt.xg,(0,Rt.Ij)(10173,"The color of the row's top and bottom border when the row is focused.")),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Yi)(),(0,Rt.Bn)(),(0,Rt.Mb)(),(0,Rt.gD)(),(0,Rt.PA)(),(0,Rt.IC)(),(0,Rt.PS)(),(0,Rt.ok)(),(0,Rt.nM)(),(0,Rt.uy)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.wl)(),(0,Rt.Kb)(),(0,Rt.Mi)(),(0,Wt.Di)(),(0,Wt.ji)(),(0,Rt.gC)(),(0,Rt.uC)(),(0,Rt.tC)(),(0,Rt.XS)();var tb=class extends Wp{constructor(e,t,i,o,s){super(i,t,s),this.inputNumber=e,this.otherInputNumber=1===this.inputNumber?2:1,this.modifiedBaseRangeGutterItemInfos=(0,Rt.mC)({debugName:"input".concat(this.inputNumber,".modifiedBaseRangeGutterItemInfos")},e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=this.inputNumber,s=t.showNonConflictingChanges.read(e);return i.modifiedBaseRanges.read(e).filter(t=>t.getInputDiffs(this.inputNumber).length>0&&(s||t.isConflicting||!i.isHandled(t).read(e))).map((e,i)=>new ib(i.toString(),e,o,t))}),this.decorations=(0,Rt.mC)({debugName:"input".concat(this.inputNumber,".decorations")},e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=(1===this.inputNumber?i.input1:i.input2).textModel,s=t.activeModifiedBaseRange.read(e),r=[],n=t.showNonConflictingChanges.read(e),a=this.showDeletionMarkers.read(e),d=!(void 0!==t.baseCodeEditorView.read(e)&&t.baseShowDiffAgainst.read(e)===this.inputNumber)&&this.useSimplifiedDecorations.read(e);for(let l of i.modifiedBaseRanges.read(e)){let t=l.getInputRange(this.inputNumber);if(!t)continue;let c=["merge-editor-block"],h=[0,0,0,0],u=i.isInputHandled(l,this.inputNumber).read(e);u&&c.push("handled"),l===s&&(c.push("focused"),h=[0,2,0,2]),l.isConflicting&&c.push("conflicting");let g=1===this.inputNumber?"input i1":"input i2";if(c.push(g),(l.isConflicting||n||!u)&&(d&&!u&&c.push("use-simplified-decorations"),r.push({range:t.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:c.join(" "),blockPadding:h,blockIsAfterEnd:t.startLineNumber>o.getLineCount(),description:"Merge Editor",minimap:{position:Rt.ny.Gutter,color:{id:u?Vp:Rp}},overviewRuler:l.isConflicting?{position:Rt.ay.Center,color:{id:u?Vp:Rp}}:void 0}}),!d&&(l.isConflicting||!i.isHandled(l).read(e)))){let e=l.getInputDiffs(this.inputNumber);for(let t of e){let e=t.outputRange.toInclusiveRange();if(e&&r.push({range:e,options:{className:"merge-editor-diff ".concat(g),description:"Merge Editor",isWholeLine:!0}}),t.rangeMappings)for(let i of t.rangeMappings)(a||!i.outputRange.isEmpty())&&r.push({range:i.outputRange,options:{className:i.outputRange.isEmpty()?"merge-editor-diff-empty-word ".concat(g):"merge-editor-diff-word ".concat(g),description:"Merge Editor",showIfCollapsed:!0}})}}}return r}),this.htmlElements.root.classList.add("input"),this._register(new Tp(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(e,t)=>this.checkboxesVisible.read(t)?this.modifiedBaseRangeGutterItemInfos.read(t):[],createView:(e,t)=>new ob(e,t,o)})),this._register(Fp(this,(e,t)=>t.model.translateBaseRangeToInput(this.inputNumber,e))),this._register(i.createInstance(Gp,1===e?Rt.sb.MergeInput1Toolbar:Rt.sb.MergeInput2Toolbar,this.htmlElements.toolbar)),this._register((0,Rt.sC)({debugName:"input".concat(this.inputNumber,": update labels & text model")},e=>{let t=this.viewModel.read(e);if(!t)return;this.editor.setModel(1===this.inputNumber?t.model.input1.textModel:t.model.input2.textModel);let i=1===this.inputNumber?t.model.input1.title||(0,Rt.Ij)(9182,"Input 1"):t.model.input2.title||(0,Rt.Ij)(9183,"Input 2"),o=1===this.inputNumber?t.model.input1.description:t.model.input2.description,s=1===this.inputNumber?t.model.input1.detail:t.model.input2.detail;(0,Rt.vS)(this.htmlElements.title,...(0,Rt.Zi)(i)),(0,Rt.vS)(this.htmlElements.description,...o?(0,Rt.Zi)(o):[]),(0,Rt.vS)(this.htmlElements.detail,...s?(0,Rt.Zi)(s):[])})),this._register((0,Wt.ki)(this.editor,this.decorations))}};tb=(0,Rt.Pb)([(0,Rt.Fb)(2,Rt.Ub),(0,Rt.Fb)(3,Rt.Sl),(0,Rt.Fb)(4,Rt.o_)],tb);var ib=class{constructor(e,t,i,o){this.id=e,this.baseRange=t,this.inputNumber=i,this.viewModel=o,this.model=this.viewModel.model,this.range=this.baseRange.getInputRange(this.inputNumber),this.enabled=this.model.isUpToDate,this.toggleState=(0,Rt.dC)(this,e=>{let t=this.model.getState(this.baseRange).read(e).getInput(this.inputNumber);return t!==Wt.wi.second||this.baseRange.isOrderRelevant?t:Wt.wi.first}),this.state=(0,Rt.dC)(this,e=>{let t=this.viewModel.activeModifiedBaseRange.read(e);return this.model.hasBaseRange(this.baseRange)?{handled:this.model.isHandled(this.baseRange).read(e),focused:this.baseRange===t}:{handled:!1,focused:!1}})}setState(e,t){this.viewModel.setState(this.baseRange,this.model.getState(this.baseRange).get().withInputValue(this.inputNumber,e),t,this.inputNumber)}toggleBothSides(){(0,Rt.rC)(e=>{let t=this.model.getState(this.baseRange).get();this.model.setState(this.baseRange,t.toggle(this.inputNumber).toggle(1===this.inputNumber?2:1),!0,e)})}getContextMenuActions(){let e=this.model.getState(this.baseRange).get(),t=this.model.isHandled(this.baseRange).get(),i=e=>{(0,Rt.rC)(t=>this.viewModel.setState(this.baseRange,e,t,this.inputNumber))};function o(e,t,o,s){let r=new Rt.Ob(e,t,void 0,!0,()=>{i(o)});return r.checked=s,r}let s=e.includesInput1&&e.includesInput2;return[this.baseRange.input1Diffs.length>0?o("mergeEditor.acceptInput1",(0,Rt.Ij)(9184,"Accept {0}",this.model.input1.title),e.toggle(1),e.includesInput1):void 0,this.baseRange.input2Diffs.length>0?o("mergeEditor.acceptInput2",(0,Rt.Ij)(9184,"Accept {0}",this.model.input2.title),e.toggle(2),e.includesInput2):void 0,this.baseRange.isConflicting?(0,Wt.Ni)(o("mergeEditor.acceptBoth",(0,Rt.Ij)(9185,"Accept Both"),e.withInputValue(1,!s).withInputValue(2,!s),s),{enabled:this.baseRange.canBeCombined}):void 0,new Rt.Ab,this.baseRange.isConflicting?(0,Wt.Ni)(o("mergeEditor.swap",(0,Rt.Ij)(9186,"Swap"),e.swap(),!1),{enabled:!e.kind&&(!s||this.baseRange.isOrderRelevant)}):void 0,(0,Wt.Ni)(new Rt.Ob("mergeEditor.markAsHandled",(0,Rt.Ij)(9187,"Mark as Handled"),void 0,!0,()=>{(0,Rt.rC)(e=>{this.model.setHandled(this.baseRange,!t,e)})}),{checked:t})].filter(Rt.aM)}},ob=class extends Rt.CA{constructor(e,t,i){super(),this.isMultiLine=(0,Rt.ZS)(this,!1),this.item=(0,Rt.ZS)(this,e);let o=new Rt.zn((0,xt.A)({isChecked:!1,title:"",icon:Rt.mD.check},Rt.Ai));o.domNode.classList.add("accept-conflict-group"),this._register((0,Rt.ox)(o.domNode,Rt.tx.MOUSE_DOWN,e=>{let t=this.item.get();t&&(2===e.button?(e.stopPropagation(),e.preventDefault(),i.showContextMenu({getAnchor:()=>o.domNode,getActions:()=>t.getContextMenuActions()})):1===e.button&&(e.stopPropagation(),e.preventDefault(),t.toggleBothSides()))})),this._register((0,Rt.iC)(e=>{let t=this.item.read(e),i=t.toggleState.read(e),s={[Wt.wi.excluded]:{icon:void 0,checked:!1,title:(0,Rt.Ij)(9188,"Accept")},[Wt.wi.unrecognized]:{icon:Rt.mD.circleFilled,checked:!1,title:(0,Rt.Ij)(9189,"Accept (result is dirty)")},[Wt.wi.first]:{icon:Rt.mD.check,checked:!0,title:(0,Rt.Ij)(9190,"Undo accept")},[Wt.wi.second]:{icon:Rt.mD.checkAll,checked:!0,title:(0,Rt.Ij)(9191,"Undo accept (currently second)")}}[i];o.setIcon(s.icon),o.checked=s.checked,o.setTitle(s.title),t.enabled.read(e)?o.enable():o.disable()})),this._register((0,Rt.iC)(e=>{let i=this.item.read(e).state.read(e);t.className=["merge-accept-gutter-marker",i.handled&&"handled",i.focused&&"focused",this.isMultiLine.read(e)?"multi-line":"single-line"].filter(e=>"string"==typeof e).join(" ")})),this._register(o.onChange(()=>{(0,Rt.rC)(e=>{this.item.get().setState(o.checked,e)})})),t.appendChild((0,Rt.Gx)("div.background",["\xa0"]).root),t.appendChild(this.checkboxDiv=(0,Rt.Gx)("div.checkbox",[(0,Rt.Gx)("div.checkbox-background",[o.domNode])]).root)}layout(e,t,i,o){let s=this.checkboxDiv.clientHeight,r=e+(t/2-s/2),n=[s,i+o-s-s],a=[e+s,e+t-s-s];a[0]<a[1]&&(r=(0,Rt.FC)(r,n[0],n[1]),r=(0,Rt.FC)(r,a[0],a[1])),this.checkboxDiv.style.top="".concat(r-e,"px"),(0,Rt.rC)(e=>{this.isMultiLine.set(t>30,e)})}update(e){(0,Rt.rC)(t=>{this.item.set(e,t)})}};(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.zr)(),(0,Rt.Yi)(),(0,Rt.WM)(),(0,Rt.xN)(),(0,Rt.PA)(),(0,Rt.PS)(),(0,Rt.uy)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.bb)(),(0,Rt.Kb)(),(0,Rt.Xa)(),(0,Wt.Gi)(),(0,Wt.ji)(),(0,Wt.Ci)(),(0,Rt.gC)(),(0,Rt.uC)();var sb,rb,nb=class extends Wp{constructor(e,t,i,o){super(t,e,o),this._labelService=i,this.decorations=(0,Rt.dC)(this,e=>{let t=this.viewModel.read(e);if(!t)return[];let i=t.model,o=i.resultTextModel,s=[],r=(0,Wt.Mi)(i.modifiedBaseRanges.read(e),i.baseResultDiffs.read(e),(e,t)=>e.baseRange.intersectsOrTouches(t.inputRange)?Rt.CM.neitherLessOrGreaterThan:Wt.Wi.compareByStart(e.baseRange,t.inputRange)),n=t.activeModifiedBaseRange.read(e),a=t.showNonConflictingChanges.read(e);for(let d of r){let t=d.left;if(t){let r=["merge-editor-block"],d=[0,0,0,0],l=i.isHandled(t).read(e);if(l&&r.push("handled"),t===n&&(r.push("focused"),d=[0,2,0,2]),t.isConflicting&&r.push("conflicting"),r.push("result"),!t.isConflicting&&!a&&l)continue;let c=i.getLineRangeInResult(t.baseRange,e);s.push({range:c.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:r.join(" "),blockPadding:d,blockIsAfterEnd:c.startLineNumber>o.getLineCount(),description:"Result Diff",minimap:{position:Rt.ny.Gutter,color:{id:l?Vp:Rp}},overviewRuler:t.isConflicting?{position:Rt.ay.Center,color:{id:l?Vp:Rp}}:void 0}})}if(!t||t.isConflicting)for(let e of d.rights){let t=e.outputRange.toInclusiveRange();if(t&&s.push({range:t,options:{className:"merge-editor-diff result",description:"Merge Editor",isWholeLine:!0}}),e.rangeMappings)for(let i of e.rangeMappings)s.push({range:i.outputRange,options:{className:"merge-editor-diff-word result",description:"Merge Editor"}})}}return s}),this.editor.invokeWithinContext(e=>{let t=e.get(Rt.yb),i=Wt.gi.bindTo(t);i.set(!0),this._register((0,Rt.zA)(()=>i.reset()))}),this.htmlElements.gutterDiv.style.width="5px",this.htmlElements.root.classList.add("result"),this._register((0,Rt.lC)((e,t)=>{this.checkboxesVisible.read(e)&&t.add(new Tp(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(e,t)=>[],createView:(e,t)=>{throw new Rt.lN}}))})),this._register((0,Rt.iC)(e=>{let t=this.viewModel.read(e);t&&(this.editor.setModel(t.model.resultTextModel),(0,Rt.vS)(this.htmlElements.title,...(0,Rt.Zi)((0,Rt.Ij)(9192,"Result"))),(0,Rt.vS)(this.htmlElements.description,...(0,Rt.Zi)(this._labelService.getUriLabel(t.model.resultTextModel.uri,{relative:!0}))))}));let s=this._register(new Rt.Lr(this.htmlElements.detail));this._register((0,Rt.iC)(e=>{let t=this.viewModel.read(e);if(!t)return;let i=t.model;if(!i)return;let o=i.unhandledConflictsCount.read(e),r=1===o?(0,Rt.Ij)(9193,"{0} Conflict Remaining",o):(0,Rt.Ij)(9194,"{0} Conflicts Remaining ",o);s.clear(),s.push({class:void 0,enabled:o>0,id:"nextConflict",label:r,run(){t.model.telemetry.reportConflictCounterClicked(),t.goToNextModifiedBaseRange(e=>!i.isHandled(e).read(void 0))},tooltip:o>0?(0,Rt.Ij)(9195,"Go to next conflict"):(0,Rt.Ij)(9196,"All conflicts handled, the merge can be completed now.")})})),this._register((0,Wt.ki)(this.editor,this.decorations)),this._register(Fp(this,(e,t)=>t.model.translateBaseRangeToResult(e))),this._register(t.createInstance(Gp,Rt.sb.MergeInputResultToolbar,this.htmlElements.toolbar))}};nb=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Rt.Ya),(0,Rt.Fb)(3,Rt.o_)],nb),(0,Rt.fE)(),(0,Rt.Ib)(),(0,Rt.qx)(),(0,Rt.Yt)(),(0,Rt.Ev)(),(0,Rt.xN)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.PS)(),(0,Rt.iT)(),(0,Rt.nM)(),(0,Rt.Hb)(),(0,Rt.pv)(),(0,Rt._v)(),(0,Rt.Fj)(),(0,Rt.bb)(),(0,Rt.bs)(),(0,Rt.Kb)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Rt.ab)(),(0,Rt.$d)(),(0,Pt.en)(),(0,Zt.h)(),(0,Tt.mn)(),(0,Wt.pi)(),(0,Wt.ji)(),(0,Wt.Ci)(),(0,Pt.G)(),(0,Lt.a)(),(0,Lt.L)(),(0,Pt.At)(),(0,Rt.en)(),(0,Rt.XS)(),(0,Rt.tC)(),(0,Rt.uC)(),(0,Rt.mE)({});var ab=(Qe=class extends Ho{get viewModel(){return this._viewModel}get inputModel(){return this._inputModel}get model(){var e;return null===(e=this.inputModel.get())||void 0===e?void 0:e.model}constructor(e,t,i,o,s,r,n,a,d,l,c){var h;super(sb.ID,e,o,t,s,n,r,a,d,l),this.contextKeyService=i,this._codeEditorService=c,this._sessionDisposables=new Rt.EA,this._viewModel=(0,Rt.ZS)(this,void 0),this._grid=this._register(new Rt.OA),this.input1View=this._register(this.instantiationService.createInstance(tb,1,this._viewModel)),this.baseView=(0,Rt.ZS)(this,void 0),this.baseViewOptions=(0,Rt.ZS)(this,void 0),this.input2View=this._register(this.instantiationService.createInstance(tb,2,this._viewModel)),this.inputResultView=this._register(this.instantiationService.createInstance(nb,this._viewModel)),this._layoutMode=this.instantiationService.createInstance(db),this._layoutModeObs=(0,Rt.ZS)(this,this._layoutMode.value),this._ctxIsMergeEditor=Wt.hi.bindTo(this.contextKeyService),this._ctxUsesColumnLayout=Wt.vi.bindTo(this.contextKeyService),this._ctxShowBase=Wt.yi.bindTo(this.contextKeyService),this._ctxShowBaseAtTop=Wt.bi.bindTo(this.contextKeyService),this._ctxResultUri=Wt.Si.bindTo(this.contextKeyService),this._ctxBaseUri=Wt._i.bindTo(this.contextKeyService),this._ctxShowNonConflictingChanges=Wt.xi.bindTo(this.contextKeyService),this._inputModel=(0,Rt.ZS)(this,void 0),this.viewZoneComputer=new Hp(this.input1View.editor,this.input2View.editor,this.inputResultView.editor),this.scrollSynchronizer=this._register(new Np(this._viewModel,this.input1View,this.input2View,this.baseView,this.inputResultView,this._layoutModeObs)),this._onDidChangeSizeConstraints=new Rt.uA,this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this.baseViewDisposables=this._register(new Rt.EA),this.showNonConflictingChangesStore=this.instantiationService.createInstance(Wt.Oi,"mergeEditor/showNonConflictingChanges"),this.showNonConflictingChanges=(0,Rt.ZS)(this,null!==(h=this.showNonConflictingChangesStore.get())&&void 0!==h&&h)}dispose(){this._sessionDisposables.dispose(),this._ctxIsMergeEditor.reset(),this._ctxUsesColumnLayout.reset(),this._ctxShowNonConflictingChanges.reset(),super.dispose()}get minimumWidth(){return"mixed"===this._layoutMode.value.kind?this.input1View.view.minimumWidth+this.input2View.view.minimumWidth:this.input1View.view.minimumWidth+this.input2View.view.minimumWidth+this.inputResultView.view.minimumWidth}getTitle(){return this.input?this.input.getName():(0,Rt.Ij)(9197,"Text Merge Editor")}createEditorControl(e,t){this.rootHtmlElement=e,e.classList.add("merge-editor"),this.applyLayout(this._layoutMode.value),this.applyOptions(t)}updateEditorControlOptions(e){this.applyOptions(e)}applyOptions(e){let t=(0,Wt.Ai)(e,{minimap:{enabled:!1},glyphMargin:!1,lineNumbersMinChars:2}),i=(0,Wt.Ai)(t,{readOnly:!0,readOnlyMessage:void 0});this.input1View.updateOptions(i),this.input2View.updateOptions(i),this.baseViewOptions.set((0,xt.A)({},this.input2View.editor.getRawOptions()),void 0),this.inputResultView.updateOptions(t)}getMainControl(){return this.inputResultView.editor}layout(e){var t;null===(t=this._grid.value)||void 0===t||t.layout(e.width,e.height)}async setInput(e,t,i,o){if(!(e instanceof Wt.di))throw new Rt.lN("ONLY MergeEditorInput is supported");await super.setInput(e,t,i,o),this._sessionDisposables.clear(),(0,Rt.rC)(e=>{this._viewModel.set(void 0,e),this._inputModel.set(void 0,e)});let s=await e.resolve(),r=s.model,n=this.instantiationService.createInstance(Pp,r,this.input1View,this.input2View,this.inputResultView,this.baseView,this.showNonConflictingChanges);r.telemetry.reportMergeEditorOpened({combinableConflictCount:r.combinableConflictCount,conflictCount:r.conflictCount,baseTop:this._layoutModeObs.get().showBaseAtTop,baseVisible:this._layoutModeObs.get().showBase,isColumnView:"columns"===this._layoutModeObs.get().kind}),(0,Rt.rC)(e=>{this._viewModel.set(n,e),this._inputModel.set(s,e)}),this._sessionDisposables.add(n),this._sessionDisposables.add((0,Rt.iC)(t=>{let i=n.focusedEditorType.read(t);e instanceof Wt.di&&e.updateFocusedEditor(i||"result")})),this._ctxResultUri.set(s.resultUri.toString()),this._ctxBaseUri.set(r.base.uri.toString()),this._sessionDisposables.add((0,Rt.zA)(()=>{this._ctxBaseUri.reset(),this._ctxResultUri.reset()}));let a=new Rt.EA;this._sessionDisposables.add(a),this._sessionDisposables.add((0,Rt.lC)(e=>{let t=this.baseView.read(e),i=this.inputResultView.editor.getScrollTop();this.scrollSynchronizer.stopSync(),a.clear(),this.inputResultView.editor.changeViewZones(i=>{let o=this._layoutModeObs.read(e),s="columns"===o.kind,r="mixed"===o.kind&&!o.showBaseAtTop;this.input1View.editor.changeViewZones(o=>{this.input2View.editor.changeViewZones(d=>{t?t.editor.changeViewZones(l=>{a.add(this.setViewZones(e,n,this.input1View.editor,o,this.input2View.editor,d,t.editor,l,r,this.inputResultView.editor,i,s))}):a.add(this.setViewZones(e,n,this.input1View.editor,o,this.input2View.editor,d,void 0,void 0,!1,this.inputResultView.editor,i,s))})})}),this.inputResultView.editor.setScrollTop(i,Rt.fv.Smooth),this.scrollSynchronizer.startSync(),this.scrollSynchronizer.updateScrolling()}));let d=this.loadEditorViewState(e,i);d?this._applyViewState(d):this._sessionDisposables.add((0,Rt.RA)(r.onInitialized,()=>{let e=r.modifiedBaseRanges.get().find(e=>e.isConflicting);e&&(this.input1View.editor.revealLineInCenter(e.input1Range.startLineNumber),(0,Rt.rC)(t=>{n.setActiveModifiedBaseRange(e,t)}))}));let l=e=>{var t;let i=(0,Tt.hn)(e,this._codeEditorService);(0,Tt.gn)(r.input2.textModel,i,this._codeEditorService),(0,Tt.gn)(r.input1.textModel,i,this._codeEditorService),(0,Tt.gn)(r.resultTextModel,i,this._codeEditorService);let o=null===(t=this.baseView.get())||void 0===t?void 0:t.editor.getModel();o&&(0,Tt.gn)(o,i,this._codeEditorService)};this._sessionDisposables.add(this._codeEditorService.onDidChangeTransientModelProperty(e=>{l(e)})),l(this.inputResultView.editor.getModel());let c=this;this._sessionDisposables.add(new class{constructor(){this._disposable=new Rt.EA;for(let e of this.baseInput1Input2())this._disposable.add(e.onDidChangeContent(()=>this._checkBaseInput1Input2AllEmpty()))}dispose(){this._disposable.dispose()}*baseInput1Input2(){yield r.base,yield r.input1.textModel,yield r.input2.textModel}_checkBaseInput1Input2AllEmpty(){for(let e of this.baseInput1Input2())if(e.getValueLength()>0)return;c.editorService.replaceEditors([{editor:e,replacement:{resource:e.result,options:{preserveFocus:!0}},forceReplaceDirty:!0}],c.group)}})}setViewZones(e,t,i,o,s,r,n,a,d,l,c,h){let u=[],g=[],p=[],b=[],m=this.viewZoneComputer.computeViewZones(e,t,{codeLensesVisible:!0,showNonConflictingChanges:this.showNonConflictingChanges.read(e),shouldAlignBase:d,shouldAlignResult:h}),v=new Rt.EA;if(a)for(let C of m.baseViewZones)C.create(a,p,v);for(let C of m.resultViewZones)C.create(c,b,v);for(let C of m.input1ViewZones)C.create(o,u,v);for(let C of m.input2ViewZones)C.create(r,g,v);return v.add({dispose:()=>{i.changeViewZones(e=>{for(let t of u)e.removeZone(t)}),s.changeViewZones(e=>{for(let t of g)e.removeZone(t)}),null!==n&&void 0!==n&&n.changeViewZones(e=>{for(let t of p)e.removeZone(t)}),l.changeViewZones(e=>{for(let t of b)e.removeZone(t)})}}),v}setOptions(e){super.setOptions(e),e&&(0,Zt.m)(e,this.inputResultView.editor,Rt.fv.Smooth)}clearInput(){super.clearInput(),this._sessionDisposables.clear();for(let{editor:e}of[this.input1View,this.input2View,this.inputResultView])e.setModel(null)}focus(){var e;super.focus(),(null!==(e=this.getControl())&&void 0!==e?e:this.inputResultView.editor).focus()}hasFocus(){for(let{editor:e}of[this.input1View,this.input2View,this.inputResultView])if(e.hasTextFocus())return!0;return super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e);for(let{editor:t}of[this.input1View,this.input2View,this.inputResultView])e?t.onVisible():t.onHide();this._ctxIsMergeEditor.set(e)}getControl(){return this.inputResultView.editor}get scopedContextKeyService(){var e;return null===(e=this.getControl())||void 0===e?void 0:e.invokeWithinContext(e=>e.get(Rt.yb))}toggleBase(){this.setLayout((0,xt.A)((0,xt.A)({},this._layoutMode.value),{},{showBase:!this._layoutMode.value.showBase}))}toggleShowBaseTop(){let e=this._layoutMode.value.showBase&&this._layoutMode.value.showBaseAtTop;this.setLayout((0,xt.A)((0,xt.A)({},this._layoutMode.value),{},{showBaseAtTop:!0,showBase:!e}))}toggleShowBaseCenter(){let e=this._layoutMode.value.showBase&&!this._layoutMode.value.showBaseAtTop;this.setLayout((0,xt.A)((0,xt.A)({},this._layoutMode.value),{},{showBaseAtTop:!1,showBase:!e}))}setLayoutKind(e){this.setLayout((0,xt.A)((0,xt.A)({},this._layoutMode.value),{},{kind:e}))}setLayout(e){var t;let i=this._layoutMode.value;JSON.stringify(i)!==JSON.stringify(e)&&(null!==(t=this.model)&&void 0!==t&&t.telemetry.reportLayoutChange({baseTop:e.showBaseAtTop,baseVisible:e.showBase,isColumnView:"columns"===e.kind}),this.applyLayout(e))}applyLayout(e){(0,Rt.rC)(t=>{if(e.showBase&&!this.baseView.get()){this.baseViewDisposables.clear();let e=this.baseViewDisposables.add(this.instantiationService.createInstance(Zp,this.viewModel));this.baseViewDisposables.add((0,Rt.iC)(t=>{let i=this.baseViewOptions.read(t);i&&e.updateOptions(i)})),this.baseView.set(e,t)}else!e.showBase&&this.baseView.get()&&(this.baseView.set(void 0,t),this.baseViewDisposables.clear());"mixed"===e.kind?this.setGrid([e.showBaseAtTop&&e.showBase?{size:38,data:this.baseView.get().view}:void 0,{size:38,groups:[{data:this.input1View.view},!e.showBaseAtTop&&e.showBase?{data:this.baseView.get().view}:void 0,{data:this.input2View.view}].filter(Rt.aM)},{size:62,data:this.inputResultView.view}].filter(Rt.aM)):"columns"===e.kind&&this.setGrid([e.showBase?{size:40,data:this.baseView.get().view}:void 0,{size:60,groups:[{data:this.input1View.view},{data:this.inputResultView.view},{data:this.input2View.view}]}].filter(Rt.aM)),this._layoutMode.value=e,this._ctxUsesColumnLayout.set(e.kind),this._ctxShowBase.set(e.showBase),this._ctxShowBaseAtTop.set(e.showBaseAtTop),this._onDidChangeSizeConstraints.fire(),this._layoutModeObs.set(e,t)})}setGrid(e){var t;let i=-1,o=-1;this._grid.value&&(i=this._grid.value.width,o=this._grid.value.height),this._grid.value=Vi.from({orientation:Rt.Xt.VERTICAL,size:100,groups:e},{styles:{separatorBorder:null!==(t=this.theme.getColor(eb))&&void 0!==t?t:Rt.Sv.transparent},proportionalLayout:!0}),(0,Rt.vS)(this.rootHtmlElement,this._grid.value.element),-1!==i&&this._grid.value.layout(i,o)}_applyViewState(e){e&&(this.inputResultView.editor.restoreViewState(e),e.input1State&&this.input1View.editor.restoreViewState(e.input1State),e.input2State&&this.input2View.editor.restoreViewState(e.input2State),e.focusIndex>=0&&[this.input1View.editor,this.input2View.editor,this.inputResultView.editor][e.focusIndex].focus())}computeEditorViewState(e){var t,i,o;if(!(0,Rt.oT)(null===(t=this.inputModel.get())||void 0===t?void 0:t.resultUri,e))return;let s=this.inputResultView.editor.saveViewState();if(!s)return;let r=null!==(i=this.input1View.editor.saveViewState())&&void 0!==i?i:void 0,n=null!==(o=this.input2View.editor.saveViewState())&&void 0!==o?o:void 0,a=[this.input1View.editor,this.input2View.editor,this.inputResultView.editor].findIndex(e=>e.hasWidgetFocus());return(0,xt.A)((0,xt.A)({},s),{},{input1State:r,input2State:n,focusIndex:a})}tracksEditorViewState(e){return e instanceof Wt.di}toggleShowNonConflictingChanges(){this.showNonConflictingChanges.set(!this.showNonConflictingChanges.get(),void 0),this.showNonConflictingChangesStore.set(this.showNonConflictingChanges.get()),this._ctxShowNonConflictingChanges.set(this.showNonConflictingChanges.get())}},{_:sb=Qe},{_:Qe.ID="mergeEditor"},Qe);ab=sb=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.Ub),(0,Rt.Fb)(2,Rt.yb),(0,Rt.Fb)(3,Rt.ib),(0,Rt.Fb)(4,Rt.Uo),(0,Rt.Fb)(5,Rt.Qd),(0,Rt.Fb)(6,Rt.hv),(0,Rt.Fb)(7,Pt.kt),(0,Rt.Fb)(8,Pt.W),(0,Rt.Fb)(9,Rt.ys),(0,Rt.Fb)(10,Rt.Vb)],ab);var db=(Ye=class{constructor(e){this._storageService=e,this._value={kind:"mixed",showBase:!1,showBaseAtTop:!0};let t=e.get(rb._key,Rt.Go.PROFILE,"mixed");if("mixed"===t||"columns"===t)this._value={kind:t,showBase:!1,showBaseAtTop:!0};else if(t)try{this._value=JSON.parse(t)}catch(e){(0,Rt.CN)(e)}}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._storageService.store(rb._key,JSON.stringify(this._value),Rt.Go.PROFILE,Rt.Ko.USER))}},{_:rb=Ye},{_:Ye._key="mergeEditor/layout"},Ye);db=rb=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Uo)],db);var lb=class extends Rt.CA{constructor(e,t){super(),this._editorService=e,this._store.add(t.registerCodeEditorOpenHandler(this.openCodeEditorFromMergeEditor.bind(this)))}async openCodeEditorFromMergeEditor(e,t,i){let o=this._editorService.activeEditorPane;if(!i&&e.options&&o instanceof ab&&o.getControl()&&o.input instanceof Wt.di&&(0,Rt.oT)(e.resource,o.input.result)){let t=o.getControl();return(0,Zt.m)(e.options,t,Rt.fv.Smooth),t}return null}};lb=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.kt),(0,Rt.Fb)(1,Rt.Vb)],lb);var cb=(He=class extends Rt.CA{constructor(e,t){super(),this._register(e.registerEditor("*",{id:Pt.Ft.id,label:Pt.Ft.displayName,detail:Pt.Ft.providerDisplayName,priority:Lt.t.builtin},{},{createMergeEditorInput:e=>{var i,o,s,r;return{editor:t.createInstance(Wt.di,e.base.resource,{uri:e.input1.resource,title:null!==(i=e.input1.label)&&void 0!==i?i:(0,Rt.Xw)(e.input1.resource),description:null!==(o=e.input1.description)&&void 0!==o?o:"",detail:e.input1.detail},{uri:e.input2.resource,title:null!==(s=e.input2.label)&&void 0!==s?s:(0,Rt.Xw)(e.input2.resource),description:null!==(r=e.input2.description)&&void 0!==r?r:"",detail:e.input2.detail},e.result.resource)}}}))}},{_:He.ID="workbench.contrib.mergeEditorResolver"},He);cb=(0,Rt.Pb)([(0,Rt.Fb)(0,Lt.I),(0,Rt.Fb)(1,Rt.Ub)],cb),(0,Rt.gD)(),(0,Rt.iT)(),(0,Rt.TD)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.IO)(),(0,Rt.Ll)(),(0,Rt.br)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Wt.pi)(),(0,Wt.Ci)(),(0,Pt.At)(),(0,Rt.PS)(),(0,Wt.Di)(),(0,Rt.tO)(),(0,Rt.gb)(),(0,Rt.tC)();var hb,ub=class extends Rt.ob{constructor(e){super(e)}run(e){let{activeEditorPane:t}=e.get(Pt.kt);if(t instanceof ab){let i=t.viewModel.get();if(!i)return;this.runWithViewModel(i,e)}}},gb=class extends Rt.ob{constructor(e){super(e)}run(e){let{activeEditorPane:t}=e.get(Pt.kt);if(t instanceof ab){let r=t.viewModel.get();for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return r?this.runWithMergeEditor({viewModel:r,inputModel:t.inputModel.get(),input:t.input,editorIdentifier:{editor:t.input,groupId:t.group.id}},e,...o):void 0}}},pb=class extends Rt.ob{constructor(){super({id:"_open.mergeEditor",title:(0,Rt.Lj)(9068,"Open Merge Editor")})}run(e){let t=hb.validate(arguments.length<=1?void 0:arguments[1]),i={base:{resource:t.base},input1:{resource:t.input1.uri,label:t.input1.title,description:t.input1.description,detail:t.input1.detail},input2:{resource:t.input2.uri,label:t.input2.title,description:t.input2.description,detail:t.input2.detail},result:{resource:t.output},options:{preserveFocus:!0}};e.get(Pt.kt).openEditor(i)}};!function(e){function t(e){if("string"==typeof e)return new Wt.fi(Rt.wD.parse(e,!0),void 0,void 0,void 0);if(!e||"object"!=typeof e)throw TypeError("invalid argument");if(function(e){if(!e||"object"!=typeof e)return!1;let t=e;return"string"==typeof t.scheme&&"string"==typeof t.authority&&"string"==typeof t.path&&"string"==typeof t.query&&"string"==typeof t.fragment}(e))return new Wt.fi(Rt.wD.revive(e),void 0,void 0,void 0);let t=e,o=t.title,s=i(t.uri),r=t.detail,n=t.description;return new Wt.fi(s,o,r,n)}function i(e){if("string"==typeof e)return Rt.wD.parse(e,!0);if(e&&"object"==typeof e)return Rt.wD.revive(e);throw TypeError("invalid argument")}e.validate=function(e){if(!e||"object"!=typeof e)throw TypeError("invalid argument");let o=e,s=i(o.base),r=i(o.output);return{base:s,input1:t(o.input1),input2:t(o.input2),output:r}}}(hb||(hb={}));var bb=class extends Rt.ob{constructor(){super({id:"merge.mixedLayout",title:(0,Rt.Lj)(9069,"Mixed Layout"),toggled:Wt.vi.isEqualTo("mixed"),menu:[{id:Rt.sb.EditorTitle,when:Wt.hi,group:"1_merge",order:9}],precondition:Wt.hi})}run(e){let{activeEditorPane:t}=e.get(Pt.kt);t instanceof ab&&t.setLayoutKind("mixed")}},mb=class extends Rt.ob{constructor(){super({id:"merge.columnLayout",title:(0,Rt.Lj)(9070,"Column Layout"),toggled:Wt.vi.isEqualTo("columns"),menu:[{id:Rt.sb.EditorTitle,when:Wt.hi,group:"1_merge",order:10}],precondition:Wt.hi})}run(e){let{activeEditorPane:t}=e.get(Pt.kt);t instanceof ab&&t.setLayoutKind("columns")}},vb=class extends Rt.ob{constructor(){super({id:"merge.showNonConflictingChanges",title:(0,Rt.Lj)(9071,"Show Non-Conflicting Changes"),toggled:Wt.xi.isEqualTo(!0),menu:[{id:Rt.sb.EditorTitle,when:Wt.hi,group:"3_merge",order:9}],precondition:Wt.hi})}run(e){let{activeEditorPane:t}=e.get(Pt.kt);t instanceof ab&&t.toggleShowNonConflictingChanges()}},Cb=class extends Rt.ob{constructor(){super({id:"merge.showBase",title:(0,Rt.Lj)(9072,"Show Base"),toggled:Wt.yi.isEqualTo(!0),menu:[{id:Rt.sb.EditorTitle,when:Rt.PO.and(Wt.hi,Wt.vi.isEqualTo("columns")),group:"2_merge",order:9}]})}run(e){let{activeEditorPane:t}=e.get(Pt.kt);t instanceof ab&&t.toggleBase()}},wb=class extends Rt.ob{constructor(){super({id:"merge.showBaseTop",title:(0,Rt.Lj)(9073,"Show Base Top"),toggled:Rt.PO.and(Wt.yi,Wt.bi),menu:[{id:Rt.sb.EditorTitle,when:Rt.PO.and(Wt.hi,Wt.vi.isEqualTo("mixed")),group:"2_merge",order:10}]})}run(e){let{activeEditorPane:t}=e.get(Pt.kt);t instanceof ab&&t.toggleShowBaseTop()}},yb=class extends Rt.ob{constructor(){super({id:"merge.showBaseCenter",title:(0,Rt.Lj)(9074,"Show Base Center"),toggled:Rt.PO.and(Wt.yi,Wt.bi.negate()),menu:[{id:Rt.sb.EditorTitle,when:Rt.PO.and(Wt.hi,Wt.vi.isEqualTo("mixed")),group:"2_merge",order:11}]})}run(e){let{activeEditorPane:t}=e.get(Pt.kt);t instanceof ab&&t.toggleShowBaseCenter()}},fb=(0,Rt.Lj)(9075,"Merge Editor");async function Sb(e,t,i){t.openEditor(t.activeEditor,{pinned:!0});let o=e.model.base,s=1===i?e.inputCodeEditorView1.editor:e.inputCodeEditorView2.editor,r=s.getPosition().lineNumber;await t.openEditor({original:{resource:o.uri},modified:{resource:s.getModel().uri},options:{selection:{startLineNumber:r,startColumn:1},revealIfOpened:!0,revealIfVisible:!0}})}var Ib=class extends Rt.ob{constructor(){super({id:"mergeEditor.resetCloseWithConflictsChoice",category:fb,title:(0,Rt.Lj)(9089,"Reset Choice for 'Close with Conflicts'"),f1:!0})}run(e){e.get(Rt.Uo).remove(Wt.mi,Rt.Go.PROFILE)}};(0,Rt.XC)(),(0,Rt.gD)(),(0,Rt.TD)(),(0,Rt.lv)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.w)(),(0,Rt.Ll)(),(0,Rt.bs)(),(0,Rt.Rd)(),(0,Rt.Sc)(),(0,Wt.Ci)(),(0,Pt.At)();var kb=(0,Rt.Lj)(9096,"Merge Editor (Dev)"),_b=class extends Rt.ob{constructor(){super({id:"merge.dev.copyContentsJson",category:kb,title:(0,Rt.Lj)(9097,"Copy Merge Editor State as JSON"),icon:Rt.mD.layoutCentered,f1:!0,precondition:Wt.hi})}run(e){let{activeEditorPane:t}=e.get(Pt.kt),i=e.get(Rt.C),o=e.get(Rt.Ld);if(!(t instanceof ab))return void o.info({name:(0,Rt.Ij)(9098,"Merge Editor"),message:(0,Rt.Ij)(9099,"No active merge editor")});let s=t.model;if(!s)return;let r={languageId:s.resultTextModel.getLanguageId(),base:s.base.getValue(),input1:s.input1.textModel.getValue(),input2:s.input2.textModel.getValue(),result:s.resultTextModel.getValue(),initialResult:s.getInitialResultValue()},n=JSON.stringify(r,void 0,4);i.writeText(n),o.info({name:(0,Rt.Ij)(9098,"Merge Editor"),message:(0,Rt.Ij)(9100,"Successfully copied merge editor state")})}},Eb=class extends Rt.ob{constructor(){super({id:"merge.dev.saveContentsToFolder",category:kb,title:(0,Rt.Lj)(9101,"Save Merge Editor State to Folder"),icon:Rt.mD.layoutCentered,f1:!0,precondition:Wt.hi})}async run(e){let{activeEditorPane:t}=e.get(Pt.kt),i=e.get(Rt.Ld),o=e.get(Rt.Il),s=e.get(Rt.ys),r=e.get(Rt.cv);if(!(t instanceof ab))return void i.info({name:(0,Rt.Ij)(9098,"Merge Editor"),message:(0,Rt.Ij)(9099,"No active merge editor")});let n=t.model;if(!n)return;let a=await o.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:(0,Rt.Ij)(9102,"Select folder to save to")});if(!a)return;let d=a[0],l=r.getExtensions(n.resultTextModel.getLanguageId())[0]||"";async function c(e,t){await s.writeFile(Rt.wD.joinPath(d,e+l),Rt.HC.fromString(t),{})}await Promise.all([c("base",n.base.getValue()),c("input1",n.input1.textModel.getValue()),c("input2",n.input2.textModel.getValue()),c("result",n.resultTextModel.getValue()),c("initialResult",n.getInitialResultValue())]),i.info({name:(0,Rt.Ij)(9098,"Merge Editor"),message:(0,Rt.Ij)(9103,"Successfully saved merge editor state to folder")})}},Ab=class extends Rt.ob{constructor(){super({id:"merge.dev.loadContentsFromFolder",category:kb,title:(0,Rt.Lj)(9104,"Load Merge Editor State from Folder"),icon:Rt.mD.layoutCentered,f1:!0})}async run(e,t){let i,o=e.get(Rt.Il),s=e.get(Pt.kt),r=e.get(Rt.ys),n=e.get(Rt.xc);if(t||(t={}),t.folderUri)i=t.folderUri;else{let e=await o.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:(0,Rt.Ij)(9102,"Select folder to save to")});if(!e)return;i=e[0]}let a=await r.resolve(i);function d(e){var t;return null===(t=a.children.find(t=>t.name.startsWith(e)))||void 0===t?void 0:t.resource}let l=await async function(e,t){var i;return t?"initial"===t:null===(i=await e.pick([{label:"result",result:!1},{label:"initial result",result:!0}],{canPickMany:!1}))||void 0===i?void 0:i.result}(n,t.resultState),c={base:{resource:d("base")},input1:{resource:d("input1"),label:"Input 1",description:"Input 1",detail:"(from file)"},input2:{resource:d("input2"),label:"Input 2",description:"Input 2",detail:"(from file)"},result:{resource:d(l?"initialResult":"result")}};s.openEditor(c)}};(0,Rt.xN)(),(0,Rt.mc)(),(0,Wt.pi)();(0,Rt.Hb)(),(0,Rt.Fj)(),(0,Wt.Ig)(),(0,Rt.IO)(),(0,Wt.Mg)();(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.I_)(),(0,Rt.sm)(),(0,Rt.vb)(),(0,Tt.f)(),(0,Pt.b)(),(0,Pt.en)(),(0,Wt.pi)(),(0,Pt.L)(),(0,Tt.vn)(),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(ab,ab.ID,(0,Rt.Ij)(9105,"Merge Editor")),[new Rt.om(Wt.di)]),Rt._b.as(Pt.Rt.EditorFactory).registerEditorSerializer(Wt.di.ID,class{canSerialize(){return!0}serialize(e){return JSON.stringify(this.toJSON(e))}toJSON(e){return{base:e.base,input1:e.input1,input2:e.input2,result:e.result}}deserialize(e,t){try{let i=(0,Rt.hc)(t);return e.createInstance(Wt.di,i.base,new Wt.fi(i.input1.uri,i.input1.title,i.input1.detail,i.input1.description),new Wt.fi(i.input2.uri,i.input2.title,i.input2.detail,i.input2.description),i.result)}catch(e){return void(0,Rt.CN)(e)}}}),Rt._b.as(Rt.E_.Configuration).registerConfiguration({properties:{"mergeEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:"advanced",markdownEnumDescriptions:[(0,Rt.Ij)(9106,"Uses the legacy diffing algorithm."),(0,Rt.Ij)(9107,"Uses the advanced diffing algorithm.")]},"mergeEditor.showDeletionMarkers":{type:"boolean",default:!0,description:"Controls if deletions in base or one of the inputs should be indicated by a vertical bar."}}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.openResult",icon:Rt.mD.goToFile,title:(0,Rt.Lj)(9076,"Open File"),category:fb,menu:[{id:Rt.sb.EditorTitle,when:Wt.hi,group:"navigation",order:1}],precondition:Wt.hi})}runWithViewModel(e,t){t.get(Pt.kt).openEditor({resource:e.model.resultTextModel.uri})}}),(0,Rt.pb)(bb),(0,Rt.pb)(mb),(0,Rt.pb)(pb),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.openBaseEditor",category:fb,title:(0,Rt.Lj)(9084,"Open Base File"),f1:!0,precondition:Wt.hi})}runWithViewModel(e,t){t.get(Rt.yr).open(e.model.base.uri)}}),(0,Rt.pb)(vb),(0,Rt.pb)(Cb),(0,Rt.pb)(wb),(0,Rt.pb)(yb),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.goToNextUnhandledConflict",category:fb,title:(0,Rt.Lj)(9077,"Go to Next Unhandled Conflict"),icon:Rt.mD.arrowDown,menu:[{id:Rt.sb.EditorTitle,when:Wt.hi,group:"navigation",order:3}],f1:!0,precondition:Wt.hi})}runWithViewModel(e){e.model.telemetry.reportNavigationToNextConflict(),e.goToNextModifiedBaseRange(t=>!e.model.isHandled(t).get())}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.goToPreviousUnhandledConflict",category:fb,title:(0,Rt.Lj)(9078,"Go to Previous Unhandled Conflict"),icon:Rt.mD.arrowUp,menu:[{id:Rt.sb.EditorTitle,when:Wt.hi,group:"navigation",order:2}],f1:!0,precondition:Wt.hi})}runWithViewModel(e){e.model.telemetry.reportNavigationToPreviousConflict(),e.goToPreviousModifiedBaseRange(t=>!e.model.isHandled(t).get())}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.toggleActiveConflictInput1",category:fb,title:(0,Rt.Lj)(9079,"Toggle Current Conflict from Left"),f1:!0,precondition:Wt.hi})}runWithViewModel(e){e.toggleActiveConflict(1)}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.toggleActiveConflictInput2",category:fb,title:(0,Rt.Lj)(9080,"Toggle Current Conflict from Right"),f1:!0,precondition:Wt.hi})}runWithViewModel(e){e.toggleActiveConflict(2)}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"mergeEditor.compareInput1WithBase",category:fb,title:(0,Rt.Lj)(9081,"Compare Input 1 With Base"),shortTitle:(0,Rt.Ij)(9082,"Compare With Base"),f1:!0,precondition:Wt.hi,menu:{id:Rt.sb.MergeInput1Toolbar,group:"primary"},icon:Rt.mD.compareChanges})}runWithViewModel(e,t){Sb(e,t.get(Pt.kt),1)}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"mergeEditor.compareInput2WithBase",category:fb,title:(0,Rt.Lj)(9083,"Compare Input 2 With Base"),shortTitle:(0,Rt.Ij)(9082,"Compare With Base"),f1:!0,precondition:Wt.hi,menu:{id:Rt.sb.MergeInput2Toolbar,group:"primary"},icon:Rt.mD.compareChanges})}runWithViewModel(e,t){Sb(e,t.get(Pt.kt),2)}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.acceptAllInput1",category:fb,title:(0,Rt.Lj)(9085,"Accept All Incoming Changes from Left"),f1:!0,precondition:Wt.hi,menu:{id:Rt.sb.MergeInput1Toolbar,group:"primary"},icon:Rt.mD.checkAll})}runWithViewModel(e){e.acceptAll(1)}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"merge.acceptAllInput2",category:fb,title:(0,Rt.Lj)(9086,"Accept All Current Changes from Right"),f1:!0,precondition:Wt.hi,menu:{id:Rt.sb.MergeInput2Toolbar,group:"primary"},icon:Rt.mD.checkAll})}runWithViewModel(e){e.acceptAll(2)}}),(0,Rt.pb)(class extends ub{constructor(){super({id:"mergeEditor.resetResultToBaseAndAutoMerge",category:fb,title:(0,Rt.Lj)(9087,"Reset Result"),shortTitle:(0,Rt.Ij)(9088,"Reset"),f1:!0,precondition:Wt.hi,menu:{id:Rt.sb.MergeInputResultToolbar,group:"primary"},icon:Rt.mD.discard})}runWithViewModel(e,t){e.model.reset()}}),(0,Rt.pb)(class extends gb{constructor(){super({id:"mergeEditor.acceptMerge",category:fb,title:(0,Rt.Lj)(9091,"Complete Merge"),f1:!0,precondition:Wt.hi,keybinding:[{primary:Rt.ZD.CtrlCmd|Rt.YD.Enter,weight:Rt.mb.EditorContrib,when:Wt.hi}]})}async runWithMergeEditor(e,t){let{inputModel:i,editorIdentifier:o,viewModel:s}=e,r=t.get(Rt.Fl),n=t.get(Pt.kt);if(s.model.unhandledConflictsCount.get()>0){let{confirmed:e}=await r.confirm({message:(0,Rt.Ij)(9092,"Do you want to complete the merge of {0}?",(0,Rt.Xw)(i.resultUri)),detail:(0,Rt.Ij)(9093,"The file contains unhandled conflicts."),primaryButton:(0,Rt.Ij)(9094,"&&Complete with Conflicts")});if(!e)return{successful:!1}}return await i.accept(),await n.closeEditor(o),{successful:!0}}}),(0,Rt.pb)(Ib),(0,Rt.pb)(class extends gb{constructor(){super({id:"mergeEditor.acceptAllCombination",category:fb,title:(0,Rt.Lj)(9090,"Accept All Combination"),f1:!0})}runWithMergeEditor(e,t){let{viewModel:i}=e,o=i.model.modifiedBaseRanges.get(),s=i.model;return(0,Rt.rC)(e=>{for(let t of o){let o=s.getState(t).get();o.kind!==Wt.Ei.unrecognized&&!o.isInputIncluded(1)&&(!o.isInputIncluded(2)||!i.shouldUseAppendInsteadOfAccept.get())&&t.canBeCombined&&(s.setState(t,o.withInputValue(1,!0).withInputValue(2,!0,!0),!0,e),s.telemetry.reportSmartCombinationInvoked(o.includesInput(2)))}}),{success:!0}}}),(0,Rt.pb)(class extends gb{constructor(){super({id:"mergeEditor.toggleBetweenInputs",category:fb,title:(0,Rt.Lj)(9095,"Toggle Between Merge Editor Inputs"),f1:!0,precondition:Wt.hi,keybinding:[{primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.KeyT,weight:Rt.mb.WorkbenchContrib+10,when:Wt.hi}]})}runWithMergeEditor(e,t){let{viewModel:i}=e;i.inputCodeEditorView1.editor.hasWidgetFocus()?i.inputCodeEditorView2.editor.focus():i.inputCodeEditorView1.editor.focus()}}),(0,Rt.pb)(_b),(0,Rt.pb)(Eb),(0,Rt.pb)(Ab),Rt._b.as(Pt.v.Workbench).registerWorkbenchContribution(lb,Pt.M.Restored),(0,Pt.x)(cb.ID,cb,Pt.y.BlockStartup),Tt._n.register(new class{constructor(){this.name="mergeEditor",this.type=Wt.Fg.Help,this.priority=125,this.when=Rt.NO.create("isMergeEditor",!0)}getProvider(e){let t=e.get(Rt.Vb),i=t.getActiveCodeEditor()||t.getFocusedCodeEditor();if(!i)return;let o=[(0,Rt.Ij)(9108,"You are in a merge editor."),(0,Rt.Ij)(9109,"Navigate between merge conflicts using the commands Go to Next Unhandled Conflict{0} and Go to Previous Unhandled Conflict{1}.","<keybinding:merge.goToNextUnhandledConflict>","<keybinding:merge.goToPreviousUnhandledConflict>"),(0,Rt.Ij)(9110,"Run the command Merge Editor: Accept All Incoming Changes from the Left{0} and Merge Editor: Accept All Current Changes from the Right{1}","<keybinding:merge.acceptAllInput1>","<keybinding:merge.acceptAllInput2>"),(0,Rt.Ij)(9111,"Complete the Merge{0}.","<keybinding:mergeEditor.acceptMerge>"),(0,Rt.Ij)(9112,"Toggle between merge editor inputs, incoming and current changes {0}.","<keybinding:mergeEditor.toggleBetweenInputs>")];return new Wt.Ng(Wt.Pg.MergeEditor,{type:Wt.Fg.Help},()=>o.join("\n"),()=>i.focus(),Wt.kg.MergeEditor)}}),(0,Rt.qx)(),(0,Rt.Wy)(),(0,Tt.ln)(),(0,Rt.Fj)(),(0,Rt.db)(),(0,Rt.IO)(),(0,Wt.ey)(),(0,Wt.$i)(),(0,Pt.At)();function Db(e,t){null===e||void 0===e||e.addImplementation(100,"webview",e=>{var i;let o=e.get(Wt.$v).activeWebview;if(null!==o&&void 0!==o&&o.isFocused)return t(o),!0;if(null!==(i=(0,Rt.Tx)())&&void 0!==i&&i.classList.contains("action-menu-item")){let i=e.get(Pt.kt);if(i.activeEditor instanceof Wt.Qi)return t(i.activeEditor.webview),!0}return!1})}Db(Rt.Uy,e=>e.undo()),Db(Rt.Vy,e=>e.redo()),Db(Rt.Hy,e=>e.selectAll()),Db(Tt.on,e=>e.copy()),Db(Tt.cn,e=>e.paste()),Db(Tt.sn,e=>e.cut());var xb="preventDefaultContextMenuItems";Tt.sn&&Rt.lb.appendMenuItem(Rt.sb.WebviewContext,{command:{id:Tt.sn.id,title:(0,Rt.Ij)(13154,"Cut")},group:"5_cutcopypaste",order:1,when:Rt.PO.not(xb)}),Tt.on&&Rt.lb.appendMenuItem(Rt.sb.WebviewContext,{command:{id:Tt.on.id,title:(0,Rt.Ij)(13155,"Copy")},group:"5_cutcopypaste",order:2,when:Rt.PO.not(xb)}),Tt.cn&&Rt.lb.appendMenuItem(Rt.sb.WebviewContext,{command:{id:Tt.cn.id,title:(0,Rt.Ij)(13156,"Paste")},group:"5_cutcopypaste",order:3,when:Rt.PO.not(xb)}),(0,Rt.Ib)(),(0,Rt.PA)(),(0,Rt.qd)(),(0,Gt.o)(),(0,Pt.At)(),(0,Jt.n)(),(0,Rt.vb)(),(0,Pt.b)(),(0,Pt.L)(),(0,Rt.Fj)(),(0,Wt.lC)(),(0,Wt.dp)();var Vb=(0,Rt.Ij)(8516,"Configure"),Rb=class extends Rt.CA{constructor(e,t){super();let i=[new Tb,new Lb].map(e=>new Wb(t,e));i.forEach(e=>this._register(e));let o,s=()=>{let t=e.activeTextEditorControl;if(t===o)return;o=t;let s=(0,Gt.i)(t);i.forEach(e=>e.onActiveEditorChanged(s))};this._register(e.onDidActiveEditorChange(s)),s()}};Rb=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.kt),(0,Rt.Fb)(1,Jt.t)],Rb);var Tb=class{constructor(){this.id="decoratorsLimitInfo",this.name=(0,Rt.Ij)(8517,"Color Decorator Status"),this.label=(0,Rt.Ij)(8518,"Color decorators"),this.source=(0,Rt.Ij)(8519,"Color Decorators"),this.settingsId="editor.colorDecoratorsLimit"}getLimitReporter(e){var t;return null===(t=Wt.up.get(e))||void 0===t?void 0:t.limitReporter}},Lb=class{constructor(){this.id="foldingLimitInfo",this.name=(0,Rt.Ij)(8520,"Folding Status"),this.label=(0,Rt.Ij)(8521,"Folding ranges"),this.source=(0,Rt.Ij)(8522,"Folding"),this.settingsId="editor.foldingMaximumRegions"}getLimitReporter(e){var t;return null===(t=Wt.cC.get(e))||void 0===t?void 0:t.limitReporter}},Wb=class{constructor(e,t){this.languageStatusService=e,this.accessor=t}onActiveEditorChanged(e){let t;return this._indicatorChangeListener&&(this._indicatorChangeListener=void this._indicatorChangeListener.dispose()),e&&(t=this.accessor.getLimitReporter(e)),this.updateStatusItem(t),!!t&&(this._indicatorChangeListener=t.onDidChange(e=>{this.updateStatusItem(t)}),!0)}updateStatusItem(e){if(this._limitStatusItem&&(this._limitStatusItem=void this._limitStatusItem.dispose()),e&&!1!==e.limited){let t={id:this.accessor.id,selector:"*",name:this.accessor.name,severity:Rt.Kd.Warning,label:this.accessor.label,detail:(0,Rt.Ij)(8523,"only {0} shown for performance reasons",e.limited),command:{id:"workbench.action.openSettings",arguments:[this.accessor.settingsId],title:Vb},accessibilityInfo:void 0,source:this.accessor.source,busy:!1};this._limitStatusItem=this.languageStatusService.addStatus(t)}}dispose(){var e,t;null!==(e=this._limitStatusItem)&&void 0!==e&&e.dispose(),this._limitStatusItem=void 0,null!==(t=this._indicatorChangeListener)&&void 0!==t&&t.dispose(),this._indicatorChangeListener=void 0}};Rt._b.as(Pt.v.Workbench).registerWorkbenchContribution(Rb,Pt.M.Restored),(0,Rt.Ib)(),(0,Rt.IC)(),(0,Rt.en)(),(0,Rt.gA)(),(0,Rt.PA)(),(0,Rt.s_)(),(0,Rt.qg)();var Fb=(Xe=class extends Rt.CA{constructor(e){super(),this.configurationService=e,this.styleSheet=(0,Rt.Gg)(),Rt.dA.filter(e.onDidChangeConfiguration,e=>e.affectsConfiguration("workbench.sash.size"))(this.onDidChangeSize,this,this._store),this.onDidChangeSize(),Rt.dA.filter(e.onDidChangeConfiguration,e=>e.affectsConfiguration("workbench.sash.hoverDelay"))(this.onDidChangeHoverDelay,this,this._store),this.onDidChangeHoverDelay()}onDidChangeSize(){let e=this.configurationService.getValue("workbench.sash.size"),t=(0,Rt.FC)(e,4,20),i=(0,Rt.FC)(e,1,8);this.styleSheet.textContent="\n\t\t\t.monaco-workbench {\n\t\t\t\t--vscode-sash-size: ".concat(t,"px;\n\t\t\t\t--vscode-sash-hover-size: ").concat(i,"px;\n\t\t\t}\n\t\t"),(0,Rt.nn)(t)}onDidChangeHoverDelay(){(0,Rt.tn)(this.configurationService.getValue("workbench.sash.hoverDelay"))}},{_:Xe.ID="workbench.contrib.sash"},Xe);Fb=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.o_)],Fb),(0,Rt.mj)(),(0,Rt.Fj)(),(0,Rt.I_)(),(0,Rt.vb)(),(0,Lt.O)(),(0,Pt.b)(),(0,Pt.x)(Fb.ID,Fb,Pt.y.AfterRestored),Rt._b.as(Rt.E_.Configuration).registerConfiguration((0,xt.A)((0,xt.A)({},Lt.j),{},{properties:{"workbench.sash.size":{type:"number",default:Rt.bj?20:4,minimum:1,maximum:20,description:(0,Rt.Ij)(10434,"Controls the feedback area size in pixels of the dragging area in between views/editors. Set it to a larger value if you feel it's hard to resize views using the mouse.")},"workbench.sash.hoverDelay":{type:"number",default:300,minimum:0,maximum:2e3,description:(0,Rt.Ij)(10435,"Controls the hover feedback delay in milliseconds of the dragging area in between views/editors.")}}})),(0,Rt.Iw)(),(0,Rt.zk)(),(0,Rt.Fj)(),(0,Rt.IO)(),new Rt.FO("inPreferencesSearch",!1),new Rt.FO("inSettingsEditor",!1),new Rt.FO("inSettingsJSONEditor",!1),new Rt.FO("inSettingsSearch",!1),new Rt.FO("settingsTocRowFocus",!1),new Rt.FO("settingRowFocus",!1),new Rt.FO("inKeybindings",!1),new Rt.FO("inKeybindingsSearch",!1),new Rt.FO("keybindingsSearchHasValue",!1),new Rt.FO("keybindingFocus",!1),new Rt.FO("whenFocus",!1),new Rt.FO("aiSettingResultsAvailable",!1);var Gb,Zb="workbench.action.openKeyboardLayoutPicker";(function(e){e.ShowAISearchToggle="workbench.settings.showAISearchToggle",e.EnableNaturalLanguageSearch="workbench.settings.enableNaturalLanguageSearch"})(Gb||(Gb={})),(0,Rt.Ij)(10145,"Preview setting: this setting controls a new feature that is still under refinement yet ready to use. Feedback is welcome."),(0,Rt.Ij)(10146,"Experimental setting: this setting controls a new feature that is actively being developed and may be unstable. It is subject to change or removal."),(0,Rt.Ij)(10147,"Advanced setting: this setting is intended for advanced scenarios and configurations. Only modify this if you know what it does.");var Nb=new Set;["css","html","scss","less","json","js","ts","ie","id","php","scm"].forEach(e=>Nb.add(e));var Pb=new Map;Pb.set("power shell","PowerShell"),Pb.set("powershell","PowerShell"),Pb.set("javascript","JavaScript"),Pb.set("typescript","TypeScript"),Pb.set("github","GitHub"),Pb.set("jet brains","JetBrains"),Pb.set("jetbrains","JetBrains"),Pb.set("re sharper","ReSharper"),Pb.set("resharper","ReSharper"),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Wt.Sx)(),(0,Wt.vx)(),(0,Rt.PA)(),(0,Tt.Zn)(),(0,Pt.b)(),(0,Rt.mj)(),(0,Rt.Sc)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.Ml)(),(0,Rt.bs)(),(0,Pt.At)(),(0,Rt.XC)();var Jb=(Ue=class extends Rt.CA{constructor(e,t){super(),this.keyboardLayoutService=e,this.statusbarService=t,this.pickerElement=this._register(new Rt.OA);let i=(0,Rt.Ij)(9874,"Keyboard Layout"),o=this.keyboardLayoutService.getCurrentKeyboardLayout();if(o){let e=(0,Rt.Ij)(9875,"Layout: {0}",_a(o).label);this.pickerElement.value=this.statusbarService.addEntry({name:i,text:e,ariaLabel:e,command:Zb},"status.workbench.keyboardLayout",Wt.bx.RIGHT)}this._register(this.keyboardLayoutService.onDidChangeKeyboardLayout(()=>{let e=_a(this.keyboardLayoutService.getCurrentKeyboardLayout());if(this.pickerElement.value){let t=(0,Rt.Ij)(9875,"Layout: {0}",e.label);this.pickerElement.value.update({name:i,text:t,ariaLabel:t,command:Zb})}else{let t=(0,Rt.Ij)(9875,"Layout: {0}",e.label);this.pickerElement.value=this.statusbarService.addEntry({name:i,text:t,ariaLabel:t,command:Zb},"status.workbench.keyboardLayout",Wt.bx.RIGHT)}}))}},{_:Ue.ID="workbench.contrib.keyboardLayoutPicker"},Ue);Jb=(0,Rt.Pb)([(0,Rt.Fb)(0,Tt.Xn),(0,Rt.Fb)(1,Wt._x)],Jb),(0,Pt.x)(Jb.ID,Jb,Pt.y.BlockStartup);var Bb=["// ".concat((0,Rt.Ij)(9876,"Defines the keyboard layout used in VS Code in the browser environment.")),"// ".concat((0,Rt.Ij)(9877,'Open VS Code and run "Developer: Inspect Key Mappings (JSON)" from Command Palette.')),"","// Once you have the keyboard layout info, please paste it below.","\n"].join("\n");(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:Zb,title:(0,Rt.Lj)(9878,"Change Keyboard Layout"),f1:!0})}async run(e){let t=e.get(Tt.Xn),i=e.get(Rt.xc),o=e.get(Rt.o_),s=e.get(Rt.jl),r=e.get(Pt.kt),n=e.get(Rt.ys),a=t.getAllKeyboardLayouts(),d=t.getCurrentKeyboardLayout(),l="autodetect"===o.getValue("keyboard.layout"),c=a.map(e=>{let t=!l&&ka(d,e),i=_a(e);return{layout:e,label:[i.label,e&&e.isUserKeyboardLayout?"(User configured layout)":""].join(" "),id:e.text||e.lang||e.layout,description:i.description+(t?" (Current layout)":""),picked:!l&&ka(d,e)}}).sort((e,t)=>e.label<t.label?-1:e.label>t.label?1:0);if(c.length>0){let e=Rt.Cj?"Mac":Rt.kj?"Win":"Linux";c.unshift({type:"separator",label:(0,Rt.Ij)(9879,"Keyboard Layouts ({0})",e)})}let h={label:(0,Rt.Ij)(9880,"Configure Keyboard Layout")};c.unshift(h);let u={label:(0,Rt.Ij)(9881,"Auto Detect"),description:l?"Current: ".concat(_a(d).label):void 0,picked:!!l||void 0};c.unshift(u);let g=await i.pick(c,{placeHolder:(0,Rt.Ij)(9882,"Select Keyboard Layout"),matchOnDescription:!0});if(g){if(g===u)return void o.updateValue("keyboard.layout","autodetect");if(g===h){let e=s.keyboardLayoutResource;return await n.stat(e).then(void 0,()=>n.createFile(e,Rt.HC.fromString(Bb))).then(e=>{if(e)return r.openEditor({resource:e.resource,languageId:"jsonc",options:{pinned:!0}})},t=>{throw Error((0,Rt.Ij)(9883,"Unable to create '{0}' ({1}).",e.toString(),t))}),Promise.resolve()}o.updateValue("keyboard.layout",Ea(g.layout))}}}),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.PA)(),(0,Tt.dt)(),(0,Tt.zn)(),(0,Pt.C)(),(0,Pt.l)(),(0,Pt.V)();var Ob=(ze=class extends Rt.CA{constructor(e,t,i){super(),this.activityService=e,this.workingCopyService=t,this.filesConfigurationService=i,this.badgeHandle=this._register(new Rt.OA),this.lastKnownDirtyCount=0,this.updateActivityBadge(),this.registerListeners()}registerListeners(){this._register(this.workingCopyService.onDidChangeDirty(e=>this.onWorkingCopyDidChangeDirty(e)))}onWorkingCopyDidChangeDirty(e){let t=e.isDirty();t&&!(e.capabilities&Pt.c.Untitled)&&this.filesConfigurationService.hasShortAutoSaveDelay(e.resource)||(t||this.lastKnownDirtyCount>0)&&this.updateActivityBadge()}updateActivityBadge(){let e=this.lastKnownDirtyCount=this.workingCopyService.dirtyCount;e>0?this.badgeHandle.value=this.activityService.showViewContainerActivity(Xt.c,{badge:new Tt.lt(e,t=>1===t?(0,Rt.Ij)(8257,"1 unsaved file"):(0,Rt.Ij)(8258,"{0} unsaved files",e))}):this.badgeHandle.clear()}},{_:ze.ID="workbench.contrib.dirtyFilesIndicator"},ze);Ob=(0,Rt.Pb)([(0,Rt.Fb)(0,Tt.Rn),(0,Rt.Fb)(1,Pt.S),(0,Rt.Fb)(2,Pt.B)],Ob),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.ab)(),(0,Rt.$d)(),(0,Rt.Wo)(),(0,Rt.$p)(),(0,Lt.a)(),(0,Lt.L)(),(0,Pt.en)(),(0,Pt.it)();var Kb,Mb=(qe=class extends yg{constructor(e,t,i,o,s){super(Kb.ID,e,{openInternal:(e,t)=>this.openInternal(e,t)},t,i,s),this.editorResolverService=o}async openInternal(e,t){if(e instanceof zt.n&&this.group.activeEditor){var i,o,s,r;let n=this.group.activeEditor,a=null===n||void 0===n?void 0:n.toUntyped();if(!a)return;let d=await this.editorResolverService.resolveEditor((0,xt.A)((0,xt.A)({},a),{},{options:(0,xt.A)((0,xt.A)({},t),{},{override:Rt.Xp.PICK})}),this.group);if(d===Lt.n.NONE)d=void 0;else if(d===Lt.n.ABORT)return;if((0,Pt.in)(d))for(let e of d.editor instanceof Pt.nt?[d.editor.original,d.editor.modified]:[d.editor])e instanceof zt.n&&(e.setForceOpenAsText(),e.setPreferredLanguageId(Xt.n));await this.group.replaceEditors([{editor:n,replacement:null!==(i=null===(o=d)||void 0===o?void 0:o.editor)&&void 0!==i?i:e,options:(0,xt.A)({},null!==(s=null===(r=d)||void 0===r?void 0:r.options)&&void 0!==s?s:t)}])}}getTitle(){return this.input?this.input.getName():(0,Rt.Ij)(7891,"Binary File Viewer")}},{_:Kb=qe},{_:qe.ID=Xt.t},qe);Mb=Kb=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.Qd),(0,Rt.Fb)(3,Lt.I),(0,Rt.Fb)(4,Rt.Uo)],Mb),(0,Rt.Ib)(),(0,Rt.PA)(),(0,Rt.TD)(),(0,Zt.d)(),(0,Rt.iT)(),(0,Pt.l)(),(0,Wt.w_)(),(0,Rt.bs)();var jb=($e=class extends Rt.CA{constructor(e,t,i){super(),this.textEditorService=t,this.fileService=i,this._register(e.registerHandler(this))}handles(e){return""===e.typeId&&this.fileService.canHandleResource(e.resource)}handlesSync(e){return""===e.typeId&&this.fileService.hasProvider(e.resource)}isOpen(e,t){return!!this.handlesSync(e)&&(0,Rt.oT)(e.resource,t.resource)}createEditor(e){return this.textEditorService.createTextEditor({resource:e.resource,forceFile:!0})}},{_:$e.ID="workbench.contrib.fileEditorWorkingCopyEditorHandler"},$e);jb=(0,Rt.Pb)([(0,Rt.Fb)(0,Wt.C_),(0,Rt.Fb)(1,Zt.u),(0,Rt.Fb)(2,Rt.ys)],jb),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.yc)(),(0,Rt.nM)(),(0,Pt.j)(),(0,Rt.Mb)(),(0,Pt.h)(),(0,Pt.D)(),(0,Pt.en)(),(0,Zt.h)(),(0,Rt.ac)(),(0,Rt.bs)(),(0,Rt.ab)(),(0,Rt.za)(),(0,Rt.Wo)(),(0,Rt._v)(),(0,Rt.Kb)(),(0,Rt.$d)(),(0,Rt.pv)(),(0,Pt.At)(),(0,Pt.G)(),(0,Rt.$p)(),(0,Rt.Qo)(),(0,Tt.Un)(),(0,Nt.wt)(),(0,Wt.Df)(),(0,Rt.s_)(),(0,jt.i)(),(0,Lt.F)(),(0,Pt.V)();var Qb,Yb=(et=class extends mg{constructor(e,t,i,o,s,r,n,a,d,l,c,h,u,g,p,b,m,v,C){super(Qb.ID,e,t,s,n,a,l,d,c,i),this.paneCompositeService=o,this.contextService=r,this.textFileService=h,this.explorerService=u,this.uriIdentityService=g,this.pathService=p,this.configurationService=b,this.preferencesService=m,this.hostService=v,this.filesConfigurationService=C,this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidRunOperation(e)))}onDidFilesChange(e){for(let t of e.rawDeleted)this.clearEditorViewState(t)}onDidRunOperation(e){e.operation===Rt.Ns.MOVE&&e.target&&this.moveEditorViewState(e.resource,e.target.resource,this.uriIdentityService.extUri)}getTitle(){return this.input?this.input.getName():(0,Rt.Ij)(7892,"Text File Editor")}get input(){return this._input}async setInput(e,t,i,o){(0,Rt.bc)("code/willSetInputToTextFileEditor"),await super.setInput(e,t,i,o);try{let s=await e.resolve(t);if(o.isCancellationRequested)return;if(s instanceof zt.r)return this.openAsBinary(e,t);let r=s,n=(0,Rt.$j)(this.editorControl);if(n.setModel(r.textEditorModel),!(0,Pt.hn)(null===t||void 0===t?void 0:t.viewState)){let o=this.loadEditorViewState(e,i);o&&(null!==t&&void 0!==t&&t.selection&&(o.cursorState=[]),n.restoreViewState(o))}t&&(0,Zt.m)(t,n,Rt.fv.Immediate),n.updateOptions(this.getReadonlyConfiguration(r.isReadonly())),n.handleInitialized&&n.handleInitialized()}catch(i){await this.handleSetInputError(i,e,t)}(0,Rt.bc)("code/didSetInputToTextFileEditor")}async handleSetInputError(e,t,i){if(e.textFileOperationResult===Pt.p.FILE_IS_BINARY)return this.openAsBinary(t,i);if(e.fileOperationResult===Rt.Is.FILE_IS_DIRECTORY){let e=[];throw e.push((0,Rt.Nb)({id:"workbench.files.action.openFolder",label:(0,Rt.Ij)(7893,"Open Folder"),run:async()=>this.hostService.openWindow([{folderUri:t.resource}],{forceNewWindow:!0})})),this.contextService.isInsideWorkspace(t.preferredResource)&&e.push((0,Rt.Nb)({id:"workbench.files.action.reveal",label:(0,Rt.Ij)(7894,"Reveal Folder"),run:async()=>(await this.paneCompositeService.openPaneComposite(Xt.c,Wt.Sf.Sidebar,!0),this.explorerService.select(t.preferredResource,!0))})),(0,Pt.Zt)((0,Rt.Ij)(7895,"The file is not displayed in the text editor because it is a directory."),e,{forceMessage:!0})}if(e.fileOperationResult===Rt.Is.FILE_TOO_LARGE){let o;throw o=e instanceof Rt.Ws?(0,Rt.Ij)(7896,"The file is not displayed in the text editor because it is very large ({0}).",Rt.Ss.formatSize(e.size)):(0,Rt.Ij)(7897,"The file is not displayed in the text editor because it is very large."),(0,Pt.Qt)(this.group,t,i,o,this.preferencesService)}throw e.fileOperationResult===Rt.Is.FILE_NOT_FOUND&&!this.filesConfigurationService.isReadonly(t.preferredResource)&&await this.pathService.hasValidBasename(t.preferredResource)?(0,Pt.Zt)(new Rt.Ps((0,Rt.Ij)(7898,"The editor could not be opened because the file was not found."),Rt.Is.FILE_NOT_FOUND),[(0,Rt.Nb)({id:"workbench.files.action.createMissingFile",label:(0,Rt.Ij)(7899,"Create File"),run:async()=>(await this.textFileService.create([{resource:t.preferredResource}]),this.editorService.openEditor({resource:t.preferredResource,options:{pinned:!0}}))})],{allowDialog:!0}):e}openAsBinary(e,t){let i=this.configurationService.getValue("workbench.editor.defaultBinaryEditor"),o=(0,xt.A)((0,xt.A)({},t),{},{activation:Rt.Jp.PRESERVE});i&&""!==i&&i!==Pt.Ft.id?this.doOpenAsBinaryInDifferentEditor(this.group,i,e,o):this.doOpenAsBinaryInSameEditor(this.group,i,e,o)}doOpenAsBinaryInDifferentEditor(e,t,i,o){this.editorService.replaceEditors([{editor:i,replacement:{resource:i.resource,options:(0,xt.A)((0,xt.A)({},o),{},{override:t})}}],e)}doOpenAsBinaryInSameEditor(e,t,i,o){t===Pt.Ft.id?(i.setForceOpenAsText(),i.setPreferredLanguageId(Xt.n),o=(0,xt.A)((0,xt.A)({},o),{},{forceReload:!0})):i.setForceOpenAsBinary(),e.openEditor(i,o)}clearInput(){var e;super.clearInput(),null===(e=this.editorControl)||void 0===e||e.setModel(null)}createEditorControl(e,t){(0,Rt.bc)("code/willCreateTextFileEditorControl"),super.createEditorControl(e,t),(0,Rt.bc)("code/didCreateTextFileEditorControl")}tracksEditorViewState(e){return e instanceof zt.n}tracksDisposedEditorViewState(){return!0}},{_:Qb=et},{_:et.ID=Xt.o},et);Yb=Qb=(0,Rt.Pb)([(0,Rt.Fb)(1,Rt.ib),(0,Rt.Fb)(2,Rt.ys),(0,Rt.Fb)(3,Nt.Ct),(0,Rt.Fb)(4,Rt.Ub),(0,Rt.Fb)(5,Rt.Ra),(0,Rt.Fb)(6,Rt.Uo),(0,Rt.Fb)(7,Rt.hv),(0,Rt.Fb)(8,Pt.kt),(0,Rt.Fb)(9,Rt.Qd),(0,Rt.Fb)(10,Pt.W),(0,Rt.Fb)(11,Pt.E),(0,Rt.Fb)(12,Tt.Hn),(0,Rt.Fb)(13,Rt.Zo),(0,Rt.Fb)(14,Pt.A),(0,Rt.Fb)(15,Rt.o_),(0,Rt.Fb)(16,jt.r),(0,Rt.Fb)(17,Lt.P),(0,Rt.Fb)(18,Pt.B)],Yb),(0,Rt.Ib)(),(0,Pt.h)(),(0,Pt.D)(),(0,Pt.z)(),(0,Rt.PA)(),(0,Rt.WM)(),(0,Lt.F)(),(0,Pt.At)(),(0,Rt.Iw)(),(0,Rt.Hb)(),(0,Pt.V)(),(0,Rt.yT)(),(0,Wt.w_)(),(0,Pt.en)();var Hb=(tt=class extends Rt.CA{constructor(e,t,i,o,s,r,n){super(),this.editorService=e,this.textFileService=t,this.lifecycleService=i,this.hostService=o,this.codeEditorService=s,this.filesConfigurationService=r,this.workingCopyEditorService=n,this.ensureDirtyFilesAreOpenedWorker=this._register(new Rt.Cw(e=>this.ensureDirtyTextFilesAreOpened(e),this.getDirtyTextFileTrackerDelay())),this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.files.onDidSaveError(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.untitled.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.hostService.onDidChangeFocus(e=>e?this.reloadVisibleTextFileEditors():void 0)),this._register(this.lifecycleService.onDidShutdown(()=>this.dispose()))}getDirtyTextFileTrackerDelay(){return 800}ensureDirtyTextFilesAreOpened(e){this.doEnsureDirtyTextFilesAreOpened((0,Rt.LM)(e.filter(e=>{if(!this.textFileService.isDirty(e))return!1;let t=this.textFileService.files.get(e);if(null!==t&&void 0!==t&&t.hasState(Pt.d.PENDING_SAVE)||e.scheme!==Rt.vT.untitled&&(null===t||void 0===t||!t.hasState(Pt.d.ERROR))&&this.filesConfigurationService.hasShortAutoSaveDelay(e)||this.editorService.isOpened({resource:e,typeId:e.scheme===Rt.vT.untitled?zt.l.ID:"workbench.editors.files.fileEditorInput",editorId:Pt.Ft.id}))return!1;let i=null!==t&&void 0!==t?t:this.textFileService.untitled.get(e);return!(i&&this.workingCopyEditorService.findEditor(i))}),e=>e.toString()))}doEnsureDirtyTextFilesAreOpened(e){e.length&&this.editorService.openEditors(e.map(e=>({resource:e,options:{inactive:!0,pinned:!0,preserveFocus:!0}})))}reloadVisibleTextFileEditors(){(0,Rt.LM)((0,Rt.AM)(this.codeEditorService.listCodeEditors().map(e=>{var t;let i=null===(t=e.getModel())||void 0===t?void 0:t.uri;if(!i)return;let o=this.textFileService.files.get(i);return o&&!o.isDirty()&&o.isResolved()?o:void 0})),e=>e.resource.toString()).forEach(e=>this.textFileService.files.resolve(e.resource,{reload:{async:!0}}))}},{_:tt.ID="workbench.contrib.textFileEditorTracker"},tt);Hb=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.kt),(0,Rt.Fb)(1,Pt.E),(0,Rt.Fb)(2,Pt.R),(0,Rt.Fb)(3,Lt.P),(0,Rt.Fb)(4,Rt.Vb),(0,Rt.Fb)(5,Pt.B),(0,Rt.Fb)(6,Wt.C_)],Hb),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.Pp)(),(0,Rt.iT)(),(0,Rt.Mb)(),(0,Rt.TD)(),(0,Rt.ac)(),(0,Pt.D)(),(0,Rt.Kb)(),(0,Rt.PA)(),(0,Rt.Rb)(),(0,Rt.QA)(),(0,Pt.it)(),(0,Rt.IO)(),(0,Rt.bb)(),(0,Zt.l)(),(0,Rt.Ud)(),(0,Rt.Rd)(),(0,Rt.br)(),(0,Rt.Jo)(),(0,Rt.Wo)(),(0,Nt.Ut)(),(0,Rt.gA)(),(0,Pt.At)(),(0,Rt.mj)(),(0,Rt.yT)(),(0,jt.i)(),(0,Pt.en)(),(0,Rt.BC)(),(0,Rt.qd)();var Xb="conflictResolution",Ub="learnMoreDirtyWriteError",zb=(0,Rt.Ij)(7900,"Use the actions in the editor tool bar to either undo your changes or overwrite the content of the file with your changes."),qb=(it=class extends Rt.CA{constructor(e,t,i,o,s,r,n){super(),this.notificationService=e,this.textFileService=t,this.editorService=o,this.instantiationService=r,this.storageService=n,this.messages=new Rt.qA,this.activeConflictResolutionResource=void 0,this.conflictResolutionContext=new Rt.FO("saveConflictResolutionContext",!1,!0).bindTo(i);let a=this._register(r.createInstance(Xt.s));this._register(s.registerTextModelContentProvider(Xb,a)),this.textFileService.files.saveErrorHandler=this,this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidSave(e=>this.onFileSavedOrReverted(e.model.resource))),this._register(this.textFileService.files.onDidRevert(e=>this.onFileSavedOrReverted(e.resource))),this._register(this.editorService.onDidActiveEditorChange(()=>this.onActiveEditorChanged()))}onActiveEditorChanged(){var e;let t,i=!1,o=this.editorService.activeEditor;o instanceof Pt.nt&&"conflictResolution"===(null===(e=o.original.resource)||void 0===e?void 0:e.scheme)&&(i=!0,t=o.modified.resource),this.conflictResolutionContext.set(i),this.activeConflictResolutionResource=t}onFileSavedOrReverted(e){let t=this.messages.get(e);t&&(t.close(),this.messages.delete(e))}onSaveError(e,t,i){let o,s=e,r=t.resource,n=[],a=[];if(s.fileOperationResult===Rt.Is.FILE_MODIFIED_SINCE)if(this.activeConflictResolutionResource&&(0,Rt.oT)(this.activeConflictResolutionResource,t.resource)){if(this.storageService.getBoolean(Ub,Rt.Go.APPLICATION))return;o=zb,n.push(this.instantiationService.createInstance(em)),a.push(this.instantiationService.createInstance(tm))}else o=(0,Rt.Ij)(7901,"Failed to save '{0}': The content of the file is newer. Please compare your version with the file contents or overwrite the content of the file with your changes.",(0,Rt.Xw)(r)),n.push(this.instantiationService.createInstance(im,t)),n.push(this.instantiationService.createInstance(dm,t,i)),a.push(this.instantiationService.createInstance(lm));else{var d;let a=s.fileOperationResult===Rt.Is.FILE_WRITE_LOCKED,l=a&&(null===(d=s.options)||void 0===d?void 0:d.unlock),c=s.fileOperationResult===Rt.Is.FILE_PERMISSION_DENIED,h=r.scheme===Rt.vT.file;h&&(c||l)?n.push(this.instantiationService.createInstance(om,t,i,!!l)):a?n.push(this.instantiationService.createInstance(am,t,i)):n.push(this.instantiationService.createInstance(sm,t,i)),n.push(this.instantiationService.createInstance(nm,t)),n.push(this.instantiationService.createInstance(rm,t)),o=a?l&&h?Rt.kj?(0,Rt.Ij)(7902,"Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",(0,Rt.Xw)(r)):(0,Rt.Ij)(7903,"Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",(0,Rt.Xw)(r)):(0,Rt.Ij)(7904,"Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",(0,Rt.Xw)(r)):h&&c?Rt.kj?(0,Rt.Ij)(7905,"Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",(0,Rt.Xw)(r)):(0,Rt.Ij)(7906,"Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",(0,Rt.Xw)(r)):(0,Rt.Ij)(7907,"Failed to save '{0}': {1}",(0,Rt.Xw)(r),(0,Rt.Ip)(e,!1))}let l={primary:n,secondary:a},c=this.notificationService.notify({id:"".concat((0,Rt.zC)(t.resource.toString())),severity:Rt.Kd.Error,message:o,actions:l});Rt.dA.once(c.onDidClose)(()=>{(0,Rt.MA)(n),(0,Rt.MA)(a)}),this.messages.set(t.resource,c)}dispose(){super.dispose(),this.messages.clear()}},{_:it.ID="workbench.contrib.textFileSaveErrorHandler"},it);qb=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ld),(0,Rt.Fb)(1,Pt.E),(0,Rt.Fb)(2,Rt.yb),(0,Rt.Fb)(3,Pt.kt),(0,Rt.Fb)(4,Rt.Lb),(0,Rt.Fb)(5,Rt.Ub),(0,Rt.Fb)(6,Rt.Uo)],qb);var $b=[],em=class extends Rt.Ob{constructor(e){super("workbench.files.action.resolveConflictLearnMore",(0,Rt.Ij)(7908,"Learn More")),this.openerService=e}async run(){await this.openerService.open(Rt.wD.parse("https://go.microsoft.com/fwlink/?linkid=868264"))}};em=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.yr)],em);var tm=class extends Rt.Ob{constructor(e){super("workbench.files.action.resolveConflictLearnMoreDoNotShowAgain",(0,Rt.Ij)(7909,"Don't Show Again")),this.storageService=e}async run(e){this.storageService.store(Ub,!0,Rt.Go.APPLICATION,Rt.Ko.USER),e.dispose()}};tm=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Uo)],tm);var im=class extends Rt.Ob{constructor(e,t,i,o,s){super("workbench.files.action.resolveConflict",(0,Rt.Ij)(7910,"Compare")),this.model=e,this.editorService=t,this.notificationService=i,this.instantiationService=o,this.productService=s}async run(){if(!this.model.isDisposed()){let e=this.model.resource,t=(0,Rt.Xw)(e),i=(0,Rt.Ij)(7911,"{0} (in file) \u2194 {1} (in {2}) - Resolve save conflict",t,t,this.productService.nameLong);await Xt.s.open(e,Xb,i,this.editorService,{pinned:!0});let o={primary:[this.instantiationService.createInstance(em)]},s=this.notificationService.notify({id:"".concat((0,Rt.zC)(e.toString())),severity:Rt.Kd.Info,message:zb,actions:o,neverShowAgain:{id:Ub,isSecondary:!0}});Rt.dA.once(s.onDidClose)(()=>(0,Rt.MA)(o.primary)),$b.push(s)}}};im=(0,Rt.Pb)([(0,Rt.Fb)(1,Pt.kt),(0,Rt.Fb)(2,Rt.Ld),(0,Rt.Fb)(3,Rt.Ub),(0,Rt.Fb)(4,Nt.Ht)],im);var om=class extends Rt.Ob{constructor(e,t,i){super("workbench.files.action.saveModelElevated",i?Rt.kj?(0,Rt.Ij)(7912,"Overwrite as Admin..."):(0,Rt.Ij)(7913,"Overwrite as Sudo..."):Rt.kj?(0,Rt.Ij)(7914,"Retry as Admin..."):(0,Rt.Ij)(7915,"Retry as Sudo...")),this.model=e,this.options=t,this.triedToUnlock=i}async run(){this.model.isDisposed()||await this.model.save((0,xt.A)((0,xt.A)({},this.options),{},{writeElevated:!0,writeUnlock:this.triedToUnlock,reason:Pt.Kt.EXPLICIT}))}},sm=class extends Rt.Ob{constructor(e,t){super("workbench.files.action.saveModel",(0,Rt.Ij)(7916,"Retry")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save((0,xt.A)((0,xt.A)({},this.options),{},{reason:Pt.Kt.EXPLICIT}))}},rm=class extends Rt.Ob{constructor(e){super("workbench.files.action.revertModel",(0,Rt.Ij)(7917,"Revert")),this.model=e}async run(){this.model.isDisposed()||await this.model.revert()}},nm=class extends Rt.Ob{constructor(e,t){super("workbench.files.action.saveModelAs",Zt.o.value),this.model=e,this.editorService=t}async run(){if(!this.model.isDisposed()){let e=this.findEditor();e&&await this.editorService.save(e,{saveAs:!0,reason:Pt.Kt.EXPLICIT})}}findEditor(){let e,t=this.editorService.findEditors(this.model.resource,{supportSideBySide:Pt.Jt.PRIMARY});for(let i of t){if(i.editor instanceof zt.n){e=i;break}e||(e=i)}return e}};nm=(0,Rt.Pb)([(0,Rt.Fb)(1,Pt.kt)],nm);var am=class extends Rt.Ob{constructor(e,t){super("workbench.files.action.unlock",(0,Rt.Ij)(7918,"Overwrite")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save((0,xt.A)((0,xt.A)({},this.options),{},{writeUnlock:!0,reason:Pt.Kt.EXPLICIT}))}},dm=class extends Rt.Ob{constructor(e,t){super("workbench.files.action.saveIgnoreModifiedSince",(0,Rt.Ij)(7918,"Overwrite")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save((0,xt.A)((0,xt.A)({},this.options),{},{ignoreModifiedSince:!0,reason:Pt.Kt.EXPLICIT}))}},lm=class extends Rt.Ob{constructor(e){super("workbench.files.action.configureSaveConflict",(0,Rt.Ij)(7919,"Configure")),this.preferencesService=e}async run(){this.preferencesService.openSettings({query:"files.saveConflictResolution"})}};lm=(0,Rt.Pb)([(0,Rt.Fb)(0,jt.r)],lm),(0,Rt.Ib)(),(0,Rt.Fj)(),(0,Rt.PA)(),(0,Rt.TD)(),(0,Rt.s_)(),(0,Rt.bs)(),(0,Rt.za)(),(0,Rt.QA)(),(0,Rt.Ud)(),(0,Rt.Rd)(),(0,Rt.br)(),(0,Rt.AD)(),(0,Rt.Qo)(),(0,Lt.F)(),(0,Rt.ab)(),(0,Rt.qd)();var cm=(ot=class extends Rt.CA{constructor(e,t,i,o,s,r,n,a){super(),this.fileService=e,this.configurationService=t,this.contextService=i,this.notificationService=o,this.openerService=s,this.uriIdentityService=r,this.hostService=n,this.telemetryService=a,this.watchedWorkspaces=new Rt.qA(e=>this.uriIdentityService.extUri.getComparisonKey(e)),this.registerListeners(),this.refresh()}registerListeners(){this._register(this.contextService.onDidChangeWorkspaceFolders(e=>this.onDidChangeWorkspaceFolders(e))),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onDidChangeWorkbenchState())),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onDidChangeConfiguration(e))),this._register(this.fileService.onDidWatchError(e=>this.onDidWatchError(e)))}onDidChangeWorkspaceFolders(e){for(let t of e.removed)this.unwatchWorkspace(t);for(let t of e.added)this.watchWorkspace(t)}onDidChangeWorkbenchState(){this.refresh()}onDidChangeConfiguration(e){(e.affectsConfiguration("files.watcherExclude")||e.affectsConfiguration("files.watcherInclude"))&&this.refresh()}onDidWatchError(e){let t,i=e.toString();i.indexOf("ENOSPC")>=0?(t="ENOSPC",this.notificationService.prompt(Rt.Kd.Warning,(0,Rt.Ij)(8253,"Unable to watch for file changes. Please follow the instructions link to resolve this issue."),[{label:(0,Rt.Ij)(8254,"Instructions"),run:()=>this.openerService.open(Rt.wD.parse("https://go.microsoft.com/fwlink/?linkid=867693"))}],{sticky:!0,neverShowAgain:{id:"ignoreEnospcError",isSecondary:!0,scope:Rt.zd.WORKSPACE}})):i.indexOf("EUNKNOWN")>=0?(t="EUNKNOWN",this.notificationService.prompt(Rt.Kd.Warning,(0,Rt.Ij)(8255,"File changes watcher stopped unexpectedly. A reload of the window may enable the watcher again unless the workspace cannot be watched for file changes."),[{label:(0,Rt.Ij)(8256,"Reload"),run:()=>this.hostService.reload()}],{sticky:!0,priority:Rt.Vd.SILENT})):i.indexOf("ETERM")>=0&&(t="ETERM"),t&&this.telemetryService.publicLog2("fileWatcherError",{reason:t})}watchWorkspace(e){var t,i;let o=[],s=this.configurationService.getValue({resource:e.uri});if(null!==(t=s.files)&&void 0!==t&&t.watcherExclude)for(let a in s.files.watcherExclude)a&&!0===s.files.watcherExclude[a]&&o.push(a);let r=new Rt.qA(e=>this.uriIdentityService.extUri.getComparisonKey(e));if(r.set(e.uri,e.uri),null!==(i=s.files)&&void 0!==i&&i.watcherInclude)for(let a of s.files.watcherInclude)if(a)if((0,Rt.jD)(a)){let t=Rt.wD.file(a).with({scheme:e.uri.scheme});this.uriIdentityService.extUri.isEqualOrParent(t,e.uri)&&r.set(t,t)}else{let t=e.toResource(a);r.set(t,t)}let n=new Rt.EA;for(let[,a]of r)n.add(this.fileService.watch(a,{recursive:!0,excludes:o}));this.watchedWorkspaces.set(e.uri,n)}unwatchWorkspace(e){this.watchedWorkspaces.has(e.uri)&&((0,Rt.MA)(this.watchedWorkspaces.get(e.uri)),this.watchedWorkspaces.delete(e.uri))}refresh(){this.unwatchWorkspaces();for(let e of this.contextService.getWorkspace().folders)this.watchWorkspace(e)}unwatchWorkspaces(){for(let[,e]of this.watchedWorkspaces)e.dispose();this.watchedWorkspaces.clear()}dispose(){super.dispose(),this.unwatchWorkspaces()}},{_:ot.ID="workbench.contrib.workspaceWatcher"},ot);cm=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.ys),(0,Rt.Fb)(1,Rt.o_),(0,Rt.Fb)(2,Rt.Ra),(0,Rt.Fb)(3,Rt.Ld),(0,Rt.Fb)(4,Rt.yr),(0,Rt.Fb)(5,Rt.Zo),(0,Rt.Fb)(6,Lt.P),(0,Rt.Fb)(7,Rt.ib)],cm),(0,Rt.Ib)(),(0,Rt.yT)(),(0,Rt.AD)(),(0,Rt.mj)(),(0,Rt.C_)(),(0,Rt.Fj)(),(0,Rt.sm)(),(0,Rt.Xa)(),(0,Rt.vb)(),(0,Tt.f)(),(0,Pt.b)(),(0,Pt.en)();var hm=(st=class{constructor(e){e.registerFormatter({scheme:Rt.vT.file,formatting:{label:"${authority}${path}",separator:Rt.LD,tildify:!Rt.kj,normalizeDriveLetter:Rt.kj,authorityPrefix:Rt.LD+Rt.LD,workspaceSuffix:""}})}},{_:st.ID="workbench.contrib.fileUriLabel"},st);hm=(0,Rt.Pb)([(0,Rt.Fb)(0,Rt.Ya)],hm),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(Yb,Yb.ID,(0,Rt.Ij)(8159,"Text File Editor")),[new Rt.om(zt.n)]),Rt._b.as(Pt.Rt.EditorPane).registerEditorPane(Tt.u.create(Mb,Mb.ID,(0,Rt.Ij)(8160,"Binary File Editor")),[new Rt.om(zt.n)]),Rt._b.as(Pt.Rt.EditorFactory).registerEditorSerializer(Xt.r,class{canSerialize(e){return!0}serialize(e){let t=e,i=t.resource,o=t.preferredResource,s={resourceJSON:i.toJSON(),preferredResourceJSON:(0,Rt.oT)(i,o)?void 0:o,name:t.getPreferredName(),description:t.getPreferredDescription(),encoding:t.getEncoding(),modeId:t.getPreferredLanguageId()};return JSON.stringify(s)}deserialize(e,t){return e.invokeFunction(e=>{let i=JSON.parse(t),o=Rt.wD.revive(i.resourceJSON),s=Rt.wD.revive(i.preferredResourceJSON),r=i.name,n=i.description,a=i.encoding,d=i.modeId,l=e.get(Zt.u).createTextEditor({resource:o,label:r,description:n,encoding:a,languageId:d,forceFile:!0});return s&&l.setPreferredResource(s),l})}}),(0,Pt.x)(jb.ID,jb,Pt.y.BlockRestore),(0,Pt.x)(Hb.ID,Hb,Pt.y.BlockStartup),(0,Pt.x)(qb.ID,qb,Pt.y.BlockStartup),(0,Pt.x)(hm.ID,hm,Pt.y.BlockStartup),(0,Pt.x)(cm.ID,cm,Pt.y.AfterRestored),(0,Pt.x)(Ob.ID,Ob,Pt.y.BlockStartup),Rt.b_.registerLanguage({id:Xt.n,aliases:["Binary"],mimetypes:["text/x-code-binary"]}),(0,Rt.fE)(),(0,Rt.dp)(),(0,Lt.Xn)(),(0,Rt.mj)(),(0,Rt.qx)(),(0,Rt.eE)(),(0,Rt.Pg)(),(0,Rt.wg)(),(0,Rt.lh)(),(0,Rt.ig)(),(0,Rt.Zm)(),(0,Rt.Pm)(),(0,Rt.Mm)(),(0,Rt.uh)(),(0,Rt.mg)(),(0,Rt.Om)(),(0,Rt.Dm)(),(0,Rt.gE)(),(0,Rt.mE)({}),(0,Rt.fp)((e,t)=>{let i=(0,Lt.Yn)(e);t.addRule(".monaco-workbench-part { background-color: ".concat(i,"; }"));let o=e.getColor(Rt.Tg);if(o&&t.addRule(".monaco-workbench-part ::selection { background-color: ".concat(o,"; }")),Rt.Dj){let t=e.getColor(Lt.Hn);if(t){let e="monaco-workbench-meta-theme-color",i=Rt.vE.document.getElementById(e);i||(i=(0,Rt.yx)(),i.name="theme-color",i.id=e),i.content=t.toString()}}Rt.aE&&t.addRule("\n\t\t\t.monaco-workbench-part.web {\n\t\t\t\ttouch-action: none;\n\t\t\t}\n\t\t\t.monaco-workbench-part .monaco-editor .view-lines {\n\t\t\t\tuser-select: text;\n\t\t\t\t-webkit-user-select: text;\n\t\t\t}\n\t\t"),Rt.bj&&(0,Rt.oE)()&&t.addRule(".monaco-workbench-part { background-color: ".concat(i,"; }"))}),(0,Rt.Ib)(),(0,Rt.PA)(),(0,Rt.Fj)(),(0,Mt.c)(),(0,Rt.db)(),(0,Rt.Ad)(),(0,Pt.en)(),(0,Wt.Ii)(),(0,Pt.At)(),(0,Wt.Sx)(),(0,Wt.vx)();var um=(rt=class extends Rt.CA{constructor(e,t){super(),this.editorService=e,this.statusbarService=t,this.paneInitialScrollTop=new Map,this.syncScrollDispoasbles=this._register(new Rt.EA),this.paneDisposables=new Rt.EA,this.statusBarEntry=this._register(new Rt.OA),this.isActive=!1,this._reentrancyBarrier=new Wt.Fi,this.registerActions()}registerActiveListeners(){this.syncScrollDispoasbles.add(this.editorService.onDidVisibleEditorsChange(()=>this.trackVisiblePanes()))}activate(){this.registerActiveListeners(),this.trackVisiblePanes()}toggle(){this.isActive?this.deactivate():this.activate(),this.isActive=!this.isActive,this.toggleStatusbarItem(this.isActive)}trackVisiblePanes(){this.paneDisposables.clear(),this.paneInitialScrollTop.clear();for(let e of this.getAllVisiblePanes())(0,Pt.sn)(e)&&(this.paneInitialScrollTop.set(e,e.getScrollPosition()),this.paneDisposables.add(e.onDidChangeScroll(()=>this._reentrancyBarrier.runExclusivelyOrSkip(()=>{this.onDidEditorPaneScroll(e)}))))}onDidEditorPaneScroll(e){let t=this.paneInitialScrollTop.get(e);if(void 0===t)throw Error("Scrolled pane not tracked");if(!(0,Pt.sn)(e))throw Error("Scrolled pane does not support scrolling");let i=e.getScrollPosition(),o=i.scrollTop-t.scrollTop,s=void 0!==i.scrollLeft&&void 0!==t.scrollLeft?i.scrollLeft-t.scrollLeft:void 0;for(let r of this.getAllVisiblePanes()){if(r===e||!(0,Pt.sn)(r))continue;let t=this.paneInitialScrollTop.get(r);if(void 0===t)throw Error("Could not find initial offset for pane");let i=r.getScrollPosition(),n={scrollTop:t.scrollTop+o,scrollLeft:void 0!==t.scrollLeft&&void 0!==s?t.scrollLeft+s:void 0};i.scrollTop===n.scrollTop&&i.scrollLeft===n.scrollLeft||r.setScrollPosition(n)}}getAllVisiblePanes(){let e=[];for(let t of this.editorService.visibleEditorPanes){if(t instanceof zt.o){let i=t.getPrimaryEditorPane(),o=t.getSecondaryEditorPane();i&&e.push(i),o&&e.push(o);continue}e.push(t)}return e}deactivate(){this.paneDisposables.clear(),this.syncScrollDispoasbles.clear(),this.paneInitialScrollTop.clear()}toggleStatusbarItem(e){if(e){if(!this.statusBarEntry.value){let e=(0,Rt.Ij)(10651,"Scrolling Locked"),t=(0,Rt.Ij)(10652,"Lock Scrolling Enabled");this.statusBarEntry.value=this.statusbarService.addEntry({name:e,text:e,tooltip:t,ariaLabel:e,command:{id:"workbench.action.toggleLockedScrolling",title:""},kind:"prominent",showInAllWindows:!0},"status.scrollLockingEnabled",Wt.bx.RIGHT,102)}}else this.statusBarEntry.clear()}registerActions(){let e=this;this._register((0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.toggleLockedScrolling",title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(10653,"Toggle Locked Scrolling Across Editors")),{},{mnemonicTitle:(0,Rt.Ij)(10654,"Locked Scrolling")}),category:Mt.s.View,f1:!0,metadata:{description:(0,Rt.Ij)(10655,"Synchronize Scrolling Editors")}})}run(){e.toggle()}})),this._register((0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"workbench.action.holdLockedScrolling",title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(10656,"Hold Locked Scrolling Across Editors")),{},{mnemonicTitle:(0,Rt.Ij)(10657,"Locked Scrolling")}),category:Mt.s.View})}run(t){let i=t.get(Rt.kd);e.toggle();let o=i.enableKeybindingHoldMode("workbench.action.holdLockedScrolling");o&&o.finally(()=>{e.toggle()})}}))}dispose(){this.deactivate(),super.dispose()}},{_:rt.ID="workbench.contrib.syncScrolling"},rt);um=(0,Rt.Pb)([(0,Rt.Fb)(0,Pt.kt),(0,Rt.Fb)(1,Wt._x)],um),(0,Pt.b)(),(0,Pt.x)(um.ID,um,Pt.y.Eventually),(0,Rt.Ib)(),(0,Rt.Mb)(),(0,Rt.Fj)(),(0,Nt.Q)(),(0,Rt.wl)(),(0,Rt.PA)(),(0,Rt.qx)(),(0,Pt.b)(),(0,Rt.w)(),(0,Rt.FT)(),(0,Rt.gA)(),(0,Rt.Mk)(),(0,Rt.nb)();var gm=(nt=class extends Rt.CA{constructor(e,t,i,o){super(),this.layoutService=e,this.contextMenuService=t,this.clipboardService=i,this.logService=o,this.textInputActions=new Rt.jk(()=>function(e,t){return[(0,Rt.Nb)({id:"undo",label:(0,Rt.Ij)(2918,"Undo"),run:()=>(0,Rt.wx)().execCommand("undo")}),(0,Rt.Nb)({id:"redo",label:(0,Rt.Ij)(2919,"Redo"),run:()=>(0,Rt.wx)().execCommand("redo")}),new Rt.Ab,(0,Rt.Nb)({id:"editor.action.clipboardCutAction",label:(0,Rt.Ij)(2920,"Cut"),run:()=>{t.trace("TextInputActionsProvider#cut"),(0,Rt.wx)().execCommand("cut")}}),(0,Rt.Nb)({id:"editor.action.clipboardCopyAction",label:(0,Rt.Ij)(2921,"Copy"),run:()=>{t.trace("TextInputActionsProvider#copy"),(0,Rt.wx)().execCommand("copy")}}),(0,Rt.Nb)({id:"editor.action.clipboardPasteAction",label:(0,Rt.Ij)(2922,"Paste"),run:async i=>{t.trace("TextInputActionsProvider#paste");let o=await e.readText();if((0,Rt.oS)(i)||(0,Rt.aS)(i)){let e=i.selectionStart||0,t=i.selectionEnd||0;i.value="".concat(i.value.substring(0,e)).concat(o).concat(i.value.substring(t,i.value.length)),i.selectionStart=e+o.length,i.selectionEnd=i.selectionStart,i.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))}}}),new Rt.Ab,(0,Rt.Nb)({id:"editor.action.selectAll",label:(0,Rt.Ij)(2923,"Select All"),run:()=>(0,Rt.wx)().execCommand("selectAll")})]}(this.clipboardService,this.logService)),this.registerListeners()}registerListeners(){this._register(Rt.dA.runAndSubscribe(this.layoutService.onDidAddContainer,e=>{let{container:t,disposables:i}=e;i.add((0,Rt.ox)(t,"contextmenu",e=>this.onContextMenu((0,Rt.Bx)(t),e)))},{container:this.layoutService.mainContainer,disposables:this._store}))}onContextMenu(e,t){if(t.defaultPrevented)return;let i=t.target;if(!(0,Rt.oS)(i)&&!(0,Rt.aS)(i))return;Rt.ex.stop(t,!0);let o=new Rt.NT(e,t);this.contextMenuService.showContextMenu({getAnchor:()=>o,getActions:()=>this.textInputActions.value,getActionsContext:()=>i})}},{_:nt.ID="workbench.contrib.textInputActionsProvider"},nt);gm=(0,Rt.Pb)([(0,Rt.Fb)(0,Nt.Z),(0,Rt.Fb)(1,Rt.Sl),(0,Rt.Fb)(2,Rt.C),(0,Rt.Fb)(3,Rt.eb)],gm),(0,Pt.x)(gm.ID,gm,Pt.y.BlockRestore),(0,Rt.Fj)(),(0,Rt.K_)(),(0,Rt.mj)(),(0,Rt.ab)(),(0,Rt.br)(),(0,Rt.TD)(),(0,Rt.db)(),(0,Rt.tO)(),(0,Nt.Ut)(),(0,Rt.gb)(),(0,Mt.c)(),(0,Rt.wb)(),(0,Rt.IO)();var pm=(at=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2755,"Keyboard Shortcuts Reference")),{},{mnemonicTitle:(0,Rt.Ij)(2756,"&&Keyboard Shortcuts Reference")}),category:Mt.s.Help,f1:!0,keybinding:{weight:Rt.mb.WorkbenchContrib,when:null,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyR)},menu:{id:Rt.sb.MenubarHelpMenu,group:"2_reference",order:1}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr),o=Rt.xj?t.keyboardShortcutsUrlLinux:Rt.Cj?t.keyboardShortcutsUrlMac:t.keyboardShortcutsUrlWin;o&&i.open(Rt.wD.parse(o))}},{_:at.ID="workbench.action.keybindingsReference"},{_:at.AVAILABLE=!!(Rt.xj?Rt.q_.keyboardShortcutsUrlLinux:Rt.Cj?Rt.q_.keyboardShortcutsUrlMac:Rt.q_.keyboardShortcutsUrlWin)},at),bm=(dt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2757,"Video Tutorials")),{},{mnemonicTitle:(0,Rt.Ij)(2758,"&&Video Tutorials")}),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"2_reference",order:2}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr);t.introductoryVideosUrl&&i.open(Rt.wD.parse(t.introductoryVideosUrl))}},{_:dt.ID="workbench.action.openVideoTutorialsUrl"},{_:dt.AVAILABLE=!!Rt.q_.introductoryVideosUrl},dt),mm=(lt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2759,"Tips and Tricks")),{},{mnemonicTitle:(0,Rt.Ij)(2760,"Tips and Tri&&cks")}),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"2_reference",order:3}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr);t.tipsAndTricksUrl&&i.open(Rt.wD.parse(t.tipsAndTricksUrl))}},{_:lt.ID="workbench.action.openTipsAndTricksUrl"},{_:lt.AVAILABLE=!!Rt.q_.tipsAndTricksUrl},lt),vm=(ct=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2761,"Documentation")),{},{mnemonicTitle:(0,Rt.Ij)(2762,"&&Documentation")}),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"1_welcome",order:3}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr),o=Rt.Dj?t.serverDocumentationUrl:t.documentationUrl;o&&i.open(Rt.wD.parse(o))}},{_:ct.ID="workbench.action.openDocumentationUrl"},{_:ct.AVAILABLE=!!(Rt.Dj?Rt.q_.serverDocumentationUrl:Rt.q_.documentationUrl)},ct),Cm=(ht=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2763,"Signup for the VS Code Newsletter"),category:Mt.s.Help,f1:!0})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr),o=e.get(Rt.ib);i.open(Rt.wD.parse("".concat(t.newsletterSignupUrl,"?machineId=").concat(encodeURIComponent(o.machineId))))}},{_:ht.ID="workbench.action.openNewsletterSignupUrl"},{_:ht.AVAILABLE=!!Rt.q_.newsletterSignupUrl},ht),wm=(ut=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2764,"Join Us on YouTube")),{},{mnemonicTitle:(0,Rt.Ij)(2765,"&&Join Us on YouTube")}),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"3_feedback",order:1}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr);t.youTubeUrl&&i.open(Rt.wD.parse(t.youTubeUrl))}},{_:ut.ID="workbench.action.openYouTubeUrl"},{_:ut.AVAILABLE=!!Rt.q_.youTubeUrl},ut),ym=(gt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2766,"Search Feature Requests")),{},{mnemonicTitle:(0,Rt.Ij)(2767,"&&Search Feature Requests")}),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"3_feedback",order:2}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr);t.requestFeatureUrl&&i.open(Rt.wD.parse(t.requestFeatureUrl))}},{_:gt.ID="workbench.action.openRequestFeatureUrl"},{_:gt.AVAILABLE=!!Rt.q_.requestFeatureUrl},gt),fm=(pt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2768,"View License")),{},{mnemonicTitle:(0,Rt.Ij)(2769,"View &&License")}),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"4_legal",order:1}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr),o=Rt.Dj?t.serverLicenseUrl:t.licenseUrl;if(o)if(Rt.Aj){let e=o.indexOf("?")>0?"&":"?";i.open(Rt.wD.parse("".concat(o).concat(e,"lang=").concat(Rt.Aj)))}else i.open(Rt.wD.parse(o))}},{_:pt.ID="workbench.action.openLicenseUrl"},{_:pt.AVAILABLE=!!(Rt.Dj?Rt.q_.serverLicense:Rt.q_.licenseUrl)},pt),Sm=(bt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2770,"Privacy Statement")),{},{mnemonicTitle:(0,Rt.Ij)(2771,"Privac&&y Statement")}),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"4_legal",order:2}})}run(e){let t=e.get(Nt.Ht),i=e.get(Rt.yr);t.privacyStatementUrl&&i.open(Rt.wD.parse(t.privacyStatementUrl))}},{_:bt.ID="workbench.action.openPrivacyStatementUrl"},{_:bt.AVAILABLE=!!Rt.q_.privacyStatementUrl},bt),Im=(mt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2772,"Get Started with Accessibility Features"),category:Mt.s.Help,f1:!0,menu:{id:Rt.sb.MenubarHelpMenu,group:"1_welcome",order:6}})}run(e){e.get(Rt.Cb).executeCommand("workbench.action.openWalkthrough","SetupAccessibility")}},{_:mt.ID="workbench.action.getStartedWithAccessibilityFeatures"},mt),km=(vt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2773,"Ask @vscode"),category:Mt.s.Help,f1:!0,precondition:Rt.PO.equals("chatSetupHidden",!1)})}async run(e){e.get(Rt.Cb).executeCommand("workbench.action.chat.open",{mode:"ask",query:"@vscode ",isPartialQuery:!0})}},{_:vt.ID="workbench.action.askVScode"},vt);function _m(e){let t=null===e||void 0===e?void 0:e.getHTMLElement();t&&!(0,Rt.Yx)(t)&&(null===e||void 0===e||e.domFocus())}async function Em(e,t){if(!e)return;await async function(e,t){if(!Rt.dt.getValue(e.contextKeyService))return t(e);let i=e.getFocus(),o=e.getSelection();await t(e);let s=e.getFocus();if(o.length>1||!(0,Rt.RM)(i,o)||(0,Rt.RM)(i,s))return;let r=new KeyboardEvent("keydown");e.setSelection(s,r)}(e,t);let i=e.getFocus();i.length&&e.reveal(i[0]),e.setAnchor(i[0]),_m(e)}function Am(e,t){if(e instanceof Rt.ra||e instanceof Rt.rn||e instanceof Rt.Wt){let i=e,o=i.getFocus()?i.getFocus()[0]:void 0,s=i.getSelection();s&&"number"==typeof o&&s.indexOf(o)>=0?i.setSelection(s.filter(e=>e!==t)):"number"==typeof o&&i.setSelection(s.concat(o))}else if(e instanceof Rt.Ht||e instanceof Rt.Rt||e instanceof Rt.Bt){let i=e,o=i.getFocus()?i.getFocus()[0]:void 0;if(t===o)return;let s=i.getSelection(),r=new KeyboardEvent("keydown",{shiftKey:!0});s&&s.indexOf(o)>=0?i.setSelection(s.filter(e=>e!==t),r):i.setSelection(s.concat(o),r)}}function Dm(e,t){let i=e.getStickyScrollFocus();if(0===i.length)throw Error("StickyScroll has no focus");if(i.length>1)throw Error("StickyScroll can only have a single focused item");e.reveal(i[0]),e.getHTMLElement().focus(),e.setFocus(i),null===t||void 0===t||t(i[0])}function xm(e,t){let i=e.get(Rt.wt).lastFocusedList,o=(0,Rt.St)("keydown",t);if(i instanceof Rt.ra||i instanceof Rt.rn||i instanceof Rt.Wt){let e=i;e.setAnchor(e.getFocus()[0]),e.setSelection(e.getFocus(),o)}else if(i instanceof Rt.Ht||i instanceof Rt.Rt||i instanceof Rt.Bt){let e=i,t=e.getFocus();if(t.length>0){let i=!0;(!0===e.expandOnlyOnTwistieClick||"boolean"!=typeof e.expandOnlyOnTwistieClick&&e.expandOnlyOnTwistieClick(t[0]))&&(i=!1),i&&e.toggleCollapsed(t[0])}e.setAnchor(t[0]),e.setSelection(t,o)}}Rt.lb.appendMenuItem(Rt.sb.MenubarHelpMenu,{command:{id:km.ID,title:(0,Rt.Lj)(2773,"Ask @vscode")},order:7,group:"1_welcome",when:Rt.PO.equals("chatSetupHidden",!1)}),pm.AVAILABLE&&(0,Rt.pb)(pm),bm.AVAILABLE&&(0,Rt.pb)(bm),mm.AVAILABLE&&(0,Rt.pb)(mm),vm.AVAILABLE&&(0,Rt.pb)(vm),Cm.AVAILABLE&&(0,Rt.pb)(Cm),wm.AVAILABLE&&(0,Rt.pb)(wm),ym.AVAILABLE&&(0,Rt.pb)(ym),fm.AVAILABLE&&(0,Rt.pb)(fm),Sm.AVAILABLE&&(0,Rt.pb)(Sm),(0,Rt.pb)(Im),(0,Rt.pb)(km),(0,Rt.tO)(),(0,Rt.gb)(),(0,Rt.ia)(),(0,Rt.Ct)(),(0,Rt.Tt)(),(0,Rt.in)(),(0,Rt.WM)(),(0,Rt.IO)(),(0,Rt.Ut)(),(0,Rt.Vt)(),(0,Rt.zt)(),(0,Rt.Sb)(),(0,Rt.Gt)(),(0,Rt.fn)(),(0,Rt.qx)(),(0,Rt.db)(),(0,Rt.s_)(),(0,Rt.Fj)(),(0,Rt.cr)(),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusDown",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.DownArrow,mac:{primary:Rt.YD.DownArrow,secondary:[Rt.ZD.WinCtrl|Rt.YD.KeyN]},handler:(e,t)=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown");await e.focusNext("number"==typeof t?t:1,!1,i)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusUp",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.UpArrow,mac:{primary:Rt.YD.UpArrow,secondary:[Rt.ZD.WinCtrl|Rt.YD.KeyP]},handler:(e,t)=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown");await e.focusPrevious("number"==typeof t?t:1,!1,i)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusAnyDown",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.ZD.Alt|Rt.YD.DownArrow,mac:{primary:Rt.ZD.Alt|Rt.YD.DownArrow,secondary:[Rt.ZD.WinCtrl|Rt.ZD.Alt|Rt.YD.KeyN]},handler:(e,t)=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown",{altKey:!0});await e.focusNext("number"==typeof t?t:1,!1,i)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusAnyUp",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.ZD.Alt|Rt.YD.UpArrow,mac:{primary:Rt.ZD.Alt|Rt.YD.UpArrow,secondary:[Rt.ZD.WinCtrl|Rt.ZD.Alt|Rt.YD.KeyP]},handler:(e,t)=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let i=new KeyboardEvent("keydown",{altKey:!0});await e.focusPrevious("number"==typeof t?t:1,!1,i)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusPageDown",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.PageDown,handler:e=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusNextPage(t)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusPageUp",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.PageUp,handler:e=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusPreviousPage(t)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusFirst",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.Home,handler:e=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusFirst(t)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusLast",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.End,handler:e=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown");await e.focusLast(t)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusAnyFirst",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.ZD.Alt|Rt.YD.Home,handler:e=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown",{altKey:!0});await e.focusFirst(t)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusAnyLast",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.ZD.Alt|Rt.YD.End,handler:e=>{Em(e.get(Rt.wt).lastFocusedList,async e=>{let t=new KeyboardEvent("keydown",{altKey:!0});await e.focusLast(t)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.expandSelectionDown",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,Rt.pt),primary:Rt.ZD.Shift|Rt.YD.DownArrow,handler:(e,t)=>{let i=e.get(Rt.wt).lastFocusedList;if(!i)return;let o=i.getFocus()?i.getFocus()[0]:void 0,s=new KeyboardEvent("keydown");i.focusNext("number"==typeof t?t:1,!1,s),Am(i,o);let r=i.getFocus();r.length&&i.reveal(r[0]),_m(i)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.expandSelectionUp",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,Rt.pt),primary:Rt.ZD.Shift|Rt.YD.UpArrow,handler:(e,t)=>{let i=e.get(Rt.wt).lastFocusedList;if(!i)return;let o=i.getFocus()?i.getFocus()[0]:void 0,s=new KeyboardEvent("keydown");i.focusPrevious("number"==typeof t?t:1,!1,s),Am(i,o);let r=i.getFocus();r.length&&i.reveal(r[0]),_m(i)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.collapse",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,Rt.PO.or(Rt.gt,Rt.yt)),primary:Rt.YD.LeftArrow,mac:{primary:Rt.YD.LeftArrow,secondary:[Rt.ZD.CtrlCmd|Rt.YD.UpArrow]},handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(!t||!(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt))return;let i=t,o=i.getFocus();if(0===o.length)return;let s=o[0];if(!i.collapse(s)){let e=i.getParentElement(s);e&&Em(t,t=>{let i=new KeyboardEvent("keydown");t.setFocus([e],i)})}}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.stickyScroll.collapse",weight:Rt.mb.WorkbenchContrib+50,when:Rt.xt,primary:Rt.YD.LeftArrow,mac:{primary:Rt.YD.LeftArrow,secondary:[Rt.ZD.CtrlCmd|Rt.YD.UpArrow]},handler:e=>{let t=e.get(Rt.wt).lastFocusedList;!t||!(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt)||Dm(t,e=>t.collapse(e))}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.collapseAll",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.ZD.CtrlCmd|Rt.YD.LeftArrow,mac:{primary:Rt.ZD.CtrlCmd|Rt.YD.LeftArrow,secondary:[Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.UpArrow]},handler:e=>{let t=e.get(Rt.wt).lastFocusedList;t&&!(t instanceof Rt.ra||t instanceof Rt.rn||t instanceof Rt.Wt)&&t.collapseAll()}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.collapseAllToFocus",weight:Rt.mb.WorkbenchContrib,when:Rt.st,handler:e=>{let t=e.get(Rt.wt).lastFocusedList,i=(0,Rt.St)("keydown",!0);if(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt){let e=t,o=e.getFocus();o.length>0&&e.collapse(o[0],!0),e.setSelection(o,i),e.setAnchor(o[0])}}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.focusParent",weight:Rt.mb.WorkbenchContrib,when:Rt.st,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(!t||!(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt))return;let i=t,o=i.getFocus();if(0===o.length)return;let s=o[0],r=i.getParentElement(s);r&&Em(t,e=>{let t=new KeyboardEvent("keydown");e.setFocus([r],t)})}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.expand",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,Rt.PO.or(Rt._t,Rt.vt)),primary:Rt.YD.RightArrow,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(t)if(t instanceof Rt.Ht||t instanceof Rt.Rt){let e=t.getFocus();if(0===e.length)return;let i=e[0];if(!t.expand(i)){let e=t.getFirstElementChild(i);e&&t.getNode(e).visible&&Em(t,t=>{let i=new KeyboardEvent("keydown");t.setFocus([e],i)})}}else if(t instanceof Rt.Bt){let e=t.getFocus();if(0===e.length)return;let i=e[0];t.expand(i).then(e=>{if(i&&!e){let e=t.getFirstElementChild(i);e&&t.getNode(e).visible&&Em(t,t=>{let i=new KeyboardEvent("keydown");t.setFocus([e],i)})}})}}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.select",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.Enter,mac:{primary:Rt.YD.Enter,secondary:[Rt.ZD.CtrlCmd|Rt.YD.DownArrow]},handler:e=>{xm(e,!1)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.stickyScrollselect",weight:Rt.mb.WorkbenchContrib+50,when:Rt.xt,primary:Rt.YD.Enter,mac:{primary:Rt.YD.Enter,secondary:[Rt.ZD.CtrlCmd|Rt.YD.DownArrow]},handler:e=>{let t=e.get(Rt.wt).lastFocusedList;!t||!(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt)||Dm(t,e=>t.setSelection([e]))}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.selectAndPreserveFocus",weight:Rt.mb.WorkbenchContrib,when:Rt.st,handler:e=>{xm(e,!0)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.selectAll",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,Rt.pt),primary:Rt.ZD.CtrlCmd|Rt.YD.KeyA,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(t instanceof Rt.ra||t instanceof Rt.rn||t instanceof Rt.Wt){let e=t,i=new KeyboardEvent("keydown");e.setSelection((0,Rt.tN)(e.length),i)}else if(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt){let e,i,o=t,s=o.getFocus(),r=o.getSelection();s.length>0&&(0===r.length||!r.includes(s[0]))&&(e=s[0]),!e&&r.length>0&&(e=r[0]),i=e?o.getParentElement(e):void 0;let n=[],a=e=>{for(let t of e.children)t.visible&&(n.push(t.element),t.collapsed||a(t))};a(o.getNode(i)),i&&r.length===n.length&&n.unshift(i);let d=new KeyboardEvent("keydown");o.setSelection(n,d)}}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.toggleSelection",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.ZD.CtrlCmd|Rt.ZD.Shift|Rt.YD.Enter,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(!t)return;let i=t.getFocus();if(0===i.length)return;let o=t.getSelection(),s=o.indexOf(i[0]);s>-1?t.setSelection([...o.slice(0,s),...o.slice(s+1)]):t.setSelection([...o,i[0]])}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.showHover",weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyI),when:Rt.st,handler:async e=>{var t;let i=e.get(Rt.wt).lastFocusedList;if(!i)return;let o=i.getFocus();if(!o||0===o.length)return;let s=null===(t=i.getHTMLElement().querySelector(".monaco-scrollable-element"))||void 0===t||null===(t=t.querySelector(".monaco-list-rows"))||void 0===t?void 0:t.querySelector(".focused");if(!s)return;let r=function(e){if(e.matches('[custom-hover="true"]'))return e;let t=e.querySelector('[custom-hover="true"]:not([tabindex]):not(.action-item)');if(t)return t}(s);r&&e.get(Rt.sr).showManagedHover(r)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.toggleExpand",weight:Rt.mb.WorkbenchContrib,when:Rt.st,primary:Rt.YD.Space,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt){let e=t,i=e.getFocus();if(!e.options.disableExpandOnSpacebar&&i.length>0&&e.isCollapsible(i[0]))return void e.toggleCollapsed(i[0])}xm(e,!0)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.stickyScrolltoggleExpand",weight:Rt.mb.WorkbenchContrib+50,when:Rt.xt,primary:Rt.YD.Space,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;!t||!(t instanceof Rt.Ht||t instanceof Rt.Rt||t instanceof Rt.Bt)||Dm(t)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.clear",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,Rt.ct),primary:Rt.YD.Escape,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(!t)return;let i=t.getSelection(),o=new KeyboardEvent("keydown");if(i.length>1)if(Rt.dt.getValue(t.contextKeyService)){let e=t.getFocus();t.setSelection([e[0]],o)}else t.setSelection([],o);else t.setSelection([],o),t.setFocus([],o);t.setAnchor(void 0)}}),Rt.xb.registerCommand({id:"list.triggerTypeNavigation",handler:e=>{var t;null===(t=e.get(Rt.wt).lastFocusedList)||void 0===t||t.triggerTypeNavigation()}}),Rt.xb.registerCommand({id:"list.toggleFindMode",handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(t instanceof Rt.ln||t instanceof Rt.Bt){let e=t;e.findMode=e.findMode===Rt.dn.Filter?Rt.dn.Highlight:Rt.dn.Filter}}}),Rt.xb.registerCommand({id:"list.toggleFindMatchType",handler:e=>{let t=e.get(Rt.wt).lastFocusedList;if(t instanceof Rt.ln||t instanceof Rt.Bt){let e=t;e.findMatchType=e.findMatchType===Rt.un.Contiguous?Rt.un.Fuzzy:Rt.un.Contiguous}}}),Rt.xb.registerCommandAlias("list.toggleKeyboardNavigation","list.triggerTypeNavigation"),Rt.xb.registerCommandAlias("list.toggleFilterOnType","list.toggleFindMode"),Rt.hb.registerCommandAndKeybindingRule({id:"list.find",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.rt,Rt.ft),primary:Rt.ZD.CtrlCmd|Rt.ZD.Alt|Rt.YD.KeyF,secondary:[Rt.YD.F3],handler:e=>{let t=e.get(Rt.wt).lastFocusedList;t instanceof Rt.ra||t instanceof Rt.rn||t instanceof Rt.Wt||(t instanceof Rt.ln||t instanceof Rt.Bt)&&t.openFind()}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.closeFind",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.rt,Rt.bt),primary:Rt.YD.Escape,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;(t instanceof Rt.ln||t instanceof Rt.Bt)&&t.closeFind()}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.scrollUp",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,null===Rt.ut||void 0===Rt.ut?void 0:Rt.ut.negate()),primary:Rt.ZD.CtrlCmd|Rt.YD.UpArrow,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;t&&(t.scrollTop-=10)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.scrollDown",weight:Rt.mb.WorkbenchContrib,when:Rt.PO.and(Rt.st,null===Rt.lt||void 0===Rt.lt?void 0:Rt.lt.negate()),primary:Rt.ZD.CtrlCmd|Rt.YD.DownArrow,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;t&&(t.scrollTop+=10)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.scrollLeft",weight:Rt.mb.WorkbenchContrib,when:Rt.st,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;t&&(t.scrollLeft-=10)}}),Rt.hb.registerCommandAndKeybindingRule({id:"list.scrollRight",weight:Rt.mb.WorkbenchContrib,when:Rt.st,handler:e=>{let t=e.get(Rt.wt).lastFocusedList;t&&(t.scrollLeft+=10)}}),(0,Rt.pb)(class extends Rt.ob{constructor(){super({id:"tree.toggleStickyScroll",title:(0,xt.A)((0,xt.A)({},(0,Rt.Lj)(2903,"Toggle Tree Sticky Scroll")),{},{mnemonicTitle:(0,Rt.Ij)(2904,"&&Toggle Tree Sticky Scroll")}),category:"View",metadata:{description:(0,Rt.Ij)(2905,"Toggles Sticky Scroll widget at the top of tree structures such as the File Explorer and Debug variables View.")},f1:!0})}run(e){let t=e.get(Rt.o_),i=!t.getValue("workbench.tree.enableStickyScroll");t.updateValue("workbench.tree.enableStickyScroll",i)}}),(0,Rt.Fj)(),(0,Pt.Q)(),(0,Pt.G)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Rt.db)(),(0,Mt.c)(),(0,Rt.tO)(),(0,Pt.At)(),(0,Nt.wt)(),(0,Wt.Df)(),(0,Rt.gb)(),(0,Rt.qx)(),(0,Rt.gE)();var Vm=class extends Rt.ob{constructor(e,t){super(e),this.direction=t}run(e){let t,i=e.get(Nt.Z),o=e.get(Pt.W),s=e.get(Nt.Ct),r=i.hasFocus(Nt.I.EDITOR_PART),n=i.hasFocus(Nt.I.PANEL_PART),a=i.hasFocus(Nt.I.SIDEBAR_PART),d=i.hasFocus(Nt.I.AUXILIARYBAR_PART);if(r){if(this.navigateAcrossEditorGroup(this.toGroupDirection(this.direction),o))return;t=i.getVisibleNeighborPart(Nt.I.EDITOR_PART,this.direction)}n&&(t=i.getVisibleNeighborPart(Nt.I.PANEL_PART,this.direction)),a&&(t=i.getVisibleNeighborPart(Nt.I.SIDEBAR_PART,this.direction)),d&&(t=t=i.getVisibleNeighborPart(Nt.I.AUXILIARYBAR_PART,this.direction)),t===Nt.I.EDITOR_PART?this.navigateBackToEditorGroup(this.toGroupDirection(this.direction),o)||this.navigateToEditorGroup(this.direction===wi.Right?Pt.q.FIRST:Pt.q.LAST,o):t===Nt.I.SIDEBAR_PART?this.navigateToSidebar(i,s):t===Nt.I.PANEL_PART?this.navigateToPanel(i,s):t===Nt.I.AUXILIARYBAR_PART&&this.navigateToAuxiliaryBar(i,s)}async navigateToPanel(e,t){if(!e.isVisible(Nt.I.PANEL_PART))return!1;let i=t.getActivePaneComposite(Wt.Sf.Panel);if(!i)return!1;let o=i.getId();return await t.openPaneComposite(o,Wt.Sf.Panel,!0)||!1}async navigateToSidebar(e,t){if(!e.isVisible(Nt.I.SIDEBAR_PART))return!1;let i=t.getActivePaneComposite(Wt.Sf.Sidebar);if(!i)return!1;let o=i.getId();return!!await t.openPaneComposite(o,Wt.Sf.Sidebar,!0)}async navigateToAuxiliaryBar(e,t){if(!e.isVisible(Nt.I.AUXILIARYBAR_PART))return!1;let i=t.getActivePaneComposite(Wt.Sf.AuxiliaryBar);if(!i)return!1;let o=i.getId();return await t.openPaneComposite(o,Wt.Sf.AuxiliaryBar,!0)||!1}navigateAcrossEditorGroup(e,t){return this.doNavigateToEditorGroup({direction:e},t)}navigateToEditorGroup(e,t){return this.doNavigateToEditorGroup({location:e},t)}navigateBackToEditorGroup(e,t){if(!t.activeGroup)return!1;let i=this.toOppositeDirection(e);return!t.findGroup({direction:i},t.activeGroup)&&(t.activeGroup.focus(),!0)}toGroupDirection(e){switch(e){case wi.Down:return Pt.K.DOWN;case wi.Left:return Pt.K.LEFT;case wi.Right:return Pt.K.RIGHT;case wi.Up:return Pt.K.UP}}toOppositeDirection(e){switch(e){case Pt.K.UP:return Pt.K.DOWN;case Pt.K.RIGHT:return Pt.K.LEFT;case Pt.K.LEFT:return Pt.K.RIGHT;case Pt.K.DOWN:return Pt.K.UP}}doNavigateToEditorGroup(e,t){let i=t.findGroup(e,t.activeGroup);return!!i&&(i.focus(),!0)}};(0,Rt.pb)(class extends Vm{constructor(){super({id:"workbench.action.navigateLeft",title:(0,Rt.Lj)(2906,"Navigate to the View on the Left"),category:Mt.s.View,f1:!0},wi.Left)}}),(0,Rt.pb)(class extends Vm{constructor(){super({id:"workbench.action.navigateRight",title:(0,Rt.Lj)(2907,"Navigate to the View on the Right"),category:Mt.s.View,f1:!0},wi.Right)}}),(0,Rt.pb)(class extends Vm{constructor(){super({id:"workbench.action.navigateUp",title:(0,Rt.Lj)(2908,"Navigate to the View Above"),category:Mt.s.View,f1:!0},wi.Up)}}),(0,Rt.pb)(class extends Vm{constructor(){super({id:"workbench.action.navigateDown",title:(0,Rt.Lj)(2909,"Navigate to the View Below"),category:Mt.s.View,f1:!0},wi.Down)}});var Rm=class extends Rt.ob{constructor(e,t){super(e),this.focusNext=t}run(e){let t=e.get(Nt.Z),i=e.get(Pt.kt);this.focusNextOrPreviousPart(t,i,this.focusNext)}findVisibleNeighbour(e,t,i){let o,s=(0,Rt.Ex)();if((0,Rt._E)(s))if(t===Nt.I.EDITOR_PART)o=Nt.I.STATUSBAR_PART;else o=Nt.I.EDITOR_PART;else switch(t){case Nt.I.EDITOR_PART:o=i?Nt.I.PANEL_PART:Nt.I.SIDEBAR_PART;break;case Nt.I.PANEL_PART:o=i?Nt.I.AUXILIARYBAR_PART:Nt.I.EDITOR_PART;break;case Nt.I.AUXILIARYBAR_PART:o=i?Nt.I.STATUSBAR_PART:Nt.I.PANEL_PART;break;case Nt.I.STATUSBAR_PART:o=i?Nt.I.ACTIVITYBAR_PART:Nt.I.AUXILIARYBAR_PART;break;case Nt.I.ACTIVITYBAR_PART:o=i?Nt.I.SIDEBAR_PART:Nt.I.STATUSBAR_PART;break;case Nt.I.SIDEBAR_PART:o=i?Nt.I.EDITOR_PART:Nt.I.ACTIVITYBAR_PART;break;default:o=Nt.I.EDITOR_PART}return e.isVisible(o,s)||o===Nt.I.EDITOR_PART?o:this.findVisibleNeighbour(e,o,i)}focusNextOrPreviousPart(e,t,i){var o;let s;null!==(o=t.activeEditorPane)&&void 0!==o&&o.hasFocus()||e.hasFocus(Nt.I.EDITOR_PART)?s=Nt.I.EDITOR_PART:e.hasFocus(Nt.I.ACTIVITYBAR_PART)?s=Nt.I.ACTIVITYBAR_PART:e.hasFocus(Nt.I.STATUSBAR_PART)?s=Nt.I.STATUSBAR_PART:e.hasFocus(Nt.I.SIDEBAR_PART)?s=Nt.I.SIDEBAR_PART:e.hasFocus(Nt.I.AUXILIARYBAR_PART)?s=Nt.I.AUXILIARYBAR_PART:e.hasFocus(Nt.I.PANEL_PART)&&(s=Nt.I.PANEL_PART),e.focusPart(s?this.findVisibleNeighbour(e,s,i):Nt.I.EDITOR_PART,(0,Rt.Ex)())}};(0,Rt.pb)(class extends Rm{constructor(){super({id:"workbench.action.focusNextPart",title:(0,Rt.Lj)(2910,"Focus Next Part"),category:Mt.s.View,f1:!0,keybinding:{primary:Rt.YD.F6,weight:Rt.mb.WorkbenchContrib}},!0)}}),(0,Rt.pb)(class extends Rm{constructor(){super({id:"workbench.action.focusPreviousPart",title:(0,Rt.Lj)(2911,"Focus Previous Part"),category:Mt.s.View,f1:!0,keybinding:{primary:Rt.ZD.Shift|Rt.YD.F6,weight:Rt.mb.WorkbenchContrib}},!1)}}),(0,Rt.Fj)(),(0,Rt.ss)(),(0,Rt.za)(),(0,Wt.S_)(),(0,Rt.iT)(),(0,Rt.zk)(),(0,Pt.ot)(),(0,Rt.Sb)(),(0,Rt.wb)(),(0,Rt.ac)(),(0,Rt.Xa)(),(0,Rt.Sc)(),(0,Mt.o)(),(0,Rt.Bb)(),(0,Rt.lv)(),(0,Rt.Ll)(),(0,Rt.TD)(),(0,Rt.yT)(),(0,Wt.Dx)(),(0,Pt.j)();var Tm="addRootFolder",Lm=(0,Rt.Lj)(2976,"Add Folder to Workspace..."),Wm="setRootFolder",Fm="_workbench.pickWorkspaceFolder";async function Gm(e){let t=e.get(Rt.Il),i=e.get(Pt.A);return await t.showOpenDialog({openLabel:(0,Pt.st)((0,Rt.Ij)(2977,"&&Add")),title:(0,Rt.Ij)(2978,"Add Folder to Workspace"),canSelectFolders:!0,canSelectMany:!0,defaultUri:await t.defaultFolderPath(),availableFileSystems:[i.defaultUriScheme]})}Rt.xb.registerCommand({id:"workbench.action.files.openFileFolderInNewWindow",handler:e=>e.get(Rt.Il).pickFileFolderAndOpen({forceNewWindow:!0})}),Rt.xb.registerCommand({id:"_files.pickFolderAndOpen",handler:(e,t)=>e.get(Rt.Il).pickFolderAndOpen(t)}),Rt.xb.registerCommand({id:"workbench.action.files.openFolderInNewWindow",handler:e=>e.get(Rt.Il).pickFolderAndOpen({forceNewWindow:!0})}),Rt.xb.registerCommand({id:"workbench.action.files.openFileInNewWindow",handler:e=>e.get(Rt.Il).pickFileAndOpen({forceNewWindow:!0})}),Rt.xb.registerCommand({id:"workbench.action.openWorkspaceInNewWindow",handler:e=>e.get(Rt.Il).pickWorkspaceAndOpen({forceNewWindow:!0})}),Rt.xb.registerCommand({id:Tm,handler:async e=>{let t=e.get(Wt.x_),i=await Gm(e);(null===i||void 0===i?void 0:i.length)&&await t.addFolders(i.map(e=>({uri:e})))}}),Rt.xb.registerCommand({id:Wm,handler:async e=>{let t=e.get(Wt.x_),i=e.get(Rt.Ra),o=await Gm(e);(null===o||void 0===o?void 0:o.length)&&await t.updateFolders(0,i.getWorkspace().folders.length,o.map(e=>({uri:e})))}}),Rt.xb.registerCommand(Fm,async function(e,t){let i=e.get(Rt.xc),o=e.get(Rt.Ya),s=e.get(Rt.Ra),r=e.get(Rt.zb),n=e.get(Rt.cv),a=s.getWorkspace().folders;if(!a.length)return;let d=a.map(e=>{let t=e.name,i=o.getUriLabel((0,Rt.Qw)(e.uri),{relative:!0});return{label:t,description:i===t?void 0:i,folder:e,iconClasses:(0,Mt.i)(r,n,e.uri,Rt.Ms.ROOT_FOLDER)}}),l=(t?t[0]:void 0)||Object.create(null);l.activeItem||(l.activeItem=d[0]),l.placeHolder||(l.placeHolder=(0,Rt.Ij)(2979,"Select workspace folder")),"boolean"!=typeof l.matchOnDescription&&(l.matchOnDescription=!0);let c=(t?t[1]:void 0)||Rt.Ik.None,h=await i.pick(d,l,c);return h?a[d.indexOf(h)]:void 0}),Rt.xb.registerCommand({id:"vscode.openFolder",handler:(e,t,i)=>{var o,s,r,n,a,d,l,c;let h=e.get(Rt.Cb);if("boolean"==typeof i&&(i={forceNewWindow:i}),!t){var u,g;let e={forceNewWindow:null===(u=i)||void 0===u?void 0:u.forceNewWindow};return null!==(g=i)&&void 0!==g&&g.forceLocalWindow&&(e.remoteAuthority=null,e.availableFileSystems=["file"]),h.executeCommand("_files.pickFolderAndOpen",e)}let p=Rt.wD.from(t,!0),b={forceNewWindow:null===(o=i)||void 0===o?void 0:o.forceNewWindow,forceReuseWindow:null===(s=i)||void 0===s?void 0:s.forceReuseWindow,noRecentEntry:null===(r=i)||void 0===r?void 0:r.noRecentEntry,remoteAuthority:null!==(n=i)&&void 0!==n&&n.forceLocalWindow?null:void 0,forceProfile:null===(a=i)||void 0===a?void 0:a.forceProfile,forceTempProfile:null===(d=i)||void 0===d?void 0:d.forceTempProfile},m=(0,Rt.os)(p)||p.scheme===Rt.vT.untitled?{workspaceUri:p}:{folderUri:p},v=null!==(l=null===(c=i)||void 0===c||null===(c=c.filesToOpen)||void 0===c?void 0:c.map(e=>({fileUri:Rt.wD.from(e,!0)})))&&void 0!==l?l:[];return h.executeCommand("_files.windowOpen",[m,...v],b)},metadata:{description:"Open a folder or workspace in the current window or new window depending on the newWindow argument. Note that opening in the same window will shutdown the current extension host process and start a new one on the given folder/workspace unless the newWindow parameter is set to true.",args:[{name:"uri",description:"(optional) Uri of the folder or workspace file to open. If not provided, a native dialog will ask the user for the folder",constraint:e=>null==e||e instanceof Rt.wD},{name:"options",description:"(optional) Options. Object with the following properties: `forceNewWindow`: Whether to open the folder/workspace in a new window or the same. Defaults to opening in the same window. `forceReuseWindow`: Whether to force opening the folder/workspace in the same window.  Defaults to false. `noRecentEntry`: Whether the opened URI will appear in the 'Open Recent' list. Defaults to false. `forceLocalWindow`: Whether to force opening the folder/workspace in a local window. Defaults to false. `forceProfile`: The profile to use when opening the folder/workspace. Defaults to the current profile. `forceTempProfile`: Whether to use a temporary profile when opening the folder/workspace. Defaults to false. `filesToOpen`: An array of files to open in the new window. Defaults to an empty array. Note, for backward compatibility, options can also be of type boolean, representing the `forceNewWindow` setting.",constraint:e=>void 0===e||"object"==typeof e||"boolean"==typeof e}]}}),Rt.xb.registerCommand({id:"vscode.newWindow",handler:(e,t)=>{let i=e.get(Rt.Cb),o={forceReuseWindow:null===t||void 0===t?void 0:t.reuseWindow,remoteAuthority:null===t||void 0===t?void 0:t.remoteAuthority};return i.executeCommand("_files.newWindow",o)},metadata:{description:"Opens an new window depending on the newWindow argument.",args:[{name:"options",description:"(optional) Options. Object with the following properties: `reuseWindow`: Whether to open a new window or the same. Defaults to opening in a new window. ",constraint:e=>void 0===e||"object"==typeof e}]}}),Rt.xb.registerCommand("_workbench.removeFromRecentlyOpened",function(e,t){return e.get(Wt.Ex).removeRecentlyOpened([t])}),Rt.xb.registerCommand({id:"vscode.removeFromRecentlyOpened",handler:(e,t)=>{let i=e.get(Wt.Ex);return t="string"==typeof t?t.match(/^[^:/?#]+:\/\//)?Rt.wD.parse(t):Rt.wD.file(t):Rt.wD.revive(t),i.removeRecentlyOpened([t])},metadata:{description:"Removes an entry with the given path from the recently opened list.",args:[{name:"path",description:"URI or URI string to remove from recently opened.",constraint:e=>"string"==typeof e||e instanceof Rt.wD}]}}),Rt.xb.registerCommand("_workbench.addToRecentlyOpened",async function(e,t){let i,o=e.get(Wt.Ex),s=t.uri,r=t.label,n=t.remoteAuthority;return i="workspace"===t.type?{workspace:await o.getWorkspaceIdentifier(s),label:r,remoteAuthority:n}:"folder"===t.type?{folderUri:s,label:r,remoteAuthority:n}:{fileUri:s,label:r,remoteAuthority:n},o.addRecentlyOpened([i])}),Rt.xb.registerCommand("_workbench.getRecentlyOpened",async function(e){return e.get(Wt.Ex).getRecentlyOpened()}),(0,Rt.Fj)(),(0,Rt.ss)(),(0,Rt.za)(),(0,Wt.S_)(),(0,Pt.At)(),(0,Rt.wb)(),(0,Rt.Ll)(),(0,Rt.db)(),(0,Nt.ir)(),(0,Lt.F)(),(0,Rt.tO)(),(0,Rt.IO)(),(0,Pt.k)(),(0,Wt.Dx)(),(0,Rt.gb)(),(0,Rt.Lt)(),(0,Mt.c)();var Zm=(0,Rt.Lj)(2957,"Workspaces"),Nm=(Ct=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2958,"Open File..."),category:Mt.s.File,f1:!0,keybinding:{when:Rt.Mt.toNegated(),weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.KeyO}})}async run(e,t){return e.get(Rt.Il).pickFileAndOpen({forceNewWindow:!1,telemetryExtraData:t})}},{_:Ct.ID="workbench.action.files.openFile"},Ct),Pm=(wt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2959,"Open Folder..."),category:Mt.s.File,f1:!0,precondition:Nt.Pn,keybinding:{weight:Rt.mb.WorkbenchContrib,primary:void 0,linux:{primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyO)},win:{primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.ZD.CtrlCmd|Rt.YD.KeyO)}}})}async run(e,t){return e.get(Rt.Il).pickFolderAndOpen({forceNewWindow:!1,telemetryExtraData:t})}},{_:wt.ID="workbench.action.files.openFolder"},wt),Jm=(yt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2959,"Open Folder..."),category:Mt.s.File,f1:!0,precondition:Rt.PO.and(Nt.Pn.toNegated(),Nt.er.isEqualTo("workspace")),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.KeyO}})}run(e){return e.get(Rt.Cb).executeCommand(Wm)}},{_:yt.ID="workbench.action.files.openFolderViaWorkspace"},yt),Bm=(ft=class e extends Rt.ob{constructor(){super({id:e.ID,title:e.LABEL,category:Mt.s.File,f1:!0,precondition:Rt.PO.and(Rt.Mt,Nt.Pn),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:Rt.ZD.CtrlCmd|Rt.YD.KeyO}})}async run(e,t){return e.get(Rt.Il).pickFileFolderAndOpen({forceNewWindow:!1,telemetryExtraData:t})}},{_:ft.ID="workbench.action.files.openFileFolder"},{_:ft.LABEL=(0,Rt.Lj)(2960,"Open...")},ft),Om=(St=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2961,"Open Workspace from File..."),category:Mt.s.File,f1:!0,precondition:Nt.vn})}async run(e,t){return e.get(Rt.Il).pickWorkspaceAndOpen({telemetryExtraData:t})}},{_:St.ID="workbench.action.openWorkspace"},St),Km=(It=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2962,"Close Workspace"),category:Zm,f1:!0,precondition:Rt.PO.and(Nt.er.notEqualsTo("empty"),Nt._n),keybinding:{weight:Rt.mb.WorkbenchContrib,primary:(0,Rt.JD)(Rt.ZD.CtrlCmd|Rt.YD.KeyK,Rt.YD.KeyF)}})}async run(e){let t=e.get(Lt.P),i=e.get(Pt.O);return t.openWindow({forceReuseWindow:!0,remoteAuthority:i.remoteAuthority})}},{_:It.ID="workbench.action.closeFolder"},It),Mm=(kt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2963,"Open Workspace Configuration File"),category:Zm,f1:!0,precondition:Nt.er.isEqualTo("workspace")})}async run(e){let t=e.get(Rt.Ra),i=e.get(Pt.kt),o=t.getWorkspace().configuration;o&&await i.openEditor({resource:o,options:{pinned:!0}})}},{_:kt.ID="workbench.action.openWorkspaceConfigFile"},kt),jm=(_t=class e extends Rt.ob{constructor(){super({id:e.ID,title:Lm,category:Zm,f1:!0,precondition:Rt.PO.or(Nt.vn,Nt.er.isEqualTo("workspace"))})}run(e){return e.get(Rt.Cb).executeCommand(Tm)}},{_:_t.ID="workbench.action.addRootFolder"},_t),Qm=(Et=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2964,"Remove Folder from Workspace..."),category:Zm,f1:!0,precondition:Rt.PO.and(Nt.tr.notEqualsTo("0"),Rt.PO.or(Nt.vn,Nt.er.isEqualTo("workspace")))})}async run(e){let t=e.get(Rt.Cb),i=e.get(Wt.x_),o=await t.executeCommand(Fm);o&&await i.removeFolders([o.uri])}},{_:Et.ID="workbench.action.removeRootFolder"},Et),Ym=(At=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2965,"Save Workspace As..."),category:Zm,f1:!0,precondition:Nt.vn})}async run(e){let t=e.get(Wt.x_),i=e.get(Rt.Ra),o=await t.pickNewWorkspacePath();if(o&&(0,Rt.os)(o))switch(i.getWorkbenchState()){case Rt.rs.EMPTY:case Rt.rs.FOLDER:{let e=i.getWorkspace().folders.map(e=>({uri:e.uri}));return t.createAndEnterWorkspace(e,o)}case Rt.rs.WORKSPACE:return t.saveAndEnterWorkspace(o)}}},{_:At.ID="workbench.action.saveWorkspaceAs"},At),Hm=(Dt=class e extends Rt.ob{constructor(){super({id:e.ID,title:(0,Rt.Lj)(2966,"Duplicate As Workspace in New Window"),category:Zm,f1:!0,precondition:Nt.vn})}async run(e){let t=e.get(Rt.Ra),i=e.get(Wt.x_),o=e.get(Lt.P),s=e.get(Wt.Ex),r=e.get(Pt.O),n=t.getWorkspace().folders,a=r.remoteAuthority,d=await s.createUntitledWorkspace(n,a);return await i.copyWorkspaceSettings(d),o.openWindow([{workspaceUri:d.configPath}],{forceNewWindow:!0,remoteAuthority:a})}},{_:Dt.ID="workbench.action.duplicateWorkspaceInNewWindow"},Dt);(0,Rt.pb)(jm),(0,Rt.pb)(Qm),(0,Rt.pb)(Nm),(0,Rt.pb)(Pm),(0,Rt.pb)(Jm),(0,Rt.pb)(Bm),(0,Rt.pb)(Om),(0,Rt.pb)(Mm),(0,Rt.pb)(Km),(0,Rt.pb)(Ym),(0,Rt.pb)(Hm),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"2_open",command:{id:Nm.ID,title:(0,Rt.Ij)(2967,"&&Open File...")},order:1,when:Rt.Mt.toNegated()}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"2_open",command:{id:Pm.ID,title:(0,Rt.Ij)(2968,"Open &&Folder...")},order:2,when:Nt.Pn}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"2_open",command:{id:Jm.ID,title:(0,Rt.Ij)(2968,"Open &&Folder...")},order:2,when:Rt.PO.and(Nt.Pn.toNegated(),Nt.er.isEqualTo("workspace"))}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"2_open",command:{id:Bm.ID,title:(0,Rt.Ij)(2969,"&&Open...")},order:1,when:Rt.PO.and(Rt.Mt,Nt.Pn)}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"2_open",command:{id:Om.ID,title:(0,Rt.Ij)(2970,"Open Wor&&kspace from File...")},order:3,when:Nt.vn}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"3_workspace",command:{id:Tm,title:(0,Rt.Ij)(2971,"A&&dd Folder to Workspace...")},when:Rt.PO.or(Nt.vn,Nt.er.isEqualTo("workspace")),order:1}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"3_workspace",command:{id:Ym.ID,title:(0,Rt.Ij)(2972,"Save Workspace As...")},order:2,when:Nt.vn}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"3_workspace",command:{id:Hm.ID,title:(0,Rt.Ij)(2973,"Duplicate Workspace")},order:3,when:Nt.vn}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"6_close",command:{id:Km.ID,title:(0,Rt.Ij)(2974,"Close &&Folder")},order:3,when:Rt.PO.and(Nt.er.isEqualTo("folder"),Nt._n)}),Rt.lb.appendMenuItem(Rt.sb.MenubarFileMenu,{group:"6_close",command:{id:Km.ID,title:(0,Rt.Ij)(2975,"Close &&Workspace")},order:3,when:Rt.PO.and(Nt.er.isEqualTo("workspace"),Nt._n)});var Xm,Um={"vs/workbench/contrib/debug/browser/media/continue-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIxSURBVHgB7dlNbtNAGMbxZyaUBSuOYHOBYlYskEhPwscFoKsqIBRHCCKyKNADQLkAR0jCiqBIhH6wAim+AWyAVKlnmDdKJUNTimT7nVm8v13SStGjfyauG0AIIYQQQgghBKPu5HGzO0kjBEahYjRUN3QbFk33MHMvkW6tP3iDQFQ6eDFW68GpF1HYzfN5p5WkGTzTYGAtbmu9Nni29/QWPGMZvBS56bu9/SevfZ5tzsELvmvXO1jZoTGms+Inka/atRduJY9SY3SMxSf2n5a1+5y1Wd7SraSVba0/jM+oHXPWZj3DIdRm/9DyXZt98Alftb0NJlT7ornEWtvrYLKZbOL61RtU+woYansfTDbUBtWectQOYvCJ/6nd0GtvUUJQg8l5tS1wGSUEN5gM7ABHmMXuvvomKnYBAaGhB18PMN4f3dfatN1b+FRNdwP/DSUEM3j7cFt9+DSKVMO8cg+bK37F7Tcvf5m8gxK8D6aqH/feq+P86N4ZVd2xRebO8x33x8o7lOT1DO982YGrGh9r23f1nq/4QFpWnV+rYizxUpiqjj+P1eznD5aqReyDqerIVdXnnNWZO6tpkn5HxdgGF6s2mKsWsQz2XbWo9sG9w96/qpJp3VWL6h1sVWTNvA/PVYvqLhy5kxmteJ6q3nVVh2DGfR2mqi+W19UhPOC8LHmrWlRpYQNNZ3H619PeqxbV8HVpN9LI29CK/iWThVCVBQ1PJ2mpm3UhhBBCCCFEOH4DIKF0k8sm4ZEAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,"vs/workbench/contrib/debug/browser/media/pause-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADASURBVHgB7dmxDcIwEEbh3xGLMAIbgFiADWADKmqoEUPAJFY2YAOyBRUxR2GLjkgxzeV9VWLlFD+3lgAAAAAAmJ6gyg4x7ZW0KT8Iup5X4fZr7hiTntI2Je3ymj23l3U4qaKZKrNNLuwUl/n91asdMvc5+b7X3A6ozIZGD1XWaGII9o5g7wj2jmDvCPaOYO8I9o5g7wj2jmDvCPaO4NpGXG0k/UH1mwfbZmeVMb9acDdsrHwbv5bvAgAAAAAAo70BgzIgmYCKG/cAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,"vs/workbench/contrib/debug/browser/media/restart-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASRSURBVHgB7ZlPTxtHGMafGUNsStWEQ6QcTauemha76r1GvZf0CzQ410iBcgiCNGVpipE5ADnkWuMec4hoP4BNbtzstBwqVWq2UlUhBTUoqgv2emf6jg1lcW1iZsdWkeYnGbyz9s48nnnn/TOAxWKxWCwWi8VisXQBQx9ZKS0lfCAR4bjsCzHSbOUuINwq/LKTdPbRY7QEOyXnShS4cnxdBfY7DXa59CDFI5EpJmVKBr7TYTRbkGxDiNrTuaTjogcMQIMoItOc84Xj65jEBv1LBz/TEMp5jt7GISVkNw+WSNEf+t6gXPkps+jXa3nTwjkMs1xajmd/XCqS2CKUWD2YFNIh4YVM6cENGMSoYCWWc1FszlQHpCzThG+cvOQW2VUn2x2NcP6EZnsBhtBa0u1QGxJIbDs7VaKkZPkqvM12tp57nsPu/u8pDjYJzm623FazvUCicff9+UWERGvTIvt0gjbc3Gwayzfe8lFXCJGeS97fQhcUZRHb5e04h++0ES4h2Mxscn4dITCzpJtLOH66jW0eCC/ZrVjFOBvHXHLOHXrzrUlfyJmW2wxcrjZWUgiMb1pNZH42Mf+Zrl+98+4dXB4cWRMCt1puMcnxLULQC8HugahPIyS3r99GDG/kyCRa7TaRfZa5CU3M2HAAmpW0ipyCbWGiqJWdFSbqXoGxk52fBl26O3bvQ2hgfIY5R0754OAr+roI6wyuDl+lTV58HWwjT5BQgQ006JENmyM9mkZkMEpujTzBCYxxTEADLcEx+Mo1lNEnYtGYpFj8h2AbB/8YGmgJ/oLs8ZLwxo9+dbeLVyiuVa+hDrYVbFPLGhr0NT3URUoH62WM1Pjgn8FmIby3z5tc/O9tWMGYo9a1kVz5Qgg2yYURLKpdZdSv5UIIfrzzGIdS/meT0ikOXAjBu9FdymNlKtjGNN2ikXxY5bMvKy8bO/7M9Rkzay9A5a8KIz4NuhQB8RQahJphtdRUrEvJ+3jNr6x54nBVtZlE/ZhAPRWMpaE8lcAmNAgl2PV+SUjhFSheLlCyOkXDmKa2pEN+0xR7r/5g9PzWlNClPLv/MzwIz2USY8G2Rr5KQQIMkH2WZQJMZWXxYBdkwQ40CR1pZUrfTEc4Wzv1UIYNJi/d+uiDihzXHFv25yxD1ae8V+Zabv06O3bvHWgSepeeT365TjF1MdhG15OCeU+2yxh9tPMI50HVtVZ3MoxVxVQbsSqc/AQhMBJLH5VnC/R2tOWWS10ssshAfhjD8sV7L+B0mHG1Oe292mO+qMd5RK5REtya/tFSFouzY/dDVS6NJQ/NMi0KNKqRNr2oI5T8gah9PzQ0tM+rVJCNNbv2pY+BQx816acox71Bad/nbUq9RsQ2h2KQM2Y6SJmM3KVacyMZIHtP0CDiZ5w7GRPb6A+GaYiGv3BUVw7zfBXAHNe1tVxQO3qWDy+XliapvvUVmi7lPP1IdfRCx6kPqfj30PQRas8LANnGYRibYJxNBJZtsN9/Q1F1JMMZ2/xbeN/16qy47wfidF4SF6fKM/w52ehv/ToQt1gsFovFYrFYLJau+AfCNPXR3BjmUgAAAABJRU5ErkJggg==","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,"vs/workbench/contrib/debug/browser/media/run-with-debugging-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAUfSURBVHgB7ZpNTxtHGMefmbWTktICh1x66bqXXqpit5ccKmHovSVfoGCukUqJUlEaqixKE0Qb4RQpxwL9Amn6BWJzKlKl2Ea5VJXqvfVYU1xsx96ZPI+9gxdjwtpmd1G0Pwn2bWZ3/vOft2cAICQkJCQkJCQkJCTkQrKau5tczRk6XBAYeAQJ5Rq/AxKSeGnip4zF8W9/gYDxRPBa7u40cP7riY8x2Las+spSwjAhIDh4gAA+2u2+lDDLeTSzVrg/AwHhieAz0FH69g9797aC6NtBCG4SlNv+CGYyK4RY6fJE99tt3xxeSnxnCMFj0Byxj2O7/dQPt31t0kuJJXNx/HbsFLdjfrgdSB8O0u3ABq2g3A5MsOJa/BNy+z3wye3ABU+ySXK7eElc8cXtwAUrFhILvrh9YQQTfrjtkWCeBSGug5AUHZnQI27c1nj0MfRBBDyARmBoFfQJXVOoCD1CbiPFdC4dq0LZ4BxDTQcSYBT6wJcmjfNuFvogIzNQhWoM4+oJOCcGdlgF+kxCnGodA+ySZCyLFjwZJODf+GsD/tjbnde4MLAJn3ATv/Mv9MFADtPggU0tQ7saqok1j1JO0+Dy4979NPQIubqaW41VKgcZCeJht6ZL9w9F/VPoA1c7HlSIncLO2PDQcOnW+7fko+ePoCz20yjsK1UGJIuvM/FUZ4wl1btpl+PqW++kUrEUPPjzAasflt+9FgdzkhknvvGs8DuzGPsStxCMLkLxFpg4eqewi+xAn7gSTDXOuXiKhc/yy5fn6oe1Gc5hy35cxELMOfspptcpPTSnESy+EJPRK0M7olbbxOaZFKI+hds8RZV+/fk6e1Gv6UwTm/YeWCeYTfxUFdaKkTBKMACu+jBj4mc86DQdYKHJNV09swtvOtPTKI2ip1B0UxT1ccxnUv7WdZTeN0Xn5HqjWpvHtHe69NVzcdWJK8FS8jkU3XSMCs1Uu8DA/u3oVZOaeBfMg0Ypi2mTdh9XFIVVn1MXtcNaPMIh3fWz5+SqE1eCHY4dNdMWDP6rl1Kn5eMatDxqU+xsEVpUyzPLKjn67Lm76qSnbdrmFESjcp9QX+6ck1v99/8043wePHLVSY/zMNcdFxLcY1es1DsfvFndl3UtksXTz7xy1Ykrwbi8ax6rcHh0DxUsWEIUzsorgcU1ztKd76L1MvHPxwxG8lZ2X1gfeeWqE1eCaS1LR860cWUsiXWzZMRuAMpgrkU+r1pl3X5kNH+15mPPhSpcCW4v3HtpxV3AFRi+a9q+MiAA3PZhp9JB/h41YI0NjivBOJVQXIoL7wj+kazVHyMaG4Ee4Uxe//rD5d8gQFwFDzRv0s8laGyre5aUk4Y0XpmP1secs1l13bAaZw5yXtNjtDRCg0uezhjwGTwbOy0lVcZufhcXKWyilR7yb4yOmBAwrgXTdFLjFQNP4/at0SEt+nitsMYyHU5vFbeoWsY4BQPQWndj543XyxWD4twgcTUA0Vr5wNo3GEi1zSIdeU1aLvKhIVNjGjZ1C0TlBa3I1qFdOe30gt0cjo6kb3xwA4LAlcNla3/mmFghb+JRhXcYCkb/hlrjWaNS26QjiqU1txJblCBXQI3QXK7T+yAgXDZpkbRPpBAwt5hYfog7ilM4r9K/NaipJo6R0Sw4XEUy5P4348srlK+d9uh9vuN6Tl0rfL8lBNtZStzePnaf/p+DsS9ol8OOeEyUmhdSbnSuxFZz93AzXU4sji+nICQkJCQkJCTkdecljQujDnl0mKoAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,"vs/workbench/contrib/debug/browser/media/stepinto-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJRSURBVHgB7ZpNbtNAFMf/zzYCdnACcoQKLlCzYAviAvQIoFLEroUVUoXoCZpwBLYg6nKDcoLkBsmCL6luH/Ocpoqjtnbdea9S+n5SFI89mpmfx56PlwCO4ziO4ziODgRj1gtenU9/zGkfhmQwJmEUC6dMb3qCG4YLLzsuvOy48LLjwldl/Vt9JdWVzYLxuohT1jxRhd8U/CJJUWx85z6uwFbB9A/oE2NPykREoglLw5gxqBKEta7SIvsX2D1mrElJocx+TOkowi8LvhcauFM72UF6Qfa0pJD+JHUgAlGEd3KaUImcgUntwiWkz5FFKHNMhMdSByIQ7ZHefkIHXaWbZLdzOkAkog5aXaQtZadNUWDjK69whiIUXn/vZFCjulhCGFjJCmqb73OlG9CUFVSjDZeV1pYV1MMrbaUtZAWTeFKTtJWsYLJ5mBu9x4vXLGUF04jhSU/vzXpapi9LWcE8Lv224F5ZoifHWYbRh5xGcJxomD7Ssqmn26FOnqY5RbWu3MrtmmFWU1gz4xeQ0xGehoHqgZzjBD/CNPHlDjB8ZyRtUovI/glfYTO/ecZlmZZe3QU+W0irz8MNssJ9iWr8LrEKA9SFQ2yqd4HsDKIUu/KOa6MuXB7jWcusPYte1l9aElZaZ02mCxJN1IXD49w6FhWCAWMoo9/DjP22WcNo/RPKqAsfpZXwsCFbWJFgYLGuVheuwqslnp+1NTxBhuZhCryHAWb74YzwMBzKH1p49qluQujZQ8Ijq13TtW0Pw+9Gk8NbGMUKsDuO4ziO4zjXzX/ncxVIRDwWzgAAAABJRU5ErkJggg==","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,"vs/workbench/contrib/debug/browser/media/stepout-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJSSURBVHgB7ZpRbtNAEIb/cYIAqQ/tCQg3qOACOEi8Aj1BOQIPEbw14amoIHECKBcA8cpDDTeAEyQ3oA9AK9XpdsbxSlGUNk60M62i+aRIlr3S5vPYuzvjBRzHcRzHcRwdCMa8KkKnBDpy3AZGb3MawRBT4V4RtkNAwZ1u1qeOUSI/eEK/YEQGI+bICpsc5qPe97ANI0wifInsNH840l2LSKsLN5CNmEirCi8hG1GXVhNeQTaiKq0yaF0mG4DPs23nnNvSHMiSC18l+65Lu7PtNwgvLKWTCi8rK/RzCpbSyYRXkY1YSqeLcMDXWdnzgMEi2Ugtvcs3bTBzSaS/IBHphEs8D7JUrBHZ94+pjyVgaWxk6E9LBxm1CTtIRDJhmUaI18UivYpsZFpaZIl4isrTTVFJBy2RLgn3V5WNROk24UFKWcE8PewdceymOOiS6X8wy5ZuCi687rjwuuPC604b9gRcI+bCYYwuHEcN03XsXhFAt7nP+i0OLQQ6mSQLVpj11GfZv0BOYzzldOGenAsZfvI08e0OMBwYSZv0IrL/UeW4e3MuS8778i6Xdyyk1efhBbLCFl/79K/EIxigLnzKn0avkI0QtfBR3nFt1IXLczxr2LRjEWX9pSWhcYmVssmHck3UhflxPm7aNiOuUCqjH+GAH02b8mj9G8qoC49blfBwQTNekeBw32C/h7rwh5xkH8dOVVCfjwzNwxbwBgaY5MNSr5YaMx8WmAhWv/qrwuEZ4eG+0W4e87r0a9m2VKJDPJid3cKoegIcx3Ecx3GcNeAC4UEBaURTA6MAAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,"vs/workbench/contrib/debug/browser/media/stepover-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMnSURBVHgB7ZldTttAFIXPOA5Sfx5YgmEDzQ6agPpcdgB0BVQ09JHQp7a0aruBClZA+9qWOKygdAONl5BKhf4AuT0DQXKCG8cTzwik+SQLezzGc3zv3Dt3Ang8Ho/H4/F4PB4TFG4IrVjQA6J029uGSlAQp4LXYokqqUEHQO8ESDjwXt6zT2NRfUE/1SQnCvNFRYewiBY4AyyLoC5ATQlmR/tUeTTbkkDQUQE+vmyoD7CIFcHrsdQDwSYuhJ6T40oRO6zww6xo8Uphh9bffW7gsnkEKBG6XcQBxxQb87IOMyIKb50J2huxLKNkSrOwtioHuUdLzuZ0TVLn0Zh+cxS+s7Ev9/4GeMbrHyiBUgRrS+jBZd2jS/d47x3DTecsxOFogGp+khoqqPH0Id166crzCo+rnBp/FBarmJ6po/TGF1mSAHsZt/RcbDEI7WICdNr5TYuf0p05qCxXPuRRS10bRempBOs5Szf+esWNadGTAK1J0s0omxR+dIqGquA9xru8keCpghbzYjwqlm1b24tqzUSsZquhcDdEHCgsYHi+l4Kx4Oa+rGDEAlrs60XVwpS0KPoW0NWidQxAiZgHLcU8O0xiIjZryagZqJSqwhanyBuUhJHgdQYqjAyS1mjAgGN+uhlODRk/XzMJT8+fSQo8YubSnLdD6YOD7bywsCrKIQnD4nPcTHCA+0P/RGXnYIt0K5zfJkvPwoJZEOioHKXbaOFvcIexWE3hPNyMuTJi7k23bS+oG1NXFw5aun7lUm/18lpJuWnD4/F4xuE8uupq6PKlevtHFwsucfY2LfQX39fXWz/9wcIlwAEXAh0WCuJKuJO3nNe4YI0rmTVuImdYvROi40J0qZt4/2Mgto3sAiFisd9m0V+HA6x/Um3dY0EX+dVQ9zZ3MGxb2bqFjy62a6MJukY/HVjZumDpTyxCsQqbtK8x1gUXcFAZHFaxH7S4H22lryFO0hJ/fvnOP3M53bosM+dhGSdpiXn2Eca7q+hcDAc4EfzqgepQkN5n1ukpLVyfd3mvwT4HcIDztfSTz1LHZTTmnNUfAx6Px+PxeDwej8dz3fgHnygaDf8DyT4AAAAASUVORK5CYII=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,"vs/workbench/contrib/debug/browser/media/stop-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADLSURBVHgB7dkxDoJAEEbhf4ml3gFvwpGsNFSWxEqPxEmMdzDRRHRXSGjsZIEQhvclhJaXHZodCQAAAAD+4BThXuwyeWWaUqJyk19KdbRSjDrWJe6oCQUfmlepjhItzOKC40b6122dn7ca2bM4uI9eXj0x0tYRbB3B1hFsHcHWEWwdwdYRbB3B1hFsHcHWEWzdEBfxepz2UUu5LqrwdklQb0MEp95XV41sqFEc5IRrqWZirv9waJ/O4k64Xka3+9mphOYbBAAAAABj+QJmPCRPyVBXxgAAAABJRU5ErkJggg==","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href};function zm(e){return null!=e&&(Xm=e),(0,xt.A)((0,xt.A)({},{[Rt.jo.toString()]:new Rt.om(zl,[],!0)}),{},{[Wt.T_.toString()]:new Rt.om(Al,[],!1),[Wt.dx.toString()]:new Rt.om(vd,[],!0),[Tt.Rn.toString()]:new Rt.om(ia,[],!0),[Nt.Ct.toString()]:new Rt.om(bl,[],!0),[Rt.Vb.toString()]:new Rt.om(Zt.f,[],!0),[Zt.u.toString()]:new Rt.om(zt.c,[],!1),[Lt.I.toString()]:new Rt.om(wd,[],!1),[Tt.Kn.toString()]:new Rt.om(uo,[],!0),[Rt.Cl.toString()]:new Rt.om(Rt.Tc,[],!0),[Pt.w.toString()]:new Rt.om(fd,[],!0),[Tt.On.toString()]:new Rt.om(kd,[],!1),[Wt.jb.toString()]:new Rt.om(Od,[],!0),[Wt.$v.toString()]:new Rt.om(ll,[],!0),[Wt.Yv.toString()]:new Rt.om(hl,[],!0),[Wt.Zv.toString()]:new Rt.om(Wt.Ji,[],!0),[Rt.qa.toString()]:new Rt.om(pl,[],!0),[Tt.Pn.toString()]:new Rt.om(_l,[],!0),[Pt.H.toString()]:new Rt.om(Rl,[],!0),[Lt.R.toString()]:new Rt.om(Tt.wt,[],!0),[Lt.ur.toString()]:new Rt.om(Tl,[],!0)})}function qm(e){return Rt.n.get(Nt.Z).isVisible(e,window)}(0,Wt.xd)(),(0,Wt.Sd)(Um),(0,Rt.sm)(),(0,Wt.fx)(),(0,Tt.zn)(),(0,Nt.wt)(),(0,Lt.L)(),(0,Tt.qn)(),(0,Rt.wl)(),(0,Rt.Ec)(),(0,Rt.Hb)(),(0,Zt.d)(),(0,Zt.p)(),(0,Pt.T)(),(0,Tt.kn)(),(0,Wt.Mb)(),(0,Wt.Yi)(),(0,Wt.Qv)(),(0,Wt.ey)(),(0,Wt.Xv)(),(0,Rt.Ja)(),(0,Tt.Fn)(),(0,Wt.E_)(),(0,Pt.U)(),(0,Tt.Tt)(),(0,Lt.z)(),(0,Lt.dr)(),(0,Wt.wd)(),(0,Wt.xd)(),(0,Nt.x)(),(0,Tt.xt)(),(0,Tt.nt)(),(0,Tt.k)(),(0,Wt.q)(),(0,Wt.Sd)({"vs/workbench/contrib/webview/browser/pre/service-worker.js":()=>(0,Wt.Cd)(new URL("data:text/javascript;base64,LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi4KICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCi8vQHRzLWNoZWNrCi8vLyA8cmVmZXJlbmNlIGxpYj0id2Vid29ya2VyIiAvPgoKLyoqIEB0eXBlIHtTZXJ2aWNlV29ya2VyR2xvYmFsU2NvcGV9ICovCmNvbnN0IHN3ID0gLyoqIEB0eXBlIHthbnl9ICovIChzZWxmKTsKCmNvbnN0IFZFUlNJT04gPSA0OwoKY29uc3QgcmVzb3VyY2VDYWNoZU5hbWUgPSBgdnNjb2RlLXJlc291cmNlLWNhY2hlLSR7VkVSU0lPTn1gOwoKY29uc3Qgcm9vdFBhdGggPSBzdy5sb2NhdGlvbi5wYXRobmFtZS5yZXBsYWNlKC9cL3NlcnZpY2Utd29ya2VyLmpzJC8sICcnKTsKCmNvbnN0IHNlYXJjaFBhcmFtcyA9IG5ldyBVUkwobG9jYXRpb24udG9TdHJpbmcoKSkuc2VhcmNoUGFyYW1zOwoKY29uc3QgcmVtb3RlQXV0aG9yaXR5ID0gc2VhcmNoUGFyYW1zLmdldCgncmVtb3RlQXV0aG9yaXR5Jyk7CgovKiogQHR5cGUge01lc3NhZ2VQb3J0fHVuZGVmaW5lZH0gKi8KbGV0IG91dGVySWZyYW1lTWVzc2FnZVBvcnQ7CgovKioKICogT3JpZ2luIHVzZWQgZm9yIHJlc291cmNlcwogKi8KY29uc3QgcmVzb3VyY2VCYXNlQXV0aG9yaXR5ID0gc2VhcmNoUGFyYW1zLmdldCgndnNjb2RlLXJlc291cmNlLWJhc2UtYXV0aG9yaXR5Jyk7CgovKioKICogQHBhcmFtIHtzdHJpbmd9IG5hbWUKICogQHBhcmFtIHtSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+fSBbb3B0aW9uc10KICovCmNvbnN0IHBlcmZNYXJrID0gKG5hbWUsIG9wdGlvbnMgPSB7fSkgPT4gewoJcGVyZm9ybWFuY2UubWFyayhgd2Vidmlldy9zZXJ2aWNlLXdvcmtlci8ke25hbWV9YCwgewoJCWRldGFpbDogewoJCQkuLi5vcHRpb25zCgkJfQoJfSk7Cn07CgpwZXJmTWFyaygnc2NyaXB0U3RhcnQnKTsKCi8qKiBAdHlwZSB7bnVtYmVyfSAqLwpjb25zdCByZXNvbHZlVGltZW91dCA9IDMwXzAwMDsKCgovKioKICogQHRlbXBsYXRlIFQKICogQHR5cGVkZWYge3sgc3RhdHVzOiAnb2snLCB2YWx1ZTogVCB9IHwgeyBzdGF0dXM6ICd0aW1lb3V0JyB9fSBSZXF1ZXN0U3RvcmVSZXN1bHQKICovCgoKLyoqCiAqIEB0ZW1wbGF0ZSBUCiAqIEB0eXBlZGVmIHt7IHJlc29sdmU6ICh4OiBSZXF1ZXN0U3RvcmVSZXN1bHQ8VD4pID0+IHZvaWQsIHByb21pc2U6IFByb21pc2U8UmVxdWVzdFN0b3JlUmVzdWx0PFQ+PiB9fSBSZXF1ZXN0U3RvcmVFbnRyeQogKi8KCgovKioKICogQHRlbXBsYXRlIFQKICovCmNsYXNzIFJlcXVlc3RTdG9yZSB7Cgljb25zdHJ1Y3RvcigpIHsKCQkvKiogQHR5cGUge01hcDxudW1iZXIsIFJlcXVlc3RTdG9yZUVudHJ5PFQ+Pn0gKi8KCQl0aGlzLm1hcCA9IG5ldyBNYXAoKTsKCQkvKiogQHR5cGUge251bWJlcn0gKi8KCQl0aGlzLnJlcXVlc3RQb29sID0gMDsKCX0KCgkvKioKCSAqIEByZXR1cm5zIHt7IHJlcXVlc3RJZDogbnVtYmVyLCBwcm9taXNlOiBQcm9taXNlPFJlcXVlc3RTdG9yZVJlc3VsdDxUPj4gfX0KCSAqLwoJY3JlYXRlKCkgewoJCWNvbnN0IHJlcXVlc3RJZCA9ICsrdGhpcy5yZXF1ZXN0UG9vbDsKCgkJLyoqIEB0eXBlIHsoeDogUmVxdWVzdFN0b3JlUmVzdWx0PFQ+KSA9PiB2b2lkfSAqLwoJCWxldCByZXNvbHZlOwoJCWNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShyID0+IHJlc29sdmUgPSByKTsKCgkJLyoqIEB0eXBlIHtSZXF1ZXN0U3RvcmVFbnRyeTxUPn0gKi8KCQljb25zdCBlbnRyeSA9IHsgcmVzb2x2ZSwgcHJvbWlzZSB9OwoJCXRoaXMubWFwLnNldChyZXF1ZXN0SWQsIGVudHJ5KTsKCgkJY29uc3QgZGlzcG9zZSA9ICgpID0+IHsKCQkJY2xlYXJUaW1lb3V0KHRpbWVvdXQpOwoJCQljb25zdCBleGlzdGluZ0VudHJ5ID0gdGhpcy5tYXAuZ2V0KHJlcXVlc3RJZCk7CgkJCWlmIChleGlzdGluZ0VudHJ5ID09PSBlbnRyeSkgewoJCQkJZXhpc3RpbmdFbnRyeS5yZXNvbHZlKHsgc3RhdHVzOiAndGltZW91dCcgfSk7CgkJCQl0aGlzLm1hcC5kZWxldGUocmVxdWVzdElkKTsKCQkJfQoJCX07CgkJY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoZGlzcG9zZSwgcmVzb2x2ZVRpbWVvdXQpOwoJCXJldHVybiB7IHJlcXVlc3RJZCwgcHJvbWlzZSB9OwoJfQoKCS8qKgoJICogQHBhcmFtIHtudW1iZXJ9IHJlcXVlc3RJZAoJICogQHBhcmFtIHtUfSByZXN1bHQKCSAqIEByZXR1cm5zIHtib29sZWFufQoJICovCglyZXNvbHZlKHJlcXVlc3RJZCwgcmVzdWx0KSB7CgkJY29uc3QgZW50cnkgPSB0aGlzLm1hcC5nZXQocmVxdWVzdElkKTsKCQlpZiAoIWVudHJ5KSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJZW50cnkucmVzb2x2ZSh7IHN0YXR1czogJ29rJywgdmFsdWU6IHJlc3VsdCB9KTsKCQl0aGlzLm1hcC5kZWxldGUocmVxdWVzdElkKTsKCQlyZXR1cm4gdHJ1ZTsKCX0KfQoKLyoqCiAqIE1hcCBvZiByZXF1ZXN0ZWQgcGF0aHMgdG8gcmVzcG9uc2VzLgogKi8KLyoqIEB0eXBlIHtSZXF1ZXN0U3RvcmU8UmVzb3VyY2VSZXNwb25zZT59ICovCmNvbnN0IHJlc291cmNlUmVxdWVzdFN0b3JlID0gbmV3IFJlcXVlc3RTdG9yZSgpOwoKLyoqCiAqIE1hcCBvZiByZXF1ZXN0ZWQgbG9jYWxob3N0IG9yaWdpbnMgdG8gb3B0aW9uYWwgcmVkaXJlY3RzLgogKi8KLyoqIEB0eXBlIHtSZXF1ZXN0U3RvcmU8c3RyaW5nfHVuZGVmaW5lZD59ICovCmNvbnN0IGxvY2FsaG9zdFJlcXVlc3RTdG9yZSA9IG5ldyBSZXF1ZXN0U3RvcmUoKTsKCmNvbnN0IHVuYXV0aG9yaXplZCA9ICgpID0+CgluZXcgUmVzcG9uc2UoJ1VuYXV0aG9yaXplZCcsIHsgc3RhdHVzOiA0MDEsIH0pOwoKY29uc3Qgbm90Rm91bmQgPSAoKSA9PgoJbmV3IFJlc3BvbnNlKCdOb3QgRm91bmQnLCB7IHN0YXR1czogNDA0LCB9KTsKCmNvbnN0IG1ldGhvZE5vdEFsbG93ZWQgPSAoKSA9PgoJbmV3IFJlc3BvbnNlKCdNZXRob2QgTm90IEFsbG93ZWQnLCB7IHN0YXR1czogNDA1LCB9KTsKCmNvbnN0IHJlcXVlc3RUaW1lb3V0ID0gKCkgPT4KCW5ldyBSZXNwb25zZSgnUmVxdWVzdCBUaW1lb3V0JywgeyBzdGF0dXM6IDQwOCwgfSk7Cgpzdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgYXN5bmMgKGV2ZW50KSA9PiB7CglpZiAoIWV2ZW50LnNvdXJjZSkgewoJCXJldHVybjsKCX0KCgkvKiogQHR5cGUge0NsaWVudH0gKi8KCWNvbnN0IHNvdXJjZSA9IGV2ZW50LnNvdXJjZTsKCXN3aXRjaCAoZXZlbnQuZGF0YS5jaGFubmVsKSB7CgkJY2FzZSAndmVyc2lvbic6IHsKCQkJcGVyZk1hcmsoJ3ZlcnNpb24vcmVxdWVzdCcpOwoJCQlvdXRlcklmcmFtZU1lc3NhZ2VQb3J0ID0gZXZlbnQucG9ydHNbMF07CgkJCXN3LmNsaWVudHMuZ2V0KHNvdXJjZS5pZCkudGhlbihjbGllbnQgPT4gewoJCQkJcGVyZk1hcmsoJ3ZlcnNpb24vcmVwbHknKTsKCQkJCWlmIChjbGllbnQpIHsKCQkJCQljbGllbnQucG9zdE1lc3NhZ2UoewoJCQkJCQljaGFubmVsOiAndmVyc2lvbicsCgkJCQkJCXZlcnNpb246IFZFUlNJT04KCQkJCQl9KTsKCQkJCX0KCQkJfSk7CgkJCXJldHVybjsKCQl9CgkJY2FzZSAnZGlkLWxvYWQtcmVzb3VyY2UnOiB7CgkJCS8qKiBAdHlwZSB7UmVzb3VyY2VSZXNwb25zZX0gKi8KCQkJY29uc3QgcmVzcG9uc2UgPSBldmVudC5kYXRhLmRhdGE7CgkJCWlmICghcmVzb3VyY2VSZXF1ZXN0U3RvcmUucmVzb2x2ZShyZXNwb25zZS5pZCwgcmVzcG9uc2UpKSB7CgkJCQljb25zb2xlLmxvZygnQ291bGQgbm90IHJlc29sdmUgdW5rbm93biByZXNvdXJjZScsIHJlc3BvbnNlLnBhdGgpOwoJCQl9CgkJCXJldHVybjsKCQl9CgkJY2FzZSAnZGlkLWxvYWQtbG9jYWxob3N0JzogewoJCQljb25zdCBkYXRhID0gZXZlbnQuZGF0YS5kYXRhOwoJCQlpZiAoIWxvY2FsaG9zdFJlcXVlc3RTdG9yZS5yZXNvbHZlKGRhdGEuaWQsIGRhdGEubG9jYXRpb24pKSB7CgkJCQljb25zb2xlLmxvZygnQ291bGQgbm90IHJlc29sdmUgdW5rbm93biBsb2NhbGhvc3QnLCBkYXRhLm9yaWdpbik7CgkJCX0KCQkJcmV0dXJuOwoJCX0KCQlkZWZhdWx0OiB7CgkJCWNvbnNvbGUubG9nKCdVbmtub3duIG1lc3NhZ2UnKTsKCQkJcmV0dXJuOwoJCX0KCX0KfSk7Cgpzdy5hZGRFdmVudExpc3RlbmVyKCdmZXRjaCcsIChldmVudCkgPT4gewoJY29uc3QgcmVxdWVzdFVybCA9IG5ldyBVUkwoZXZlbnQucmVxdWVzdC51cmwpOwoJaWYgKHR5cGVvZiByZXNvdXJjZUJhc2VBdXRob3JpdHkgPT09ICdzdHJpbmcnICYmIHJlcXVlc3RVcmwucHJvdG9jb2wgPT09ICdodHRwczonICYmIHJlcXVlc3RVcmwuaG9zdG5hbWUuZW5kc1dpdGgoJy4nICsgcmVzb3VyY2VCYXNlQXV0aG9yaXR5KSkgewoJCXN3aXRjaCAoZXZlbnQucmVxdWVzdC5tZXRob2QpIHsKCQkJY2FzZSAnR0VUJzoKCQkJY2FzZSAnSEVBRCc6IHsKCQkJCWNvbnN0IGZpcnN0SG9zdFNlZ21lbnQgPSByZXF1ZXN0VXJsLmhvc3RuYW1lLnNsaWNlKDAsIHJlcXVlc3RVcmwuaG9zdG5hbWUubGVuZ3RoIC0gKHJlc291cmNlQmFzZUF1dGhvcml0eS5sZW5ndGggKyAxKSk7CgkJCQljb25zdCBzY2hlbWUgPSBmaXJzdEhvc3RTZWdtZW50LnNwbGl0KCcrJywgMSlbMF07CgkJCQljb25zdCBhdXRob3JpdHkgPSBmaXJzdEhvc3RTZWdtZW50LnNsaWNlKHNjaGVtZS5sZW5ndGggKyAxKTsgLy8gbWF5IGJlIGVtcHR5CgkJCQlyZXR1cm4gZXZlbnQucmVzcG9uZFdpdGgocHJvY2Vzc1Jlc291cmNlUmVxdWVzdChldmVudCwgewoJCQkJCXNjaGVtZSwKCQkJCQlhdXRob3JpdHksCgkJCQkJcGF0aDogcmVxdWVzdFVybC5wYXRobmFtZSwKCQkJCQlxdWVyeTogcmVxdWVzdFVybC5zZWFyY2gucmVwbGFjZSgvXlw/LywgJycpLAoJCQkJfSkpOwoJCQl9CgkJCWRlZmF1bHQ6IHsKCQkJCXJldHVybiBldmVudC5yZXNwb25kV2l0aChtZXRob2ROb3RBbGxvd2VkKCkpOwoJCQl9CgkJfQoJfQoKCS8vIElmIHdlJ3JlIG1ha2luZyBhIHJlcXVlc3QgYWdhaW5zdCB0aGUgcmVtb3RlIGF1dGhvcml0eSwgd2Ugd2FudCB0byBnbwoJLy8gdGhyb3VnaCBWUyBDb2RlIGl0c2VsZiBzbyB0aGF0IHdlIGFyZSBhdXRoZW50aWNhdGVkIHByb3Blcmx5LiAgSWYgdGhlCgkvLyBzZXJ2aWNlIHdvcmtlciBpcyBob3N0ZWQgb24gdGhlIHNhbWUgb3JpZ2luIHdlIHdpbGwgaGF2ZSBjb29raWVzIGFuZAoJLy8gYXV0aGVudGljYXRpb24gd2lsbCBub3QgYmUgYW4gaXNzdWUuCglpZiAocmVxdWVzdFVybC5vcmlnaW4gIT09IHN3Lm9yaWdpbiAmJiByZXF1ZXN0VXJsLmhvc3QgPT09IHJlbW90ZUF1dGhvcml0eSkgewoJCXN3aXRjaCAoZXZlbnQucmVxdWVzdC5tZXRob2QpIHsKCQkJY2FzZSAnR0VUJzoKCQkJY2FzZSAnSEVBRCc6IHsKCQkJCXJldHVybiBldmVudC5yZXNwb25kV2l0aChwcm9jZXNzUmVzb3VyY2VSZXF1ZXN0KGV2ZW50LCB7CgkJCQkJcGF0aDogcmVxdWVzdFVybC5wYXRobmFtZSwKCQkJCQlzY2hlbWU6IHJlcXVlc3RVcmwucHJvdG9jb2wuc2xpY2UoMCwgcmVxdWVzdFVybC5wcm90b2NvbC5sZW5ndGggLSAxKSwKCQkJCQlhdXRob3JpdHk6IHJlcXVlc3RVcmwuaG9zdCwKCQkJCQlxdWVyeTogcmVxdWVzdFVybC5zZWFyY2gucmVwbGFjZSgvXlw/LywgJycpLAoJCQkJfSkpOwoJCQl9CgkJCWRlZmF1bHQ6IHsKCQkJCXJldHVybiBldmVudC5yZXNwb25kV2l0aChtZXRob2ROb3RBbGxvd2VkKCkpOwoJCQl9CgkJfQoJfQoKCS8vIFNlZSBpZiBpdCdzIGEgbG9jYWxob3N0IHJlcXVlc3QKCWlmIChyZXF1ZXN0VXJsLm9yaWdpbiAhPT0gc3cub3JpZ2luICYmIHJlcXVlc3RVcmwuaG9zdC5tYXRjaCgvXihsb2NhbGhvc3R8MTI3LjAuMC4xfDAuMC4wLjApOihcZCspJC8pKSB7CgkJcmV0dXJuIGV2ZW50LnJlc3BvbmRXaXRoKHByb2Nlc3NMb2NhbGhvc3RSZXF1ZXN0KGV2ZW50LCByZXF1ZXN0VXJsKSk7Cgl9Cn0pOwoKc3cuYWRkRXZlbnRMaXN0ZW5lcignaW5zdGFsbCcsIChldmVudCkgPT4gewoJZXZlbnQud2FpdFVudGlsKHN3LnNraXBXYWl0aW5nKCkpOyAvLyBBY3RpdmF0ZSB3b3JrZXIgaW1tZWRpYXRlbHkKfSk7Cgpzdy5hZGRFdmVudExpc3RlbmVyKCdhY3RpdmF0ZScsIChldmVudCkgPT4gewoJZXZlbnQud2FpdFVudGlsKHN3LmNsaWVudHMuY2xhaW0oKSk7IC8vIEJlY29tZSBhdmFpbGFibGUgdG8gYWxsIHBhZ2VzCn0pOwoKCi8qKgogKiBAdHlwZWRlZiB7T2JqZWN0fSBSZXNvdXJjZVJlcXVlc3RVcmxDb21wb25lbnRzCiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBzY2hlbWUKICogQHByb3BlcnR5IHtzdHJpbmd9IGF1dGhvcml0eQogKiBAcHJvcGVydHkge3N0cmluZ30gcGF0aAogKiBAcHJvcGVydHkge3N0cmluZ30gcXVlcnkKICovCgovKioKICogQHBhcmFtIHtGZXRjaEV2ZW50fSBldmVudAogKiBAcGFyYW0ge1Jlc291cmNlUmVxdWVzdFVybENvbXBvbmVudHN9IHJlcXVlc3RVcmxDb21wb25lbnRzCiAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0KICovCmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NSZXNvdXJjZVJlcXVlc3QoCglldmVudCwKCXJlcXVlc3RVcmxDb21wb25lbnRzCikgewoJbGV0IGNsaWVudCA9IGF3YWl0IHN3LmNsaWVudHMuZ2V0KGV2ZW50LmNsaWVudElkKTsKCWlmICghY2xpZW50KSB7CgkJY2xpZW50ID0gYXdhaXQgZ2V0V29ya2VyQ2xpZW50Rm9ySWQoZXZlbnQuY2xpZW50SWQpOwoJCWlmICghY2xpZW50KSB7CgkJCWNvbnNvbGUuZXJyb3IoJ0NvdWxkIG5vdCBmaW5kIGlubmVyIGNsaWVudCBmb3IgcmVxdWVzdCcpOwoJCQlyZXR1cm4gbm90Rm91bmQoKTsKCQl9Cgl9CgoJY29uc3Qgd2Vidmlld0lkID0gZ2V0V2Vidmlld0lkRm9yQ2xpZW50KGNsaWVudCk7CgoJLy8gUmVmcyBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L3ZzY29kZS9pc3N1ZXMvMjQ0MTQzCgkvLyBXaXRoIFBsekRlZGljYXRlZFdvcmtlciwgd29ya2VyIHN1YnJlc291cmNlcyBhbmQgYmxvYiB3b2tlcnMKCS8vIHdpbGwgdXNlIGNsaWVudHMgZGlmZmVyZW50IGZyb20gdGhlIHdpbmRvdyBjbGllbnQuCgkvLyBTaW5jZSB3ZSBjYW5ub3QgZGlmZmVyZW50IGEgd29ya2VyIG1haW4gcmVzb3VyY2UgZnJvbSBhIHdvcmtlciBzdWJyZXNvdXJjZQoJLy8gd2Ugd2lsbCB1c2UgbWVzc2FnZSBjaGFubmVsIHRvIHRoZSBvdXRlciBpZnJhbWUgcHJvdmlkZWQgYXQgdGhlIHRpbWUKCS8vIG9mIHNlcnZpY2Ugd29ya2VyIGNvbnRyb2xsZXIgdmVyc2lvbiBpbml0aWFsaXphdGlvbi4KCWlmICghd2Vidmlld0lkICYmIGNsaWVudC50eXBlICE9PSAnd29ya2VyJyAmJiBjbGllbnQudHlwZSAhPT0gJ3NoYXJlZHdvcmtlcicpIHsKCQljb25zb2xlLmVycm9yKCdDb3VsZCBub3QgcmVzb2x2ZSB3ZWJ2aWV3IGlkJyk7CgkJcmV0dXJuIG5vdEZvdW5kKCk7Cgl9CgoJY29uc3Qgc2hvdWxkVHJ5Q2FjaGluZyA9IChldmVudC5yZXF1ZXN0Lm1ldGhvZCA9PT0gJ0dFVCcpOwoKCS8qKgoJICogQHBhcmFtIHtSZXF1ZXN0U3RvcmVSZXN1bHQ8UmVzb3VyY2VSZXNwb25zZT59IHJlc3VsdAoJICogQHBhcmFtIHtSZXNwb25zZXx1bmRlZmluZWR9IGNhY2hlZFJlc3BvbnNlCgkgKiBAcmV0dXJucyB7UmVzcG9uc2V9CgkgKi8KCWNvbnN0IHJlc29sdmVSZXNvdXJjZUVudHJ5ID0gKHJlc3VsdCwgY2FjaGVkUmVzcG9uc2UpID0+IHsKCQlpZiAocmVzdWx0LnN0YXR1cyA9PT0gJ3RpbWVvdXQnKSB7CgkJCXJldHVybiByZXF1ZXN0VGltZW91dCgpOwoJCX0KCgkJLyoqIEB0eXBlIHtSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+fSAqLwoJCWNvbnN0IGFjY2Vzc0NvbnRyb2xIZWFkZXJzID0gewoJCQknQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogJyonLAoJCQknQ3Jvc3MtT3JpZ2luLVJlc291cmNlLVBvbGljeSc6ICdjcm9zcy1vcmlnaW4nLAoJCX07CgoJCWNvbnN0IGVudHJ5ID0gcmVzdWx0LnZhbHVlOwoJCWlmIChlbnRyeS5zdGF0dXMgPT09IDMwNCkgeyAvLyBOb3QgbW9kaWZpZWQKCQkJaWYgKGNhY2hlZFJlc3BvbnNlKSB7CgkJCQljb25zdCByID0gY2FjaGVkUmVzcG9uc2UuY2xvbmUoKTsKCQkJCWZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGFjY2Vzc0NvbnRyb2xIZWFkZXJzKSkgewoJCQkJCXIuaGVhZGVycy5zZXQoa2V5LCB2YWx1ZSk7CgkJCQl9CgkJCQlyZXR1cm4gcjsKCQkJfSBlbHNlIHsKCQkJCXRocm93IG5ldyBFcnJvcignTm8gY2FjaGUgZm91bmQnKTsKCQkJfQoJCX0KCgkJaWYgKGVudHJ5LnN0YXR1cyA9PT0gNDAxKSB7CgkJCXJldHVybiB1bmF1dGhvcml6ZWQoKTsKCQl9CgoJCWlmIChlbnRyeS5zdGF0dXMgIT09IDIwMCkgewoJCQlyZXR1cm4gbm90Rm91bmQoKTsKCQl9CgoJCWNvbnN0IGJ5dGVMZW5ndGggPSBlbnRyeS5kYXRhLmJ5dGVMZW5ndGg7CgoJCWNvbnN0IHJhbmdlID0gZXZlbnQucmVxdWVzdC5oZWFkZXJzLmdldCgncmFuZ2UnKTsKCQlpZiAocmFuZ2UpIHsKCQkJLy8gVG8gc3VwcG9ydCBzZWVraW5nIGZvciB2aWRlb3MsIHdlIG5lZWQgdG8gaGFuZGxlIHJhbmdlIHJlcXVlc3RzCgkJCWNvbnN0IGJ5dGVzID0gcmFuZ2UubWF0Y2goL15ieXRlc1w9KFxkKylcLShcZCspPyQvZyk7CgkJCWlmIChieXRlcykgewoJCQkJLy8gVE9ETzogUmlnaHQgbm93IHdlIGFyZSBhbHdheXMgcmVhZGluZyB0aGUgZnVsbCBmaWxlIGNvbnRlbnQuIFRoaXMgaXMgYSBiYWQgaWRlYQoJCQkJLy8gZm9yIGxhcmdlIHZpZGVvIGZpbGVzIDopCgoJCQkJY29uc3Qgc3RhcnQgPSBOdW1iZXIoYnl0ZXNbMV0pOwoJCQkJY29uc3QgZW5kID0gTnVtYmVyKGJ5dGVzWzJdKSB8fCBieXRlTGVuZ3RoIC0gMTsKCQkJCXJldHVybiBuZXcgUmVzcG9uc2UoZW50cnkuZGF0YS5zbGljZShzdGFydCwgZW5kICsgMSksIHsKCQkJCQlzdGF0dXM6IDIwNiwKCQkJCQloZWFkZXJzOiB7CgkJCQkJCS4uLmFjY2Vzc0NvbnRyb2xIZWFkZXJzLAoJCQkJCQknQ29udGVudC1yYW5nZSc6IGBieXRlcyAwLSR7ZW5kfS8ke2J5dGVMZW5ndGh9YCwKCQkJCQl9CgkJCQl9KTsKCQkJfSBlbHNlIHsKCQkJCS8vIFdlIGRvbid0IHVuZGVyc3RhbmQgdGhlIHJlcXVlc3RlZCBieXRlcwoJCQkJcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7CgkJCQkJc3RhdHVzOiA0MTYsCgkJCQkJaGVhZGVyczogewoJCQkJCQkuLi5hY2Nlc3NDb250cm9sSGVhZGVycywKCQkJCQkJJ0NvbnRlbnQtcmFuZ2UnOiBgKi8ke2J5dGVMZW5ndGh9YAoJCQkJCX0KCQkJCX0pOwoJCQl9CgkJfQoKCQkvKiogQHR5cGUge1JlY29yZDxzdHJpbmcsIHN0cmluZz59ICovCgkJY29uc3QgaGVhZGVycyA9IHsKCQkJLi4uYWNjZXNzQ29udHJvbEhlYWRlcnMsCgkJCSdDb250ZW50LVR5cGUnOiBlbnRyeS5taW1lLAoJCQknQ29udGVudC1MZW5ndGgnOiBieXRlTGVuZ3RoLnRvU3RyaW5nKCksCgkJfTsKCgkJaWYgKGVudHJ5LmV0YWcpIHsKCQkJaGVhZGVyc1snRVRhZyddID0gZW50cnkuZXRhZzsKCQkJaGVhZGVyc1snQ2FjaGUtQ29udHJvbCddID0gJ25vLWNhY2hlJzsKCQl9CgkJaWYgKGVudHJ5Lm10aW1lKSB7CgkJCWhlYWRlcnNbJ0xhc3QtTW9kaWZpZWQnXSA9IG5ldyBEYXRlKGVudHJ5Lm10aW1lKS50b1VUQ1N0cmluZygpOwoJCX0KCgkJLy8gc3VwcG9ydCBDT0kgcmVxdWVzdHMsIHNlZSBuZXR3b3JrLnRzI0NPSS5nZXRIZWFkZXJzRnJvbVF1ZXJ5KC4uLikKCQljb25zdCBjb2lSZXF1ZXN0ID0gbmV3IFVSTChldmVudC5yZXF1ZXN0LnVybCkuc2VhcmNoUGFyYW1zLmdldCgndnNjb2RlLWNvaScpOwoJCWlmIChjb2lSZXF1ZXN0ID09PSAnMycpIHsKCQkJaGVhZGVyc1snQ3Jvc3MtT3JpZ2luLU9wZW5lci1Qb2xpY3knXSA9ICdzYW1lLW9yaWdpbic7CgkJCWhlYWRlcnNbJ0Nyb3NzLU9yaWdpbi1FbWJlZGRlci1Qb2xpY3knXSA9ICdyZXF1aXJlLWNvcnAnOwoJCX0gZWxzZSBpZiAoY29pUmVxdWVzdCA9PT0gJzInKSB7CgkJCWhlYWRlcnNbJ0Nyb3NzLU9yaWdpbi1FbWJlZGRlci1Qb2xpY3knXSA9ICdyZXF1aXJlLWNvcnAnOwoJCX0gZWxzZSBpZiAoY29pUmVxdWVzdCA9PT0gJzEnKSB7CgkJCWhlYWRlcnNbJ0Nyb3NzLU9yaWdpbi1PcGVuZXItUG9saWN5J10gPSAnc2FtZS1vcmlnaW4nOwoJCX0KCgkJY29uc3QgcmVzcG9uc2UgPSBuZXcgUmVzcG9uc2UoZW50cnkuZGF0YSwgewoJCQlzdGF0dXM6IDIwMCwKCQkJaGVhZGVycwoJCX0pOwoKCQlpZiAoc2hvdWxkVHJ5Q2FjaGluZyAmJiBlbnRyeS5ldGFnKSB7CgkJCWNhY2hlcy5vcGVuKHJlc291cmNlQ2FjaGVOYW1lKS50aGVuKGNhY2hlID0+IHsKCQkJCXJldHVybiBjYWNoZS5wdXQoZXZlbnQucmVxdWVzdCwgcmVzcG9uc2UpOwoJCQl9KTsKCQl9CgkJcmV0dXJuIHJlc3BvbnNlLmNsb25lKCk7Cgl9OwoKCS8qKiBAdHlwZSB7UmVzcG9uc2V8dW5kZWZpbmVkfSAqLwoJbGV0IGNhY2hlZDsKCWlmIChzaG91bGRUcnlDYWNoaW5nKSB7CgkJY29uc3QgY2FjaGUgPSBhd2FpdCBjYWNoZXMub3BlbihyZXNvdXJjZUNhY2hlTmFtZSk7CgkJY2FjaGVkID0gYXdhaXQgY2FjaGUubWF0Y2goZXZlbnQucmVxdWVzdCk7Cgl9CgoJY29uc3QgeyByZXF1ZXN0SWQsIHByb21pc2UgfSA9IHJlc291cmNlUmVxdWVzdFN0b3JlLmNyZWF0ZSgpOwoKCWlmICh3ZWJ2aWV3SWQpIHsKCQljb25zdCBwYXJlbnRDbGllbnRzID0gYXdhaXQgZ2V0T3V0ZXJJZnJhbWVDbGllbnQod2Vidmlld0lkKTsKCQlpZiAoIXBhcmVudENsaWVudHMubGVuZ3RoKSB7CgkJCWNvbnNvbGUubG9nKCdDb3VsZCBub3QgZmluZCBwYXJlbnQgY2xpZW50IGZvciByZXF1ZXN0Jyk7CgkJCXJldHVybiBub3RGb3VuZCgpOwoJCX0KCgkJZm9yIChjb25zdCBwYXJlbnRDbGllbnQgb2YgcGFyZW50Q2xpZW50cykgewoJCQlwYXJlbnRDbGllbnQucG9zdE1lc3NhZ2UoewoJCQkJY2hhbm5lbDogJ2xvYWQtcmVzb3VyY2UnLAoJCQkJaWQ6IHJlcXVlc3RJZCwKCQkJCXNjaGVtZTogcmVxdWVzdFVybENvbXBvbmVudHMuc2NoZW1lLAoJCQkJYXV0aG9yaXR5OiByZXF1ZXN0VXJsQ29tcG9uZW50cy5hdXRob3JpdHksCgkJCQlwYXRoOiByZXF1ZXN0VXJsQ29tcG9uZW50cy5wYXRoLAoJCQkJcXVlcnk6IHJlcXVlc3RVcmxDb21wb25lbnRzLnF1ZXJ5LAoJCQkJaWZOb25lTWF0Y2g6IGNhY2hlZD8uaGVhZGVycy5nZXQoJ0VUYWcnKSwKCQkJfSk7CgkJfQoJfSBlbHNlIGlmIChjbGllbnQudHlwZSA9PT0gJ3dvcmtlcicgfHwgY2xpZW50LnR5cGUgPT09ICdzaGFyZWR3b3JrZXInKSB7CgkJb3V0ZXJJZnJhbWVNZXNzYWdlUG9ydD8ucG9zdE1lc3NhZ2UoewoJCQljaGFubmVsOiAnbG9hZC1yZXNvdXJjZScsCgkJCWlkOiByZXF1ZXN0SWQsCgkJCXNjaGVtZTogcmVxdWVzdFVybENvbXBvbmVudHMuc2NoZW1lLAoJCQlhdXRob3JpdHk6IHJlcXVlc3RVcmxDb21wb25lbnRzLmF1dGhvcml0eSwKCQkJcGF0aDogcmVxdWVzdFVybENvbXBvbmVudHMucGF0aCwKCQkJcXVlcnk6IHJlcXVlc3RVcmxDb21wb25lbnRzLnF1ZXJ5LAoJCQlpZk5vbmVNYXRjaDogY2FjaGVkPy5oZWFkZXJzLmdldCgnRVRhZycpLAoJCX0pOwoJfQoKCXJldHVybiBwcm9taXNlLnRoZW4oZW50cnkgPT4gcmVzb2x2ZVJlc291cmNlRW50cnkoZW50cnksIGNhY2hlZCkpOwp9CgovKioKICogQHBhcmFtIHtGZXRjaEV2ZW50fSBldmVudAogKiBAcGFyYW0ge1VSTH0gcmVxdWVzdFVybAogKiBAcmV0dXJucyB7UHJvbWlzZTxSZXNwb25zZT59CiAqLwphc3luYyBmdW5jdGlvbiBwcm9jZXNzTG9jYWxob3N0UmVxdWVzdCgKCWV2ZW50LAoJcmVxdWVzdFVybAopIHsKCWNvbnN0IGNsaWVudCA9IGF3YWl0IHN3LmNsaWVudHMuZ2V0KGV2ZW50LmNsaWVudElkKTsKCWlmICghY2xpZW50KSB7CgkJLy8gVGhpcyBpcyBleHBlY3RlZCB3aGVuIHJlcXVlc3RpbmcgcmVzb3VyY2VzIG9uIG90aGVyIGxvY2FsaG9zdCBwb3J0cwoJCS8vIHRoYXQgYXJlIG5vdCBzcGF3bmVkIGJ5IHZzIGNvZGUKCQlyZXR1cm4gZmV0Y2goZXZlbnQucmVxdWVzdCk7Cgl9Cgljb25zdCB3ZWJ2aWV3SWQgPSBnZXRXZWJ2aWV3SWRGb3JDbGllbnQoY2xpZW50KTsKCS8vIFJlZnMgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvaXNzdWVzLzI0NDE0MwoJLy8gV2l0aCBQbHpEZWRpY2F0ZWRXb3JrZXIsIHdvcmtlciBzdWJyZXNvdXJjZXMgYW5kIGJsb2Igd29rZXJzCgkvLyB3aWxsIHVzZSBjbGllbnRzIGRpZmZlcmVudCBmcm9tIHRoZSB3aW5kb3cgY2xpZW50LgoJLy8gU2luY2Ugd2UgY2Fubm90IGRpZmZlcmVudCBhIHdvcmtlciBtYWluIHJlc291cmNlIGZyb20gYSB3b3JrZXIgc3VicmVzb3VyY2UKCS8vIHdlIHdpbGwgdXNlIG1lc3NhZ2UgY2hhbm5lbCB0byB0aGUgb3V0ZXIgaWZyYW1lIHByb3ZpZGVkIGF0IHRoZSB0aW1lCgkvLyBvZiBzZXJ2aWNlIHdvcmtlciBjb250cm9sbGVyIHZlcnNpb24gaW5pdGlhbGl6YXRpb24uCglpZiAoIXdlYnZpZXdJZCAmJiBjbGllbnQudHlwZSAhPT0gJ3dvcmtlcicgJiYgY2xpZW50LnR5cGUgIT09ICdzaGFyZWR3b3JrZXInKSB7CgkJY29uc29sZS5lcnJvcignQ291bGQgbm90IHJlc29sdmUgd2VidmlldyBpZCcpOwoJCXJldHVybiBmZXRjaChldmVudC5yZXF1ZXN0KTsKCX0KCgljb25zdCBvcmlnaW4gPSByZXF1ZXN0VXJsLm9yaWdpbjsKCgkvKioKCSAqIEBwYXJhbSB7UmVxdWVzdFN0b3JlUmVzdWx0PHN0cmluZ3x1bmRlZmluZWQ+fSByZXN1bHQKCSAqIEByZXR1cm5zIHtQcm9taXNlPFJlc3BvbnNlPn0KCSAqLwoJY29uc3QgcmVzb2x2ZVJlZGlyZWN0ID0gYXN5bmMgZnVuY3Rpb24gKHJlc3VsdCkgewoJCWlmIChyZXN1bHQuc3RhdHVzICE9PSAnb2snIHx8ICFyZXN1bHQudmFsdWUpIHsKCQkJcmV0dXJuIGZldGNoKGV2ZW50LnJlcXVlc3QpOwoJCX0KCgkJY29uc3QgcmVkaXJlY3RPcmlnaW4gPSByZXN1bHQudmFsdWU7CgkJY29uc3QgbG9jYXRpb24gPSBldmVudC5yZXF1ZXN0LnVybC5yZXBsYWNlKG5ldyBSZWdFeHAoYF4ke3JlcXVlc3RVcmwub3JpZ2lufSgvfCQpYCksIGAke3JlZGlyZWN0T3JpZ2lufSQxYCk7CgkJcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7CgkJCXN0YXR1czogMzAyLAoJCQloZWFkZXJzOiB7CgkJCQlMb2NhdGlvbjogbG9jYXRpb24KCQkJfQoJCX0pOwoJfTsKCgljb25zdCB7IHJlcXVlc3RJZCwgcHJvbWlzZSB9ID0gbG9jYWxob3N0UmVxdWVzdFN0b3JlLmNyZWF0ZSgpOwoJaWYgKHdlYnZpZXdJZCkgewoJCWNvbnN0IHBhcmVudENsaWVudHMgPSBhd2FpdCBnZXRPdXRlcklmcmFtZUNsaWVudCh3ZWJ2aWV3SWQpOwoJCWlmICghcGFyZW50Q2xpZW50cy5sZW5ndGgpIHsKCQkJY29uc29sZS5sb2coJ0NvdWxkIG5vdCBmaW5kIHBhcmVudCBjbGllbnQgZm9yIHJlcXVlc3QnKTsKCQkJcmV0dXJuIG5vdEZvdW5kKCk7CgkJfQoJCWZvciAoY29uc3QgcGFyZW50Q2xpZW50IG9mIHBhcmVudENsaWVudHMpIHsKCQkJcGFyZW50Q2xpZW50LnBvc3RNZXNzYWdlKHsKCQkJCWNoYW5uZWw6ICdsb2FkLWxvY2FsaG9zdCcsCgkJCQlvcmlnaW46IG9yaWdpbiwKCQkJCWlkOiByZXF1ZXN0SWQsCgkJCX0pOwoJCX0KCX0gZWxzZSBpZiAoY2xpZW50LnR5cGUgPT09ICd3b3JrZXInIHx8IGNsaWVudC50eXBlID09PSAnc2hhcmVkd29ya2VyJykgewoJCW91dGVySWZyYW1lTWVzc2FnZVBvcnQ/LnBvc3RNZXNzYWdlKHsKCQkJY2hhbm5lbDogJ2xvYWQtbG9jYWxob3N0JywKCQkJb3JpZ2luOiBvcmlnaW4sCgkJCWlkOiByZXF1ZXN0SWQsCgkJfSk7Cgl9CgoJcmV0dXJuIHByb21pc2UudGhlbihyZXNvbHZlUmVkaXJlY3QpOwp9CgovKioKICogQHBhcmFtIHtDbGllbnR9IGNsaWVudAogKiBAcmV0dXJucyB7c3RyaW5nfG51bGx9CiAqLwpmdW5jdGlvbiBnZXRXZWJ2aWV3SWRGb3JDbGllbnQoY2xpZW50KSB7Cgljb25zdCByZXF1ZXN0ZXJDbGllbnRVcmwgPSBuZXcgVVJMKGNsaWVudC51cmwpOwoJcmV0dXJuIHJlcXVlc3RlckNsaWVudFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdpZCcpOwp9CgovKioKICogQHBhcmFtIHtzdHJpbmd9IHdlYnZpZXdJZAogKiBAcmV0dXJucyB7UHJvbWlzZTxDbGllbnRbXT59CiAqLwphc3luYyBmdW5jdGlvbiBnZXRPdXRlcklmcmFtZUNsaWVudCh3ZWJ2aWV3SWQpIHsKCWNvbnN0IGFsbENsaWVudHMgPSBhd2FpdCBzdy5jbGllbnRzLm1hdGNoQWxsKHsgaW5jbHVkZVVuY29udHJvbGxlZDogdHJ1ZSB9KTsKCXJldHVybiBhbGxDbGllbnRzLmZpbHRlcihjbGllbnQgPT4gewoJCWNvbnN0IGNsaWVudFVybCA9IG5ldyBVUkwoY2xpZW50LnVybCk7CgkJcmV0dXJuIGNsaWVudFVybC5zZWFyY2hQYXJhbXMuZ2V0KCdpZCcpID09PSB3ZWJ2aWV3SWQ7Cgl9KTsKfQoKLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSBjbGllbnRJZAogKiBAcmV0dXJucyB7UHJvbWlzZTxDbGllbnR8dW5kZWZpbmVkPn0KICovCmFzeW5jIGZ1bmN0aW9uIGdldFdvcmtlckNsaWVudEZvcklkKGNsaWVudElkKSB7Cgljb25zdCBhbGxEZWRpY2F0ZWRXb3JrZXJDbGllbnRzID0gYXdhaXQgc3cuY2xpZW50cy5tYXRjaEFsbCh7IHR5cGU6ICd3b3JrZXInIH0pOwoJY29uc3QgYWxsU2hhcmVkV29ya2VyQ2xpZW50cyA9IGF3YWl0IHN3LmNsaWVudHMubWF0Y2hBbGwoeyB0eXBlOiAnc2hhcmVkd29ya2VyJyB9KTsKCWNvbnN0IGFsbFdvcmtlckNsaWVudHMgPSBbLi4uYWxsRGVkaWNhdGVkV29ya2VyQ2xpZW50cywgLi4uYWxsU2hhcmVkV29ya2VyQ2xpZW50c107CglyZXR1cm4gYWxsV29ya2VyQ2xpZW50cy5maW5kKGNsaWVudCA9PiB7CgkJcmV0dXJuIGNsaWVudC5pZCA9PT0gY2xpZW50SWQ7Cgl9KTsKfQoKCi8qKgogKiBAdHlwZWRlZiB7KAogKiAgIHwgeyByZWFkb25seSBzdGF0dXM6IDIwMCwgaWQ6IG51bWJlciwgcGF0aDogc3RyaW5nLCBtaW1lOiBzdHJpbmcsIGRhdGE6IFVpbnQ4QXJyYXksIGV0YWc6IHN0cmluZ3x1bmRlZmluZWQsIG10aW1lOiBudW1iZXJ8dW5kZWZpbmVkIH0KICogICB8IHsgcmVhZG9ubHkgc3RhdHVzOiAzMDQsIGlkOiBudW1iZXIsIHBhdGg6IHN0cmluZywgbWltZTogc3RyaW5nLCBtdGltZTogbnVtYmVyfHVuZGVmaW5lZCB9CiAqICAgfCB7IHJlYWRvbmx5IHN0YXR1czogNDAxLCBpZDogbnVtYmVyLCBwYXRoOiBzdHJpbmcgfQogKiAgIHwgeyByZWFkb25seSBzdGF0dXM6IDQwNCwgaWQ6IG51bWJlciwgcGF0aDogc3RyaW5nIH0KICogKX0gUmVzb3VyY2VSZXNwb25zZQogKi8K","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,Xm),"vs/workbench/contrib/webview/browser/pre/index.html":()=>(0,Wt.Cd)(new URL("data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIiBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsiPgoKPGhlYWQ+Cgk8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CgoJPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1TZWN1cml0eS1Qb2xpY3kiCgkJY29udGVudD0iZGVmYXVsdC1zcmMgJ25vbmUnOyBzY3JpcHQtc3JjICdzaGEyNTYtNGlYbkh4M3B1WThFTzBkanI1eVhrbXpTaG9naURvVHpyalVlSmpUWkJtVT0nICdzZWxmJzsgZnJhbWUtc3JjICdzZWxmJzsgc3R5bGUtc3JjICd1bnNhZmUtaW5saW5lJzsiPgoKCTwhLS0gRGlzYWJsZSBwaW5jaCB6b29taW5nIC0tPgoJPG1ldGEgbmFtZT0idmlld3BvcnQiCgkJY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIG1pbmltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIj4KPC9oZWFkPgoKPGJvZHkgc3R5bGU9Im1hcmdpbjogMDsgb3ZlcmZsb3c6IGhpZGRlbjsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgb3ZlcnNjcm9sbC1iZWhhdmlvci14OiBub25lOyIgcm9sZT0iZG9jdW1lbnQiPgoJPHNjcmlwdCBhc3luYyB0eXBlPSJtb2R1bGUiPgoJCS8vIEB0cy1jaGVjawoJCS8vLyA8cmVmZXJlbmNlIGxpYj0iZG9tIiAvPgoKCQljb25zdCBpc1NhZmFyaSA9ICgKCQkJbmF2aWdhdG9yLnZlbmRvciAmJiBuYXZpZ2F0b3IudmVuZG9yLmluZGV4T2YoJ0FwcGxlJykgPiAtMSAmJgoJCQluYXZpZ2F0b3IudXNlckFnZW50ICYmCgkJCW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignQ3JpT1MnKSA9PT0gLTEgJiYKCQkJbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdGeGlPUycpID09PSAtMQoJCSk7CgoJCWNvbnN0IGlzRmlyZWZveCA9ICgKCQkJbmF2aWdhdG9yLnVzZXJBZ2VudCAmJgoJCQluYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0ZpcmVmb3gnKSA+PSAwCgkJKTsKCgkJY29uc3Qgc2VhcmNoUGFyYW1zID0gbmV3IFVSTChsb2NhdGlvbi50b1N0cmluZygpKS5zZWFyY2hQYXJhbXM7CgkJY29uc3QgSUQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdpZCcpOwoJCWNvbnN0IHdlYnZpZXdPcmlnaW4gPSBzZWFyY2hQYXJhbXMuZ2V0KCdvcmlnaW4nKTsKCQljb25zdCBvbkVsZWN0cm9uID0gc2VhcmNoUGFyYW1zLmdldCgncGxhdGZvcm0nKSA9PT0gJ2VsZWN0cm9uJzsKCQljb25zdCBkaXNhYmxlU2VydmljZVdvcmtlciA9IHNlYXJjaFBhcmFtcy5oYXMoJ2Rpc2FibGVTZXJ2aWNlV29ya2VyJyk7CgkJY29uc3QgZXhwZWN0ZWRXb3JrZXJWZXJzaW9uID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnc3dWZXJzaW9uJykpOwoJCWNvbnN0IHNlcnZpY2VXb3JrZXJVcmkgPSBzZWFyY2hQYXJhbXMuZ2V0KCdzZXJ2aWNlV29ya2VyVXJpJyk7CgkJY29uc3QgZmFrZUh0bWxVcmkgPSBzZWFyY2hQYXJhbXMuZ2V0KCdmYWtlSHRtbFVyaScpOwoKCQkvKioKCQkgKiBAcGFyYW0ge3N0cmluZ30gbmFtZQoJCSAqIEBwYXJhbSB7UmVjb3JkPHN0cmluZywgc3RyaW5nPn0gW29wdGlvbnNdCgkJICovCgkJY29uc3QgcGVyZk1hcmsgPSAobmFtZSwgb3B0aW9ucyA9IHt9KSA9PiB7CgkJCXBlcmZvcm1hbmNlLm1hcmsoYHdlYnZpZXcvaW5kZXguaHRtbC8ke25hbWV9YCwgewoJCQkJZGV0YWlsOiB7CgkJCQkJaWQ6IElELAoJCQkJCS4uLm9wdGlvbnMKCQkJCX0KCQkJfSk7CgkJfQoKCQlwZXJmTWFyaygnc2NyaXB0U3RhcnQnKTsKCgkJLyoqIEB0eXBlIHtNZXNzYWdlQ2hhbm5lbCB8IHVuZGVmaW5lZH0gKi8KCQlsZXQgb3V0ZXJJZnJhbWVNZXNzYWdlQ2hhbm5lbDsKCgkJLyoqCgkJICogVXNlIHBvbGxpbmcgdG8gdHJhY2sgZm9jdXMgb2YgbWFpbiB3ZWJ2aWV3IGFuZCBpZnJhbWVzIHdpdGhpbiB0aGUgd2VidmlldwoJCSAqCgkJICogQHBhcmFtIHtPYmplY3R9IGhhbmRsZXJzCgkJICogQHBhcmFtIHsoKSA9PiB2b2lkfSBoYW5kbGVycy5vbkZvY3VzCgkJICogQHBhcmFtIHsoKSA9PiB2b2lkfSBoYW5kbGVycy5vbkJsdXIKCQkgKi8KCQljb25zdCB0cmFja0ZvY3VzID0gKHsgb25Gb2N1cywgb25CbHVyIH0pID0+IHsKCQkJY29uc3QgaW50ZXJ2YWwgPSAyNTA7CgkJCWxldCBpc0ZvY3VzZWQgPSBkb2N1bWVudC5oYXNGb2N1cygpOwoJCQlzZXRJbnRlcnZhbCgoKSA9PiB7CgkJCQljb25zdCB0YXJnZXQgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJY29uc3QgaXNDdXJyZW50bHlGb2N1c2VkID0gZG9jdW1lbnQuaGFzRm9jdXMoKSB8fCAhISh0YXJnZXQgJiYgdGFyZ2V0LmNvbnRlbnREb2N1bWVudCAmJiB0YXJnZXQuY29udGVudERvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKCd2c2NvZGUtY29udGV4dC1tZW51LXZpc2libGUnKSk7CgkJCQlpZiAoaXNDdXJyZW50bHlGb2N1c2VkID09PSBpc0ZvY3VzZWQpIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCQlpc0ZvY3VzZWQgPSBpc0N1cnJlbnRseUZvY3VzZWQ7CgkJCQlpZiAoaXNDdXJyZW50bHlGb2N1c2VkKSB7CgkJCQkJb25Gb2N1cygpOwoJCQkJfSBlbHNlIHsKCQkJCQlvbkJsdXIoKTsKCQkJCX0KCQkJfSwgaW50ZXJ2YWwpOwoJCX07CgoJCWNvbnN0IGdldEFjdGl2ZUZyYW1lID0gKCkgPT4gewoJCQlyZXR1cm4gLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudCB8IHVuZGVmaW5lZH0gKi8gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3RpdmUtZnJhbWUnKSk7CgkJfTsKCgkJY29uc3QgZ2V0UGVuZGluZ0ZyYW1lID0gKCkgPT4gewoJCQlyZXR1cm4gLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudCB8IHVuZGVmaW5lZH0gKi8gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW5kaW5nLWZyYW1lJykpOwoJCX07CgoJCS8qKgoJCSAqIEB0ZW1wbGF0ZSBUCgkJICogQHBhcmFtIHtUIHwgdW5kZWZpbmVkIHwgbnVsbH0gb2JqCgkJICogQHJldHVybiB7VH0KCQkgKi8KCQlmdW5jdGlvbiBhc3NlcnRJc0RlZmluZWQob2JqKSB7CgkJCWlmICh0eXBlb2Ygb2JqID09PSAndW5kZWZpbmVkJyB8fCBvYmogPT09IG51bGwpIHsKCQkJCXRocm93IG5ldyBFcnJvcignRm91bmQgdW5leHBlY3RlZCBudWxsJyk7CgkJCX0KCQkJcmV0dXJuIG9iajsKCQl9CgoJCWNvbnN0IHZzY29kZVBvc3RNZXNzYWdlRnVuY05hbWUgPSAnX192c2NvZGVfcG9zdF9tZXNzYWdlX18nOwoKCQljb25zdCBkZWZhdWx0U3R5bGVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKCQlkZWZhdWx0U3R5bGVzLmlkID0gJ19kZWZhdWx0U3R5bGVzJzsKCQlkZWZhdWx0U3R5bGVzLnRleHRDb250ZW50ID0gYAoJCUBsYXllciB2c2NvZGUtZGVmYXVsdCB7CgkJCWh0bWwgewoJCQkJc2Nyb2xsYmFyLWNvbG9yOiB2YXIoLS12c2NvZGUtc2Nyb2xsYmFyU2xpZGVyLWJhY2tncm91bmQpIHZhcigtLXZzY29kZS1lZGl0b3ItYmFja2dyb3VuZCk7CgkJCX0KCgkJCWJvZHkgewoJCQkJb3ZlcnNjcm9sbC1iZWhhdmlvci14OiBub25lOwoJCQkJYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLWVkaXRvci1mb3JlZ3JvdW5kKTsKCQkJCWZvbnQtZmFtaWx5OiB2YXIoLS12c2NvZGUtZm9udC1mYW1pbHkpOwoJCQkJZm9udC13ZWlnaHQ6IHZhcigtLXZzY29kZS1mb250LXdlaWdodCk7CgkJCQlmb250LXNpemU6IHZhcigtLXZzY29kZS1mb250LXNpemUpOwoJCQkJbWFyZ2luOiAwOwoJCQkJcGFkZGluZzogMCAyMHB4OwoJCQl9CgoJCQlpbWcsIHZpZGVvIHsKCQkJCW1heC13aWR0aDogMTAwJTsKCQkJCW1heC1oZWlnaHQ6IDEwMCU7CgkJCX0KCgkJCWEsIGEgY29kZSB7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLXRleHRMaW5rLWZvcmVncm91bmQpOwoJCQl9CgoJCQlwID4gYSB7CgkJCQl0ZXh0LWRlY29yYXRpb246IHZhcigtLXRleHQtbGluay1kZWNvcmF0aW9uKTsKCQkJfQoKCQkJYTpob3ZlciB7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLXRleHRMaW5rLWFjdGl2ZUZvcmVncm91bmQpOwoJCQl9CgoJCQlhOmZvY3VzLAoJCQlpbnB1dDpmb2N1cywKCQkJc2VsZWN0OmZvY3VzLAoJCQl0ZXh0YXJlYTpmb2N1cyB7CgkJCQlvdXRsaW5lOiAxcHggc29saWQgLXdlYmtpdC1mb2N1cy1yaW5nLWNvbG9yOwoJCQkJb3V0bGluZS1vZmZzZXQ6IC0xcHg7CgkJCX0KCgkJCWNvZGUgewoJCQkJZm9udC1mYW1pbHk6IHZhcigtLW1vbmFjby1tb25vc3BhY2UtZm9udCk7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLXRleHRQcmVmb3JtYXQtZm9yZWdyb3VuZCk7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS12c2NvZGUtdGV4dFByZWZvcm1hdC1iYWNrZ3JvdW5kKTsKCQkJCXBhZGRpbmc6IDFweCAzcHg7CgkJCQlib3JkZXItcmFkaXVzOiA0cHg7CgkJCX0KCgkJCXByZSBjb2RlIHsKCQkJCXBhZGRpbmc6IDA7CgkJCX0KCgkJCWJsb2NrcXVvdGUgewoJCQkJYmFja2dyb3VuZDogdmFyKC0tdnNjb2RlLXRleHRCbG9ja1F1b3RlLWJhY2tncm91bmQpOwoJCQkJYm9yZGVyLWNvbG9yOiB2YXIoLS12c2NvZGUtdGV4dEJsb2NrUXVvdGUtYm9yZGVyKTsKCQkJfQoKCQkJa2JkIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1rZXliaW5kaW5nTGFiZWwtYmFja2dyb3VuZCk7CgkJCQljb2xvcjogdmFyKC0tdnNjb2RlLWtleWJpbmRpbmdMYWJlbC1mb3JlZ3JvdW5kKTsKCQkJCWJvcmRlci1zdHlsZTogc29saWQ7CgkJCQlib3JkZXItd2lkdGg6IDFweDsKCQkJCWJvcmRlci1yYWRpdXM6IDNweDsKCQkJCWJvcmRlci1jb2xvcjogdmFyKC0tdnNjb2RlLWtleWJpbmRpbmdMYWJlbC1ib3JkZXIpOwoJCQkJYm9yZGVyLWJvdHRvbS1jb2xvcjogdmFyKC0tdnNjb2RlLWtleWJpbmRpbmdMYWJlbC1ib3R0b21Cb3JkZXIpOwoJCQkJYm94LXNoYWRvdzogaW5zZXQgMCAtMXB4IDAgdmFyKC0tdnNjb2RlLXdpZGdldC1zaGFkb3cpOwoJCQkJdmVydGljYWwtYWxpZ246IG1pZGRsZTsKCQkJCXBhZGRpbmc6IDFweCAzcHg7CgkJCX0KCgkJCTo6LXdlYmtpdC1zY3JvbGxiYXIgewoJCQkJd2lkdGg6IDEwcHg7CgkJCQloZWlnaHQ6IDEwcHg7CgkJCX0KCgkJCTo6LXdlYmtpdC1zY3JvbGxiYXItY29ybmVyIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1lZGl0b3ItYmFja2dyb3VuZCk7CgkJCX0KCgkJCTo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgewoJCQkJYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tdnNjb2RlLXNjcm9sbGJhclNsaWRlci1iYWNrZ3JvdW5kKTsKCQkJfQoJCQk6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1zY3JvbGxiYXJTbGlkZXItaG92ZXJCYWNrZ3JvdW5kKTsKCQkJfQoJCQk6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmFjdGl2ZSB7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS12c2NvZGUtc2Nyb2xsYmFyU2xpZGVyLWFjdGl2ZUJhY2tncm91bmQpOwoJCQl9CgkJCTo6aGlnaGxpZ2h0KGZpbmQtaGlnaGxpZ2h0KSB7CgkJCQliYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS12c2NvZGUtZWRpdG9yLWZpbmRNYXRjaEhpZ2hsaWdodEJhY2tncm91bmQpOwoJCQl9CgkJCTo6aGlnaGxpZ2h0KGN1cnJlbnQtZmluZC1oaWdobGlnaHQpIHsKCQkJCWJhY2tncm91bmQtY29sb3I6IHZhcigtLXZzY29kZS1lZGl0b3ItZmluZE1hdGNoQmFja2dyb3VuZCk7CgkJCX0KCQkJfWA7CgoJCS8qKgoJCSAqIEBwYXJhbSB7Ym9vbGVhbn0gYWxsb3dNdWx0aXBsZUFQSUFjcXVpcmUKCQkgKiBAcGFyYW0geyp9IFtzdGF0ZV0KCQkgKiBAcmV0dXJuIHtzdHJpbmd9CgkJICovCgkJZnVuY3Rpb24gZ2V0VnNDb2RlQXBpU2NyaXB0KGFsbG93TXVsdGlwbGVBUElBY3F1aXJlLCBzdGF0ZSkgewoJCQljb25zdCBlbmNvZGVkU3RhdGUgPSBzdGF0ZSA/IGVuY29kZVVSSUNvbXBvbmVudChzdGF0ZSkgOiB1bmRlZmluZWQ7CgkJCXJldHVybiAvKiBqcyAqL2AKCQkJCQlnbG9iYWxUaGlzLmFjcXVpcmVWc0NvZGVBcGkgPSAoZnVuY3Rpb24oKSB7CgkJCQkJCWNvbnN0IG9yaWdpbmFsUG9zdE1lc3NhZ2UgPSB3aW5kb3cucGFyZW50Wycke3ZzY29kZVBvc3RNZXNzYWdlRnVuY05hbWV9J10uYmluZCh3aW5kb3cucGFyZW50KTsKCQkJCQkJY29uc3QgZG9Qb3N0TWVzc2FnZSA9IChjaGFubmVsLCBkYXRhLCB0cmFuc2ZlcikgPT4gewoJCQkJCQkJb3JpZ2luYWxQb3N0TWVzc2FnZShjaGFubmVsLCBkYXRhLCB0cmFuc2Zlcik7CgkJCQkJCX07CgoJCQkJCQlsZXQgYWNxdWlyZWQgPSBmYWxzZTsKCgkJCQkJCWxldCBzdGF0ZSA9ICR7c3RhdGUgPyBgSlNPTi5wYXJzZShkZWNvZGVVUklDb21wb25lbnQoIiR7ZW5jb2RlZFN0YXRlfSIpKWAgOiB1bmRlZmluZWR9OwoKCQkJCQkJcmV0dXJuICgpID0+IHsKCQkJCQkJCWlmIChhY3F1aXJlZCAmJiAhJHthbGxvd011bHRpcGxlQVBJQWNxdWlyZX0pIHsKCQkJCQkJCQl0aHJvdyBuZXcgRXJyb3IoJ0FuIGluc3RhbmNlIG9mIHRoZSBWUyBDb2RlIEFQSSBoYXMgYWxyZWFkeSBiZWVuIGFjcXVpcmVkJyk7CgkJCQkJCQl9CgkJCQkJCQlhY3F1aXJlZCA9IHRydWU7CgkJCQkJCQlyZXR1cm4gT2JqZWN0LmZyZWV6ZSh7CgkJCQkJCQkJcG9zdE1lc3NhZ2U6IGZ1bmN0aW9uKG1lc3NhZ2UsIHRyYW5zZmVyKSB7CgkJCQkJCQkJCWRvUG9zdE1lc3NhZ2UoJ29ubWVzc2FnZScsIHsgbWVzc2FnZSwgdHJhbnNmZXIgfSwgdHJhbnNmZXIpOwoJCQkJCQkJCX0sCgkJCQkJCQkJc2V0U3RhdGU6IGZ1bmN0aW9uKG5ld1N0YXRlKSB7CgkJCQkJCQkJCXN0YXRlID0gbmV3U3RhdGU7CgkJCQkJCQkJCWRvUG9zdE1lc3NhZ2UoJ2RvLXVwZGF0ZS1zdGF0ZScsIEpTT04uc3RyaW5naWZ5KG5ld1N0YXRlKSk7CgkJCQkJCQkJCXJldHVybiBuZXdTdGF0ZTsKCQkJCQkJCQl9LAoJCQkJCQkJCWdldFN0YXRlOiBmdW5jdGlvbigpIHsKCQkJCQkJCQkJcmV0dXJuIHN0YXRlOwoJCQkJCQkJCX0KCQkJCQkJCX0pOwoJCQkJCQl9OwoJCQkJCX0pKCk7CgkJCQkJd2luZG93LnBhcmVudCA9IHdpbmRvdzsKCQkJCQl3aW5kb3cudG9wID0gd2luZG93OwoJCQkJCXdpbmRvdy5mcmFtZUVsZW1lbnQgPSBudWxsOwoJCQkJYDsKCQl9CgoJCS8qKiBAdHlwZSB7UHJvbWlzZTx2b2lkPn0gKi8KCQljb25zdCB3b3JrZXJSZWFkeSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKCQkJaWYgKGRpc2FibGVTZXJ2aWNlV29ya2VyKSB7CgkJCQlyZXR1cm4gcmVzb2x2ZSgpOwoJCQl9CgoJCQlpZiAoIWFyZVNlcnZpY2VXb3JrZXJzRW5hYmxlZCgpKSB7CgkJCQlyZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignU2VydmljZSBXb3JrZXJzIGFyZSBub3QgZW5hYmxlZC4gV2Vidmlld3Mgd2lsbCBub3Qgd29yay4gVHJ5IGRpc2FibGluZyBwcml2YXRlL2luY29nbml0byBtb2RlLicpKTsKCQkJfQoKCQkJY29uc3Qgc3dQYXRoID0gZW5jb2RlVVJJKGAke3NlcnZpY2VXb3JrZXJVcml9P3Y9JHtleHBlY3RlZFdvcmtlclZlcnNpb259JnZzY29kZS1yZXNvdXJjZS1iYXNlLWF1dGhvcml0eT0ke3NlYXJjaFBhcmFtcy5nZXQoJ3ZzY29kZS1yZXNvdXJjZS1iYXNlLWF1dGhvcml0eScpfSZyZW1vdGVBdXRob3JpdHk9JHtzZWFyY2hQYXJhbXMuZ2V0KCdyZW1vdGVBdXRob3JpdHknKSA/PyAnJ31gKTsKCQkJbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoc3dQYXRoLCB7IHR5cGU6ICdtb2R1bGUnIH0pCgkJCQkudGhlbihhc3luYyByZWdpc3RyYXRpb24gPT4gewoJCQkJCS8qKgoJCQkJCSAqIEBwYXJhbSB7TWVzc2FnZUV2ZW50fSBldmVudAoJCQkJCSAqLwoJCQkJCWNvbnN0IHZlcnNpb25IYW5kbGVyID0gYXN5bmMgKGV2ZW50KSA9PiB7CgkJCQkJCWlmIChldmVudC5kYXRhLmNoYW5uZWwgIT09ICd2ZXJzaW9uJykgewoJCQkJCQkJcmV0dXJuOwoJCQkJCQl9CgoJCQkJCQluYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdmVyc2lvbkhhbmRsZXIpOwoJCQkJCQlpZiAoZXZlbnQuZGF0YS52ZXJzaW9uID09PSBleHBlY3RlZFdvcmtlclZlcnNpb24pIHsKCQkJCQkJCXJldHVybiByZXNvbHZlKCk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljb25zb2xlLmxvZyhgRm91bmQgdW5leHBlY3RlZCBzZXJ2aWNlIHdvcmtlciB2ZXJzaW9uLiBGb3VuZDogJHtldmVudC5kYXRhLnZlcnNpb259LiBFeHBlY3RlZDogJHtleHBlY3RlZFdvcmtlclZlcnNpb259YCk7CgkJCQkJCQljb25zb2xlLmxvZyhgQXR0ZW1wdGluZyB0byByZWxvYWQgc2VydmljZSB3b3JrZXJgKTsKCgkJCQkJCQkvLyBJZiB3ZSBoYXZlIHRoZSB3cm9uZyB2ZXJzaW9uLCB0cnkgb25jZSAoYW5kIG9ubHkgb25jZSkgdG8gdW5yZWdpc3RlciBhbmQgcmUtcmVnaXN0ZXIKCQkJCQkJCS8vIE5vdGUgdGhhdCBgLnVwZGF0ZWAgZG9lc24ndCBzZWVtIHRvIHdvcmsgZGVza3RvcCBlbGVjdHJvbiBhdCB0aGUgbW9tZW50IHNvIHdlIHVzZQoJCQkJCQkJLy8gYHVucmVnaXN0ZXJgIGFuZCBgcmVnaXN0ZXJgIGhlcmUuCgkJCQkJCQlyZXR1cm4gcmVnaXN0cmF0aW9uLnVucmVnaXN0ZXIoKQoJCQkJCQkJCS50aGVuKCgpID0+IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKHN3UGF0aCkpCgkJCQkJCQkJLmZpbmFsbHkoKCkgPT4geyByZXNvbHZlKCk7IH0pOwoJCQkJCQl9CgkJCQkJfTsKCQkJCQluYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdmVyc2lvbkhhbmRsZXIpOwoKCQkJCQljb25zdCBwb3N0VmVyc2lvbk1lc3NhZ2UgPSAoLyoqIEB0eXBlIHtTZXJ2aWNlV29ya2VyfSAqLyBjb250cm9sbGVyKSA9PiB7CgkJCQkJCW91dGVySWZyYW1lTWVzc2FnZUNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTsKCQkJCQkJY29udHJvbGxlci5wb3N0TWVzc2FnZSh7IGNoYW5uZWw6ICd2ZXJzaW9uJyB9LCBbb3V0ZXJJZnJhbWVNZXNzYWdlQ2hhbm5lbC5wb3J0Ml0pOwoJCQkJCX07CgoJCQkJCS8vIEF0IHRoaXMgcG9pbnQsIGVpdGhlciB0aGUgc2VydmljZSB3b3JrZXIgaXMgcmVhZHkgYW5kCgkJCQkJLy8gYmVjYW1lIG91ciBjb250cm9sbGVyLCBvciB3ZSBuZWVkIHRvIHdhaXQgZm9yIGl0LgoJCQkJCS8vIE5vdGUgdGhhdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyIGNvdWxkIGJlIGEKCQkJCQkvLyBjb250cm9sbGVyIGZyb20gYSBwcmV2aW91c2x5IGxvYWRlZCBzZXJ2aWNlIHdvcmtlci4KCQkJCQljb25zdCBjdXJyZW50Q29udHJvbGxlciA9IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXI7CgkJCQkJaWYgKGN1cnJlbnRDb250cm9sbGVyPy5zY3JpcHRVUkwuZW5kc1dpdGgoc3dQYXRoKSkgewoJCQkJCQkvLyBzZXJ2aWNlIHdvcmtlciBhbHJlYWR5IGxvYWRlZCAmIHJlYWR5IHRvIHJlY2VpdmUgbWVzc2FnZXMKCQkJCQkJcG9zdFZlcnNpb25NZXNzYWdlKGN1cnJlbnRDb250cm9sbGVyKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlpZiAoY3VycmVudENvbnRyb2xsZXIpIHsKCQkJCQkJCWNvbnNvbGUubG9nKGBGb3VuZCB1bmV4cGVjdGVkIHNlcnZpY2Ugd29ya2VyIGNvbnRyb2xsZXIuIEZvdW5kOiAke2N1cnJlbnRDb250cm9sbGVyLnNjcmlwdFVSTH0uIEV4cGVjdGVkOiAke3N3UGF0aH0uIFdhaXRpbmcgZm9yIGNvbnRyb2xsZXJjaGFuZ2UuYCk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQljb25zb2xlLmxvZyhgTm8gc2VydmljZSB3b3JrZXIgY29udHJvbGxlciBmb3VuZC4gV2FpdGluZyBmb3IgY29udHJvbGxlcmNoYW5nZS5gKTsKCQkJCQkJfQoKCQkJCQkJLy8gRWl0aGVyIHRoZXJlJ3Mgbm8gY29udHJvbGxpbmcgc2VydmljZSB3b3JrZXIsIG9yIGl0J3MgYW4gb2xkIG9uZS4KCQkJCQkJLy8gV2FpdCBmb3IgaXQgdG8gY2hhbmdlIGJlZm9yZSBwb3N0aW5nIHRoZSBtZXNzYWdlCgkJCQkJCWNvbnN0IG9uQ29udHJvbGxlckNoYW5nZSA9ICgpID0+IHsKCQkJCQkJCW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjaGFuZ2UnLCBvbkNvbnRyb2xsZXJDaGFuZ2UpOwoJCQkJCQkJaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHsKCQkJCQkJCQlwb3N0VmVyc2lvbk1lc3NhZ2UobmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlcik7CgkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCXJldHVybiByZWplY3QobmV3IEVycm9yKCdObyBjb250cm9sbGVyIGZvdW5kLicpKTsKCQkJCQkJCX0KCQkJCQkJfTsKCQkJCQkJbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNoYW5nZScsIG9uQ29udHJvbGxlckNoYW5nZSk7CgkJCQkJfQoJCQkJfSkuY2F0Y2goZXJyb3IgPT4gewoJCQkJCWlmICghb25FbGVjdHJvbiAmJiBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3VzZXIgZGVuaWVkIHBlcm1pc3Npb24nKSkgewoJCQkJCQlyZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihgQ291bGQgbm90IHJlZ2lzdGVyIHNlcnZpY2Ugd29ya2VyLiBQbGVhc2UgbWFrZSBzdXJlIHRoaXJkIHBhcnR5IGNvb2tpZXMgYXJlIGVuYWJsZWQ6ICR7ZXJyb3J9YCkpOwoJCQkJCX0KCQkJCQlyZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihgQ291bGQgbm90IHJlZ2lzdGVyIHNlcnZpY2Ugd29ya2VyOiAke2Vycm9yfS5gKSk7CgkJCQl9KTsKCQl9KTsKCgkJLyoqCgkJICogIEB0eXBlIHtpbXBvcnQoJy4uL3dlYnZpZXdNZXNzYWdlcycpLldlYnZpZXdIb3N0TWVzc2FnaW5nfQoJCSAqLwoJCWNvbnN0IGhvc3RNZXNzYWdpbmcgPSBuZXcgY2xhc3MgSG9zdE1lc3NhZ2luZyB7CgoJCQljb25zdHJ1Y3RvcigpIHsKCQkJCXRoaXMuY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwoKCQkJCS8qKiBAdHlwZSB7TWFwPHN0cmluZywgQXJyYXk8KGV2ZW50OiBNZXNzYWdlRXZlbnQsIGRhdGE6IGFueSkgPT4gdm9pZD4+fSAqLwoJCQkJdGhpcy5oYW5kbGVycyA9IG5ldyBNYXAoKTsKCgkJCQl0aGlzLmNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gKGUpID0+IHsKCQkJCQljb25zdCBjaGFubmVsID0gZS5kYXRhLmNoYW5uZWw7CgkJCQkJY29uc3QgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmdldChjaGFubmVsKTsKCQkJCQlpZiAoaGFuZGxlcnMpIHsKCQkJCQkJZm9yIChjb25zdCBoYW5kbGVyIG9mIGhhbmRsZXJzKSB7CgkJCQkJCQloYW5kbGVyKGUsIGUuZGF0YS5hcmdzKTsKCQkJCQkJfQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNvbnNvbGUubG9nKCdubyBoYW5kbGVyIGZvciAnLCBlKTsKCQkJCQl9CgkJCQl9OwoJCQl9CgoJCQlwb3N0TWVzc2FnZShjaGFubmVsLCBkYXRhLCB0cmFuc2ZlcikgewoJCQkJdGhpcy5jaGFubmVsLnBvcnQxLnBvc3RNZXNzYWdlKHsgY2hhbm5lbCwgZGF0YSB9LCB0cmFuc2Zlcik7CgkJCX0KCgkJCW9uTWVzc2FnZShjaGFubmVsLCBoYW5kbGVyKSB7CgkJCQlsZXQgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzLmdldChjaGFubmVsKTsKCQkJCWlmICghaGFuZGxlcnMpIHsKCQkJCQloYW5kbGVycyA9IFtdOwoJCQkJCXRoaXMuaGFuZGxlcnMuc2V0KGNoYW5uZWwsIGhhbmRsZXJzKTsKCQkJCX0KCQkJCWhhbmRsZXJzLnB1c2goaGFuZGxlcik7CgkJCX0KCgkJCWFzeW5jIHNpZ25hbFJlYWR5KCkgewoJCQkJY29uc3Qgc3RhcnQgPSAoLyoqIEB0eXBlIHtzdHJpbmd9ICovIHBhcmVudE9yaWdpbikgPT4gewoJCQkJCXBlcmZNYXJrKCdzaWduYWxpbmdSZWFkeScpOwoJCQkJCXdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoeyB0YXJnZXQ6IElELCBjaGFubmVsOiAnd2Vidmlldy1yZWFkeScsIGRhdGE6IHt9IH0sIHBhcmVudE9yaWdpbiwgW3RoaXMuY2hhbm5lbC5wb3J0Ml0pOwoJCQkJfTsKCgkJCQljb25zdCBwYXJlbnRPcmlnaW4gPSBzZWFyY2hQYXJhbXMuZ2V0KCdwYXJlbnRPcmlnaW4nKTsKCgkJCQlyZXR1cm4gc3RhcnQocGFyZW50T3JpZ2luKTsKCQkJfQoJCX0oKTsKCgkJY29uc3QgdW5sb2FkTW9uaXRvciA9IG5ldyBjbGFzcyB7CgoJCQljb25zdHJ1Y3RvcigpIHsKCQkJCXRoaXMuY29uZmlybUJlZm9yZUNsb3NlID0gJ2tleWJvYXJkT25seSc7CgkJCQl0aGlzLmlzTW9kaWZpZXJLZXlEb3duID0gZmFsc2U7CgoJCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ3NldC1jb25maXJtLWJlZm9yZS1jbG9zZScsIChfZSwgZGF0YSkgPT4gewoJCQkJCXRoaXMuY29uZmlybUJlZm9yZUNsb3NlID0gZGF0YTsKCQkJCX0pOwoKCQkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdjb250ZW50JywgKF9lLCBkYXRhKSA9PiB7CgkJCQkJdGhpcy5jb25maXJtQmVmb3JlQ2xvc2UgPSBkYXRhLmNvbmZpcm1CZWZvcmVDbG9zZTsKCQkJCX0pOwoKCQkJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCAoZXZlbnQpID0+IHsKCQkJCQlpZiAob25FbGVjdHJvbikgewoJCQkJCQlyZXR1cm47CgkJCQkJfQoKCQkJCQlzd2l0Y2ggKHRoaXMuY29uZmlybUJlZm9yZUNsb3NlKSB7CgkJCQkJCWNhc2UgJ2Fsd2F5cyc6IHsKCQkJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQkJCQlldmVudC5yZXR1cm5WYWx1ZSA9ICcnOwoJCQkJCQkJcmV0dXJuICcnOwoJCQkJCQl9CgkJCQkJCWNhc2UgJ25ldmVyJzogewoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQkJY2FzZSAna2V5Ym9hcmRPbmx5JzoKCQkJCQkJZGVmYXVsdDogewoJCQkJCQkJaWYgKHRoaXMuaXNNb2RpZmllcktleURvd24pIHsKCQkJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQkJCWV2ZW50LnJldHVyblZhbHVlID0gJyc7CgkJCQkJCQkJcmV0dXJuICcnOwoJCQkJCQkJfQoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQl9KTsKCQkJfQoKCQkJb25JZnJhbWVMb2FkZWQoLyoqIEB0eXBlIHtIVE1MSUZyYW1lRWxlbWVudH0gKi8gZnJhbWUpIHsKCQkJCWFzc2VydElzRGVmaW5lZChmcmFtZS5jb250ZW50V2luZG93KS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZSA9PiB7CgkJCQkJdGhpcy5pc01vZGlmaWVyS2V5RG93biA9IGUubWV0YUtleSB8fCBlLmN0cmxLZXkgfHwgZS5hbHRLZXk7CgkJCQl9KTsKCgkJCQlhc3NlcnRJc0RlZmluZWQoZnJhbWUuY29udGVudFdpbmRvdykuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoKSA9PiB7CgkJCQkJdGhpcy5pc01vZGlmaWVyS2V5RG93biA9IGZhbHNlOwoJCQkJfSk7CgkJCX0KCQl9OwoKCQkvLyBzdGF0ZQoJCWxldCBmaXJzdExvYWQgPSB0cnVlOwoJCS8qKiBAdHlwZSB7YW55fSAqLwoJCWxldCBsb2FkVGltZW91dDsKCQlsZXQgc3R5bGVWZXJzaW9uID0gMDsKCgkJLyoqIEB0eXBlIHtBcnJheTx7IHJlYWRvbmx5IG1lc3NhZ2U6IGFueSwgdHJhbnNmZXI/OiBBcnJheUJ1ZmZlcltdIH0+fSAqLwoJCWxldCBwZW5kaW5nTWVzc2FnZXMgPSBbXTsKCgkJY29uc3QgaW5pdERhdGEgPSB7CgkJCS8qKiBAdHlwZSB7bnVtYmVyIHwgdW5kZWZpbmVkfSAqLwoJCQlpbml0aWFsU2Nyb2xsUHJvZ3Jlc3M6IHVuZGVmaW5lZCwKCgkJCS8qKiBAdHlwZSB7eyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSB8IHVuZGVmaW5lZH0gKi8KCQkJc3R5bGVzOiB1bmRlZmluZWQsCgoJCQkvKiogQHR5cGUge3N0cmluZyB8IHVuZGVmaW5lZH0gKi8KCQkJYWN0aXZlVGhlbWU6IHVuZGVmaW5lZCwKCgkJCS8qKiBAdHlwZSB7c3RyaW5nIHwgdW5kZWZpbmVkfSAqLwoJCQl0aGVtZUlkOiB1bmRlZmluZWQsCgoJCQkvKiogQHR5cGUge3N0cmluZyB8IHVuZGVmaW5lZH0gKi8KCQkJdGhlbWVMYWJlbDogdW5kZWZpbmVkLAoKCQkJLyoqIEB0eXBlIHtib29sZWFufSAqLwoJCQlzY3JlZW5SZWFkZXI6IGZhbHNlLAoKCQkJLyoqIEB0eXBlIHtib29sZWFufSAqLwoJCQlyZWR1Y2VNb3Rpb246IGZhbHNlLAoJCX07CgoJCWlmICghZGlzYWJsZVNlcnZpY2VXb3JrZXIpIHsKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ2RpZC1sb2FkLXJlc291cmNlJywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJYXNzZXJ0SXNEZWZpbmVkKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpLnBvc3RNZXNzYWdlKHsgY2hhbm5lbDogJ2RpZC1sb2FkLXJlc291cmNlJywgZGF0YSB9LCBkYXRhLmRhdGE/LmJ1ZmZlciA/IFtkYXRhLmRhdGEuYnVmZmVyXSA6IFtdKTsKCQkJfSk7CgoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnZGlkLWxvYWQtbG9jYWxob3N0JywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJYXNzZXJ0SXNEZWZpbmVkKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpLnBvc3RNZXNzYWdlKHsgY2hhbm5lbDogJ2RpZC1sb2FkLWxvY2FsaG9zdCcsIGRhdGEgfSk7CgkJCX0pOwoKCQkJbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGV2ZW50ID0+IHsKCQkJCXN3aXRjaCAoZXZlbnQuZGF0YS5jaGFubmVsKSB7CgkJCQkJY2FzZSAnbG9hZC1yZXNvdXJjZSc6CgkJCQkJY2FzZSAnbG9hZC1sb2NhbGhvc3QnOgoJCQkJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKGV2ZW50LmRhdGEuY2hhbm5lbCwgZXZlbnQuZGF0YSk7CgkJCQkJCXJldHVybjsKCQkJCX0KCQkJfSk7CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge0hUTUxEb2N1bWVudD99IGRvY3VtZW50CgkJICogQHBhcmFtIHtIVE1MRWxlbWVudD99IGJvZHkKCQkgKi8KCQljb25zdCBhcHBseVN0eWxlcyA9IChkb2N1bWVudCwgYm9keSkgPT4gewoJCQlpZiAoIWRvY3VtZW50KSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmIChib2R5KSB7CgkJCQlib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3ZzY29kZS1saWdodCcsICd2c2NvZGUtZGFyaycsICd2c2NvZGUtaGlnaC1jb250cmFzdCcsICd2c2NvZGUtaGlnaC1jb250cmFzdC1saWdodCcsICd2c2NvZGUtcmVkdWNlLW1vdGlvbicsICd2c2NvZGUtdXNpbmctc2NyZWVuLXJlYWRlcicpOwoKCQkJCWlmIChpbml0RGF0YS5hY3RpdmVUaGVtZSkgewoJCQkJCWJvZHkuY2xhc3NMaXN0LmFkZChpbml0RGF0YS5hY3RpdmVUaGVtZSk7CgkJCQkJaWYgKGluaXREYXRhLmFjdGl2ZVRoZW1lID09PSAndnNjb2RlLWhpZ2gtY29udHJhc3QtbGlnaHQnKSB7CgkJCQkJCS8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5CgkJCQkJCWJvZHkuY2xhc3NMaXN0LmFkZCgndnNjb2RlLWhpZ2gtY29udHJhc3QnKTsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGluaXREYXRhLnJlZHVjZU1vdGlvbikgewoJCQkJCWJvZHkuY2xhc3NMaXN0LmFkZCgndnNjb2RlLXJlZHVjZS1tb3Rpb24nKTsKCQkJCX0KCgkJCQlpZiAoaW5pdERhdGEuc2NyZWVuUmVhZGVyKSB7CgkJCQkJYm9keS5jbGFzc0xpc3QuYWRkKCd2c2NvZGUtdXNpbmctc2NyZWVuLXJlYWRlcicpOwoJCQkJfQoKCQkJCWJvZHkuZGF0YXNldC52c2NvZGVUaGVtZUtpbmQgPSBpbml0RGF0YS5hY3RpdmVUaGVtZTsKCQkJCS8qKiBAZGVwcmVjYXRlZCBkYXRhLXZzY29kZS10aGVtZS1uYW1lIHdpbGwgYmUgcmVtb3ZlZCwgdXNlIGRhdGEtdnNjb2RlLXRoZW1lLWlkIGluc3RlYWQgKi8KCQkJCWJvZHkuZGF0YXNldC52c2NvZGVUaGVtZU5hbWUgPSBpbml0RGF0YS50aGVtZUxhYmVsIHx8ICcnOwoJCQkJYm9keS5kYXRhc2V0LnZzY29kZVRoZW1lSWQgPSBpbml0RGF0YS50aGVtZUlkIHx8ICcnOwoJCQl9CgoJCQlpZiAoaW5pdERhdGEuc3R5bGVzKSB7CgkJCQljb25zdCBkb2N1bWVudFN0eWxlID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlOwoKCQkJCS8vIFJlbW92ZSBzdGFsZSBwcm9wZXJ0aWVzCgkJCQlmb3IgKGxldCBpID0gZG9jdW1lbnRTdHlsZS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewoJCQkJCWNvbnN0IHByb3BlcnR5ID0gZG9jdW1lbnRTdHlsZVtpXTsKCgkJCQkJLy8gRG9uJ3QgcmVtb3ZlIHByb3BlcnRpZXMgdGhhdCB0aGUgd2VidmlldyBtaWdodCBoYXZlIGFkZGVkIHNlcGFyYXRlbHkKCQkJCQlpZiAocHJvcGVydHkgJiYgcHJvcGVydHkuc3RhcnRzV2l0aCgnLS12c2NvZGUtJykpIHsKCQkJCQkJZG9jdW1lbnRTdHlsZS5yZW1vdmVQcm9wZXJ0eShwcm9wZXJ0eSk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFJlLWFkZCBuZXcgcHJvcGVydGllcwoJCQkJZm9yIChjb25zdCBbdmFyaWFibGUsIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhpbml0RGF0YS5zdHlsZXMpKSB7CgkJCQkJZG9jdW1lbnRTdHlsZS5zZXRQcm9wZXJ0eShgLS0ke3ZhcmlhYmxlfWAsIHZhbHVlKTsKCQkJCX0KCQkJfQoJCX07CgoJCS8qKgoJCSAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZlbnQKCQkgKi8KCQljb25zdCBoYW5kbGVJbm5lckNsaWNrID0gKGV2ZW50KSA9PiB7CgkJCWlmICghZXZlbnQ/LnZpZXc/LmRvY3VtZW50KSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWNvbnN0IGJhc2VFbGVtZW50ID0gZXZlbnQudmlldy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdiYXNlJyk7CgoJCQlmb3IgKGNvbnN0IHBhdGhFbGVtZW50IG9mIGV2ZW50LmNvbXBvc2VkUGF0aCgpKSB7CgkJCQkvKiogQHR5cGUge2FueX0gKi8KCQkJCWNvbnN0IG5vZGUgPSBwYXRoRWxlbWVudDsKCQkJCWlmIChub2RlLnRhZ05hbWUgJiYgbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJyAmJiBub2RlLmhyZWYpIHsKCQkJCQlpZiAobm9kZS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSA9PT0gJyMnKSB7CgkJCQkJCWV2ZW50LnZpZXcuc2Nyb2xsVG8oMCwgMCk7CgkJCQkJfSBlbHNlIGlmIChub2RlLmhhc2ggJiYgKG5vZGUuZ2V0QXR0cmlidXRlKCdocmVmJykgPT09IG5vZGUuaGFzaCB8fCAoYmFzZUVsZW1lbnQgJiYgbm9kZS5ocmVmID09PSBiYXNlRWxlbWVudC5ocmVmICsgbm9kZS5oYXNoKSkpIHsKCQkJCQkJY29uc3QgZnJhZ21lbnQgPSBub2RlLmhhc2guc2xpY2UoMSk7CgkJCQkJCWNvbnN0IGRlY29kZWRGcmFnbWVudCA9IGRlY29kZVVSSUNvbXBvbmVudChmcmFnbWVudCk7CgkJCQkJCWNvbnN0IHNjcm9sbFRhcmdldCA9IGV2ZW50LnZpZXcuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZnJhZ21lbnQpID8/IGV2ZW50LnZpZXcuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGVjb2RlZEZyYWdtZW50KTsKCQkJCQkJaWYgKHNjcm9sbFRhcmdldCkgewoJCQkJCQkJc2Nyb2xsVGFyZ2V0LnNjcm9sbEludG9WaWV3KCk7CgkJCQkJCX0gZWxzZSBpZiAoZGVjb2RlZEZyYWdtZW50LnRvTG93ZXJDYXNlKCkgPT09ICd0b3AnKSB7CgkJCQkJCQlldmVudC52aWV3LnNjcm9sbFRvKDAsIDApOwoJCQkJCQl9CgkJCQkJfSBlbHNlIHsKCQkJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWNsaWNrLWxpbmsnLCB7IHVyaTogbm9kZS5ocmVmLmJhc2VWYWwgfHwgbm9kZS5ocmVmIH0pOwoJCQkJCX0KCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJfQoJCX07CgoJCS8qKgoJCSAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZlbnQKCQkgKi8KCQljb25zdCBoYW5kbGVBdXhDbGljayA9IChldmVudCkgPT4gewoJCQkvLyBQcmV2ZW50IG1pZGRsZSBjbGlja3Mgb3BlbmluZyBhIGJyb2tlbiBsaW5rIGluIHRoZSBicm93c2VyCgkJCWlmICghZXZlbnQ/LnZpZXc/LmRvY3VtZW50KSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmIChldmVudC5idXR0b24gPT09IDEpIHsKCQkJCWZvciAoY29uc3QgcGF0aEVsZW1lbnQgb2YgZXZlbnQuY29tcG9zZWRQYXRoKCkpIHsKCQkJCQkvKiogQHR5cGUge2FueX0gKi8KCQkJCQljb25zdCBub2RlID0gcGF0aEVsZW1lbnQ7CgkJCQkJaWYgKG5vZGUudGFnTmFtZSAmJiBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIG5vZGUuaHJlZikgewoJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICovCgkJY29uc3QgaGFuZGxlSW5uZXJLZXlkb3duID0gKGUpID0+IHsKCQkJLy8gSWYgdGhlIGtleXByZXNzIHdvdWxkIHRyaWdnZXIgYSBicm93c2VyIGV2ZW50LCBzdWNoIGFzIGNvcHkgb3IgcGFzdGUsCgkJCS8vIG1ha2Ugc3VyZSB3ZSBibG9jayB0aGUgYnJvd3NlciBmcm9tIGRpc3BhdGNoaW5nIGl0LiBJbnN0ZWFkIFZTIENvZGUKCQkJLy8gaGFuZGxlcyB0aGVzZSBldmVudHMgYW5kIHdpbGwgZGlzcGF0Y2ggYSBjb3B5L3Bhc3RlIGJhY2sgdG8gdGhlIHdlYnZpZXcKCQkJLy8gaWYgbmVlZGVkCgkJCWlmIChpc1VuZG9SZWRvKGUpIHx8IGlzUHJpbnQoZSkgfHwgaXNGaW5kRXZlbnQoZSkgfHwgaXNTYXZlRXZlbnQoZSkpIHsKCQkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJfSBlbHNlIGlmIChpc0NvcHlQYXN0ZU9yQ3V0KGUpKSB7CgkJCQlpZiAob25FbGVjdHJvbikgewoJCQkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJCX0gZWxzZSB7CgkJCQkJcmV0dXJuOyAvLyBsZXQgdGhlIGJyb3dzZXIgaGFuZGxlIHRoaXMKCQkJCX0KCQkJfSBlbHNlIGlmICghb25FbGVjdHJvbiAmJiAoaXNDbG9zZVRhYihlKSB8fCBpc05ld1dpbmRvdyhlKSB8fCBpc0hlbHAoZSkgfHwgaXNSZWZyZXNoKGUpKSkgewoJCQkJLy8gUHJldmVudCBDdHJsK1cgY2xvc2luZyB3aW5kb3cgLyBDdHJsK04gb3BlbmluZyBuZXcgd2luZG93IGluIFBXQS4KCQkJCS8vIChObyBlZmZlY3QgaW4gYSByZWd1bGFyIGJyb3dzZXIgdGFiLikKCQkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJfQoKCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWtleWRvd24nLCB7CgkJCQlrZXk6IGUua2V5LAoJCQkJa2V5Q29kZTogZS5rZXlDb2RlLAoJCQkJY29kZTogZS5jb2RlLAoJCQkJc2hpZnRLZXk6IGUuc2hpZnRLZXksCgkJCQlhbHRLZXk6IGUuYWx0S2V5LAoJCQkJY3RybEtleTogZS5jdHJsS2V5LAoJCQkJbWV0YUtleTogZS5tZXRhS2V5LAoJCQkJcmVwZWF0OiBlLnJlcGVhdAoJCQl9KTsKCQl9OwoJCS8qKgoJCSAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZQoJCSAqLwoJCWNvbnN0IGhhbmRsZUlubmVyS2V5dXAgPSAoZSkgPT4gewoJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKCdkaWQta2V5dXAnLCB7CgkJCQlrZXk6IGUua2V5LAoJCQkJa2V5Q29kZTogZS5rZXlDb2RlLAoJCQkJY29kZTogZS5jb2RlLAoJCQkJc2hpZnRLZXk6IGUuc2hpZnRLZXksCgkJCQlhbHRLZXk6IGUuYWx0S2V5LAoJCQkJY3RybEtleTogZS5jdHJsS2V5LAoJCQkJbWV0YUtleTogZS5tZXRhS2V5LAoJCQkJcmVwZWF0OiBlLnJlcGVhdAoJCQl9KTsKCQl9OwoKCQkvKioKCQkgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGUKCQkgKiBAcmV0dXJuIHtib29sZWFufQoJCSAqLwoJCWZ1bmN0aW9uIGlzQ29weVBhc3RlT3JDdXQoZSkgewoJCQljb25zdCBoYXNNZXRhID0gZS5jdHJsS2V5IHx8IGUubWV0YUtleTsKCQkJLy8gNDU6IGtleUNvZGUgb2YgIkluc2VydCIKCQkJY29uc3Qgc2hpZnRJbnNlcnQgPSBlLnNoaWZ0S2V5ICYmIGUua2V5Q29kZSA9PT0gNDU7CgkJCS8vIDY3LCA4NiwgODg6IGtleUNvZGUgb2YgIkMiLCAiViIsICJYIgoJCQlyZXR1cm4gKGhhc01ldGEgJiYgWzY3LCA4NiwgODhdLmluY2x1ZGVzKGUua2V5Q29kZSkpIHx8IHNoaWZ0SW5zZXJ0OwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc1VuZG9SZWRvKGUpIHsKCQkJY29uc3QgaGFzTWV0YSA9IGUuY3RybEtleSB8fCBlLm1ldGFLZXk7CgkJCS8vIDkwLCA4OToga2V5Q29kZSBvZiAiWiIsICJZIgoJCQlyZXR1cm4gaGFzTWV0YSAmJiBbOTAsIDg5XS5pbmNsdWRlcyhlLmtleUNvZGUpOwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc1ByaW50KGUpIHsKCQkJY29uc3QgaGFzTWV0YSA9IGUuY3RybEtleSB8fCBlLm1ldGFLZXk7CgkJCS8vIDgwOiBrZXlDb2RlIG9mICJQIgoJCQlyZXR1cm4gaGFzTWV0YSAmJiBlLmtleUNvZGUgPT09IDgwOwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc0ZpbmRFdmVudChlKSB7CgkJCWNvbnN0IGhhc01ldGEgPSBlLmN0cmxLZXkgfHwgZS5tZXRhS2V5OwoJCQkvLyA3MDoga2V5Q29kZSBvZiAiRiIKCQkJcmV0dXJuIGhhc01ldGEgJiYgZS5rZXlDb2RlID09PSA3MDsKCQl9CgoJCS8qKgoJCSAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZQoJCSAqIEByZXR1cm4ge2Jvb2xlYW59CgkJICovCgkJZnVuY3Rpb24gaXNTYXZlRXZlbnQoZSkgewoJCQljb25zdCBoYXNNZXRhID0gZS5jdHJsS2V5IHx8IGUubWV0YUtleTsKCQkJLy8gODM6IGtleUNvZGUgb2YgIlMiCgkJCXJldHVybiBoYXNNZXRhICYmIGUua2V5Q29kZSA9PT0gODM7CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGUKCQkgKiBAcmV0dXJuIHtib29sZWFufQoJCSAqLwoJCWZ1bmN0aW9uIGlzQ2xvc2VUYWIoZSkgewoJCQljb25zdCBoYXNNZXRhID0gZS5jdHJsS2V5IHx8IGUubWV0YUtleTsKCQkJLy8gODc6IGtleUNvZGUgb2YgIlciCgkJCXJldHVybiBoYXNNZXRhICYmIGUua2V5Q29kZSA9PT0gODc7CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGUKCQkgKiBAcmV0dXJuIHtib29sZWFufQoJCSAqLwoJCWZ1bmN0aW9uIGlzTmV3V2luZG93KGUpIHsKCQkJY29uc3QgaGFzTWV0YSA9IGUuY3RybEtleSB8fCBlLm1ldGFLZXk7CgkJCS8vIDc4OiBrZXlDb2RlIG9mICJOIgoJCQlyZXR1cm4gaGFzTWV0YSAmJiBlLmtleUNvZGUgPT09IDc4OwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQkgZnVuY3Rpb24gaXNIZWxwKGUpIHsKCQkJLy8gMTEyOiBrZXlDb2RlIG9mICJGMSIKCQkJcmV0dXJuIGUua2V5Q29kZSA9PT0gMTEyOwoJCX0KCgkJLyoqCgkJICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBlCgkJICogQHJldHVybiB7Ym9vbGVhbn0KCQkgKi8KCQlmdW5jdGlvbiBpc1JlZnJlc2goZSkgewoJCQkvLyAxMTY6IGtleUNvZGUgb2YgIkY1IgoJCQlyZXR1cm4gZS5rZXlDb2RlID09PSAxMTY7CgkJfQoKCQlsZXQgaXNIYW5kbGluZ1Njcm9sbCA9IGZhbHNlOwoKCQkvKioKCQkgKiBAcGFyYW0ge1doZWVsRXZlbnR9IGV2ZW50CgkJICovCgkJY29uc3QgaGFuZGxlV2hlZWwgPSAoZXZlbnQpID0+IHsKCQkJaWYgKGlzSGFuZGxpbmdTY3JvbGwpIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLXNjcm9sbC13aGVlbCcsIHsKCQkJCWRlbHRhTW9kZTogZXZlbnQuZGVsdGFNb2RlLAoJCQkJZGVsdGFYOiBldmVudC5kZWx0YVgsCgkJCQlkZWx0YVk6IGV2ZW50LmRlbHRhWSwKCQkJCWRlbHRhWjogZXZlbnQuZGVsdGFaLAoJCQkJZGV0YWlsOiBldmVudC5kZXRhaWwsCgkJCQl0eXBlOiBldmVudC50eXBlCgkJCX0pOwoJCX07CgoJCS8qKgoJCSAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50CgkJICovCgkJY29uc3QgaGFuZGxlSW5uZXJTY3JvbGwgPSAoZXZlbnQpID0+IHsKCQkJaWYgKGlzSGFuZGxpbmdTY3JvbGwpIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJY29uc3QgdGFyZ2V0ID0gLyoqIEB0eXBlIHtIVE1MRG9jdW1lbnQgfCBudWxsfSAqLyAoZXZlbnQudGFyZ2V0KTsKCQkJY29uc3QgY3VycmVudFRhcmdldCA9IC8qKiBAdHlwZSB7V2luZG93IHwgbnVsbH0gKi8gKGV2ZW50LmN1cnJlbnRUYXJnZXQpOwoJCQlpZiAoIWN1cnJlbnRUYXJnZXQgfHwgIXRhcmdldD8uYm9keSkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQljb25zdCBwcm9ncmVzcyA9IGN1cnJlbnRUYXJnZXQuc2Nyb2xsWSAvIHRhcmdldC5ib2R5LmNsaWVudEhlaWdodDsKCQkJaWYgKGlzTmFOKHByb2dyZXNzKSkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQlpc0hhbmRsaW5nU2Nyb2xsID0gdHJ1ZTsKCQkJd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7CgkJCQl0cnkgewoJCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RpZC1zY3JvbGwnLCB7IHNjcm9sbFlQZXJjZW50YWdlOiBwcm9ncmVzcyB9KTsKCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQkvLyBub29wCgkJCQl9CgkJCQlpc0hhbmRsaW5nU2Nyb2xsID0gZmFsc2U7CgkJCX0pOwoJCX07CgoJCWZ1bmN0aW9uIGhhbmRsZUlubmVyRHJhZ1N0YXJ0RXZlbnQoLyoqIEB0eXBlIHtEcmFnRXZlbnR9ICovIGUpIHsKCQkJaWYgKGUuZGVmYXVsdFByZXZlbnRlZCkgewoJCQkJLy8gRXh0ZW5zaW9uIGNvZGUgaGFzIGFscmVhZHkgaGFuZGxlZCB0aGlzIGV2ZW50CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmICghZS5kYXRhVHJhbnNmZXIgfHwgZS5zaGlmdEtleSkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBPbmx5IGhhbmRsZSBkcmFncyBmcm9tIG91dHNpZGUgZWRpdG9yIGZvciBub3cKCQkJaWYgKGUuZGF0YVRyYW5zZmVyLml0ZW1zLmxlbmd0aCAmJiBBcnJheS5wcm90b3R5cGUuZXZlcnkuY2FsbChlLmRhdGFUcmFuc2Zlci5pdGVtcywgaXRlbSA9PiBpdGVtLmtpbmQgPT09ICdmaWxlJykpIHsKCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RyYWctc3RhcnQnLCB1bmRlZmluZWQpOwoJCQl9CgkJfQoKCgkJZnVuY3Rpb24gaGFuZGxlSW5uZXJEcmFnRXZlbnQoLyoqIEB0eXBlIHtEcmFnRXZlbnR9ICovIGUpIHsKCQkJLyoqCgkJCSAqIFRvIGVuc3VyZSB0aGF0IHRoZSBkcm9wIGV2ZW50IGFsd2F5cyBmaXJlcyBhcyBleHBlY3RlZCwgeW91IHNob3VsZCBhbHdheXMgaW5jbHVkZSBhIHByZXZlbnREZWZhdWx0KCkgY2FsbCBpbiB0aGUgcGFydCBvZiB5b3VyIGNvZGUgd2hpY2ggaGFuZGxlcyB0aGUgZHJhZ292ZXIgZXZlbnQuCgkJCSAqIHNvdXJjZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxFbGVtZW50L2Ryb3BfZXZlbnQKCQkJICoqLwoJCQllLnByZXZlbnREZWZhdWx0KCk7CgoJCQlpZiAoIWUuZGF0YVRyYW5zZmVyKSB7CgkJCQlyZXR1cm47CgkJCX0KCgoJCQkvLyBPbmx5IGhhbmRsZSBkcmFncyBmcm9tIG91dHNpZGUgZWRpdG9yIGZvciBub3cKCQkJaWYgKGUuZGF0YVRyYW5zZmVyLml0ZW1zLmxlbmd0aCAmJiBBcnJheS5wcm90b3R5cGUuZXZlcnkuY2FsbChlLmRhdGFUcmFuc2Zlci5pdGVtcywgaXRlbSA9PiBpdGVtLmtpbmQgPT09ICdmaWxlJykpIHsKCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RyYWcnLCB7CgkJCQkJc2hpZnRLZXk6IGUuc2hpZnRLZXkKCQkJCX0pOwoJCQl9CgoJCX0KCgkJZnVuY3Rpb24gaGFuZGxlSW5uZXJEcm9wRXZlbnQoLyoqQHR5cGUge0RyYWdFdmVudH0gKi9lKSB7CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQl9CgoJCS8qKgoJCSAqIEBwYXJhbSB7KCkgPT4gdm9pZH0gY2FsbGJhY2sKCQkgKi8KCQlmdW5jdGlvbiBvbkRvbVJlYWR5KGNhbGxiYWNrKSB7CgkJCWlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnaW50ZXJhY3RpdmUnIHx8IGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHsKCQkJCWNhbGxiYWNrKCk7CgkJCX0gZWxzZSB7CgkJCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgY2FsbGJhY2spOwoJCQl9CgkJfQoKCQlmdW5jdGlvbiBhcmVTZXJ2aWNlV29ya2Vyc0VuYWJsZWQoKSB7CgkJCXRyeSB7CgkJCQlyZXR1cm4gISFuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcjsKCQkJfSBjYXRjaCAoZSkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJfQoKCQkvKioKCQkgKiBAcGFyYW0ge2ltcG9ydCgnLi4vd2Vidmlld01lc3NhZ2VzJykuVXBkYXRlQ29udGVudEV2ZW50fSBkYXRhCgkJICogQHJldHVybiB7c3RyaW5nfQoJCSAqLwoJCWZ1bmN0aW9uIHRvQ29udGVudEh0bWwoZGF0YSkgewoJCQljb25zdCBvcHRpb25zID0gZGF0YS5vcHRpb25zOwoJCQljb25zdCB0ZXh0ID0gZGF0YS5jb250ZW50czsKCQkJY29uc3QgbmV3RG9jdW1lbnQgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHRleHQsICd0ZXh0L2h0bWwnKTsKCgkJCW5ld0RvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKS5mb3JFYWNoKGEgPT4gewoJCQkJaWYgKCFhLnRpdGxlKSB7CgkJCQkJY29uc3QgaHJlZiA9IGEuZ2V0QXR0cmlidXRlKCdocmVmJyk7CgkJCQkJaWYgKHR5cGVvZiBocmVmID09PSAnc3RyaW5nJykgewoJCQkJCQlhLnRpdGxlID0gaHJlZjsKCQkJCQl9CgkJCQl9CgkJCX0pOwoKCQkJLy8gU2V0IGRlZmF1bHQgYXJpYSByb2xlCgkJCWlmICghbmV3RG9jdW1lbnQuYm9keS5oYXNBdHRyaWJ1dGUoJ3JvbGUnKSkgewoJCQkJbmV3RG9jdW1lbnQuYm9keS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnZG9jdW1lbnQnKTsKCQkJfQoKCQkJLy8gSW5qZWN0IGRlZmF1bHQgc2NyaXB0CgkJCWlmIChvcHRpb25zLmFsbG93U2NyaXB0cykgewoJCQkJY29uc3QgZGVmYXVsdFNjcmlwdCA9IG5ld0RvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwoJCQkJZGVmYXVsdFNjcmlwdC5pZCA9ICdfdnNjb2RlQXBpU2NyaXB0JzsKCQkJCWRlZmF1bHRTY3JpcHQudGV4dENvbnRlbnQgPSBnZXRWc0NvZGVBcGlTY3JpcHQob3B0aW9ucy5hbGxvd011bHRpcGxlQVBJQWNxdWlyZSwgZGF0YS5zdGF0ZSk7CgkJCQluZXdEb2N1bWVudC5oZWFkLnByZXBlbmQoZGVmYXVsdFNjcmlwdCk7CgkJCX0KCgkJCS8vIEluamVjdCBkZWZhdWx0IHN0eWxlcwoJCQluZXdEb2N1bWVudC5oZWFkLnByZXBlbmQoZGVmYXVsdFN0eWxlcy5jbG9uZU5vZGUodHJ1ZSkpOwoKCQkJYXBwbHlTdHlsZXMobmV3RG9jdW1lbnQsIG5ld0RvY3VtZW50LmJvZHkpOwoKCQkJLy8gU3RyaXAgb3V0IHVuc3VwcG9ydGVkIGh0dHAtZXF1aXYgdGFncwoJCQlmb3IgKGNvbnN0IG1ldGFFbGVtZW50IG9mIEFycmF5LmZyb20obmV3RG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbWV0YScpKSkgewoJCQkJY29uc3QgaHR0cEVxdWl2ID0gbWV0YUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdodHRwLWVxdWl2Jyk7CgkJCQlpZiAoaHR0cEVxdWl2ICYmICEvXihjb250ZW50LXNlY3VyaXR5LXBvbGljeXxkZWZhdWx0LXN0eWxlfGNvbnRlbnQtdHlwZSkkL2kudGVzdChodHRwRXF1aXYpKSB7CgkJCQkJY29uc29sZS53YXJuKGBSZW1vdmluZyB1bnN1cHBvcnRlZCBtZXRhIGh0dHAtZXF1aXY6ICR7aHR0cEVxdWl2fWApOwoJCQkJCW1ldGFFbGVtZW50LnJlbW92ZSgpOwoJCQkJfQoJCQl9CgoJCQkvLyBDaGVjayBmb3IgQ1NQCgkJCWNvbnN0IGNzcCA9IG5ld0RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21ldGFbaHR0cC1lcXVpdj0iQ29udGVudC1TZWN1cml0eS1Qb2xpY3kiXScpOwoJCQlpZiAoIWNzcCkgewoJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnbm8tY3NwLWZvdW5kJywgdW5kZWZpbmVkKTsKCQkJfSBlbHNlIHsKCQkJCXRyeSB7CgkJCQkJLy8gQXR0ZW1wdCB0byByZXdyaXRlIENTUHMgdGhhdCBoYXJkY29kZSBvbGQtc3R5bGUgcmVzb3VyY2UgZW5kcG9pbnQKCQkJCQljb25zdCBjc3BDb250ZW50ID0gY3NwLmdldEF0dHJpYnV0ZSgnY29udGVudCcpOwoJCQkJCWlmIChjc3BDb250ZW50KSB7CgkJCQkJCWNvbnN0IG5ld0NzcCA9IGNzcENvbnRlbnQucmVwbGFjZSgvKHZzY29kZS13ZWJ2aWV3LXJlc291cmNlfHZzY29kZS1yZXNvdXJjZSk6KD89KFxzfDt8JCkpL2csIGRhdGEuY3NwU291cmNlKTsKCQkJCQkJY3NwLnNldEF0dHJpYnV0ZSgnY29udGVudCcsIG5ld0NzcCk7CgkJCQkJfQoJCQkJfSBjYXRjaCAoZSkgewoJCQkJCWNvbnNvbGUuZXJyb3IoYENvdWxkIG5vdCByZXdyaXRlIGNzcDogJHtlfWApOwoJCQkJfQoJCQl9CgoJCQkvLyBzZXQgRE9DVFlQRSBmb3IgbmV3RG9jdW1lbnQgZXhwbGljaXRseSBhcyBET01QYXJzZXIucGFyc2VGcm9tU3RyaW5nIHN0cmlwcyBpdCBvZmYKCQkJLy8gYW5kIERPQ1RZUEUgaXMgbmVlZGVkIGluIHRoZSBpZnJhbWUgdG8gZW5zdXJlIHRoYXQgdGhlIHVzZXIgYWdlbnQgc3R5bGVzaGVldCBpcyBjb3JyZWN0bHkgb3ZlcnJpZGRlbgoJCQlyZXR1cm4gJzwhRE9DVFlQRSBodG1sPlxuJyArIG5ld0RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vdXRlckhUTUw7CgkJfQoKCQkvLyBBbHNvIGZvcndhcmQgZXZlbnRzIGJlZm9yZSB0aGUgY29udGVudHMgb2YgdGhlIHdlYnZpZXcgaGF2ZSBsb2FkZWQKCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUlubmVyS2V5ZG93bik7CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgaGFuZGxlSW5uZXJLZXl1cCk7CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGhhbmRsZUlubmVyRHJhZ1N0YXJ0RXZlbnQpOwoJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGhhbmRsZUlubmVyRHJhZ0V2ZW50KTsKCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJhZycsIGhhbmRsZUlubmVyRHJhZ0V2ZW50KTsKCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGhhbmRsZUlubmVyRHJvcEV2ZW50KTsKCgoJCW9uRG9tUmVhZHkoKCkgPT4gewoJCQlpZiAoIWRvY3VtZW50LmJvZHkpIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ3N0eWxlcycsIChfZXZlbnQsIGRhdGEpID0+IHsKCQkJCSsrc3R5bGVWZXJzaW9uOwoKCQkJCWluaXREYXRhLnN0eWxlcyA9IGRhdGEuc3R5bGVzOwoJCQkJaW5pdERhdGEuYWN0aXZlVGhlbWUgPSBkYXRhLmFjdGl2ZVRoZW1lOwoJCQkJaW5pdERhdGEudGhlbWVMYWJlbCA9IGRhdGEudGhlbWVMYWJlbDsKCQkJCWluaXREYXRhLnRoZW1lSWQgPSBkYXRhLnRoZW1lSWQ7CgkJCQlpbml0RGF0YS5yZWR1Y2VNb3Rpb24gPSBkYXRhLnJlZHVjZU1vdGlvbjsKCQkJCWluaXREYXRhLnNjcmVlblJlYWRlciA9IGRhdGEuc2NyZWVuUmVhZGVyOwoKCQkJCWNvbnN0IHRhcmdldCA9IGdldEFjdGl2ZUZyYW1lKCk7CgkJCQlpZiAoIXRhcmdldCkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAodGFyZ2V0LmNvbnRlbnREb2N1bWVudCkgewoJCQkJCWFwcGx5U3R5bGVzKHRhcmdldC5jb250ZW50RG9jdW1lbnQsIHRhcmdldC5jb250ZW50RG9jdW1lbnQuYm9keSk7CgkJCQl9CgkJCX0pOwoKCQkJLy8gcHJvcGFnYXRlIGZvY3VzCgkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdmb2N1cycsICgpID0+IHsKCQkJCWNvbnN0IGFjdGl2ZUZyYW1lID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCWlmICghYWN0aXZlRnJhbWUgfHwgIWFjdGl2ZUZyYW1lLmNvbnRlbnRXaW5kb3cpIHsKCQkJCQkvLyBGb2N1cyB0aGUgdG9wIGxldmVsIHdlYnZpZXcgaW5zdGVhZAoJCQkJCXdpbmRvdy5mb2N1cygpOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gYWN0aXZlRnJhbWUpIHsKCQkJCQkvLyBXZSBhcmUgYWxyZWFkeSBmb2N1c2VkIG9uIHRoZSBpZnJhbWUgKG9yIG9uZSBvZiBpdHMgY2hpbGRyZW4pIHNvIG5vIG5lZWQKCQkJCQkvLyB0byByZWZvY3VzLgoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlhY3RpdmVGcmFtZS5jb250ZW50V2luZG93LmZvY3VzKCk7CgkJCX0pOwoKCQkJLy8gdXBkYXRlIGlmcmFtZS1jb250ZW50cwoJCQlsZXQgdXBkYXRlSWQgPSAwOwoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnY29udGVudCcsIGFzeW5jIChfZXZlbnQsIC8qKiBAdHlwZSB7aW1wb3J0KCcuLi93ZWJ2aWV3TWVzc2FnZXMnKS5VcGRhdGVDb250ZW50RXZlbnR9ICovIGRhdGEpID0+IHsKCQkJCXBlcmZNYXJrKCdjb250ZW50L3N0YXJ0ZWQnKTsKCgkJCQljb25zdCBjdXJyZW50VXBkYXRlSWQgPSArK3VwZGF0ZUlkOwoJCQkJdHJ5IHsKCQkJCQlhd2FpdCB3b3JrZXJSZWFkeTsKCQkJCQlwZXJmTWFyaygnY29udGVudC93b3JrZXJSZWFkeScpOwoJCQkJfSBjYXRjaCAoZSkgewoJCQkJCWNvbnNvbGUuZXJyb3IoYFdlYnZpZXcgZmF0YWwgZXJyb3I6ICR7ZX1gKTsKCQkJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKCdmYXRhbC1lcnJvcicsIHsgbWVzc2FnZTogZSArICcnIH0pOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAoY3VycmVudFVwZGF0ZUlkICE9PSB1cGRhdGVJZCkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQljb25zdCBvcHRpb25zID0gZGF0YS5vcHRpb25zOwoJCQkJY29uc3QgbmV3RG9jdW1lbnQgPSB0b0NvbnRlbnRIdG1sKGRhdGEpOwoKCQkJCWNvbnN0IGluaXRpYWxTdHlsZVZlcnNpb24gPSBzdHlsZVZlcnNpb247CgoJCQkJY29uc3QgZnJhbWUgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJY29uc3Qgd2FzRmlyc3RMb2FkID0gZmlyc3RMb2FkOwoJCQkJLy8ga2VlcCBjdXJyZW50IHNjcm9sbFkgYXJvdW5kIGFuZCB1c2UgbGF0ZXIKCQkJCS8qKiBAdHlwZSB7KGJvZHk6IEhUTUxFbGVtZW50LCB3aW5kb3c6IFdpbmRvdykgPT4gdm9pZH0gKi8KCQkJCWxldCBzZXRJbml0aWFsU2Nyb2xsUG9zaXRpb247CgkJCQlpZiAoZmlyc3RMb2FkKSB7CgkJCQkJZmlyc3RMb2FkID0gZmFsc2U7CgkJCQkJc2V0SW5pdGlhbFNjcm9sbFBvc2l0aW9uID0gKGJvZHksIHdpbmRvdykgPT4gewoJCQkJCQlpZiAodHlwZW9mIGluaXREYXRhLmluaXRpYWxTY3JvbGxQcm9ncmVzcyA9PT0gJ251bWJlcicgJiYgIWlzTmFOKGluaXREYXRhLmluaXRpYWxTY3JvbGxQcm9ncmVzcykpIHsKCQkJCQkJCWlmICh3aW5kb3cuc2Nyb2xsWSA9PT0gMCkgewoJCQkJCQkJCXdpbmRvdy5zY3JvbGwoMCwgYm9keS5jbGllbnRIZWlnaHQgKiBpbml0RGF0YS5pbml0aWFsU2Nyb2xsUHJvZ3Jlc3MpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfTsKCQkJCX0gZWxzZSB7CgkJCQkJY29uc3Qgc2Nyb2xsWSA9IGZyYW1lICYmIGZyYW1lLmNvbnRlbnREb2N1bWVudCAmJiBmcmFtZS5jb250ZW50RG9jdW1lbnQuYm9keSA/IGFzc2VydElzRGVmaW5lZChmcmFtZS5jb250ZW50V2luZG93KS5zY3JvbGxZIDogMDsKCQkJCQlzZXRJbml0aWFsU2Nyb2xsUG9zaXRpb24gPSAoYm9keSwgd2luZG93KSA9PiB7CgkJCQkJCWlmICh3aW5kb3cuc2Nyb2xsWSA9PT0gMCkgewoJCQkJCQkJd2luZG93LnNjcm9sbCgwLCBzY3JvbGxZKTsKCQkJCQkJfQoJCQkJCX07CgkJCQl9CgoJCQkJLy8gQ2xlYW4gdXAgb2xkIHBlbmRpbmcgZnJhbWVzIGFuZCBzZXQgY3VycmVudCBvbmUgYXMgbmV3IG9uZQoJCQkJY29uc3QgcHJldmlvdXNQZW5kaW5nRnJhbWUgPSBnZXRQZW5kaW5nRnJhbWUoKTsKCQkJCWlmIChwcmV2aW91c1BlbmRpbmdGcmFtZSkgewoJCQkJCXByZXZpb3VzUGVuZGluZ0ZyYW1lLnNldEF0dHJpYnV0ZSgnaWQnLCAnJyk7CgkJCQkJcHJldmlvdXNQZW5kaW5nRnJhbWUucmVtb3ZlKCk7CgkJCQl9CgkJCQlpZiAoIXdhc0ZpcnN0TG9hZCkgewoJCQkJCXBlbmRpbmdNZXNzYWdlcyA9IFtdOwoJCQkJfQoKCQkJCWNvbnN0IG5ld0ZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CgkJCQluZXdGcmFtZS50aXRsZSA9IGRhdGEudGl0bGU7CgkJCQluZXdGcmFtZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3BlbmRpbmctZnJhbWUnKTsKCQkJCW5ld0ZyYW1lLnNldEF0dHJpYnV0ZSgnZnJhbWVib3JkZXInLCAnMCcpOwoKCQkJCWNvbnN0IHNhbmRib3hSdWxlcyA9IG5ldyBTZXQoWydhbGxvdy1zYW1lLW9yaWdpbicsICdhbGxvdy1wb2ludGVyLWxvY2snXSk7CgkJCQlpZiAob3B0aW9ucy5hbGxvd1NjcmlwdHMpIHsKCQkJCQlzYW5kYm94UnVsZXMuYWRkKCdhbGxvdy1zY3JpcHRzJyk7CgkJCQkJc2FuZGJveFJ1bGVzLmFkZCgnYWxsb3ctZG93bmxvYWRzJyk7CgkJCQl9CgkJCQlpZiAob3B0aW9ucy5hbGxvd0Zvcm1zKSB7CgkJCQkJc2FuZGJveFJ1bGVzLmFkZCgnYWxsb3ctZm9ybXMnKTsKCQkJCX0KCQkJCW5ld0ZyYW1lLnNldEF0dHJpYnV0ZSgnc2FuZGJveCcsIEFycmF5LmZyb20oc2FuZGJveFJ1bGVzKS5qb2luKCcgJykpOwoKCQkJCWNvbnN0IGFsbG93UnVsZXMgPSBbJ2Nyb3NzLW9yaWdpbi1pc29sYXRlZDsnLCAnYXV0b3BsYXk7JywgJ2xvY2FsLW5ldHdvcmstYWNjZXNzOyddOwoJCQkJaWYgKCFpc0ZpcmVmb3ggJiYgb3B0aW9ucy5hbGxvd1NjcmlwdHMpIHsKCQkJCQlhbGxvd1J1bGVzLnB1c2goJ2NsaXBib2FyZC1yZWFkOycsICdjbGlwYm9hcmQtd3JpdGU7Jyk7CgkJCQl9CgkJCQluZXdGcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93JywgYWxsb3dSdWxlcy5qb2luKCcgJykpOwoJCQkJLy8gV2Ugc2hvdWxkIGp1c3QgYmUgYWJsZSB0byB1c2Ugc3JjZG9jLCBidXQgSSB3YXNuJ3QKCQkJCS8vIHNlZWluZyB0aGUgc2VydmljZSB3b3JrZXIgYXBwbHlpbmcgcHJvcGVybHkuCgkJCQkvLyBGYWtlIGxvYWQgYW4gZW1wdHkgb24gdGhlIGNvcnJlY3Qgb3JpZ2luIGFuZCB0aGVuIHdyaXRlIHJlYWwgaHRtbAoJCQkJLy8gaW50byBpdCB0byBnZXQgYXJvdW5kIHRoaXMuCgkJCQljb25zdCBmYWtlVXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7IGlkOiBJRCB9KTsKCQkJCWlmIChnbG9iYWxUaGlzLmNyb3NzT3JpZ2luSXNvbGF0ZWQpIHsKCQkJCQlmYWtlVXJsUGFyYW1zLnNldCgndnNjb2RlLWNvaScsICczJyk7IC8qQ09PUCtDT0VQKi8KCQkJCX0KCQkJCW5ld0ZyYW1lLnNyYyA9IGAke2Zha2VIdG1sVXJpfT8ke2Zha2VVcmxQYXJhbXMudG9TdHJpbmcoKX1gOwoKCQkJCW5ld0ZyYW1lLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTogYmxvY2s7IG1hcmdpbjogMDsgb3ZlcmZsb3c6IGhpZGRlbjsgcG9zaXRpb246IGFic29sdXRlOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyB2aXNpYmlsaXR5OiBoaWRkZW4nOwoJCQkJZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChuZXdGcmFtZSk7CgoJCQkJbmV3RnJhbWUuY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlSW5uZXJLZXlkb3duKTsKCQkJCW5ld0ZyYW1lLmNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBoYW5kbGVJbm5lcktleXVwKTsKCgkJCQkvKioKCQkJCSAqIEBwYXJhbSB7RG9jdW1lbnR9IGNvbnRlbnREb2N1bWVudAoJCQkJICovCgkJCQlmdW5jdGlvbiBvbkZyYW1lTG9hZGVkKGNvbnRlbnREb2N1bWVudCkgewoJCQkJCXBlcmZNYXJrKCdjb250ZW50L2lubmVyRnJhbWVMb2FkZWQnKQoKCQkJCQkvLyBXb3JrYXJvdW5kIGZvciBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD05NzgzMjUKCQkJCQlzZXRUaW1lb3V0KCgpID0+IHsKCQkJCQkJY29udGVudERvY3VtZW50Lm9wZW4oKTsKCQkJCQkJY29udGVudERvY3VtZW50LndyaXRlKG5ld0RvY3VtZW50KTsKCQkJCQkJY29udGVudERvY3VtZW50LmNsb3NlKCk7CgkJCQkJCWhvb2t1cE9uTG9hZEhhbmRsZXJzKG5ld0ZyYW1lKTsKCQkJCQkJcGVyZk1hcmsoJ2NvbnRlbnQvd3JvdGVJbm5lckNvbnRlbnQnKQoKCQkJCQkJaWYgKGluaXRpYWxTdHlsZVZlcnNpb24gIT09IHN0eWxlVmVyc2lvbikgewoJCQkJCQkJYXBwbHlTdHlsZXMoY29udGVudERvY3VtZW50LCBjb250ZW50RG9jdW1lbnQuYm9keSk7CgkJCQkJCX0KCQkJCQl9LCAwKTsKCQkJCX0KCgkJCQlpZiAoIW9wdGlvbnMuYWxsb3dTY3JpcHRzICYmIGlzU2FmYXJpKSB7CgkJCQkJLy8gT24gU2FmYXJpIGZvciBpZnJhbWVzIHdpdGggc2NyaXB0cyBkaXNhYmxlZCwgdGhlIGBET01Db250ZW50TG9hZGVkYCBuZXZlciBzZWVtcyB0byBiZSBmaXJlZDogaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTMzNjA0CgkJCQkJLy8gVXNlIHBvbGxpbmcgaW5zdGVhZC4KCQkJCQljb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsKCQkJCQkJLy8gSWYgdGhlIGZyYW1lIGlzIG5vIGxvbmdlciBtb3VudGVkLCBsb2FkaW5nIGhhcyBzdG9wcGVkCgkJCQkJCWlmICghbmV3RnJhbWUucGFyZW50RWxlbWVudCkgewoJCQkJCQkJY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7CgkJCQkJCQlyZXR1cm47CgkJCQkJCX0KCgkJCQkJCWNvbnN0IGNvbnRlbnREb2N1bWVudCA9IGFzc2VydElzRGVmaW5lZChuZXdGcmFtZS5jb250ZW50RG9jdW1lbnQpOwoJCQkJCQlpZiAoY29udGVudERvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lLmVuZHNXaXRoKCcvZmFrZS5odG1sJykgJiYgY29udGVudERvY3VtZW50LnJlYWR5U3RhdGUgIT09ICdsb2FkaW5nJykgewoJCQkJCQkJY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7CgkJCQkJCQlvbkZyYW1lTG9hZGVkKGNvbnRlbnREb2N1bWVudCk7CgkJCQkJCX0KCQkJCQl9LCAxMCk7CgkJCQl9IGVsc2UgewoJCQkJCWFzc2VydElzRGVmaW5lZChuZXdGcmFtZS5jb250ZW50V2luZG93KS5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZSA9PiB7CgkJCQkJCWNvbnN0IGNvbnRlbnREb2N1bWVudCA9IGUudGFyZ2V0ID8gKC8qKiBAdHlwZSB7SFRNTERvY3VtZW50fSAqLyAoZS50YXJnZXQpKSA6IHVuZGVmaW5lZDsKCQkJCQkJb25GcmFtZUxvYWRlZChhc3NlcnRJc0RlZmluZWQoY29udGVudERvY3VtZW50KSk7CgkJCQkJfSk7CgkJCQl9CgoJCQkJLyoqCgkJCQkgKiBAcGFyYW0ge0RvY3VtZW50fSBjb250ZW50RG9jdW1lbnQKCQkJCSAqIEBwYXJhbSB7V2luZG93fSBjb250ZW50V2luZG93CgkJCQkgKi8KCQkJCWNvbnN0IG9uTG9hZCA9IChjb250ZW50RG9jdW1lbnQsIGNvbnRlbnRXaW5kb3cpID0+IHsKCQkJCQlpZiAoY29udGVudERvY3VtZW50ICYmIGNvbnRlbnREb2N1bWVudC5ib2R5KSB7CgkJCQkJCS8vIFdvcmthcm91bmQgZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlL2lzc3Vlcy8xMjg2NQoJCQkJCQkvLyBjaGVjayBuZXcgc2Nyb2xsWSBhbmQgcmVzZXQgaWYgbmVjZXNzYXJ5CgkJCQkJCXNldEluaXRpYWxTY3JvbGxQb3NpdGlvbihjb250ZW50RG9jdW1lbnQuYm9keSwgY29udGVudFdpbmRvdyk7CgkJCQkJfQoKCQkJCQljb25zdCBuZXdGcmFtZSA9IGdldFBlbmRpbmdGcmFtZSgpOwoJCQkJCWlmIChuZXdGcmFtZSAmJiBuZXdGcmFtZS5jb250ZW50RG9jdW1lbnQgJiYgbmV3RnJhbWUuY29udGVudERvY3VtZW50ID09PSBjb250ZW50RG9jdW1lbnQpIHsKCQkJCQkJY29uc3Qgd2FzRm9jdXNlZCA9IGRvY3VtZW50Lmhhc0ZvY3VzKCk7CgkJCQkJCWNvbnN0IG9sZEFjdGl2ZUZyYW1lID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCQkJb2xkQWN0aXZlRnJhbWU/LnJlbW92ZSgpOwoJCQkJCQkvLyBTdHlsZXMgbWF5IGhhdmUgY2hhbmdlZCBzaW5jZSB3ZSBjcmVhdGVkIHRoZSBlbGVtZW50LiBNYWtlIHN1cmUgd2UgcmUtc3R5bGUKCQkJCQkJaWYgKGluaXRpYWxTdHlsZVZlcnNpb24gIT09IHN0eWxlVmVyc2lvbikgewoJCQkJCQkJYXBwbHlTdHlsZXMobmV3RnJhbWUuY29udGVudERvY3VtZW50LCBuZXdGcmFtZS5jb250ZW50RG9jdW1lbnQuYm9keSk7CgkJCQkJCX0KCQkJCQkJbmV3RnJhbWUuc2V0QXR0cmlidXRlKCdpZCcsICdhY3RpdmUtZnJhbWUnKTsKCQkJCQkJbmV3RnJhbWUuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJzsKCgkJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgaGFuZGxlSW5uZXJTY3JvbGwpOwoJCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgaGFuZGxlV2hlZWwpOwoKCQkJCQkJaWYgKHdhc0ZvY3VzZWQpIHsKCQkJCQkJCWNvbnRlbnRXaW5kb3cuZm9jdXMoKTsKCQkJCQkJfQoKCQkJCQkJLy8gR2V0IGJvZHkgc2l6ZQoJCQkJCQljb25zdCBkb2NFbCA9IGNvbnRlbnREb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgkJCQkJCWlmIChkb2NFbCkgewoJCQkJCQkJY29uc3QgcG9zdFNpemUgPSAoKSA9PiB7CgkJCQkJCQkJaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgndXBkYXRlZC1pbnRyaW5zaWMtY29udGVudC1zaXplJywgewoJCQkJCQkJCQl3aWR0aDogZG9jRWwub2Zmc2V0V2lkdGgsCgkJCQkJCQkJCWhlaWdodDogZG9jRWwub2Zmc2V0SGVpZ2h0CgkJCQkJCQkJfSk7CgkJCQkJCQl9OwoKCQkJCQkJCWNvbnN0IHJlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKHBvc3RTaXplKTsKCQkJCQkJCXJlc2l6ZU9ic2VydmVyLm9ic2VydmUoZG9jRWwpOwoJCQkJCQkJcG9zdFNpemUoKTsKCQkJCQkJfQoKCQkJCQkJcGVuZGluZ01lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UpID0+IHsKCQkJCQkJCWNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UobWVzc2FnZS5tZXNzYWdlLCB3aW5kb3cub3JpZ2luLCBtZXNzYWdlLnRyYW5zZmVyKTsKCQkJCQkJfSk7CgkJCQkJCXBlbmRpbmdNZXNzYWdlcyA9IFtdOwoJCQkJCX0KCQkJCX07CgoJCQkJLyoqCgkJCQkgKiBAcGFyYW0ge0hUTUxJRnJhbWVFbGVtZW50fSBuZXdGcmFtZQoJCQkJICovCgkJCQlmdW5jdGlvbiBob29rdXBPbkxvYWRIYW5kbGVycyhuZXdGcmFtZSkgewoJCQkJCWNsZWFyVGltZW91dChsb2FkVGltZW91dCk7CgkJCQkJbG9hZFRpbWVvdXQgPSB1bmRlZmluZWQ7CgkJCQkJbG9hZFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKCQkJCQkJY2xlYXJUaW1lb3V0KGxvYWRUaW1lb3V0KTsKCQkJCQkJbG9hZFRpbWVvdXQgPSB1bmRlZmluZWQ7CgkJCQkJCW9uTG9hZChhc3NlcnRJc0RlZmluZWQobmV3RnJhbWUuY29udGVudERvY3VtZW50KSwgYXNzZXJ0SXNEZWZpbmVkKG5ld0ZyYW1lLmNvbnRlbnRXaW5kb3cpKTsKCQkJCQl9LCAyMDApOwoKCQkJCQljb25zdCBjb250ZW50V2luZG93ID0gYXNzZXJ0SXNEZWZpbmVkKG5ld0ZyYW1lLmNvbnRlbnRXaW5kb3cpOwoKCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoZSkgewoJCQkJCQljb25zdCBjb250ZW50RG9jdW1lbnQgPSAvKiogQHR5cGUge0RvY3VtZW50fSAqLyAoZS50YXJnZXQpOwoKCQkJCQkJaWYgKGxvYWRUaW1lb3V0KSB7CgkJCQkJCQljbGVhclRpbWVvdXQobG9hZFRpbWVvdXQpOwoJCQkJCQkJbG9hZFRpbWVvdXQgPSB1bmRlZmluZWQ7CgkJCQkJCQlvbkxvYWQoY29udGVudERvY3VtZW50LCB0aGlzKTsKCQkJCQkJfQoJCQkJCX0pOwoKCQkJCQkvLyBCdWJibGUgb3V0IHZhcmlvdXMgZXZlbnRzCgkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUlubmVyQ2xpY2spOwoJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYXV4Y2xpY2snLCBoYW5kbGVBdXhDbGljayk7CgkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlSW5uZXJLZXlkb3duKTsKCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgaGFuZGxlSW5uZXJLZXl1cCk7CgkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIGUgPT4gewoJCQkJCQlpZiAoZS5kZWZhdWx0UHJldmVudGVkKSB7CgkJCQkJCQkvLyBFeHRlbnNpb24gY29kZSBoYXMgYWxyZWFkeSBoYW5kbGVkIHRoaXMgZXZlbnQKCQkJCQkJCXJldHVybjsKCQkJCQkJfQoKCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCQkJLyoqIEB0eXBlIHsgUmVjb3JkPHN0cmluZywgYm9vbGVhbj59ICovCgkJCQkJCWxldCBjb250ZXh0ID0ge307CgoJCQkJCQkvKiogQHR5cGUge0hUTUxFbGVtZW50IHwgbnVsbH0gKi8KCQkJCQkJbGV0IGVsID0gZS50YXJnZXQ7CgkJCQkJCXdoaWxlICh0cnVlKSB7CgkJCQkJCQlpZiAoIWVsKSB7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQl9CgoJCQkJCQkJLy8gU2VhcmNoIHNlbGYvYW5jZXN0b3JzIGZvciB0aGUgY2xvc2VzdCBjb250ZXh0IGRhdGEgYXR0cmlidXRlCgkJCQkJCQllbCA9IGVsLmNsb3Nlc3QoJ1tkYXRhLXZzY29kZS1jb250ZXh0XScpOwoJCQkJCQkJaWYgKCFlbCkgewoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJfQoKCQkJCQkJCXRyeSB7CgkJCQkJCQkJY29udGV4dCA9IHsgLi4uSlNPTi5wYXJzZShlbC5kYXRhc2V0LnZzY29kZUNvbnRleHQpLCAuLi5jb250ZXh0IH07CgkJCQkJCQl9IGNhdGNoIChlKSB7CgkJCQkJCQkJY29uc29sZS5lcnJvcihgRXJyb3IgcGFyc2luZyAnZGF0YS12c2NvZGUtY29udGV4dCcgYXMganNvbmAsIGVsLCBlKTsKCQkJCQkJCX0KCgkJCQkJCQllbCA9IGVsLnBhcmVudEVsZW1lbnQ7CgkJCQkJCX0KCgkJCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RpZC1jb250ZXh0LW1lbnUnLCB7CgkJCQkJCQljbGllbnRYOiBlLmNsaWVudFgsCgkJCQkJCQljbGllbnRZOiBlLmNsaWVudFksCgkJCQkJCQljb250ZXh0OiBjb250ZXh0CgkJCQkJCX0pOwoJCQkJCX0pOwoKCQkJCQljb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGhhbmRsZUlubmVyRHJhZ1N0YXJ0RXZlbnQpOwoJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCBoYW5kbGVJbm5lckRyYWdFdmVudCk7CgkJCQkJY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFnJywgaGFuZGxlSW5uZXJEcmFnRXZlbnQpOwoJCQkJCWNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGhhbmRsZUlubmVyRHJvcEV2ZW50KTsKCgkJCQkJdW5sb2FkTW9uaXRvci5vbklmcmFtZUxvYWRlZChuZXdGcmFtZSk7CgkJCQl9CgoJCQkJaWYgKCFkaXNhYmxlU2VydmljZVdvcmtlciAmJiBvdXRlcklmcmFtZU1lc3NhZ2VDaGFubmVsKSB7CgkJCQkJb3V0ZXJJZnJhbWVNZXNzYWdlQ2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBldmVudCA9PiB7CgkJCQkJCXN3aXRjaCAoZXZlbnQuZGF0YS5jaGFubmVsKSB7CgkJCQkJCQljYXNlICdsb2FkLXJlc291cmNlJzoKCQkJCQkJCWNhc2UgJ2xvYWQtbG9jYWxob3N0JzoKCQkJCQkJCQlob3N0TWVzc2FnaW5nLnBvc3RNZXNzYWdlKGV2ZW50LmRhdGEuY2hhbm5lbCwgZXZlbnQuZGF0YSk7CgkJCQkJCQkJcmV0dXJuOwoJCQkJCQl9CgkJCQkJfTsKCQkJCX0KCQkJfSk7CgoJCQkvLyBwcm9wYWdhdGUgdnNjb2RlLWNvbnRleHQtbWVudS12aXNpYmxlIGNsYXNzCgkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdzZXQtY29udGV4dC1tZW51LXZpc2libGUnLCAoX2V2ZW50LCBkYXRhKSA9PiB7CgkJCQljb25zdCB0YXJnZXQgPSBnZXRBY3RpdmVGcmFtZSgpOwoJCQkJaWYgKHRhcmdldCAmJiB0YXJnZXQuY29udGVudERvY3VtZW50KSB7CgkJCQkJdGFyZ2V0LmNvbnRlbnREb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoJ3ZzY29kZS1jb250ZXh0LW1lbnUtdmlzaWJsZScsIGRhdGEudmlzaWJsZSk7CgkJCQl9CgkJCX0pOwoKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ3NldC10aXRsZScsIGFzeW5jIChfZXZlbnQsIGRhdGEpID0+IHsKCQkJCWNvbnN0IHRhcmdldCA9IGdldEFjdGl2ZUZyYW1lKCk7CgkJCQlpZiAodGFyZ2V0KSB7CgkJCQkJdGFyZ2V0LnRpdGxlID0gZGF0YTsKCQkJCX0KCQkJfSk7CgoJCQkvLyBGb3J3YXJkIG1lc3NhZ2UgdG8gdGhlIGVtYmVkZGVkIGlmcmFtZQoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnbWVzc2FnZScsIChfZXZlbnQsIGRhdGEpID0+IHsKCQkJCWNvbnN0IHBlbmRpbmcgPSBnZXRQZW5kaW5nRnJhbWUoKTsKCQkJCWlmICghcGVuZGluZykgewoJCQkJCWNvbnN0IHRhcmdldCA9IGdldEFjdGl2ZUZyYW1lKCk7CgkJCQkJaWYgKHRhcmdldCkgewoJCQkJCQlhc3NlcnRJc0RlZmluZWQodGFyZ2V0LmNvbnRlbnRXaW5kb3cpLnBvc3RNZXNzYWdlKGRhdGEubWVzc2FnZSwgd2luZG93Lm9yaWdpbiwgZGF0YS50cmFuc2Zlcik7CgkJCQkJCXJldHVybjsKCQkJCQl9CgkJCQl9CgkJCQlwZW5kaW5nTWVzc2FnZXMucHVzaChkYXRhKTsKCQkJfSk7CgoJCQlob3N0TWVzc2FnaW5nLm9uTWVzc2FnZSgnaW5pdGlhbC1zY3JvbGwtcG9zaXRpb24nLCAoX2V2ZW50LCBwcm9ncmVzcykgPT4gewoJCQkJaW5pdERhdGEuaW5pdGlhbFNjcm9sbFByb2dyZXNzID0gcHJvZ3Jlc3M7CgkJCX0pOwoKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ2V4ZWNDb21tYW5kJywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJY29uc3QgdGFyZ2V0ID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCWlmICghdGFyZ2V0KSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQkJYXNzZXJ0SXNEZWZpbmVkKHRhcmdldC5jb250ZW50RG9jdW1lbnQpLmV4ZWNDb21tYW5kKGRhdGEpOwoJCQl9KTsKCgkJCS8qKiBAdHlwZSB7c3RyaW5nIHwgdW5kZWZpbmVkfSAqLwoJCQlsZXQgbGFzdEZpbmRWYWx1ZSA9IHVuZGVmaW5lZDsKCgkJCWhvc3RNZXNzYWdpbmcub25NZXNzYWdlKCdmaW5kJywgKF9ldmVudCwgZGF0YSkgPT4gewoJCQkJY29uc3QgdGFyZ2V0ID0gZ2V0QWN0aXZlRnJhbWUoKTsKCQkJCWlmICghdGFyZ2V0KSB7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCWlmICghZGF0YS5wcmV2aW91cyAmJiBsYXN0RmluZFZhbHVlICE9PSBkYXRhLnZhbHVlICYmIHRhcmdldC5jb250ZW50V2luZG93KSB7CgkJCQkJLy8gUmVzZXQgc2VsZWN0aW9uIHNvIHdlIHN0YXJ0IHNlYXJjaCBhdCB0aGUgaGVhZCBvZiB0aGUgbGFzdCBzZWFyY2gKCQkJCQljb25zdCBzZWxlY3Rpb24gPSB0YXJnZXQuY29udGVudFdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKCQkJCQlpZiAoc2VsZWN0aW9uKSB7CgkJCQkJCXNlbGVjdGlvbi5jb2xsYXBzZShzZWxlY3Rpb24uYW5jaG9yTm9kZSk7CgkJCQkJfQoJCQkJfQoJCQkJbGFzdEZpbmRWYWx1ZSA9IGRhdGEudmFsdWU7CgoJCQkJY29uc3QgZGlkRmluZCA9ICgvKiogQHR5cGUge2FueX0gKi8gKHRhcmdldC5jb250ZW50V2luZG93KSkuZmluZCgKCQkJCQlkYXRhLnZhbHVlLAoJCQkJCS8qIGNhc2VTZW5zaXRpdmUqLyBmYWxzZSwKCQkJCQkvKiBiYWNrd2FyZHMqLyBkYXRhLnByZXZpb3VzLAoJCQkJCS8qIHdyYXBBcm91bmQqLyB0cnVlLAoJCQkJCS8qIHdob2xlV29yZCAqLyBmYWxzZSwKCQkJCQkvKiBzZWFyY2hJbkZyYW1lcyovIGZhbHNlLAoJCQkJCWZhbHNlKTsKCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoJ2RpZC1maW5kJywgZGlkRmluZCk7CgkJCX0pOwoKCQkJaG9zdE1lc3NhZ2luZy5vbk1lc3NhZ2UoJ2ZpbmQtc3RvcCcsIChfZXZlbnQsIGRhdGEpID0+IHsKCQkJCWNvbnN0IHRhcmdldCA9IGdldEFjdGl2ZUZyYW1lKCk7CgkJCQlpZiAoIXRhcmdldCkgewoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlsYXN0RmluZFZhbHVlID0gdW5kZWZpbmVkOwoKCQkJCWlmICghZGF0YS5jbGVhclNlbGVjdGlvbiAmJiB0YXJnZXQuY29udGVudFdpbmRvdykgewoJCQkJCWNvbnN0IHNlbGVjdGlvbiA9IHRhcmdldC5jb250ZW50V2luZG93LmdldFNlbGVjdGlvbigpOwoJCQkJCWlmIChzZWxlY3Rpb24pIHsKCQkJCQkJZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Rpb24ucmFuZ2VDb3VudDsgaSsrKSB7CgkJCQkJCQlzZWxlY3Rpb24ucmVtb3ZlUmFuZ2Uoc2VsZWN0aW9uLmdldFJhbmdlQXQoaSkpOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9KTsKCgkJCXRyYWNrRm9jdXMoewoJCQkJb25Gb2N1czogKCkgPT4gaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWZvY3VzJywgdW5kZWZpbmVkKSwKCQkJCW9uQmx1cjogKCkgPT4gaG9zdE1lc3NhZ2luZy5wb3N0TWVzc2FnZSgnZGlkLWJsdXInLCB1bmRlZmluZWQpCgkJCX0pOwoKCQkJKC8qKiBAdHlwZSB7YW55fSAqLyAod2luZG93KSlbdnNjb2RlUG9zdE1lc3NhZ2VGdW5jTmFtZV0gPSAoLyoqIEB0eXBlIHtzdHJpbmd9ICovIGNvbW1hbmQsIC8qKiBAdHlwZSB7YW55fSAqLyBkYXRhKSA9PiB7CgkJCQlzd2l0Y2ggKGNvbW1hbmQpIHsKCQkJCQljYXNlICdvbm1lc3NhZ2UnOgoJCQkJCWNhc2UgJ2RvLXVwZGF0ZS1zdGF0ZSc6CgkJCQkJCWhvc3RNZXNzYWdpbmcucG9zdE1lc3NhZ2UoY29tbWFuZCwgZGF0YSk7CgkJCQkJCWJyZWFrOwoJCQkJfQoJCQl9OwoKCQkJaG9zdE1lc3NhZ2luZy5zaWduYWxSZWFkeSgpOwoJCX0pOwoJPC9zY3JpcHQ+CjwvYm9keT4KCjwvaHRtbD4K","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,Xm),"vs/workbench/contrib/webview/browser/pre/fake.html":()=>(0,Wt.Cd)(new URL("data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+Cgk8bWV0YSBjaGFyc2V0PSJVVEYtOCI+Cgk8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+Cgk8dGl0bGU+RmFrZTwvdGl0bGU+CjwvaGVhZD4KPGJvZHk+CjwvYm9keT4KPC9odG1sPgo=","file:///home/runner/work/windmill-whitelabelling-react-webpack/windmill-whitelabelling-react-webpack/node_modules/@windmill-labs/windmill-react-sdk/dist/views-BmB0TABx.js").href,Xm)}),(0,Nt.w)(async e=>{e.get(Tt.On)}),(0,Wt.Df)(),(0,Rt.PA)(),(0,Rt.qx)(),(0,Wt.Q)(),(0,Rt.vb)(),(0,Wt.L)(),(0,Rt.TD)(),(0,Rt.gD)(),(0,Lt.a)(),(0,Lt.L)(),(0,Pt.Mt)(),(0,Pt.en)(),(0,Rt.db)(),(0,Mt.c)(),(0,Rt.IO)(),(0,Tt.f)(),(0,Lt.c)(),(0,Rt.ab)(),(0,Rt.Wo)(),(0,Rt.$d)(),(0,Rt.zk)(),(0,Rt.Up)(),(0,Rt.nM)(),(0,Rt.oA)(),(0,Wt.ca)(),(0,Lt.x)(),(0,Lt._)(),(0,Nt.z)(),(0,Nt.Q)(),(0,Rt.r)(),(0,Rt.gA)(),(0,Rt.Yt)(),(0,Tt.n)(),Rt._b.as(Wt.gf.ViewContainersRegistry),Rt._b.as(Wt.gf.ViewsRegistry);var $m=e=>Rt.n.get(Nt.Z).onDidChangeSideBarPosition(e);function ev(){return Rt.n.get(Nt.Z).getSideBarPosition()}}}]);