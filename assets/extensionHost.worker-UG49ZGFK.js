var w5=yt=>{throw TypeError(yt)};var wy=(yt,Ii,Pi)=>Ii.has(yt)||w5("Cannot "+Pi);var I=(yt,Ii,Pi)=>(wy(yt,Ii,"read from private field"),Pi?Pi.call(yt):Ii.get(yt)),me=(yt,Ii,Pi)=>Ii.has(yt)?w5("Cannot add the same private member more than once"):Ii instanceof WeakSet?Ii.add(yt):Ii.set(yt,Pi),te=(yt,Ii,Pi,Za)=>(wy(yt,Ii,"write to private field"),Za?Za.call(yt,Pi):Ii.set(yt,Pi),Pi),af=(yt,Ii,Pi)=>(wy(yt,Ii,"access private method"),Pi);(function(){"use strict";var Pc,us,c5,u5,d5,h5,Qi,Sa,Nc,Da,ka,f5,Ca,Ci,p5,yr,xr,Mh,fs,Ia,lf,g5,Fc,on,Ym,ps,$h,Uh,m5,Pa,Zs,Ta,Hh,Aa,eo,Bh,Zn,La,Wh,wn,Mc,Na,Oa,Fa,zh,qh,jh,Er,Ma,$a,Ua,Ha,Gh,Uc,Ba,gs,to,fi,Sr,Bc,Wc,Vc,Dr,Jh,pi,Va,zc,qc,io,no,Xh,Gc,Yh,qa,Qc,ms,Jc,Xc,ro,Yc,Kc,so,oo,Kh,Zc,ao,ja,Ga,eu,Qa,tu,iu,Ja;class yt{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}let Ii=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Pr.isErrorNoTelemetry(e)?new Pr(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const Pi=new Ii;function Za(i){Pi.setUnexpectedErrorHandler(i)}function ln(i){uo(i)||Pi.onUnexpectedError(i)}function D1(i){uo(i)||Pi.onUnexpectedExternalError(i)}function cu(i){if(i instanceof Error){const{name:e,message:t}=i,n=i.stacktrace||i.stack;return{$isError:!0,name:e,message:t,stack:n,noTelemetry:Pr.isErrorNoTelemetry(i)}}return i}function y5(i){let e;return i.noTelemetry?e=new Pr:(e=new Error,e.name=i.name),e.message=i.message,e.stack=i.stack,e}const cf="Canceled";function uo(i){return i instanceof Ir?!0:i instanceof Error&&i.name===cf&&i.message===cf}class Ir extends Error{constructor(){super(cf),this.name=this.message}}function ky(){const i=new Error(cf);return i.name=i.message,i}function Ue(i){return i?new Error(`Illegal argument: ${i}`):new Error("Illegal argument")}function k1(i){return i?new Error(`Illegal state: ${i}`):new Error("Illegal state")}class ho extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}}class x5 extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}}class C1 extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class Pr extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof Pr)return e;const t=new Pr;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class I1 extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,I1.prototype)}}function E5(i,e){const t=S5(i,e);if(t!==-1)return i[t]}function S5(i,e,t=i.length-1){for(let n=t;n>=0;n--){const r=i[n];if(e(r))return n}return-1}function Tr(i,e,t=(n,r)=>n===r){if(i===e)return!0;if(!i||!e||i.length!==e.length)return!1;for(let n=0,r=i.length;n<r;n++)if(!t(i[n],e[n]))return!1;return!0}function D5(i,e){const t=[];let n;for(const r of i.slice(0).sort(e))!n||e(n[0],r)!==0?(n=[r],t.push(n)):n.push(r);return t}function Cy(i,e,t){const n=[];function r(a,l,c){if(l===0&&c.length===0)return;const u=n[n.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=l,u.toInsert.push(...c)):n.push({start:a,deleteCount:l,toInsert:c})}let s=0,o=0;for(;;){if(s===i.length){r(s,0,e.slice(o));break}if(o===e.length){r(s,i.length-s,[]);break}const a=i[s],l=e[o],c=t(a,l);c===0?(s+=1,o+=1):c<0?(r(s,1,[]),s+=1):c>0&&(r(s,0,[l]),o+=1)}return n}function k5(i,e,t){const n=Cy(i,e,t),r=[],s=[];for(const o of n)r.push(...i.slice(o.start,o.start+o.deleteCount)),s.push(...o.toInsert);return{removed:r,added:s}}function Ti(i){return i.filter(e=>!!e)}function C5(i){let e=0;for(let t=0;t<i.length;t++)i[t]&&(i[e]=i[t],e+=1);i.length=e}function P1(i){return!Array.isArray(i)||i.length===0}function uu(i){return Array.isArray(i)&&i.length>0}function el(i,e=t=>t){const t=new Set;return i.filter(n=>{const r=e(n);return t.has(r)?!1:(t.add(r),!0)})}function Iy(i,e){let t;if(typeof e=="number"){let n=e;t=()=>{const r=Math.sin(n++)*179426549;return r-Math.floor(r)}}else t=Math.random;for(let n=i.length-1;n>0;n-=1){const r=Math.floor(t()*(n+1)),s=i[n];i[n]=i[r],i[r]=s}}function du(i,e){return Array.isArray(i)?i.map(e):e(i)}function fo(i){return Array.isArray(i)?i:[i]}var T1;(function(i){function e(s){return s<0}i.isLessThan=e;function t(s){return s<=0}i.isLessThanOrEqual=t;function n(s){return s>0}i.isGreaterThan=n;function r(s){return s===0}i.isNeitherLessOrGreaterThan=r,i.greaterThan=1,i.lessThan=-1,i.neitherLessOrGreaterThan=0})(T1||(T1={}));function I5(i,e){return(t,n)=>e(i(t),i(n))}const P5=(i,e)=>i-e,Ic=class Ic{constructor(e){this.iterate=e}forEach(e){this.iterate(t=>(e(t),!0))}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new Ic(t=>this.iterate(n=>e(n)?t(n):!0))}map(e){return new Ic(t=>this.iterate(n=>t(e(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(r=>((n||T1.isGreaterThan(e(r,t)))&&(n=!1,t=r),!0)),t}};Ic.empty=new Ic(e=>{});let Py=Ic;function Ty(i,e){const t=Object.create(null);for(const n of i){const r=e(n);let s=t[r];s||(s=t[r]=[]),s.push(n)}return t}function T5(i,e){const t=[],n=[];for(const r of i)e.has(r)||t.push(r);for(const r of e)i.has(r)||n.push(r);return{removed:t,added:n}}var Ay,Ry,Ly;function A5(i,e,t){let n=i.get(e);return n===void 0&&(n=t,i.set(e,n)),n}class R5{constructor(e,t){this.uri=e,this.value=t}}function L5(i){return Array.isArray(i)}const ba=class ba{constructor(e,t){if(this[Ay]="ResourceMap",e instanceof ba)this.map=new Map(e.map),this.toKey=t??ba.defaultToKey;else if(L5(e)){this.map=new Map,this.toKey=t??ba.defaultToKey;for(const[n,r]of e)this.set(n,r)}else this.map=new Map,this.toKey=e??ba.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new R5(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[n,r]of this.map)e(r.value,r.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(Ay=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};ba.defaultToKey=e=>e.toString();let $t=ba;class Ny{constructor(e,t){this[Ry]="ResourceSet",!e||typeof e=="function"?this._map=new $t(e):(this._map=new $t(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,r)=>e.call(t,r,r,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(Ry=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}var Ai;(function(i){i[i.None=0]="None",i[i.AsOld=1]="AsOld",i[i.AsNew=2]="AsNew"})(Ai||(Ai={}));class N5{constructor(){this[Ly]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Ai.None){const n=this._map.get(e);if(n)return t!==Ai.None&&this.touch(n,t),n.value}set(e,t,n=Ai.None){let r=this._map.get(e);if(r)r.value=t,n!==Ai.None&&this.touch(r,n);else{switch(r={key:e,value:t,next:void 0,previous:void 0},n){case Ai.None:this.addItemLast(r);break;case Ai.AsOld:this.addItemFirst(r);break;case Ai.AsNew:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this,t=this._state;let n=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const s={value:n.key,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return r}values(){const e=this,t=this._state;let n=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const s={value:n.value,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return r}entries(){const e=this,t=this._state;let n=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const s={value:[n.key,n.value],done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return r}[(Ly=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Ai.AsOld&&t!==Ai.AsNew)){if(t===Ai.AsOld){if(e===this._head)return;const n=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(n.previous=r,r.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Ai.AsNew){if(e===this._tail)return;const n=e.next,r=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=r,r.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}let O5=class extends N5{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Ai.AsNew){return super.get(e,t)}peek(e){return super.get(e,Ai.None)}set(e,t){return super.set(e,t,Ai.AsNew),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}};class A1 extends O5{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class Oy{constructor(){this.map=new Map}add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){const n=this.map.get(e);n&&(n.delete(t),n.size===0&&this.map.delete(e))}forEach(e,t){const n=this.map.get(e);n&&n.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}function R1(i,e){const t=this;let n=!1,r;return function(){if(n)return r;if(n=!0,e)try{r=i.apply(t,arguments)}finally{e()}else r=i.apply(t,arguments);return r}}var yn;(function(i){function e(N){return N&&typeof N=="object"&&typeof N[Symbol.iterator]=="function"}i.is=e;const t=Object.freeze([]);function n(){return t}i.empty=n;function*r(N){yield N}i.single=r;function s(N){return e(N)?N:r(N)}i.wrap=s;function o(N){return N||t}i.from=o;function*a(N){for(let A=N.length-1;A>=0;A--)yield N[A]}i.reverse=a;function l(N){return!N||N[Symbol.iterator]().next().done===!0}i.isEmpty=l;function c(N){return N[Symbol.iterator]().next().value}i.first=c;function u(N,A){let V=0;for(const ae of N)if(A(ae,V++))return!0;return!1}i.some=u;function d(N,A){for(const V of N)if(A(V))return V}i.find=d;function*f(N,A){for(const V of N)A(V)&&(yield V)}i.filter=f;function*p(N,A){let V=0;for(const ae of N)yield A(ae,V++)}i.map=p;function*b(N,A){let V=0;for(const ae of N)yield*A(ae,V++)}i.flatMap=b;function*w(...N){for(const A of N)yield*A}i.concat=w;function v(N,A,V){let ae=V;for(const be of N)ae=A(ae,be);return ae}i.reduce=v;function*S(N,A,V=N.length){for(A<0&&(A+=N.length),V<0?V+=N.length:V>N.length&&(V=N.length);A<V;A++)yield N[A]}i.slice=S;function k(N,A=Number.POSITIVE_INFINITY){const V=[];if(A===0)return[V,N];const ae=N[Symbol.iterator]();for(let be=0;be<A;be++){const Q=ae.next();if(Q.done)return[V,i.empty()];V.push(Q.value)}return[V,{[Symbol.iterator](){return ae}}]}i.consume=k;async function C(N){const A=[];for await(const V of N)A.push(V);return Promise.resolve(A)}i.asyncToArray=C})(yn||(yn={}));const Wm=class Wm{constructor(){this.livingDisposables=new Map}getDisposableData(e){let t=this.livingDisposables.get(e);return t||(t={parent:null,source:null,isSingleton:!1,value:e,idx:Wm.idx++},this.livingDisposables.set(e,t)),t}trackDisposable(e){const t=this.getDisposableData(e);t.source||(t.source=new Error().stack)}setParent(e,t){const n=this.getDisposableData(e);n.parent=t}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,t){const n=t.get(e);if(n)return n;const r=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;return t.set(e,r),r}getTrackedDisposables(){const e=new Map;return[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n)}computeLeakingDisposables(e=10,t){let n;if(t)n=t;else{const l=new Map,c=[...this.livingDisposables.values()].filter(d=>d.source!==null&&!this.getRootParent(d,l).isSingleton);if(c.length===0)return;const u=new Set(c.map(d=>d.value));if(n=c.filter(d=>!(d.parent&&u.has(d.parent))),n.length===0)throw new Error("There are cyclic diposable chains!")}if(!n)return;function r(l){function c(d,f){for(;d.length>0&&f.some(p=>typeof p=="string"?p===d[0]:d[0].match(p));)d.shift()}const u=l.source.split(`
`).map(d=>d.trim().replace("at ","")).filter(d=>d!=="");return c(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const s=new Oy;for(const l of n){const c=r(l);for(let u=0;u<=c.length;u++)s.add(c.slice(0,u).join(`
`),l)}n.sort(I5(l=>l.idx,P5));let o="",a=0;for(const l of n.slice(0,e)){a++;const c=r(l),u=[];for(let d=0;d<c.length;d++){let f=c[d];f=`(shared with ${s.get(c.slice(0,d+1).join(`
`)).size}/${n.length} leaks) at ${f}`;const b=s.get(c.slice(0,d).join(`
`)),w=Ty([...b].map(v=>r(v)[d]),v=>v);delete w[c[d]];for(const[v,S]of Object.entries(w))u.unshift(`    - stacktraces of ${S.length} other leaks continue with ${v}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${n.length}: ${l.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return n.length>e&&(o+=`


... and ${n.length-e} more leaking disposables

`),{leaks:n,details:o}}};Wm.idx=0;let Fy=Wm;function wL(i){return i}function bL(i,e){}function F5(i){return typeof i=="object"&&i!==null&&typeof i.dispose=="function"&&i.dispose.length===0}function Ar(i){if(yn.is(i)){const e=[];for(const t of i)if(t)try{t.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(i)?[]:i}else if(i)return i.dispose(),i}function My(...i){return Me(()=>Ar(i))}function Me(i){return{dispose:R1(()=>{i()})}}const Vm=class Vm{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Ar(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Vm.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}};Vm.DISABLE_DISPOSED_WARNING=!1;let Le=Vm,Re=(Pc=class{constructor(){this._store=new Le,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Pc.None=Object.freeze({dispose(){}}),Pc);class po{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e}}class L1{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Ar(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){var r;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||(r=this._store.get(e))==null||r.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}deleteAndLeak(e){const t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}function M5(i,e){return new Promise((t,n)=>{const r=[];$5(i,{onData:s=>{e&&r.push(s)},onError:s=>{e?n(s):t(void 0)},onEnd:()=>{t(e?e(r):void 0)}})})}function $5(i,e,t){i.on("error",n=>{t!=null&&t.isCancellationRequested||e.onError(n)}),i.on("end",()=>{t!=null&&t.isCancellationRequested||e.onEnd()}),i.on("data",n=>{t!=null&&t.isCancellationRequested||e.onData(n)})}const uf=typeof Buffer<"u",U5=new yt(()=>new Uint8Array(256));let N1,O1;class De{static alloc(e){return uf?new De(Buffer.allocUnsafe(e)):new De(new Uint8Array(e))}static wrap(e){return uf&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new De(e)}static fromString(e,t){return!((t==null?void 0:t.dontUseNodeBuffer)||!1)&&uf?new De(Buffer.from(e)):(N1||(N1=new TextEncoder),new De(N1.encode(e)))}static fromByteArray(e){const t=De.alloc(e.length);for(let n=0,r=e.length;n<r;n++)t.buffer[n]=e[n];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let s=0,o=e.length;s<o;s++)t+=e[s].byteLength}const n=De.alloc(t);let r=0;for(let s=0,o=e.length;s<o;s++){const a=e[s];n.set(a,r),r+=a.byteLength}return n}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){const e=De.alloc(this.byteLength);return e.set(this),e}toString(){return uf?this.buffer.toString():(O1||(O1=new TextDecoder),O1.decode(this.buffer))}slice(e,t){return new De(this.buffer.subarray(e,t))}set(e,t){if(e instanceof De)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return df(this.buffer,e)}writeUInt32BE(e,t){hf(this.buffer,e,t)}readUInt32LE(e){return V5(this.buffer,e)}writeUInt32LE(e,t){z5(this.buffer,e,t)}readUInt8(e){return q5(this.buffer,e)}writeUInt8(e,t){j5(this.buffer,e,t)}indexOf(e,t=0){return H5(this.buffer,e instanceof De?e.buffer:e,t)}}function H5(i,e,t=0){const n=e.byteLength,r=i.byteLength;if(n===0)return 0;if(n===1)return i.indexOf(e[0]);if(n>r-t)return-1;const s=U5.value;s.fill(e.length);for(let c=0;c<e.length;c++)s[e[c]]=e.length-c-1;let o=t+e.length-1,a=o,l=-1;for(;o<r;)if(i[o]===e[a]){if(a===0){l=o;break}o--,a--}else o+=Math.max(e.length-a,s[i[o]]),a=e.length-1;return l}function B5(i,e){return i[e+0]<<0>>>0|i[e+1]<<8>>>0}function W5(i,e,t){i[t+0]=e&255,e=e>>>8,i[t+1]=e&255}function df(i,e){return i[e]*2**24+i[e+1]*2**16+i[e+2]*2**8+i[e+3]}function hf(i,e,t){i[t+3]=e,e=e>>>8,i[t+2]=e,e=e>>>8,i[t+1]=e,e=e>>>8,i[t]=e}function V5(i,e){return i[e+0]<<0>>>0|i[e+1]<<8>>>0|i[e+2]<<16>>>0|i[e+3]<<24>>>0}function z5(i,e,t){i[t+0]=e&255,e=e>>>8,i[t+1]=e&255,e=e>>>8,i[t+2]=e&255,e=e>>>8,i[t+3]=e&255}function q5(i,e){return i[e]}function j5(i,e,t){i[t]=e}function G5(i){return M5(i,e=>De.concat(e))}function Q5(i){let e=0,t=0,n=0;const r=new Uint8Array(Math.floor(i.length/4*3)),s=a=>{switch(t){case 3:r[n++]=e|a,t=0;break;case 2:r[n++]=e|a>>>2,e=a<<6,t=3;break;case 1:r[n++]=e|a>>>4,e=a<<4,t=2;break;default:e=a<<2,t=1}};for(let a=0;a<i.length;a++){const l=i.charCodeAt(a);if(l>=65&&l<=90)s(l-65);else if(l>=97&&l<=122)s(l-97+26);else if(l>=48&&l<=57)s(l-48+52);else if(l===43||l===45)s(62);else if(l===47||l===95)s(63);else{if(l===61)break;throw new SyntaxError(`Unexpected base64 character ${i[a]}`)}}const o=n;for(;t>0;)s(0);return De.wrap(r).slice(0,o)}const J5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function $y({buffer:i},e=!0,t=!1){const n=t?X5:J5;let r="";const s=i.byteLength%3;let o=0;for(;o<i.byteLength-s;o+=3){const a=i[o+0],l=i[o+1],c=i[o+2];r+=n[a>>>2],r+=n[(a<<4|l>>>4)&63],r+=n[(l<<2|c>>>6)&63],r+=n[c&63]}if(s===1){const a=i[o+0];r+=n[a>>>2],r+=n[a<<4&63],e&&(r+="==")}else if(s===2){const a=i[o+0],l=i[o+1];r+=n[a>>>2],r+=n[(a<<4|l>>>4)&63],r+=n[l<<2&63],e&&(r+="=")}return r}let Ut=(us=class{constructor(e){this.element=e,this.next=us.Undefined,this.prev=us.Undefined}},us.Undefined=new us(void 0),us);class hu{constructor(){this._first=Ut.Undefined,this._last=Ut.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Ut.Undefined}clear(){let e=this._first;for(;e!==Ut.Undefined;){const t=e.next;e.prev=Ut.Undefined,e.next=Ut.Undefined,e=t}this._first=Ut.Undefined,this._last=Ut.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const n=new Ut(e);if(this._first===Ut.Undefined)this._first=n,this._last=n;else if(t){const s=this._last;this._last=n,n.prev=s,s.next=n}else{const s=this._first;this._first=n,n.next=s,s.prev=n}this._size+=1;let r=!1;return()=>{r||(r=!0,this._remove(n))}}shift(){if(this._first!==Ut.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Ut.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Ut.Undefined&&e.next!==Ut.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Ut.Undefined&&e.next===Ut.Undefined?(this._first=Ut.Undefined,this._last=Ut.Undefined):e.next===Ut.Undefined?(this._last=this._last.prev,this._last.next=Ut.Undefined):e.prev===Ut.Undefined&&(this._first=this._first.next,this._first.prev=Ut.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Ut.Undefined;)yield e.element,e=e.next}}const Y5=globalThis.performance&&typeof globalThis.performance.now=="function";class Rr{static create(e){return new Rr(e)}constructor(e){this._now=Y5&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var Ht;(function(i){i.None=()=>Re.None;function e(J,q){return d(J,()=>{},0,void 0,!0,void 0,q)}i.defer=e;function t(J){return(q,oe=null,re)=>{let de=!1,fe;return fe=J(je=>{if(!de)return fe?fe.dispose():de=!0,q.call(oe,je)},null,re),de&&fe.dispose(),fe}}i.once=t;function n(J,q,oe){return c((re,de=null,fe)=>J(je=>re.call(de,q(je)),null,fe),oe)}i.map=n;function r(J,q,oe){return c((re,de=null,fe)=>J(je=>{q(je),re.call(de,je)},null,fe),oe)}i.forEach=r;function s(J,q,oe){return c((re,de=null,fe)=>J(je=>q(je)&&re.call(de,je),null,fe),oe)}i.filter=s;function o(J){return J}i.signal=o;function a(...J){return(q,oe=null,re)=>{const de=My(...J.map(fe=>fe(je=>q.call(oe,je))));return u(de,re)}}i.any=a;function l(J,q,oe,re){let de=oe;return n(J,fe=>(de=q(de,fe),de),re)}i.reduce=l;function c(J,q){let oe;const re={onWillAddFirstListener(){oe=J(de.fire,de)},onDidRemoveLastListener(){oe==null||oe.dispose()}},de=new L(re);return q==null||q.add(de),de.event}function u(J,q){return q instanceof Array?q.push(J):q&&q.add(J),J}function d(J,q,oe=100,re=!1,de=!1,fe,je){let gt,$e,gi,oi=0,Zt;const mi={leakWarningThreshold:fe,onWillAddFirstListener(){gt=J(kt=>{oi++,$e=q($e,kt),re&&!gi&&($i.fire($e),$e=void 0),Zt=()=>{const er=$e;$e=void 0,gi=void 0,(!re||oi>1)&&$i.fire(er),oi=0},typeof oe=="number"?(clearTimeout(gi),gi=setTimeout(Zt,oe)):gi===void 0&&(gi=0,queueMicrotask(Zt))})},onWillRemoveListener(){de&&oi>0&&(Zt==null||Zt())},onDidRemoveLastListener(){Zt=void 0,gt.dispose()}},$i=new L(mi);return je==null||je.add($i),$i.event}i.debounce=d;function f(J,q=0,oe){return i.debounce(J,(re,de)=>re?(re.push(de),re):[de],q,void 0,!0,void 0,oe)}i.accumulate=f;function p(J,q=(re,de)=>re===de,oe){let re=!0,de;return s(J,fe=>{const je=re||!q(fe,de);return re=!1,de=fe,je},oe)}i.latch=p;function b(J,q,oe){return[i.filter(J,q,oe),i.filter(J,re=>!q(re),oe)]}i.split=b;function w(J,q=!1,oe=[],re){let de=oe.slice(),fe=J($e=>{de?de.push($e):gt.fire($e)});re&&re.add(fe);const je=()=>{de==null||de.forEach($e=>gt.fire($e)),de=null},gt=new L({onWillAddFirstListener(){fe||(fe=J($e=>gt.fire($e)),re&&re.add(fe))},onDidAddFirstListener(){de&&(q?setTimeout(je):je())},onDidRemoveLastListener(){fe&&fe.dispose(),fe=null}});return re&&re.add(gt),gt.event}i.buffer=w;function v(J,q){return(re,de,fe)=>{const je=q(new k);return J(function(gt){const $e=je.evaluate(gt);$e!==S&&re.call(de,$e)},void 0,fe)}}i.chain=v;const S=Symbol("HaltChainable");class k{constructor(){this.steps=[]}map(q){return this.steps.push(q),this}forEach(q){return this.steps.push(oe=>(q(oe),oe)),this}filter(q){return this.steps.push(oe=>q(oe)?oe:S),this}reduce(q,oe){let re=oe;return this.steps.push(de=>(re=q(re,de),re)),this}latch(q=(oe,re)=>oe===re){let oe=!0,re;return this.steps.push(de=>{const fe=oe||!q(de,re);return oe=!1,re=de,fe?de:S}),this}evaluate(q){for(const oe of this.steps)if(q=oe(q),q===S)break;return q}}function C(J,q,oe=re=>re){const re=(...gt)=>je.fire(oe(...gt)),de=()=>J.on(q,re),fe=()=>J.removeListener(q,re),je=new L({onWillAddFirstListener:de,onDidRemoveLastListener:fe});return je.event}i.fromNodeEventEmitter=C;function N(J,q,oe=re=>re){const re=(...gt)=>je.fire(oe(...gt)),de=()=>J.addEventListener(q,re),fe=()=>J.removeEventListener(q,re),je=new L({onWillAddFirstListener:de,onDidRemoveLastListener:fe});return je.event}i.fromDOMEventEmitter=N;function A(J){return new Promise(q=>t(J)(q))}i.toPromise=A;function V(J){const q=new L;return J.then(oe=>{q.fire(oe)},()=>{q.fire(void 0)}).finally(()=>{q.dispose()}),q.event}i.fromPromise=V;function ae(J,q){return J(oe=>q.fire(oe))}i.forward=ae;function be(J,q,oe){return q(oe),J(re=>q(re))}i.runAndSubscribe=be;class Q{constructor(q,oe){this._observable=q,this._counter=0,this._hasChanged=!1;const re={onWillAddFirstListener:()=>{q.addObserver(this)},onDidRemoveLastListener:()=>{q.removeObserver(this)}};this.emitter=new L(re),oe&&oe.add(this.emitter)}beginUpdate(q){this._counter++}handlePossibleChange(q){}handleChange(q,oe){this._hasChanged=!0}endUpdate(q){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Ce(J,q){return new Q(J,q).emitter.event}i.fromObservable=Ce;function Se(J){return(q,oe,re)=>{let de=0,fe=!1;const je={beginUpdate(){de++},endUpdate(){de--,de===0&&(J.reportChanges(),fe&&(fe=!1,q.call(oe)))},handlePossibleChange(){},handleChange(){fe=!0}};J.addObserver(je),J.reportChanges();const gt={dispose(){J.removeObserver(je)}};return re instanceof Le?re.add(gt):Array.isArray(re)&&re.push(gt),gt}}i.fromObservableLight=Se})(Ht||(Ht={}));const Tc=class Tc{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${Tc._idPool++}`,Tc.all.add(this)}start(e){this._stopWatch=new Rr,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};Tc.all=new Set,Tc._idPool=0;let F1=Tc,K5=-1;const zm=class zm{constructor(e,t,n=(zm._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=n,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const n=this.threshold;if(n<=0||t<n)return;this._stacks||(this._stacks=new Map);const r=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,r+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;const[s,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(s);const l=new Z5(a,s);this._errorHandler(l)}return()=>{const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[n,r]of this._stacks)(!e||t<r)&&(e=[n,r],t=r);return e}};zm._idPool=1;let M1=zm;class $1{static create(){const e=new Error;return new $1(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class Z5 extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class eC extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}let tC=0;class ff{constructor(e){this.value=e,this.id=tC++}}const iC=2,nC=(i,e)=>{if(i instanceof ff)e(i);else for(let t=0;t<i.length;t++){const n=i[t];n&&e(n)}};class L{constructor(e){var t,n,r,s;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new M1((e==null?void 0:e.onListenerError)??ln,((n=this._options)==null?void 0:n.leakWarningThreshold)??K5):void 0,this._perfMon=(r=this._options)!=null&&r._profName?new F1(this._options._profName):void 0,this._deliveryQueue=(s=this._options)==null?void 0:s.deliveryQueue}dispose(){var e,t,n,r;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(n=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||n.call(t),(r=this._leakageMon)==null||r.dispose())}get event(){return this._event??(this._event=(e,t,n)=>{var a,l,c,u,d;if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const f=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(f);const p=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],b=new eC(`${f}. HINT: Stack shows most frequent listener (${p[1]}-times)`,p[0]);return(((a=this._options)==null?void 0:a.onListenerError)||ln)(b),Re.None}if(this._disposed)return Re.None;t&&(e=e.bind(t));const r=new ff(e);let s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(r.stack=$1.create(),s=this._leakageMon.check(r.stack,this._size+1)),this._listeners?this._listeners instanceof ff?(this._deliveryQueue??(this._deliveryQueue=new rC),this._listeners=[this._listeners,r]):this._listeners.push(r):((c=(l=this._options)==null?void 0:l.onWillAddFirstListener)==null||c.call(l,this),this._listeners=r,(d=(u=this._options)==null?void 0:u.onDidAddFirstListener)==null||d.call(u,this)),this._size++;const o=Me(()=>{s==null||s(),this._removeListener(r)});return n instanceof Le?n.add(o):Array.isArray(n)&&n.push(o),o}),this._event}_removeListener(e){var s,o,a,l;if((o=(s=this._options)==null?void 0:s.onWillRemoveListener)==null||o.call(s,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(l=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||l.call(a,this),this._size=0;return}const t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[n]=void 0;const r=this._deliveryQueue.current===this;if(this._size*iC<=t.length){let c=0;for(let u=0;u<t.length;u++)t[u]?t[c++]=t[u]:r&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=c}}_deliver(e,t){var r;if(!e)return;const n=((r=this._options)==null?void 0:r.onListenerError)||ln;if(!n){e.value(t);return}try{e.value(t)}catch(s){n(s)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,n,r,s;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(n=this._perfMon)==null||n.stop()),(r=this._perfMon)==null||r.start(this._size),this._listeners)if(this._listeners instanceof ff)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(s=this._perfMon)==null||s.stop()}hasListeners(){return this._size>0}}class rC{constructor(){this.i=-1,this.end=0}enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class fu extends L{async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new hu),nC(this._listeners,r=>this._asyncDeliveryQueue.push([r.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){const[r,s]=this._asyncDeliveryQueue.shift(),o=[],a={...s,token:t,waitUntil:l=>{if(Object.isFrozen(o))throw new Error("waitUntil can NOT be called asynchronous");n&&(l=n(l,r)),o.push(l)}};try{r(a)}catch(l){ln(l);continue}await Promise.allSettled(o).then(l=>{for(const c of l)c.status==="rejected"&&ln(c.reason)})}}}class pf extends L{get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._isPaused=0,this._eventQueue=new hu,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class sC extends pf{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}var pu;(function(i){i[i.Desktop=1]="Desktop",i[i.Web=2]="Web"})(pu||(pu={}));var Uy;(function(i){i[i.VersionMismatch=55]="VersionMismatch",i[i.UnexpectedError=81]="UnexpectedError"})(Uy||(Uy={}));var Pn;(function(i){i[i.Initialized=0]="Initialized",i[i.Ready=1]="Ready",i[i.Terminate=2]="Terminate"})(Pn||(Pn={}));function Hy(i){const e=De.alloc(1);switch(i){case Pn.Initialized:e.writeUInt8(1,0);break;case Pn.Ready:e.writeUInt8(2,0);break;case Pn.Terminate:e.writeUInt8(3,0);break}return e}function oC(i,e){if(i.byteLength!==1)return!1;switch(i.readUInt8(0)){case 1:return e===Pn.Initialized;case 2:return e===Pn.Ready;case 3:return e===Pn.Terminate;default:return!1}}const gu={exports:{}};(function(){function i(r){const s=[];typeof r=="number"&&s.push("code/timeOrigin",r);function o(l){s.push(l,Date.now())}function a(){const l=[];for(let c=0;c<s.length;c+=2)l.push({name:s[c],startTime:s[c+1]});return l}return{mark:o,getMarks:a}}function e(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?i():{mark(r){performance.mark(r)},getMarks(){let r=performance.timeOrigin;typeof r!="number"&&(r=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const s=[{name:"code/timeOrigin",startTime:Math.round(r)}];for(const o of performance.getEntriesByType("mark"))s.push({name:o.name,startTime:Math.round(r+o.startTime)});return s}};if(typeof process=="object"){const r=(performance==null?void 0:performance.timeOrigin)??Math.round((require.__$__nodeRequire||require)("perf_hooks").performance.timeOrigin);return i(r)}else return console.trace("perf-util loaded in UNKNOWN environment"),i()}function t(r){return r.MonacoPerformanceMarks||(r.MonacoPerformanceMarks=e()),r.MonacoPerformanceMarks}var n;typeof global=="object"?n=global:typeof self=="object"?n=self:n={},typeof define=="function"?define([],function(){return t(n)}):typeof gu=="object"&&typeof gu.exports=="object"?gu.exports=t(n):(console.trace("perf-util defined in UNKNOWN context (neither requirejs or commonjs)"),n.perf=t(n))})();const Ui=gu.exports.mark,aC=gu.exports.getMarks;var P;(function(i){i[i.Null=0]="Null",i[i.Backspace=8]="Backspace",i[i.Tab=9]="Tab",i[i.LineFeed=10]="LineFeed",i[i.CarriageReturn=13]="CarriageReturn",i[i.Space=32]="Space",i[i.ExclamationMark=33]="ExclamationMark",i[i.DoubleQuote=34]="DoubleQuote",i[i.Hash=35]="Hash",i[i.DollarSign=36]="DollarSign",i[i.PercentSign=37]="PercentSign",i[i.Ampersand=38]="Ampersand",i[i.SingleQuote=39]="SingleQuote",i[i.OpenParen=40]="OpenParen",i[i.CloseParen=41]="CloseParen",i[i.Asterisk=42]="Asterisk",i[i.Plus=43]="Plus",i[i.Comma=44]="Comma",i[i.Dash=45]="Dash",i[i.Period=46]="Period",i[i.Slash=47]="Slash",i[i.Digit0=48]="Digit0",i[i.Digit1=49]="Digit1",i[i.Digit2=50]="Digit2",i[i.Digit3=51]="Digit3",i[i.Digit4=52]="Digit4",i[i.Digit5=53]="Digit5",i[i.Digit6=54]="Digit6",i[i.Digit7=55]="Digit7",i[i.Digit8=56]="Digit8",i[i.Digit9=57]="Digit9",i[i.Colon=58]="Colon",i[i.Semicolon=59]="Semicolon",i[i.LessThan=60]="LessThan",i[i.Equals=61]="Equals",i[i.GreaterThan=62]="GreaterThan",i[i.QuestionMark=63]="QuestionMark",i[i.AtSign=64]="AtSign",i[i.A=65]="A",i[i.B=66]="B",i[i.C=67]="C",i[i.D=68]="D",i[i.E=69]="E",i[i.F=70]="F",i[i.G=71]="G",i[i.H=72]="H",i[i.I=73]="I",i[i.J=74]="J",i[i.K=75]="K",i[i.L=76]="L",i[i.M=77]="M",i[i.N=78]="N",i[i.O=79]="O",i[i.P=80]="P",i[i.Q=81]="Q",i[i.R=82]="R",i[i.S=83]="S",i[i.T=84]="T",i[i.U=85]="U",i[i.V=86]="V",i[i.W=87]="W",i[i.X=88]="X",i[i.Y=89]="Y",i[i.Z=90]="Z",i[i.OpenSquareBracket=91]="OpenSquareBracket",i[i.Backslash=92]="Backslash",i[i.CloseSquareBracket=93]="CloseSquareBracket",i[i.Caret=94]="Caret",i[i.Underline=95]="Underline",i[i.BackTick=96]="BackTick",i[i.a=97]="a",i[i.b=98]="b",i[i.c=99]="c",i[i.d=100]="d",i[i.e=101]="e",i[i.f=102]="f",i[i.g=103]="g",i[i.h=104]="h",i[i.i=105]="i",i[i.j=106]="j",i[i.k=107]="k",i[i.l=108]="l",i[i.m=109]="m",i[i.n=110]="n",i[i.o=111]="o",i[i.p=112]="p",i[i.q=113]="q",i[i.r=114]="r",i[i.s=115]="s",i[i.t=116]="t",i[i.u=117]="u",i[i.v=118]="v",i[i.w=119]="w",i[i.x=120]="x",i[i.y=121]="y",i[i.z=122]="z",i[i.OpenCurlyBrace=123]="OpenCurlyBrace",i[i.Pipe=124]="Pipe",i[i.CloseCurlyBrace=125]="CloseCurlyBrace",i[i.Tilde=126]="Tilde",i[i.NoBreakSpace=160]="NoBreakSpace",i[i.U_Combining_Grave_Accent=768]="U_Combining_Grave_Accent",i[i.U_Combining_Acute_Accent=769]="U_Combining_Acute_Accent",i[i.U_Combining_Circumflex_Accent=770]="U_Combining_Circumflex_Accent",i[i.U_Combining_Tilde=771]="U_Combining_Tilde",i[i.U_Combining_Macron=772]="U_Combining_Macron",i[i.U_Combining_Overline=773]="U_Combining_Overline",i[i.U_Combining_Breve=774]="U_Combining_Breve",i[i.U_Combining_Dot_Above=775]="U_Combining_Dot_Above",i[i.U_Combining_Diaeresis=776]="U_Combining_Diaeresis",i[i.U_Combining_Hook_Above=777]="U_Combining_Hook_Above",i[i.U_Combining_Ring_Above=778]="U_Combining_Ring_Above",i[i.U_Combining_Double_Acute_Accent=779]="U_Combining_Double_Acute_Accent",i[i.U_Combining_Caron=780]="U_Combining_Caron",i[i.U_Combining_Vertical_Line_Above=781]="U_Combining_Vertical_Line_Above",i[i.U_Combining_Double_Vertical_Line_Above=782]="U_Combining_Double_Vertical_Line_Above",i[i.U_Combining_Double_Grave_Accent=783]="U_Combining_Double_Grave_Accent",i[i.U_Combining_Candrabindu=784]="U_Combining_Candrabindu",i[i.U_Combining_Inverted_Breve=785]="U_Combining_Inverted_Breve",i[i.U_Combining_Turned_Comma_Above=786]="U_Combining_Turned_Comma_Above",i[i.U_Combining_Comma_Above=787]="U_Combining_Comma_Above",i[i.U_Combining_Reversed_Comma_Above=788]="U_Combining_Reversed_Comma_Above",i[i.U_Combining_Comma_Above_Right=789]="U_Combining_Comma_Above_Right",i[i.U_Combining_Grave_Accent_Below=790]="U_Combining_Grave_Accent_Below",i[i.U_Combining_Acute_Accent_Below=791]="U_Combining_Acute_Accent_Below",i[i.U_Combining_Left_Tack_Below=792]="U_Combining_Left_Tack_Below",i[i.U_Combining_Right_Tack_Below=793]="U_Combining_Right_Tack_Below",i[i.U_Combining_Left_Angle_Above=794]="U_Combining_Left_Angle_Above",i[i.U_Combining_Horn=795]="U_Combining_Horn",i[i.U_Combining_Left_Half_Ring_Below=796]="U_Combining_Left_Half_Ring_Below",i[i.U_Combining_Up_Tack_Below=797]="U_Combining_Up_Tack_Below",i[i.U_Combining_Down_Tack_Below=798]="U_Combining_Down_Tack_Below",i[i.U_Combining_Plus_Sign_Below=799]="U_Combining_Plus_Sign_Below",i[i.U_Combining_Minus_Sign_Below=800]="U_Combining_Minus_Sign_Below",i[i.U_Combining_Palatalized_Hook_Below=801]="U_Combining_Palatalized_Hook_Below",i[i.U_Combining_Retroflex_Hook_Below=802]="U_Combining_Retroflex_Hook_Below",i[i.U_Combining_Dot_Below=803]="U_Combining_Dot_Below",i[i.U_Combining_Diaeresis_Below=804]="U_Combining_Diaeresis_Below",i[i.U_Combining_Ring_Below=805]="U_Combining_Ring_Below",i[i.U_Combining_Comma_Below=806]="U_Combining_Comma_Below",i[i.U_Combining_Cedilla=807]="U_Combining_Cedilla",i[i.U_Combining_Ogonek=808]="U_Combining_Ogonek",i[i.U_Combining_Vertical_Line_Below=809]="U_Combining_Vertical_Line_Below",i[i.U_Combining_Bridge_Below=810]="U_Combining_Bridge_Below",i[i.U_Combining_Inverted_Double_Arch_Below=811]="U_Combining_Inverted_Double_Arch_Below",i[i.U_Combining_Caron_Below=812]="U_Combining_Caron_Below",i[i.U_Combining_Circumflex_Accent_Below=813]="U_Combining_Circumflex_Accent_Below",i[i.U_Combining_Breve_Below=814]="U_Combining_Breve_Below",i[i.U_Combining_Inverted_Breve_Below=815]="U_Combining_Inverted_Breve_Below",i[i.U_Combining_Tilde_Below=816]="U_Combining_Tilde_Below",i[i.U_Combining_Macron_Below=817]="U_Combining_Macron_Below",i[i.U_Combining_Low_Line=818]="U_Combining_Low_Line",i[i.U_Combining_Double_Low_Line=819]="U_Combining_Double_Low_Line",i[i.U_Combining_Tilde_Overlay=820]="U_Combining_Tilde_Overlay",i[i.U_Combining_Short_Stroke_Overlay=821]="U_Combining_Short_Stroke_Overlay",i[i.U_Combining_Long_Stroke_Overlay=822]="U_Combining_Long_Stroke_Overlay",i[i.U_Combining_Short_Solidus_Overlay=823]="U_Combining_Short_Solidus_Overlay",i[i.U_Combining_Long_Solidus_Overlay=824]="U_Combining_Long_Solidus_Overlay",i[i.U_Combining_Right_Half_Ring_Below=825]="U_Combining_Right_Half_Ring_Below",i[i.U_Combining_Inverted_Bridge_Below=826]="U_Combining_Inverted_Bridge_Below",i[i.U_Combining_Square_Below=827]="U_Combining_Square_Below",i[i.U_Combining_Seagull_Below=828]="U_Combining_Seagull_Below",i[i.U_Combining_X_Above=829]="U_Combining_X_Above",i[i.U_Combining_Vertical_Tilde=830]="U_Combining_Vertical_Tilde",i[i.U_Combining_Double_Overline=831]="U_Combining_Double_Overline",i[i.U_Combining_Grave_Tone_Mark=832]="U_Combining_Grave_Tone_Mark",i[i.U_Combining_Acute_Tone_Mark=833]="U_Combining_Acute_Tone_Mark",i[i.U_Combining_Greek_Perispomeni=834]="U_Combining_Greek_Perispomeni",i[i.U_Combining_Greek_Koronis=835]="U_Combining_Greek_Koronis",i[i.U_Combining_Greek_Dialytika_Tonos=836]="U_Combining_Greek_Dialytika_Tonos",i[i.U_Combining_Greek_Ypogegrammeni=837]="U_Combining_Greek_Ypogegrammeni",i[i.U_Combining_Bridge_Above=838]="U_Combining_Bridge_Above",i[i.U_Combining_Equals_Sign_Below=839]="U_Combining_Equals_Sign_Below",i[i.U_Combining_Double_Vertical_Line_Below=840]="U_Combining_Double_Vertical_Line_Below",i[i.U_Combining_Left_Angle_Below=841]="U_Combining_Left_Angle_Below",i[i.U_Combining_Not_Tilde_Above=842]="U_Combining_Not_Tilde_Above",i[i.U_Combining_Homothetic_Above=843]="U_Combining_Homothetic_Above",i[i.U_Combining_Almost_Equal_To_Above=844]="U_Combining_Almost_Equal_To_Above",i[i.U_Combining_Left_Right_Arrow_Below=845]="U_Combining_Left_Right_Arrow_Below",i[i.U_Combining_Upwards_Arrow_Below=846]="U_Combining_Upwards_Arrow_Below",i[i.U_Combining_Grapheme_Joiner=847]="U_Combining_Grapheme_Joiner",i[i.U_Combining_Right_Arrowhead_Above=848]="U_Combining_Right_Arrowhead_Above",i[i.U_Combining_Left_Half_Ring_Above=849]="U_Combining_Left_Half_Ring_Above",i[i.U_Combining_Fermata=850]="U_Combining_Fermata",i[i.U_Combining_X_Below=851]="U_Combining_X_Below",i[i.U_Combining_Left_Arrowhead_Below=852]="U_Combining_Left_Arrowhead_Below",i[i.U_Combining_Right_Arrowhead_Below=853]="U_Combining_Right_Arrowhead_Below",i[i.U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below=854]="U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below",i[i.U_Combining_Right_Half_Ring_Above=855]="U_Combining_Right_Half_Ring_Above",i[i.U_Combining_Dot_Above_Right=856]="U_Combining_Dot_Above_Right",i[i.U_Combining_Asterisk_Below=857]="U_Combining_Asterisk_Below",i[i.U_Combining_Double_Ring_Below=858]="U_Combining_Double_Ring_Below",i[i.U_Combining_Zigzag_Above=859]="U_Combining_Zigzag_Above",i[i.U_Combining_Double_Breve_Below=860]="U_Combining_Double_Breve_Below",i[i.U_Combining_Double_Breve=861]="U_Combining_Double_Breve",i[i.U_Combining_Double_Macron=862]="U_Combining_Double_Macron",i[i.U_Combining_Double_Macron_Below=863]="U_Combining_Double_Macron_Below",i[i.U_Combining_Double_Tilde=864]="U_Combining_Double_Tilde",i[i.U_Combining_Double_Inverted_Breve=865]="U_Combining_Double_Inverted_Breve",i[i.U_Combining_Double_Rightwards_Arrow_Below=866]="U_Combining_Double_Rightwards_Arrow_Below",i[i.U_Combining_Latin_Small_Letter_A=867]="U_Combining_Latin_Small_Letter_A",i[i.U_Combining_Latin_Small_Letter_E=868]="U_Combining_Latin_Small_Letter_E",i[i.U_Combining_Latin_Small_Letter_I=869]="U_Combining_Latin_Small_Letter_I",i[i.U_Combining_Latin_Small_Letter_O=870]="U_Combining_Latin_Small_Letter_O",i[i.U_Combining_Latin_Small_Letter_U=871]="U_Combining_Latin_Small_Letter_U",i[i.U_Combining_Latin_Small_Letter_C=872]="U_Combining_Latin_Small_Letter_C",i[i.U_Combining_Latin_Small_Letter_D=873]="U_Combining_Latin_Small_Letter_D",i[i.U_Combining_Latin_Small_Letter_H=874]="U_Combining_Latin_Small_Letter_H",i[i.U_Combining_Latin_Small_Letter_M=875]="U_Combining_Latin_Small_Letter_M",i[i.U_Combining_Latin_Small_Letter_R=876]="U_Combining_Latin_Small_Letter_R",i[i.U_Combining_Latin_Small_Letter_T=877]="U_Combining_Latin_Small_Letter_T",i[i.U_Combining_Latin_Small_Letter_V=878]="U_Combining_Latin_Small_Letter_V",i[i.U_Combining_Latin_Small_Letter_X=879]="U_Combining_Latin_Small_Letter_X",i[i.LINE_SEPARATOR=8232]="LINE_SEPARATOR",i[i.PARAGRAPH_SEPARATOR=8233]="PARAGRAPH_SEPARATOR",i[i.NEXT_LINE=133]="NEXT_LINE",i[i.U_CIRCUMFLEX=94]="U_CIRCUMFLEX",i[i.U_GRAVE_ACCENT=96]="U_GRAVE_ACCENT",i[i.U_DIAERESIS=168]="U_DIAERESIS",i[i.U_MACRON=175]="U_MACRON",i[i.U_ACUTE_ACCENT=180]="U_ACUTE_ACCENT",i[i.U_CEDILLA=184]="U_CEDILLA",i[i.U_MODIFIER_LETTER_LEFT_ARROWHEAD=706]="U_MODIFIER_LETTER_LEFT_ARROWHEAD",i[i.U_MODIFIER_LETTER_RIGHT_ARROWHEAD=707]="U_MODIFIER_LETTER_RIGHT_ARROWHEAD",i[i.U_MODIFIER_LETTER_UP_ARROWHEAD=708]="U_MODIFIER_LETTER_UP_ARROWHEAD",i[i.U_MODIFIER_LETTER_DOWN_ARROWHEAD=709]="U_MODIFIER_LETTER_DOWN_ARROWHEAD",i[i.U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING=722]="U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING",i[i.U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING=723]="U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING",i[i.U_MODIFIER_LETTER_UP_TACK=724]="U_MODIFIER_LETTER_UP_TACK",i[i.U_MODIFIER_LETTER_DOWN_TACK=725]="U_MODIFIER_LETTER_DOWN_TACK",i[i.U_MODIFIER_LETTER_PLUS_SIGN=726]="U_MODIFIER_LETTER_PLUS_SIGN",i[i.U_MODIFIER_LETTER_MINUS_SIGN=727]="U_MODIFIER_LETTER_MINUS_SIGN",i[i.U_BREVE=728]="U_BREVE",i[i.U_DOT_ABOVE=729]="U_DOT_ABOVE",i[i.U_RING_ABOVE=730]="U_RING_ABOVE",i[i.U_OGONEK=731]="U_OGONEK",i[i.U_SMALL_TILDE=732]="U_SMALL_TILDE",i[i.U_DOUBLE_ACUTE_ACCENT=733]="U_DOUBLE_ACUTE_ACCENT",i[i.U_MODIFIER_LETTER_RHOTIC_HOOK=734]="U_MODIFIER_LETTER_RHOTIC_HOOK",i[i.U_MODIFIER_LETTER_CROSS_ACCENT=735]="U_MODIFIER_LETTER_CROSS_ACCENT",i[i.U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR=741]="U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR",i[i.U_MODIFIER_LETTER_HIGH_TONE_BAR=742]="U_MODIFIER_LETTER_HIGH_TONE_BAR",i[i.U_MODIFIER_LETTER_MID_TONE_BAR=743]="U_MODIFIER_LETTER_MID_TONE_BAR",i[i.U_MODIFIER_LETTER_LOW_TONE_BAR=744]="U_MODIFIER_LETTER_LOW_TONE_BAR",i[i.U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR=745]="U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR",i[i.U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK=746]="U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK",i[i.U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK=747]="U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK",i[i.U_MODIFIER_LETTER_UNASPIRATED=749]="U_MODIFIER_LETTER_UNASPIRATED",i[i.U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD=751]="U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD",i[i.U_MODIFIER_LETTER_LOW_UP_ARROWHEAD=752]="U_MODIFIER_LETTER_LOW_UP_ARROWHEAD",i[i.U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD=753]="U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD",i[i.U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD=754]="U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD",i[i.U_MODIFIER_LETTER_LOW_RING=755]="U_MODIFIER_LETTER_LOW_RING",i[i.U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT=756]="U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT",i[i.U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT=757]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT",i[i.U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT=758]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT",i[i.U_MODIFIER_LETTER_LOW_TILDE=759]="U_MODIFIER_LETTER_LOW_TILDE",i[i.U_MODIFIER_LETTER_RAISED_COLON=760]="U_MODIFIER_LETTER_RAISED_COLON",i[i.U_MODIFIER_LETTER_BEGIN_HIGH_TONE=761]="U_MODIFIER_LETTER_BEGIN_HIGH_TONE",i[i.U_MODIFIER_LETTER_END_HIGH_TONE=762]="U_MODIFIER_LETTER_END_HIGH_TONE",i[i.U_MODIFIER_LETTER_BEGIN_LOW_TONE=763]="U_MODIFIER_LETTER_BEGIN_LOW_TONE",i[i.U_MODIFIER_LETTER_END_LOW_TONE=764]="U_MODIFIER_LETTER_END_LOW_TONE",i[i.U_MODIFIER_LETTER_SHELF=765]="U_MODIFIER_LETTER_SHELF",i[i.U_MODIFIER_LETTER_OPEN_SHELF=766]="U_MODIFIER_LETTER_OPEN_SHELF",i[i.U_MODIFIER_LETTER_LOW_LEFT_ARROW=767]="U_MODIFIER_LETTER_LOW_LEFT_ARROW",i[i.U_GREEK_LOWER_NUMERAL_SIGN=885]="U_GREEK_LOWER_NUMERAL_SIGN",i[i.U_GREEK_TONOS=900]="U_GREEK_TONOS",i[i.U_GREEK_DIALYTIKA_TONOS=901]="U_GREEK_DIALYTIKA_TONOS",i[i.U_GREEK_KORONIS=8125]="U_GREEK_KORONIS",i[i.U_GREEK_PSILI=8127]="U_GREEK_PSILI",i[i.U_GREEK_PERISPOMENI=8128]="U_GREEK_PERISPOMENI",i[i.U_GREEK_DIALYTIKA_AND_PERISPOMENI=8129]="U_GREEK_DIALYTIKA_AND_PERISPOMENI",i[i.U_GREEK_PSILI_AND_VARIA=8141]="U_GREEK_PSILI_AND_VARIA",i[i.U_GREEK_PSILI_AND_OXIA=8142]="U_GREEK_PSILI_AND_OXIA",i[i.U_GREEK_PSILI_AND_PERISPOMENI=8143]="U_GREEK_PSILI_AND_PERISPOMENI",i[i.U_GREEK_DASIA_AND_VARIA=8157]="U_GREEK_DASIA_AND_VARIA",i[i.U_GREEK_DASIA_AND_OXIA=8158]="U_GREEK_DASIA_AND_OXIA",i[i.U_GREEK_DASIA_AND_PERISPOMENI=8159]="U_GREEK_DASIA_AND_PERISPOMENI",i[i.U_GREEK_DIALYTIKA_AND_VARIA=8173]="U_GREEK_DIALYTIKA_AND_VARIA",i[i.U_GREEK_DIALYTIKA_AND_OXIA=8174]="U_GREEK_DIALYTIKA_AND_OXIA",i[i.U_GREEK_VARIA=8175]="U_GREEK_VARIA",i[i.U_GREEK_OXIA=8189]="U_GREEK_OXIA",i[i.U_GREEK_DASIA=8190]="U_GREEK_DASIA",i[i.U_IDEOGRAPHIC_FULL_STOP=12290]="U_IDEOGRAPHIC_FULL_STOP",i[i.U_LEFT_CORNER_BRACKET=12300]="U_LEFT_CORNER_BRACKET",i[i.U_RIGHT_CORNER_BRACKET=12301]="U_RIGHT_CORNER_BRACKET",i[i.U_LEFT_BLACK_LENTICULAR_BRACKET=12304]="U_LEFT_BLACK_LENTICULAR_BRACKET",i[i.U_RIGHT_BLACK_LENTICULAR_BRACKET=12305]="U_RIGHT_BLACK_LENTICULAR_BRACKET",i[i.U_OVERLINE=8254]="U_OVERLINE",i[i.UTF8_BOM=65279]="UTF8_BOM",i[i.U_FULLWIDTH_SEMICOLON=65307]="U_FULLWIDTH_SEMICOLON",i[i.U_FULLWIDTH_COMMA=65292]="U_FULLWIDTH_COMMA"})(P||(P={}));var mt;(function(i){i[i.Uri=1]="Uri",i[i.Regexp=2]="Regexp",i[i.ScmResource=3]="ScmResource",i[i.ScmResourceGroup=4]="ScmResourceGroup",i[i.ScmProvider=5]="ScmProvider",i[i.CommentController=6]="CommentController",i[i.CommentThread=7]="CommentThread",i[i.CommentThreadInstance=8]="CommentThreadInstance",i[i.CommentThreadReply=9]="CommentThreadReply",i[i.CommentNode=10]="CommentNode",i[i.CommentThreadNode=11]="CommentThreadNode",i[i.TimelineActionContext=12]="TimelineActionContext",i[i.NotebookCellActionContext=13]="NotebookCellActionContext",i[i.NotebookActionContext=14]="NotebookActionContext",i[i.TerminalContext=15]="TerminalContext",i[i.TestItemContext=16]="TestItemContext",i[i.Date=17]="Date",i[i.TestMessageMenuArgs=18]="TestMessageMenuArgs"})(mt||(mt={}));const go="en";let mu=!1,_u=!1,vu=!1,By=!1,U1=!1,Wy=!1,Vy=!1,gf,mf=go,zy=go,lC,Tn;const Lr=globalThis;let yi;typeof Lr.vscode<"u"&&typeof Lr.vscode.process<"u"?yi=Lr.vscode.process:typeof process<"u"&&typeof((c5=process==null?void 0:process.versions)==null?void 0:c5.node)=="string"&&(yi=process);const cC=typeof((u5=yi==null?void 0:yi.versions)==null?void 0:u5.electron)=="string"&&(yi==null?void 0:yi.type)==="renderer";if(typeof yi=="object"){mu=yi.platform==="win32",_u=yi.platform==="darwin",vu=yi.platform==="linux",vu&&yi.env.SNAP&&yi.env.SNAP_REVISION,Vy=!!yi.env.CI||!!yi.env.BUILD_ARTIFACTSTAGINGDIRECTORY,gf=go,mf=go;const i=yi.env.VSCODE_NLS_CONFIG;if(i)try{const e=JSON.parse(i);gf=e.userLocale,zy=e.osLocale,mf=e.resolvedLanguage||go,lC=(d5=e.languagePack)==null?void 0:d5.translationsConfigFile}catch{}By=!0}else typeof navigator=="object"&&!cC?(Tn=navigator.userAgent,mu=Tn.indexOf("Windows")>=0,_u=Tn.indexOf("Macintosh")>=0,Wy=(Tn.indexOf("Macintosh")>=0||Tn.indexOf("iPad")>=0||Tn.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,vu=Tn.indexOf("Linux")>=0,(Tn==null?void 0:Tn.indexOf("Mobi"))>=0,U1=!0,mf=globalThis._VSCODE_NLS_LANGUAGE||go,gf=navigator.language.toLowerCase(),zy=gf):console.error("Unable to resolve platform.");var An;(function(i){i[i.Web=0]="Web",i[i.Mac=1]="Mac",i[i.Linux=2]="Linux",i[i.Windows=3]="Windows"})(An||(An={}));function uC(i){switch(i){case An.Web:return"Web";case An.Mac:return"Mac";case An.Linux:return"Linux";case An.Windows:return"Windows"}}An.Web,_u?An.Mac:mu?An.Windows:vu&&An.Linux;const cn=mu,Rn=_u,ws=vu,dC=By,H1=U1,wu=U1&&typeof Lr.importScripts=="function",hC=wu?Lr.origin:void 0,mo=Vy,nr=Tn,bs=mf;var qy;(function(i){function e(){return bs}i.value=e;function t(){return bs.length===2?bs==="en":bs.length>=3?bs[0]==="e"&&bs[1]==="n"&&bs[2]==="-":!1}i.isDefaultVariant=t;function n(){return bs==="en"}i.isDefault=n})(qy||(qy={}));const fC=typeof Lr.postMessage=="function"&&!Lr.importScripts,jy=(()=>{if(fC){const i=[];Lr.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,r=i.length;n<r;n++){const s=i[n];if(s.id===t.data.vscodeScheduleAsyncWork){i.splice(n,1),s.callback();return}}});let e=0;return t=>{const n=++e;i.push({id:n,callback:t}),Lr.postMessage({vscodeScheduleAsyncWork:n},"*")}}return i=>setTimeout(i)})();var tl;(function(i){i[i.Windows=1]="Windows",i[i.Macintosh=2]="Macintosh",i[i.Linux=3]="Linux"})(tl||(tl={})),_u||Wy?tl.Macintosh:mu?tl.Windows:tl.Linux;let Gy=!0,Qy=!1;function Jy(){if(!Qy){Qy=!0;const i=new Uint8Array(2);i[0]=1,i[1]=2,Gy=new Uint16Array(i.buffer)[0]===513}return Gy}const Xy=!!(nr&&nr.indexOf("Chrome")>=0),pC=!!(nr&&nr.indexOf("Firefox")>=0),gC=!!(!Xy&&nr&&nr.indexOf("Safari")>=0),mC=!!(nr&&nr.indexOf("Edg/")>=0);nr&&nr.indexOf("Android")>=0;let _o;const B1=globalThis.vscode;if(typeof B1<"u"&&typeof B1.process<"u"){const i=B1.process;_o={get platform(){return i.platform},get arch(){return i.arch},get env(){return i.env},cwd(){return i.cwd()}}}else typeof process<"u"&&typeof((h5=process==null?void 0:process.versions)==null?void 0:h5.node)=="string"?_o={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:_o={get platform(){return cn?"win32":Rn?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const il=_o.cwd,W1=_o.env,_C=_o.platform;_o.arch;const vC=65,wC=97,bC=90,yC=122,ys=46,_i=47,Xi=92,xs=58,xC=63;class Yy extends Error{constructor(e,t,n){let r;typeof t=="string"&&t.indexOf("not ")===0?(r="must not be",t=t.replace(/^not /,"")):r="must be";const s=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${s} ${r} of type ${t}`;o+=`. Received type ${typeof n}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function EC(i,e){if(i===null||typeof i!="object")throw new Yy(e,"Object",i)}function zt(i,e){if(typeof i!="string")throw new Yy(e,"string",i)}const xn=_C==="win32";function ze(i){return i===_i||i===Xi}function V1(i){return i===_i}function Es(i){return i>=vC&&i<=bC||i>=wC&&i<=yC}function _f(i,e,t,n){let r="",s=0,o=-1,a=0,l=0;for(let c=0;c<=i.length;++c){if(c<i.length)l=i.charCodeAt(c);else{if(n(l))break;l=_i}if(n(l)){if(!(o===c-1||a===1))if(a===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==ys||r.charCodeAt(r.length-2)!==ys){if(r.length>2){const u=r.lastIndexOf(t);u===-1?(r="",s=0):(r=r.slice(0,u),s=r.length-1-r.lastIndexOf(t)),o=c,a=0;continue}else if(r.length!==0){r="",s=0,o=c,a=0;continue}}e&&(r+=r.length>0?`${t}..`:"..",s=2)}else r.length>0?r+=`${t}${i.slice(o+1,c)}`:r=i.slice(o+1,c),s=c-o-1;o=c,a=0}else l===ys&&a!==-1?++a:a=-1}return r}function SC(i){return i?`${i[0]==="."?"":"."}${i}`:""}function Ky(i,e){EC(e,"pathObject");const t=e.dir||e.root,n=e.base||`${e.name||""}${SC(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}${i}${n}`:n}const li={resolve(...i){let e="",t="",n=!1;for(let r=i.length-1;r>=-1;r--){let s;if(r>=0){if(s=i[r],zt(s,`paths[${r}]`),s.length===0)continue}else e.length===0?s=il():(s=W1[`=${e}`]||il(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===Xi)&&(s=`${e}\\`));const o=s.length;let a=0,l="",c=!1;const u=s.charCodeAt(0);if(o===1)ze(u)&&(a=1,c=!0);else if(ze(u))if(c=!0,ze(s.charCodeAt(1))){let d=2,f=d;for(;d<o&&!ze(s.charCodeAt(d));)d++;if(d<o&&d!==f){const p=s.slice(f,d);for(f=d;d<o&&ze(s.charCodeAt(d));)d++;if(d<o&&d!==f){for(f=d;d<o&&!ze(s.charCodeAt(d));)d++;(d===o||d!==f)&&(l=`\\\\${p}\\${s.slice(f,d)}`,a=d)}}}else a=1;else Es(u)&&s.charCodeAt(1)===xs&&(l=s.slice(0,2),a=2,o>2&&ze(s.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${s.slice(a)}\\${t}`,n=c,c&&e.length>0)break}return t=_f(t,!n,"\\",ze),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(i){zt(i,"path");const e=i.length;if(e===0)return".";let t=0,n,r=!1;const s=i.charCodeAt(0);if(e===1)return V1(s)?"\\":i;if(ze(s))if(r=!0,ze(i.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ze(i.charCodeAt(a));)a++;if(a<e&&a!==l){const c=i.slice(l,a);for(l=a;a<e&&ze(i.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ze(i.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${i.slice(l)}\\`;a!==l&&(n=`\\\\${c}\\${i.slice(l,a)}`,t=a)}}}else t=1;else Es(s)&&i.charCodeAt(1)===xs&&(n=i.slice(0,2),t=2,e>2&&ze(i.charCodeAt(2))&&(r=!0,t=3));let o=t<e?_f(i.slice(t),!r,"\\",ze):"";return o.length===0&&!r&&(o="."),o.length>0&&ze(i.charCodeAt(e-1))&&(o+="\\"),n===void 0?r?`\\${o}`:o:r?`${n}\\${o}`:`${n}${o}`},isAbsolute(i){zt(i,"path");const e=i.length;if(e===0)return!1;const t=i.charCodeAt(0);return ze(t)||e>2&&Es(t)&&i.charCodeAt(1)===xs&&ze(i.charCodeAt(2))},join(...i){if(i.length===0)return".";let e,t;for(let s=0;s<i.length;++s){const o=i[s];zt(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let n=!0,r=0;if(typeof t=="string"&&ze(t.charCodeAt(0))){++r;const s=t.length;s>1&&ze(t.charCodeAt(1))&&(++r,s>2&&(ze(t.charCodeAt(2))?++r:n=!1))}if(n){for(;r<e.length&&ze(e.charCodeAt(r));)r++;r>=2&&(e=`\\${e.slice(r)}`)}return li.normalize(e)},relative(i,e){if(zt(i,"from"),zt(e,"to"),i===e)return"";const t=li.resolve(i),n=li.resolve(e);if(t===n||(i=t.toLowerCase(),e=n.toLowerCase(),i===e))return"";let r=0;for(;r<i.length&&i.charCodeAt(r)===Xi;)r++;let s=i.length;for(;s-1>r&&i.charCodeAt(s-1)===Xi;)s--;const o=s-r;let a=0;for(;a<e.length&&e.charCodeAt(a)===Xi;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Xi;)l--;const c=l-a,u=o<c?o:c;let d=-1,f=0;for(;f<u;f++){const b=i.charCodeAt(r+f);if(b!==e.charCodeAt(a+f))break;b===Xi&&(d=f)}if(f!==u){if(d===-1)return n}else{if(c>u){if(e.charCodeAt(a+f)===Xi)return n.slice(a+f+1);if(f===2)return n.slice(a+f)}o>u&&(i.charCodeAt(r+f)===Xi?d=f:f===2&&(d=3)),d===-1&&(d=0)}let p="";for(f=r+d+1;f<=s;++f)(f===s||i.charCodeAt(f)===Xi)&&(p+=p.length===0?"..":"\\..");return a+=d,p.length>0?`${p}${n.slice(a,l)}`:(n.charCodeAt(a)===Xi&&++a,n.slice(a,l))},toNamespacedPath(i){if(typeof i!="string"||i.length===0)return i;const e=li.resolve(i);if(e.length<=2)return i;if(e.charCodeAt(0)===Xi){if(e.charCodeAt(1)===Xi){const t=e.charCodeAt(2);if(t!==xC&&t!==ys)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Es(e.charCodeAt(0))&&e.charCodeAt(1)===xs&&e.charCodeAt(2)===Xi)return`\\\\?\\${e}`;return i},dirname(i){zt(i,"path");const e=i.length;if(e===0)return".";let t=-1,n=0;const r=i.charCodeAt(0);if(e===1)return ze(r)?i:".";if(ze(r)){if(t=n=1,ze(i.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ze(i.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&ze(i.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ze(i.charCodeAt(a));)a++;if(a===e)return i;a!==l&&(t=n=a+1)}}}}else Es(r)&&i.charCodeAt(1)===xs&&(t=e>2&&ze(i.charCodeAt(2))?3:2,n=t);let s=-1,o=!0;for(let a=e-1;a>=n;--a)if(ze(i.charCodeAt(a))){if(!o){s=a;break}}else o=!1;if(s===-1){if(t===-1)return".";s=t}return i.slice(0,s)},basename(i,e){e!==void 0&&zt(e,"suffix"),zt(i,"path");let t=0,n=-1,r=!0,s;if(i.length>=2&&Es(i.charCodeAt(0))&&i.charCodeAt(1)===xs&&(t=2),e!==void 0&&e.length>0&&e.length<=i.length){if(e===i)return"";let o=e.length-1,a=-1;for(s=i.length-1;s>=t;--s){const l=i.charCodeAt(s);if(ze(l)){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return t===n?n=a:n===-1&&(n=i.length),i.slice(t,n)}for(s=i.length-1;s>=t;--s)if(ze(i.charCodeAt(s))){if(!r){t=s+1;break}}else n===-1&&(r=!1,n=s+1);return n===-1?"":i.slice(t,n)},extname(i){zt(i,"path");let e=0,t=-1,n=0,r=-1,s=!0,o=0;i.length>=2&&i.charCodeAt(1)===xs&&Es(i.charCodeAt(0))&&(e=n=2);for(let a=i.length-1;a>=e;--a){const l=i.charCodeAt(a);if(ze(l)){if(!s){n=a+1;break}continue}r===-1&&(s=!1,r=a+1),l===ys?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||r===-1||o===0||o===1&&t===r-1&&t===n+1?"":i.slice(t,r)},format:Ky.bind(null,"\\"),parse(i){zt(i,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return e;const t=i.length;let n=0,r=i.charCodeAt(0);if(t===1)return ze(r)?(e.root=e.dir=i,e):(e.base=e.name=i,e);if(ze(r)){if(n=1,ze(i.charCodeAt(1))){let d=2,f=d;for(;d<t&&!ze(i.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&ze(i.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&!ze(i.charCodeAt(d));)d++;d===t?n=d:d!==f&&(n=d+1)}}}}else if(Es(r)&&i.charCodeAt(1)===xs){if(t<=2)return e.root=e.dir=i,e;if(n=2,ze(i.charCodeAt(2))){if(t===3)return e.root=e.dir=i,e;n=3}}n>0&&(e.root=i.slice(0,n));let s=-1,o=n,a=-1,l=!0,c=i.length-1,u=0;for(;c>=n;--c){if(r=i.charCodeAt(c),ze(r)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===ys?s===-1?s=c:u!==1&&(u=1):s!==-1&&(u=-1)}return a!==-1&&(s===-1||u===0||u===1&&s===a-1&&s===o+1?e.base=e.name=i.slice(o,a):(e.name=i.slice(o,s),e.base=i.slice(o,a),e.ext=i.slice(s,a))),o>0&&o!==n?e.dir=i.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},DC=(()=>{if(xn){const i=/\\/g;return()=>{const e=il().replace(i,"/");return e.slice(e.indexOf("/"))}}return()=>il()})(),tt={resolve(...i){let e="",t=!1;for(let n=i.length-1;n>=-1&&!t;n--){const r=n>=0?i[n]:DC();zt(r,`paths[${n}]`),r.length!==0&&(e=`${r}/${e}`,t=r.charCodeAt(0)===_i)}return e=_f(e,!t,"/",V1),t?`/${e}`:e.length>0?e:"."},normalize(i){if(zt(i,"path"),i.length===0)return".";const e=i.charCodeAt(0)===_i,t=i.charCodeAt(i.length-1)===_i;return i=_f(i,!e,"/",V1),i.length===0?e?"/":t?"./":".":(t&&(i+="/"),e?`/${i}`:i)},isAbsolute(i){return zt(i,"path"),i.length>0&&i.charCodeAt(0)===_i},join(...i){if(i.length===0)return".";let e;for(let t=0;t<i.length;++t){const n=i[t];zt(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":tt.normalize(e)},relative(i,e){if(zt(i,"from"),zt(e,"to"),i===e||(i=tt.resolve(i),e=tt.resolve(e),i===e))return"";const t=1,n=i.length,r=n-t,s=1,o=e.length-s,a=r<o?r:o;let l=-1,c=0;for(;c<a;c++){const d=i.charCodeAt(t+c);if(d!==e.charCodeAt(s+c))break;d===_i&&(l=c)}if(c===a)if(o>a){if(e.charCodeAt(s+c)===_i)return e.slice(s+c+1);if(c===0)return e.slice(s+c)}else r>a&&(i.charCodeAt(t+c)===_i?l=c:c===0&&(l=0));let u="";for(c=t+l+1;c<=n;++c)(c===n||i.charCodeAt(c)===_i)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(s+l)}`},toNamespacedPath(i){return i},dirname(i){if(zt(i,"path"),i.length===0)return".";const e=i.charCodeAt(0)===_i;let t=-1,n=!0;for(let r=i.length-1;r>=1;--r)if(i.charCodeAt(r)===_i){if(!n){t=r;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":i.slice(0,t)},basename(i,e){e!==void 0&&zt(e,"ext"),zt(i,"path");let t=0,n=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=i.length){if(e===i)return"";let o=e.length-1,a=-1;for(s=i.length-1;s>=0;--s){const l=i.charCodeAt(s);if(l===_i){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(n=s):(o=-1,n=a))}return t===n?n=a:n===-1&&(n=i.length),i.slice(t,n)}for(s=i.length-1;s>=0;--s)if(i.charCodeAt(s)===_i){if(!r){t=s+1;break}}else n===-1&&(r=!1,n=s+1);return n===-1?"":i.slice(t,n)},extname(i){zt(i,"path");let e=-1,t=0,n=-1,r=!0,s=0;for(let o=i.length-1;o>=0;--o){const a=i.charCodeAt(o);if(a===_i){if(!r){t=o+1;break}continue}n===-1&&(r=!1,n=o+1),a===ys?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===t+1?"":i.slice(e,n)},format:Ky.bind(null,"/"),parse(i){zt(i,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return e;const t=i.charCodeAt(0)===_i;let n;t?(e.root="/",n=1):n=0;let r=-1,s=0,o=-1,a=!0,l=i.length-1,c=0;for(;l>=n;--l){const u=i.charCodeAt(l);if(u===_i){if(!a){s=l+1;break}continue}o===-1&&(a=!1,o=l+1),u===ys?r===-1?r=l:c!==1&&(c=1):r!==-1&&(c=-1)}if(o!==-1){const u=s===0&&t?1:s;r===-1||c===0||c===1&&r===o-1&&r===s+1?e.base=e.name=i.slice(u,o):(e.name=i.slice(u,r),e.base=i.slice(u,o),e.ext=i.slice(r,o))}return s>0?e.dir=i.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};tt.win32=li.win32=li,tt.posix=li.posix=tt;const nl=xn?li.normalize:tt.normalize,z1=xn?li.isAbsolute:tt.isAbsolute,Zy=xn?li.join:tt.join,kC=xn?li.resolve:tt.resolve,bu=xn?li.relative:tt.relative,vo=xn?li.dirname:tt.dirname,Yi=xn?li.basename:tt.basename,q1=xn?li.extname:tt.extname;xn?li.parse:tt.parse;const Ln=xn?li.sep:tt.sep;xn?li.delimiter:tt.delimiter;const CC=/^\w[\w\d+.-]*$/,IC=/^\//,PC=/^\/\//;function TC(i,e){if(!i.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${i.authority}", path: "${i.path}", query: "${i.query}", fragment: "${i.fragment}"}`);if(i.scheme&&!CC.test(i.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(i.path){if(i.authority){if(!IC.test(i.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(PC.test(i.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function AC(i,e){return!i&&!e?"file":i}function RC(i,e){switch(i){case"https":case"http":case"file":e?e[0]!==Nn&&(e=Nn+e):e=Nn;break}return e}const xt="",Nn="/",LC=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class y{static isUri(e){return e instanceof y?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,n,r,s,o=!1){typeof e=="object"?(this.scheme=e.scheme||xt,this.authority=e.authority||xt,this.path=e.path||xt,this.query=e.query||xt,this.fragment=e.fragment||xt):(this.scheme=AC(e,o),this.authority=t||xt,this.path=RC(this.scheme,n||xt),this.query=r||xt,this.fragment=s||xt,TC(this,o))}get fsPath(){return vf(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:r,query:s,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=xt),n===void 0?n=this.authority:n===null&&(n=xt),r===void 0?r=this.path:r===null&&(r=xt),s===void 0?s=this.query:s===null&&(s=xt),o===void 0?o=this.fragment:o===null&&(o=xt),t===this.scheme&&n===this.authority&&r===this.path&&s===this.query&&o===this.fragment?this:new rl(t,n,r,s,o)}static parse(e,t=!1){const n=LC.exec(e);return n?new rl(n[2]||xt,wf(n[4]||xt),wf(n[5]||xt),wf(n[7]||xt),wf(n[9]||xt),t):new rl(xt,xt,xt,xt,xt)}static file(e){let t=xt;if(cn&&(e=e.replace(/\\/g,Nn)),e[0]===Nn&&e[1]===Nn){const n=e.indexOf(Nn,2);n===-1?(t=e.substring(2),e=Nn):(t=e.substring(2,n),e=e.substring(n)||Nn)}return new rl("file",t,e,xt,xt)}static from(e,t){return new rl(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return cn&&e.scheme==="file"?n=y.file(li.join(vf(e,!0),...t)).path:n=tt.join(e.path,...t),e.with({path:n})}toString(e=!1){return j1(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof y)return e;{const t=new rl(e);return t._formatted=e.external??null,t._fsPath=e._sep===tx?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}}function ex(i){return!i||typeof i!="object"?!1:typeof i.scheme=="string"&&(typeof i.authority=="string"||typeof i.authority>"u")&&(typeof i.path=="string"||typeof i.path>"u")&&(typeof i.query=="string"||typeof i.query>"u")&&(typeof i.fragment=="string"||typeof i.fragment>"u")}const tx=cn?1:void 0;class rl extends y{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=vf(this,!1)),this._fsPath}toString(e=!1){return e?j1(this,!0):(this._formatted||(this._formatted=j1(this,!1)),this._formatted)}toJSON(){const e={$mid:mt.Uri};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=tx),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const ix={[P.Colon]:"%3A",[P.Slash]:"%2F",[P.QuestionMark]:"%3F",[P.Hash]:"%23",[P.OpenSquareBracket]:"%5B",[P.CloseSquareBracket]:"%5D",[P.AtSign]:"%40",[P.ExclamationMark]:"%21",[P.DollarSign]:"%24",[P.Ampersand]:"%26",[P.SingleQuote]:"%27",[P.OpenParen]:"%28",[P.CloseParen]:"%29",[P.Asterisk]:"%2A",[P.Plus]:"%2B",[P.Comma]:"%2C",[P.Semicolon]:"%3B",[P.Equals]:"%3D",[P.Space]:"%20"};function nx(i,e,t){let n,r=-1;for(let s=0;s<i.length;s++){const o=i.charCodeAt(s);if(o>=P.a&&o<=P.z||o>=P.A&&o<=P.Z||o>=P.Digit0&&o<=P.Digit9||o===P.Dash||o===P.Period||o===P.Underline||o===P.Tilde||e&&o===P.Slash||t&&o===P.OpenSquareBracket||t&&o===P.CloseSquareBracket||t&&o===P.Colon)r!==-1&&(n+=encodeURIComponent(i.substring(r,s)),r=-1),n!==void 0&&(n+=i.charAt(s));else{n===void 0&&(n=i.substr(0,s));const a=ix[o];a!==void 0?(r!==-1&&(n+=encodeURIComponent(i.substring(r,s)),r=-1),n+=a):r===-1&&(r=s)}}return r!==-1&&(n+=encodeURIComponent(i.substring(r))),n!==void 0?n:i}function NC(i){let e;for(let t=0;t<i.length;t++){const n=i.charCodeAt(t);n===P.Hash||n===P.QuestionMark?(e===void 0&&(e=i.substr(0,t)),e+=ix[n]):e!==void 0&&(e+=i[t])}return e!==void 0?e:i}function vf(i,e){let t;return i.authority&&i.path.length>1&&i.scheme==="file"?t=`//${i.authority}${i.path}`:i.path.charCodeAt(0)===P.Slash&&(i.path.charCodeAt(1)>=P.A&&i.path.charCodeAt(1)<=P.Z||i.path.charCodeAt(1)>=P.a&&i.path.charCodeAt(1)<=P.z)&&i.path.charCodeAt(2)===P.Colon?e?t=i.path.substr(1):t=i.path[1].toLowerCase()+i.path.substr(2):t=i.path,cn&&(t=t.replace(/\//g,"\\")),t}function j1(i,e){const t=e?NC:nx;let n="",{scheme:r,authority:s,path:o,query:a,fragment:l}=i;if(r&&(n+=r,n+=":"),(s||r==="file")&&(n+=Nn,n+=Nn),s){let c=s.indexOf("@");if(c!==-1){const u=s.substr(0,c);s=s.substr(c+1),c=u.lastIndexOf(":"),c===-1?n+=t(u,!1,!1):(n+=t(u.substr(0,c),!1,!1),n+=":",n+=t(u.substr(c+1),!1,!0)),n+="@"}s=s.toLowerCase(),c=s.lastIndexOf(":"),c===-1?n+=t(s,!1,!0):(n+=t(s.substr(0,c),!1,!0),n+=s.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===P.Slash&&o.charCodeAt(2)===P.Colon){const c=o.charCodeAt(1);c>=P.A&&c<=P.Z&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===P.Colon){const c=o.charCodeAt(0);c>=P.A&&c<=P.Z&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}n+=t(o,!0,!1)}return a&&(n+="?",n+=t(a,!1,!1)),l&&(n+="#",n+=e?l:nx(l,!1,!1)),n}function rx(i){try{return decodeURIComponent(i)}catch{return i.length>3?i.substr(0,3)+rx(i.substr(3)):i}}const sx=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function wf(i){return i.match(sx)?i.replace(sx,e=>rx(e)):i}const qm=class qm{constructor(e){this._proxyIdentifierBrand=void 0,this.sid=e,this.nid=++qm.count}};qm.count=0;let bf=qm;const ox=[];function U(i){const e=new bf(i);return ox[e.nid]=e,e}function yf(i){return ox[i].sid}class un{constructor(e){this.value=e}}var ax;(function(i){i[i.Default=0]="Default",i[i.InCenter=1]="InCenter",i[i.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",i[i.AtTop=3]="AtTop"})(ax||(ax={}));var dn;(function(i){i[i.UnknownInput=0]="UnknownInput",i[i.TextInput=1]="TextInput",i[i.TextDiffInput=2]="TextDiffInput",i[i.TextMergeInput=3]="TextMergeInput",i[i.NotebookInput=4]="NotebookInput",i[i.NotebookDiffInput=5]="NotebookDiffInput",i[i.CustomEditorInput=6]="CustomEditorInput",i[i.WebviewEditorInput=7]="WebviewEditorInput",i[i.TerminalEditorInput=8]="TerminalEditorInput",i[i.InteractiveEditorInput=9]="InteractiveEditorInput",i[i.ChatEditorInput=10]="ChatEditorInput",i[i.MultiDiffEditorInput=11]="MultiDiffEditorInput"})(dn||(dn={}));var Nr;(function(i){i[i.TAB_OPEN=0]="TAB_OPEN",i[i.TAB_CLOSE=1]="TAB_CLOSE",i[i.TAB_UPDATE=2]="TAB_UPDATE",i[i.TAB_MOVE=3]="TAB_MOVE"})(Nr||(Nr={}));var Lt;(function(i){i[i.Int8Array=1]="Int8Array",i[i.Uint8Array=2]="Uint8Array",i[i.Uint8ClampedArray=3]="Uint8ClampedArray",i[i.Int16Array=4]="Int16Array",i[i.Uint16Array=5]="Uint16Array",i[i.Int32Array=6]="Int32Array",i[i.Uint32Array=7]="Uint32Array",i[i.Float32Array=8]="Float32Array",i[i.Float64Array=9]="Float64Array",i[i.BigInt64Array=10]="BigInt64Array",i[i.BigUint64Array=11]="BigUint64Array"})(Lt||(Lt={}));var lx;(function(i){i[i.Default=0]="Default",i[i.InCenter=1]="InCenter",i[i.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",i[i.AtTop=3]="AtTop"})(lx||(lx={}));var G1;(function(i){i[i.None=0]="None",i[i.Process=1]="Process",i[i.Output=2]="Output",i[i.Hybrid=3]="Hybrid"})(G1||(G1={}));var Ne;(function(i){i.label="a",i.kind="b",i.detail="c",i.documentation="d",i.sortText="e",i.filterText="f",i.preselect="g",i.insertText="h",i.insertTextRules="i",i.range="j",i.commitCharacters="k",i.additionalTextEdits="l",i.kindModifier="m",i.commandIdent="n",i.commandId="o",i.commandArguments="p"})(Ne||(Ne={}));var sl;(function(i){i.defaultRanges="a",i.completions="b",i.isIncomplete="c",i.duration="d"})(sl||(sl={}));const Z={MainThreadAuthentication:U("MainThreadAuthentication"),MainThreadBulkEdits:U("MainThreadBulkEdits"),MainThreadLanguageModels:U("MainThreadLanguageModels"),MainThreadEmbeddings:U("MainThreadEmbeddings"),MainThreadChatAgents2:U("MainThreadChatAgents2"),MainThreadChatVariables:U("MainThreadChatVariables"),MainThreadLanguageModelTools:U("MainThreadChatSkills"),MainThreadClipboard:U("MainThreadClipboard"),MainThreadCommands:U("MainThreadCommands"),MainThreadComments:U("MainThreadComments"),MainThreadConfiguration:U("MainThreadConfiguration"),MainThreadConsole:U("MainThreadConsole"),MainThreadDebugService:U("MainThreadDebugService"),MainThreadDecorations:U("MainThreadDecorations"),MainThreadDiagnostics:U("MainThreadDiagnostics"),MainThreadDialogs:U("MainThreadDiaglogs"),MainThreadDocuments:U("MainThreadDocuments"),MainThreadDocumentContentProviders:U("MainThreadDocumentContentProviders"),MainThreadTextEditors:U("MainThreadTextEditors"),MainThreadEditorInsets:U("MainThreadEditorInsets"),MainThreadEditorTabs:U("MainThreadEditorTabs"),MainThreadErrors:U("MainThreadErrors"),MainThreadTreeViews:U("MainThreadTreeViews"),MainThreadDownloadService:U("MainThreadDownloadService"),MainThreadLanguageFeatures:U("MainThreadLanguageFeatures"),MainThreadLanguages:U("MainThreadLanguages"),MainThreadLogger:U("MainThreadLogger"),MainThreadMessageService:U("MainThreadMessageService"),MainThreadOutputService:U("MainThreadOutputService"),MainThreadProgress:U("MainThreadProgress"),MainThreadQuickDiff:U("MainThreadQuickDiff"),MainThreadQuickOpen:U("MainThreadQuickOpen"),MainThreadStatusBar:U("MainThreadStatusBar"),MainThreadSecretState:U("MainThreadSecretState"),MainThreadStorage:U("MainThreadStorage"),MainThreadSpeech:U("MainThreadSpeechProvider"),MainThreadTelemetry:U("MainThreadTelemetry"),MainThreadTerminalService:U("MainThreadTerminalService"),MainThreadTerminalShellIntegration:U("MainThreadTerminalShellIntegration"),MainThreadWebviews:U("MainThreadWebviews"),MainThreadWebviewPanels:U("MainThreadWebviewPanels"),MainThreadWebviewViews:U("MainThreadWebviewViews"),MainThreadCustomEditors:U("MainThreadCustomEditors"),MainThreadUrls:U("MainThreadUrls"),MainThreadUriOpeners:U("MainThreadUriOpeners"),MainThreadProfileContentHandlers:U("MainThreadProfileContentHandlers"),MainThreadWorkspace:U("MainThreadWorkspace"),MainThreadFileSystem:U("MainThreadFileSystem"),MainThreadFileSystemEventService:U("MainThreadFileSystemEventService"),MainThreadExtensionService:U("MainThreadExtensionService"),MainThreadSCM:U("MainThreadSCM"),MainThreadSearch:U("MainThreadSearch"),MainThreadShare:U("MainThreadShare"),MainThreadTask:U("MainThreadTask"),MainThreadWindow:U("MainThreadWindow"),MainThreadLabelService:U("MainThreadLabelService"),MainThreadNotebook:U("MainThreadNotebook"),MainThreadNotebookDocuments:U("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:U("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:U("MainThreadNotebookKernels"),MainThreadNotebookRenderers:U("MainThreadNotebookRenderers"),MainThreadInteractive:U("MainThreadInteractive"),MainThreadTheming:U("MainThreadTheming"),MainThreadTunnelService:U("MainThreadTunnelService"),MainThreadManagedSockets:U("MainThreadManagedSockets"),MainThreadTimeline:U("MainThreadTimeline"),MainThreadTesting:U("MainThreadTesting"),MainThreadLocalization:U("MainThreadLocalizationShape"),MainThreadAiRelatedInformation:U("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:U("MainThreadAiEmbeddingVector")},ce={ExtHostCommands:U("ExtHostCommands"),ExtHostConfiguration:U("ExtHostConfiguration"),ExtHostDiagnostics:U("ExtHostDiagnostics"),ExtHostDebugService:U("ExtHostDebugService"),ExtHostDecorations:U("ExtHostDecorations"),ExtHostDocumentsAndEditors:U("ExtHostDocumentsAndEditors"),ExtHostDocuments:U("ExtHostDocuments"),ExtHostDocumentContentProviders:U("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:U("ExtHostDocumentSaveParticipant"),ExtHostEditors:U("ExtHostEditors"),ExtHostTreeViews:U("ExtHostTreeViews"),ExtHostFileSystem:U("ExtHostFileSystem"),ExtHostFileSystemInfo:U("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:U("ExtHostFileSystemEventService"),ExtHostLanguages:U("ExtHostLanguages"),ExtHostLanguageFeatures:U("ExtHostLanguageFeatures"),ExtHostQuickOpen:U("ExtHostQuickOpen"),ExtHostQuickDiff:U("ExtHostQuickDiff"),ExtHostStatusBar:U("ExtHostStatusBar"),ExtHostShare:U("ExtHostShare"),ExtHostExtensionService:U("ExtHostExtensionService"),ExtHostLogLevelServiceShape:U("ExtHostLogLevelServiceShape"),ExtHostTerminalService:U("ExtHostTerminalService"),ExtHostTerminalShellIntegration:U("ExtHostTerminalShellIntegration"),ExtHostSCM:U("ExtHostSCM"),ExtHostSearch:U("ExtHostSearch"),ExtHostTask:U("ExtHostTask"),ExtHostWorkspace:U("ExtHostWorkspace"),ExtHostWindow:U("ExtHostWindow"),ExtHostWebviews:U("ExtHostWebviews"),ExtHostWebviewPanels:U("ExtHostWebviewPanels"),ExtHostCustomEditors:U("ExtHostCustomEditors"),ExtHostWebviewViews:U("ExtHostWebviewViews"),ExtHostEditorInsets:U("ExtHostEditorInsets"),ExtHostEditorTabs:U("ExtHostEditorTabs"),ExtHostProgress:U("ExtHostProgress"),ExtHostComments:U("ExtHostComments"),ExtHostSecretState:U("ExtHostSecretState"),ExtHostStorage:U("ExtHostStorage"),ExtHostUrls:U("ExtHostUrls"),ExtHostUriOpeners:U("ExtHostUriOpeners"),ExtHostProfileContentHandlers:U("ExtHostProfileContentHandlers"),ExtHostOutputService:U("ExtHostOutputService"),ExtHostLabelService:U("ExtHostLabelService"),ExtHostNotebook:U("ExtHostNotebook"),ExtHostNotebookDocuments:U("ExtHostNotebookDocuments"),ExtHostNotebookEditors:U("ExtHostNotebookEditors"),ExtHostNotebookKernels:U("ExtHostNotebookKernels"),ExtHostNotebookRenderers:U("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:U("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:U("ExtHostInteractive"),ExtHostChatAgents2:U("ExtHostChatAgents"),ExtHostChatVariables:U("ExtHostChatVariables"),ExtHostLanguageModelTools:U("ExtHostChatSkills"),ExtHostChatProvider:U("ExtHostChatProvider"),ExtHostSpeech:U("ExtHostSpeech"),ExtHostEmbeddings:U("ExtHostEmbeddings"),ExtHostAiRelatedInformation:U("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:U("ExtHostAiEmbeddingVector"),ExtHostTheming:U("ExtHostTheming"),ExtHostTunnelService:U("ExtHostTunnelService"),ExtHostManagedSockets:U("ExtHostManagedSockets"),ExtHostAuthentication:U("ExtHostAuthentication"),ExtHostTimeline:U("ExtHostTimeline"),ExtHostTesting:U("ExtHostTesting"),ExtHostTelemetry:U("ExtHostTelemetry"),ExtHostLocalization:U("ExtHostLocalization")},cx=Object.freeze(function(i,e){const t=setTimeout(i.bind(e),0);return{dispose(){clearTimeout(t)}}});var Nt;(function(i){function e(t){return t===i.None||t===i.Cancelled||t instanceof xf?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}i.isCancellationToken=e,i.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ht.None}),i.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:cx})})(Nt||(Nt={}));class xf{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?cx:(this._emitter||(this._emitter=new L),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class Qt{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new xf),this._token}cancel(){this._token?this._token instanceof xf&&this._token.cancel():this._token=Nt.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof xf&&this._token.dispose():this._token=Nt.None}}function OC(i){return i}class FC{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=OC):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}var Ri;(function(i){i[i.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",i[i.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",i[i.MAX_UINT_8=255]="MAX_UINT_8",i[i.MAX_UINT_16=65535]="MAX_UINT_16",i[i.MAX_UINT_32=4294967295]="MAX_UINT_32",i[i.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(Ri||(Ri={}));function ux(i){return i<0?0:i>Ri.MAX_UINT_8?Ri.MAX_UINT_8:i|0}function ol(i){return i<0?0:i>Ri.MAX_UINT_32?Ri.MAX_UINT_32:i|0}function yu(i){return!i||typeof i!="string"?!0:i.trim().length===0}const MC=/{([^}]+)}/g;function dx(i,e){return Object.keys(e).length===0?i:i.replace(MC,(t,n)=>e[n]??t)}function wo(i){return i.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function $C(i,e){let t=0,n=i.indexOf(e);for(;n!==-1;)t++,n=i.indexOf(e,n+e.length);return t}function UC(i,e){if(!i||!e)return i;const t=e.length;if(t===0||i.length===0)return i;let n=0;for(;i.indexOf(e,n)===n;)n=n+t;return i.substring(n)}function hx(i,e){if(!i||!e)return i;const t=e.length,n=i.length;if(t===0||n===0)return i;let r=n,s=-1;for(;s=i.lastIndexOf(e,r-1),!(s===-1||s+t!==r);){if(s===0)return"";r=s}return i.substring(0,r)}function HC(i,e,t={}){if(!i)throw new Error("Cannot create regex from empty string");e||(i=wo(i)),t.wholeWord&&(/\B/.test(i.charAt(0))||(i="\\b"+i),/\B/.test(i.charAt(i.length-1))||(i=i+"\\b"));let n="";return t.global&&(n+="g"),t.matchCase||(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),new RegExp(i,n)}function fx(i){return i.source==="^"||i.source==="^$"||i.source==="$"||i.source==="^\\s*$"?!1:!!(i.exec("")&&i.lastIndex===0)}function px(i){return i.split(/\r\n|\r|\n/)}function Q1(i){for(let e=0,t=i.length;e<t;e++){const n=i.charCodeAt(e);if(n!==P.Space&&n!==P.Tab)return e}return-1}function BC(i,e=i.length-1){for(let t=e;t>=0;t--){const n=i.charCodeAt(t);if(n!==P.Space&&n!==P.Tab)return t}return-1}function WC(i,e,t){const n=[];let r=0;for(const s of i.matchAll(e)){if(n.push(i.slice(r,s.index)),s.index===void 0)throw new Error("match.index should be defined");r=s.index+s[0].length,n.push(t(s[0],...s.slice(1),s.index,i,s.groups))}return n.push(i.slice(r)),Promise.all(n).then(s=>s.join(""))}function bo(i,e){return i<e?-1:i>e?1:0}function J1(i,e,t=0,n=i.length,r=0,s=e.length){for(;t<n&&r<s;t++,r++){const l=i.charCodeAt(t),c=e.charCodeAt(r);if(l<c)return-1;if(l>c)return 1}const o=n-t,a=s-r;return o<a?-1:o>a?1:0}function gx(i,e){return xu(i,e,0,i.length,0,e.length)}function xu(i,e,t=0,n=i.length,r=0,s=e.length){for(;t<n&&r<s;t++,r++){let l=i.charCodeAt(t),c=e.charCodeAt(r);if(l===c)continue;if(l>=128||c>=128)return J1(i.toLowerCase(),e.toLowerCase(),t,n,r,s);mx(l)&&(l-=32),mx(c)&&(c-=32);const u=l-c;if(u!==0)return u}const o=n-t,a=s-r;return o<a?-1:o>a?1:0}function mx(i){return i>=P.a&&i<=P.z}function Ss(i,e){return i.length===e.length&&xu(i,e)===0}function X1(i,e){const t=e.length;return e.length>i.length?!1:xu(i,e,0,t)===0}function VC(i,e){const t=Math.min(i.length,e.length);let n;for(n=0;n<t;n++)if(i.charCodeAt(n)!==e.charCodeAt(n))return n;return t}function Y1(i){return 55296<=i&&i<=56319}function _x(i){return 56320<=i&&i<=57343}function vx(i,e){return(i-55296<<10)+(e-56320)+65536}function wx(i,e,t){const n=i.charCodeAt(t);if(Y1(n)&&t+1<e){const r=i.charCodeAt(t+1);if(_x(r))return vx(n,r)}return n}function zC(i,e){const t=i.charCodeAt(e-1);if(_x(t)&&e>1){const n=i.charCodeAt(e-2);if(Y1(n))return vx(n,t)}return t}class qC{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=zC(this._str,this._offset);return this._offset-=e>=Ri.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,e}nextCodePoint(){const e=wx(this._str,this._len,this._offset);return this._offset+=e>=Ri.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,e}eol(){return this._offset>=this._len}}class jC{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new qC(e,t)}nextGraphemeLength(){const e=Ef.getInstance(),t=this._iterator,n=t.offset;let r=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const s=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(Sx(r,o)){t.setOffset(s);break}r=o}return t.offset-n}prevGraphemeLength(){const e=Ef.getInstance(),t=this._iterator,n=t.offset;let r=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const s=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(Sx(o,r)){t.setOffset(s);break}r=o}return n-t.offset}eol(){return this._iterator.eol()}}function bx(i,e){return new jC(i,e).nextGraphemeLength()}let K1;function GC(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function yx(i){return K1||(K1=GC()),K1.test(i)}const QC=/^[\t\n\r\x20-\x7E]*$/;function JC(i){return QC.test(i)}const XC=/[\u2028\u2029]/;function xx(i){return XC.test(i)}const YC=String.fromCharCode(P.UTF8_BOM);function KC(i){return!!(i&&i.length>0&&i.charCodeAt(0)===P.UTF8_BOM)}function Ex(i,e=!1){return i?(e&&(i=i.replace(/\\./g,"")),i.toLowerCase()!==i):!1}function ZC(i,e=1){if(e===0)return"";let t=-1;do t=i.indexOf(`
`,t+1),e--;while(e>0&&t>=0);return t===-1?i:(i[t-1]==="\r"&&t--,i.substr(0,t))}function Sx(i,e){return i===Je.Other?e!==Je.Extend&&e!==Je.SpacingMark:i===Je.CR&&e===Je.LF?!1:i===Je.Control||i===Je.CR||i===Je.LF||e===Je.Control||e===Je.CR||e===Je.LF?!0:!(i===Je.L&&(e===Je.L||e===Je.V||e===Je.LV||e===Je.LVT)||(i===Je.LV||i===Je.V)&&(e===Je.V||e===Je.T)||(i===Je.LVT||i===Je.T)&&e===Je.T||e===Je.Extend||e===Je.ZWJ||e===Je.SpacingMark||i===Je.Prepend||i===Je.ZWJ&&e===Je.Extended_Pictographic||i===Je.Regional_Indicator&&e===Je.Regional_Indicator)}var Je;(function(i){i[i.Other=0]="Other",i[i.Prepend=1]="Prepend",i[i.CR=2]="CR",i[i.LF=3]="LF",i[i.Control=4]="Control",i[i.Extend=5]="Extend",i[i.Regional_Indicator=6]="Regional_Indicator",i[i.SpacingMark=7]="SpacingMark",i[i.L=8]="L",i[i.V=9]="V",i[i.T=10]="T",i[i.LV=11]="LV",i[i.LVT=12]="LVT",i[i.ZWJ=13]="ZWJ",i[i.Extended_Pictographic=14]="Extended_Pictographic"})(Je||(Je={}));const ya=class ya{static getInstance(){return ya._INSTANCE||(ya._INSTANCE=new ya),ya._INSTANCE}constructor(){this._data=eI()}getGraphemeBreakType(e){if(e<32)return e===P.LineFeed?Je.LF:e===P.CarriageReturn?Je.CR:Je.Control;if(e<127)return Je.Other;const t=this._data,n=t.length/3;let r=1;for(;r<=n;)if(e<t[3*r])r=2*r;else if(e>t[3*r+1])r=2*r+1;else return t[3*r+2];return Je.Other}};ya._INSTANCE=null;let Ef=ya;function eI(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var Dx;(function(i){i[i.zwj=8205]="zwj",i[i.emojiVariantSelector=65039]="emojiVariantSelector",i[i.enclosingKeyCap=8419]="enclosingKeyCap"})(Dx||(Dx={}));const wr=class wr{static getInstance(e){return wr.cache.get(Array.from(e))}static getLocales(){return wr._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){const n=e.codePointAt(t);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};wr.ambiguousCharacterData=new yt(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),wr.cache=new FC({getCacheKey:JSON.stringify},e=>{function t(u){const d=new Map;for(let f=0;f<u.length;f+=2)d.set(u[f],u[f+1]);return d}function n(u,d){const f=new Map(u);for(const[p,b]of d)f.set(p,b);return f}function r(u,d){if(!u)return d;const f=new Map;for(const[p,b]of u)d.has(p)&&f.set(p,b);return f}const s=wr.ambiguousCharacterData.value;let o=e.filter(u=>!u.startsWith("_")&&u in s);o.length===0&&(o=["_default"]);let a;for(const u of o){const d=t(s[u]);a=r(a,d)}const l=t(s._common),c=n(l,a);return new wr(c)}),wr._locales=new yt(()=>Object.keys(wr.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let kx=wr;const xa=class xa{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(xa.getRawData())),this._data}static isInvisibleCharacter(e){return xa.getData().has(e)}static containsInvisibleCharacter(e){for(let t=0;t<e.length;t++){const n=e.codePointAt(t);if(typeof n=="number"&&xa.isInvisibleCharacter(n))return!0}return!1}static get codePoints(){return xa.getData()}};xa._data=void 0;let Cx=xa;function Ge(i){return typeof i=="string"}function tI(i){return Array.isArray(i)&&i.every(e=>Ge(e))}function Bt(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)&&!(i instanceof RegExp)&&!(i instanceof Date)}function iI(i){const e=Object.getPrototypeOf(Uint8Array);return typeof i=="object"&&i instanceof e}function Ds(i){return typeof i=="number"&&!isNaN(i)}function Eu(i){return typeof i>"u"}function yo(i){return!Wt(i)}function Wt(i){return Eu(i)||i===null}function Ix(i,e){if(!i)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function al(i){if(Wt(i))throw new Error("Assertion Failed: argument is undefined or null");return i}const nI=Object.prototype.hasOwnProperty;function Px(i){if(!Bt(i))return!1;for(const e in i)if(nI.call(i,e))return!1;return!0}function rI(i){return typeof i=="function"}function sI(i,e){if(Ge(e)){if(typeof i!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(rI(e)){try{if(i instanceof e)return}catch{}if(!Wt(i)&&i.constructor===e||e.length===1&&e.call(void 0,i)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function ks(i){return i===P.Slash||i===P.Backslash}function Tx(i){return i.replace(/[\\/]/g,tt.sep)}function oI(i){return i.indexOf("/")===-1&&(i=Tx(i)),/^[a-zA-Z]:(\/|$)/.test(i)&&(i="/"+i),i}function Ax(i,e=tt.sep){if(!i)return"";const t=i.length,n=i.charCodeAt(0);if(ks(n)){if(ks(i.charCodeAt(1))&&!ks(i.charCodeAt(2))){let s=3;const o=s;for(;s<t&&!ks(i.charCodeAt(s));s++);if(o!==s&&!ks(i.charCodeAt(s+1))){for(s+=1;s<t;s++)if(ks(i.charCodeAt(s)))return i.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(Rx(n)&&i.charCodeAt(1)===P.Colon)return ks(i.charCodeAt(2))?i.slice(0,2)+e:i.slice(0,2);let r=i.indexOf("://");if(r!==-1){for(r+=3;r<t;r++)if(ks(i.charCodeAt(r)))return i.slice(0,r+1)}return""}function Sf(i,e,t,n=Ln){if(i===e)return!0;if(!i||!e||e.length>i.length)return!1;if(t){if(!X1(i,e))return!1;if(e.length===i.length)return!0;let s=e.length;return e.charAt(e.length-1)===n&&s--,i.charAt(s)===n}return e.charAt(e.length-1)!==n&&(e+=n),i.indexOf(e)===0}function Rx(i){return i>=P.A&&i<=P.Z||i>=P.a&&i<=P.z}function aI(i,e=cn){return e?Rx(i.charCodeAt(0))&&i.charCodeAt(1)===P.Colon:!1}var le;(function(i){i.inMemory="inmemory",i.vscode="vscode",i.internal="private",i.walkThrough="walkThrough",i.walkThroughSnippet="walkThroughSnippet",i.http="http",i.https="https",i.file="file",i.mailto="mailto",i.untitled="untitled",i.data="data",i.command="command",i.vscodeRemote="vscode-remote",i.vscodeRemoteResource="vscode-remote-resource",i.vscodeManagedRemoteResource="vscode-managed-remote-resource",i.vscodeUserData="vscode-userdata",i.vscodeCustomEditor="vscode-custom-editor",i.vscodeNotebookCell="vscode-notebook-cell",i.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",i.vscodeNotebookCellOutput="vscode-notebook-cell-output",i.vscodeInteractiveInput="vscode-interactive-input",i.vscodeSettings="vscode-settings",i.vscodeWorkspaceTrust="vscode-workspace-trust",i.vscodeTerminal="vscode-terminal",i.vscodeChatCodeBlock="vscode-chat-code-block",i.vscodeCopilotBackingChatCodeBlock="vscode-copilot-chat-code-block",i.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",i.vscodeChatSesssion="vscode-chat-editor",i.webviewPanel="webview-panel",i.vscodeWebview="vscode-webview",i.extension="extension",i.vscodeFileResource="vscode-file",i.tmp="tmp",i.vsls="vsls",i.vscodeSourceControl="vscode-scm",i.commentsInput="comment",i.codeSetting="code-setting"})(le||(le={}));function Z1(i,e){return y.isUri(i)?Ss(i.scheme,e):X1(i,e+":")}function lI(i,...e){return e.some(t=>Z1(i,t))}const cI="tkn";class uI{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=hI(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return tt.join(this._serverRootPath,le.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return ln(a),e}const t=e.authority;let n=this._hosts[t];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);const r=this._ports[t],s=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(o+=`&${cI}=${encodeURIComponent(s)}`),y.from({scheme:H1?this._preferredWebSchema:le.vscodeRemoteResource,authority:`${n}:${r}`,path:this._remoteResourcesPath,query:o})}}const dI=new uI;function hI(i,e){return tt.join(e??"/",`${i.quality??"oss"}-${i.commit??"dev"}`)}const fI="vscode-app",Ac=class Ac{constructor(){this.staticBrowserUris=new $t,this.appResourcePathUrls=new Map,this.moduleContentProvider=new Map}registerModuleContentProvider(e,t){this.moduleContentProvider.set(e,t)}toModuleContent(e){return this.moduleContentProvider.get(e)()}registerAppResourcePathUrl(e,t){this.appResourcePathUrls.set(e,t)}toUrl(e){var n;let t=this.appResourcePathUrls.get(e);return typeof t=="function"&&(t=t()),new URL(t??e,((n=globalThis.location)==null?void 0:n.href)??self.location.href).toString()}asBrowserUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===le.vscodeRemote?dI.rewrite(e):e.scheme===le.file&&(dC||hC===`${le.vscodeFileResource}://${Ac.FALLBACK_AUTHORITY}`)?e.with({scheme:le.vscodeFileResource,authority:e.authority||Ac.FALLBACK_AUTHORITY,query:null,fragment:null}):this.staticBrowserUris.get(e)??e}asFileUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===le.vscodeFileResource?e.with({scheme:le.file,authority:e.authority!==Ac.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){return y.isUri(e)?e:y.parse(t.toUrl(e))}registerStaticBrowserUri(e,t){return this.staticBrowserUris.set(e,t),Me(()=>{this.staticBrowserUris.get(e)===t&&this.staticBrowserUris.delete(e)})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}};Ac.FALLBACK_AUTHORITY=fI;let e_=Ac;new e_;var Lx;(function(i){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);i.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function n(s){let o;typeof s=="string"?o=new URL(s).searchParams:s instanceof URL?o=s.searchParams:y.isUri(s)&&(o=new URL(s.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}i.getHeadersFromQuery=n;function r(s,o,a){if(!globalThis.crossOriginIsolated)return;const l=o&&a?"3":a?"2":"1";s instanceof URLSearchParams?s.set(t,l):s[t]=l}i.addSearchParam=r})(Lx||(Lx={}));function On(i){return vf(i,!0)}class Su{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:bo(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===le.file)return Sf(On(e),On(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(Fx(e.authority,t.authority))return Sf(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return y.joinPath(e,...t)}basenameOrAuthority(e){return xo(e)||e.authority}basename(e){return tt.basename(e.path)}extname(e){return tt.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===le.file?t=y.file(vo(On(e))).path:(t=tt.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==P.Slash&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===le.file?t=y.file(nl(On(e))).path:t=tt.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Fx(e.authority,t.authority))return;if(e.scheme===le.file){const s=bu(On(e),On(t));return cn?Tx(s):s}let n=e.path||"/";const r=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(const o=Math.min(n.length,r.length);s<o&&!(n.charCodeAt(s)!==r.charCodeAt(s)&&n.charAt(s).toLowerCase()!==r.charAt(s).toLowerCase());s++);n=r.substr(0,s)+n.substr(s)}return tt.relative(n,r)}resolvePath(e,t){if(e.scheme===le.file){const n=y.file(kC(On(e),t));return e.with({authority:n.authority,path:n.path})}return t=oI(t),e.with({path:tt.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Ss(e,t)}hasTrailingPathSeparator(e,t=Ln){if(e.scheme===le.file){const n=On(e);return n.length>Ax(n).length&&n[n.length-1]===t}else{const n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===P.Slash&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Ln){return Mx(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Ln){let n=!1;if(e.scheme===le.file){const r=On(e);n=r!==void 0&&r.length===Ax(r).length&&r[r.length-1]===t}else{t="/";const r=e.path;n=r.length===1&&r.charCodeAt(r.length-1)===P.Slash}return!n&&!Mx(e,t)?e.with({path:e.path+"/"}):e}}const Ze=new Su(()=>!1),pI=new Su(i=>i.scheme===le.file?!ws:!0),gI=new Su(i=>!0),Nx=Ze.isEqual.bind(Ze);Ze.isEqualOrParent.bind(Ze),Ze.getComparisonKey.bind(Ze);const t_=Ze.basenameOrAuthority.bind(Ze),xo=Ze.basename.bind(Ze);Ze.extname.bind(Ze);const i_=Ze.dirname.bind(Ze),Li=Ze.joinPath.bind(Ze);Ze.normalizePath.bind(Ze);const Ox=Ze.relativePath.bind(Ze);Ze.resolvePath.bind(Ze);const mI=Ze.isAbsolutePath.bind(Ze),Fx=Ze.isEqualAuthority.bind(Ze),Mx=Ze.hasTrailingPathSeparator.bind(Ze);Ze.removeTrailingPathSeparator.bind(Ze),Ze.addTrailingPathSeparator.bind(Ze);var $x;(function(i){i.META_DATA_LABEL="label",i.META_DATA_DESCRIPTION="description",i.META_DATA_SIZE="size",i.META_DATA_MIME="mime";function e(t){const n=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&n.set(a,l)});const s=t.path.substring(0,t.path.indexOf(";"));return s&&n.set(i.META_DATA_MIME,s),n}i.parseMetaData=e})($x||($x={}));const _I=Symbol("MicrotaskDelay");function Cs(i){return!!i&&typeof i.then=="function"}function vI(i){const e=new Qt,t=i(e.token),n=new Promise((r,s)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),s(new Ir)});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),r(a)},a=>{o.dispose(),e.dispose(),s(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(r,s){return n.then(r,s)}catch(r){return this.then(void 0,r)}finally(r){return n.finally(r)}}}function wI(i,e,t){return new Promise((n,r)=>{const s=e.onCancellationRequested(()=>{s.dispose(),n(t)});i.then(n,r).finally(()=>s.dispose())})}function bI(i,e){return new Promise((t,n)=>{const r=e.onCancellationRequested(()=>{r.dispose(),n(new Ir)});i.then(t,n).finally(()=>r.dispose())})}function xi(i){return new Promise((e,t)=>{const n=i();Cs(n)?n.then(e,t):e(n)})}function yI(){let i,e;return{promise:new Promise((n,r)=>{i=n,e=r}),resolve:i,reject:e}}class xI{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(t,t).then(n)})}return new Promise((t,n)=>{this.queuedPromise.then(t,n)})}return this.activePromise=e(),new Promise((t,n)=>{this.activePromise.then(r=>{this.activePromise=null,t(r)},r=>{this.activePromise=null,n(r)})})}dispose(){this.isDisposed=!0}}const EI=(i,e)=>{let t=!0;const n=setTimeout(()=>{t=!1,e()},i);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},SI=i=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,i())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class DI{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((r,s)=>{this.doResolve=r,this.doReject=s}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const r=this.task;return this.task=null,r()}}));const n=()=>{var r;this.deferred=null,(r=this.doResolve)==null||r.call(this,null)};return this.deferred=t===_I?SI(n):EI(t,n),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Ir),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class kI{constructor(e){this.delayer=new DI(e),this.throttler=new xI}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}class rr{constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}function Or(i,e){return e?new Promise((t,n)=>{const r=setTimeout(()=>{s.dispose(),t()},i),s=e.onCancellationRequested(()=>{clearTimeout(r),s.dispose(),n(new Ir)})}):vI(t=>Or(i,t))}function CI(i,e=0,t){const n=setTimeout(()=>{i(),t&&r.dispose()},e),r=Me(()=>{clearTimeout(n),t==null||t.deleteAndLeak(r)});return t==null||t.add(r),r}class II{constructor(e){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new L}whenIdle(){return this.size>0?Ht.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,n)=>{this.outstandingPromises.push({factory:e,c:t,e:n}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const e=this.outstandingPromises.shift();this.runningPromises++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}}class PI extends II{constructor(){super(1)}}class TI{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const e=new cl;return this.drainers.add(e),e.p}isDrained(){for(const[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=Ze){var r;const n=t.getComparisonKey(e);return((r=this.queues.get(n))==null?void 0:r.size)??0}queueFor(e,t,n=Ze){const r=n.getComparisonKey(e);let s=this.queues.get(r);if(!s){s=new PI;const o=this.drainListenerCount++,a=Ht.once(s.onDrained)(()=>{var l,c;s==null||s.dispose(),this.queues.delete(r),this.onDidQueueDrain(),(l=this.drainListeners)==null||l.deleteAndDispose(o),((c=this.drainListeners)==null?void 0:c.size)===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new L1),this.drainListeners.set(o,a),this.queues.set(r,s)}return s.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers)e.complete();this.drainers.clear()}dispose(){var e;for(const[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers(),(e=this.drainListeners)==null||e.dispose()}}class AI{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new I1("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const r=n.setInterval(()=>{e()},t);this.disposable=Me(()=>{n.clearInterval(r),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class ll{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let Ux,Df;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Df=(i,e)=>{jy(()=>{if(t)return;const n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Df=(i,e,t)=>{const n=i.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let r=!1;return{dispose(){r||(r=!0,i.cancelIdleCallback(n))}}},Ux=i=>Df(globalThis,i)})();class RI{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=Df(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class LI extends RI{constructor(e){super(globalThis,e)}}var Eo;(function(i){i[i.Resolved=0]="Resolved",i[i.Rejected=1]="Rejected"})(Eo||(Eo={}));class cl{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===Eo.Rejected}get isResolved(){var e;return((e=this.outcome)==null?void 0:e.outcome)===Eo.Resolved}get isSettled(){return!!this.outcome}get value(){var e,t;return((e=this.outcome)==null?void 0:e.outcome)===Eo.Resolved?(t=this.outcome)==null?void 0:t.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:Eo.Resolved,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:Eo.Rejected,value:e},t()})}cancel(){return this.error(new Ir)}}var ul;(function(i){async function e(n){let r;const s=await Promise.all(n.map(o=>o.then(a=>a,a=>{r||(r=a)})));if(typeof r<"u")throw r;return s}i.settled=e;function t(n){return new Promise(async(r,s)=>{try{await n(r,s)}catch(o){s(o)}})}i.withAsyncBody=t})(ul||(ul={}));var Fn;(function(i){i[i.Initial=0]="Initial",i[i.DoneOK=1]="DoneOK",i[i.DoneError=2]="DoneError"})(Fn||(Fn={}));const Gi=class Gi{static fromArray(e){return new Gi(t=>{t.emitMany(e)})}static fromPromise(e){return new Gi(async t=>{t.emitMany(await e)})}static fromPromises(e){return new Gi(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new Gi(async t=>{await Promise.all(e.map(async n=>{for await(const r of n)t.emitOne(r)}))})}constructor(e,t){this._state=Fn.Initial,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new L,queueMicrotask(async()=>{const n={emitOne:r=>this.emitOne(r),emitMany:r=>this.emitMany(r),reject:r=>this.reject(r)};try{await Promise.resolve(e(n)),this.resolve()}catch(r){this.reject(r)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===Fn.DoneError)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===Fn.DoneOK)return{done:!0,value:void 0};await Ht.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>{var t;return(t=this._onReturn)==null||t.call(this),{done:!0,value:void 0}}}}static map(e,t){return new Gi(async n=>{for await(const r of e)n.emitOne(t(r))})}map(e){return Gi.map(this,e)}static filter(e,t){return new Gi(async n=>{for await(const r of e)t(r)&&n.emitOne(r)})}filter(e){return Gi.filter(this,e)}static coalesce(e){return Gi.filter(e,t=>!!t)}coalesce(){return Gi.coalesce(this)}static async toPromise(e){const t=[];for await(const n of e)t.push(n);return t}toPromise(){return Gi.toPromise(this)}emitOne(e){this._state===Fn.Initial&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===Fn.Initial&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===Fn.Initial&&(this._state=Fn.DoneOK,this._onStateChanged.fire())}reject(e){this._state===Fn.Initial&&(this._state=Fn.DoneError,this._error=e,this._onStateChanged.fire())}};Gi.EMPTY=Gi.fromArray([]);let So=Gi;class n_{constructor(e){this._deferred=new cl,this._asyncIterable=new So(r=>{if(t){r.reject(t);return}return n&&r.emitMany(n),this._errorFn=s=>r.reject(s),this._emitFn=s=>r.emitOne(s),this._deferred.p},e);let t,n;this._emitFn=r=>{n||(n=[]),n.push(r)},this._errorFn=r=>{t||(t=r)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}}function Hx(i,e,t,n){if(!i||n>200)return null;if(typeof i=="object"){if(i.$mid===mt.Uri)return t?y.revive(e.transformIncoming(i)):e.transformIncoming(i);if(i instanceof De)return null;for(const r in i)if(Object.hasOwnProperty.call(i,r)){const s=Hx(i[r],e,t,n+1);s!==null&&(i[r]=s)}}return null}function Du(i,e){const t=Hx(i,e,!1,0);return t===null?i:t}class Bx{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||(this._actual=new Promise((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)})),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):ln(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class NI extends Bx{constructor(){super(),this._hasErr=!0,this._err=new Ir}}var Wx;function r_(i,e){try{return JSON.stringify(i,e)}catch{return"null"}}const s_="$$ref$$",OI={[s_]:-1};function Vx(i,e=null,t=!1){const n=[];return{jsonString:(t?r_:JSON.stringify)(i,(s,o)=>{if(typeof o>"u")return OI;if(typeof o=="object"){if(o instanceof De){const a=n.push(o)-1;return{[s_]:a}}if(e)return e(s,o)}return o}),referencedBuffers:n}}function zx(i,e,t){return JSON.parse(i,(n,r)=>{if(r){const s=r[s_];if(typeof s=="number")return e[s];if(t&&r.$mid===mt.Uri)return t.transformIncoming(r)}return r})}function qx(i,e){return JSON.stringify(i,e)}function FI(i){return i?(e,t)=>t&&t.$mid===mt.Uri?i.transformOutgoing(t):t:null}var En;(function(i){i[i.LocalSide=0]="LocalSide",i[i.OtherSide=1]="OtherSide"})(En||(En={}));var ku;(function(i){i[i.Responsive=0]="Responsive",i[i.Unresponsive=1]="Unresponsive"})(ku||(ku={}));const MI=()=>{},$I=Symbol.for("rpcProtocol"),UI=Symbol.for("rpcProxy"),Oh=class Oh extends Re{constructor(e,t=null,n=null){super(),this[Wx]=!0,this._onDidChangeResponsiveState=this._register(new L),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=e,this._logger=t,this._uriTransformer=n,this._uriReplacer=FI(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let r=0,s=bf.count;r<s;r++)this._locals[r]=null,this._proxies[r]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=ku.Responsive,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new ll(()=>this._checkUnresponsive(),1e3)),this._register(this._protocol.onMessage(r=>this._receiveOneMessage(r)))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach(e=>{const t=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e],t.resolveErr(ky())}),super.dispose()}drain(){return typeof this._protocol.drain=="function"?this._protocol.drain():Promise.resolve()}_onWillSendRequest(e){this._unacknowledgedCount===0&&(this._unresponsiveTime=Date.now()+Oh.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+Oh.UNRESPONSIVE_TIME,this._unacknowledgedCount--,this._unacknowledgedCount===0&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(ku.Responsive)}_checkUnresponsive(){this._unacknowledgedCount!==0&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(ku.Unresponsive):this._asyncCheckUresponsive.schedule())}_setResponsiveState(e){this._responsiveState!==e&&(this._responsiveState=e,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){return this._uriTransformer?Du(e,this._uriTransformer):e}getProxy(e){const{nid:t,sid:n}=e;return this._proxies[t]||(this._proxies[t]=this._createProxy(t,n)),this._proxies[t]}_createProxy(e,t){const n={get:(r,s)=>(typeof s=="string"&&!r[s]&&s.charCodeAt(0)===P.DollarSign&&(r[s]=(...o)=>this._remoteCall(e,s,o)),s===UI?t:r[s])};return new Proxy(Object.create(null),n)}set(e,t){return this._locals[e.nid]=t,t}assertRegistered(e){for(let t=0,n=e.length;t<n;t++){const r=e[t];if(!this._locals[r.nid])throw new Error(`Missing proxy instance ${r.sid}`)}}_receiveOneMessage(e){var o;if(this._isDisposed)return;const t=e.byteLength,n=Tt.read(e,0),r=n.readUInt8(),s=n.readUInt32();switch(r){case _t.RequestJSONArgs:case _t.RequestJSONArgsWithCancellation:{let{rpcId:a,method:l,args:c}=hn.deserializeRequestJSONArgs(n);this._uriTransformer&&(c=Du(c,this._uriTransformer)),this._receiveRequest(t,s,a,l,c,r===_t.RequestJSONArgsWithCancellation);break}case _t.RequestMixedArgs:case _t.RequestMixedArgsWithCancellation:{let{rpcId:a,method:l,args:c}=hn.deserializeRequestMixedArgs(n);this._uriTransformer&&(c=Du(c,this._uriTransformer)),this._receiveRequest(t,s,a,l,c,r===_t.RequestMixedArgsWithCancellation);break}case _t.Acknowledged:{(o=this._logger)==null||o.logIncoming(t,s,En.LocalSide,"ack"),this._onDidReceiveAcknowledge(s);break}case _t.Cancel:{this._receiveCancel(t,s);break}case _t.ReplyOKEmpty:{this._receiveReply(t,s,void 0);break}case _t.ReplyOKJSON:{let a=hn.deserializeReplyOKJSON(n);this._uriTransformer&&(a=Du(a,this._uriTransformer)),this._receiveReply(t,s,a);break}case _t.ReplyOKJSONWithBuffers:{const a=hn.deserializeReplyOKJSONWithBuffers(n,this._uriTransformer);this._receiveReply(t,s,a);break}case _t.ReplyOKVSBuffer:{const a=hn.deserializeReplyOKVSBuffer(n);this._receiveReply(t,s,a);break}case _t.ReplyErrError:{let a=hn.deserializeReplyErrError(n);this._uriTransformer&&(a=Du(a,this._uriTransformer)),this._receiveReplyErr(t,s,a);break}case _t.ReplyErrEmpty:{this._receiveReplyErr(t,s,void 0);break}default:console.error("received unexpected message"),console.error(e)}}_receiveRequest(e,t,n,r,s,o){var d,f;(d=this._logger)==null||d.logIncoming(e,t,En.OtherSide,`receiveRequest ${yf(n)}.${r}(`,s);const a=String(t);let l,c;if(o){const p=new Qt;s.push(p.token),l=this._invokeHandler(n,r,s),c=()=>p.cancel()}else l=this._invokeHandler(n,r,s),c=MI;this._cancelInvokedHandlers[a]=c;const u=hn.serializeAcknowledged(t);(f=this._logger)==null||f.logOutgoing(u.byteLength,t,En.OtherSide,"ack"),this._protocol.send(u),l.then(p=>{var w;delete this._cancelInvokedHandlers[a];const b=hn.serializeReplyOK(t,p,this._uriReplacer);(w=this._logger)==null||w.logOutgoing(b.byteLength,t,En.OtherSide,"reply:",p),this._protocol.send(b)},p=>{var w;delete this._cancelInvokedHandlers[a];const b=hn.serializeReplyErr(t,p);(w=this._logger)==null||w.logOutgoing(b.byteLength,t,En.OtherSide,"replyErr:",p),this._protocol.send(b)})}_receiveCancel(e,t){var r,s,o;(r=this._logger)==null||r.logIncoming(e,t,En.OtherSide,"receiveCancel");const n=String(t);(o=(s=this._cancelInvokedHandlers)[n])==null||o.call(s)}_receiveReply(e,t,n){var o;(o=this._logger)==null||o.logIncoming(e,t,En.LocalSide,"receiveReply:",n);const r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;const s=this._pendingRPCReplies[r];delete this._pendingRPCReplies[r],s.resolveOk(n)}_receiveReplyErr(e,t,n){var a;(a=this._logger)==null||a.logIncoming(e,t,En.LocalSide,"receiveReplyErr:",n);const r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;const s=this._pendingRPCReplies[r];delete this._pendingRPCReplies[r];let o;n&&(n.$isError?(o=new Error,o.name=n.name,o.message=n.message,o.stack=n.stack):o=n),s.resolveErr(o)}_invokeHandler(e,t,n){try{return Promise.resolve(this._doInvokeHandler(e,t,n))}catch(r){return Promise.reject(r)}}_doInvokeHandler(e,t,n){const r=this._locals[e];if(!r)throw new Error("Unknown actor "+yf(e));const s=r[t];if(typeof s!="function")throw new Error("Unknown method "+t+" on actor "+yf(e));return s.apply(r,n)}_remoteCall(e,t,n){var d;if(this._isDisposed)return new NI;let r=null;if(n.length>0&&Nt.isCancellationToken(n[n.length-1])&&(r=n.pop()),r&&r.isCancellationRequested)return Promise.reject(ky());const s=hn.serializeRequestArguments(n,this._uriReplacer),o=++this._lastMessageId,a=String(o),l=new Bx,c=new Le;r&&c.add(r.onCancellationRequested(()=>{var p;const f=hn.serializeCancel(o);(p=this._logger)==null||p.logOutgoing(f.byteLength,o,En.LocalSide,"cancel"),this._protocol.send(hn.serializeCancel(o))})),this._pendingRPCReplies[a]=new HI(l,c),this._onWillSendRequest(o);const u=hn.serializeRequest(o,e,t,s,!!r);return(d=this._logger)==null||d.logOutgoing(u.byteLength,o,En.LocalSide,`request: ${yf(e)}.${t}(`,n),this._protocol.send(u),l}};Wx=$I,Oh.UNRESPONSIVE_TIME=3*1e3;let o_=Oh;class HI{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}}const Fh=class Fh{static alloc(e,t,n){const r=new Fh(De.alloc(n+1+4),0);return r.writeUInt8(e),r.writeUInt32(t),r}static read(e,t){return new Fh(e,t)}get buffer(){return this._buff}constructor(e,t){this._buff=e,this._offset=t}static sizeUInt8(){return 1}writeUInt8(e){this._buff.writeUInt8(e,this._offset),this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);return this._offset+=1,e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset),this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);return this._offset+=4,e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset),this._offset+=1,this._buff.set(e,this._offset),this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const n=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,n}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const n=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,n}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const t=this._buff.slice(this._offset,this._offset+e);return this._offset+=e,t}static sizeMixedArray(e){let t=0;t+=1;for(let n=0,r=e.length;n<r;n++){const s=e[n];switch(t+=1,s.type){case Jt.String:t+=this.sizeLongString(s.value);break;case Jt.VSBuffer:t+=this.sizeVSBuffer(s.value);break;case Jt.SerializedObjectWithBuffers:t+=this.sizeUInt32,t+=this.sizeLongString(s.value);for(let o=0;o<s.buffers.length;++o)t+=this.sizeVSBuffer(s.buffers[o]);break}}return t}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset),this._offset+=1;for(let t=0,n=e.length;t<n;t++){const r=e[t];switch(r.type){case Jt.String:this.writeUInt8(Jt.String),this.writeLongString(r.value);break;case Jt.VSBuffer:this.writeUInt8(Jt.VSBuffer),this.writeVSBuffer(r.value);break;case Jt.SerializedObjectWithBuffers:this.writeUInt8(Jt.SerializedObjectWithBuffers),this.writeUInt32(r.buffers.length),this.writeLongString(r.value);for(let s=0;s<r.buffers.length;++s)this.writeBuffer(r.buffers[s]);break;case Jt.Undefined:this.writeUInt8(Jt.Undefined);break}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const t=new Array(e);for(let n=0;n<e;n++)switch(this.readUInt8()){case Jt.String:t[n]=this.readLongString();break;case Jt.VSBuffer:t[n]=this.readVSBuffer();break;case Jt.SerializedObjectWithBuffers:{const s=this.readUInt32(),o=this.readLongString(),a=[];for(let l=0;l<s;++l)a.push(this.readVSBuffer());t[n]=new un(zx(o,a,null));break}case Jt.Undefined:t[n]=void 0;break}return t}};Fh.sizeUInt32=4;let Tt=Fh;var dl;(function(i){i[i.Simple=0]="Simple",i[i.Mixed=1]="Mixed"})(dl||(dl={}));class hn{static _useMixedArgSerialization(e){for(let t=0,n=e.length;t<n;t++)if(e[t]instanceof De||e[t]instanceof un||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){const n=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];if(o instanceof De)n[r]={type:Jt.VSBuffer,value:o};else if(typeof o>"u")n[r]={type:Jt.Undefined};else if(o instanceof un){const{jsonString:a,referencedBuffers:l}=Vx(o.value,t);n[r]={type:Jt.SerializedObjectWithBuffers,value:De.fromString(a),buffers:l}}else n[r]={type:Jt.String,value:De.fromString(qx(o,t))}}return{type:dl.Mixed,args:n}}return{type:dl.Simple,args:qx(e,t)}}static serializeRequest(e,t,n,r,s){switch(r.type){case dl.Simple:return this._requestJSONArgs(e,t,n,r.args,s);case dl.Mixed:return this._requestMixedArgs(e,t,n,r.args,s)}}static _requestJSONArgs(e,t,n,r,s){const o=De.fromString(n),a=De.fromString(r);let l=0;l+=Tt.sizeUInt8(),l+=Tt.sizeShortString(o),l+=Tt.sizeLongString(a);const c=Tt.alloc(s?_t.RequestJSONArgsWithCancellation:_t.RequestJSONArgs,e,l);return c.writeUInt8(t),c.writeShortString(o),c.writeLongString(a),c.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),n=e.readShortString(),r=e.readLongString();return{rpcId:t,method:n,args:JSON.parse(r)}}static _requestMixedArgs(e,t,n,r,s){const o=De.fromString(n);let a=0;a+=Tt.sizeUInt8(),a+=Tt.sizeShortString(o),a+=Tt.sizeMixedArray(r);const l=Tt.alloc(s?_t.RequestMixedArgsWithCancellation:_t.RequestMixedArgs,e,a);return l.writeUInt8(t),l.writeShortString(o),l.writeMixedArray(r),l.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),n=e.readShortString(),r=e.readMixedArray(),s=new Array(r.length);for(let o=0,a=r.length;o<a;o++){const l=r[o];typeof l=="string"?s[o]=JSON.parse(l):s[o]=l}return{rpcId:t,method:n,args:s}}static serializeAcknowledged(e){return Tt.alloc(_t.Acknowledged,e,0).buffer}static serializeCancel(e){return Tt.alloc(_t.Cancel,e,0).buffer}static serializeReplyOK(e,t,n){if(typeof t>"u")return this._serializeReplyOKEmpty(e);if(t instanceof De)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof un){const{jsonString:r,referencedBuffers:s}=Vx(t.value,n,!0);return this._serializeReplyOKJSONWithBuffers(e,r,s)}else return this._serializeReplyOKJSON(e,r_(t,n))}static _serializeReplyOKEmpty(e){return Tt.alloc(_t.ReplyOKEmpty,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let n=0;n+=Tt.sizeVSBuffer(t);const r=Tt.alloc(_t.ReplyOKVSBuffer,e,n);return r.writeVSBuffer(t),r.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){const n=De.fromString(t);let r=0;r+=Tt.sizeLongString(n);const s=Tt.alloc(_t.ReplyOKJSON,e,r);return s.writeLongString(n),s.buffer}static _serializeReplyOKJSONWithBuffers(e,t,n){const r=De.fromString(t);let s=0;s+=Tt.sizeUInt32,s+=Tt.sizeLongString(r);for(const a of n)s+=Tt.sizeVSBuffer(a);const o=Tt.alloc(_t.ReplyOKJSONWithBuffers,e,s);o.writeUInt32(n.length),o.writeLongString(r);for(const a of n)o.writeBuffer(a);return o.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const n=e.readUInt32(),r=e.readLongString(),s=[];for(let o=0;o<n;++o)s.push(e.readVSBuffer());return new un(zx(r,s,t))}static serializeReplyErr(e,t){const n=t?r_(cu(t),null):void 0;if(typeof n!="string")return this._serializeReplyErrEmpty(e);const r=De.fromString(n);let s=0;s+=Tt.sizeLongString(r);const o=Tt.alloc(_t.ReplyErrError,e,s);return o.writeLongString(r),o.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return Tt.alloc(_t.ReplyErrEmpty,e,0).buffer}}var _t;(function(i){i[i.RequestJSONArgs=1]="RequestJSONArgs",i[i.RequestJSONArgsWithCancellation=2]="RequestJSONArgsWithCancellation",i[i.RequestMixedArgs=3]="RequestMixedArgs",i[i.RequestMixedArgsWithCancellation=4]="RequestMixedArgsWithCancellation",i[i.Acknowledged=5]="Acknowledged",i[i.Cancel=6]="Cancel",i[i.ReplyOKEmpty=7]="ReplyOKEmpty",i[i.ReplyOKVSBuffer=8]="ReplyOKVSBuffer",i[i.ReplyOKJSON=9]="ReplyOKJSON",i[i.ReplyOKJSONWithBuffers=10]="ReplyOKJSONWithBuffers",i[i.ReplyErrError=11]="ReplyErrError",i[i.ReplyErrEmpty=12]="ReplyErrEmpty"})(_t||(_t={}));var Jt;(function(i){i[i.String=1]="String",i[i.VSBuffer=2]="VSBuffer",i[i.SerializedObjectWithBuffers=3]="SerializedObjectWithBuffers",i[i.Undefined=4]="Undefined"})(Jt||(Jt={}));var Mn;(function(i){i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=e})(Mn||(Mn={}));const kf=ke("instantiationService");function BI(i,e,t){e[Mn.DI_TARGET]===e?e[Mn.DI_DEPENDENCIES].push({id:i,index:t}):(e[Mn.DI_DEPENDENCIES]=[{id:i,index:t}],e[Mn.DI_TARGET]=e)}function ke(i){if(Mn.serviceIds.has(i))return Mn.serviceIds.get(i);const e=function(t,n,r){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");BI(e,t,r)};return e.toString=()=>i,Mn.serviceIds.set(i,e),e}const rt=ke("logService"),hl=ke("loggerService");class sr{constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}}const jx=[];var ut;(function(i){i[i.Eager=0]="Eager",i[i.Delayed=1]="Delayed"})(ut||(ut={}));function pt(i,e,t){e instanceof sr||(e=new sr(e,[],!!t)),jx.push([i,e])}function WI(){return jx}class a_{constructor(...e){this._entries=new Map;for(const[t,n]of e)this.set(t,n)}set(e,t){const n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const Ei=ke("IExtHostInitDataService");let VI=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class Gx{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const n=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);n.outgoing.set(r.key,r),r.incoming.set(n.key,n)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const n of this._nodes.values())n.outgoing.delete(t),n.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let n=this._nodes.get(t);return n||(n=new VI(t,e),this._nodes.set(t,n)),n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,n]of this._nodes)e.push(`${t}
	(-> incoming)[${[...n.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...n.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const n=new Set([e]),r=this._findCycle(t,n);if(r)return r}}_findCycle(e,t){for(const[n,r]of e.outgoing){if(t.has(n))return[...t,n].join(" -> ");t.add(n);const s=this._findCycle(r,t);if(s)return s;t.delete(n)}}}const zI=!1;class Qx extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class Cf{constructor(e=new a_,t=!1,n,r=zI){this._services=e,this._strict=t,this._parent=n,this._enableTracing=r,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(kf,this),this._globalGraph=r?(n==null?void 0:n._globalGraph)??new Gx(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Ar(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)F5(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const n=this,r=new class extends Cf{dispose(){n._children.delete(r),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(r),t==null||t.add(r),r}invokeFunction(e,...t){this._throwIfDisposed();const n=Cu.traceInvocation(this._enableTracing,e);let r=!1;try{return e({get:o=>{if(r)throw k1("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,n);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{r=!0,n.stop()}}createInstance(e,...t){this._throwIfDisposed();let n,r;return e instanceof sr?(n=Cu.traceCreation(this._enableTracing,e.ctor),r=this._createInstance(e.ctor,e.staticArguments.concat(t),n)):(n=Cu.traceCreation(this._enableTracing,e),r=this._createInstance(e,t,n)),n.stop(),r}_createInstance(e,t=[],n){const r=Mn.getServiceDependencies(e).sort((a,l)=>a.index-l.index),s=[];for(const a of r){const l=this._getOrCreateServiceInstance(a.id,n);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(l)}const o=r.length>0?r[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(s))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof sr)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const n=this._getServiceInstanceOrDescriptor(e);return n instanceof sr?this._safeCreateAndCacheServiceInstance(e,n,t.branch(e,!0)):(t.branch(e,!1),n)}_safeCreateAndCacheServiceInstance(e,t,n){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,n){var l;const r=new Gx(c=>c.id.toString());let s=0;const o=[{id:e,desc:t,_trace:n}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),r.lookupOrInsertNode(c),s++>1e3)throw new Qx(r);for(const u of Mn.getServiceDependencies(c.desc.ctor)){const d=this._getServiceInstanceOrDescriptor(u.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),(l=this._globalGraph)==null||l.insertEdge(String(c.id),String(u.id)),d instanceof sr){const f={id:u.id,desc:d,_trace:c._trace.branch(u.id,!0)};r.lookup(f)||o.push(f),r.insertEdge(c,f)}}}}for(;;){const c=r.roots();if(c.length===0){if(!r.isEmpty())throw new Qx(r);break}for(const{data:u}of c){if(this._getServiceInstanceOrDescriptor(u.id)instanceof sr){const f=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,f)}r.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,n=[],r,s){if(this._services.get(e)instanceof sr)return this._createServiceInstance(e,t,n,r,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,n,r,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,n=[],r,s,o){if(r){const a=new Cf(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new LI(()=>{const u=a._createInstance(t,n,s);for(const[d,f]of l){const p=u[d];if(typeof p=="function")for(const b of f)b.disposable=p.apply(u,b.listener)}return l.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,d){if(!c.isInitialized&&typeof d=="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let b=l.get(d);return b||(b=new hu,l.set(d,b)),(v,S,k)=>{if(c.isInitialized)return c.value[d](v,S,k);{const C={listener:[v,S,k],disposable:void 0},N=b.push(C);return Me(()=>{var V;N(),(V=C.disposable)==null||V.dispose()})}}}if(d in u)return u[d];const f=c.value;let p=f[d];return typeof p!="function"||(p=p.bind(f),u[d]=p),p},set(u,d,f){return c.value[d]=f,!0},getPrototypeOf(u){return t.prototype}})}else{const a=this._createInstance(t,n,s);return o.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}var Do;(function(i){i[i.None=0]="None",i[i.Creation=1]="Creation",i[i.Invocation=2]="Invocation",i[i.Branch=3]="Branch"})(Do||(Do={}));const sn=class sn{static traceInvocation(e,t){return e?new sn(Do.Invocation,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):sn._None}static traceCreation(e,t){return e?new sn(Do.Creation,t.name):sn._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const n=new sn(Do.Branch,e.toString());return this._dep.push([e,t,n]),n}stop(){const e=Date.now()-this._start;sn._totals+=e;let t=!1;function n(s,o){const a=[],l=new Array(s+1).join("	");for(const[c,u,d]of o._dep)if(u&&d){t=!0,a.push(`${l}CREATES -> ${c}`);const f=n(s+1,d);f&&a.push(f)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const r=[`${this.type===Do.Creation?"CREATE":"CALL"} ${this.name}`,`${n(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${sn._totals.toFixed(2)}ms)`];(e>2||t)&&sn.all.add(r.join(`
`))}};sn.all=new Set,sn._None=new class extends sn{constructor(){super(Do.None,null)}stop(){}branch(){return this}},sn._totals=0;let Cu=sn;const it=ke("IExtHostRpcService");class qI{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}}const If=ke("IURITransformerService");class jI{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}}function B(i,e,t,n){var r=arguments.length,s=r<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,e,t,n);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function O(i,e){return function(t,n){e(t,n,i)}}const GI=globalThis._VSCODE_NLS_LANGUAGE==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Pf(i,e){let t;return e.length===0?t=i:t=i.replace(/\{(\d+)\}/g,(n,r)=>{const s=r[0],o=e[s];let a=n;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),GI&&(t=""+t.replace(/[aouei]/g,"$&$&")+""),t}function h(i,e,...t){return Pf(typeof i=="number"?Jx(i,e):e,t)}function Jx(i,e){var n;const t=(n=globalThis._VSCODE_NLS_MESSAGES)==null?void 0:n[i];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${i} !!!`)}return t}function l_(i,e,...t){let n;typeof i=="number"?n=Jx(i,e):n=e;const r=Pf(n,t);return{value:r,original:e===n?r:Pf(e,t)}}class QI{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),n=this._value.charCodeAt(this._pos);return t-n}value(){return this._value[this._pos]}}class JI{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===P.Period)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?J1(e,this._value,0,e.length,this._from,this._to):xu(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class Xx{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const n=this._value.charCodeAt(t);if(!(n===P.Slash||this._splitOnBackslash&&n===P.Backslash))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===P.Slash||this._splitOnBackslash&&t===P.Backslash)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?J1(e,this._value,0,e.length,this._from,this._to):xu(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}var ci;(function(i){i[i.Scheme=1]="Scheme",i[i.Authority=2]="Authority",i[i.Path=3]="Path",i[i.Query=4]="Query",i[i.Fragment=5]="Fragment"})(ci||(ci={}));class XI{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(ci.Scheme),this._value.authority&&this._states.push(ci.Authority),this._value.path&&(this._pathIterator=new Xx(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(ci.Path)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(ci.Query),this._value.fragment&&this._states.push(ci.Fragment)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===ci.Path&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===ci.Path&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===ci.Scheme)return gx(e,this._value.scheme);if(this._states[this._stateIdx]===ci.Authority)return gx(e,this._value.authority);if(this._states[this._stateIdx]===ci.Path)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===ci.Query)return bo(e,this._value.query);if(this._states[this._stateIdx]===ci.Fragment)return bo(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===ci.Scheme)return this._value.scheme;if(this._states[this._stateIdx]===ci.Authority)return this._value.authority;if(this._states[this._stateIdx]===ci.Path)return this._pathIterator.value();if(this._states[this._stateIdx]===ci.Query)return this._value.query;if(this._states[this._stateIdx]===ci.Fragment)return this._value.fragment;throw new Error}}class Tf{constructor(){this.height=1}isEmpty(){return!this.left&&!this.mid&&!this.right&&!this.value}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}var At;(function(i){i[i.Left=-1]="Left",i[i.Mid=0]="Mid",i[i.Right=1]="Right"})(At||(At={}));class Fr{static forUris(e=()=>!1,t=()=>!1){return new Fr(new XI(e,t))}static forPaths(e=!1){return new Fr(new Xx(void 0,!e))}static forStrings(){return new Fr(new QI)}static forConfigKeys(){return new Fr(new JI)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){const n=t.slice(0);Iy(n);for(const r of n)this.set(r,e)}else{const n=e.slice(0);Iy(n);for(const r of n)this.set(r[0],r[1])}}set(e,t){const n=this._iter.reset(e);let r;this._root||(this._root=new Tf,this._root.segment=n.value());const s=[];for(r=this._root;;){const a=n.cmp(r.segment);if(a>0)r.left||(r.left=new Tf,r.left.segment=n.value()),s.push([At.Left,r]),r=r.left;else if(a<0)r.right||(r.right=new Tf,r.right.segment=n.value()),s.push([At.Right,r]),r=r.right;else if(n.hasNext())n.next(),r.mid||(r.mid=new Tf,r.mid.segment=n.value()),s.push([At.Mid,r]),r=r.mid;else break}const o=r.value;r.value=t,r.key=e;for(let a=s.length-1;a>=0;a--){const l=s[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const u=s[a][0],d=s[a+1][0];if(u===At.Right&&d===At.Right)s[a][1]=l.rotateLeft();else if(u===At.Left&&d===At.Left)s[a][1]=l.rotateRight();else if(u===At.Right&&d===At.Left)l.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=l.rotateLeft();else if(u===At.Left&&d===At.Right)l.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case At.Left:s[a-1][1].left=s[a][1];break;case At.Right:s[a-1][1].right=s[a][1];break;case At.Mid:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return o}get(e){var t;return(t=this._getNode(e))==null?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let n=this._root;for(;n;){const r=t.cmp(n.segment);if(r>0)n=n.left;else if(r<0)n=n.right;else if(t.hasNext())t.next(),n=n.mid;else break}return n}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const n=this._iter.reset(e),r=[];let s=this._root;for(;s;){const o=n.cmp(s.segment);if(o>0)r.push([At.Left,s]),s=s.left;else if(o<0)r.push([At.Right,s]),s=s.right;else if(n.hasNext())n.next(),r.push([At.Mid,s]),s=s.mid;else break}if(s){if(t?(s.left=void 0,s.mid=void 0,s.right=void 0,s.height=1):(s.key=void 0,s.value=void 0),!s.mid&&!s.value)if(s.left&&s.right){const o=this._min(s.right);if(o.key){const{key:a,value:l,segment:c}=o;this._delete(o.key,!1),s.key=a,s.value=l,s.segment=c}}else{const o=s.left??s.right;if(r.length>0){const[a,l]=r[r.length-1];switch(a){case At.Left:l.left=o;break;case At.Mid:l.mid=o;break;case At.Right:l.right=o;break}}else this._root=o}for(let o=r.length-1;o>=0;o--){const a=r[o][1];a.updateHeight();const l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),r[o][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),r[o][1]=a.rotateRight()),o>0)switch(r[o-1][0]){case At.Left:r[o-1][1].left=r[o][1];break;case At.Right:r[o-1][1].right=r[o][1];break;case At.Mid:r[o-1][1].mid=r[o][1];break}else this._root=r[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let n=this._root,r;for(;n;){const s=t.cmp(n.segment);if(s>0)n=n.left;else if(s<0)n=n.right;else if(t.hasNext())t.next(),r=n.value||r,n=n.mid;else break}return n&&n.value||r}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const n=this._iter.reset(e);let r=this._root;for(;r;){const s=n.cmp(r.segment);if(s>0)r=r.left;else if(s<0)r=r.right;else if(n.hasNext())n.next(),r=r.mid;else return r.mid?this._entries(r.mid):t?r.value:void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(const[t,n]of this)e(n,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){const e=t=>{if(!t)return!0;const n=t.balanceFactor();return n<-1||n>1?!1:e(t.left)&&e(t.right)};return e(this._root)}}function Et(i){if(!i||typeof i!="object"||i instanceof RegExp)return i;const e=Array.isArray(i)?[]:{};return Object.entries(i).forEach(([t,n])=>{e[t]=n&&typeof n=="object"?Et(n):n}),e}function Yx(i){if(!i||typeof i!="object")return i;const e=[i];for(;e.length>0;){const t=e.shift();for(const n in t)if(Kx.call(t,n)){const r=t[n];typeof r=="object"&&!Object.isFrozen(r)&&!iI(r)&&e.push(r)}}return i}const Kx=Object.prototype.hasOwnProperty;function Af(i,e){return c_(i,e,new Set)}function c_(i,e,t){if(Wt(i))return i;const n=e(i);if(typeof n<"u")return n;if(Array.isArray(i)){const r=[];for(const s of i)r.push(c_(s,e,t));return r}if(Bt(i)){if(t.has(i))throw new Error("Cannot clone recursive data-structure");t.add(i);const r={};for(const s in i)Kx.call(i,s)&&(r[s]=c_(i[s],e,t));return t.delete(i),r}return i}function ko(i,e,t=!0){return Bt(i)?(Bt(e)&&Object.keys(e).forEach(n=>{n in i?t&&(Bt(i[n])&&Bt(e[n])?ko(i[n],e[n],t):i[n]=e[n]):i[n]=e[n]}),i):e}function $n(i,e){if(i===e)return!0;if(i==null||e===null||e===void 0||typeof i!=typeof e||typeof i!="object"||Array.isArray(i)!==Array.isArray(e))return!1;let t,n;if(Array.isArray(i)){if(i.length!==e.length)return!1;for(t=0;t<i.length;t++)if(!$n(i[t],e[t]))return!1}else{const r=[];for(n in i)r.push(n);r.sort();const s=[];for(n in e)s.push(n);if(s.sort(),!$n(r,s))return!1;for(t=0;t<r.length;t++)if(!$n(i[r[t]],e[r[t]]))return!1}return!0}function YI(i){const e=new Set;return JSON.stringify(i,(t,n)=>{if(Bt(n)||Array.isArray(n)){if(e.has(n))return"[Circular]";e.add(n)}return typeof n=="bigint"?`[BigInt ${n.toString()}]`:n})}function Zx(i,e){const t=Object.create(null);for(const[n,r]of Object.entries(i))e(n,r)&&(t[n]=r);return t}class KI{constructor(){this._next=0}getNext(){return this._next++}}var Co;(function(i){i[i.Unknown=0]="Unknown",i[i.File=1]="File",i[i.Directory=2]="Directory",i[i.SymbolicLink=64]="SymbolicLink"})(Co||(Co={}));var fl;(function(i){i[i.Readonly=1]="Readonly",i[i.Locked=2]="Locked"})(fl||(fl={}));var Is;(function(i){i[i.UPDATED=2]="UPDATED",i[i.ADDED=4]="ADDED",i[i.DELETED=8]="DELETED"})(Is||(Is={}));var or;(function(i){i[i.None=0]="None",i[i.FileReadWrite=2]="FileReadWrite",i[i.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",i[i.FileReadStream=16]="FileReadStream",i[i.FileFolderCopy=8]="FileFolderCopy",i[i.PathCaseSensitive=1024]="PathCaseSensitive",i[i.Readonly=2048]="Readonly",i[i.Trash=4096]="Trash",i[i.FileWriteUnlock=8192]="FileWriteUnlock",i[i.FileAtomicRead=16384]="FileAtomicRead",i[i.FileAtomicWrite=32768]="FileAtomicWrite",i[i.FileAtomicDelete=65536]="FileAtomicDelete",i[i.FileClone=131072]="FileClone"})(or||(or={}));var Pe;(function(i){i.FileExists="EntryExists",i.FileNotFound="EntryNotFound",i.FileNotADirectory="EntryNotADirectory",i.FileIsADirectory="EntryIsADirectory",i.FileExceedsStorageQuota="EntryExceedsStorageQuota",i.FileTooLarge="EntryTooLarge",i.FileWriteLocked="EntryWriteLocked",i.NoPermissions="NoPermissions",i.Unavailable="Unavailable",i.Unknown="Unknown"})(Pe||(Pe={}));class Rf extends Error{static create(e,t){const n=new Rf(e.toString(),t);return e2(n,t),n}constructor(e,t){super(e),this.code=t}}function e2(i,e){return i.name=e?`${e} (FileSystemError)`:"FileSystemError",i}function Lf(i){if(!i)return Pe.Unknown;if(i instanceof Rf)return i.code;const e=/^(.+) \(FileSystemError\)$/.exec(i.name);if(!e)return Pe.Unknown;switch(e[1]){case Pe.FileExists:return Pe.FileExists;case Pe.FileIsADirectory:return Pe.FileIsADirectory;case Pe.FileNotADirectory:return Pe.FileNotADirectory;case Pe.FileNotFound:return Pe.FileNotFound;case Pe.FileTooLarge:return Pe.FileTooLarge;case Pe.FileWriteLocked:return Pe.FileWriteLocked;case Pe.NoPermissions:return Pe.NoPermissions;case Pe.Unavailable:return Pe.Unavailable}return Pe.Unknown}function ZI(i){if(i instanceof u_)return i.fileOperationResult;switch(Lf(i)){case Pe.FileNotFound:return fn.FILE_NOT_FOUND;case Pe.FileIsADirectory:return fn.FILE_IS_DIRECTORY;case Pe.FileNotADirectory:return fn.FILE_NOT_DIRECTORY;case Pe.FileWriteLocked:return fn.FILE_WRITE_LOCKED;case Pe.NoPermissions:return fn.FILE_PERMISSION_DENIED;case Pe.FileExists:return fn.FILE_MOVE_CONFLICT;case Pe.FileTooLarge:return fn.FILE_TOO_LARGE;default:return fn.FILE_OTHER_ERROR}}var ar;(function(i){i[i.CREATE=0]="CREATE",i[i.DELETE=1]="DELETE",i[i.MOVE=2]="MOVE",i[i.COPY=3]="COPY",i[i.WRITE=4]="WRITE"})(ar||(ar={}));var Iu;(function(i){i[i.UPDATED=0]="UPDATED",i[i.ADDED=1]="ADDED",i[i.DELETED=2]="DELETED"})(Iu||(Iu={}));class u_ extends Error{constructor(e,t,n){super(e),this.fileOperationResult=t,this.options=n}}var fn;(function(i){i[i.FILE_IS_DIRECTORY=0]="FILE_IS_DIRECTORY",i[i.FILE_NOT_FOUND=1]="FILE_NOT_FOUND",i[i.FILE_NOT_MODIFIED_SINCE=2]="FILE_NOT_MODIFIED_SINCE",i[i.FILE_MODIFIED_SINCE=3]="FILE_MODIFIED_SINCE",i[i.FILE_MOVE_CONFLICT=4]="FILE_MOVE_CONFLICT",i[i.FILE_WRITE_LOCKED=5]="FILE_WRITE_LOCKED",i[i.FILE_PERMISSION_DENIED=6]="FILE_PERMISSION_DENIED",i[i.FILE_TOO_LARGE=7]="FILE_TOO_LARGE",i[i.FILE_INVALID_PATH=8]="FILE_INVALID_PATH",i[i.FILE_NOT_DIRECTORY=9]="FILE_NOT_DIRECTORY",i[i.FILE_OTHER_ERROR=10]="FILE_OTHER_ERROR"})(fn||(fn={}));var t2;(function(i){i[i.FILE=0]="FILE",i[i.FOLDER=1]="FOLDER",i[i.ROOT_FOLDER=2]="ROOT_FOLDER"})(t2||(t2={}));const e7="";function i2(i){if(!(typeof i.size!="number"||typeof i.mtime!="number"))return i.mtime.toString(29)+i.size.toString(31)}const si=class si{static formatSize(e){return Ds(e)||(e=0),e<si.KB?h(1,"{0}B",e.toFixed(0)):e<si.MB?h(2,"{0}KB",(e/si.KB).toFixed(2)):e<si.GB?h(3,"{0}MB",(e/si.MB).toFixed(2)):e<si.TB?h(4,"{0}GB",(e/si.GB).toFixed(2)):h(5,"{0}TB",(e/si.TB).toFixed(2))}};si.KB=1024,si.MB=si.KB*si.KB,si.GB=si.MB*si.KB,si.TB=si.GB*si.KB;let n2=si;var Pu;(function(i){i[i.Ignore=0]="Ignore",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error"})(Pu||(Pu={})),function(i){const e="error",t="warning",n="warn",r="info",s="ignore";function o(l){return l?Ss(e,l)?i.Error:Ss(t,l)||Ss(n,l)?i.Warning:Ss(r,l)?i.Info:i.Ignore:i.Ignore}i.fromValue=o;function a(l){switch(l){case i.Error:return e;case i.Warning:return t;case i.Info:return r;default:return s}}i.toString=a}(Pu||(Pu={}));var Vt=Pu,r2;(function(i){i[i.DEFAULT=0]="DEFAULT",i[i.SILENT=1]="SILENT",i[i.URGENT=2]="URGENT"})(r2||(r2={}));var s2;(function(i){i[i.WORKSPACE=0]="WORKSPACE",i[i.PROFILE=1]="PROFILE",i[i.APPLICATION=2]="APPLICATION"})(s2||(s2={}));var o2;(function(i){i[i.OFF=0]="OFF",i[i.ERROR=1]="ERROR"})(o2||(o2={}));function d_(i){const e=i;return typeof(e==null?void 0:e.id)=="string"&&y.isUri(e.uri)}function h_(i){const e=i;return typeof(e==null?void 0:e.id)=="string"&&y.isUri(e.configPath)}var Nf;(function(i){i[i.EMPTY=1]="EMPTY",i[i.FOLDER=2]="FOLDER",i[i.WORKSPACE=3]="WORKSPACE"})(Nf||(Nf={}));let t7=class{constructor(e,t,n,r,s){this._id=e,this._transient=n,this._configuration=r,this._ignorePathCasing=s,this._foldersMap=Fr.forUris(this._ignorePathCasing,()=>!0),this.folders=t}update(e){this._id=e.id,this._configuration=e.configuration,this._transient=e.transient,this._ignorePathCasing=e._ignorePathCasing,this.folders=e.folders}get folders(){return this._folders}set folders(e){this._folders=e,this.updateFoldersMap()}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){return e&&this._foldersMap.findSubstr(e)||null}updateFoldersMap(){this._foldersMap=Fr.forUris(this._ignorePathCasing,()=>!0);for(const e of this.folders)this._foldersMap.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};class a2{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return Li(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}function l2(i){return new a2({uri:i,index:0,name:t_(i)},{uri:i.toString()})}const i7="code-workspace";h(702,"Code Workspace");class n7{constructor(){this._systemSchemes=new Set(Object.keys(le)),this._providerInfo=new Map,this.extUri=new Su(e=>{const t=this._providerInfo.get(e.scheme);return!(t===void 0||t&or.PathCaseSensitive)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const pl=ke("IExtHostFileSystemInfo"),Un=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let i;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?i=crypto.getRandomValues.bind(crypto):i=function(n){for(let r=0;r<n.length;r++)n[r]=Math.floor(Math.random()*256);return n};const e=new Uint8Array(16),t=[];for(let n=0;n<256;n++)t.push(n.toString(16).padStart(2,"0"));return function(){i(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let r=0,s="";return s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s}}(),f_=Object.freeze({create:i=>el(i.map(e=>e.toString())).join(`\r
`),split:i=>i.split(`\r
`),parse:i=>f_.split(i).filter(e=>!e.startsWith("#"))});var c2;(function(i){i[i.InitialConsonant=4352]="InitialConsonant",i[i.Vowel=4449]="Vowel",i[i.FinalConsonant=4520]="FinalConsonant",i[i.CompatibilityJamo=12593]="CompatibilityJamo"})(c2||(c2={}));var K;(function(i){i[i.NUL=0]="NUL",i[i.A=65]="A",i[i.B=66]="B",i[i.C=67]="C",i[i.D=68]="D",i[i.E=69]="E",i[i.F=70]="F",i[i.G=71]="G",i[i.H=72]="H",i[i.I=73]="I",i[i.J=74]="J",i[i.K=75]="K",i[i.L=76]="L",i[i.M=77]="M",i[i.N=78]="N",i[i.O=79]="O",i[i.P=80]="P",i[i.Q=81]="Q",i[i.R=82]="R",i[i.S=83]="S",i[i.T=84]="T",i[i.U=85]="U",i[i.V=86]="V",i[i.W=87]="W",i[i.X=88]="X",i[i.Y=89]="Y",i[i.Z=90]="Z",i[i.a=97]="a",i[i.b=98]="b",i[i.c=99]="c",i[i.d=100]="d",i[i.e=101]="e",i[i.f=102]="f",i[i.g=103]="g",i[i.h=104]="h",i[i.i=105]="i",i[i.j=106]="j",i[i.k=107]="k",i[i.l=108]="l",i[i.m=109]="m",i[i.n=110]="n",i[i.o=111]="o",i[i.p=112]="p",i[i.q=113]="q",i[i.r=114]="r",i[i.s=115]="s",i[i.t=116]="t",i[i.u=117]="u",i[i.v=118]="v",i[i.w=119]="w",i[i.x=120]="x",i[i.y=121]="y",i[i.z=122]="z"})(K||(K={}));var Xe;(function(i){i[i.fa=24934]="fa",i[i.fg=26470]="fg",i[i.fq=29030]="fq",i[i.fr=29286]="fr",i[i.ft=29798]="ft",i[i.fv=30310]="fv",i[i.fx=30822]="fx",i[i.hk=27496]="hk",i[i.hl=27752]="hl",i[i.ho=28520]="ho",i[i.ml=27757]="ml",i[i.nj=27246]="nj",i[i.nl=27758]="nl",i[i.np=28782]="np",i[i.qt=29809]="qt",i[i.rt=29810]="rt",i[i.sg=26483]="sg",i[i.sw=30579]="sw"})(Xe||(Xe={})),new Uint8Array([K.r,K.R,K.s,K.e,K.E,K.f,K.a,K.q,K.Q,K.t,K.T,K.d,K.w,K.W,K.c,K.z,K.x,K.v,K.g]),new Uint16Array([K.k,K.o,K.i,K.O,K.j,K.p,K.u,K.P,K.h,Xe.hk,Xe.ho,Xe.hl,K.y,K.n,Xe.nj,Xe.np,Xe.nl,K.b,K.m,Xe.ml,K.l]),new Uint16Array([K.r,K.R,Xe.rt,K.s,Xe.sw,Xe.sg,K.e,K.f,Xe.fr,Xe.fa,Xe.fq,Xe.ft,Xe.fx,Xe.fv,Xe.fg,K.a,K.q,Xe.qt,K.t,K.T,K.d,K.w,K.c,K.z,K.x,K.v,K.g]),new Uint16Array([K.r,K.R,Xe.rt,K.s,Xe.sw,Xe.sg,K.e,K.E,K.f,Xe.fr,Xe.fa,Xe.fq,Xe.ft,Xe.fx,Xe.fv,Xe.fg,K.a,K.q,K.Q,Xe.qt,K.t,K.T,K.d,K.w,K.W,K.c,K.z,K.x,K.v,K.g,K.k,K.o,K.i,K.O,K.j,K.p,K.u,K.P,K.h,Xe.hk,Xe.ho,Xe.hl,K.y,K.n,Xe.nj,Xe.np,Xe.nl,K.b,K.m,Xe.ml,K.l]),u2.bind(void 0,!1),u2.bind(void 0,!0);function u2(i,e,t){if(!t||t.length<e.length)return null;let n;return i?n=X1(t,e):n=t.indexOf(e)===0,n?e.length>0?[{start:0,end:e.length}]:[]:null}const r7=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(i=>r7.add(i.charCodeAt(0))),new A1(1e4);const d2=128;function p_(){const i=[],e=[];for(let t=0;t<=d2;t++)e[t]=0;for(let t=0;t<=d2;t++)i.push(e.slice(0));return i}p_(),p_(),p_();var h2;(function(i){i[i.Diag=1]="Diag",i[i.Left=2]="Left",i[i.LeftLeft=3]="LeftLeft"})(h2||(h2={}));var f2;(function(i){i.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}i.isDefault=e})(f2||(f2={}));const Y0=class Y0{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}};Y0.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};let p2=Y0;const g_=Object.create(null);function g(i,e){if(Ge(e)){const t=g_[e];if(t===void 0)throw new Error(`${i} references an unknown codicon: ${e}`);e=t}return g_[i]=e,{id:i}}function s7(){return g_}const o7={add:g("add",6e4),plus:g("plus",6e4),gistNew:g("gist-new",6e4),repoCreate:g("repo-create",6e4),lightbulb:g("lightbulb",60001),lightBulb:g("light-bulb",60001),repo:g("repo",60002),repoDelete:g("repo-delete",60002),gistFork:g("gist-fork",60003),repoForked:g("repo-forked",60003),gitPullRequest:g("git-pull-request",60004),gitPullRequestAbandoned:g("git-pull-request-abandoned",60004),recordKeys:g("record-keys",60005),keyboard:g("keyboard",60005),tag:g("tag",60006),gitPullRequestLabel:g("git-pull-request-label",60006),tagAdd:g("tag-add",60006),tagRemove:g("tag-remove",60006),person:g("person",60007),personFollow:g("person-follow",60007),personOutline:g("person-outline",60007),personFilled:g("person-filled",60007),gitBranch:g("git-branch",60008),gitBranchCreate:g("git-branch-create",60008),gitBranchDelete:g("git-branch-delete",60008),sourceControl:g("source-control",60008),mirror:g("mirror",60009),mirrorPublic:g("mirror-public",60009),star:g("star",60010),starAdd:g("star-add",60010),starDelete:g("star-delete",60010),starEmpty:g("star-empty",60010),comment:g("comment",60011),commentAdd:g("comment-add",60011),alert:g("alert",60012),warning:g("warning",60012),search:g("search",60013),searchSave:g("search-save",60013),logOut:g("log-out",60014),signOut:g("sign-out",60014),logIn:g("log-in",60015),signIn:g("sign-in",60015),eye:g("eye",60016),eyeUnwatch:g("eye-unwatch",60016),eyeWatch:g("eye-watch",60016),circleFilled:g("circle-filled",60017),primitiveDot:g("primitive-dot",60017),closeDirty:g("close-dirty",60017),debugBreakpoint:g("debug-breakpoint",60017),debugBreakpointDisabled:g("debug-breakpoint-disabled",60017),debugHint:g("debug-hint",60017),terminalDecorationSuccess:g("terminal-decoration-success",60017),primitiveSquare:g("primitive-square",60018),edit:g("edit",60019),pencil:g("pencil",60019),info:g("info",60020),issueOpened:g("issue-opened",60020),gistPrivate:g("gist-private",60021),gitForkPrivate:g("git-fork-private",60021),lock:g("lock",60021),mirrorPrivate:g("mirror-private",60021),close:g("close",60022),removeClose:g("remove-close",60022),x:g("x",60022),repoSync:g("repo-sync",60023),sync:g("sync",60023),clone:g("clone",60024),desktopDownload:g("desktop-download",60024),beaker:g("beaker",60025),microscope:g("microscope",60025),vm:g("vm",60026),deviceDesktop:g("device-desktop",60026),file:g("file",60027),fileText:g("file-text",60027),more:g("more",60028),ellipsis:g("ellipsis",60028),kebabHorizontal:g("kebab-horizontal",60028),mailReply:g("mail-reply",60029),reply:g("reply",60029),organization:g("organization",60030),organizationFilled:g("organization-filled",60030),organizationOutline:g("organization-outline",60030),newFile:g("new-file",60031),fileAdd:g("file-add",60031),newFolder:g("new-folder",60032),fileDirectoryCreate:g("file-directory-create",60032),trash:g("trash",60033),trashcan:g("trashcan",60033),history:g("history",60034),clock:g("clock",60034),folder:g("folder",60035),fileDirectory:g("file-directory",60035),symbolFolder:g("symbol-folder",60035),logoGithub:g("logo-github",60036),markGithub:g("mark-github",60036),github:g("github",60036),terminal:g("terminal",60037),console:g("console",60037),repl:g("repl",60037),zap:g("zap",60038),symbolEvent:g("symbol-event",60038),error:g("error",60039),stop:g("stop",60039),variable:g("variable",60040),symbolVariable:g("symbol-variable",60040),array:g("array",60042),symbolArray:g("symbol-array",60042),symbolModule:g("symbol-module",60043),symbolPackage:g("symbol-package",60043),symbolNamespace:g("symbol-namespace",60043),symbolObject:g("symbol-object",60043),symbolMethod:g("symbol-method",60044),symbolFunction:g("symbol-function",60044),symbolConstructor:g("symbol-constructor",60044),symbolBoolean:g("symbol-boolean",60047),symbolNull:g("symbol-null",60047),symbolNumeric:g("symbol-numeric",60048),symbolNumber:g("symbol-number",60048),symbolStructure:g("symbol-structure",60049),symbolStruct:g("symbol-struct",60049),symbolParameter:g("symbol-parameter",60050),symbolTypeParameter:g("symbol-type-parameter",60050),symbolKey:g("symbol-key",60051),symbolText:g("symbol-text",60051),symbolReference:g("symbol-reference",60052),goToFile:g("go-to-file",60052),symbolEnum:g("symbol-enum",60053),symbolValue:g("symbol-value",60053),symbolRuler:g("symbol-ruler",60054),symbolUnit:g("symbol-unit",60054),activateBreakpoints:g("activate-breakpoints",60055),archive:g("archive",60056),arrowBoth:g("arrow-both",60057),arrowDown:g("arrow-down",60058),arrowLeft:g("arrow-left",60059),arrowRight:g("arrow-right",60060),arrowSmallDown:g("arrow-small-down",60061),arrowSmallLeft:g("arrow-small-left",60062),arrowSmallRight:g("arrow-small-right",60063),arrowSmallUp:g("arrow-small-up",60064),arrowUp:g("arrow-up",60065),bell:g("bell",60066),bold:g("bold",60067),book:g("book",60068),bookmark:g("bookmark",60069),debugBreakpointConditionalUnverified:g("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:g("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:g("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:g("debug-breakpoint-data-unverified",60072),debugBreakpointData:g("debug-breakpoint-data",60073),debugBreakpointDataDisabled:g("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:g("debug-breakpoint-log-unverified",60074),debugBreakpointLog:g("debug-breakpoint-log",60075),debugBreakpointLogDisabled:g("debug-breakpoint-log-disabled",60075),briefcase:g("briefcase",60076),broadcast:g("broadcast",60077),browser:g("browser",60078),bug:g("bug",60079),calendar:g("calendar",60080),caseSensitive:g("case-sensitive",60081),check:g("check",60082),checklist:g("checklist",60083),chevronDown:g("chevron-down",60084),chevronLeft:g("chevron-left",60085),chevronRight:g("chevron-right",60086),chevronUp:g("chevron-up",60087),chromeClose:g("chrome-close",60088),chromeMaximize:g("chrome-maximize",60089),chromeMinimize:g("chrome-minimize",60090),chromeRestore:g("chrome-restore",60091),circleOutline:g("circle-outline",60092),circle:g("circle",60092),debugBreakpointUnverified:g("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:g("terminal-decoration-incomplete",60092),circleSlash:g("circle-slash",60093),circuitBoard:g("circuit-board",60094),clearAll:g("clear-all",60095),clippy:g("clippy",60096),closeAll:g("close-all",60097),cloudDownload:g("cloud-download",60098),cloudUpload:g("cloud-upload",60099),code:g("code",60100),collapseAll:g("collapse-all",60101),colorMode:g("color-mode",60102),commentDiscussion:g("comment-discussion",60103),creditCard:g("credit-card",60105),dash:g("dash",60108),dashboard:g("dashboard",60109),database:g("database",60110),debugContinue:g("debug-continue",60111),debugDisconnect:g("debug-disconnect",60112),debugPause:g("debug-pause",60113),debugRestart:g("debug-restart",60114),debugStart:g("debug-start",60115),debugStepInto:g("debug-step-into",60116),debugStepOut:g("debug-step-out",60117),debugStepOver:g("debug-step-over",60118),debugStop:g("debug-stop",60119),debug:g("debug",60120),deviceCameraVideo:g("device-camera-video",60121),deviceCamera:g("device-camera",60122),deviceMobile:g("device-mobile",60123),diffAdded:g("diff-added",60124),diffIgnored:g("diff-ignored",60125),diffModified:g("diff-modified",60126),diffRemoved:g("diff-removed",60127),diffRenamed:g("diff-renamed",60128),diff:g("diff",60129),diffSidebyside:g("diff-sidebyside",60129),discard:g("discard",60130),editorLayout:g("editor-layout",60131),emptyWindow:g("empty-window",60132),exclude:g("exclude",60133),extensions:g("extensions",60134),eyeClosed:g("eye-closed",60135),fileBinary:g("file-binary",60136),fileCode:g("file-code",60137),fileMedia:g("file-media",60138),filePdf:g("file-pdf",60139),fileSubmodule:g("file-submodule",60140),fileSymlinkDirectory:g("file-symlink-directory",60141),fileSymlinkFile:g("file-symlink-file",60142),fileZip:g("file-zip",60143),files:g("files",60144),filter:g("filter",60145),flame:g("flame",60146),foldDown:g("fold-down",60147),foldUp:g("fold-up",60148),fold:g("fold",60149),folderActive:g("folder-active",60150),folderOpened:g("folder-opened",60151),gear:g("gear",60152),gift:g("gift",60153),gistSecret:g("gist-secret",60154),gist:g("gist",60155),gitCommit:g("git-commit",60156),gitCompare:g("git-compare",60157),compareChanges:g("compare-changes",60157),gitMerge:g("git-merge",60158),githubAction:g("github-action",60159),githubAlt:g("github-alt",60160),globe:g("globe",60161),grabber:g("grabber",60162),graph:g("graph",60163),gripper:g("gripper",60164),heart:g("heart",60165),home:g("home",60166),horizontalRule:g("horizontal-rule",60167),hubot:g("hubot",60168),inbox:g("inbox",60169),issueReopened:g("issue-reopened",60171),issues:g("issues",60172),italic:g("italic",60173),jersey:g("jersey",60174),json:g("json",60175),kebabVertical:g("kebab-vertical",60176),key:g("key",60177),law:g("law",60178),lightbulbAutofix:g("lightbulb-autofix",60179),linkExternal:g("link-external",60180),link:g("link",60181),listOrdered:g("list-ordered",60182),listUnordered:g("list-unordered",60183),liveShare:g("live-share",60184),loading:g("loading",60185),location:g("location",60186),mailRead:g("mail-read",60187),mail:g("mail",60188),markdown:g("markdown",60189),megaphone:g("megaphone",60190),mention:g("mention",60191),milestone:g("milestone",60192),gitPullRequestMilestone:g("git-pull-request-milestone",60192),mortarBoard:g("mortar-board",60193),move:g("move",60194),multipleWindows:g("multiple-windows",60195),mute:g("mute",60196),noNewline:g("no-newline",60197),note:g("note",60198),octoface:g("octoface",60199),openPreview:g("open-preview",60200),package:g("package",60201),paintcan:g("paintcan",60202),pin:g("pin",60203),play:g("play",60204),run:g("run",60204),plug:g("plug",60205),preserveCase:g("preserve-case",60206),preview:g("preview",60207),project:g("project",60208),pulse:g("pulse",60209),question:g("question",60210),quote:g("quote",60211),radioTower:g("radio-tower",60212),reactions:g("reactions",60213),references:g("references",60214),refresh:g("refresh",60215),regex:g("regex",60216),remoteExplorer:g("remote-explorer",60217),remote:g("remote",60218),remove:g("remove",60219),replaceAll:g("replace-all",60220),replace:g("replace",60221),repoClone:g("repo-clone",60222),repoForcePush:g("repo-force-push",60223),repoPull:g("repo-pull",60224),repoPush:g("repo-push",60225),report:g("report",60226),requestChanges:g("request-changes",60227),rocket:g("rocket",60228),rootFolderOpened:g("root-folder-opened",60229),rootFolder:g("root-folder",60230),rss:g("rss",60231),ruby:g("ruby",60232),saveAll:g("save-all",60233),saveAs:g("save-as",60234),save:g("save",60235),screenFull:g("screen-full",60236),screenNormal:g("screen-normal",60237),searchStop:g("search-stop",60238),server:g("server",60240),settingsGear:g("settings-gear",60241),settings:g("settings",60242),shield:g("shield",60243),smiley:g("smiley",60244),sortPrecedence:g("sort-precedence",60245),splitHorizontal:g("split-horizontal",60246),splitVertical:g("split-vertical",60247),squirrel:g("squirrel",60248),starFull:g("star-full",60249),starHalf:g("star-half",60250),symbolClass:g("symbol-class",60251),symbolColor:g("symbol-color",60252),symbolConstant:g("symbol-constant",60253),symbolEnumMember:g("symbol-enum-member",60254),symbolField:g("symbol-field",60255),symbolFile:g("symbol-file",60256),symbolInterface:g("symbol-interface",60257),symbolKeyword:g("symbol-keyword",60258),symbolMisc:g("symbol-misc",60259),symbolOperator:g("symbol-operator",60260),symbolProperty:g("symbol-property",60261),wrench:g("wrench",60261),wrenchSubaction:g("wrench-subaction",60261),symbolSnippet:g("symbol-snippet",60262),tasklist:g("tasklist",60263),telescope:g("telescope",60264),textSize:g("text-size",60265),threeBars:g("three-bars",60266),thumbsdown:g("thumbsdown",60267),thumbsup:g("thumbsup",60268),tools:g("tools",60269),triangleDown:g("triangle-down",60270),triangleLeft:g("triangle-left",60271),triangleRight:g("triangle-right",60272),triangleUp:g("triangle-up",60273),twitter:g("twitter",60274),unfold:g("unfold",60275),unlock:g("unlock",60276),unmute:g("unmute",60277),unverified:g("unverified",60278),verified:g("verified",60279),versions:g("versions",60280),vmActive:g("vm-active",60281),vmOutline:g("vm-outline",60282),vmRunning:g("vm-running",60283),watch:g("watch",60284),whitespace:g("whitespace",60285),wholeWord:g("whole-word",60286),window:g("window",60287),wordWrap:g("word-wrap",60288),zoomIn:g("zoom-in",60289),zoomOut:g("zoom-out",60290),listFilter:g("list-filter",60291),listFlat:g("list-flat",60292),listSelection:g("list-selection",60293),selection:g("selection",60293),listTree:g("list-tree",60294),debugBreakpointFunctionUnverified:g("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:g("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:g("debug-breakpoint-function-disabled",60296),debugStackframeActive:g("debug-stackframe-active",60297),circleSmallFilled:g("circle-small-filled",60298),debugStackframeDot:g("debug-stackframe-dot",60298),terminalDecorationMark:g("terminal-decoration-mark",60298),debugStackframe:g("debug-stackframe",60299),debugStackframeFocused:g("debug-stackframe-focused",60299),debugBreakpointUnsupported:g("debug-breakpoint-unsupported",60300),symbolString:g("symbol-string",60301),debugReverseContinue:g("debug-reverse-continue",60302),debugStepBack:g("debug-step-back",60303),debugRestartFrame:g("debug-restart-frame",60304),debugAlt:g("debug-alt",60305),callIncoming:g("call-incoming",60306),callOutgoing:g("call-outgoing",60307),menu:g("menu",60308),expandAll:g("expand-all",60309),feedback:g("feedback",60310),gitPullRequestReviewer:g("git-pull-request-reviewer",60310),groupByRefType:g("group-by-ref-type",60311),ungroupByRefType:g("ungroup-by-ref-type",60312),account:g("account",60313),gitPullRequestAssignee:g("git-pull-request-assignee",60313),bellDot:g("bell-dot",60314),debugConsole:g("debug-console",60315),library:g("library",60316),output:g("output",60317),runAll:g("run-all",60318),syncIgnored:g("sync-ignored",60319),pinned:g("pinned",60320),githubInverted:g("github-inverted",60321),serverProcess:g("server-process",60322),serverEnvironment:g("server-environment",60323),pass:g("pass",60324),issueClosed:g("issue-closed",60324),stopCircle:g("stop-circle",60325),playCircle:g("play-circle",60326),record:g("record",60327),debugAltSmall:g("debug-alt-small",60328),vmConnect:g("vm-connect",60329),cloud:g("cloud",60330),merge:g("merge",60331),export:g("export",60332),graphLeft:g("graph-left",60333),magnet:g("magnet",60334),notebook:g("notebook",60335),redo:g("redo",60336),checkAll:g("check-all",60337),pinnedDirty:g("pinned-dirty",60338),passFilled:g("pass-filled",60339),circleLargeFilled:g("circle-large-filled",60340),circleLarge:g("circle-large",60341),circleLargeOutline:g("circle-large-outline",60341),combine:g("combine",60342),gather:g("gather",60342),table:g("table",60343),variableGroup:g("variable-group",60344),typeHierarchy:g("type-hierarchy",60345),typeHierarchySub:g("type-hierarchy-sub",60346),typeHierarchySuper:g("type-hierarchy-super",60347),gitPullRequestCreate:g("git-pull-request-create",60348),runAbove:g("run-above",60349),runBelow:g("run-below",60350),notebookTemplate:g("notebook-template",60351),debugRerun:g("debug-rerun",60352),workspaceTrusted:g("workspace-trusted",60353),workspaceUntrusted:g("workspace-untrusted",60354),workspaceUnknown:g("workspace-unknown",60355),terminalCmd:g("terminal-cmd",60356),terminalDebian:g("terminal-debian",60357),terminalLinux:g("terminal-linux",60358),terminalPowershell:g("terminal-powershell",60359),terminalTmux:g("terminal-tmux",60360),terminalUbuntu:g("terminal-ubuntu",60361),terminalBash:g("terminal-bash",60362),arrowSwap:g("arrow-swap",60363),copy:g("copy",60364),personAdd:g("person-add",60365),filterFilled:g("filter-filled",60366),wand:g("wand",60367),debugLineByLine:g("debug-line-by-line",60368),inspect:g("inspect",60369),layers:g("layers",60370),layersDot:g("layers-dot",60371),layersActive:g("layers-active",60372),compass:g("compass",60373),compassDot:g("compass-dot",60374),compassActive:g("compass-active",60375),azure:g("azure",60376),issueDraft:g("issue-draft",60377),gitPullRequestClosed:g("git-pull-request-closed",60378),gitPullRequestDraft:g("git-pull-request-draft",60379),debugAll:g("debug-all",60380),debugCoverage:g("debug-coverage",60381),runErrors:g("run-errors",60382),folderLibrary:g("folder-library",60383),debugContinueSmall:g("debug-continue-small",60384),beakerStop:g("beaker-stop",60385),graphLine:g("graph-line",60386),graphScatter:g("graph-scatter",60387),pieChart:g("pie-chart",60388),bracket:g("bracket",60175),bracketDot:g("bracket-dot",60389),bracketError:g("bracket-error",60390),lockSmall:g("lock-small",60391),azureDevops:g("azure-devops",60392),verifiedFilled:g("verified-filled",60393),newline:g("newline",60394),layout:g("layout",60395),layoutActivitybarLeft:g("layout-activitybar-left",60396),layoutActivitybarRight:g("layout-activitybar-right",60397),layoutPanelLeft:g("layout-panel-left",60398),layoutPanelCenter:g("layout-panel-center",60399),layoutPanelJustify:g("layout-panel-justify",60400),layoutPanelRight:g("layout-panel-right",60401),layoutPanel:g("layout-panel",60402),layoutSidebarLeft:g("layout-sidebar-left",60403),layoutSidebarRight:g("layout-sidebar-right",60404),layoutStatusbar:g("layout-statusbar",60405),layoutMenubar:g("layout-menubar",60406),layoutCentered:g("layout-centered",60407),target:g("target",60408),indent:g("indent",60409),recordSmall:g("record-small",60410),errorSmall:g("error-small",60411),terminalDecorationError:g("terminal-decoration-error",60411),arrowCircleDown:g("arrow-circle-down",60412),arrowCircleLeft:g("arrow-circle-left",60413),arrowCircleRight:g("arrow-circle-right",60414),arrowCircleUp:g("arrow-circle-up",60415),layoutSidebarRightOff:g("layout-sidebar-right-off",60416),layoutPanelOff:g("layout-panel-off",60417),layoutSidebarLeftOff:g("layout-sidebar-left-off",60418),blank:g("blank",60419),heartFilled:g("heart-filled",60420),map:g("map",60421),mapHorizontal:g("map-horizontal",60421),foldHorizontal:g("fold-horizontal",60421),mapFilled:g("map-filled",60422),mapHorizontalFilled:g("map-horizontal-filled",60422),foldHorizontalFilled:g("fold-horizontal-filled",60422),circleSmall:g("circle-small",60423),bellSlash:g("bell-slash",60424),bellSlashDot:g("bell-slash-dot",60425),commentUnresolved:g("comment-unresolved",60426),gitPullRequestGoToChanges:g("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:g("git-pull-request-new-changes",60428),searchFuzzy:g("search-fuzzy",60429),commentDraft:g("comment-draft",60430),send:g("send",60431),sparkle:g("sparkle",60432),insert:g("insert",60433),mic:g("mic",60434),thumbsdownFilled:g("thumbsdown-filled",60435),thumbsupFilled:g("thumbsup-filled",60436),coffee:g("coffee",60437),snake:g("snake",60438),game:g("game",60439),vr:g("vr",60440),chip:g("chip",60441),piano:g("piano",60442),music:g("music",60443),micFilled:g("mic-filled",60444),repoFetch:g("repo-fetch",60445),copilot:g("copilot",60446),lightbulbSparkle:g("lightbulb-sparkle",60447),robot:g("robot",60448),sparkleFilled:g("sparkle-filled",60449),diffSingle:g("diff-single",60450),diffMultiple:g("diff-multiple",60451),surroundWith:g("surround-with",60452),share:g("share",60453),gitStash:g("git-stash",60454),gitStashApply:g("git-stash-apply",60455),gitStashPop:g("git-stash-pop",60456),vscode:g("vscode",60457),vscodeInsiders:g("vscode-insiders",60458),codeOss:g("code-oss",60459),runCoverage:g("run-coverage",60460),runAllCoverage:g("run-all-coverage",60461),coverage:g("coverage",60462),githubProject:g("github-project",60463),mapVertical:g("map-vertical",60464),foldVertical:g("fold-vertical",60464),mapVerticalFilled:g("map-vertical-filled",60465),foldVerticalFilled:g("fold-vertical-filled",60465),goToSearch:g("go-to-search",60466),percentage:g("percentage",60467),sortPercentage:g("sort-percentage",60467),attach:g("attach",60468)},a7={dialogError:g("dialog-error","error"),dialogWarning:g("dialog-warning","warning"),dialogInfo:g("dialog-info","info"),dialogClose:g("dialog-close","close"),treeItemExpanded:g("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:g("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:g("tree-filter-on-type-off","list-selection"),treeFilterClear:g("tree-filter-clear","close"),treeItemLoading:g("tree-item-loading","loading"),menuSelection:g("menu-selection","check"),menuSubmenu:g("menu-submenu","chevron-right"),menuBarMore:g("menubar-more","more"),scrollbarButtonLeft:g("scrollbar-button-left","triangle-left"),scrollbarButtonRight:g("scrollbar-button-right","triangle-right"),scrollbarButtonUp:g("scrollbar-button-up","triangle-up"),scrollbarButtonDown:g("scrollbar-button-down","triangle-down"),toolBarMore:g("toolbar-more","more"),quickInputBack:g("quick-input-back","arrow-left"),dropDownButton:g("drop-down-button",60084),symbolCustomColor:g("symbol-customcolor",60252),exportIcon:g("export",60332),workspaceUnspecified:g("workspace-unspecified",60355),newLine:g("newline",60394),thumbsDownFilled:g("thumbsdown-filled",60435),thumbsUpFilled:g("thumbsup-filled",60436),gitFetch:g("git-fetch",60445),lightbulbSparkleAutofix:g("lightbulb-sparkle-autofix",60447),debugBreakpointPending:g("debug-breakpoint-pending",60377)},_e={...o7,...a7};var gl;(function(i){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}i.isThemeColor=e})(gl||(gl={}));var Si;(function(i){i.iconNameSegment="[A-Za-z0-9]+",i.iconNameExpression="[A-Za-z0-9-]+",i.iconModifierExpression="~[A-Za-z]+",i.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${i.iconNameExpression})(${i.iconModifierExpression})?$`);function t(f){const p=e.exec(f.id);if(!p)return t(_e.error);const[,b,w]=p,v=["codicon","codicon-"+b];return w&&v.push("codicon-modifier-"+w.substring(1)),v}i.asClassNameArray=t;function n(f){return t(f).join(" ")}i.asClassName=n;function r(f){return"."+t(f).join(".")}i.asCSSSelector=r;function s(f){return f&&typeof f=="object"&&typeof f.id=="string"&&(typeof f.color>"u"||gl.isThemeColor(f.color))}i.isThemeIcon=s;const o=new RegExp(`^\\$\\((${i.iconNameExpression}(?:${i.iconModifierExpression})?)\\)$`);function a(f){const p=o.exec(f);if(!p)return;const[,b]=p;return{id:b}}i.fromString=a;function l(f){return{id:f}}i.fromId=l;function c(f,p){let b=f.id;const w=b.lastIndexOf("~");return w!==-1&&(b=b.substring(0,w)),p&&(b=`${b}~${p}`),{id:b}}i.modify=c;function u(f){const p=f.id.lastIndexOf("~");if(p!==-1)return f.id.substring(p+1)}i.getModifier=u;function d(f,p){var b,w;return f.id===p.id&&((b=f.color)==null?void 0:b.id)===((w=p.color)==null?void 0:w.id)}i.isEqual=d})(Si||(Si={}));const m_=new RegExp(`\\$\\(${Si.iconNameExpression}(?:${Si.iconModifierExpression})?\\)`,"g"),l7=new RegExp(`(\\\\)?${m_.source}`,"g");function c7(i){return i.replace(l7,(e,t)=>t?e:`\\${e}`)}new RegExp(`\\\\${m_.source}`,"g"),new RegExp(`(\\s)?(\\\\)?${m_.source}(\\s)?`,"g"),new RegExp(`\\$\\(${Si.iconNameCharacter}+\\)`,"g");var Of;(function(i){i[i.Paragraph=0]="Paragraph",i[i.Break=1]="Break"})(Of||(Of={}));let g2=class{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw Ue("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=Of.Paragraph){return this.value+=u7(this.supportThemeIcons?c7(e):e).replace(/([ \t]+)/g,(n,r)=>"&nbsp;".repeat(r.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===Of.Break?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${d7(t,e)}
`,this}appendLink(e,t,n){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),n&&(this.value+=` "${this._escape(this._escape(n,'"'),")")}"`),this.value+=")",this}_escape(e,t){const n=new RegExp(wo(t),"g");return e.replace(n,(r,s)=>e.charAt(s-1)!=="\\"?`\\${r}`:r)}};function Io(i){return i instanceof g2?!0:i&&typeof i=="object"?typeof i.value=="string"&&(typeof i.isTrusted=="boolean"||typeof i.isTrusted=="object"||i.isTrusted===void 0)&&(typeof i.supportThemeIcons=="boolean"||i.supportThemeIcons===void 0):!1}function u7(i){return i.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function d7(i,e){var r;const t=((r=i.match(/^`+/gm))==null?void 0:r.reduce((s,o)=>s.length>o.length?s:o).length)??0,n=t>=3?t+1:3;return[`${"`".repeat(n)}${e}`,i,`${"`".repeat(n)}`].join(`
`)}function h7(i){const e=[],t=i.split("|").map(r=>r.trim());i=t[0];const n=t[1];if(n){const r=/height=(\d+)/.exec(n),s=/width=(\d+)/.exec(n),o=r?r[1]:"",a=s?s[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&e.push(`width="${a}"`),c&&e.push(`height="${o}"`)}return{href:i,dimensions:e}}var Po={exports:{}};function m2(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function f7(i){Po.exports.defaults=i}Po.exports={defaults:m2(),getDefaults:m2,changeDefaults:f7};const p7=/[&<>"']/,g7=/[&<>"']/g,m7=/[<>"']|&(?!#?\w+;)/,_7=/[<>"']|&(?!#?\w+;)/g,v7={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_2=i=>v7[i];function w7(i,e){if(e){if(p7.test(i))return i.replace(g7,_2)}else if(m7.test(i))return i.replace(_7,_2);return i}const b7=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function v2(i){return i.replace(b7,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const y7=/(^|[^\[])\^/g;function x7(i,e){i=i.source||i,e=e||"";const t={replace:(n,r)=>(r=r.source||r,r=r.replace(y7,"$1"),i=i.replace(n,r),t),getRegex:()=>new RegExp(i,e)};return t}const E7=/[^\w:]/g,S7=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function D7(i,e,t){if(i){let n;try{n=decodeURIComponent(v2(t)).replace(E7,"").toLowerCase()}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}e&&!S7.test(t)&&(t=w2(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const Ff={},k7=/^[^:]+:\/*[^/]*$/,C7=/^([^:]+:)[\s\S]*$/,I7=/^([^:]+:\/*[^/]*)[\s\S]*$/;function w2(i,e){Ff[" "+i]||(k7.test(i)?Ff[" "+i]=i+"/":Ff[" "+i]=b2(i,"/",!0)),i=Ff[" "+i];const t=i.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:i.replace(C7,"$1")+e:e.charAt(0)==="/"?t?e:i.replace(I7,"$1")+e:i+e}const P7={exec:function(){}};function T7(i){let e=1,t,n;for(;e<arguments.length;e++){t=arguments[e];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i}function A7(i,e){const t=i.replace(/\|/g,(s,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),n=t.split(/ \|/);let r=0;if(n[0].trim()||n.shift(),n[n.length-1].trim()||n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function b2(i,e,t){const n=i.length;if(n===0)return"";let r=0;for(;r<n;){const s=i.charAt(n-r-1);if(s===e&&!t)r++;else if(s!==e&&t)r++;else break}return i.substr(0,n-r)}function R7(i,e){if(i.indexOf(e[1])===-1)return-1;const t=i.length;let n=0,r=0;for(;r<t;r++)if(i[r]==="\\")r++;else if(i[r]===e[0])n++;else if(i[r]===e[1]&&(n--,n<0))return r;return-1}function L7(i){i&&i.sanitize&&!i.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function N7(i,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=i),e>>=1,i+=i;return t+i}var ml={escape:w7,unescape:v2,edit:x7,cleanUrl:D7,resolveUrl:w2,noopTest:P7,merge:T7,splitCells:A7,rtrim:b2,findClosingBracket:R7,checkSanitizeDeprecation:L7,repeatString:N7};const{defaults:O7}=Po.exports,{rtrim:__,splitCells:y2,escape:Sn,findClosingBracket:F7}=ml;function x2(i,e,t,n){const r=e.href,s=e.title?Sn(e.title):null,o=i[1].replace(/\\([\[\]])/g,"$1");if(i[0].charAt(0)!=="!"){n.state.inLink=!0;const a={type:"link",raw:t,href:r,title:s,text:o,tokens:n.inlineTokens(o,[])};return n.state.inLink=!1,a}else return{type:"image",raw:t,href:r,title:s,text:Sn(o)}}function M7(i,e){const t=i.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(r=>{const s=r.match(/^\s+/);if(s===null)return r;const[o]=s;return o.length>=n.length?r.slice(n.length):r}).join(`
`)}var E2=class{constructor(e){this.options=e||O7}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:`
`}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:__(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=M7(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim():t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const s=__(n,"#");(this.options.pedantic||!s||/ $/.test(s))&&(n=s.trim())}const r={type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:[]};return this.lexer.inline(r.text,r.tokens),r}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(n,[]),text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,r,s,o,a,l,c,u,d,f,p=t[1].trim();const b=p.length>1,w={type:"list",raw:"",ordered:b,start:b?+p.slice(0,-1):"",loose:!1,items:[]};p=b?`\\d{1,9}\\${p.slice(-1)}`:`\\${p}`,this.options.pedantic&&(p=b?p:"[*+-]");const v=new RegExp(`^( {0,3}${p})((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);for(;e&&!(this.rules.block.hr.test(e)||!(t=v.exec(e)));){d=t[2].split(`
`),this.options.pedantic?(o=2,f=d[0].trimLeft()):(o=t[2].search(/[^ ]/),o=t[1].length+(o>4?1:o),f=d[0].slice(o-t[1].length)),l=!1,n=t[0],!d[0]&&/^ *$/.test(d[1])&&(n=t[1]+d.slice(0,2).join(`
`)+`
`,w.loose=!0,d=[]);const k=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(a=1;a<d.length;a++){if(u=d[a],this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),k.test(u)){n=t[1]+d.slice(0,a).join(`
`)+`
`;break}if(!l){u.trim()||(l=!0),u.search(/[^ ]/)>=o?f+=`
`+u.slice(o):f+=`
`+u;continue}if(u.search(/[^ ]/)>=o||!u.trim()){f+=`
`+u.slice(o);continue}else{n=t[1]+d.slice(0,a).join(`
`)+`
`;break}}w.loose||(c?w.loose=!0:/\n *\n *$/.test(n)&&(c=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(f),r&&(s=r[0]!=="[ ] ",f=f.replace(/^\[[ xX]\] +/,""))),w.items.push({type:"list_item",raw:n,task:!!r,checked:s,loose:!1,text:f}),w.raw+=n,e=e.slice(n.length)}w.items[w.items.length-1].raw=n.trimRight(),w.items[w.items.length-1].text=f.trimRight(),w.raw=w.raw.trimRight();const S=w.items.length;for(a=0;a<S;a++)this.lexer.state.top=!1,w.items[a].tokens=this.lexer.blockTokens(w.items[a].text,[]),w.items[a].tokens.some(k=>k.type==="space")&&(w.loose=!0,w.items[a].loose=!0);return w}}html(e){const t=this.rules.block.html.exec(e);if(t){const n={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(n.type="paragraph",n.text=this.options.sanitizer?this.options.sanitizer(t[0]):Sn(t[0]),n.tokens=[],this.lexer.inline(n.text,n.tokens)),n}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const n={type:"table",header:y2(t[1]).map(r=>({text:r})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=t[0];let r=n.align.length,s,o,a,l;for(s=0;s<r;s++)/^ *-+: *$/.test(n.align[s])?n.align[s]="right":/^ *:-+: *$/.test(n.align[s])?n.align[s]="center":/^ *:-+ *$/.test(n.align[s])?n.align[s]="left":n.align[s]=null;for(r=n.rows.length,s=0;s<r;s++)n.rows[s]=y2(n.rows[s],n.header.length).map(c=>({text:c}));for(r=n.header.length,o=0;o<r;o++)n.header[o].tokens=[],this.lexer.inlineTokens(n.header[o].text,n.header[o].tokens);for(r=n.rows.length,o=0;o<r;o++)for(l=n.rows[o],a=0;a<l.length;a++)l[a].tokens=[],this.lexer.inlineTokens(l[a].text,l[a].tokens);return n}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const n={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}text(e){const t=this.rules.block.text.exec(e);if(t){const n={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Sn(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):Sn(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const o=__(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{const o=F7(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);o&&(r=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(n)?r=r.slice(1):r=r.slice(1,-1)),x2(t,{href:r&&r.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(/\s+/g," ");if(r=t[r.toLowerCase()],!r||!r.href){const s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return x2(n,r,n[0],this.lexer)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrong.lDelim.exec(e);if(!r||r[3]&&n.match(/[\p{L}\p{N}]/u))return;const s=r[1]||r[2]||"";if(!s||s&&(n===""||this.rules.inline.punctuation.exec(n))){const o=r[0].length-1;let a,l,c=o,u=0;const d=r[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(r=d.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(l=a.length,r[3]||r[4]){c+=l;continue}else if((r[5]||r[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;if(l=Math.min(l,l+c+u),Math.min(o,l)%2){const p=e.slice(1,o+r.index+l);return{type:"em",raw:e.slice(0,o+r.index+l+1),text:p,tokens:this.lexer.inlineTokens(p,[])}}const f=e.slice(2,o+r.index+l-1);return{type:"strong",raw:e.slice(0,o+r.index+l+1),text:f,tokens:this.lexer.inlineTokens(f,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const r=/[^ ]/.test(n),s=/^ /.test(n)&&/ $/.test(n);return r&&s&&(n=n.substring(1,n.length-1)),n=Sn(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let r,s;return n[2]==="@"?(r=Sn(this.options.mangle?t(n[1]):n[1]),s="mailto:"+r):(r=Sn(n[1]),s=r),{type:"link",raw:n[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let r,s;if(n[2]==="@")r=Sn(this.options.mangle?t(n[0]):n[0]),s="mailto:"+r;else{let o;do o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(o!==n[0]);r=Sn(n[0]),n[1]==="www."?s="http://"+r:s=r}return{type:"link",raw:n[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let r;return this.lexer.state.inRawBlock?r=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):Sn(n[0]):n[0]:r=Sn(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:r}}}};const{noopTest:Mf,edit:Rt,merge:To}=ml,Be={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:Mf,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/};Be._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,Be._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,Be.def=Rt(Be.def).replace("label",Be._label).replace("title",Be._title).getRegex(),Be.bullet=/(?:[*+-]|\d{1,9}[.)])/,Be.listItemStart=Rt(/^( *)(bull) */).replace("bull",Be.bullet).getRegex(),Be.list=Rt(Be.list).replace(/bull/g,Be.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Be.def.source+")").getRegex(),Be._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Be._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Be.html=Rt(Be.html,"i").replace("comment",Be._comment).replace("tag",Be._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Be.paragraph=Rt(Be._paragraph).replace("hr",Be.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Be._tag).getRegex(),Be.blockquote=Rt(Be.blockquote).replace("paragraph",Be.paragraph).getRegex(),Be.normal=To({},Be),Be.gfm=To({},Be.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)\\|?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Be.gfm.table=Rt(Be.gfm.table).replace("hr",Be.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Be._tag).getRegex(),Be.pedantic=To({},Be.normal,{html:Rt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Be._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Mf,paragraph:Rt(Be.normal._paragraph).replace("hr",Be.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Be.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const we={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Mf,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Mf,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};we._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",we.punctuation=Rt(we.punctuation).replace(/punctuation/g,we._punctuation).getRegex(),we.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,we.escapedEmSt=/\\\*|\\_/g,we._comment=Rt(Be._comment).replace("(?:-->|$)","-->").getRegex(),we.emStrong.lDelim=Rt(we.emStrong.lDelim).replace(/punct/g,we._punctuation).getRegex(),we.emStrong.rDelimAst=Rt(we.emStrong.rDelimAst,"g").replace(/punct/g,we._punctuation).getRegex(),we.emStrong.rDelimUnd=Rt(we.emStrong.rDelimUnd,"g").replace(/punct/g,we._punctuation).getRegex(),we._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,we._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,we._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,we.autolink=Rt(we.autolink).replace("scheme",we._scheme).replace("email",we._email).getRegex(),we._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,we.tag=Rt(we.tag).replace("comment",we._comment).replace("attribute",we._attribute).getRegex(),we._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,we._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,we._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,we.link=Rt(we.link).replace("label",we._label).replace("href",we._href).replace("title",we._title).getRegex(),we.reflink=Rt(we.reflink).replace("label",we._label).getRegex(),we.reflinkSearch=Rt(we.reflinkSearch,"g").replace("reflink",we.reflink).replace("nolink",we.nolink).getRegex(),we.normal=To({},we),we.pedantic=To({},we.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Rt(/^!?\[(label)\]\((.*?)\)/).replace("label",we._label).getRegex(),reflink:Rt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",we._label).getRegex()}),we.gfm=To({},we.normal,{escape:Rt(we.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),we.gfm.url=Rt(we.gfm.url,"i").replace("email",we.gfm._extended_email).getRegex(),we.breaks=To({},we.gfm,{br:Rt(we.br).replace("{2,}","*").getRegex(),text:Rt(we.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var $7={block:Be,inline:we};const U7=E2,{defaults:H7}=Po.exports,{block:$f,inline:Tu}=$7,{repeatString:S2}=ml;function B7(i){return i.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function D2(i){let e="",t,n;const r=i.length;for(t=0;t<r;t++)n=i.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}var W7=class by{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||H7,this.options.tokenizer=this.options.tokenizer||new U7,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:$f.normal,inline:Tu.normal};this.options.pedantic?(t.block=$f.pedantic,t.inline=Tu.pedantic):this.options.gfm&&(t.block=$f.gfm,this.options.breaks?t.inline=Tu.breaks:t.inline=Tu.gfm),this.tokenizer.rules=t}static get rules(){return{block:$f,inline:Tu}}static lex(e,t){return new by(t).lex(e)}static lexInline(e,t){return new by(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic&&(e=e.replace(/^ +$/gm,""));let n,r,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.type&&t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(function(u){c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(s))){r=t[t.length-1],o&&r.type==="paragraph"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),o=s.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let n,r,s,o=e,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+S2("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+S2("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(n=u.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,o,c)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e,D2)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,D2))){e=e.substring(n.raw.length),t.push(n);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let f;this.options.extensions.startInline.forEach(function(p){f=p.call({lexer:this},d),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(n=this.tokenizer.inlineText(s,B7)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(c=n.raw.slice(-1)),l=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}};const{defaults:V7}=Po.exports,{cleanUrl:k2,escape:Uf}=ml;var C2=class{constructor(e){this.options=e||V7}code(e,t,n){const r=(t||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(e,r);s!=null&&s!==e&&(n=!0,e=s)}return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="'+this.options.langPrefix+Uf(r,!0)+'">'+(n?e:Uf(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:Uf(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,n,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(n)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,n){const r=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+e+"</"+r+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,n){if(e=k2(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let r='<a href="'+Uf(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>",r}image(e,t,n){if(e=k2(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">",r}text(e){return e}},I2=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}},P2=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[e];do r++,n=e+"-"+r;while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=r,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}};const z7=C2,q7=I2,j7=P2,{defaults:G7}=Po.exports,{unescape:Q7}=ml;var J7=class yy{constructor(e){this.options=e||G7,this.options.renderer=this.options.renderer||new z7,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new q7,this.slugger=new j7}static parse(e,t){return new yy(t).parse(e)}static parseInline(e,t){return new yy(t).parseInline(e)}parse(e,t=!0){let n="",r,s,o,a,l,c,u,d,f,p,b,w,v,S,k,C,N,A,V;const ae=e.length;for(r=0;r<ae;r++){if(p=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[p.type]&&(V=this.options.extensions.renderers[p.type].call({parser:this},p),V!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(p.type))){n+=V||"";continue}switch(p.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(p.tokens),p.depth,Q7(this.parseInline(p.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(p.text,p.lang,p.escaped);continue}case"table":{for(d="",u="",a=p.header.length,s=0;s<a;s++)u+=this.renderer.tablecell(this.parseInline(p.header[s].tokens),{header:!0,align:p.align[s]});for(d+=this.renderer.tablerow(u),f="",a=p.rows.length,s=0;s<a;s++){for(c=p.rows[s],u="",l=c.length,o=0;o<l;o++)u+=this.renderer.tablecell(this.parseInline(c[o].tokens),{header:!1,align:p.align[o]});f+=this.renderer.tablerow(u)}n+=this.renderer.table(d,f);continue}case"blockquote":{f=this.parse(p.tokens),n+=this.renderer.blockquote(f);continue}case"list":{for(b=p.ordered,w=p.start,v=p.loose,a=p.items.length,f="",s=0;s<a;s++)k=p.items[s],C=k.checked,N=k.task,S="",k.task&&(A=this.renderer.checkbox(C),v?k.tokens.length>0&&k.tokens[0].type==="paragraph"?(k.tokens[0].text=A+" "+k.tokens[0].text,k.tokens[0].tokens&&k.tokens[0].tokens.length>0&&k.tokens[0].tokens[0].type==="text"&&(k.tokens[0].tokens[0].text=A+" "+k.tokens[0].tokens[0].text)):k.tokens.unshift({type:"text",text:A}):S+=A),S+=this.parse(k.tokens,v),f+=this.renderer.listitem(S,N,C);n+=this.renderer.list(f,b,w);continue}case"html":{n+=this.renderer.html(p.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(p.tokens));continue}case"text":{for(f=p.tokens?this.parseInline(p.tokens):p.text;r+1<ae&&e[r+1].type==="text";)p=e[++r],f+=`
`+(p.tokens?this.parseInline(p.tokens):p.text);n+=t?this.renderer.paragraph(f):f;continue}default:{const be='Token with "'+p.type+'" type was not found.';if(this.options.silent){console.error(be);return}else throw new Error(be)}}}return n}parseInline(e,t){t=t||this.renderer;let n="",r,s,o;const a=e.length;for(r=0;r<a;r++){if(s=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(o=this.options.extensions.renderers[s.type].call({parser:this},s),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){n+=o||"";continue}switch(s.type){case"escape":{n+=t.text(s.text);break}case"html":{n+=t.html(s.text);break}case"link":{n+=t.link(s.href,s.title,this.parseInline(s.tokens,t));break}case"image":{n+=t.image(s.href,s.title,s.text);break}case"strong":{n+=t.strong(this.parseInline(s.tokens,t));break}case"em":{n+=t.em(this.parseInline(s.tokens,t));break}case"codespan":{n+=t.codespan(s.text);break}case"br":{n+=t.br();break}case"del":{n+=t.del(this.parseInline(s.tokens,t));break}case"text":{n+=t.text(s.text);break}default:{const l='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return n}};const Au=W7,Ru=J7,T2=E2,A2=C2,X7=I2,Y7=P2,{merge:Hf,checkSanitizeDeprecation:R2,escape:L2}=ml,{getDefaults:K7,changeDefaults:Z7,defaults:e9}=Po.exports;function qe(i,e,t){if(typeof i>"u"||i===null)throw new Error("marked(): input parameter is undefined or null");if(typeof i!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected");if(typeof e=="function"&&(t=e,e=null),e=Hf({},qe.defaults,e||{}),R2(e),t){const n=e.highlight;let r;try{r=Au.lex(i,e)}catch(a){return t(a)}const s=function(a){let l;if(!a)try{e.walkTokens&&qe.walkTokens(r,e.walkTokens),l=Ru.parse(r,e)}catch(c){a=c}return e.highlight=n,a?t(a):t(null,l)};if(!n||n.length<3||(delete e.highlight,!r.length))return s();let o=0;qe.walkTokens(r,function(a){a.type==="code"&&(o++,setTimeout(()=>{n(a.text,a.lang,function(l,c){if(l)return s(l);c!=null&&c!==a.text&&(a.text=c,a.escaped=!0),o--,o===0&&s()})},0))}),o===0&&s();return}try{const n=Au.lex(i,e);return e.walkTokens&&qe.walkTokens(n,e.walkTokens),Ru.parse(n,e)}catch(n){if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+L2(n.message+"",!0)+"</pre>";throw n}}qe.options=qe.setOptions=function(i){return Hf(qe.defaults,i),Z7(qe.defaults),qe},qe.getDefaults=K7,qe.defaults=e9,qe.use=function(...i){const e=Hf({},...i),t=qe.defaults.extensions||{renderers:{},childTokens:{}};let n;i.forEach(r=>{if(r.extensions&&(n=!0,r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const o=t.renderers?t.renderers[s.name]:null;o?t.renderers[s.name]=function(...a){let l=s.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:t.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[s.level]?t[s.level].unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}s.childTokens&&(t.childTokens[s.name]=s.childTokens)})),r.renderer){const s=qe.defaults.renderer||new A2;for(const o in r.renderer){const a=s[o];s[o]=(...l)=>{let c=r.renderer[o].apply(s,l);return c===!1&&(c=a.apply(s,l)),c}}e.renderer=s}if(r.tokenizer){const s=qe.defaults.tokenizer||new T2;for(const o in r.tokenizer){const a=s[o];s[o]=(...l)=>{let c=r.tokenizer[o].apply(s,l);return c===!1&&(c=a.apply(s,l)),c}}e.tokenizer=s}if(r.walkTokens){const s=qe.defaults.walkTokens;e.walkTokens=o=>{r.walkTokens.call(this,o),s&&s(o)}}n&&(e.extensions=t),qe.setOptions(e)})},qe.walkTokens=function(i,e){for(const t of i)switch(e(t),t.type){case"table":{for(const n of t.header)qe.walkTokens(n.tokens,e);for(const n of t.rows)for(const r of n)qe.walkTokens(r.tokens,e);break}case"list":{qe.walkTokens(t.items,e);break}default:qe.defaults.extensions&&qe.defaults.extensions.childTokens&&qe.defaults.extensions.childTokens[t.type]?qe.defaults.extensions.childTokens[t.type].forEach(function(n){qe.walkTokens(t[n],e)}):t.tokens&&qe.walkTokens(t.tokens,e)}},qe.parseInline=function(i,e){if(typeof i>"u"||i===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof i!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected");e=Hf({},qe.defaults,e||{}),R2(e);try{const t=Au.lexInline(i,e);return e.walkTokens&&qe.walkTokens(t,e.walkTokens),Ru.parseInline(t,e)}catch(t){if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+L2(t.message+"",!0)+"</pre>";throw t}},qe.Parser=Ru,qe.parser=Ru.parse,qe.Renderer=A2,qe.TextRenderer=X7,qe.Lexer=Au,qe.lexer=Au.lex,qe.Tokenizer=T2,qe.Slugger=Y7,qe.parse=qe;var N2=qe;function t9(i){return JSON.stringify(i,i9)}function O2(i){let e=JSON.parse(i);return e=Ki(e),e}function i9(i,e){return e instanceof RegExp?{$mid:mt.Regexp,source:e.source,flags:e.flags}:e}function Ki(i,e=0){if(!i||e>200)return i;if(typeof i=="object"){switch(i.$mid){case mt.Uri:return y.revive(i);case mt.Regexp:return new RegExp(i.source,i.flags);case mt.Date:return new Date(i.source)}if(i instanceof De||i instanceof Uint8Array)return i;if(Array.isArray(i))for(let t=0;t<i.length;++t)i[t]=Ki(i[t],e+1);else for(const t in i)Object.hasOwnProperty.call(i,t)&&(i[t]=Ki(i[t],e+1))}return i}const Mr=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),n9=/^(.+)\/(.+?)(;.+)?$/;function F2(i,e){const t=n9.exec(i);return t?`${t[1].toLowerCase()}/${t[2].toLowerCase()}${t[3]??""}`:e?void 0:i}const Hi=Symbol("unset");class r9{constructor(){this.root=new v_,this._size=0}get size(){return this._size}get nodes(){var e;return((e=this.root.children)==null?void 0:e.values())||yn.empty()}get entries(){var e;return((e=this.root.children)==null?void 0:e.entries())||yn.empty()}insert(e,t,n){this.opNode(e,r=>r._value=t,n)}mutate(e,t){this.opNode(e,n=>n._value=t(n._value===Hi?void 0:n._value))}mutatePath(e,t){this.opNode(e,()=>{},n=>t(n))}delete(e){var s;const t=this.getPathToKey(e);if(!t)return;let n=t.length-1;const r=t[n].node._value;if(r!==Hi){for(this._size--,t[n].node._value=Hi;n>0;n--){const{node:o,part:a}=t[n];if((s=o.children)!=null&&s.size||o._value!==Hi)break;t[n-1].node.children.delete(a)}return r}}*deleteRecursive(e){const t=this.getPathToKey(e);if(!t)return;const n=t[t.length-1].node;for(let r=t.length-1;r>0;r--){const s=t[r-1];if(s.node.children.delete(t[r].part),s.node.children.size>0||s.node._value!==Hi)break}for(const r of M2(n))r._value!==Hi&&(this._size--,yield r._value)}find(e){var n;let t=this.root;for(const r of e){const s=(n=t.children)==null?void 0:n.get(r);if(!s)return;t=s}return t._value===Hi?void 0:t._value}hasKeyOrParent(e){var n;let t=this.root;for(const r of e){const s=(n=t.children)==null?void 0:n.get(r);if(!s)return!1;if(s._value!==Hi)return!0;t=s}return!1}hasKeyOrChildren(e){var n;let t=this.root;for(const r of e){const s=(n=t.children)==null?void 0:n.get(r);if(!s)return!1;t=s}return!0}hasKey(e){var n;let t=this.root;for(const r of e){const s=(n=t.children)==null?void 0:n.get(r);if(!s)return!1;t=s}return t._value!==Hi}getPathToKey(e){var r;const t=[{part:"",node:this.root}];let n=0;for(const s of e){const o=(r=t[n].node.children)==null?void 0:r.get(s);if(!o)return;t.push({part:s,node:o}),n++}return t}opNode(e,t,n){let r=this.root;for(const a of e){if(r.children)if(r.children.has(a))r=r.children.get(a);else{const l=new v_;r.children.set(a,l),r=l}else{const l=new v_;r.children=new Map([[a,l]]),r=l}n==null||n(r)}const s=r._value===Hi?0:1;t(r);const o=r._value===Hi?0:1;this._size+=o-s}*values(){for(const{_value:e}of M2(this.root))e!==Hi&&(yield e)}}function*M2(i){const e=[i];for(;e.length>0;){const t=e.pop();if(yield t,t.children)for(const n of t.children.values())e.push(n)}}class v_{constructor(){this._value=Hi}get value(){return this._value===Hi?void 0:this._value}set value(e){this._value=e===void 0?Hi:e}}var Ao;(function(i){i[i.Auto=1]="Auto",i[i.Hidden=2]="Hidden",i[i.Visible=3]="Visible"})(Ao||(Ao={}));const $2={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},U2="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function s9(i=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of U2)i.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const o9=s9();function H2(i){let e=o9;if(i&&i instanceof RegExp)if(i.global)e=i;else{let t="g";i.ignoreCase&&(t+="i"),i.multiline&&(t+="m"),i.unicode&&(t+="u"),e=new RegExp(i.source,t)}return e.lastIndex=0,e}const B2=new hu;B2.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function W2(i,e,t,n,r){if(e=H2(e),r||(r=yn.first(B2)),t.length>r.maxLen){let c=i-r.maxLen/2;return c<0?c=0:n+=c,t=t.substring(c,i+r.maxLen/2),W2(i,e,t,n,r)}const s=Date.now(),o=i-1-n;let a=-1,l=null;for(let c=1;!(Date.now()-s>=r.timeBudget);c++){const u=o-r.windowSize*c;e.lastIndex=Math.max(0,u);const d=a9(e,t,o,a);if(!d&&l||(l=d,u<=0))break;a=u}if(l){const c={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function a9(i,e,t,n){let r;for(;r=i.exec(e);){const s=r.index||0;if(s<=t&&i.lastIndex>=t)return r;if(n>0&&s>n)return null}return null}var Y;(function(i){i[i.LParen=0]="LParen",i[i.RParen=1]="RParen",i[i.Neg=2]="Neg",i[i.Eq=3]="Eq",i[i.NotEq=4]="NotEq",i[i.Lt=5]="Lt",i[i.LtEq=6]="LtEq",i[i.Gt=7]="Gt",i[i.GtEq=8]="GtEq",i[i.RegexOp=9]="RegexOp",i[i.RegexStr=10]="RegexStr",i[i.True=11]="True",i[i.False=12]="False",i[i.In=13]="In",i[i.Not=14]="Not",i[i.And=15]="And",i[i.Or=16]="Or",i[i.Str=17]="Str",i[i.QuotedStr=18]="QuotedStr",i[i.Error=19]="Error",i[i.EOF=20]="EOF"})(Y||(Y={}));function w_(...i){switch(i.length){case 1:return h(1928,"Did you mean {0}?",i[0]);case 2:return h(1929,"Did you mean {0} or {1}?",i[0],i[1]);case 3:return h(1930,"Did you mean {0}, {1} or {2}?",i[0],i[1],i[2]);default:return}}const l9=h(1931,"Did you forget to open or close the quote?"),c9=h(1932,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),Rc=class Rc{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case Y.LParen:return"(";case Y.RParen:return")";case Y.Neg:return"!";case Y.Eq:return e.isTripleEq?"===":"==";case Y.NotEq:return e.isTripleEq?"!==":"!=";case Y.Lt:return"<";case Y.LtEq:return"<=";case Y.Gt:return">=";case Y.GtEq:return">=";case Y.RegexOp:return"=~";case Y.RegexStr:return e.lexeme;case Y.True:return"true";case Y.False:return"false";case Y.In:return"in";case Y.Not:return"not";case Y.And:return"&&";case Y.Or:return"||";case Y.Str:return e.lexeme;case Y.QuotedStr:return e.lexeme;case Y.Error:return e.lexeme;case Y.EOF:return"EOF";default:throw k1(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case P.OpenParen:this._addToken(Y.LParen);break;case P.CloseParen:this._addToken(Y.RParen);break;case P.ExclamationMark:if(this._match(P.Equals)){const t=this._match(P.Equals);this._tokens.push({type:Y.NotEq,offset:this._start,isTripleEq:t})}else this._addToken(Y.Neg);break;case P.SingleQuote:this._quotedString();break;case P.Slash:this._regex();break;case P.Equals:if(this._match(P.Equals)){const t=this._match(P.Equals);this._tokens.push({type:Y.Eq,offset:this._start,isTripleEq:t})}else this._match(P.Tilde)?this._addToken(Y.RegexOp):this._error(w_("==","=~"));break;case P.LessThan:this._addToken(this._match(P.Equals)?Y.LtEq:Y.Lt);break;case P.GreaterThan:this._addToken(this._match(P.Equals)?Y.GtEq:Y.Gt);break;case P.Ampersand:this._match(P.Ampersand)?this._addToken(Y.And):this._error(w_("&&"));break;case P.Pipe:this._match(P.Pipe)?this._addToken(Y.Or):this._error(w_("||"));break;case P.Space:case P.CarriageReturn:case P.Tab:case P.LineFeed:case P.NoBreakSpace:break;default:this._string()}return this._start=this._current,this._addToken(Y.EOF),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?P.Null:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,n=this._input.substring(this._start,this._current),r={type:Y.Error,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(r)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),n=Rc._keywords.get(t);n?this._addToken(n):this._tokens.push({type:Y.Str,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==P.SingleQuote&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(l9);return}this._advance(),this._tokens.push({type:Y.QuotedStr,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,n=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(c9);return}const s=this._input.charCodeAt(e);if(t)t=!1;else if(s===P.Slash&&!n){e++;break}else s===P.OpenSquareBracket?n=!0:s===P.Backslash?t=!0:s===P.CloseSquareBracket&&(n=!1);e++}for(;e<this._input.length&&Rc._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const r=this._input.substring(this._start,this._current);this._tokens.push({type:Y.RegexStr,lexeme:r,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};Rc._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),Rc._keywords=new Map([["not",Y.Not],["in",Y.In],["false",Y.False],["true",Y.True]]);let Ro=Rc;const ui=new Map;ui.set("false",!1),ui.set("true",!0),ui.set("isMac",Rn),ui.set("isLinux",ws),ui.set("isWindows",cn),ui.set("isWeb",H1),ui.set("isMacNative",Rn&&!H1),ui.set("isEdge",mC),ui.set("isFirefox",pC),ui.set("isChrome",Xy),ui.set("isSafari",gC);const u9=Object.prototype.hasOwnProperty;var Ct;(function(i){i[i.False=0]="False",i[i.True=1]="True",i[i.Defined=2]="Defined",i[i.Not=3]="Not",i[i.Equals=4]="Equals",i[i.NotEquals=5]="NotEquals",i[i.And=6]="And",i[i.Regex=7]="Regex",i[i.NotRegex=8]="NotRegex",i[i.Or=9]="Or",i[i.In=10]="In",i[i.NotIn=11]="NotIn",i[i.Greater=12]="Greater",i[i.GreaterEquals=13]="GreaterEquals",i[i.Smaller=14]="Smaller",i[i.SmallerEquals=15]="SmallerEquals"})(Ct||(Ct={}));const d9={regexParsingWithErrorRecovery:!0},h9=h(556,"Empty context key expression"),f9=h(557,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),p9=h(558,"'in' after 'not'."),V2=h(559,"closing parenthesis ')'"),g9=h(560,"Unexpected token"),m9=h(561,"Did you forget to put && or || before the token?"),_9=h(562,"Unexpected end of expression"),v9=h(563,"Did you forget to put a context key?"),Ea=class Ea{get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=d9){this._config=e,this._scanner=new Ro,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:h9,offset:0,lexeme:"",additionalInfo:f9});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const n=this._peek(),r=n.type===Y.Str?m9:void 0;throw this._parsingErrors.push({message:g9,offset:n.offset,lexeme:Ro.getLexeme(n),additionalInfo:r}),Ea._parseError}return t}catch(t){if(t!==Ea._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(Y.Or);){const t=this._and();e.push(t)}return e.length===1?e[0]:Xt.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(Y.And);){const t=this._term();e.push(t)}return e.length===1?e[0]:Xt.and(...e)}_term(){if(this._matchOne(Y.Neg)){const e=this._peek();switch(e.type){case Y.True:return this._advance(),Di.INSTANCE;case Y.False:return this._advance(),Ni.INSTANCE;case Y.LParen:{this._advance();const t=this._expr();return this._consume(Y.RParen,V2),t==null?void 0:t.negate()}case Y.Str:return this._advance(),No.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case Y.True:return this._advance(),Xt.true();case Y.False:return this._advance(),Xt.false();case Y.LParen:{this._advance();const t=this._expr();return this._consume(Y.RParen,V2),t}case Y.Str:{const t=e.lexeme;if(this._advance(),this._matchOne(Y.RegexOp)){const r=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),r.type!==Y.RegexStr)throw this._errExpectedButGot("REGEX",r);const s=r.lexeme,o=s.lastIndexOf("/"),a=o===s.length-1?void 0:this._removeFlagsGY(s.substring(o+1));let l;try{l=new RegExp(s.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",r)}return Hu.create(t,l)}switch(r.type){case Y.RegexStr:case Y.Error:{const s=[r.lexeme];this._advance();let o=this._peek(),a=0;for(let f=0;f<r.lexeme.length;f++)r.lexeme.charCodeAt(f)===P.OpenParen?a++:r.lexeme.charCodeAt(f)===P.CloseParen&&a--;for(;!this._isAtEnd()&&o.type!==Y.And&&o.type!==Y.Or;){switch(o.type){case Y.LParen:a++;break;case Y.RParen:a--;break;case Y.RegexStr:case Y.QuotedStr:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===P.OpenParen?a++:r.lexeme.charCodeAt(f)===P.CloseParen&&a--}if(a<0)break;s.push(Ro.getLexeme(o)),this._advance(),o=this._peek()}const l=s.join(""),c=l.lastIndexOf("/"),u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let d;try{d=new RegExp(l.substring(1,c),u)}catch{throw this._errExpectedButGot("REGEX",r)}return Xt.regex(t,d)}case Y.QuotedStr:{const s=r.lexeme;this._advance();let o=null;if(!yu(s)){const a=s.indexOf("/"),l=s.lastIndexOf("/");if(a!==l&&a>=0){const c=s.slice(a+1,l),u=s[l+1]==="i"?"i":"";try{o=new RegExp(c,u)}catch{throw this._errExpectedButGot("REGEX",r)}}}if(o===null)throw this._errExpectedButGot("REGEX",r);return Hu.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(Y.Not)){this._consume(Y.In,p9);const r=this._value();return Xt.notIn(t,r)}switch(this._peek().type){case Y.Eq:{this._advance();const r=this._value();if(this._previous().type===Y.QuotedStr)return Xt.equals(t,r);switch(r){case"true":return Xt.has(t);case"false":return Xt.not(t);default:return Xt.equals(t,r)}}case Y.NotEq:{this._advance();const r=this._value();if(this._previous().type===Y.QuotedStr)return Xt.notEquals(t,r);switch(r){case"true":return Xt.not(t);case"false":return Xt.has(t);default:return Xt.notEquals(t,r)}}case Y.Lt:return this._advance(),$u.create(t,this._value());case Y.LtEq:return this._advance(),Uu.create(t,this._value());case Y.Gt:return this._advance(),Fu.create(t,this._value());case Y.GtEq:return this._advance(),Mu.create(t,this._value());case Y.In:return this._advance(),Xt.in(t,this._value());default:return Xt.has(t)}}case Y.EOF:throw this._parsingErrors.push({message:_9,offset:e.offset,lexeme:"",additionalInfo:v9}),Ea._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case Y.Str:case Y.QuotedStr:return this._advance(),e.lexeme;case Y.True:return this._advance(),"true";case Y.False:return this._advance(),"false";case Y.In:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){const r=h(564,`Expected: {0}
Received: '{1}'.`,e,Ro.getLexeme(t)),s=t.offset,o=Ro.getLexeme(t);return this._parsingErrors.push({message:r,offset:s,lexeme:o,additionalInfo:n}),Ea._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===Y.EOF}};Ea._parseError=new Error;let Bf=Ea;const K0=class K0{static false(){return Di.INSTANCE}static true(){return Ni.INSTANCE}static has(e){return Lo.create(e)}static equals(e,t){return Nu.create(e,t)}static notEquals(e,t){return Ou.create(e,t)}static regex(e,t){return Hu.create(e,t)}static in(e,t){return Wf.create(e,t)}static notIn(e,t){return Vf.create(e,t)}static not(e){return No.create(e)}static and(...e){return Ps.create(e,null,!0)}static or(...e){return lr.create(e,null,!0)}static greater(e,t){return Fu.create(e,t)}static greaterEquals(e,t){return Mu.create(e,t)}static smaller(e,t){return $u.create(e,t)}static smallerEquals(e,t){return Uu.create(e,t)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};K0._parser=new Bf({regexParsingWithErrorRecovery:!1});let Xt=K0;function w9(i){const e=new Bf({regexParsingWithErrorRecovery:!1});return i.map(t=>(e.parse(t),e.lexingErrors.length>0?e.lexingErrors.map(n=>({errorMessage:n.additionalInfo?h(565,"Unexpected token. Hint: {0}",n.additionalInfo):h(566,"Unexpected token."),offset:n.offset,length:n.lexeme.length})):e.parsingErrors.length>0?e.parsingErrors.map(n=>({errorMessage:n.additionalInfo?`${n.message}. ${n.additionalInfo}`:n.message,offset:n.offset,length:n.lexeme.length})):[]))}function Lu(i,e){return i.cmp(e)}const jm=class jm{constructor(){this.type=Ct.False}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return Ni.INSTANCE}};jm.INSTANCE=new jm;let Di=jm;const Gm=class Gm{constructor(){this.type=Ct.True}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Di.INSTANCE}};Gm.INSTANCE=new Gm;let Ni=Gm;class Lo{static create(e,t=null){const n=ui.get(e);return typeof n=="boolean"?n?Ni.INSTANCE:Di.INSTANCE:new Lo(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=Ct.Defined}cmp(e){return e.type!==this.type?this.type-e.type:q2(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=ui.get(this.key);return typeof e=="boolean"?e?Ni.INSTANCE:Di.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=No.create(this.key,this)),this.negated}}class Nu{static create(e,t,n=null){if(typeof t=="boolean")return t?Lo.create(e,n):No.create(e,n);const r=ui.get(e);return typeof r=="boolean"?t===(r?"true":"false")?Ni.INSTANCE:Di.INSTANCE:new Nu(e,t,n)}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=Ct.Equals}cmp(e){return e.type!==this.type?this.type-e.type:Oo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=ui.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Ni.INSTANCE:Di.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Ou.create(this.key,this.value,this)),this.negated}}class Wf{static create(e,t){return new Wf(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=Ct.In,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:Oo(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n=="string"&&typeof t=="object"&&t!==null?u9.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=Vf.create(this.key,this.valueKey)),this.negated}}class Vf{static create(e,t){return new Vf(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=Ct.NotIn,this._negated=Wf.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class Ou{static create(e,t,n=null){if(typeof t=="boolean")return t?No.create(e,n):Lo.create(e,n);const r=ui.get(e);return typeof r=="boolean"?t===(r?"true":"false")?Di.INSTANCE:Ni.INSTANCE:new Ou(e,t,n)}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=Ct.NotEquals}cmp(e){return e.type!==this.type?this.type-e.type:Oo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=ui.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Di.INSTANCE:Ni.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Nu.create(this.key,this.value,this)),this.negated}}class No{static create(e,t=null){const n=ui.get(e);return typeof n=="boolean"?n?Di.INSTANCE:Ni.INSTANCE:new No(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=Ct.Not}cmp(e){return e.type!==this.type?this.type-e.type:q2(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=ui.get(this.key);return typeof e=="boolean"?e?Di.INSTANCE:Ni.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Lo.create(this.key,this)),this.negated}}function zf(i,e){if(typeof i=="string"){const t=parseFloat(i);isNaN(t)||(i=t)}return typeof i=="string"||typeof i=="number"?e(i):Di.INSTANCE}class Fu{static create(e,t,n=null){return zf(t,r=>new Fu(e,r,n))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=Ct.Greater}cmp(e){return e.type!==this.type?this.type-e.type:Oo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=Uu.create(this.key,this.value,this)),this.negated}}class Mu{static create(e,t,n=null){return zf(t,r=>new Mu(e,r,n))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=Ct.GreaterEquals}cmp(e){return e.type!==this.type?this.type-e.type:Oo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=$u.create(this.key,this.value,this)),this.negated}}class $u{static create(e,t,n=null){return zf(t,r=>new $u(e,r,n))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=Ct.Smaller}cmp(e){return e.type!==this.type?this.type-e.type:Oo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Mu.create(this.key,this.value,this)),this.negated}}class Uu{static create(e,t,n=null){return zf(t,r=>new Uu(e,r,n))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=Ct.SmallerEquals}cmp(e){return e.type!==this.type?this.type-e.type:Oo(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Fu.create(this.key,this.value,this)),this.negated}}class Hu{static create(e,t){return new Hu(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=Ct.Regex,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=qf.create(this)),this.negated}}class qf{static create(e){return new qf(e)}constructor(e){this._actual=e,this.type=Ct.NotRegex}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new qf(this._actual.map(e))}negate(){return this._actual}}function z2(i){let e=null;for(let t=0,n=i.length;t<n;t++){const r=i[t].substituteConstants();if(i[t]!==r&&e===null){e=[];for(let s=0;s<t;s++)e[s]=i[s]}e!==null&&(e[t]=r)}return e===null?i:e}class Ps{static create(e,t,n){return Ps._normalizeArr(e,t,n)}constructor(e,t){this.expr=e,this.negated=t,this.type=Ct.And}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){const r=Lu(this.expr[t],e.expr[t]);if(r!==0)return r}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=z2(this.expr);return e===this.expr?this:Ps.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,n){const r=[];let s=!1;for(const o of e)if(o){if(o.type===Ct.True){s=!0;continue}if(o.type===Ct.False)return Di.INSTANCE;if(o.type===Ct.And){r.push(...o.expr);continue}r.push(o)}if(r.length===0&&s)return Ni.INSTANCE;if(r.length!==0){if(r.length===1)return r[0];r.sort(Lu);for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];for(;r.length>1;){const o=r[r.length-1];if(o.type!==Ct.Or)break;r.pop();const a=r.pop(),l=r.length===0,c=lr.create(o.expr.map(u=>Ps.create([u,a],null,n)),null,l);c&&(r.push(c),r.sort(Lu))}if(r.length===1)return r[0];if(n){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return Di.INSTANCE;if(r.length===1)return r[0]}return new Ps(r,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new Ps(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=lr.create(e,this,!0)}return this.negated}}class lr{static create(e,t,n){return lr._normalizeArr(e,t,n)}constructor(e,t){this.expr=e,this.negated=t,this.type=Ct.Or}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){const r=Lu(this.expr[t],e.expr[t]);if(r!==0)return r}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=z2(this.expr);return e===this.expr?this:lr.create(e,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,n){let r=[],s=!1;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l){if(l.type===Ct.False){s=!0;continue}if(l.type===Ct.True)return Ni.INSTANCE;if(l.type===Ct.Or){r=r.concat(l.expr);continue}r.push(l)}}if(r.length===0&&s)return Di.INSTANCE;r.sort(Lu)}if(r.length!==0){if(r.length===1)return r[0];for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];if(n){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return Ni.INSTANCE;if(r.length===1)return r[0]}return new lr(r,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new lr(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),n=e.shift(),r=[];for(const s of j2(t))for(const o of j2(n))r.push(Ps.create([s,o],null,!1));e.unshift(lr.create(r,null,!1))}this.negated=lr.create(e,this,!0)}return this.negated}}const Lc=class Lc extends Lo{static all(){return Lc._info.values()}constructor(e,t,n){super(e,null),this._defaultValue=t,typeof n=="object"?Lc._info.push({...n,key:e}):n!==!0&&Lc._info.push({key:e,description:n,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return Nu.create(this.key,e)}notEqualsTo(e){return Ou.create(this.key,e)}};Lc._info=[];let X=Lc;function q2(i,e){return i<e?-1:i>e?1:0}function Oo(i,e,t,n){return i<t?-1:i>t?1:e<n?-1:e>n?1:0}function j2(i){return i.type===Ct.Or?i.expr:[i]}var $r;(function(i){i[i.Unknown=0]="Unknown",i[i.Disabled=1]="Disabled",i[i.Enabled=2]="Enabled"})($r||($r={})),new X("accessibilityModeEnabled",!1);var Ts;(function(i){i[i.None=0]="None",i[i.Keep=1]="Keep",i[i.Brackets=2]="Brackets",i[i.Advanced=3]="Advanced",i[i.Full=4]="Full"})(Ts||(Ts={}));const b9=8;class y9{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class st{constructor(e,t,n,r){this.id=e,this.name=t,this.defaultValue=n,this.schema=r}applyUpdate(e,t){return Gf(e,t)}compute(e,t,n){return n}}class jf{constructor(e,t){this.newValue=e,this.didChange=t}}function Gf(i,e){if(typeof i!="object"||typeof e!="object"||!i||!e)return new jf(e,i!==e);if(Array.isArray(i)||Array.isArray(e)){const n=Array.isArray(i)&&Array.isArray(e)&&Tr(i,e);return new jf(e,!n)}let t=!1;for(const n in e)if(e.hasOwnProperty(n)){const r=Gf(i[n],e[n]);r.didChange&&(i[n]=r.newValue,t=!0)}return new jf(i,t)}class Bu{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return Gf(e,t)}validate(e){return this.defaultValue}}class _l{constructor(e,t,n,r){this.id=e,this.name=t,this.defaultValue=n,this.schema=r}applyUpdate(e,t){return Gf(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,n){return n}}function ie(i,e){return typeof i>"u"?e:i==="false"?!1:!!i}class Te extends _l{constructor(e,t,n,r=void 0){typeof r<"u"&&(r.type="boolean",r.default=n),super(e,t,n,r)}validate(e){return ie(e,this.defaultValue)}}function x9(i,e,t,n){if(typeof i>"u")return e;let r=parseInt(i,10);return isNaN(r)?e:(r=Math.max(t,r),r=Math.min(n,r),r|0)}class Ke extends _l{static clampedInt(e,t,n,r){return x9(e,t,n,r)}constructor(e,t,n,r,s,o=void 0){typeof o<"u"&&(o.type="integer",o.default=n,o.minimum=r,o.maximum=s),super(e,t,n,o),this.minimum=r,this.maximum=s}validate(e){return Ke.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class Dn extends _l{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const n=parseFloat(e);return isNaN(n)?t:n}constructor(e,t,n,r,s){typeof s<"u"&&(s.type="number",s.default=n),super(e,t,n,s),this.validationFn=r}validate(e){return this.validationFn(Dn.float(e,this.defaultValue))}}class vi extends _l{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,n,r=void 0){typeof r<"u"&&(r.type="string",r.default=n),super(e,t,n,r)}validate(e){return vi.string(e,this.defaultValue)}}function vt(i,e,t,n){return typeof i!="string"?e:n&&i in n?n[i]:t.indexOf(i)===-1?e:i}class ht extends _l{constructor(e,t,n,r,s=void 0){typeof s<"u"&&(s.type="string",s.enum=r,s.default=n),super(e,t,n,s),this._allowedValues=r}validate(e){return vt(e,this.defaultValue,this._allowedValues)}}class Qf extends st{constructor(e,t,n,r,s,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=s,a.default=r),super(e,t,n,a),this._allowedValues=s,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function E9(i){switch(i){case"none":return Ts.None;case"keep":return Ts.Keep;case"brackets":return Ts.Brackets;case"advanced":return Ts.Advanced;case"full":return Ts.Full}}class S9 extends st{constructor(){super(T.accessibilitySupport,"accessibilitySupport",$r.Unknown,{type:"string",enum:["auto","on","off"],enumDescriptions:[h(75,"Use platform APIs to detect when a Screen Reader is attached."),h(76,"Optimize for usage with a Screen Reader."),h(77,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h(78,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return $r.Unknown;case"off":return $r.Disabled;case"on":return $r.Enabled}return this.defaultValue}compute(e,t,n){return n===$r.Unknown?e.accessibilitySupport:n}}class D9 extends st{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(T.comments,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h(79,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h(80,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:ie(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ie(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}var As;(function(i){i[i.Hidden=0]="Hidden",i[i.Blink=1]="Blink",i[i.Smooth=2]="Smooth",i[i.Phase=3]="Phase",i[i.Expand=4]="Expand",i[i.Solid=5]="Solid"})(As||(As={}));function k9(i){switch(i){case"blink":return As.Blink;case"smooth":return As.Smooth;case"phase":return As.Phase;case"expand":return As.Expand;case"solid":return As.Solid}}var cr;(function(i){i[i.Line=1]="Line",i[i.Block=2]="Block",i[i.Underline=3]="Underline",i[i.LineThin=4]="LineThin",i[i.BlockOutline=5]="BlockOutline",i[i.UnderlineThin=6]="UnderlineThin"})(cr||(cr={}));function C9(i){switch(i){case"line":return cr.Line;case"block":return cr.Block;case"underline":return cr.Underline;case"line-thin":return cr.LineThin;case"block-outline":return cr.BlockOutline;case"underline-thin":return cr.UnderlineThin}}class I9 extends Bu{constructor(){super(T.editorClassName)}compute(e,t,n){const r=["monaco-editor"];return t.get(T.extraEditorClassName)&&r.push(t.get(T.extraEditorClassName)),e.extraEditorClassName&&r.push(e.extraEditorClassName),t.get(T.mouseStyle)==="default"?r.push("mouse-default"):t.get(T.mouseStyle)==="copy"&&r.push("mouse-copy"),t.get(T.showUnused)&&r.push("showUnused"),t.get(T.showDeprecated)&&r.push("showDeprecated"),r.join(" ")}}class P9 extends Te{constructor(){super(T.emptySelectionClipboard,"emptySelectionClipboard",!0,{description:h(81,"Controls whether copying without a selection copies the current line.")})}compute(e,t,n){return n&&e.emptySelectionClipboard}}class T9 extends st{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(T.find,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h(82,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h(83,"Never seed search string from the editor selection."),h(84,"Always seed search string from the editor selection, including word at cursor position."),h(85,"Only seed search string from the editor selection.")],description:h(86,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h(87,"Never turn on Find in Selection automatically (default)."),h(88,"Always turn on Find in Selection automatically."),h(89,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h(90,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h(91,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Rn},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h(92,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h(93,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:ie(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":vt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":vt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ie(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ie(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ie(t.loop,this.defaultValue.loop)}}}const ds=class ds extends st{constructor(){super(T.fontLigatures,"fontLigatures",ds.OFF,{anyOf:[{type:"boolean",description:h(94,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h(95,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h(96,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?ds.OFF:e==="true"?ds.ON:e:e?ds.ON:ds.OFF}};ds.OFF='"liga" off, "calt" off',ds.ON='"liga" on, "calt" on';let b_=ds;const hs=class hs extends st{constructor(){super(T.fontVariations,"fontVariations",hs.OFF,{anyOf:[{type:"boolean",description:h(97,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h(98,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h(99,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?hs.OFF:e==="true"?hs.TRANSLATE:e:e?hs.TRANSLATE:hs.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}};hs.OFF="normal",hs.TRANSLATE="translate";let y_=hs;class A9 extends Bu{constructor(){super(T.fontInfo)}compute(e,t,n){return e.fontInfo}}class R9 extends _l{constructor(){super(T.fontSize,"fontSize",Br.fontSize,{type:"number",minimum:6,maximum:100,default:Br.fontSize,description:h(100,"Controls the font size in pixels.")})}validate(e){const t=Dn.float(e,this.defaultValue);return t===0?Br.fontSize:Dn.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}}const br=class br extends st{constructor(){super(T.fontWeight,"fontWeight",Br.fontWeight,{anyOf:[{type:"number",minimum:br.MINIMUM_VALUE,maximum:br.MAXIMUM_VALUE,errorMessage:h(101,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:br.SUGGESTION_VALUES}],default:Br.fontWeight,description:h(102,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Ke.clampedInt(e,Br.fontWeight,br.MINIMUM_VALUE,br.MAXIMUM_VALUE))}};br.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],br.MINIMUM_VALUE=1,br.MAXIMUM_VALUE=1e3;let x_=br;class L9 extends st{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h(103,"Show Peek view of the results (default)"),h(104,"Go to the primary result and show a Peek view"),h(105,"Go to the primary result and enable Peek-less navigation to others")]},n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(T.gotoLocation,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h(106,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h(107,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:h(108,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:h(109,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:h(110,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:h(111,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:h(112,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:h(113,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:h(114,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:h(115,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:h(116,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:vt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??vt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??vt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??vt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??vt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??vt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??vt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:vi.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:vi.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:vi.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:vi.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:vi.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:vi.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class N9 extends st{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(T.hover,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h(117,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h(118,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h(119,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h(120,"Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h(121,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),delay:Ke.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:ie(t.sticky,this.defaultValue.sticky),hidingDelay:Ke.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ie(t.above,this.defaultValue.above)}}}var vl;(function(i){i[i.None=0]="None",i[i.Text=1]="Text",i[i.Blocks=2]="Blocks"})(vl||(vl={}));class Wu extends Bu{constructor(){super(T.layoutInfo)}compute(e,t,n){return Wu.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight);let r=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(r=Math.max(r,t-1));const s=(n+e.viewLineCount+r)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/s);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:r,desiredRatio:s,minimapLineCount:o}}static _computeMinimapLayout(e,t){const n=e.outerWidth,r=e.outerHeight,s=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:vl.None,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*r),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:r};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,d=e.minimap.renderCharacters;let f=s>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const p=e.minimap.maxColumn,b=e.minimap.size,w=e.minimap.side,v=e.verticalScrollbarWidth,S=e.viewLineCount,k=e.remainingWidth,C=e.isViewportWrapping,N=d?2:3;let A=Math.floor(s*r);const V=A/s;let ae=!1,be=!1,Q=N*f,Ce=f/s,Se=1;if(b==="fill"||b==="fit"){const{typicalViewportLineCount:je,extraLinesBeforeFirstLine:gt,extraLinesBeyondLastLine:$e,desiredRatio:gi,minimapLineCount:oi}=Wu.computeContainedMinimapLineCount({viewLineCount:S,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:r,lineHeight:l,pixelRatio:s});if(S/oi>1)ae=!0,be=!0,f=1,Q=1,Ce=f/s;else{let mi=!1,$i=f+1;if(b==="fit"){const kt=Math.ceil((gt+S+$e)*Q);C&&a&&k<=t.stableFitRemainingWidth?(mi=!0,$i=t.stableFitMaxMinimapScale):mi=kt>A}if(b==="fill"||mi){ae=!0;const kt=f;Q=Math.min(l*s,Math.max(1,Math.floor(1/gi))),C&&a&&k<=t.stableFitRemainingWidth&&($i=t.stableFitMaxMinimapScale),f=Math.min($i,Math.max(1,Math.floor(Q/N))),f>kt&&(Se=Math.min(2,f/kt)),Ce=f/s/Se,A=Math.ceil(Math.max(je,gt+S+$e)*Q),C?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=k,t.stableFitMaxMinimapScale=f):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const J=Math.floor(p*Ce),q=Math.min(J,Math.max(0,Math.floor((k-v-2)*Ce/(c+Ce)))+b9);let oe=Math.floor(s*q);const re=oe/s;oe=Math.floor(oe*Se);const de=d?vl.Text:vl.Blocks,fe=w==="left"?0:n-q-v;return{renderMinimap:de,minimapLeft:fe,minimapWidth:q,minimapHeightIsEditorHeight:ae,minimapIsSampling:be,minimapScale:f,minimapLineHeight:Q,minimapCanvasInnerWidth:oe,minimapCanvasInnerHeight:A,minimapCanvasOuterWidth:re,minimapCanvasOuterHeight:V}}static computeLayout(e,t){const n=t.outerWidth|0,r=t.outerHeight|0,s=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,u=t.viewLineCount,d=e.get(T.wordWrapOverride2),f=d==="inherit"?e.get(T.wordWrapOverride1):d,p=f==="inherit"?e.get(T.wordWrap):f,b=e.get(T.wordWrapColumn),w=t.isDominatedByLongLines,v=e.get(T.glyphMargin),S=e.get(T.lineNumbers).renderType!==ki.Off,k=e.get(T.lineNumbersMinChars),C=e.get(T.scrollBeyondLastLine),N=e.get(T.padding),A=e.get(T.minimap),V=e.get(T.scrollbar),ae=V.verticalScrollbarSize,be=V.verticalHasArrows,Q=V.arrowSize,Ce=V.horizontalScrollbarSize,Se=e.get(T.folding),J=e.get(T.showFoldingControls)!=="never";let q=e.get(T.lineDecorationsWidth);Se&&J&&(q+=16);let oe=0;if(S){const _s=Math.max(o,k);oe=Math.round(_s*l)}let re=0;v&&(re=s*t.glyphMarginDecorationLaneCount);let de=0,fe=de+re,je=fe+oe,gt=je+q;const $e=n-re-oe-q;let gi=!1,oi=!1,Zt=-1;f==="inherit"&&w?(gi=!0,oi=!0):p==="on"||p==="bounded"?oi=!0:p==="wordWrapColumn"&&(Zt=b);const mi=Wu._computeMinimapLayout({outerWidth:n,outerHeight:r,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:C,paddingTop:N.top,paddingBottom:N.bottom,minimap:A,verticalScrollbarWidth:ae,viewLineCount:u,remainingWidth:$e,isViewportWrapping:oi},t.memory||new y9);mi.renderMinimap!==vl.None&&mi.minimapLeft===0&&(de+=mi.minimapWidth,fe+=mi.minimapWidth,je+=mi.minimapWidth,gt+=mi.minimapWidth);const $i=$e-mi.minimapWidth,kt=Math.max(1,Math.floor(($i-ae-2)/a)),er=be?Q:0;return oi&&(Zt=Math.max(1,kt),p==="bounded"&&(Zt=Math.min(Zt,b))),{width:n,height:r,glyphMarginLeft:de,glyphMarginWidth:re,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:fe,lineNumbersWidth:oe,decorationsLeft:je,decorationsWidth:q,contentLeft:gt,contentWidth:$i,minimap:mi,viewportColumn:kt,isWordWrapMinified:gi,isViewportWrapping:oi,wrappingColumn:Zt,verticalScrollbarWidth:ae,horizontalScrollbarHeight:Ce,overviewRuler:{top:er,width:ae,height:r-2*er,right:0}}}}class O9 extends st{constructor(){super(T.wrappingStrategy,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h(122,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h(123,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h(124,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return vt(e,"simple",["simple","advanced"])}compute(e,t,n){return t.get(T.accessibilitySupport)===$r.Enabled?"advanced":n}}var Ur;(function(i){i.Off="off",i.OnCode="onCode",i.On="on"})(Ur||(Ur={}));class F9 extends st{constructor(){const e={enabled:Ur.On};super(T.lightbulb,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[Ur.Off,Ur.OnCode,Ur.On],default:e.enabled,enumDescriptions:[h(125,"Disable the code action menu."),h(126,"Show the code action menu when the cursor is on lines with code."),h(127,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h(128,"Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:vt(e.enabled,this.defaultValue.enabled,[Ur.Off,Ur.OnCode,Ur.On])}}}class M9 extends st{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(T.stickyScroll,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h(129,"Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h(130,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h(131,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h(132,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),maxLineCount:Ke.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:vt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ie(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class $9 extends st{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(T.inlayHints,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h(133,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h(134,"Inlay hints are enabled"),h(135,"Inlay hints are showing by default and hide when holding {0}",Rn?"Ctrl+Option":"Ctrl+Alt"),h(136,"Inlay hints are hidden by default and show when holding {0}",Rn?"Ctrl+Option":"Ctrl+Alt"),h(137,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h(138,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h(139,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h(140,"Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:vt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Ke.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:vi.string(t.fontFamily,this.defaultValue.fontFamily),padding:ie(t.padding,this.defaultValue.padding)}}}class U9 extends st{constructor(){super(T.lineDecorationsWidth,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Ke.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?Ke.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}}class H9 extends Dn{constructor(){super(T.lineHeight,"lineHeight",Br.lineHeight,e=>Dn.clamp(e,0,150),{markdownDescription:h(141,`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,n){return e.fontInfo.lineHeight}}class B9 extends st{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(T.minimap,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h(142,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h(143,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h(144,"The minimap has the same size as the editor contents (and might scroll)."),h(145,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h(146,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h(147,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h(148,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h(149,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h(150,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h(151,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h(152,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h(153,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h(154,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h(155,"Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h(156,"Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),autohide:ie(t.autohide,this.defaultValue.autohide),size:vt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:vt(t.side,this.defaultValue.side,["right","left"]),showSlider:vt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ie(t.renderCharacters,this.defaultValue.renderCharacters),scale:Ke.clampedInt(t.scale,1,1,3),maxColumn:Ke.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ie(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ie(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:Dn.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:Dn.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}}function W9(i){return i==="ctrlCmd"?Rn?"metaKey":"ctrlKey":"altKey"}class V9 extends st{constructor(){super(T.padding,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h(157,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h(158,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Ke.clampedInt(t.top,0,0,1e3),bottom:Ke.clampedInt(t.bottom,0,0,1e3)}}}class z9 extends st{constructor(){const e={enabled:!0,cycle:!0};super(T.parameterHints,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h(159,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h(160,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),cycle:ie(t.cycle,this.defaultValue.cycle)}}}class q9 extends Bu{constructor(){super(T.pixelRatio)}compute(e,t,n){return e.pixelRatio}}class j9 extends st{constructor(){super(T.placeholder,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class G9 extends st{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h(161,"Quick suggestions show inside the suggest widget"),h(162,"Quick suggestions show as ghost text"),h(163,"Quick suggestions are disabled")]}];super(T.quickSuggestions,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:h(164,"Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:h(165,"Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:h(166,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h(167,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:n,strings:r}=e,s=["on","inline","off"];let o,a,l;return typeof t=="boolean"?o=t?"on":"off":o=vt(t,this.defaultValue.other,s),typeof n=="boolean"?a=n?"on":"off":a=vt(n,this.defaultValue.comments,s),typeof r=="boolean"?l=r?"on":"off":l=vt(r,this.defaultValue.strings,s),{other:o,comments:a,strings:l}}}var ki;(function(i){i[i.Off=0]="Off",i[i.On=1]="On",i[i.Relative=2]="Relative",i[i.Interval=3]="Interval",i[i.Custom=4]="Custom"})(ki||(ki={}));class Q9 extends st{constructor(){super(T.lineNumbers,"lineNumbers",{renderType:ki.On,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h(168,"Line numbers are not rendered."),h(169,"Line numbers are rendered as absolute number."),h(170,"Line numbers are rendered as distance in lines to cursor position."),h(171,"Line numbers are rendered every 10 lines.")],default:"on",description:h(172,"Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=ki.Custom,n=e):e==="interval"?t=ki.Interval:e==="relative"?t=ki.Relative:e==="on"?t=ki.On:t=ki.Off),{renderType:t,renderFn:n}}}class J9 extends st{constructor(){const e=[],t={type:"number",description:h(173,"Number of monospace characters at which this editor ruler will render.")};super(T.rulers,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:h(174,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h(175,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const n of e)if(typeof n=="number")t.push({column:Ke.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n=="object"){const r=n;t.push({column:Ke.clampedInt(r.column,0,0,1e4),color:r.color})}return t.sort((n,r)=>n.column-r.column),t}return this.defaultValue}}class X9 extends st{constructor(){super(T.readOnlyMessage,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function G2(i,e){if(typeof i!="string")return e;switch(i){case"hidden":return Ao.Hidden;case"visible":return Ao.Visible;default:return Ao.Auto}}class Y9 extends st{constructor(){const e={vertical:Ao.Auto,horizontal:Ao.Auto,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(T.scrollbar,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(176,"The vertical scrollbar will be visible only when necessary."),h(177,"The vertical scrollbar will always be visible."),h(178,"The vertical scrollbar will always be hidden.")],default:"auto",description:h(179,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(180,"The horizontal scrollbar will be visible only when necessary."),h(181,"The horizontal scrollbar will always be visible."),h(182,"The horizontal scrollbar will always be hidden.")],default:"auto",description:h(183,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h(184,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h(185,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h(186,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h(187,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,n=Ke.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),r=Ke.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Ke.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:G2(t.vertical,this.defaultValue.vertical),horizontal:G2(t.horizontal,this.defaultValue.horizontal),useShadows:ie(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:ie(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ie(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ie(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ie(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:Ke.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:r,verticalSliderSize:Ke.clampedInt(t.verticalSliderSize,r,0,1e3),scrollByPage:ie(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ie(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}const Hn="inUntrustedWorkspace",Fo={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class K9 extends st{constructor(){const e={nonBasicASCII:Hn,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Hn,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(T.unicodeHighlighting,"unicodeHighlight",e,{[Fo.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Hn],default:e.nonBasicASCII,description:h(188,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Fo.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:h(189,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[Fo.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:h(190,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Fo.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Hn],default:e.includeComments,description:h(191,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[Fo.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Hn],default:e.includeStrings,description:h(192,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[Fo.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:h(193,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Fo.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h(194,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&($n(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&($n(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));const r=super.applyUpdate(e,t);return n?new jf(r.newValue,!0):r}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:wl(t.nonBasicASCII,Hn,[!0,!1,Hn]),invisibleCharacters:ie(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ie(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:wl(t.includeComments,Hn,[!0,!1,Hn]),includeStrings:wl(t.includeStrings,Hn,[!0,!1,Hn]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const n={};for(const[r,s]of Object.entries(e))s===!0&&(n[r]=!0);return n}}class Z9 extends st{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(T.inlineSuggest,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h(195,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(196,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),h(197,"Show the inline suggestion toolbar when hovering over an inline suggestion."),h(198,"Never show the inline suggestion toolbar.")],description:h(199,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h(200,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h(201,"Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),mode:vt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:vt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ie(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ie(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:vi.string(t.fontFamily,this.defaultValue.fontFamily)}}}class eP extends st{constructor(){const e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(T.inlineEdit,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:h(202,"Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(203,"Show the inline edit toolbar whenever an inline suggestion is shown."),h(204,"Show the inline edit toolbar when hovering over an inline suggestion."),h(205,"Never show the inline edit toolbar.")],description:h(206,"Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:h(207,"Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),showToolbar:vt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:vi.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:ie(t.keepOnBlur,this.defaultValue.keepOnBlur)}}}class tP extends st{constructor(){const e={enabled:$2.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:$2.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(T.bracketPairColorization,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(208,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h(209,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ie(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class iP extends st{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(T.guides,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(210,"Enables bracket pair guides."),h(211,"Enables bracket pair guides only for the active bracket pair."),h(212,"Disables bracket pair guides.")],default:e.bracketPairs,description:h(213,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(214,"Enables horizontal guides as addition to vertical bracket pair guides."),h(215,"Enables horizontal guides only for the active bracket pair."),h(216,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h(217,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h(218,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h(219,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h(220,"Highlights the active indent guide."),h(221,"Highlights the active indent guide even if bracket guides are highlighted."),h(222,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h(223,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:wl(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:wl(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:ie(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ie(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:wl(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function wl(i,e,t){const n=t.indexOf(i);return n===-1?e:t[n]}class nP extends st{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(T.suggest,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h(224,"Insert suggestion without overwriting text right of the cursor."),h(225,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h(226,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h(227,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h(228,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h(229,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h(230,"Always select a suggestion when automatically triggering IntelliSense."),h(231,"Never select a suggestion when automatically triggering IntelliSense."),h(232,"Select a suggestion only when triggering IntelliSense from a trigger character."),h(233,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h(234,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h(235,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h(236,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h(237,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h(238,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h(239,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h(240,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h(241,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h(242,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h(243,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h(244,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h(245,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h(246,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h(247,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h(248,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h(249,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h(250,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h(251,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h(252,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h(253,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h(254,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h(255,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h(256,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h(257,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h(258,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h(259,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h(260,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h(261,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h(262,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h(263,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h(264,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h(265,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h(266,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h(267,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h(268,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h(269,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h(270,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h(271,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:vt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ie(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ie(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ie(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ie(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:vt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ie(t.showIcons,this.defaultValue.showIcons),showStatusBar:ie(t.showStatusBar,this.defaultValue.showStatusBar),preview:ie(t.preview,this.defaultValue.preview),previewMode:vt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ie(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ie(t.showMethods,this.defaultValue.showMethods),showFunctions:ie(t.showFunctions,this.defaultValue.showFunctions),showConstructors:ie(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:ie(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ie(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ie(t.showFields,this.defaultValue.showFields),showVariables:ie(t.showVariables,this.defaultValue.showVariables),showClasses:ie(t.showClasses,this.defaultValue.showClasses),showStructs:ie(t.showStructs,this.defaultValue.showStructs),showInterfaces:ie(t.showInterfaces,this.defaultValue.showInterfaces),showModules:ie(t.showModules,this.defaultValue.showModules),showProperties:ie(t.showProperties,this.defaultValue.showProperties),showEvents:ie(t.showEvents,this.defaultValue.showEvents),showOperators:ie(t.showOperators,this.defaultValue.showOperators),showUnits:ie(t.showUnits,this.defaultValue.showUnits),showValues:ie(t.showValues,this.defaultValue.showValues),showConstants:ie(t.showConstants,this.defaultValue.showConstants),showEnums:ie(t.showEnums,this.defaultValue.showEnums),showEnumMembers:ie(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ie(t.showKeywords,this.defaultValue.showKeywords),showWords:ie(t.showWords,this.defaultValue.showWords),showColors:ie(t.showColors,this.defaultValue.showColors),showFiles:ie(t.showFiles,this.defaultValue.showFiles),showReferences:ie(t.showReferences,this.defaultValue.showReferences),showFolders:ie(t.showFolders,this.defaultValue.showFolders),showTypeParameters:ie(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ie(t.showSnippets,this.defaultValue.showSnippets),showUsers:ie(t.showUsers,this.defaultValue.showUsers),showIssues:ie(t.showIssues,this.defaultValue.showIssues)}}}class rP extends st{constructor(){super(T.smartSelect,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h(272,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h(273,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:ie(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ie(e.selectSubwords,this.defaultValue.selectSubwords)}}}class sP extends st{constructor(){const e=[];super(T.wordSegmenterLocales,"wordSegmenterLocales",e,{anyOf:[{description:h(274,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h(274,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const n of e)if(typeof n=="string")try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}}var Hr;(function(i){i[i.None=0]="None",i[i.Same=1]="Same",i[i.Indent=2]="Indent",i[i.DeepIndent=3]="DeepIndent"})(Hr||(Hr={}));class oP extends st{constructor(){super(T.wrappingIndent,"wrappingIndent",Hr.Same,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h(275,"No indentation. Wrapped lines begin at column 1."),h(276,"Wrapped lines get the same indentation as the parent."),h(277,"Wrapped lines get +1 indentation toward the parent."),h(278,"Wrapped lines get +2 indentation toward the parent.")],description:h(279,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return Hr.None;case"same":return Hr.Same;case"indent":return Hr.Indent;case"deepIndent":return Hr.DeepIndent}return Hr.Same}compute(e,t,n){return t.get(T.accessibilitySupport)===$r.Enabled?Hr.None:n}}class aP extends Bu{constructor(){super(T.wrappingInfo)}compute(e,t,n){const r=t.get(T.layoutInfo);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:r.isWordWrapMinified,isViewportWrapping:r.isViewportWrapping,wrappingColumn:r.wrappingColumn}}}class lP extends st{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(T.dropIntoEditor,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(280,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h(281,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h(282,"Show the drop selector widget after a file is dropped into the editor."),h(283,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),showDropSelector:vt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class cP extends st{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(T.pasteAs,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(284,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h(285,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h(286,"Show the paste selector widget after content is pasted into the editor."),h(287,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ie(t.enabled,this.defaultValue.enabled),showPasteSelector:vt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const Br={fontFamily:Rn?"Menlo, Monaco, 'Courier New', monospace":ws?"'Droid Sans Mono', 'monospace', monospace":"Consolas, 'Courier New', monospace",fontWeight:"normal",fontSize:Rn?12:14,lineHeight:0,letterSpacing:0},uP=[];function F(i){return uP[i.id]=i,i}var T;(function(i){i[i.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",i[i.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",i[i.accessibilitySupport=2]="accessibilitySupport",i[i.accessibilityPageSize=3]="accessibilityPageSize",i[i.ariaLabel=4]="ariaLabel",i[i.ariaRequired=5]="ariaRequired",i[i.autoClosingBrackets=6]="autoClosingBrackets",i[i.autoClosingComments=7]="autoClosingComments",i[i.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",i[i.autoClosingDelete=9]="autoClosingDelete",i[i.autoClosingOvertype=10]="autoClosingOvertype",i[i.autoClosingQuotes=11]="autoClosingQuotes",i[i.autoIndent=12]="autoIndent",i[i.automaticLayout=13]="automaticLayout",i[i.autoSurround=14]="autoSurround",i[i.bracketPairColorization=15]="bracketPairColorization",i[i.guides=16]="guides",i[i.codeLens=17]="codeLens",i[i.codeLensFontFamily=18]="codeLensFontFamily",i[i.codeLensFontSize=19]="codeLensFontSize",i[i.colorDecorators=20]="colorDecorators",i[i.colorDecoratorsLimit=21]="colorDecoratorsLimit",i[i.columnSelection=22]="columnSelection",i[i.comments=23]="comments",i[i.contextmenu=24]="contextmenu",i[i.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",i[i.cursorBlinking=26]="cursorBlinking",i[i.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",i[i.cursorStyle=28]="cursorStyle",i[i.cursorSurroundingLines=29]="cursorSurroundingLines",i[i.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",i[i.cursorWidth=31]="cursorWidth",i[i.disableLayerHinting=32]="disableLayerHinting",i[i.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",i[i.domReadOnly=34]="domReadOnly",i[i.dragAndDrop=35]="dragAndDrop",i[i.dropIntoEditor=36]="dropIntoEditor",i[i.emptySelectionClipboard=37]="emptySelectionClipboard",i[i.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",i[i.extraEditorClassName=39]="extraEditorClassName",i[i.fastScrollSensitivity=40]="fastScrollSensitivity",i[i.find=41]="find",i[i.fixedOverflowWidgets=42]="fixedOverflowWidgets",i[i.folding=43]="folding",i[i.foldingStrategy=44]="foldingStrategy",i[i.foldingHighlight=45]="foldingHighlight",i[i.foldingImportsByDefault=46]="foldingImportsByDefault",i[i.foldingMaximumRegions=47]="foldingMaximumRegions",i[i.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",i[i.fontFamily=49]="fontFamily",i[i.fontInfo=50]="fontInfo",i[i.fontLigatures=51]="fontLigatures",i[i.fontSize=52]="fontSize",i[i.fontWeight=53]="fontWeight",i[i.fontVariations=54]="fontVariations",i[i.formatOnPaste=55]="formatOnPaste",i[i.formatOnType=56]="formatOnType",i[i.glyphMargin=57]="glyphMargin",i[i.gotoLocation=58]="gotoLocation",i[i.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",i[i.hover=60]="hover",i[i.inDiffEditor=61]="inDiffEditor",i[i.inlineSuggest=62]="inlineSuggest",i[i.inlineEdit=63]="inlineEdit",i[i.letterSpacing=64]="letterSpacing",i[i.lightbulb=65]="lightbulb",i[i.lineDecorationsWidth=66]="lineDecorationsWidth",i[i.lineHeight=67]="lineHeight",i[i.lineNumbers=68]="lineNumbers",i[i.lineNumbersMinChars=69]="lineNumbersMinChars",i[i.linkedEditing=70]="linkedEditing",i[i.links=71]="links",i[i.matchBrackets=72]="matchBrackets",i[i.minimap=73]="minimap",i[i.mouseStyle=74]="mouseStyle",i[i.mouseWheelScrollSensitivity=75]="mouseWheelScrollSensitivity",i[i.mouseWheelZoom=76]="mouseWheelZoom",i[i.multiCursorMergeOverlapping=77]="multiCursorMergeOverlapping",i[i.multiCursorModifier=78]="multiCursorModifier",i[i.multiCursorPaste=79]="multiCursorPaste",i[i.multiCursorLimit=80]="multiCursorLimit",i[i.occurrencesHighlight=81]="occurrencesHighlight",i[i.overviewRulerBorder=82]="overviewRulerBorder",i[i.overviewRulerLanes=83]="overviewRulerLanes",i[i.padding=84]="padding",i[i.pasteAs=85]="pasteAs",i[i.parameterHints=86]="parameterHints",i[i.peekWidgetDefaultFocus=87]="peekWidgetDefaultFocus",i[i.placeholder=88]="placeholder",i[i.definitionLinkOpensInPeek=89]="definitionLinkOpensInPeek",i[i.quickSuggestions=90]="quickSuggestions",i[i.quickSuggestionsDelay=91]="quickSuggestionsDelay",i[i.readOnly=92]="readOnly",i[i.readOnlyMessage=93]="readOnlyMessage",i[i.renameOnType=94]="renameOnType",i[i.renderControlCharacters=95]="renderControlCharacters",i[i.renderFinalNewline=96]="renderFinalNewline",i[i.renderLineHighlight=97]="renderLineHighlight",i[i.renderLineHighlightOnlyWhenFocus=98]="renderLineHighlightOnlyWhenFocus",i[i.renderValidationDecorations=99]="renderValidationDecorations",i[i.renderWhitespace=100]="renderWhitespace",i[i.revealHorizontalRightPadding=101]="revealHorizontalRightPadding",i[i.roundedSelection=102]="roundedSelection",i[i.rulers=103]="rulers",i[i.scrollbar=104]="scrollbar",i[i.scrollBeyondLastColumn=105]="scrollBeyondLastColumn",i[i.scrollBeyondLastLine=106]="scrollBeyondLastLine",i[i.scrollPredominantAxis=107]="scrollPredominantAxis",i[i.selectionClipboard=108]="selectionClipboard",i[i.selectionHighlight=109]="selectionHighlight",i[i.selectOnLineNumbers=110]="selectOnLineNumbers",i[i.showFoldingControls=111]="showFoldingControls",i[i.showUnused=112]="showUnused",i[i.snippetSuggestions=113]="snippetSuggestions",i[i.smartSelect=114]="smartSelect",i[i.smoothScrolling=115]="smoothScrolling",i[i.stickyScroll=116]="stickyScroll",i[i.stickyTabStops=117]="stickyTabStops",i[i.stopRenderingLineAfter=118]="stopRenderingLineAfter",i[i.suggest=119]="suggest",i[i.suggestFontSize=120]="suggestFontSize",i[i.suggestLineHeight=121]="suggestLineHeight",i[i.suggestOnTriggerCharacters=122]="suggestOnTriggerCharacters",i[i.suggestSelection=123]="suggestSelection",i[i.tabCompletion=124]="tabCompletion",i[i.tabIndex=125]="tabIndex",i[i.unicodeHighlighting=126]="unicodeHighlighting",i[i.unusualLineTerminators=127]="unusualLineTerminators",i[i.useShadowDOM=128]="useShadowDOM",i[i.useTabStops=129]="useTabStops",i[i.wordBreak=130]="wordBreak",i[i.wordSegmenterLocales=131]="wordSegmenterLocales",i[i.wordSeparators=132]="wordSeparators",i[i.wordWrap=133]="wordWrap",i[i.wordWrapBreakAfterCharacters=134]="wordWrapBreakAfterCharacters",i[i.wordWrapBreakBeforeCharacters=135]="wordWrapBreakBeforeCharacters",i[i.wordWrapColumn=136]="wordWrapColumn",i[i.wordWrapOverride1=137]="wordWrapOverride1",i[i.wordWrapOverride2=138]="wordWrapOverride2",i[i.wrappingIndent=139]="wrappingIndent",i[i.wrappingStrategy=140]="wrappingStrategy",i[i.showDeprecated=141]="showDeprecated",i[i.inlayHints=142]="inlayHints",i[i.editorClassName=143]="editorClassName",i[i.pixelRatio=144]="pixelRatio",i[i.tabFocusMode=145]="tabFocusMode",i[i.layoutInfo=146]="layoutInfo",i[i.wrappingInfo=147]="wrappingInfo",i[i.defaultColorDecorators=148]="defaultColorDecorators",i[i.colorDecoratorsActivatedOn=149]="colorDecoratorsActivatedOn",i[i.inlineCompletionsAccessibilityVerbose=150]="inlineCompletionsAccessibilityVerbose"})(T||(T={})),F(new Te(T.acceptSuggestionOnCommitCharacter,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h(288,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),F(new ht(T.acceptSuggestionOnEnter,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h(289,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h(290,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),F(new S9),F(new Ke(T.accessibilityPageSize,"accessibilityPageSize",10,1,Ri.MAX_SAFE_SMALL_INTEGER,{description:h(291,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),F(new vi(T.ariaLabel,"ariaLabel",h(292,"Editor content"))),F(new Te(T.ariaRequired,"ariaRequired",!1,void 0)),F(new Te(T.screenReaderAnnounceInlineSuggestion,"screenReaderAnnounceInlineSuggestion",!0,{description:h(293,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),F(new ht(T.autoClosingBrackets,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(294,"Use language configurations to determine when to autoclose brackets."),h(295,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h(296,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),F(new ht(T.autoClosingComments,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(297,"Use language configurations to determine when to autoclose comments."),h(298,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:h(299,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),F(new ht(T.autoClosingDelete,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h(300,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h(301,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),F(new ht(T.autoClosingOvertype,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h(302,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:h(303,"Controls whether the editor should type over closing quotes or brackets.")})),F(new ht(T.autoClosingQuotes,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(304,"Use language configurations to determine when to autoclose quotes."),h(305,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h(306,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),F(new Qf(T.autoIndent,"autoIndent",Ts.Full,"full",["none","keep","brackets","advanced","full"],E9,{enumDescriptions:[h(307,"The editor will not insert indentation automatically."),h(308,"The editor will keep the current line's indentation."),h(309,"The editor will keep the current line's indentation and honor language defined brackets."),h(310,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h(311,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h(312,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),F(new Te(T.automaticLayout,"automaticLayout",!1)),F(new ht(T.autoSurround,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h(313,"Use language configurations to determine when to automatically surround selections."),h(314,"Surround with quotes but not brackets."),h(315,"Surround with brackets but not quotes."),""],description:h(316,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),F(new tP),F(new iP),F(new Te(T.stickyTabStops,"stickyTabStops",!1,{description:h(317,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),F(new Te(T.codeLens,"codeLens",!0,{description:h(318,"Controls whether the editor shows CodeLens.")})),F(new vi(T.codeLensFontFamily,"codeLensFontFamily","",{description:h(319,"Controls the font family for CodeLens.")})),F(new Ke(T.codeLensFontSize,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h(320,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),F(new Te(T.colorDecorators,"colorDecorators",!0,{description:h(321,"Controls whether the editor should render the inline color decorators and color picker.")})),F(new ht(T.colorDecoratorsActivatedOn,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h(322,"Make the color picker appear both on click and hover of the color decorator"),h(323,"Make the color picker appear on hover of the color decorator"),h(324,"Make the color picker appear on click of the color decorator")],description:h(325,"Controls the condition to make a color picker appear from a color decorator")})),F(new Ke(T.colorDecoratorsLimit,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h(326,"Controls the max number of color decorators that can be rendered in an editor at once.")})),F(new Te(T.columnSelection,"columnSelection",!1,{description:h(327,"Enable that the selection with the mouse and keys is doing column selection.")})),F(new D9),F(new Te(T.contextmenu,"contextmenu",!0)),F(new Te(T.copyWithSyntaxHighlighting,"copyWithSyntaxHighlighting",!0,{description:h(328,"Controls whether syntax highlighting should be copied into the clipboard.")})),F(new Qf(T.cursorBlinking,"cursorBlinking",As.Blink,"blink",["blink","smooth","phase","expand","solid"],k9,{description:h(329,"Control the cursor animation style.")})),F(new ht(T.cursorSmoothCaretAnimation,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h(330,"Smooth caret animation is disabled."),h(331,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h(332,"Smooth caret animation is always enabled.")],description:h(333,"Controls whether the smooth caret animation should be enabled.")})),F(new Qf(T.cursorStyle,"cursorStyle",cr.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],C9,{description:h(334,"Controls the cursor style.")})),F(new Ke(T.cursorSurroundingLines,"cursorSurroundingLines",0,0,Ri.MAX_SAFE_SMALL_INTEGER,{description:h(335,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),F(new ht(T.cursorSurroundingLinesStyle,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h(336,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h(337,"`cursorSurroundingLines` is enforced always.")],markdownDescription:h(338,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),F(new Ke(T.cursorWidth,"cursorWidth",0,0,Ri.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(339,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),F(new Te(T.disableLayerHinting,"disableLayerHinting",!1)),F(new Te(T.disableMonospaceOptimizations,"disableMonospaceOptimizations",!1)),F(new Te(T.domReadOnly,"domReadOnly",!1)),F(new Te(T.dragAndDrop,"dragAndDrop",!0,{description:h(340,"Controls whether the editor should allow moving selections via drag and drop.")})),F(new P9),F(new lP),F(new M9),F(new ht(T.experimentalWhitespaceRendering,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h(341,"Use a new rendering method with svgs."),h(342,"Use a new rendering method with font characters."),h(343,"Use the stable rendering method.")],description:h(344,"Controls whether whitespace is rendered with a new, experimental method.")})),F(new vi(T.extraEditorClassName,"extraEditorClassName","")),F(new Dn(T.fastScrollSensitivity,"fastScrollSensitivity",5,i=>i<=0?5:i,{markdownDescription:h(345,"Scrolling speed multiplier when pressing `Alt`.")})),F(new T9),F(new Te(T.fixedOverflowWidgets,"fixedOverflowWidgets",!1)),F(new Te(T.folding,"folding",!0,{description:h(346,"Controls whether the editor has code folding enabled.")})),F(new ht(T.foldingStrategy,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h(347,"Use a language-specific folding strategy if available, else the indentation-based one."),h(348,"Use the indentation-based folding strategy.")],description:h(349,"Controls the strategy for computing folding ranges.")})),F(new Te(T.foldingHighlight,"foldingHighlight",!0,{description:h(350,"Controls whether the editor should highlight folded ranges.")})),F(new Te(T.foldingImportsByDefault,"foldingImportsByDefault",!1,{description:h(351,"Controls whether the editor automatically collapses import ranges.")})),F(new Ke(T.foldingMaximumRegions,"foldingMaximumRegions",5e3,10,65e3,{description:h(352,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),F(new Te(T.unfoldOnClickAfterEndOfLine,"unfoldOnClickAfterEndOfLine",!1,{description:h(353,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),F(new vi(T.fontFamily,"fontFamily",Br.fontFamily,{description:h(354,"Controls the font family.")})),F(new A9),F(new b_),F(new R9),F(new x_),F(new y_),F(new Te(T.formatOnPaste,"formatOnPaste",!1,{description:h(355,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),F(new Te(T.formatOnType,"formatOnType",!1,{description:h(356,"Controls whether the editor should automatically format the line after typing.")})),F(new Te(T.glyphMargin,"glyphMargin",!0,{description:h(357,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),F(new L9),F(new Te(T.hideCursorInOverviewRuler,"hideCursorInOverviewRuler",!1,{description:h(358,"Controls whether the cursor should be hidden in the overview ruler.")})),F(new N9),F(new Te(T.inDiffEditor,"inDiffEditor",!1)),F(new Dn(T.letterSpacing,"letterSpacing",Br.letterSpacing,i=>Dn.clamp(i,-5,20),{description:h(359,"Controls the letter spacing in pixels.")})),F(new F9),F(new U9),F(new H9),F(new Q9),F(new Ke(T.lineNumbersMinChars,"lineNumbersMinChars",5,1,300)),F(new Te(T.linkedEditing,"linkedEditing",!1,{description:h(360,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),F(new Te(T.links,"links",!0,{description:h(361,"Controls whether the editor should detect links and make them clickable.")})),F(new ht(T.matchBrackets,"matchBrackets","always",["always","near","never"],{description:h(362,"Highlight matching brackets.")})),F(new B9),F(new ht(T.mouseStyle,"mouseStyle","text",["text","default","copy"])),F(new Dn(T.mouseWheelScrollSensitivity,"mouseWheelScrollSensitivity",1,i=>i===0?1:i,{markdownDescription:h(363,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),F(new Te(T.mouseWheelZoom,"mouseWheelZoom",!1,{markdownDescription:Rn?h(364,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h(365,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),F(new Te(T.multiCursorMergeOverlapping,"multiCursorMergeOverlapping",!0,{description:h(366,"Merge multiple cursors when they are overlapping.")})),F(new Qf(T.multiCursorModifier,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],W9,{markdownEnumDescriptions:[h(367,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),h(368,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h(369,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),F(new ht(T.multiCursorPaste,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h(370,"Each cursor pastes a single line of the text."),h(371,"Each cursor pastes the full text.")],markdownDescription:h(372,"Controls pasting when the line count of the pasted text matches the cursor count.")})),F(new Ke(T.multiCursorLimit,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h(373,"Controls the max number of cursors that can be in an active editor at once.")})),F(new ht(T.occurrencesHighlight,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h(374,"Does not highlight occurrences."),h(375,"Highlights occurrences only in the current file."),h(376,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h(377,"Controls whether occurrences should be highlighted across open files.")})),F(new Te(T.overviewRulerBorder,"overviewRulerBorder",!0,{description:h(378,"Controls whether a border should be drawn around the overview ruler.")})),F(new Ke(T.overviewRulerLanes,"overviewRulerLanes",3,0,3)),F(new V9),F(new cP),F(new z9),F(new ht(T.peekWidgetDefaultFocus,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h(379,"Focus the tree when opening peek"),h(380,"Focus the editor when opening peek")],description:h(381,"Controls whether to focus the inline editor or the tree in the peek widget.")})),F(new j9),F(new Te(T.definitionLinkOpensInPeek,"definitionLinkOpensInPeek",!1,{description:h(382,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),F(new G9),F(new Ke(T.quickSuggestionsDelay,"quickSuggestionsDelay",10,0,Ri.MAX_SAFE_SMALL_INTEGER,{description:h(383,"Controls the delay in milliseconds after which quick suggestions will show up.")})),F(new Te(T.readOnly,"readOnly",!1)),F(new X9),F(new Te(T.renameOnType,"renameOnType",!1,{description:h(384,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:h(385,"Deprecated, use `editor.linkedEditing` instead.")})),F(new Te(T.renderControlCharacters,"renderControlCharacters",!0,{description:h(386,"Controls whether the editor should render control characters."),restricted:!0})),F(new ht(T.renderFinalNewline,"renderFinalNewline",ws?"dimmed":"on",["off","on","dimmed"],{description:h(387,"Render last line number when the file ends with a newline.")})),F(new ht(T.renderLineHighlight,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h(388,"Highlights both the gutter and the current line.")],description:h(389,"Controls how the editor should render the current line highlight.")})),F(new Te(T.renderLineHighlightOnlyWhenFocus,"renderLineHighlightOnlyWhenFocus",!1,{description:h(390,"Controls if the editor should render the current line highlight only when the editor is focused.")})),F(new ht(T.renderValidationDecorations,"renderValidationDecorations","editable",["editable","on","off"])),F(new ht(T.renderWhitespace,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h(391,"Render whitespace characters except for single spaces between words."),h(392,"Render whitespace characters only on selected text."),h(393,"Render only trailing whitespace characters."),""],description:h(394,"Controls how the editor should render whitespace characters.")})),F(new Ke(T.revealHorizontalRightPadding,"revealHorizontalRightPadding",15,0,1e3)),F(new Te(T.roundedSelection,"roundedSelection",!0,{description:h(395,"Controls whether selections should have rounded corners.")})),F(new J9),F(new Y9),F(new Ke(T.scrollBeyondLastColumn,"scrollBeyondLastColumn",4,0,Ri.MAX_SAFE_SMALL_INTEGER,{description:h(396,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),F(new Te(T.scrollBeyondLastLine,"scrollBeyondLastLine",!0,{description:h(397,"Controls whether the editor will scroll beyond the last line.")})),F(new Te(T.scrollPredominantAxis,"scrollPredominantAxis",!0,{description:h(398,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),F(new Te(T.selectionClipboard,"selectionClipboard",!0,{description:h(399,"Controls whether the Linux primary clipboard should be supported."),included:ws})),F(new Te(T.selectionHighlight,"selectionHighlight",!0,{description:h(400,"Controls whether the editor should highlight matches similar to the selection.")})),F(new Te(T.selectOnLineNumbers,"selectOnLineNumbers",!0)),F(new ht(T.showFoldingControls,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h(401,"Always show the folding controls."),h(402,"Never show the folding controls and reduce the gutter size."),h(403,"Only show the folding controls when the mouse is over the gutter.")],description:h(404,"Controls when the folding controls on the gutter are shown.")})),F(new Te(T.showUnused,"showUnused",!0,{description:h(405,"Controls fading out of unused code.")})),F(new Te(T.showDeprecated,"showDeprecated",!0,{description:h(406,"Controls strikethrough deprecated variables.")})),F(new $9),F(new ht(T.snippetSuggestions,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h(407,"Show snippet suggestions on top of other suggestions."),h(408,"Show snippet suggestions below other suggestions."),h(409,"Show snippets suggestions with other suggestions."),h(410,"Do not show snippet suggestions.")],description:h(411,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),F(new rP),F(new Te(T.smoothScrolling,"smoothScrolling",!1,{description:h(412,"Controls whether the editor will scroll using an animation.")})),F(new Ke(T.stopRenderingLineAfter,"stopRenderingLineAfter",1e4,-1,Ri.MAX_SAFE_SMALL_INTEGER)),F(new nP),F(new Z9),F(new eP),F(new Te(T.inlineCompletionsAccessibilityVerbose,"inlineCompletionsAccessibilityVerbose",!1,{description:h(413,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),F(new Ke(T.suggestFontSize,"suggestFontSize",0,0,1e3,{markdownDescription:h(414,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),F(new Ke(T.suggestLineHeight,"suggestLineHeight",0,0,1e3,{markdownDescription:h(415,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),F(new Te(T.suggestOnTriggerCharacters,"suggestOnTriggerCharacters",!0,{description:h(416,"Controls whether suggestions should automatically show up when typing trigger characters.")})),F(new ht(T.suggestSelection,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h(417,"Always select the first suggestion."),h(418,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h(419,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h(420,"Controls how suggestions are pre-selected when showing the suggest list.")})),F(new ht(T.tabCompletion,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h(421,"Tab complete will insert the best matching suggestion when pressing tab."),h(422,"Disable tab completions."),h(423,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h(424,"Enables tab completions.")})),F(new Ke(T.tabIndex,"tabIndex",0,-1,Ri.MAX_SAFE_SMALL_INTEGER)),F(new K9),F(new ht(T.unusualLineTerminators,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h(425,"Unusual line terminators are automatically removed."),h(426,"Unusual line terminators are ignored."),h(427,"Unusual line terminators prompt to be removed.")],description:h(428,"Remove unusual line terminators that might cause problems.")})),F(new Te(T.useShadowDOM,"useShadowDOM",!0)),F(new Te(T.useTabStops,"useTabStops",!0,{description:h(429,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),F(new ht(T.wordBreak,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h(430,"Use the default line break rule."),h(431,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h(432,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),F(new sP),F(new vi(T.wordSeparators,"wordSeparators",U2,{description:h(433,"Characters that will be used as word separators when doing word related navigations or operations.")})),F(new ht(T.wordWrap,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h(434,"Lines will never wrap."),h(435,"Lines will wrap at the viewport width."),h(436,"Lines will wrap at `#editor.wordWrapColumn#`."),h(437,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h(438,"Controls how lines should wrap.")})),F(new vi(T.wordWrapBreakAfterCharacters,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),F(new vi(T.wordWrapBreakBeforeCharacters,"wordWrapBreakBeforeCharacters","([{+")),F(new Ke(T.wordWrapColumn,"wordWrapColumn",80,1,Ri.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(439,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),F(new ht(T.wordWrapOverride1,"wordWrapOverride1","inherit",["off","on","inherit"])),F(new ht(T.wordWrapOverride2,"wordWrapOverride2","inherit",["off","on","inherit"])),F(new I9),F(new Te(T.defaultColorDecorators,"defaultColorDecorators",!1,{markdownDescription:h(440,"Controls whether inline color decorations should be shown using the default document color provider")})),F(new q9),F(new Te(T.tabFocusMode,"tabFocusMode",!1,{markdownDescription:h(441,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),F(new Wu),F(new aP),F(new oP),F(new O9);let pn=class Ka{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new Ka(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return Ka.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return Ka.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return Ka.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const n=e.lineNumber|0,r=t.lineNumber|0;if(n===r){const s=e.column|0,o=t.column|0;return s-o}return n-r}clone(){return new Ka(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Ka(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},ct=class ei{constructor(e,t,n,r){e>n||e===n&&t>r?(this.startLineNumber=n,this.startColumn=r,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=r)}isEmpty(){return ei.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return ei.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return ei.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return ei.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return ei.plusRange(this,e)}static plusRange(e,t){let n,r,s,o;return t.startLineNumber<e.startLineNumber?(n=t.startLineNumber,r=t.startColumn):t.startLineNumber===e.startLineNumber?(n=t.startLineNumber,r=Math.min(t.startColumn,e.startColumn)):(n=e.startLineNumber,r=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new ei(n,r,s,o)}intersectRanges(e){return ei.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber,r=e.startColumn,s=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,u=t.endColumn;return n<a?(n=a,r=l):n===a&&(r=Math.max(r,l)),s>c?(s=c,o=u):s===c&&(o=Math.min(o,u)),n>s||n===s&&r>o?null:new ei(n,r,s,o)}equalsRange(e){return ei.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return ei.getEndPosition(this)}static getEndPosition(e){return new pn(e.endLineNumber,e.endColumn)}getStartPosition(){return ei.getStartPosition(this)}static getStartPosition(e){return new pn(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new ei(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new ei(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return ei.collapseToStart(this)}static collapseToStart(e){return new ei(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return ei.collapseToEnd(this)}static collapseToEnd(e){return new ei(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new ei(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new ei(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new ei(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const s=e.startLineNumber|0,o=t.startLineNumber|0;if(s===o){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,u=t.endLineNumber|0;if(c===u){const d=e.endColumn|0,f=t.endColumn|0;return d-f}return c-u}return a-l}return s-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var Q2;(function(i){i[i.Null=0]="Null",i[i.PlainText=1]="PlainText"})(Q2||(Q2={}));var J2;(function(i){i[i.NotSet=-1]="NotSet",i[i.None=0]="None",i[i.Italic=1]="Italic",i[i.Bold=2]="Bold",i[i.Underline=4]="Underline",i[i.Strikethrough=8]="Strikethrough"})(J2||(J2={}));var Jf;(function(i){i[i.None=0]="None",i[i.DefaultForeground=1]="DefaultForeground",i[i.DefaultBackground=2]="DefaultBackground"})(Jf||(Jf={}));var bl;(function(i){i[i.Other=0]="Other",i[i.Comment=1]="Comment",i[i.String=2]="String",i[i.RegEx=3]="RegEx"})(bl||(bl={}));var X2;(function(i){i[i.LANGUAGEID_MASK=255]="LANGUAGEID_MASK",i[i.TOKEN_TYPE_MASK=768]="TOKEN_TYPE_MASK",i[i.BALANCED_BRACKETS_MASK=1024]="BALANCED_BRACKETS_MASK",i[i.FONT_STYLE_MASK=30720]="FONT_STYLE_MASK",i[i.FOREGROUND_MASK=16744448]="FOREGROUND_MASK",i[i.BACKGROUND_MASK=4278190080]="BACKGROUND_MASK",i[i.ITALIC_MASK=2048]="ITALIC_MASK",i[i.BOLD_MASK=4096]="BOLD_MASK",i[i.UNDERLINE_MASK=8192]="UNDERLINE_MASK",i[i.STRIKETHROUGH_MASK=16384]="STRIKETHROUGH_MASK",i[i.SEMANTIC_USE_ITALIC=1]="SEMANTIC_USE_ITALIC",i[i.SEMANTIC_USE_BOLD=2]="SEMANTIC_USE_BOLD",i[i.SEMANTIC_USE_UNDERLINE=4]="SEMANTIC_USE_UNDERLINE",i[i.SEMANTIC_USE_STRIKETHROUGH=8]="SEMANTIC_USE_STRIKETHROUGH",i[i.SEMANTIC_USE_FOREGROUND=16]="SEMANTIC_USE_FOREGROUND",i[i.SEMANTIC_USE_BACKGROUND=32]="SEMANTIC_USE_BACKGROUND",i[i.LANGUAGEID_OFFSET=0]="LANGUAGEID_OFFSET",i[i.TOKEN_TYPE_OFFSET=8]="TOKEN_TYPE_OFFSET",i[i.BALANCED_BRACKETS_OFFSET=10]="BALANCED_BRACKETS_OFFSET",i[i.FONT_STYLE_OFFSET=11]="FONT_STYLE_OFFSET",i[i.FOREGROUND_OFFSET=15]="FOREGROUND_OFFSET",i[i.BACKGROUND_OFFSET=24]="BACKGROUND_OFFSET"})(X2||(X2={}));class dP{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Me(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var r;(r=this._factories.get(e))==null||r.dispose();const n=new hP(this,e,t);return this._factories.set(e,n),Me(()=>{const s=this._factories.get(e);!s||s!==n||(this._factories.delete(e),s.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>Jf.DefaultBackground?this._colorMap[Jf.DefaultBackground]:null}}class hP extends Re{get isResolved(){return this._isResolved}constructor(e,t,n){super(),this._registry=e,this._languageId=t,this._factory=n,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}var Y2;(function(i){i[i.Increase=0]="Increase",i[i.Decrease=1]="Decrease"})(Y2||(Y2={}));var W;(function(i){i[i.Method=0]="Method",i[i.Function=1]="Function",i[i.Constructor=2]="Constructor",i[i.Field=3]="Field",i[i.Variable=4]="Variable",i[i.Class=5]="Class",i[i.Struct=6]="Struct",i[i.Interface=7]="Interface",i[i.Module=8]="Module",i[i.Property=9]="Property",i[i.Event=10]="Event",i[i.Operator=11]="Operator",i[i.Unit=12]="Unit",i[i.Value=13]="Value",i[i.Constant=14]="Constant",i[i.Enum=15]="Enum",i[i.EnumMember=16]="EnumMember",i[i.Keyword=17]="Keyword",i[i.Text=18]="Text",i[i.Color=19]="Color",i[i.File=20]="File",i[i.Reference=21]="Reference",i[i.Customcolor=22]="Customcolor",i[i.Folder=23]="Folder",i[i.TypeParameter=24]="TypeParameter",i[i.User=25]="User",i[i.Issue=26]="Issue",i[i.Snippet=27]="Snippet"})(W||(W={}));var K2;(function(i){const e=new Map;e.set(W.Method,_e.symbolMethod),e.set(W.Function,_e.symbolFunction),e.set(W.Constructor,_e.symbolConstructor),e.set(W.Field,_e.symbolField),e.set(W.Variable,_e.symbolVariable),e.set(W.Class,_e.symbolClass),e.set(W.Struct,_e.symbolStruct),e.set(W.Interface,_e.symbolInterface),e.set(W.Module,_e.symbolModule),e.set(W.Property,_e.symbolProperty),e.set(W.Event,_e.symbolEvent),e.set(W.Operator,_e.symbolOperator),e.set(W.Unit,_e.symbolUnit),e.set(W.Value,_e.symbolValue),e.set(W.Enum,_e.symbolEnum),e.set(W.Constant,_e.symbolConstant),e.set(W.Enum,_e.symbolEnum),e.set(W.EnumMember,_e.symbolEnumMember),e.set(W.Keyword,_e.symbolKeyword),e.set(W.Snippet,_e.symbolSnippet),e.set(W.Text,_e.symbolText),e.set(W.Color,_e.symbolColor),e.set(W.File,_e.symbolFile),e.set(W.Reference,_e.symbolReference),e.set(W.Customcolor,_e.symbolCustomColor),e.set(W.Folder,_e.symbolFolder),e.set(W.TypeParameter,_e.symbolTypeParameter),e.set(W.User,_e.account),e.set(W.Issue,_e.issues);function t(s){let o=e.get(s);return o||(console.info("No codicon found for CompletionItemKind "+s),o=_e.symbolProperty),o}i.toIcon=t;const n=new Map;n.set("method",W.Method),n.set("function",W.Function),n.set("constructor",W.Constructor),n.set("field",W.Field),n.set("variable",W.Variable),n.set("class",W.Class),n.set("struct",W.Struct),n.set("interface",W.Interface),n.set("module",W.Module),n.set("property",W.Property),n.set("event",W.Event),n.set("operator",W.Operator),n.set("unit",W.Unit),n.set("value",W.Value),n.set("constant",W.Constant),n.set("enum",W.Enum),n.set("enum-member",W.EnumMember),n.set("enumMember",W.EnumMember),n.set("keyword",W.Keyword),n.set("snippet",W.Snippet),n.set("text",W.Text),n.set("color",W.Color),n.set("file",W.File),n.set("reference",W.Reference),n.set("customcolor",W.Customcolor),n.set("folder",W.Folder),n.set("type-parameter",W.TypeParameter),n.set("typeParameter",W.TypeParameter),n.set("account",W.User),n.set("issue",W.Issue);function r(s,o){let a=n.get(s);return typeof a>"u"&&!o&&(a=W.Property),a}i.fromString=r})(K2||(K2={}));var Xf;(function(i){i[i.Deprecated=1]="Deprecated"})(Xf||(Xf={}));var Mo;(function(i){i[i.None=0]="None",i[i.KeepWhitespace=1]="KeepWhitespace",i[i.InsertAsSnippet=4]="InsertAsSnippet"})(Mo||(Mo={}));var Vu;(function(i){i[i.Word=0]="Word",i[i.Line=1]="Line",i[i.Suggest=2]="Suggest"})(Vu||(Vu={}));var zu;(function(i){i[i.Invoke=0]="Invoke",i[i.TriggerCharacter=1]="TriggerCharacter",i[i.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(zu||(zu={}));var Yf;(function(i){i[i.Automatic=0]="Automatic",i[i.Explicit=1]="Explicit"})(Yf||(Yf={}));var Kf;(function(i){i[i.Invoke=1]="Invoke",i[i.Auto=2]="Auto"})(Kf||(Kf={}));var Z2;(function(i){i[i.Automatic=0]="Automatic",i[i.PasteAs=1]="PasteAs"})(Z2||(Z2={}));var eE;(function(i){i[i.Invoke=1]="Invoke",i[i.TriggerCharacter=2]="TriggerCharacter",i[i.ContentChange=3]="ContentChange"})(eE||(eE={}));var tE;(function(i){i[i.Text=0]="Text",i[i.Read=1]="Read",i[i.Write=2]="Write"})(tE||(tE={}));function fP(i){return i&&y.isUri(i.uri)&&ct.isIRange(i.range)&&(ct.isIRange(i.originSelectionRange)||ct.isIRange(i.targetSelectionRange))}var ee;(function(i){i[i.File=0]="File",i[i.Module=1]="Module",i[i.Namespace=2]="Namespace",i[i.Package=3]="Package",i[i.Class=4]="Class",i[i.Method=5]="Method",i[i.Property=6]="Property",i[i.Field=7]="Field",i[i.Constructor=8]="Constructor",i[i.Enum=9]="Enum",i[i.Interface=10]="Interface",i[i.Function=11]="Function",i[i.Variable=12]="Variable",i[i.Constant=13]="Constant",i[i.String=14]="String",i[i.Number=15]="Number",i[i.Boolean=16]="Boolean",i[i.Array=17]="Array",i[i.Object=18]="Object",i[i.Key=19]="Key",i[i.Null=20]="Null",i[i.EnumMember=21]="EnumMember",i[i.Struct=22]="Struct",i[i.Event=23]="Event",i[i.Operator=24]="Operator",i[i.TypeParameter=25]="TypeParameter"})(ee||(ee={})),ee.Array+"",h(1658,"array"),ee.Boolean+"",h(1659,"boolean"),ee.Class+"",h(1660,"class"),ee.Constant+"",h(1661,"constant"),ee.Constructor+"",h(1662,"constructor"),ee.Enum+"",h(1663,"enumeration"),ee.EnumMember+"",h(1664,"enumeration member"),ee.Event+"",h(1665,"event"),ee.Field+"",h(1666,"field"),ee.File+"",h(1667,"file"),ee.Function+"",h(1668,"function"),ee.Interface+"",h(1669,"interface"),ee.Key+"",h(1670,"key"),ee.Method+"",h(1671,"method"),ee.Module+"",h(1672,"module"),ee.Namespace+"",h(1673,"namespace"),ee.Null+"",h(1674,"null"),ee.Number+"",h(1675,"number"),ee.Object+"",h(1676,"object"),ee.Operator+"",h(1677,"operator"),ee.Package+"",h(1678,"package"),ee.Property+"",h(1679,"property"),ee.String+"",h(1680,"string"),ee.Struct+"",h(1681,"struct"),ee.TypeParameter+"",h(1682,"type parameter"),ee.Variable+"",h(1683,"variable");var Zf;(function(i){i[i.Deprecated=1]="Deprecated"})(Zf||(Zf={}));var iE;(function(i){const e=new Map;e.set(ee.File,_e.symbolFile),e.set(ee.Module,_e.symbolModule),e.set(ee.Namespace,_e.symbolNamespace),e.set(ee.Package,_e.symbolPackage),e.set(ee.Class,_e.symbolClass),e.set(ee.Method,_e.symbolMethod),e.set(ee.Property,_e.symbolProperty),e.set(ee.Field,_e.symbolField),e.set(ee.Constructor,_e.symbolConstructor),e.set(ee.Enum,_e.symbolEnum),e.set(ee.Interface,_e.symbolInterface),e.set(ee.Function,_e.symbolFunction),e.set(ee.Variable,_e.symbolVariable),e.set(ee.Constant,_e.symbolConstant),e.set(ee.String,_e.symbolString),e.set(ee.Number,_e.symbolNumber),e.set(ee.Boolean,_e.symbolBoolean),e.set(ee.Array,_e.symbolArray),e.set(ee.Object,_e.symbolObject),e.set(ee.Key,_e.symbolKey),e.set(ee.Null,_e.symbolNull),e.set(ee.EnumMember,_e.symbolEnumMember),e.set(ee.Struct,_e.symbolStruct),e.set(ee.Event,_e.symbolEvent),e.set(ee.Operator,_e.symbolOperator),e.set(ee.TypeParameter,_e.symbolTypeParameter);function t(n){let r=e.get(n);return r||(console.info("No codicon found for SymbolKind "+n),r=_e.symbolProperty),r}i.toIcon=t})(iE||(iE={}));let yl=(Qi=class{static fromValue(e){switch(e){case"comment":return Qi.Comment;case"imports":return Qi.Imports;case"region":return Qi.Region}return new Qi(e)}constructor(e){this.value=e}},Qi.Comment=new Qi("comment"),Qi.Imports=new Qi("imports"),Qi.Region=new Qi("region"),Qi);var nE;(function(i){i[i.AIGenerated=1]="AIGenerated"})(nE||(nE={}));var ep;(function(i){i[i.Invoke=0]="Invoke",i[i.Automatic=1]="Automatic"})(ep||(ep={}));var E_;(function(i){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}i.is=e})(E_||(E_={}));var xl;(function(i){i[i.Collapsed=0]="Collapsed",i[i.Expanded=1]="Expanded"})(xl||(xl={}));var qu;(function(i){i[i.Unresolved=0]="Unresolved",i[i.Resolved=1]="Resolved"})(qu||(qu={}));var ju;(function(i){i[i.Current=0]="Current",i[i.Outdated=1]="Outdated"})(ju||(ju={}));var rE;(function(i){i[i.Editing=0]="Editing",i[i.Preview=1]="Preview"})(rE||(rE={}));var sE;(function(i){i[i.Type=1]="Type",i[i.Parameter=2]="Parameter"})(sE||(sE={})),new dP;var oE;(function(i){i[i.None=0]="None",i[i.Option=1]="Option",i[i.Default=2]="Default",i[i.Preferred=3]="Preferred"})(oE||(oE={}));var tp;(function(i){i[i.Invoke=0]="Invoke",i[i.Automatic=1]="Automatic"})(tp||(tp={}));var S_;(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=4]="Right",i[i.Full=7]="Full"})(S_||(S_={}));var aE;(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=3]="Right"})(aE||(aE={}));var lE;(function(i){i[i.Inline=1]="Inline",i[i.Gutter=2]="Gutter"})(lE||(lE={}));var cE;(function(i){i[i.Normal=1]="Normal",i[i.Underlined=2]="Underlined"})(cE||(cE={}));var uE;(function(i){i[i.Both=0]="Both",i[i.Right=1]="Right",i[i.Left=2]="Left",i[i.None=3]="None"})(uE||(uE={}));var Wr;(function(i){i[i.TextDefined=0]="TextDefined",i[i.LF=1]="LF",i[i.CRLF=2]="CRLF"})(Wr||(Wr={}));var Gu;(function(i){i[i.LF=1]="LF",i[i.CRLF=2]="CRLF"})(Gu||(Gu={}));var El;(function(i){i[i.LF=0]="LF",i[i.CRLF=1]="CRLF"})(El||(El={}));class D_{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}var Sl;(function(i){i[i.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",i[i.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",i[i.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",i[i.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(Sl||(Sl={}));var dE;(function(i){i[i.Left=0]="Left",i[i.Right=1]="Right",i[i.None=2]="None",i[i.LeftOfInjectedText=3]="LeftOfInjectedText",i[i.RightOfInjectedText=4]="RightOfInjectedText"})(dE||(dE={}));var hE;(function(i){i[i.FIRST_LINE_DETECTION_LENGTH_LIMIT=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(hE||(hE={}));class pP{constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}}class gP{constructor(e,t,n){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=n}}var Dl;(function(i){i[i.Unnecessary=1]="Unnecessary",i[i.Deprecated=2]="Deprecated"})(Dl||(Dl={}));var Bi;(function(i){i[i.Hint=1]="Hint",i[i.Info=2]="Info",i[i.Warning=4]="Warning",i[i.Error=8]="Error"})(Bi||(Bi={})),function(i){function e(o,a){return a-o}i.compare=e;const t=Object.create(null);t[i.Error]=h(4800,"Error"),t[i.Warning]=h(4801,"Warning"),t[i.Info]=h(4802,"Info");function n(o){return t[o]||""}i.toString=n;function r(o){switch(o){case Vt.Error:return i.Error;case Vt.Warning:return i.Warning;case Vt.Info:return i.Info;case Vt.Ignore:return i.Hint}}i.fromSeverity=r;function s(o){switch(o){case i.Error:return Vt.Error;case i.Warning:return Vt.Warning;case i.Info:return Vt.Info;case i.Hint:return Vt.Ignore}}i.toSeverity=s}(Bi||(Bi={}));var fE;(function(i){const e="";function t(r){return n(r,!0)}i.makeKey=t;function n(r,s){const o=[e];return r.source?o.push(r.source.replace("","\\")):o.push(e),r.code?typeof r.code=="string"?o.push(r.code.replace("","\\")):o.push(r.code.value.replace("","\\")):o.push(e),r.severity!==void 0&&r.severity!==null?o.push(Bi.toString(r.severity)):o.push(e),r.message&&s?o.push(r.message.replace("","\\")):o.push(e),r.startLineNumber!==void 0&&r.startLineNumber!==null?o.push(r.startLineNumber.toString()):o.push(e),r.startColumn!==void 0&&r.startColumn!==null?o.push(r.startColumn.toString()):o.push(e),r.endLineNumber!==void 0&&r.endLineNumber!==null?o.push(r.endLineNumber.toString()):o.push(e),r.endColumn!==void 0&&r.endColumn!==null?o.push(r.endColumn.toString()):o.push(e),o.push(e),o.join("")}i.makeKeyOptionalMessage=n})(fE||(fE={}));const mP=ke("progressService");ke("editorProgressService");var Qu;(function(i){i[i.Explorer=1]="Explorer",i[i.Scm=3]="Scm",i[i.Extensions=5]="Extensions",i[i.Window=10]="Window",i[i.Notification=15]="Notification",i[i.Dialog=20]="Dialog"})(Qu||(Qu={}));const Z0=class Z0{get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};Z0.None=Object.freeze({report(){}});let Ju=Z0,pE=class extends Re{constructor(e,t){super(),this.deferred=new cl,t.withProgress(e,n=>(this.reporter=n,this.lastStep&&n.report(this.lastStep),this.deferred.p)),this._register(Me(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};pE=B([O(1,mP)],pE);function Zi(i,e){if(!i)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function _P(i,e="Unreachable"){throw new Error(e)}var kn;(function(i){i.Delimiter="\0"})(kn||(kn={}));var Bn;(function(i){i[i.IsSame=0]="IsSame",i[i.Disconnected=1]="Disconnected",i[i.IsChild=2]="IsChild",i[i.IsParent=3]="IsParent"})(Bn||(Bn={}));class Ie{static fromExtHostTestItem(e,t,n=e.parent){if(e._isRoot)return new Ie([t]);const r=[e.id];for(let s=n;s&&s.id!==t;s=s.parent)r.push(s.id);return r.push(t),new Ie(r.reverse())}static isRoot(e){return!e.includes(kn.Delimiter)}static root(e){const t=e.indexOf(kn.Delimiter);return t===-1?e:e.slice(0,t)}static fromString(e){return new Ie(e.split(kn.Delimiter))}static join(e,t){return new Ie([...e.path,t])}static joinToString(e,t){return e.toString()+kn.Delimiter+t}static parentId(e){const t=e.lastIndexOf(kn.Delimiter);return t===-1?void 0:e.slice(0,t)}static localId(e){const t=e.lastIndexOf(kn.Delimiter);return t===-1?e:e.slice(t+kn.Delimiter.length)}static isChild(e,t){return t[e.length]===kn.Delimiter&&t.startsWith(e)}static compare(e,t){return e===t?Bn.IsSame:Ie.isChild(e,t)?Bn.IsChild:Ie.isChild(t,e)?Bn.IsParent:Bn.Disconnected}static getLengthOfCommonPrefix(e,t){if(e===0)return 0;let n=0;for(;n<e-1;){for(let r=1;r<e;r++){const s=t(r-1),o=t(r);if(s.path[n]!==o.path[n])return n}n++}return n}constructor(e,t=e.length){if(this.path=e,this.viewEnd=t,e.length===0||t<1)throw new Error("cannot create test with empty path")}get rootId(){return new Ie(this.path,1)}get parentId(){return this.viewEnd>1?new Ie(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++)yield new Ie(this.path,e)}*idsToRoot(){for(let e=this.viewEnd;e>0;e--)yield new Ie(this.path,e)}compare(e){if(typeof e=="string")return Ie.compare(this.toString(),e);for(let t=0;t<e.viewEnd&&t<this.viewEnd;t++)if(e.path[t]!==this.path[t])return Bn.Disconnected;return e.viewEnd>this.viewEnd?Bn.IsChild:e.viewEnd<this.viewEnd?Bn.IsParent:Bn.IsSame}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++)this.stringifed+=kn.Delimiter,this.stringifed+=this.path[e]}return this.stringifed}}var qt;(function(i){i[i.Unset=0]="Unset",i[i.Queued=1]="Queued",i[i.Running=2]="Running",i[i.Passed=3]="Passed",i[i.Failed=4]="Failed",i[i.Skipped=5]="Skipped",i[i.Errored=6]="Errored"})(qt||(qt={})),qt.Unset+"",qt.Queued+"",qt.Running+"",qt.Passed+"",qt.Failed+"",qt.Skipped+"",qt.Errored+"";var gE;(function(i){i[i.Run=1]="Run",i[i.Debug=2]="Debug",i[i.Coverage=3]="Coverage"})(gE||(gE={}));var Xu;(function(i){i[i.Refresh=2]="Refresh",i[i.CodeRelatedToTest=4]="CodeRelatedToTest",i[i.TestRelatedToCode=8]="TestRelatedToCode"})(Xu||(Xu={}));var en;(function(i){i[i.Run=2]="Run",i[i.Debug=4]="Debug",i[i.Coverage=8]="Coverage",i[i.HasNonDefaultProfile=16]="HasNonDefaultProfile",i[i.HasConfigurable=32]="HasConfigurable",i[i.SupportsContinuousRun=64]="SupportsContinuousRun"})(en||(en={})),en.Run,en.Debug,en.Coverage,en.HasNonDefaultProfile,en.HasConfigurable,en.SupportsContinuousRun;const vP=i=>"runId"in i;var kl;(function(i){i.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()}),i.deserialize=(e,t)=>({range:ct.lift(t.range),uri:e.asCanonicalUri(y.revive(t.uri))})})(kl||(kl={}));var Wn;(function(i){i[i.Error=0]="Error",i[i.Output=1]="Output"})(Wn||(Wn={}));var ip;(function(i){i.serialize=e=>{var t,n;return{label:e.label,uri:(t=e.uri)==null?void 0:t.toJSON(),position:(n=e.position)==null?void 0:n.toJSON()}},i.deserialize=(e,t)=>({label:t.label,uri:t.uri?e.asCanonicalUri(y.revive(t.uri)):void 0,position:t.position?pn.lift(t.position):void 0})})(ip||(ip={}));var np;(function(i){i.serialize=e=>{var t;return{message:e.message,type:Wn.Error,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&kl.serialize(e.location),stackTrace:(t=e.stackTrace)==null?void 0:t.map(ip.serialize)}},i.deserialize=(e,t)=>({message:t.message,type:Wn.Error,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&kl.deserialize(e,t.location),stackTrace:t.stackTrace&&t.stackTrace.map(n=>ip.deserialize(e,n))})})(np||(np={}));var rp;(function(i){i.serialize=e=>({message:e.message,type:Wn.Output,offset:e.offset,length:e.length,location:e.location&&kl.serialize(e.location)}),i.deserialize=(e,t)=>({message:t.message,type:Wn.Output,offset:t.offset,length:t.length,location:t.location&&kl.deserialize(e,t.location)})})(rp||(rp={}));var sp;(function(i){i.serialize=e=>e.type===Wn.Error?np.serialize(e):rp.serialize(e),i.deserialize=(e,t)=>t.type===Wn.Error?np.deserialize(e,t):rp.deserialize(e,t),i.isDiffable=e=>e.type===Wn.Error&&e.actual!==void 0&&e.expected!==void 0})(sp||(sp={}));var Yu;(function(i){i.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]}),i.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(sp.serialize)}),i.deserialize=(e,t)=>({state:t.state,duration:t.duration,messages:t.messages.map(n=>sp.deserialize(e,n))})})(Yu||(Yu={}));const mE="\0",op=(i,e)=>i+mE+e,_E=i=>{const e=i.indexOf(mE);return{ctrlId:i.slice(0,e),tagId:i.slice(e+1)}};var ap;(function(i){i.serialize=e=>{var t,n;return{extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:(t=e.uri)==null?void 0:t.toJSON(),range:((n=e.range)==null?void 0:n.toJSON())||null,description:e.description,error:e.error,sortText:e.sortText}},i.deserialize=(e,t)=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?e.asCanonicalUri(y.revive(t.uri)):void 0,range:t.range?ct.lift(t.range):null,description:t.description,error:t.error,sortText:t.sortText})})(ap||(ap={}));var wi;(function(i){i[i.NotExpandable=0]="NotExpandable",i[i.Expandable=1]="Expandable",i[i.BusyExpanding=2]="BusyExpanding",i[i.Expanded=3]="Expanded"})(wi||(wi={}));var Rs;(function(i){i.serialize=e=>({expand:e.expand,item:ap.serialize(e.item)}),i.deserialize=(e,t)=>({controllerId:Ie.root(t.item.extId),expand:t.expand,item:ap.deserialize(e,t.item)})})(Rs||(Rs={}));var Ku;(function(i){i.serialize=e=>{var n,r;let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.uri!==void 0&&(t.uri=(n=e.item.uri)==null?void 0:n.toJSON()),e.item.range!==void 0&&(t.range=(r=e.item.range)==null?void 0:r.toJSON()),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}},i.deserialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.range!==void 0&&(t.range=e.item.range?ct.lift(e.item.range):null),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}}})(Ku||(Ku={}));const k_=(i,e)=>{e.expand!==void 0&&(i.expand=e.expand),e.item!==void 0&&(i.item=i.item?Object.assign(i.item,e.item):e.item)};var vE;(function(i){i.serializeWithoutMessages=e=>({...Rs.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Yu.serializeWithoutMessages)}),i.serialize=e=>({...Rs.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Yu.serialize)}),i.deserialize=(e,t)=>({...Rs.deserialize(e,t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(n=>Yu.deserialize(e,n)),retired:!0})})(vE||(vE={}));var C_;(function(i){i.empty=()=>({covered:0,total:0}),i.sum=(e,t)=>{e.covered+=t.covered,e.total+=t.total}})(C_||(C_={}));var wE;(function(i){i.serialize=e=>({id:e.id,statement:e.statement,branch:e.branch,declaration:e.declaration,testIds:e.testIds,uri:e.uri.toJSON()}),i.deserialize=(e,t)=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,testIds:t.testIds,uri:e.asCanonicalUri(y.revive(t.uri))}),i.empty=(e,t)=>({id:e,uri:t,statement:C_.empty()})})(wE||(wE={}));function I_(i){var e;return{...i,location:(e=i.location)==null?void 0:e.toJSON()}}function P_(i){return i.location=i.location?pn.isIPosition(i.location)?pn.lift(i.location):ct.lift(i.location):void 0,i}var Cl;(function(i){i[i.Declaration=0]="Declaration",i[i.Statement=1]="Statement",i[i.Branch=2]="Branch"})(Cl||(Cl={}));var bE;(function(i){i.serialize=e=>e.type===Cl.Declaration?cp.serialize(e):up.serialize(e),i.deserialize=e=>e.type===Cl.Declaration?cp.deserialize(e):up.deserialize(e)})(bE||(bE={}));var lp;(function(i){i.serialize=I_,i.deserialize=P_})(lp||(lp={}));var cp;(function(i){i.serialize=I_,i.deserialize=P_})(cp||(cp={}));var up;(function(i){i.serialize=e=>{var t;return{...I_(e),branches:(t=e.branches)==null?void 0:t.map(lp.serialize)}},i.deserialize=e=>{var t;return{...P_(e),branches:(t=e.branches)==null?void 0:t.map(lp.deserialize)}}})(up||(up={}));var wt;(function(i){i[i.Add=0]="Add",i[i.Update=1]="Update",i[i.DocumentSynced=2]="DocumentSynced",i[i.Remove=3]="Remove",i[i.IncrementPendingExtHosts=4]="IncrementPendingExtHosts",i[i.Retire=5]="Retire",i[i.AddTag=6]="AddTag",i[i.RemoveTag=7]="RemoveTag"})(wt||(wt={}));var dp;(function(i){i.deserialize=(e,t)=>t.op===wt.Add?{op:t.op,item:Rs.deserialize(e,t.item)}:t.op===wt.Update?{op:t.op,item:Ku.deserialize(t.item)}:t.op===wt.DocumentSynced?{op:t.op,uri:e.asCanonicalUri(y.revive(t.uri)),docv:t.docv}:t,i.serialize=e=>e.op===wt.Add?{op:e.op,item:Rs.serialize(e.item)}:e.op===wt.Update?{op:e.op,item:Ku.serialize(e.item)}:e})(dp||(dp={}));class wP{constructor(e){this.uriIdentity=e,this._tags=new Map,this.items=new Map,this.roots=new Set,this.busyControllerCount=0,this.pendingRootCount=0,this.tags=this._tags}apply(e){var n;const t=this.createChangeCollector();for(const r of e)switch(r.op){case wt.Add:this.add(Rs.deserialize(this.uriIdentity,r.item),t);break;case wt.Update:this.update(Ku.deserialize(r.item),t);break;case wt.Remove:this.remove(r.itemId,t);break;case wt.Retire:this.retireTest(r.itemId);break;case wt.IncrementPendingExtHosts:this.updatePendingRoots(r.amount);break;case wt.AddTag:this._tags.set(r.tag.id,r.tag);break;case wt.RemoveTag:this._tags.delete(r.id);break}(n=t.complete)==null||n.call(t)}add(e,t){var s,o;const n=(s=Ie.parentId(e.item.extId))==null?void 0:s.toString();let r;if(!n)r=this.createItem(e),this.roots.add(r),this.items.set(e.item.extId,r);else if(this.items.has(n)){const a=this.items.get(n);a.children.add(e.item.extId),r=this.createItem(e,a),this.items.set(e.item.extId,r)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return(o=t.add)==null||o.call(t,r),e.expand===wi.BusyExpanding&&this.busyControllerCount++,r}update(e,t){var r;const n=this.items.get(e.extId);if(n)return e.expand!==void 0&&(n.expand===wi.BusyExpanding&&this.busyControllerCount--,e.expand===wi.BusyExpanding&&this.busyControllerCount++),k_(n,e),(r=t.update)==null||r.call(t,n),n}remove(e,t){var o,a;const n=this.items.get(e);if(!n)return;const r=(o=Ie.parentId(n.item.extId))==null?void 0:o.toString();r?this.items.get(r).children.delete(n.item.extId):this.roots.delete(n);const s=[[e]];for(;s.length;)for(const l of s.pop()){const c=this.items.get(l);c&&(s.push(c.children),this.items.delete(l),(a=t.remove)==null||a.call(t,c,c!==n),c.expand===wi.BusyExpanding&&this.busyControllerCount--)}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}}var di;(function(i){i[i.Upsert=0]="Upsert",i[i.SetTags=1]="SetTags",i[i.UpdateCanResolveChildren=2]="UpdateCanResolveChildren",i[i.RemoveChild=3]="RemoveChild",i[i.SetProp=4]="SetProp",i[i.Bulk=5]="Bulk",i[i.DocumentSynced=6]="DocumentSynced"})(di||(di={}));const Zu=(i,e)=>i===e,bP=Object.entries({range:(i,e)=>i===e?!0:!i||!e?!1:i.equalsRange(e),busy:Zu,label:Zu,description:Zu,error:Zu,sortText:Zu,tags:(i,e)=>!(i.length!==e.length||i.some(t=>!e.includes(t)))}),yP=(i,e)=>{let t;for(const[n,r]of bP)r(i[n],e[n])||(t?t[n]=e[n]:t={[n]:e[n]});return t};class xP extends Re{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new ll(()=>this.flushDiff(),200)),this.diffOpEmitter=this._register(new L),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const t of this.tree.values())this.updateExpandability(t)}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case wt.DocumentSynced:{for(const t of this.diff)if(t.op===wt.DocumentSynced&&t.uri===e.uri){t.docv=e.docv;return}break}case wt.Update:{const t=this.diff[this.diff.length-1];if(t){if(t.op===wt.Update&&t.item.extId===e.item.extId){k_(t.item,e.item);return}if(t.op===wt.Add&&t.item.item.extId===e.item.extId){k_(t.item,e.item);return}}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){var r;const n=this.tree.get(e);if(n){if((n.expandLevels===void 0||t>n.expandLevels)&&(n.expandLevels=t),n.expand===wi.Expandable){const s=this.resolveChildren(n);return s.isOpen()?this.expandChildren(n,t-1):s.wait().then(()=>this.expandChildren(n,t-1))}else if(n.expand===wi.Expanded)return((r=n.resolveBarrier)==null?void 0:r.isOpen())===!1?n.resolveBarrier.wait().then(()=>this.expandChildren(n,t-1)):this.expandChildren(n,t-1)}}dispose(){for(const e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case di.RemoveChild:this.removeItem(Ie.joinToString(e.fullId,t.id));break;case di.Upsert:this.upsertItem(t.item,e);break;case di.Bulk:for(const n of t.ops)this.onTestItemEvent(e,n);break;case di.SetTags:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case di.UpdateCanResolveChildren:this.updateExpandability(e);break;case di.SetProp:this.pushDiff({op:wt.Update,item:{extId:e.fullId.toString(),item:t.update}});break;case di.DocumentSynced:this.documentSynced(e.actual.uri);break;default:_P()}}documentSynced(e){e&&this.pushDiff({op:wt.DocumentSynced,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){var u,d;const n=Ie.fromExtHostTestItem(e,this.root.id,t==null?void 0:t.actual),r=this.options.getApiFor(e);r.parent&&r.parent!==(t==null?void 0:t.actual)&&this.options.getChildren(r.parent).delete(e.id);let s=this.tree.get(n.toString());if(!s){s={fullId:n,actual:e,expandLevels:t!=null&&t.expandLevels?t.expandLevels-1:void 0,expand:wi.NotExpandable},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(s.fullId.toString(),s),this.setItemParent(e,t),this.pushDiff({op:wt.Add,item:{controllerId:this.options.controllerId,expand:s.expand,item:this.options.toITestItem(e)}}),this.connectItemAndChildren(e,s,t);return}if(s.actual===e){this.connectItem(e,s,t);return}if(((u=s.actual.uri)==null?void 0:u.toString())!==((d=e.uri)==null?void 0:d.toString()))return this.removeItem(n.toString()),this.upsertItem(e,t);const o=this.options.getChildren(s.actual),a=s.actual,l=yP(this.options.toITestItem(a),this.options.toITestItem(e));this.options.getApiFor(a).listener=void 0,s.actual=e,s.resolveBarrier=void 0,s.expand=wi.NotExpandable,l&&(l.hasOwnProperty("tags")&&(this.diffTagRefs(e.tags,a.tags,n.toString()),delete l.tags),this.onTestItemEvent(s,{op:di.SetProp,update:l})),this.connectItemAndChildren(e,s,t);for(const[f,p]of o)this.options.getChildren(e).get(p.id)||this.removeItem(Ie.joinToString(n,p.id));const c=s.expandLevels;c!==void 0&&queueMicrotask(()=>{s.expand===wi.Expandable&&(s.expandLevels=void 0,this.expand(n.toString(),c))}),this.documentSynced(s.actual.uri)}diffTagRefs(e,t,n){const r=new Set(t.map(s=>s.id));for(const s of e)r.delete(s.id)||this.incrementTagRefs(s);this.pushDiff({op:wt.Update,item:{extId:n,item:{tags:e.map(s=>op(this.options.controllerId,s.id))}}}),r.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:wt.AddTag,tag:{id:op(this.options.controllerId,e.id)}}))}decrementTagRefs(e){const t=this.tags.get(e);t&&!--t.refCount&&(this.tags.delete(e),this.pushDiff({op:wt.RemoveTag,id:op(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,n){this.setItemParent(e,n);const r=this.options.getApiFor(e);r.parent=n==null?void 0:n.actual,r.listener=s=>this.onTestItemEvent(t,s),this.updateExpandability(t)}connectItemAndChildren(e,t,n){this.connectItem(e,t,n);for(const[r,s]of this.options.getChildren(e))this.upsertItem(s,t)}updateExpandability(e){let t;this._resolveHandler?e.resolveBarrier?t=e.resolveBarrier.isOpen()?wi.Expanded:wi.BusyExpanding:t=e.actual.canResolveChildren?wi.Expandable:wi.NotExpandable:t=wi.NotExpandable,t!==e.expand&&(e.expand=t,this.pushDiff({op:wt.Update,item:{extId:e.fullId.toString(),expand:t}}),t===wi.Expandable&&e.expandLevels!==void 0&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;const n=[];for(const[r,s]of this.options.getChildren(e.actual)){const o=this.expand(Ie.joinToString(e.fullId,s.id),t);Cs(o)&&n.push(o)}if(n.length)return Promise.all(n).then(()=>{})}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){const s=new rr;return s.open(),s}e.expand=wi.BusyExpanding,this.pushExpandStateUpdate(e);const t=e.resolveBarrier=new rr,n=s=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,s)};let r;try{r=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(s){n(s)}return Cs(r)?r.catch(n).then(()=>{t.open(),this.updateExpandability(e)}):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:wt.Update,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:wt.Remove,itemId:e});const n=[t];for(;n.length;){const r=n.pop();if(r){this.options.getApiFor(r.actual).listener=void 0;for(const s of r.actual.tags)this.decrementTagRefs(s.id);this.tree.delete(r.fullId.toString());for(const[s,o]of this.options.getChildren(r.actual))n.push(this.tree.get(Ie.joinToString(r.fullId,o.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}}class EP extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class hp extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class SP extends Error{constructor(e,t,n){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${n}".`)}}const DP=(i,e,t)=>{let n=new Map;return{get size(){return n.size},forEach(r,s){for(const o of n.values())r.call(s,o,this)},[Symbol.iterator](){return n.entries()},replace(r){var l;const s=new Map,o=new Set(n.keys()),a={op:di.Bulk,ops:[]};for(const c of r){if(!(c instanceof t))throw new hp(c.id);const u=e(c).controllerId;if(u!==i.controllerId)throw new SP(c.id,u,i.controllerId);if(s.has(c.id))throw new EP(c.id);s.set(c.id,c),o.delete(c.id),a.ops.push({op:di.Upsert,item:c})}for(const c of o.keys())a.ops.push({op:di.RemoveChild,id:c});(l=i.listener)==null||l.call(i,a),n=s},add(r){var s;if(!(r instanceof t))throw new hp(r.id);n.set(r.id,r),(s=i.listener)==null||s.call(i,{op:di.Upsert,item:r})},delete(r){var s;n.delete(r)&&((s=i.listener)==null||s.call(i,{op:di.RemoveChild,id:r}))},get(r){return n.get(r)},toJSON(){return Array.from(n.values())}}},yE=new WeakMap,kP=(i,e)=>{const t={controllerId:e};return yE.set(i,t),t},fp=i=>{const e=yE.get(i);if(!e)throw new hp((i==null?void 0:i.id)||"<unknown>");return e};class CP{constructor(){this.data=new Map}add(e,t){Zi(Ge(e)),Zi(Bt(t)),Zi(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}}const hi=new CP;function T_(i,e){return e&&(i.stack||i.stacktrace)?h(568,"{0}: {1}",EE(i),xE(i.stack)||xE(i.stacktrace)):EE(i)}function xE(i){return Array.isArray(i)?i.join(`
`):i}function EE(i){return i.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${i.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof i.code=="string"&&typeof i.errno=="number"&&typeof i.syscall=="string"?h(569,"A system error occurred ({0})",i.message):i.message||h(570,"An unknown error occurred. Please consult the log for more details.")}function $o(i=null,e=!1){if(!i)return h(570,"An unknown error occurred. Please consult the log for more details.");if(Array.isArray(i)){const t=Ti(i),n=$o(t[0],e);return t.length>1?h(571,"{0} ({1} errors in total)",n,t.length):n}if(Ge(i))return i;if(i.detail){const t=i.detail;if(t.error)return T_(t.error,e);if(t.exception)return T_(t.exception,e)}return i.stack?T_(i,e):i.message?i.message:h(570,"An unknown error occurred. Please consult the log for more details.")}class IP extends Re{constructor(e,t="",n="",r=!0,s){super(),this._onDidChange=this._register(new L),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=n,this._enabled=r,this._actionCallback=s}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}const Qm=class Qm extends IP{constructor(){super(Qm.ID,h(1579,"(empty)"),void 0,!1)}};Qm.ID="vs.actions.empty";let SE=Qm;const PP={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},TP={id:"default",displayName:h(444,"Text Editor"),providerDisplayName:h(445,"Built-in")};var DE;(function(i){i[i.PROGRAMMATIC=1]="PROGRAMMATIC",i[i.USER=2]="USER",i[i.EDIT=3]="EDIT",i[i.NAVIGATION=4]="NAVIGATION",i[i.JUMP=5]="JUMP"})(DE||(DE={}));var kE;(function(i){i[i.IDENTICAL=1]="IDENTICAL",i[i.SIMILAR=2]="SIMILAR",i[i.DIFFERENT=3]="DIFFERENT"})(kE||(kE={}));var CE;(function(i){i[i.SHORT=0]="SHORT",i[i.MEDIUM=1]="MEDIUM",i[i.LONG=2]="LONG"})(CE||(CE={}));var Il;(function(i){i[i.EXPLICIT=1]="EXPLICIT",i[i.AUTO=2]="AUTO",i[i.FOCUS_CHANGE=3]="FOCUS_CHANGE",i[i.WINDOW_CHANGE=4]="WINDOW_CHANGE"})(Il||(Il={}));var IE;(function(i){i[i.None=0]="None",i[i.Readonly=2]="Readonly",i[i.Untitled=4]="Untitled",i[i.Singleton=8]="Singleton",i[i.RequiresTrust=16]="RequiresTrust",i[i.CanSplitInGroup=32]="CanSplitInGroup",i[i.ForceDescription=64]="ForceDescription",i[i.CanDropIntoEditor=128]="CanDropIntoEditor",i[i.MultipleEditors=256]="MultipleEditors",i[i.Scratchpad=512]="Scratchpad"})(IE||(IE={}));var PE;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.REPLACE=1]="REPLACE",i[i.MOVE=2]="MOVE",i[i.UNPIN=3]="UNPIN"})(PE||(PE={}));var TE;(function(i){i[i.GROUP_ACTIVE=0]="GROUP_ACTIVE",i[i.GROUP_INDEX=1]="GROUP_INDEX",i[i.GROUP_LABEL=2]="GROUP_LABEL",i[i.GROUP_LOCKED=3]="GROUP_LOCKED",i[i.EDITORS_SELECTION=4]="EDITORS_SELECTION",i[i.EDITOR_OPEN=5]="EDITOR_OPEN",i[i.EDITOR_CLOSE=6]="EDITOR_CLOSE",i[i.EDITOR_MOVE=7]="EDITOR_MOVE",i[i.EDITOR_ACTIVE=8]="EDITOR_ACTIVE",i[i.EDITOR_LABEL=9]="EDITOR_LABEL",i[i.EDITOR_CAPABILITIES=10]="EDITOR_CAPABILITIES",i[i.EDITOR_PIN=11]="EDITOR_PIN",i[i.EDITOR_TRANSIENT=12]="EDITOR_TRANSIENT",i[i.EDITOR_STICKY=13]="EDITOR_STICKY",i[i.EDITOR_DIRTY=14]="EDITOR_DIRTY",i[i.EDITOR_WILL_DISPOSE=15]="EDITOR_WILL_DISPOSE"})(TE||(TE={}));var AE;(function(i){i[i.PRIMARY=1]="PRIMARY",i[i.SECONDARY=2]="SECONDARY",i[i.BOTH=3]="BOTH",i[i.ANY=4]="ANY"})(AE||(AE={}));var RE;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.KEYBOARD=1]="KEYBOARD",i[i.MOUSE=2]="MOUSE"})(RE||(RE={}));var LE;(function(i){i[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT"})(LE||(LE={}));class AP{constructor(){this.editorSerializerConstructors=new Map,this.editorSerializerInstances=new Map}start(e){const t=this.instantiationService=e.get(kf);for(const[n,r]of this.editorSerializerConstructors)this.createEditorSerializer(n,r,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){const r=n.createInstance(t);this.editorSerializerInstances.set(e,r)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return al(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),Me(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}}hi.add(PP.EditorFactory,new AP);var NE;(function(i){i[i.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",i[i.SEQUENTIAL=1]="SEQUENTIAL"})(NE||(NE={}));const RP=(i,e)=>i===e;class OE{constructor(e,t,n){this.owner=e,this.debugNameSource=t,this.referenceFn=n}getDebugName(e){return LP(e,this)}}const FE=new Map,A_=new WeakMap;function LP(i,e){const t=A_.get(i);if(t)return t;const n=NP(i,e);if(n){let r=FE.get(n)??0;r++,FE.set(n,r);const s=r===1?n:`${n}#${r}`;return A_.set(i,s),s}}function NP(i,e){const t=A_.get(i);if(t)return t;const n=e.owner?FP(e.owner)+".":"";let r;const s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(r=s(),r!==void 0)return n+r}else return n+s;const o=e.referenceFn;if(o!==void 0&&(r=R_(o),r!==void 0))return n+r;if(e.owner!==void 0){const a=OP(e.owner,i);if(a!==void 0)return n+a}}function OP(i,e){for(const t in i)if(i[t]===e)return t}const ME=new Map,$E=new WeakMap;function FP(i){const e=$E.get(i);if(e)return e;const t=MP(i);let n=ME.get(t)??0;n++,ME.set(t,n);const r=n===1?t:`${t}#${n}`;return $E.set(i,r),r}function MP(i){const e=i.constructor;return e?e.name:"Object"}function R_(i){const e=i.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),r=n?n[1]:void 0;return r==null?void 0:r.trim()}let $P;function UP(){return $P}let HP,BP,UE;class WP{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const n=t===void 0?void 0:e,r=t===void 0?e:t;return UE({owner:n,debugName:()=>{const s=R_(r);if(s!==void 0)return s;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(r.toString());if(a)return`${this.debugName}.${a[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:r},s=>r(this.read(s),s))}flatten(){return UE({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(HP(this,t)),this}keepObserved(e){return e.add(BP(this)),this}get debugValue(){return this.get()}}class VP extends WP{constructor(){super(...arguments),this.observers=new Set}addObserver(e){const t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}class zP{constructor(e,t){this._fn=e,this._getDebugName=t,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():R_(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.updatingObservers;for(let t=0;t<e.length;t++){const{observer:n,observable:r}=e[t];n.endUpdate(r)}this.updatingObservers=null}}function qP(i,e){let t;return typeof i=="string"?t=new OE(void 0,i,void 0):t=new OE(i,void 0,void 0),new jP(t,e,RP)}class jP extends VP{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,n){super(),this._debugNameData=e,this._equalityComparator=n,this._value=t}get(){return this._value}set(e,t,n){var s;if(n===void 0&&this._equalityComparator(this._value,e))return;let r;t||(t=r=new zP(()=>{},()=>`Setting ${this.debugName}`));try{const o=this._value;this._setValue(e),(s=UP())==null||s.handleObservableChanged(this,{oldValue:o,newValue:e,change:n,didChange:!0,hadValue:!0});for(const a of this.observers)t.updateObserver(a,this),a.handleChange(this,n)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}const GP=ke("contextKeyService");function L_(i){if(!i)return;const e=i.indexOf("+");return e<0?i:i.substr(0,e)}const QP=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var HE;(function(i){i[i.System=0]="System",i[i.User=1]="User"})(HE||(HE={}));var N_;(function(i){i.WIN32_X64="win32-x64",i.WIN32_ARM64="win32-arm64",i.LINUX_X64="linux-x64",i.LINUX_ARM64="linux-arm64",i.LINUX_ARMHF="linux-armhf",i.ALPINE_X64="alpine-x64",i.ALPINE_ARM64="alpine-arm64",i.DARWIN_X64="darwin-x64",i.DARWIN_ARM64="darwin-arm64",i.WEB="web",i.UNIVERSAL="universal",i.UNKNOWN="unknown",i.UNDEFINED="undefined"})(N_||(N_={}));class ot{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const n=typeof e=="string"?e:e.value,r=typeof t=="string"?t:t.value;return Ss(n,r)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class Uo{get size(){return this._set.size}constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(ot.toKey(e))}delete(e){return this._set.delete(ot.toKey(e))}has(e){return this._set.has(ot.toKey(e))}}class Vr{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(ot.toKey(e))}get(e){return this._map.get(ot.toKey(e))}has(e){return this._map.has(ot.toKey(e))}set(e,t){this._map.set(ot.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}}const JP=ke("productService");var ti;(function(i){i[i.APPLICATION=1]="APPLICATION",i[i.USER=2]="USER",i[i.USER_LOCAL=3]="USER_LOCAL",i[i.USER_REMOTE=4]="USER_REMOTE",i[i.WORKSPACE=5]="WORKSPACE",i[i.WORKSPACE_FOLDER=6]="WORKSPACE_FOLDER",i[i.DEFAULT=7]="DEFAULT",i[i.MEMORY=8]="MEMORY"})(ti||(ti={}));function O_(i,e){const t=Object.create(null);for(const n in i)BE(t,n,i[n],e);return t}function BE(i,e,t,n){const r=e.split("."),s=r.pop();let o=i;for(let a=0;a<r.length;a++){const l=r[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){n(`Ignoring ${e} as ${r.slice(0,a+1).join(".")} is null`);return}break;default:n(`Ignoring ${e} as ${r.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[s]=t}catch{n(`Ignoring ${e} as ${r.join(".")} is ${JSON.stringify(o)}`)}else n(`Ignoring ${e} as ${r.join(".")} is ${JSON.stringify(o)}`)}function XP(i,e){const t=e.split(".");WE(i,t)}function WE(i,e){const t=e.shift();if(e.length===0){delete i[t];return}if(Object.keys(i).indexOf(t)!==-1){const n=i[t];typeof n=="object"&&!Array.isArray(n)&&(WE(n,e),Object.keys(n).length===0&&delete i[t])}}function pp(i,e,t){function n(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const r=e.split("."),s=n(i,r);return typeof s>"u"?t:s}function YP(i){return i.replace(/[\[\]]/g,"")}function KP(i){let e=!1;const t=new Map,n=new Map;if(ZP(i,u=>{if(i===u)return!0;const d=JSON.stringify(u);if(d.length<30)return!0;const f=t.get(d);if(!f){const p={schemas:[u]};return t.set(d,p),n.set(u,p),!0}return f.schemas.push(u),n.set(u,f),e=!0,!1}),t.clear(),!e)return JSON.stringify(i);let s="$defs";for(;i.hasOwnProperty(s);)s+="_";const o=[];function a(u){return JSON.stringify(u,(d,f)=>{if(f!==u){const p=n.get(f);if(p&&p.schemas.length>1)return p.id||(p.id=`_${o.length}`,o.push(p.schemas[0])),{$ref:`#/${s}/${p.id}`}}return f})}const l=a(i),c=[];for(let u=0;u<o.length;u++)c.push(`"_${u}":${a(o[u])}`);return c.length?`${l.substring(0,l.length-1)},"${s}":{${c.join(",")}}}`:l}function Pl(i){return typeof i=="object"&&i!==null}function ZP(i,e){if(!i||typeof i!="object")return;const t=(...l)=>{for(const c of l)Pl(c)&&o.push(c)},n=(...l)=>{for(const c of l)if(Pl(c))for(const u in c){const d=c[u];Pl(d)&&o.push(d)}},r=(...l)=>{for(const c of l)if(Array.isArray(c))for(const u of c)Pl(u)&&o.push(u)},s=l=>{if(Array.isArray(l))for(const c of l)Pl(c)&&o.push(c);else Pl(l)&&o.push(l)},o=[i];let a=o.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),r(a.anyOf,a.allOf,a.oneOf,a.prefixItems),s(a.items)),a=o.pop()}const gp={JSONContribution:"base.contributions.json"};function eT(i){return i.length>0&&i.charAt(i.length-1)==="#"?i.substring(0,i.length-1):i}class tT{constructor(){this._onDidChangeSchema=new L,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(e,t){this.schemasById[eT(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){const t=this.schemasById[e];return t?KP(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}}const iT=new tT;hi.add(gp.JSONContribution,iT);var VE;(function(i){i.Multiline="multilineText",i.Singleline="singlelineText"})(VE||(VE={}));const Tl={Configuration:"base.contributions.configuration"};var Ot;(function(i){i[i.APPLICATION=1]="APPLICATION",i[i.MACHINE=2]="MACHINE",i[i.WINDOW=3]="WINDOW",i[i.RESOURCE=4]="RESOURCE",i[i.LANGUAGE_OVERRIDABLE=5]="LANGUAGE_OVERRIDABLE",i[i.MACHINE_OVERRIDABLE=6]="MACHINE_OVERRIDABLE"})(Ot||(Ot={}));const Ho="vscode://schemas/settings/resourceLanguage",mp=hi.as(gp.JSONContribution);class nT{constructor(){this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=new L,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new L,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h(472,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},mp.registerSchema(Ho,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const n=new Set;this.doRegisterConfigurations(e,t,n),mp.registerSchema(Ho,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){const t=new Set;this.doDeregisterConfigurations(e,t),mp.registerSchema(Ho,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){const n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),mp.registerSchema(Ho,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const n=[];for(const{overrides:r,source:s}of e)for(const o in r){t.add(o);const a=this.configurationDefaultsOverrides.get(o)??this.configurationDefaultsOverrides.set(o,{configurationDefaultOverrides:[]}).get(o),l=r[o];if(a.configurationDefaultOverrides.push({value:l,source:s}),ur.test(o)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(o,l,s,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(o,c,s),n.push(...ed(o))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(o,l,s,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const u=this.configurationProperties[o];u&&(this.updatePropertyDefaultValue(o,u),this.updateSchema(o,u))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){const t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(const n of e){const r=this.registeredConfigurationDefaults.indexOf(n);r!==-1&&this.registeredConfigurationDefaults.splice(r,1)}for(const{overrides:n,source:r}of e)for(const s in n){const o=this.configurationDefaultsOverrides.get(s);if(!o)continue;const a=o.configurationDefaultOverrides.findIndex(l=>{var c;return r?((c=l.source)==null?void 0:c.id)===r.id:l.value===n[s]});if(a!==-1){if(o.configurationDefaultOverrides.splice(a,1),o.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(s),ur.test(s)){let l;for(const c of o.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(s,c.value,c.source,l);l&&!Px(l.value)?(o.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(s,l,r)):(this.configurationDefaultsOverrides.delete(s),delete this.configurationProperties[s],delete this.defaultLanguageConfigurationOverridesNode.properties[s])}else{let l;for(const u of o.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(s,u.value,u.source,l);o.configurationDefaultOverrideValue=l;const c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}t.add(s)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){const r={type:"object",default:t.value,description:h(473,"Configure settings to be overridden for the {0} language.",YP(e)),$ref:Ho,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=r,this.defaultLanguageConfigurationOverridesNode.properties[e]=r}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,r){const s=(r==null?void 0:r.value)||{},o=(r==null?void 0:r.source)??new Map;if(!(o instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(Bt(l)&&(Eu(s[a])||Bt(s[a]))){if(s[a]={...s[a]??{},...l},n)for(const u in l)o.set(`${a}.${u}`,n)}else s[a]=l,n?o.set(a,n):o.delete(a)}return{value:s,source:o}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,r){const s=this.configurationProperties[e],o=(r==null?void 0:r.value)??(s==null?void 0:s.defaultDefaultValue);let a=n;if(Bt(t)&&(s!==void 0&&s.type==="object"||s===void 0&&(Eu(o)||Bt(o)))){if(a=(r==null?void 0:r.source)??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)n&&a.set(`${e}.${c}`,n);t={...Bt(o)?o:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1;const n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(r=>{this.validateAndRegisterProperties(r,t,r.extensionInfo,r.restrictedProperties,void 0,n),this.configurationContributors.push(r),this.registerJSONConfiguration(r)})}doDeregisterConfigurations(e,t){const n=r=>{var s,o;if(r.properties)for(const a in r.properties){t.add(a);const l=this.configurationProperties[a];(s=l==null?void 0:l.policy)!=null&&s.name&&this.policyConfigurations.delete(l.policy.name),delete this.configurationProperties[a],this.removeFromSchema(a,r.properties[a])}(o=r.allOf)==null||o.forEach(a=>n(a))};for(const r of e){n(r);const s=this.configurationContributors.indexOf(r);s!==-1&&this.configurationContributors.splice(s,1)}}validateAndRegisterProperties(e,t=!0,n,r,s=Ot.WINDOW,o){var c;s=Wt(e.scope)?s:e.scope;const a=e.properties;if(a)for(const u in a){const d=a[u];if(t&&oT(u,d)){delete a[u];continue}if(d.source=n,d.defaultDefaultValue=a[u].default,this.updatePropertyDefaultValue(u,d),ur.test(u)?d.scope=void 0:(d.scope=Wt(d.scope)?s:d.scope,d.restricted=Wt(d.restricted)?!!(r!=null&&r.includes(u)):d.restricted),a[u].hasOwnProperty("included")&&!a[u].included){this.excludedConfigurationProperties[u]=a[u],delete a[u];continue}else this.configurationProperties[u]=a[u],(c=a[u].policy)!=null&&c.name&&this.policyConfigurations.set(a[u].policy.name,u);!a[u].deprecationMessage&&a[u].markdownDeprecationMessage&&(a[u].deprecationMessage=a[u].markdownDeprecationMessage),o.add(u)}const l=e.allOf;if(l)for(const u of l)this.validateAndRegisterProperties(u,t,n,r,s,o)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){const t=n=>{const r=n.properties;if(r)for(const o in r)this.updateSchema(o,r[o]);const s=n.allOf;s==null||s.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case Ot.APPLICATION:break;case Ot.MACHINE:break;case Ot.MACHINE_OVERRIDABLE:break;case Ot.WINDOW:break;case Ot.RESOURCE:break;case Ot.LANGUAGE_OVERRIDABLE:this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(t.scope){case Ot.APPLICATION:break;case Ot.MACHINE:break;case Ot.MACHINE_OVERRIDABLE:break;case Ot.WINDOW:break;case Ot.RESOURCE:case Ot.LANGUAGE_OVERRIDABLE:delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,n={type:"object",description:h(474,"Configure editor settings to be overridden for a language."),errorMessage:h(475,"This setting does not support per-language configuration."),$ref:Ho};this.updatePropertyDefaultValue(t,n)}}registerOverridePropertyPatternKey(){h(474,"Configure editor settings to be overridden for a language."),h(475,"This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){var o;const n=(o=this.configurationDefaultsOverrides.get(e))==null?void 0:o.configurationDefaultOverrideValue;let r,s;n&&(!t.disallowConfigurationDefault||!n.source)&&(r=n.value,s=n.source),Eu(r)&&(r=t.defaultDefaultValue,s=void 0),Eu(r)&&(r=sT(t.type)),t.default=r,t.defaultValueSource=s}}const zE="\\[([^\\]]+)\\]",qE=new RegExp(zE,"g"),rT=`^(${zE})+$`,ur=new RegExp(rT);function ed(i){const e=[];if(ur.test(i)){let t=qE.exec(i);for(;t!=null&&t.length;){const n=t[1].trim();n&&e.push(n),t=qE.exec(i)}}return el(e)}function sT(i){switch(Array.isArray(i)?i[0]:i){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const _p=new nT;hi.add(Tl.Configuration,_p);function oT(i,e){var t,n,r,s;return i.trim()?ur.test(i)?h(477,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",i):_p.getConfigurationProperties()[i]!==void 0?h(478,"Cannot register '{0}'. This property is already registered.",i):(t=e.policy)!=null&&t.name&&_p.getPolicyConfigurations().get((n=e.policy)==null?void 0:n.name)!==void 0?h(479,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",i,(r=e.policy)==null?void 0:r.name,_p.getPolicyConfigurations().get((s=e.policy)==null?void 0:s.name)):null:h(476,"Cannot register an empty property")}function td(i){return F_(i,0)}function F_(i,e){switch(typeof i){case"object":return i===null?zr(349,e):Array.isArray(i)?lT(i,e):cT(i,e);case"string":return jE(i,e);case"boolean":return aT(i,e);case"number":return zr(i,e);case"undefined":return zr(937,e);default:return zr(617,e)}}function zr(i,e){return(e<<5)-e+i|0}function aT(i,e){return zr(i?433:863,e)}function jE(i,e){e=zr(149417,e);for(let t=0,n=i.length;t<n;t++)e=zr(i.charCodeAt(t),e);return e}function lT(i,e){return e=zr(104579,e),i.reduce((t,n)=>F_(n,t),e)}function cT(i,e){return e=zr(181387,e),Object.keys(i).sort().reduce((t,n)=>(t=jE(n,t),F_(i[n],t)),e)}var GE;(function(i){i[i.BLOCK_SIZE=64]="BLOCK_SIZE",i[i.UNICODE_REPLACEMENT=65533]="UNICODE_REPLACEMENT"})(GE||(GE={}));function uT(i){return Ds(i)}var Ye;(function(i){i[i.Off=0]="Off",i[i.Trace=1]="Trace",i[i.Debug=2]="Debug",i[i.Info=3]="Info",i[i.Warning=4]="Warning",i[i.Error=5]="Error"})(Ye||(Ye={}));const dT=Ye.Info;function hT(i,e,t){switch(e){case Ye.Trace:i.trace(t);break;case Ye.Debug:i.debug(t);break;case Ye.Info:i.info(t);break;case Ye.Warning:i.warn(t);break;case Ye.Error:i.error(t);break;case Ye.Off:break;default:throw new Error(`Invalid log level ${e}`)}}function Al(i,e=!1){let t="";for(let n=0;n<i.length;n++){let r=i[n];if(r instanceof Error&&(r=$o(r,e)),typeof r=="object")try{r=JSON.stringify(r)}catch{}t+=(n>0?" ":"")+r}return t}class QE extends Re{constructor(){super(...arguments),this.level=dT,this._onDidChangeLogLevel=this._register(new L),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Ye.Off&&this.level<=e}}class JE extends QE{constructor(e){super(),this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...t){this.checkLogLevel(Ye.Trace)&&this.log(Ye.Trace,Al([e,...t],!0))}debug(e,...t){this.checkLogLevel(Ye.Debug)&&this.log(Ye.Debug,Al([e,...t]))}info(e,...t){this.checkLogLevel(Ye.Info)&&this.log(Ye.Info,Al([e,...t]))}warn(e,...t){this.checkLogLevel(Ye.Warning)&&this.log(Ye.Warning,Al([e,...t]))}error(e,...t){if(this.checkLogLevel(Ye.Error))if(e instanceof Error){const n=Array.prototype.slice.call(arguments);n[0]=e.stack,this.log(Ye.Error,Al(n))}else this.log(Ye.Error,Al([e,...t]))}flush(){}}class fT extends QE{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const n of this.loggers)n.trace(e,...t)}debug(e,...t){for(const n of this.loggers)n.debug(e,...t)}info(e,...t){for(const n of this.loggers)n.info(e,...t)}warn(e,...t){for(const n of this.loggers)n.warn(e,...t)}error(e,...t){for(const n of this.loggers)n.error(e,...t)}flush(){for(const e of this.loggers)e.flush()}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class pT extends Re{constructor(e,t,n){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new $t,this._onDidChangeLoggers=this._register(new L),this.onDidChangeLoggers=this._onDidChangeLoggers.event,this._onDidChangeLogLevel=this._register(new L),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event,this._onDidChangeVisibility=this._register(new L),this.onDidChangeVisibility=this._onDidChangeVisibility.event,n)for(const r of n)this._loggers.set(r.resource,{logger:void 0,info:r})}getLoggerEntry(e){return Ge(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}getLogger(e){var t;return(t=this.getLoggerEntry(e))==null?void 0:t.logger}createLogger(e,t){var l;const n=this.toResource(e),r=Ge(e)?e:(t==null?void 0:t.id)??td(n.toString()).toString(16);let s=(l=this._loggers.get(n))==null?void 0:l.logger;const o=(t==null?void 0:t.logLevel)==="always"?Ye.Trace:t==null?void 0:t.logLevel;s||(s=this.doCreateLogger(n,o??this.getLogLevel(n)??this.logLevel,{...t,id:r}));const a={logger:s,info:{resource:n,id:r,logLevel:o,name:t==null?void 0:t.name,hidden:t==null?void 0:t.hidden,extensionId:t==null?void 0:t.extensionId,when:t==null?void 0:t.when}};return this.registerLogger(a.info),this._loggers.set(n,a),s}toResource(e){return Ge(e)?Li(this.logsHome,`${e}.log`):e}setLogLevel(e,t){var n,r,s;if(y.isUri(e)){const o=e,a=t,l=this._loggers.get(o);l&&a!==l.info.logLevel&&(l.info.logLevel=a===this.logLevel?void 0:a,(n=l.logger)==null||n.setLevel(a),this._loggers.set(l.info.resource,l),this._onDidChangeLogLevel.fire([o,a]))}else{this.logLevel=e;for(const[o,a]of this._loggers.entries())((r=this._loggers.get(o))==null?void 0:r.info.logLevel)===void 0&&((s=a.logger)==null||s.setLevel(this.logLevel));this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,t){const n=this.getLoggerEntry(e);n&&t!==!n.info.hidden&&(n.info.hidden=!t,this._loggers.set(n.info.resource,n),this._onDidChangeVisibility.fire([n.info.resource,t]))}getLogLevel(e){var n;let t;return e&&(t=(n=this._loggers.get(e))==null?void 0:n.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this._loggers.get(e);t&&(t.logger&&t.logger.dispose(),this._loggers.delete(e),this._onDidChangeLoggers.fire({added:[],removed:[t.info]}))}*getRegisteredLoggers(){for(const e of this._loggers.values())yield e.info}getRegisteredLogger(e){var t;return(t=this._loggers.get(e))==null?void 0:t.info}dispose(){this._loggers.forEach(e=>{var t;return(t=e.logger)==null?void 0:t.dispose()}),this._loggers.clear(),super.dispose()}}function gT(i){switch(i){case Ye.Trace:return"trace";case Ye.Debug:return"debug";case Ye.Info:return"info";case Ye.Warning:return"warn";case Ye.Error:return"error";case Ye.Off:return"off"}}function mT(i){switch(i){case"trace":return Ye.Trace;case"debug":return Ye.Debug;case"info":return Ye.Info;case"warn":return Ye.Warning;case"error":return Ye.Error;case"critical":return Ye.Error;case"off":return Ye.Off}}new X("logLevel",gT(Ye.Info));function _T(i){return i.res.statusCode&&i.res.statusCode>=200&&i.res.statusCode<300||i.res.statusCode===1223}function vT(i){return i.res.statusCode===204}async function wT(i){if(!_T(i))throw new Error("Server returned "+i.res.statusCode);if(vT(i))return null;const t=(await G5(i.stream)).toString();try{return JSON.parse(t)}catch(n){throw n.message+=`:
`+t,n}}let M_;function bT(i){const e=hi.as(Tl.Configuration),t=M_;M_={id:"http",order:15,title:h(4566,"HTTP"),type:"object",scope:i,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:h(4567,"The proxy setting to use. If not set, will be inherited from the `http_proxy` and `https_proxy` environment variables."),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,description:h(4568,"Controls whether the proxy server certificate should be verified against the list of supplied CAs."),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:h(4569,"Overrides the principal service name for Kerberos authentication with the HTTP proxy. A default based on the proxy hostname is used when this is not set."),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:h(4570,"Specifies domain names for which proxy settings should be ignored for HTTP/HTTPS requests."),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:h(4571,"The value to send as the `Proxy-Authorization` header for every network request."),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[h(4572,"Disable proxy support for extensions."),h(4573,"Enable proxy support for extensions."),h(4574,"Enable proxy support for extensions, fall back to request options, when no proxy found."),h(4575,"Enable proxy support for extensions, override request options.")],default:"override",description:h(4576,"Use the proxy support for extensions."),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,description:h(4577,"Controls whether CA certificates should be loaded from the OS. (On Windows and macOS, a reload of the window is required after turning this off.)"),restricted:!0},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,description:h(4578,"Controls whether experimental loading of CA certificates from the OS should be enabled. This uses a more general approach than the default implemenation."),restricted:!0}}},e.updateConfigurations({add:[M_],remove:t?[t]:[]})}bT(Ot.APPLICATION);const yT=ke("requestService");var id;(function(i){i[i.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",i[i.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(id||(id={}));var Vn;(function(i){i[i.None=0]="None",i[i.Initialized=1]="Initialized",i[i.Closed=2]="Closed"})(Vn||(Vn={}));const Jm=class Jm extends Re{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new pf),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=Vn.None,this.cache=new Map,this.flushDelayer=this._register(new kI(Jm.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,n;this._onDidChangeStorage.pause();try{(t=e.changed)==null||t.forEach((r,s)=>this.acceptExternal(s,r)),(n=e.deleted)==null||n.forEach(r=>this.acceptExternal(r,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===Vn.Closed)return;let n=!1;Wt(t)?n=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),n=!0),n&&this._onDidChangeStorage.fire({key:e,external:!0})}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===Vn.None&&(this.state=Vn.Initialized,this.options.hint!==id.STORAGE_DOES_NOT_EXIST&&(this.cache=await this.database.getItems()))}get(e,t){const n=this.cache.get(e);return Wt(n)?t:n}getBoolean(e,t){const n=this.get(e);return Wt(n)?t:n==="true"}getNumber(e,t){const n=this.get(e);return Wt(n)?t:parseInt(n,10)}getObject(e,t){const n=this.get(e);return Wt(n)?t:O2(n)}async set(e,t,n=!1){if(this.state===Vn.Closed)return;if(Wt(t))return this.delete(e,n);const r=Bt(t)||Array.isArray(t)?t9(t):String(t);if(this.cache.get(e)!==r)return this.cache.set(e,r),this.pendingInserts.set(e,r),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:n}),this.doFlush()}async delete(e,t=!1){if(!(this.state===Vn.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}async optimize(){if(this.state!==Vn.Closed)return await this.flush(0),this.database.optimize()}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=Vn.Closed;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())==null||t()})}async flush(e){if(!(this.state===Vn.Closed||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===id.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}isInMemory(){return this.options.hint===id.STORAGE_IN_MEMORY}};Jm.DEFAULT_FLUSH_DELAY=100;let XE=Jm;const xT=ke("environmentService"),ET=ke("fileService"),ST=ke("IUriIdentityService");var YE;(function(i){i.Settings="settings",i.Keybindings="keybindings",i.Snippets="snippets",i.Tasks="tasks",i.Extensions="extensions",i.GlobalState="globalState"})(YE||(YE={}));function DT(i){const e=i;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&y.isUri(e.location)&&y.isUri(e.globalStorageHome)&&y.isUri(e.settingsResource)&&y.isUri(e.keybindingsResource)&&y.isUri(e.tasksResource)&&y.isUri(e.snippetsHome)&&y.isUri(e.extensionsResource))}function vp(i,e,t,n,r,s){var o,a,l,c,u,d;return{id:i,name:e,location:t,isDefault:!1,shortName:r==null?void 0:r.shortName,icon:r==null?void 0:r.icon,globalStorageHome:s&&((o=r==null?void 0:r.useDefaultFlags)!=null&&o.globalState)?s.globalStorageHome:Li(t,"globalStorage"),settingsResource:s&&((a=r==null?void 0:r.useDefaultFlags)!=null&&a.settings)?s.settingsResource:Li(t,"settings.json"),keybindingsResource:s&&((l=r==null?void 0:r.useDefaultFlags)!=null&&l.keybindings)?s.keybindingsResource:Li(t,"keybindings.json"),tasksResource:s&&((c=r==null?void 0:r.useDefaultFlags)!=null&&c.tasks)?s.tasksResource:Li(t,"tasks.json"),snippetsHome:s&&((u=r==null?void 0:r.useDefaultFlags)!=null&&u.snippets)?s.snippetsHome:Li(t,"snippets"),extensionsResource:s&&((d=r==null?void 0:r.useDefaultFlags)!=null&&d.extensions)?s.extensionsResource:Li(t,"extensions.json"),cacheHome:Li(n,i),useDefaultFlags:r==null?void 0:r.useDefaultFlags,isTransient:r==null?void 0:r.transient}}let KE=(Sa=class extends Re{get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}constructor(e,t,n,r){super(),this.environmentService=e,this.fileService=t,this.uriIdentityService=n,this.logService=r,this.enabled=!0,this._onDidChangeProfiles=this._register(new L),this.onDidChangeProfiles=this._onDidChangeProfiles.event,this._onWillCreateProfile=this._register(new L),this.onWillCreateProfile=this._onWillCreateProfile.event,this._onWillRemoveProfile=this._register(new L),this.onWillRemoveProfile=this._onWillRemoveProfile.event,this._onDidResetWorkspaces=this._register(new L),this.onDidResetWorkspaces=this._onDidResetWorkspaces.event,this.profileCreationPromises=new Map,this.transientProfilesObject={profiles:[],folders:new $t,workspaces:new $t,emptyWindows:new Map},this.profilesHome=Li(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=Li(this.environmentService.cacheHome,"CachedProfilesData")}init(){this._profilesObject=void 0}setEnablement(e){this.enabled!==e&&(this._profilesObject=void 0,this.enabled=e)}isEnabled(){return this.enabled}get profilesObject(){if(!this._profilesObject){const e=this.createDefaultProfile(),t=[e];if(this.enabled)try{for(const s of this.getStoredProfiles()){if(!s.name||!Ge(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}t.push(vp(xo(s.location),s.name,s.location,this.profilesCacheHome,{shortName:s.shortName,icon:s.icon,useDefaultFlags:s.useDefaultFlags},e))}}catch(s){this.logService.error(s)}const n=new $t,r=new Map;if(t.length)try{const s=this.getStoredProfileAssociations();if(s.workspaces)for(const[o,a]of Object.entries(s.workspaces)){const l=y.parse(o),c=t.find(u=>u.id===a);c&&n.set(l,c)}if(s.emptyWindows)for(const[o,a]of Object.entries(s.emptyWindows)){const l=t.find(c=>c.id===a);l&&r.set(o,l)}}catch(s){this.logService.error(s)}this._profilesObject={profiles:t,workspaces:n,emptyWindows:r}}return this._profilesObject}createDefaultProfile(){const e=vp("__default__profile__",h(567,"Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:!0}}async createTransientProfile(e){const t="Temp",n=new RegExp(`${wo(t)}\\s(\\d+)`);let r=0;for(const o of this.profiles){const a=n.exec(o.name),l=a?parseInt(a[1]):0;r=l>r?l:r}const s=`${t} ${r+1}`;return this.createProfile(td(Un()).toString(16),s,{transient:!0},e)}async createNamedProfile(e,t,n){return this.createProfile(td(Un()).toString(16),e,t,n)}async createProfile(e,t,n,r){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");const s=await this.doCreateProfile(e,t,n);return r&&await this.setProfileForWorkspace(r,s),s}async doCreateProfile(e,t,n){if(!Ge(t)||!t)throw new Error("Name of the profile is mandatory and must be of type `string`");let r=this.profileCreationPromises.get(t);return r||(r=(async()=>{try{if(this.profiles.find(l=>l.name===t||l.id===e))throw new Error(`Profile with ${t} name already exists`);const o=vp(e,t,Li(this.profilesHome,e),this.profilesCacheHome,n,this.defaultProfile);await this.fileService.createFolder(o.location);const a=[];return this._onWillCreateProfile.fire({profile:o,join(l){a.push(l)}}),await ul.settled(a),this.updateProfiles([o],[],[]),o}finally{this.profileCreationPromises.delete(t)}})(),this.profileCreationPromises.set(t,r)),r}async updateProfile(e,t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");let n=this.profiles.find(r=>r.id===e.id);if(!n)throw new Error(`Profile '${e.name}' does not exist`);return n=vp(n.id,t.name??n.name,n.location,this.profilesCacheHome,{shortName:t.shortName??n.shortName,icon:t.icon===null?void 0:t.icon??n.icon,transient:t.transient??n.isTransient,useDefaultFlags:t.useDefaultFlags??n.useDefaultFlags},this.defaultProfile),this.updateProfiles([],[],[n]),n}async removeProfile(e){var r,s;if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");if(e.isDefault)throw new Error("Cannot remove default profile");const t=this.profiles.find(o=>o.id===e.id);if(!t)throw new Error(`Profile '${e.name}' does not exist`);const n=[];this._onWillRemoveProfile.fire({profile:t,join(o){n.push(o)}});try{await Promise.allSettled(n)}catch(o){this.logService.error(o)}for(const o of[...this.profilesObject.emptyWindows.keys()])t.id===((r=this.profilesObject.emptyWindows.get(o))==null?void 0:r.id)&&this.profilesObject.emptyWindows.delete(o);for(const o of[...this.profilesObject.workspaces.keys()])t.id===((s=this.profilesObject.workspaces.get(o))==null?void 0:s.id)&&this.profilesObject.workspaces.delete(o);this.updateStoredProfileAssociations(),this.updateProfiles([],[t],[]);try{await this.fileService.del(t.cacheHome,{recursive:!0})}catch(o){ZI(o)!==fn.FILE_NOT_FOUND&&this.logService.error(o)}}async setProfileForWorkspace(e,t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");const n=this.profiles.find(r=>r.id===t.id);if(!n)throw new Error(`Profile '${t.name}' does not exist`);this.updateWorkspaceAssociation(e,n)}unsetWorkspace(e,t){if(!this.enabled)throw new Error("Profiles are disabled in the current environment.");this.updateWorkspaceAssociation(e,void 0,t)}async resetWorkspaces(){this.transientProfilesObject.folders.clear(),this.transientProfilesObject.workspaces.clear(),this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.workspaces.clear(),this.profilesObject.emptyWindows.clear(),this.updateStoredProfileAssociations(),this._onDidResetWorkspaces.fire()}async cleanUp(){if(this.enabled&&await this.fileService.exists(this.profilesHome)){const e=await this.fileService.resolve(this.profilesHome);await Promise.all((e.children||[]).filter(t=>t.isDirectory&&this.profiles.every(n=>!this.uriIdentityService.extUri.isEqual(n.location,t.resource))).map(t=>this.fileService.del(t.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){if(!this.enabled)return;const e=this.transientProfilesObject.profiles.filter(t=>!this.isProfileAssociatedToWorkspace(t));await Promise.allSettled(e.map(t=>this.removeProfile(t)))}getProfileForWorkspace(e){const t=this.getWorkspace(e),n=y.isUri(t)?this.profilesObject.workspaces.get(t):this.profilesObject.emptyWindows.get(t);return n||(d_(e)?this.transientProfilesObject.folders.get(e.uri):h_(e)?this.transientProfilesObject.workspaces.get(e.configPath):this.transientProfilesObject.emptyWindows.get(e.id))}getWorkspace(e){return d_(e)?e.uri:h_(e)?e.configPath:e.id}isProfileAssociatedToWorkspace(e){return!!([...this.profilesObject.emptyWindows.values()].some(t=>this.uriIdentityService.extUri.isEqual(t.location,e.location))||[...this.profilesObject.workspaces.values()].some(t=>this.uriIdentityService.extUri.isEqual(t.location,e.location))||[...this.transientProfilesObject.emptyWindows.values()].some(t=>this.uriIdentityService.extUri.isEqual(t.location,e.location))||[...this.transientProfilesObject.workspaces.values()].some(t=>this.uriIdentityService.extUri.isEqual(t.location,e.location))||[...this.transientProfilesObject.folders.values()].some(t=>this.uriIdentityService.extUri.isEqual(t.location,e.location)))}updateProfiles(e,t,n){const r=[...this.profiles,...e],s=[],o=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];for(let a of r){if(a.isDefault||t.some(c=>a.id===c.id))continue;a=n.find(c=>a.id===c.id)??a;const l=o.find(c=>a.id===c.id);if(a.isTransient)this.transientProfilesObject.profiles.push(a);else{if(l){for(const[c,u]of this.transientProfilesObject.emptyWindows.entries())if(a.id===u.id){this.updateWorkspaceAssociation({id:c},a);break}for(const[c,u]of this.transientProfilesObject.workspaces.entries())if(a.id===u.id){this.updateWorkspaceAssociation({id:"",configPath:c},a);break}for(const[c,u]of this.transientProfilesObject.folders.entries())if(a.id===u.id){this.updateWorkspaceAssociation({id:"",uri:c},a);break}}s.push({location:a.location,name:a.name,shortName:a.shortName,icon:a.icon,useDefaultFlags:a.useDefaultFlags})}}this.saveStoredProfiles(s),this._profilesObject=void 0,this.triggerProfilesChanges(e,t,n)}triggerProfilesChanges(e,t,n){this._onDidChangeProfiles.fire({added:e,removed:t,updated:n,all:this.profiles})}updateWorkspaceAssociation(e,t,n){if(n=t!=null&&t.isTransient?!0:n,n)d_(e)?(this.transientProfilesObject.folders.delete(e.uri),t&&this.transientProfilesObject.folders.set(e.uri,t)):h_(e)?(this.transientProfilesObject.workspaces.delete(e.configPath),t&&this.transientProfilesObject.workspaces.set(e.configPath,t)):(this.transientProfilesObject.emptyWindows.delete(e.id),t&&this.transientProfilesObject.emptyWindows.set(e.id,t));else{this.updateWorkspaceAssociation(e,void 0,!0);const r=this.getWorkspace(e);y.isUri(r)?(this.profilesObject.workspaces.delete(r),t&&this.profilesObject.workspaces.set(r,t)):(this.profilesObject.emptyWindows.delete(r),t&&this.profilesObject.emptyWindows.set(r,t)),this.updateStoredProfileAssociations()}}updateStoredProfileAssociations(){const e={};for(const[n,r]of this.profilesObject.workspaces.entries())e[n.toString()]=r.id;const t={};for(const[n,r]of this.profilesObject.emptyWindows.entries())t[n.toString()]=r.id;this.saveStoredProfileAssociations({workspaces:e,emptyWindows:t}),this._profilesObject=void 0}migrateStoredProfileAssociations(e){const t={},n=this.createDefaultProfile();if(e.workspaces)for(const[s,o]of Object.entries(e.workspaces)){const a=y.parse(o);t[s]=this.uriIdentityService.extUri.isEqual(a,n.location)?n.id:this.uriIdentityService.extUri.basename(a)}const r={};if(e.emptyWindows)for(const[s,o]of Object.entries(e.emptyWindows)){const a=y.parse(o);r[s]=this.uriIdentityService.extUri.isEqual(a,n.location)?n.id:this.uriIdentityService.extUri.basename(a)}return{workspaces:t,emptyWindows:r}}getStoredProfiles(){return[]}saveStoredProfiles(e){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}},Sa.PROFILES_KEY="userDataProfiles",Sa.PROFILE_ASSOCIATIONS_KEY="profileAssociations",Sa);KE=B([O(0,xT),O(1,ET),O(2,ST),O(3,rt)],KE);const kT="__$__isNewStorageMarker",wp="__$__targetStorageMarker";var Rl;(function(i){i[i.NONE=0]="NONE",i[i.SHUTDOWN=1]="SHUTDOWN"})(Rl||(Rl={}));var jt;(function(i){i[i.APPLICATION=-1]="APPLICATION",i[i.PROFILE=0]="PROFILE",i[i.WORKSPACE=1]="WORKSPACE"})(jt||(jt={}));var $_;(function(i){i[i.USER=0]="USER",i[i.MACHINE=1]="MACHINE"})($_||($_={}));function CT(i){const e=i.get(wp);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}const Xm=class Xm extends Re{constructor(e={flushInterval:Xm.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new pf),this._onDidChangeTarget=this._register(new pf),this.onDidChangeTarget=this._onDidChangeTarget.event,this._onWillSaveState=this._register(new L),this.onWillSaveState=this._onWillSaveState.event,this.flushWhenIdleScheduler=this._register(new ll(()=>this.doFlushWhenIdle(),this.options.flushInterval)),this.runFlushWhenIdle=this._register(new po),this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(e,t,n){return Ht.filter(this._onDidChangeValue.event,r=>r.scope===e&&(t===void 0||r.key===t),n)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Ux(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){Ar([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{Ui("code/willInitStorage");try{await this.doInitialize()}finally{Ui("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(e,t){const{key:n,external:r}=t;if(n===wp){switch(e){case jt.APPLICATION:this._applicationKeyTargets=void 0;break;case jt.PROFILE:this._profileKeyTargets=void 0;break;case jt.WORKSPACE:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:n,target:this.getKeyTargets(e)[n],external:r})}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,t,n){var r;return(r=this.getStorage(t))==null?void 0:r.get(e,n)}getBoolean(e,t,n){var r;return(r=this.getStorage(t))==null?void 0:r.getBoolean(e,n)}getNumber(e,t,n){var r;return(r=this.getStorage(t))==null?void 0:r.getNumber(e,n)}getObject(e,t,n){var r;return(r=this.getStorage(t))==null?void 0:r.getObject(e,n)}storeAll(e,t){this.withPausedEmitters(()=>{for(const n of e)this.store(n.key,n.value,n.scope,n.target,t)})}store(e,t,n,r,s=!1){if(Wt(t)){this.remove(e,n,s);return}this.withPausedEmitters(()=>{var o;this.updateKeyTarget(e,n,r),(o=this.getStorage(n))==null||o.set(e,t,s)})}remove(e,t,n=!1){this.withPausedEmitters(()=>{var r;this.updateKeyTarget(e,t,void 0),(r=this.getStorage(t))==null||r.delete(e,n)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(e,t){const n=[],r=this.getKeyTargets(e);for(const s of Object.keys(r))r[s]===t&&n.push(s);return n}updateKeyTarget(e,t,n,r=!1){var o,a;const s=this.getKeyTargets(t);typeof n=="number"?s[e]!==n&&(s[e]=n,(o=this.getStorage(t))==null||o.set(wp,JSON.stringify(s),r)):typeof s[e]=="number"&&(delete s[e],(a=this.getStorage(t))==null||a.set(wp,JSON.stringify(s),r))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(jt.WORKSPACE)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(jt.PROFILE)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(jt.APPLICATION)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case jt.APPLICATION:return this.applicationKeyTargets;case jt.PROFILE:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?CT(t):Object.create(null)}isNew(e){return this.getBoolean(kT,e)===!0}async flush(e=Rl.NONE){this._onWillSaveState.fire({reason:e});const t=this.getStorage(jt.APPLICATION),n=this.getStorage(jt.PROFILE),r=this.getStorage(jt.WORKSPACE);switch(e){case Rl.NONE:await ul.settled([(t==null?void 0:t.whenFlushed())??Promise.resolve(),(n==null?void 0:n.whenFlushed())??Promise.resolve(),(r==null?void 0:r.whenFlushed())??Promise.resolve()]);break;case Rl.SHUTDOWN:await ul.settled([(t==null?void 0:t.flush(0))??Promise.resolve(),(n==null?void 0:n.flush(0))??Promise.resolve(),(r==null?void 0:r.flush(0))??Promise.resolve()]);break}}async log(){var r,s,o;const e=((r=this.getStorage(jt.APPLICATION))==null?void 0:r.items)??new Map,t=((s=this.getStorage(jt.PROFILE))==null?void 0:s.items)??new Map,n=((o=this.getStorage(jt.WORKSPACE))==null?void 0:o.items)??new Map;return IT(e,t,n,this.getLogDetails(jt.APPLICATION)??"",this.getLogDetails(jt.PROFILE)??"",this.getLogDetails(jt.WORKSPACE)??"")}async optimize(e){var t;return await this.flush(),(t=this.getStorage(e))==null?void 0:t.optimize()}async switch(e,t){return this.emitWillSaveState(Rl.NONE),DT(e)?this.switchToProfile(e,t):this.switchToWorkspace(e,t)}canSwitchProfile(e,t){return!(e.id===t.id||eS(t)&&eS(e))}switchData(e,t,n){this.withPausedEmitters(()=>{const r=new Set;for(const[s,o]of e)r.add(s),t.get(s)!==o&&this.emitDidChangeValue(n,{key:s,external:!0});for(const[s]of t.items)r.has(s)||this.emitDidChangeValue(n,{key:s,external:!0})})}};Xm.DEFAULT_FLUSH_INTERVAL=60*1e3;let ZE=Xm;function eS(i){var e;return i.isDefault||!!((e=i.useDefaultFlags)!=null&&e.globalState)}async function IT(i,e,t,n,r,s){const o=w=>{try{return JSON.parse(w)}catch{return w}},a=new Map,l=new Map;i.forEach((w,v)=>{a.set(v,w),l.set(v,o(w))});const c=new Map,u=new Map;e.forEach((w,v)=>{c.set(v,w),u.set(v,o(w))});const d=new Map,f=new Map;t.forEach((w,v)=>{d.set(v,w),f.set(v,o(w))}),console.group(n!==r?`Storage: Application (path: ${n})`:`Storage: Application & Profile (path: ${n}, default profile)`);const p=[];if(a.forEach((w,v)=>{p.push({key:v,value:w})}),console.table(p),console.groupEnd(),console.log(l),n!==r){console.group(`Storage: Profile (path: ${r}, profile specific)`);const w=[];c.forEach((v,S)=>{w.push({key:S,value:v})}),console.table(w),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${s})`);const b=[];d.forEach((w,v)=>{b.push({key:v,value:w})}),console.table(b),console.groupEnd(),console.log(f)}const PT=ke("storageService");new X("chatSessionResponseVote","",{type:"string",description:h(7024,"When the response has been voted up, is set to 'up'. When voted down, is set to 'down'. Otherwise an empty string.")}),new X("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:h(7025,"When the agent or command was automatically detected")}),new X("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:h(7026,"True when the current chat response supports issue reporting.")}),new X("chatSessionResponseFiltered",!1,{type:"boolean",description:h(7027,"True when the chat response was filtered out by the server.")}),new X("chatSessionRequestInProgress",!1,{type:"boolean",description:h(7028,"True when the current request is still in progress.")}),new X("chatResponse",!1,{type:"boolean",description:h(7029,"The chat item is a response.")}),new X("chatRequest",!1,{type:"boolean",description:h(7030,"The chat item is a request")}),new X("chatEditApplied",!1,{type:"boolean",description:h(7031,"True when the chat text edits have been applied.")}),new X("chatInputHasText",!1,{type:"boolean",description:h(7032,"True when the chat input has text.")}),new X("chatInputHasFocus",!1,{type:"boolean",description:h(7033,"True when the chat input has focus.")}),new X("inChatInput",!1,{type:"boolean",description:h(7034,"True when focus is in the chat input, false otherwise.")}),new X("inChat",!1,{type:"boolean",description:h(7035,"True when focus is in the chat widget, false otherwise.")});const TT=new X("chatIsEnabled",!1,{type:"boolean",description:h(7036,"True when chat is enabled because a default chat participant is registered.")});new X("chatCursorAtTop",!1),new X("chatInputHasAgent",!1),new X("chatLocation",void 0),new X("quickChatHasFocus",!1,{type:"boolean",description:h(7037,"True when the quick chat UI has focus, false otherwise.")});var nd,Wi;(function(i){i.Panel="panel",i.Terminal="terminal",i.Notebook="notebook",i.Editor="editor"})(Wi||(Wi={})),function(i){function e(t){switch(t){case"panel":return i.Panel;case"terminal":return i.Terminal;case"notebook":return i.Notebook;case"editor":return i.Editor}return i.Panel}i.fromRaw=e}(Wi||(Wi={}));let tS=(Nc=class{constructor(e){this.contextKeyService=e,this._agents=new Map,this._onDidChangeAgents=new L,this.onDidChangeAgents=this._onDidChangeAgents.event,this._agentCompletionProviders=new Map,this._hasDefaultAgent=TT.bindTo(this.contextKeyService)}registerAgent(e,t){if(this.getAgent(e))throw new Error(`Agent already registered: ${JSON.stringify(e)}`);const r=this,s=t.slashCommands;t={...t,get slashCommands(){return s.filter(a=>!a.when||r.contextKeyService.contextMatchesRules(Xt.deserialize(a.when)))}};const o={data:t};return this._agents.set(e,o),Me(()=>{this._agents.delete(e),this._onDidChangeAgents.fire(void 0)})}registerAgentImplementation(e,t){const n=this._agents.get(e);if(!n)throw new Error(`Unknown agent: ${JSON.stringify(e)}`);if(n.impl)throw new Error(`Agent already has implementation: ${JSON.stringify(e)}`);return n.data.isDefault&&this._hasDefaultAgent.set(!0),n.impl=t,this._onDidChangeAgents.fire(new bp(n.data,t)),Me(()=>{n.impl=void 0,this._onDidChangeAgents.fire(void 0),n.data.isDefault&&this._hasDefaultAgent.set(!1)})}registerDynamicAgent(e,t){e.isDynamic=!0;const n={data:e,impl:t};return this._agents.set(e.id,n),this._onDidChangeAgents.fire(new bp(e,t)),Me(()=>{this._agents.delete(e.id),this._onDidChangeAgents.fire(void 0)})}registerAgentCompletionProvider(e,t){return this._agentCompletionProviders.set(e,t),{dispose:()=>{this._agentCompletionProviders.delete(e)}}}async getAgentCompletionItems(e,t,n){var r;return await((r=this._agentCompletionProviders.get(e))==null?void 0:r(t,n))??[]}updateAgent(e,t){const n=this._agents.get(e);if(!(n!=null&&n.impl))throw new Error(`No activated agent with id ${JSON.stringify(e)} registered`);n.data.metadata={...n.data.metadata,...t},this._onDidChangeAgents.fire(new bp(n.data,n.impl))}getDefaultAgent(e){return E5(this.getActivatedAgents(),t=>!!t.isDefault&&t.locations.includes(e))}getContributedDefaultAgent(e){return this.getAgents().find(t=>!!t.isDefault&&t.locations.includes(e))}getSecondaryAgent(){var e;return(e=yn.find(this._agents.values(),t=>!!t.data.metadata.isSecondary))==null?void 0:e.data}getAgent(e){var t;if(this._agentIsEnabled(e))return(t=this._agents.get(e))==null?void 0:t.data}_agentIsEnabled(e){const t=this._agents.get(e);return!(t!=null&&t.data.when)||this.contextKeyService.contextMatchesRules(Xt.deserialize(t.data.when))}getAgentByFullyQualifiedId(e){var n;const t=(n=yn.find(this._agents.values(),r=>AT(r.data)===e))==null?void 0:n.data;if(!(t&&!this._agentIsEnabled(t.id)))return t}getAgents(){return Array.from(this._agents.values()).map(e=>e.data).filter(e=>this._agentIsEnabled(e.id))}getActivatedAgents(){return Array.from(this._agents.values()).filter(e=>!!e.impl).filter(e=>this._agentIsEnabled(e.data.id)).map(e=>new bp(e.data,e.impl))}getAgentsByName(e){return this.getAgents().filter(t=>t.name===e)}agentHasDupeName(e){const t=this.getAgent(e);return t?this.getAgentsByName(t.name).filter(n=>n.extensionId.value!==t.extensionId.value).length>0:!1}async invokeAgent(e,t,n,r,s){const o=this._agents.get(e);if(!(o!=null&&o.impl))throw new Error(`No activated agent with id "${e}"`);return await o.impl.invoke(t,n,r,s)}async getFollowups(e,t,n,r,s){var a;const o=this._agents.get(e);if(!(o!=null&&o.impl))throw new Error(`No activated agent with id "${e}"`);return(a=o.impl)!=null&&a.provideFollowups?o.impl.provideFollowups(t,n,r,s):[]}},Nc.AGENT_LEADER="@",Nc);tS=B([O(0,GP)],tS);class bp{constructor(e,t){this.data=e,this.impl=t}get id(){return this.data.id}get name(){return this.data.name??""}get fullName(){return this.data.fullName??""}get description(){return this.data.description??""}get extensionId(){return this.data.extensionId}get extensionPublisherId(){return this.data.extensionPublisherId}get extensionPublisherDisplayName(){return this.data.publisherDisplayName}get extensionDisplayName(){return this.data.extensionDisplayName}get isDefault(){return this.data.isDefault}get metadata(){return this.data.metadata}get slashCommands(){return this.data.slashCommands}get locations(){return this.data.locations}async invoke(e,t,n,r){return this.impl.invoke(e,t,n,r)}async provideFollowups(e,t,n,r){return this.impl.provideFollowups?this.impl.provideFollowups(e,t,n,r):[]}provideWelcomeMessage(e,t){if(this.impl.provideWelcomeMessage)return this.impl.provideWelcomeMessage(e,t)}provideSampleQuestions(e,t){if(this.impl.provideSampleQuestions)return this.impl.provideSampleQuestions(e,t)}}let iS=(Da=class{constructor(e,t,n,r){if(this.requestService=t,this.logService=n,this.storageService=r,this.registry=qP(this,Object.create(null)),this.disposed=!1,!e.chatParticipantRegistry)return;this.url=e.chatParticipantRegistry;const s=r.get(nd.StorageKey,jt.APPLICATION);try{this.registry.set(JSON.parse(s??"{}"),void 0)}catch{r.remove(nd.StorageKey,jt.APPLICATION)}this.refresh()}refresh(){this.disposed||this.update().catch(e=>this.logService.warn("Failed to fetch chat participant registry",e)).then(()=>Or(5*60*1e3)).then(()=>this.refresh())}async update(){const e=await this.requestService.request({type:"GET",url:this.url},Nt.None);if(e.res.statusCode!==200)throw new Error("Could not get extensions report.");const t=await wT(e);if(!t||t.version!==1)throw new Error("Unexpected chat participant registry response.");const n=t.restrictedChatParticipants;this.registry.set(n,void 0),this.storageService.store(nd.StorageKey,JSON.stringify(n),jt.APPLICATION,$_.MACHINE)}getAgentNameRestriction(e){const t=this.checkAgentNameRestriction(e.name,e).get(),n=!e.fullName||this.checkAgentNameRestriction(e.fullName.replace(/\s/g,""),e).get();return t&&n}checkAgentNameRestriction(e,t){return this.registry.map(r=>r[e.toLowerCase()]).map(r=>r?r.some(s=>Ss(s,s.includes(".")?t.extensionId.value:t.extensionPublisherId)):!0)}dispose(){this.disposed=!0}},nd=Da,Da.StorageKey="chat.participantNameRegistry",Da);iS=nd=B([O(0,JP),O(1,yT),O(2,rt),O(3,PT)],iS);function AT(i){return`${i.extensionId.value}.${i.id}`}const nS="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$";var rS;(function(i){i.COMMAND="command",i.SETTINGS_SYNC="settingsSync"})(rS||(rS={}));var sS;(function(i){i[i.NoneOrRelevance=0]="NoneOrRelevance",i[i.LastUpdatedDate=1]="LastUpdatedDate",i[i.Title=2]="Title",i[i.PublisherName=3]="PublisherName",i[i.InstallCount=4]="InstallCount",i[i.PublishedDate=10]="PublishedDate",i[i.AverageRating=6]="AverageRating",i[i.WeightedRating=12]="WeightedRating"})(sS||(sS={}));var oS;(function(i){i[i.Default=0]="Default",i[i.Ascending=1]="Ascending",i[i.Descending=2]="Descending"})(oS||(oS={}));var aS;(function(i){i.Install="install",i.Uninstall="uninstall"})(aS||(aS={}));var lS;(function(i){i[i.None=1]="None",i[i.Install=2]="Install",i[i.Update=3]="Update",i[i.Migrate=4]="Migrate"})(lS||(lS={}));var cS;(function(i){i.Timeout="Timeout",i.Cancelled="Cancelled",i.Failed="Failed",i.DownloadFailedWriting="DownloadFailedWriting"})(cS||(cS={}));var uS;(function(i){i.Unsupported="Unsupported",i.Deprecated="Deprecated",i.Malicious="Malicious",i.Incompatible="Incompatible",i.IncompatibleApi="IncompatibleApi",i.IncompatibleTargetPlatform="IncompatibleTargetPlatform",i.ReleaseVersionNotFound="ReleaseVersionNotFound",i.Invalid="Invalid",i.Download="Download",i.DownloadSignature="DownloadSignature",i.DownloadFailedWriting="DownloadFailedWriting",i.UpdateMetadata="UpdateMetadata",i.Extract="Extract",i.Scanning="Scanning",i.ScanningExtension="ScanningExtension",i.ReadUninstalled="ReadUninstalled",i.UnsetUninstalled="UnsetUninstalled",i.Delete="Delete",i.Rename="Rename",i.IntializeDefaultProfile="IntializeDefaultProfile",i.AddToProfile="AddToProfile",i.InstalledExtensionNotFound="InstalledExtensionNotFound",i.PostInstall="PostInstall",i.CorruptZip="CorruptZip",i.IncompleteZip="IncompleteZip",i.Signature="Signature",i.NotAllowed="NotAllowed",i.Gallery="Gallery",i.Cancelled="Cancelled",i.Unknown="Unknown",i.Internal="Internal"})(uS||(uS={})),l_(1580,"Extensions"),l_(1581,"Preferences");var Bo;(function(i){i[i.NONE=0]="NONE",i[i.CRASH=1]="CRASH",i[i.ERROR=2]="ERROR",i[i.USAGE=3]="USAGE"})(Bo||(Bo={}));var dS;(function(i){i.OFF="off",i.CRASH="crash",i.ERROR="error",i.ON="all"})(dS||(dS={}));class U_{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}}const RT="extensionTelemetryLog",LT=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function NT(i){if(!i)return"none";const e=L_(i);return LT.has(e)?e:"other"}function OT(i,e){if(!i||!i.includes("/")&&!i.includes("\\"))return i;let t=i;const n=[];for(const a of e)for(;;){const l=a.exec(i);if(!l)break;n.push([l.index,a.lastIndex])}const r=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(t="";;){const a=s.exec(i);if(!a)break;const l=n.some(([c,u])=>a.index<u&&c<s.lastIndex);!r.test(a[0])&&!l&&(t+=i.substring(o,a.index)+"<REDACTED: user-file-path>",o=s.lastIndex)}return o<i.length&&(t+=i.substr(o)),t}function FT(i){if(!i)return i;const e=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Email",regex:/@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/}];for(const t of e)if(t.regex.test(i))return`<REDACTED: ${t.label}>`;return i}function hS(i,e){return Af(i,t=>{if(t instanceof U_||Object.hasOwnProperty.call(t,"isTrustedTelemetryValue"))return t.value;if(typeof t=="string"){let n=t.replaceAll("%20"," ");n=OT(n,e);for(const r of e)n=n.replace(r,"");return n=FT(n),n}})}new ot("pprice.better-merge");class MT{constructor(){this._generators=new Map,this._cache=new WeakMap}register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const n of e){const r=this.readActivationEvents(n);r.length>0&&(t[ot.toKey(n.identifier)]=r)}return t}_readActivationEvents(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let n=0;n<t.length;n++)t[n]==="onUri"&&(t[n]=`onUri:${ot.toKey(e.identifier)}`);if(!e.contributes)return t;for(const n in e.contributes){const r=this._generators.get(n);if(!r)continue;const s=e.contributes[n],o=Array.isArray(s)?s:[s];try{r(o,t)}catch(a){ln(a)}}return t}}const $T=new MT,UT=Object.freeze({identifier:new ot("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:y.parse("void:location"),isBuiltin:!1,targetPlatform:N_.UNDEFINED,isUserBuiltin:!1,isUnderDevelopment:!1});class fS{constructor(e){this.dependency=e}}var pS;(function(i){i[i.EagerAutoStart=1]="EagerAutoStart",i[i.EagerManualStart=2]="EagerManualStart",i[i.Lazy=3]="Lazy"})(pS||(pS={}));function ii(i,e){return i.enabledApiProposals?i.enabledApiProposals.includes(e):!1}function M(i,e){var t;if(!ii(i,e))throw new Error(`Extension '${i.identifier.value}' CANNOT use API proposal: ${e}.
Its package.json#enabledApiProposals-property declares: ${((t=i.enabledApiProposals)==null?void 0:t.join(", "))??"[]"} but NOT ${e}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${i.identifier.value}`)}var H_;(function(i){i[i.Normal=0]="Normal",i[i.Immediate=1]="Immediate"})(H_||(H_={}));const HT=ke("extensionService"),BT="vscode://schemas/vscode-product",yp=Object.freeze({activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts"},aiTextSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProviderNew.d.ts"},attributableCoverage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.attributableCoverage.d.ts"},authGetSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authGetSessions.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:2},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},chatVariableResolver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatVariableResolver.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribIssueReporter:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribIssueReporter.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemChangesMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemChangesMenu.d.ts"},contribSourceControlHistoryItemGroupMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemGroupMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},createFileSystemWatcher:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.createFileSystemWatcher.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},documentPaste:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileComments:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileComments.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProviderNew.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts"},findFiles2New:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2New.d.ts"},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFilesNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFilesNew.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},lmTools:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.lmTools.d.ts",version:2},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},showLocal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.showLocal.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalShellIntegration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellIntegration.d.ts"},testMessageStackTrace:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testMessageStackTrace.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textSearchCompleteNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchCompleteNew.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProviderNew:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProviderNew.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}}),B_=hi.as(gp.JSONContribution);class rd{static _toSet(e){const t=new Uo;for(let n=0,r=e.length;n<r;n++)t.add(e[n].description.identifier);return t}static compute(e,t){if(!e||!e.length)return new rd(t,[]);if(!t||!t.length)return new rd([],e);const n=this._toSet(e),r=this._toSet(t),s=t.filter(a=>!n.has(a.description.identifier)),o=e.filter(a=>!r.has(a.description.identifier));return new rd(s,o)}constructor(e,t){this.added=e,this.removed=t}}class WT{constructor(e,t){this.name=e,this.defaultExtensionKind=t,this._handler=null,this._users=null,this._delta=null}setHandler(e){if(this._handler!==null)throw new Error("Handler already set!");return this._handler=e,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=rd.compute(this._users,e),this._users=e,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(e){ln(e)}}}const VT={type:"string",enum:["ui","workspace"],enumDescriptions:[h(4402,"UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h(4403,"Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]},gS="vscode://schemas/vscode-extensions",W_={properties:{engines:{type:"object",description:h(4404,"Engine compatibility."),properties:{vscode:{type:"string",description:h(4405,"For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h(4406,"The publisher of the VS Code extension."),type:"string"},displayName:{description:h(4407,"The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h(4408,"The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:QP},{type:"string",const:"Languages",deprecationMessage:h(4409,"Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h(4410,"Banner used in the VS Code marketplace."),properties:{color:{description:h(4411,"The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h(4412,"The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h(4413,"All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h(4414,"Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h(4415,"Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h(4416,"Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(yp).map(i=>i),markdownEnumDescriptions:Object.values(yp).map(i=>i.proposal)}},api:{markdownDescription:h(4417,"Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h(4418,"Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h(4419,"Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h(4420,"An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h(4421,"An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h(4422,"An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h(4423,"An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h(4424,'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h(4425,'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h(4426,"An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h(4427,"An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h(4428,"An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h(4429,"An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h(4430,"An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h(4431,"An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h(4432,"An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h(4433,"An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h(4434,"An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h(4435,"An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h(4436,"An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h(4437,"An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h(4438,"An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h(4439,"An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h(4440,"An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h(4441,"An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h(4442,"An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h(4443,"An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h(4444,"An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h(4445,"An activation event emitted when the specified chat participant is invoked.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolName}",description:h(4446,"An activation event emitted when the specified language model tool is invoked.")},{label:"*",description:h(4447,"An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h(4448,"Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h(4449,"Badge image URL.")},href:{type:"string",description:h(4450,"Badge link.")},description:{type:"string",description:h(4451,"Badge description.")}}}},markdown:{type:"string",description:h(4452,"Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h(4453,"Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:h(4454,"Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:nS}},extensionPack:{description:h(4455,"A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:nS}},extensionKind:{description:h(4456,"Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:VT,default:["workspace"],defaultSnippets:[{body:["ui"],description:h(4457,"Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h(4458,"Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h(4459,"Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h(4460,"Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h(4461,"Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h(4462,"Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h(4463,"Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:h(4464,"Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(4465,"The extension will be enabled in virtual workspaces with some functionality disabled."),h(4466,"The extension will be enabled in virtual workspaces with all functionality enabled."),h(4467,"The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h(4468,"A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h(4469,"Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h(4470,"Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(4471,"The extension will be enabled in untrusted workspaces with some functionality disabled."),h(4472,"The extension will be enabled in untrusted workspaces with all functionality enabled."),h(4473,"The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h(4474,"A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h(4475,"A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h(4476,"Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:h(4477,"URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h(4478,"Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h(4479,"Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h(4480,"The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h(4481,"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h(4482,"The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}};class zT{constructor(){this._extensionPoints=new Map}registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);const t=new WT(e.extensionPoint,e.defaultExtensionKind);return this._extensionPoints.set(e.extensionPoint,t),e.activationEventsGenerator&&$T.register(e.extensionPoint,e.activationEventsGenerator),W_.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,B_.registerSchema(gS,W_),t}getExtensionPoints(){return Array.from(this._extensionPoints.values())}}const mS={ExtensionsRegistry:"ExtensionsRegistry"};hi.add(mS.ExtensionsRegistry,new zT);const _S=hi.as(mS.ExtensionsRegistry);B_.registerSchema(gS,W_),B_.registerSchema(BT,{properties:{extensionEnabledApiProposals:{description:h(4483,"API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(yp),markdownEnumDescriptions:Object.values(yp).map(i=>i.proposal)}}]}}}});var qr;(function(i){i[i.System=0]="System",i[i.User=1]="User",i[i.Assistant=2]="Assistant"})(qr||(qr={}));const vS={type:"object",properties:{vendor:{type:"string",description:h(3049,"A globally unique vendor of language models.")}}},qT=_S.registerExtensionPoint({extensionPoint:"languageModels",jsonSchema:{description:h(3050,"Contribute language models of a specific vendor."),oneOf:[vS,{type:"array",items:vS}]},activationEventsGenerator:(i,e)=>{for(const t of i)e.push(`onLanguageModelChat:${t.vendor}`)}});let wS=class{constructor(e,t){this._extensionService=e,this._logService=t,this._store=new Le,this._providers=new Map,this._vendors=new Set,this._onDidChangeProviders=this._store.add(new L),this.onDidChangeLanguageModels=this._onDidChangeProviders.event,this._store.add(qT.setHandler(n=>{this._vendors.clear();for(const s of n){if(!ii(s.description,"chatProvider")){s.collector.error(h(3051,"This contribution point requires the 'chatProvider' proposal."));continue}for(const o of yn.wrap(s.value)){if(this._vendors.has(o.vendor)){s.collector.error(h(3052,"The vendor '{0}' is already registered and cannot be registered twice",o.vendor));continue}if(yu(o.vendor)){s.collector.error(h(3053,"The vendor field cannot be empty."));continue}if(o.vendor.trim()!==o.vendor){s.collector.error(h(3054,"The vendor field cannot start or end with whitespace."));continue}this._vendors.add(o.vendor)}}const r=[];for(const[s,o]of this._providers)this._vendors.has(o.metadata.vendor)||(this._providers.delete(s),r.push(s));r.length>0&&this._onDidChangeProviders.fire({removed:r})}))}dispose(){this._store.dispose(),this._providers.clear()}getLanguageModelIds(){return Array.from(this._providers.keys())}lookupLanguageModel(e){var t;return(t=this._providers.get(e))==null?void 0:t.metadata}async selectLanguageModels(e){if(e.vendor)await this._extensionService.activateByEvent(`onLanguageModelChat:${e.vendor}}`);else{const n=Array.from(this._vendors).map(r=>this._extensionService.activateByEvent(`onLanguageModelChat:${r}`));await Promise.all(n)}const t=[];for(const[n,r]of this._providers)(e.vendor===void 0||r.metadata.vendor===e.vendor)&&(e.family===void 0||r.metadata.family===e.family)&&(e.version===void 0||r.metadata.version===e.version)&&(e.identifier===void 0||r.metadata.id===e.identifier)&&(!r.metadata.targetExtensions||r.metadata.targetExtensions.some(s=>ot.equals(s,e.extension)))&&t.push(n);return this._logService.trace("[LM] selected language models",e,t),t}registerLanguageModelChat(e,t){if(this._logService.trace("[LM] registering language model chat",e,t.metadata),!this._vendors.has(t.metadata.vendor))throw new Error(`Chat response provider uses UNKNOWN vendor ${t.metadata.vendor}.`);if(this._providers.has(e))throw new Error(`Chat response provider with identifier ${e} is already registered.`);return this._providers.set(e,t),this._onDidChangeProviders.fire({added:[{identifier:e,metadata:t.metadata}]}),Me(()=>{this._providers.delete(e)&&(this._onDidChangeProviders.fire({removed:[e]}),this._logService.trace("[LM] UNregistered language model chat",e,t.metadata))})}async sendChatRequest(e,t,n,r,s){const o=this._providers.get(e);if(!o)throw new Error(`Chat response provider with identifier ${e} is not registered.`);return o.sendChatRequest(n,t,r,s)}computeTokenLength(e,t,n){const r=this._providers.get(e);if(!r)throw new Error(`Chat response provider with identifier ${e} is not registered.`);return r.provideTokenCount(t,n)}};wS=B([O(0,HT),O(1,rt)],wS),new X("debugType",void 0,{type:"string",description:h(6,"Debug type of the active debug session. For example 'python'.")}),new X("debugConfigurationType",void 0,{type:"string",description:h(7,"Debug type of the selected launch configuration. For example 'python'.")}),new X("debugState","inactive",{type:"string",description:h(8,"State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")});const jT="debugUx";new X(jT,"default",{type:"string",description:h(9,"Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")}),new X("hasDebugged",!1,{type:"boolean",description:h(10,"True when a debug session has been started at least once, false otherwise.")}),new X("inDebugMode",!1,{type:"boolean",description:h(11,"True when debugging, false otherwise.")}),new X("inDebugRepl",!1,{type:"boolean",description:h(12,"True when focus is in the debug console, false otherwise.")}),new X("breakpointWidgetVisible",!1,{type:"boolean",description:h(13,"True when breakpoint editor zone widget is visible, false otherwise.")}),new X("inBreakpointWidget",!1,{type:"boolean",description:h(14,"True when focus is in the breakpoint editor zone widget, false otherwise.")}),new X("breakpointsFocused",!0,{type:"boolean",description:h(15,"True when the BREAKPOINTS view is focused, false otherwise.")}),new X("watchExpressionsFocused",!0,{type:"boolean",description:h(16,"True when the WATCH view is focused, false otherwise.")}),new X("watchExpressionsExist",!1,{type:"boolean",description:h(17,"True when at least one watch expression exists, false otherwise.")}),new X("variablesFocused",!0,{type:"boolean",description:h(18,"True when the VARIABLES views is focused, false otherwise")}),new X("expressionSelected",!1,{type:"boolean",description:h(19,"True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")}),new X("breakpointInputFocused",!1,{type:"boolean",description:h(20,"True when the input box has focus in the BREAKPOINTS view.")}),new X("callStackItemType",void 0,{type:"string",description:h(21,"Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")}),new X("callStackSessionIsAttach",!1,{type:"boolean",description:h(22,"True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")}),new X("callStackItemStopped",!1,{type:"boolean",description:h(23,"True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")}),new X("callStackSessionHasOneThread",!1,{type:"boolean",description:h(24,"True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")}),new X("watchItemType",void 0,{type:"string",description:h(25,"Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")}),new X("canViewMemory",void 0,{type:"boolean",description:h(26,"Indicates whether the item in the view has an associated memory refrence.")}),new X("breakpointItemType",void 0,{type:"string",description:h(27,"Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")}),new X("breakpointItemBytes",void 0,{type:"boolean",description:h(28,"Whether the breakpoint item is a data breakpoint on a byte range.")}),new X("breakpointHasModes",!1,{type:"boolean",description:h(29,"Whether the breakpoint has multiple modes it can switch to.")}),new X("breakpointSupportsCondition",!1,{type:"boolean",description:h(30,"True when the focused breakpoint supports conditions.")}),new X("loadedScriptsSupported",!1,{type:"boolean",description:h(31,"True when the focused sessions supports the LOADED SCRIPTS view")}),new X("loadedScriptsItemType",void 0,{type:"string",description:h(32,"Represents the item type of the focused element in the LOADED SCRIPTS view.")}),new X("focusedSessionIsAttach",!1,{type:"boolean",description:h(33,"True when the focused session is 'attach'.")}),new X("focusedSessionIsNoDebug",!1,{type:"boolean",description:h(34,"True when the focused session is run without debugging.")}),new X("stepBackSupported",!1,{type:"boolean",description:h(35,"True when the focused session supports 'stepBack' requests.")}),new X("restartFrameSupported",!1,{type:"boolean",description:h(36,"True when the focused session supports 'restartFrame' requests.")}),new X("stackFrameSupportsRestart",!1,{type:"boolean",description:h(37,"True when the focused stack frame supports 'restartFrame'.")}),new X("jumpToCursorSupported",!1,{type:"boolean",description:h(38,"True when the focused session supports 'jumpToCursor' request.")}),new X("stepIntoTargetsSupported",!1,{type:"boolean",description:h(39,"True when the focused session supports 'stepIntoTargets' request.")}),new X("breakpointsExist",!1,{type:"boolean",description:h(40,"True when at least one breakpoint exists.")}),new X("debuggersAvailable",!1,{type:"boolean",description:h(41,"True when there is at least one debug extensions active.")}),new X("debugExtensionAvailable",!0,{type:"boolean",description:h(42,"True when there is at least one debug extension installed and enabled.")}),new X("debugProtocolVariableMenuContext",void 0,{type:"string",description:h(43,"Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")}),new X("debugSetVariableSupported",!1,{type:"boolean",description:h(44,"True when the focused session supports 'setVariable' request.")}),new X("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:h(45,"True when the focused session supports 'getBreakpointInfo' request on an address.")}),new X("debugSetExpressionSupported",!1,{type:"boolean",description:h(46,"True when the focused session supports 'setExpression' request.")}),new X("breakWhenValueChangesSupported",!1,{type:"boolean",description:h(47,"True when the focused session supports to break when value changes.")}),new X("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:h(48,"True when the focused breakpoint supports to break when value is accessed.")}),new X("breakWhenValueIsReadSupported",!1,{type:"boolean",description:h(49,"True when the focused breakpoint supports to break when value is read.")}),new X("terminateDebuggeeSupported",!1,{type:"boolean",description:h(50,"True when the focused session supports the terminate debuggee capability.")}),new X("suspendDebuggeeSupported",!1,{type:"boolean",description:h(51,"True when the focused session supports the suspend debuggee capability.")}),new X("variableEvaluateNamePresent",!1,{type:"boolean",description:h(52,"True when the focused variable has an 'evalauteName' field set.")}),new X("variableIsReadonly",!1,{type:"boolean",description:h(53,"True when the focused variable is read-only.")}),new X("variableValue",!1,{type:"string",description:h(54,"Value of the variable, present for debug visualization clauses.")}),new X("variableType",!1,{type:"string",description:h(55,"Type of the variable, present for debug visualization clauses.")}),new X("variableInterfaces",!1,{type:"array",description:h(56,"Any interfaces or contracts that the variable satisfies, present for debug visualization clauses.")}),new X("variableName",!1,{type:"string",description:h(57,"Name of the variable, present for debug visualization clauses.")}),new X("variableLanguage",!1,{type:"string",description:h(58,"Language of the variable source, present for debug visualization clauses.")}),new X("variableExtensionId",!1,{type:"string",description:h(59,"Extension ID of the variable source, present for debug visualization clauses.")}),new X("exceptionWidgetVisible",!1,{type:"boolean",description:h(60,"True when the exception widget is visible.")}),new X("multiSessionRepl",!1,{type:"boolean",description:h(61,"True when there is more than 1 debug console.")}),new X("multiSessionDebug",!1,{type:"boolean",description:h(62,"True when there is more than 1 active debug session.")}),new X("disassembleRequestSupported",!1,{type:"boolean",description:h(63,"True when the focused sessions supports disassemble request.")}),new X("disassemblyViewFocus",!1,{type:"boolean",description:h(64,"True when the Disassembly View is focused.")}),new X("languageSupportsDisassembleRequest",!1,{type:"boolean",description:h(65,"True when the language in the current editor supports disassemble request.")}),new X("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:h(66,"True when the focused stack frame has instruction pointer reference.")}),h(68,"Controls when the internal Debug Console should open.");var bS;(function(i){i[i.Inactive=0]="Inactive",i[i.Initializing=1]="Initializing",i[i.Stopped=2]="Stopped",i[i.Running=3]="Running"})(bS||(bS={}));var yS;(function(i){i[i.Valid=0]="Valid",i[i.Unreadable=1]="Unreadable",i[i.Error=2]="Error"})(yS||(yS={}));var xS;(function(i){i[i.Variable=0]="Variable",i[i.Address=1]="Address"})(xS||(xS={}));var xp;(function(i){i[i.Initial=1]="Initial",i[i.Dynamic=2]="Dynamic"})(xp||(xp={}));var ES;(function(i){i.UnverifiedBreakpoints="unverifiedBreakpoints"})(ES||(ES={}));var SS;(function(i){i[i.CONDITION=0]="CONDITION",i[i.HIT_COUNT=1]="HIT_COUNT",i[i.LOG_MESSAGE=2]="LOG_MESSAGE",i[i.TRIGGER_POINT=3]="TRIGGER_POINT"})(SS||(SS={}));var Ep;(function(i){i[i.Command=0]="Command",i[i.Tree=1]="Tree"})(Ep||(Ep={}));var V_;(function(i){i[i.None=0]="None",i[i.Collapsed=1]="Collapsed",i[i.Expanded=2]="Expanded"})(V_||(V_={}));var DS;(function(i){i.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:y.revive(e.iconPath.light),dark:y.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization}),i.serialize=e=>e})(DS||(DS={}));const sd="**",z_="/",Sp="[/\\\\]",Dp="[^/\\\\]",GT=/\//g;function kS(i,e){switch(i){case 0:return"";case 1:return`${Dp}*?`;default:return`(?:${Sp}|${Dp}+${Sp}${e?`|${Sp}${Dp}+`:""})*?`}}function q_(i,e){if(!i)return[];const t=[];let n=!1,r=!1,s="";for(const o of i){switch(o){case e:if(!n&&!r){t.push(s),s="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":r=!0;break;case"]":r=!1;break}s+=o}return s&&t.push(s),t}function CS(i){if(!i)return"";let e="";const t=q_(i,z_);if(t.every(n=>n===sd))e=".*";else{let n=!1;t.forEach((r,s)=>{if(r===sd){if(n)return;e+=kS(2,s===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const u of r){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let d;u==="-"?d=u:(u==="^"||u==="!")&&!c?d="^":u===z_?d="":d=wo(u),c+=d;continue}switch(u){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const f=`(?:${q_(a,",").map(p=>CS(p)).join("|")})`;e+=f,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=Dp;continue;case"*":e+=kS(1);continue;default:e+=wo(u)}}s<t.length-1&&(t[s+1]!==sd||s+2<t.length)&&(e+=Sp)}n=r===sd})}return e}const QT=/^\*\*\/\*\.[\w\.-]+$/,JT=/^\*\*\/([\w\.-]+)\/?$/,XT=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,YT=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,KT=/^\*\*((\/[\w\.-]+)+)\/?$/,ZT=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,IS=new A1(1e4),PS=function(){return!1},dr=function(){return null};function j_(i,e){if(!i)return dr;let t;typeof i!="string"?t=i.pattern:t=i,t=t.trim();const n=`${t}_${!!e.trimForExclusions}`;let r=IS.get(n);if(r)return TS(r,i);let s;return QT.test(t)?r=e8(t.substr(4),t):(s=JT.exec(G_(t,e)))?r=t8(s[1],t):(e.trimForExclusions?YT:XT).test(t)?r=i8(t,e):(s=KT.exec(G_(t,e)))?r=AS(s[1].substr(1),t,!0):(s=ZT.exec(G_(t,e)))?r=AS(s[1],t,!1):r=n8(t),IS.set(n,r),TS(r,i)}function TS(i,e){if(typeof e=="string")return i;const t=function(n,r){return Sf(n,e.base,!ws)?i(UC(n.substr(e.base.length),Ln),r):null};return t.allBasenames=i.allBasenames,t.allPaths=i.allPaths,t.basenames=i.basenames,t.patterns=i.patterns,t}function G_(i,e){return e.trimForExclusions&&i.endsWith("/**")?i.substr(0,i.length-2):i}function e8(i,e){return function(t,n){return typeof t=="string"&&t.endsWith(i)?e:null}}function t8(i,e){const t=`/${i}`,n=`\\${i}`,r=function(o,a){return typeof o!="string"?null:a?a===i?e:null:o===i||o.endsWith(t)||o.endsWith(n)?e:null},s=[i];return r.basenames=s,r.patterns=[e],r.allBasenames=s,r}function i8(i,e){const t=RS(i.slice(1,-1).split(",").map(a=>j_(a,e)).filter(a=>a!==dr),i),n=t.length;if(!n)return dr;if(n===1)return t[0];const r=function(a,l){for(let c=0,u=t.length;c<u;c++)if(t[c](a,l))return i;return null},s=t.find(a=>!!a.allBasenames);s&&(r.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function AS(i,e,t){const n=Ln===tt.sep,r=n?i:i.replace(GT,Ln),s=Ln+r,o=tt.sep+i;let a;return t?a=function(l,c){return typeof l=="string"&&(l===r||l.endsWith(s)||!n&&(l===i||l.endsWith(o)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===r||!n&&l===i)?e:null},a.allPaths=[(t?"*/":"./")+i],a}function n8(i){try{const e=new RegExp(`^${CS(i)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?i:null}}catch{return dr}}function od(i,e,t){return!i||typeof e!="string"?!1:Ll(i)(e,void 0,t)}function Ll(i,e={}){if(!i)return PS;if(typeof i=="string"||r8(i)){const t=j_(i,e);if(t===dr)return PS;const n=function(r,s){return!!t(r,s)};return t.allBasenames&&(n.allBasenames=t.allBasenames),t.allPaths&&(n.allPaths=t.allPaths),n}return s8(i,e)}function r8(i){const e=i;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function s8(i,e){const t=RS(Object.getOwnPropertyNames(i).map(a=>o8(a,i[a],e)).filter(a=>a!==dr)),n=t.length;if(!n)return dr;if(!t.some(a=>!!a.requiresSiblings)){if(n===1)return t[0];const a=function(u,d){let f;for(let p=0,b=t.length;p<b;p++){const w=t[p](u,d);if(typeof w=="string")return w;Cs(w)&&(f||(f=[]),f.push(w))}return f?(async()=>{for(const p of f){const b=await p;if(typeof b=="string")return b}return null})():null},l=t.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);return c.length&&(a.allPaths=c),a}const r=function(a,l,c){let u,d;for(let f=0,p=t.length;f<p;f++){const b=t[f];b.requiresSiblings&&c&&(l||(l=Yi(a)),u||(u=l.substr(0,l.length-q1(a).length)));const w=b(a,l,u,c);if(typeof w=="string")return w;Cs(w)&&(d||(d=[]),d.push(w))}return d?(async()=>{for(const f of d){const p=await f;if(typeof p=="string")return p}return null})():null},s=t.find(a=>!!a.allBasenames);s&&(r.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function o8(i,e,t){if(e===!1)return dr;const n=j_(i,t);if(n===dr)return dr;if(typeof e=="boolean")return n;if(e){const r=e.when;if(typeof r=="string"){const s=(o,a,l,c)=>{if(!c||!n(o,a))return null;const u=r.replace("$(basename)",()=>l),d=c(u);return Cs(d)?d.then(f=>f?i:null):d?i:null};return s.requiresSiblings=!0,s}}return n}function RS(i,e){const t=i.filter(a=>!!a.basenames);if(t.length<2)return i;const n=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let r;if(e){r=[];for(let a=0,l=n.length;a<l;a++)r.push(e)}else r=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const s=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===P.Slash||d===P.Backslash)break}l=a.substr(u)}const c=n.indexOf(l);return c!==-1?r[c]:null};s.basenames=n,s.patterns=r,s.allBasenames=n;const o=i.filter(a=>!a.basenames);return o.push(s),o}const Q_=["W","X","Y","Z","a","b","c","d","e","f"],a8=new RegExp(`^[${Q_.join("")}]+`),LS=7;function l8(i){if(i.scheme!==le.vscodeNotebookCell)return;const e=i.fragment.indexOf("s");if(e<0)return;const t=parseInt(i.fragment.substring(0,e).replace(a8,""),LS),n=Q5(i.fragment.substring(e+1)).toString();if(!isNaN(t))return{handle:t,notebook:i.with({scheme:n,fragment:null})}}function c8(i,e){const t=e.toString(LS),r=`${t.length<Q_.length?Q_[t.length-1]:"z"}${t}s${$y(De.fromString(i.scheme),!0,!0)}`;return i.with({scheme:le.vscodeNotebookCell,fragment:r})}var Nl;(function(i){i[i.Markup=1]="Markup",i[i.Code=2]="Code"})(Nl||(Nl={})),Mr.latex,Mr.markdown,Mr.text,Mr.latex,Mr.markdown,Mr.text;var ad;(function(i){i[i.Unconfirmed=1]="Unconfirmed",i[i.Pending=2]="Pending",i[i.Executing=3]="Executing"})(ad||(ad={}));var NS;(function(i){i[i.Unconfirmed=1]="Unconfirmed",i[i.Pending=2]="Pending",i[i.Executing=3]="Executing"})(NS||(NS={}));var OS;(function(i){i[i.WithHardKernelDependency=0]="WithHardKernelDependency",i[i.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",i[i.Pure=2]="Pure",i[i.Never=3]="Never"})(OS||(OS={}));var FS;(function(i){i.Always="always",i.Never="never",i.Optional="optional"})(FS||(FS={}));var zn;(function(i){i[i.ModelChange=1]="ModelChange",i[i.Move=2]="Move",i[i.ChangeCellLanguage=5]="ChangeCellLanguage",i[i.Initialize=6]="Initialize",i[i.ChangeCellMetadata=7]="ChangeCellMetadata",i[i.Output=8]="Output",i[i.OutputItem=9]="OutputItem",i[i.ChangeCellContent=10]="ChangeCellContent",i[i.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",i[i.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",i[i.ChangeCellMime=13]="ChangeCellMime",i[i.Unknown=100]="Unknown"})(zn||(zn={}));var MS;(function(i){i[i.Handle=0]="Handle",i[i.Index=1]="Index"})(MS||(MS={}));var ld;(function(i){i[i.Replace=1]="Replace",i[i.Output=2]="Output",i[i.Metadata=3]="Metadata",i[i.CellLanguage=4]="CellLanguage",i[i.DocumentMetadata=5]="DocumentMetadata",i[i.Move=6]="Move",i[i.OutputItems=7]="OutputItems",i[i.PartialMetadata=8]="PartialMetadata",i[i.PartialInternalMetadata=9]="PartialInternalMetadata"})(ld||(ld={}));var $S;(function(i){i.scheme=le.vscodeNotebookCell;function e(a,l){return c8(a,l)}i.generate=e;function t(a){return l8(a)}i.parse=t;function n(a,l){return a.with({scheme:le.vscodeNotebookCellOutput,fragment:`op${l??""},${a.scheme!==le.file?a.scheme:""}`})}i.generateCellOutputUri=n;function r(a){if(a.scheme!==le.vscodeNotebookCellOutput)return;const l=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(a.fragment);if(!l)return;const c=l[1]&&l[1]!==""?l[1]:void 0,u=l[2];return{outputId:c,notebook:a.with({scheme:u||le.file,fragment:null})}}i.parseCellOutputUri=r;function s(a,l,c){return i.generate(a,l).with({scheme:c})}i.generateCellPropertyUri=s;function o(a,l){if(a.scheme===l)return i.parse(a.with({scheme:i.scheme}))}i.parseCellPropertyUri=o})($S||($S={})),new X("notebookEditorCursorAtBoundary","none"),new X("notebookEditorCursorAtLineBoundary","none");var US;(function(i){i.default="default",i.option="option"})(US||(US={}));var HS;(function(i){i.Cells="cells",i.Text="text",i.None="none"})(HS||(HS={}));var kp;(function(i){i[i.Left=1]="Left",i[i.Right=2]="Right"})(kp||(kp={}));function BS(i){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(i)}const u8=new TextDecoder;function d8(i){const e=[];let t=!1;for(const o of i)(e.length===0||t)&&(e.push(o),t=!0);let n=f8(e);const r=De.concat(e.map(o=>De.wrap(o))),s=v8(r);return n=n||s.byteLength!==r.byteLength,{data:s,didCompression:n}}const Cp="\x1B[A",J_=Cp.split("").map(i=>i.charCodeAt(0)),h8=10;function f8(i){let e=!1;return i.forEach((t,n)=>{if(n===0||t.length<Cp.length)return;const r=i[n-1],s=t.subarray(0,Cp.length);if(s[0]===J_[0]&&s[1]===J_[1]&&s[2]===J_[2]){const o=r.lastIndexOf(h8);if(o===-1)return;e=!0,i[n-1]=r.subarray(0,o),i[n]=t.subarray(Cp.length)}}),e}function p8(i){let e=i;do i=e,e=i.replace(/[^\n]\x08/gm,"");while(e.length<i.length);return i}function g8(i){for(i=i.replace(/\r+\n/gm,`
`);i.search(/\r[^$]/g)>-1;){const e=i.match(/^(.*)\r+/m)[1];let t=i.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),i=i.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return i}const m8=8,_8=13;function v8(i){return!i.buffer.includes(m8)&&!i.buffer.includes(_8)?i:De.fromString(g8(p8(u8.decode(i.buffer))))}var WS;(function(i){i[i.UP=0]="UP",i[i.DOWN=1]="DOWN",i[i.LEFT=2]="LEFT",i[i.RIGHT=3]="RIGHT"})(WS||(WS={}));var VS;(function(i){i[i.HORIZONTAL=0]="HORIZONTAL",i[i.VERTICAL=1]="VERTICAL"})(VS||(VS={}));var zS;(function(i){i[i.FIRST=0]="FIRST",i[i.LAST=1]="LAST",i[i.NEXT=2]="NEXT",i[i.PREVIOUS=3]="PREVIOUS"})(zS||(zS={}));var qS;(function(i){i[i.MAXIMIZE=0]="MAXIMIZE",i[i.EXPAND=1]="EXPAND",i[i.EVEN=2]="EVEN"})(qS||(qS={}));var jS;(function(i){i[i.COPY_EDITORS=0]="COPY_EDITORS",i[i.MOVE_EDITORS=1]="MOVE_EDITORS"})(jS||(jS={}));var GS;(function(i){i[i.CREATION_TIME=0]="CREATION_TIME",i[i.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",i[i.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(GS||(GS={}));const w8=-1,b8=-2;var Ip;(function(i){i[i.WebSocket=0]="WebSocket",i[i.Managed=1]="Managed"})(Ip||(Ip={}));class y8{constructor(e){this.id=e,this.type=Ip.Managed}toString(){return`Managed(${this.id})`}}class x8{constructor(e,t){this.host=e,this.port=t,this.type=Ip.WebSocket}toString(){return`WebSocket(${this.host}:${this.port})`}}var jr;(function(i){i.Unknown="Unknown",i.NotAvailable="NotAvailable",i.TemporarilyNotAvailable="TemporarilyNotAvailable",i.NoResolverFound="NoResolverFound",i.InvalidAuthority="InvalidAuthority"})(jr||(jr={}));function QS(i){const e=i.indexOf("+");return e===-1?i:i.substring(0,e)}var X_,Wo,Gr,Y_,Vo,Ls,zo,K_,Z_,Pp,cd,ev,hr,fr,tv,Vi,iv;function he(i){return Object.assign(i,{apply:function(...t){if(t.length===0)return Reflect.construct(i,[]);{const n=t.length===1?[]:t[1];return Reflect.construct(i,n,t[0].constructor)}},call:function(...t){if(t.length===0)return Reflect.construct(i,[]);{const[n,...r]=t;return Reflect.construct(i,r,n.constructor)}}})}var nv;(function(i){i[i.Top=0]="Top",i[i.Bottom=1]="Bottom"})(nv||(nv={}));let Qe=X_=(f5=class{constructor(e){me(this,ka);te(this,ka,e)}static from(...e){let t=e;return new X_(function(){if(t){for(const n of t)n&&typeof n.dispose=="function"&&n.dispose();t=void 0}})}dispose(){typeof I(this,ka)=="function"&&(I(this,ka).call(this),te(this,ka,void 0))}},ka=new WeakMap,f5);Qe=X_=B([he],Qe);let He=Wo=class{static Min(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let n=1;n<e.length;n++){const r=e[n];r.isBefore(t)&&(t=r)}return t}static Max(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let n=1;n<e.length;n++){const r=e[n];r.isAfter(t)&&(t=r)}return t}static isPosition(e){if(!e)return!1;if(e instanceof Wo)return!0;const{line:t,character:n}=e;return typeof t=="number"&&typeof n=="number"}static of(e){if(e instanceof Wo)return e;if(this.isPosition(e))return new Wo(e.line,e.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,t){if(e<0)throw Ue("line must be non-negative");if(t<0)throw Ue("character must be non-negative");this._line=e,this._character=t}isBefore(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<e._character}isBeforeOrEqual(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,t=0){if(e===null||t===null)throw Ue();let n;return typeof e>"u"?n=0:typeof e=="number"?n=e:(n=typeof e.lineDelta=="number"?e.lineDelta:0,t=typeof e.characterDelta=="number"?e.characterDelta:0),n===0&&t===0?this:new Wo(this.line+n,this.character+t)}with(e,t=this.character){if(e===null||t===null)throw Ue();let n;return typeof e>"u"?n=this.line:typeof e=="number"?n=e:(n=typeof e.line=="number"?e.line:this.line,t=typeof e.character=="number"?e.character:this.character),n===this.line&&t===this.character?this:new Wo(n,t)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};He=Wo=B([he],He);let Fe=Gr=class{static isRange(e){return e instanceof Gr?!0:e?He.isPosition(e.start)&&He.isPosition(e.end):!1}static of(e){if(e instanceof Gr)return e;if(this.isRange(e))return new Gr(e.start,e.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,t,n,r){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof r=="number"?(s=new He(e,t),o=new He(n,r)):He.isPosition(e)&&He.isPosition(t)&&(s=He.of(e),o=He.of(t)),!s||!o)throw new Error("Invalid arguments");s.isBefore(o)?(this._start=s,this._end=o):(this._start=o,this._end=s)}contains(e){return Gr.isRange(e)?this.contains(e.start)&&this.contains(e.end):He.isPosition(e)?!(He.of(e).isBefore(this._start)||this._end.isBefore(e)):!1}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const t=He.Max(e.start,this._start),n=He.Min(e.end,this._end);if(!t.isAfter(n))return new Gr(t,n)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;const t=He.Min(e.start,this._start),n=He.Max(e.end,this.end);return new Gr(t,n)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,t=this.end){if(e===null||t===null)throw Ue();let n;return e?He.isPosition(e)?n=e:(n=e.start||this.start,t=e.end||this.end):n=this.start,n.isEqual(this._start)&&t.isEqual(this.end)?this:new Gr(n,t)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return JS(this)}};Fe=Gr=B([he],Fe);let Qr=Y_=class extends Fe{static isSelection(e){return e instanceof Y_?!0:e?Fe.isRange(e)&&He.isPosition(e.anchor)&&He.isPosition(e.active)&&typeof e.isReversed=="boolean":!1}get anchor(){return this._anchor}get active(){return this._active}constructor(e,t,n,r){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof r=="number"?(s=new He(e,t),o=new He(n,r)):He.isPosition(e)&&He.isPosition(t)&&(s=He.of(e),o=He.of(t)),!s||!o)throw new Error("Invalid arguments");super(s,o),this._anchor=s,this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return E8(this)}};Qr=Y_=B([he],Qr);function JS(i){return i.isEmpty?`[${i.start.line}:${i.start.character})`:`[${i.start.line}:${i.start.character} -> ${i.end.line}:${i.end.character})`}function E8(i){let e=JS(i);return i.isEmpty||(i.active.isEqual(i.start)?e=`|${e}`:e=`${e}|`),e}const XS=i=>{if(typeof i!="string"||i.length===0||!/^[0-9A-Za-z_\-]+$/.test(i))throw Ue("connectionToken")};class S8{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,n){if(typeof e!="string"||e.length===0)throw Ue("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw Ue("port");typeof n<"u"&&XS(n),this.host=e,this.port=Math.round(t),this.connectionToken=n}}class Tp{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&XS(t)}}class pr extends Error{static NotAvailable(e,t){return new pr(e,jr.NotAvailable,t)}static TemporarilyNotAvailable(e){return new pr(e,jr.TemporarilyNotAvailable)}constructor(e,t=jr.Unknown,n){super(e),this._message=e,this._code=t,this._detail=n,Object.setPrototypeOf(this,pr.prototype)}}var qn;(function(i){i[i.LF=1]="LF",i[i.CRLF=2]="CRLF"})(qn||(qn={}));var Ol;(function(i){i[i.Replace=1]="Replace",i[i.Append=2]="Append",i[i.Prepend=3]="Prepend"})(Ol||(Ol={}));let Ns=Vo=class{static isTextEdit(e){return e instanceof Vo?!0:e?Fe.isRange(e)&&typeof e.newText=="string":!1}static replace(e,t){return new Vo(e,t)}static insert(e,t){return Vo.replace(new Fe(e,e),t)}static delete(e){return Vo.replace(e,"")}static setEndOfLine(e){const t=new Vo(new Fe(new He(0,0),new He(0,0)),"");return t.newEol=e,t}get range(){return this._range}set range(e){if(e&&!Fe.isRange(e))throw Ue("range");this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!="string")throw Ue("newText");this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!="number")throw Ue("newEol");this._newEol=e}constructor(e,t){this._range=e,this._newText=t}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};Ns=Vo=B([he],Ns);let Ap=Ls=class{static isNotebookCellEdit(e){return e instanceof Ls?!0:e?Xr.isNotebookRange(e)&&Array.isArray(e.newCells):!1}static replaceCells(e,t){return new Ls(e,t)}static insertCells(e,t){return new Ls(new Xr(e,e),t)}static deleteCells(e){return new Ls(e,[])}static updateCellMetadata(e,t){const n=new Ls(new Xr(e,e),[]);return n.newCellMetadata=t,n}static updateNotebookMetadata(e){const t=new Ls(new Xr(0,0),[]);return t.newNotebookMetadata=e,t}constructor(e,t){this.range=e,this.newCells=t}};Ap=Ls=B([he],Ap);class qo{static isSnippetTextEdit(e){return e instanceof qo?!0:e?Fe.isRange(e.range)&&Go.isSnippetString(e.snippet):!1}static replace(e,t){return new qo(e,t)}static insert(e,t){return qo.replace(new Fe(e,e),t)}constructor(e,t){this.range=e,this.snippet=t}}var Ft;(function(i){i[i.File=1]="File",i[i.Text=2]="Text",i[i.Cell=3]="Cell",i[i.CellReplace=5]="CellReplace",i[i.Snippet=6]="Snippet"})(Ft||(Ft={}));let jo=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,t,n,r){this._edits.push({_type:Ft.File,from:e,to:t,options:n,metadata:r})}createFile(e,t,n){this._edits.push({_type:Ft.File,from:void 0,to:e,options:t,metadata:n})}deleteFile(e,t,n){this._edits.push({_type:Ft.File,from:e,to:void 0,options:t,metadata:n})}replaceNotebookMetadata(e,t,n){this._edits.push({_type:Ft.Cell,metadata:n,uri:e,edit:{editType:ld.DocumentMetadata,metadata:t},notebookMetadata:t})}replaceNotebookCells(e,t,n,r){const s=t.start,o=t.end;(s!==o||n.length>0)&&this._edits.push({_type:Ft.CellReplace,uri:e,index:s,count:o-s,cells:n,metadata:r})}replaceNotebookCellMetadata(e,t,n,r){this._edits.push({_type:Ft.Cell,metadata:r,uri:e,edit:{editType:ld.Metadata,index:t,metadata:n}})}replace(e,t,n,r){this._edits.push({_type:Ft.Text,uri:e,edit:new Ns(t,n),metadata:r})}insert(e,t,n,r){this.replace(e,new Fe(t,t),n,r)}delete(e,t,n){this.replace(e,t,"",n)}has(e){return this._edits.some(t=>t._type===Ft.Text&&t.uri.toString()===e.toString())}set(e,t){if(t)for(const n of t){if(!n)continue;let r,s;Array.isArray(n)?(r=n[0],s=n[1]):r=n,Ap.isNotebookCellEdit(r)?r.newCellMetadata?this.replaceNotebookCellMetadata(e,r.range.start,r.newCellMetadata,s):r.newNotebookMetadata?this.replaceNotebookMetadata(e,r.newNotebookMetadata,s):this.replaceNotebookCells(e,r.range,r.newCells,s):qo.isSnippetTextEdit(r)?this._edits.push({_type:Ft.Snippet,uri:e,range:r.range,edit:r.snippet,metadata:s}):this._edits.push({_type:Ft.Text,uri:e,edit:r,metadata:s})}else{for(let n=0;n<this._edits.length;n++){const r=this._edits[n];switch(r._type){case Ft.Text:case Ft.Snippet:case Ft.Cell:case Ft.CellReplace:r.uri.toString()===e.toString()&&(this._edits[n]=void 0);break}}C5(this._edits)}}get(e){const t=[];for(const n of this._edits)n._type===Ft.Text&&n.uri.toString()===e.toString()&&t.push(n.edit);return t}entries(){const e=new $t;for(const t of this._edits)if(t._type===Ft.Text){let n=e.get(t.uri);n||(n=[t.uri,[]],e.set(t.uri,n)),n[1].push(t.edit)}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};jo=B([he],jo);let Go=zo=class{static isSnippetString(e){return e instanceof zo?!0:e?typeof e.value=="string":!1}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1,this.value=e||""}appendText(e){return this.value+=zo._escape(e),this}appendTabstop(e=this._tabstop++){return this.value+="$",this.value+=e,this}appendPlaceholder(e,t=this._tabstop++){if(typeof e=="function"){const n=new zo;n._tabstop=this._tabstop,e(n),this._tabstop=n._tabstop,e=n.value}else e=zo._escape(e);return this.value+="${",this.value+=t,this.value+=":",this.value+=e,this.value+="}",this}appendChoice(e,t=this._tabstop++){const n=e.map(r=>r.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=t,this.value+="|",this.value+=n,this.value+="|}",this}appendVariable(e,t){if(typeof t=="function"){const n=new zo;n._tabstop=this._tabstop,t(n),this._tabstop=n._tabstop,t=n.value}else typeof t=="string"&&(t=t.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=e,t&&(this.value+=":",this.value+=t),this.value+="}",this}};Go=zo=B([he],Go);var Qo;(function(i){i[i.Unnecessary=1]="Unnecessary",i[i.Deprecated=2]="Deprecated"})(Qo||(Qo={}));var bi;(function(i){i[i.Hint=3]="Hint",i[i.Information=2]="Information",i[i.Warning=1]="Warning",i[i.Error=0]="Error"})(bi||(bi={}));let gn=K_=class{static isLocation(e){return e instanceof K_?!0:e?Fe.isRange(e.range)&&y.isUri(e.uri):!1}constructor(e,t){if(this.uri=e,t)if(Fe.isRange(t))this.range=Fe.of(t);else if(He.isPosition(t))this.range=new Fe(t,t);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};gn=K_=B([he],gn);let ud=class{static is(e){return e?typeof e.message=="string"&&e.location&&Fe.isRange(e.location.range)&&y.isUri(e.location.uri):!1}constructor(e,t){this.location=e,this.message=t}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.location.range.isEqual(t.location.range)&&e.location.uri.toString()===t.location.uri.toString()}};ud=B([he],ud);let Rp=class{constructor(e,t,n=bi.Error){if(!Fe.isRange(e))throw new TypeError("range must be set");if(!t)throw new TypeError("message must be set");this.range=e,this.message=t,this.severity=n}toJSON(){return{severity:bi[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.severity===t.severity&&e.code===t.code&&e.severity===t.severity&&e.source===t.source&&e.range.isEqual(t.range)&&Tr(e.tags,t.tags)&&Tr(e.relatedInformation,t.relatedInformation,ud.isEqual)}};Rp=B([he],Rp);let Lp=class{constructor(e,t){if(!e)throw new Error("Illegal argument, contents must be defined");Array.isArray(e)?this.contents=e:this.contents=[e],this.range=t}};Lp=B([he],Lp);let Np=class extends Lp{constructor(e,t,n,r){super(e,t),this.canIncreaseVerbosity=n,this.canDecreaseVerbosity=r}};Np=B([he],Np);var rv;(function(i){i[i.Increase=0]="Increase",i[i.Decrease=1]="Decrease"})(rv||(rv={}));var dd;(function(i){i[i.Text=0]="Text",i[i.Read=1]="Read",i[i.Write=2]="Write"})(dd||(dd={}));let Op=class{constructor(e,t=dd.Text){this.range=e,this.kind=t}toJSON(){return{range:this.range,kind:dd[this.kind]}}};Op=B([he],Op);let Fp=class{constructor(e,t){this.uri=e,this.highlights=t}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};Fp=B([he],Fp);var dt;(function(i){i[i.File=0]="File",i[i.Module=1]="Module",i[i.Namespace=2]="Namespace",i[i.Package=3]="Package",i[i.Class=4]="Class",i[i.Method=5]="Method",i[i.Property=6]="Property",i[i.Field=7]="Field",i[i.Constructor=8]="Constructor",i[i.Enum=9]="Enum",i[i.Interface=10]="Interface",i[i.Function=11]="Function",i[i.Variable=12]="Variable",i[i.Constant=13]="Constant",i[i.String=14]="String",i[i.Number=15]="Number",i[i.Boolean=16]="Boolean",i[i.Array=17]="Array",i[i.Object=18]="Object",i[i.Key=19]="Key",i[i.Null=20]="Null",i[i.EnumMember=21]="EnumMember",i[i.Struct=22]="Struct",i[i.Event=23]="Event",i[i.Operator=24]="Operator",i[i.TypeParameter=25]="TypeParameter"})(dt||(dt={}));var hd;(function(i){i[i.Deprecated=1]="Deprecated"})(hd||(hd={}));let fd=Z_=class{static validate(e){if(!e.name)throw new Error("name must not be falsy")}constructor(e,t,n,r,s){this.name=e,this.kind=t,this.containerName=s,typeof n=="string"&&(this.containerName=n),r instanceof gn?this.location=r:n instanceof Fe&&(this.location=new gn(r,n)),Z_.validate(this)}toJSON(){return{name:this.name,kind:dt[this.kind],location:this.location,containerName:this.containerName}}};fd=Z_=B([he],fd);let pd=Pp=class{static validate(e){var t;if(!e.name)throw new Error("name must not be falsy");if(!e.range.contains(e.selectionRange))throw new Error("selectionRange must be contained in fullRange");(t=e.children)==null||t.forEach(Pp.validate)}constructor(e,t,n,r,s){this.name=e,this.detail=t,this.kind=n,this.range=r,this.selectionRange=s,this.children=[],Pp.validate(this)}};pd=Pp=B([he],pd);var gd;(function(i){i[i.Invoke=1]="Invoke",i[i.Automatic=2]="Automatic"})(gd||(gd={}));let Mp=class{constructor(e,t){this.title=e,this.kind=t}};Mp=B([he],Mp);let St=(Ca=class{constructor(e){this.value=e}append(e){return new cd(this.value?this.value+cd.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+cd.sep)}},cd=Ca,Ca.sep=".",Ca);St=cd=B([he],St),St.Empty=new St(""),St.QuickFix=St.Empty.append("quickfix"),St.Refactor=St.Empty.append("refactor"),St.RefactorExtract=St.Refactor.append("extract"),St.RefactorInline=St.Refactor.append("inline"),St.RefactorMove=St.Refactor.append("move"),St.RefactorRewrite=St.Refactor.append("rewrite"),St.Source=St.Empty.append("source"),St.SourceOrganizeImports=St.Source.append("organizeImports"),St.SourceFixAll=St.Source.append("fixAll"),St.Notebook=St.Empty.append("notebook");let md=class{constructor(e,t){if(this.range=e,this.parent=t,t&&!t.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};md=B([he],md);let sv=class{constructor(e,t,n,r,s,o){this.kind=e,this.name=t,this.detail=n,this.uri=r,this.range=s,this.selectionRange=o}},YS=class{constructor(e,t){this.fromRanges=t,this.from=e}},KS=class{constructor(e,t){this.fromRanges=t,this.to=e}};var Fl;(function(i){i[i.Information=0]="Information",i[i.Warning=1]="Warning",i[i.Error=2]="Error"})(Fl||(Fl={}));let $p=class{constructor(e,t){this.range=e,this.command=t}get isResolved(){return!!this.command}};$p=B([he],$p);let tn=ev=(p5=class{constructor(e,t=!1){me(this,Ci);te(this,Ci,new g2(e,{supportThemeIcons:t}))}static isMarkdownString(e){return e instanceof ev?!0:e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}get value(){return I(this,Ci).value}set value(e){I(this,Ci).value=e}get isTrusted(){return I(this,Ci).isTrusted}set isTrusted(e){I(this,Ci).isTrusted=e}get supportThemeIcons(){return I(this,Ci).supportThemeIcons}set supportThemeIcons(e){I(this,Ci).supportThemeIcons=e}get supportHtml(){return I(this,Ci).supportHtml}set supportHtml(e){I(this,Ci).supportHtml=e}get baseUri(){return I(this,Ci).baseUri}set baseUri(e){I(this,Ci).baseUri=e}appendText(e){return I(this,Ci).appendText(e),this}appendMarkdown(e){return I(this,Ci).appendMarkdown(e),this}appendCodeblock(e,t){return I(this,Ci).appendCodeblock(t??"",e),this}},Ci=new WeakMap,p5);tn=ev=B([he],tn);let ov=class{constructor(e,t){this.label=e,this.documentation=t}};ov=B([he],ov);let av=class{constructor(e,t){this.label=e,this.documentation=t,this.parameters=[]}};av=B([he],av);let lv=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};lv=B([he],lv);var cv;(function(i){i[i.Invoke=1]="Invoke",i[i.TriggerCharacter=2]="TriggerCharacter",i[i.ContentChange=3]="ContentChange"})(cv||(cv={}));var uv;(function(i){i[i.Type=1]="Type",i[i.Parameter=2]="Parameter"})(uv||(uv={}));let Up=class{constructor(e){this.value=e}};Up=B([he],Up);let Hp=class{constructor(e,t,n){this.position=e,this.label=t,this.kind=n}};Hp=B([he],Hp);var Ml;(function(i){i[i.Invoke=0]="Invoke",i[i.TriggerCharacter=1]="TriggerCharacter",i[i.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Ml||(Ml={}));var ye;(function(i){i[i.Text=0]="Text",i[i.Method=1]="Method",i[i.Function=2]="Function",i[i.Constructor=3]="Constructor",i[i.Field=4]="Field",i[i.Variable=5]="Variable",i[i.Class=6]="Class",i[i.Interface=7]="Interface",i[i.Module=8]="Module",i[i.Property=9]="Property",i[i.Unit=10]="Unit",i[i.Value=11]="Value",i[i.Enum=12]="Enum",i[i.Keyword=13]="Keyword",i[i.Snippet=14]="Snippet",i[i.Color=15]="Color",i[i.File=16]="File",i[i.Reference=17]="Reference",i[i.Folder=18]="Folder",i[i.EnumMember=19]="EnumMember",i[i.Constant=20]="Constant",i[i.Struct=21]="Struct",i[i.Event=22]="Event",i[i.Operator=23]="Operator",i[i.TypeParameter=24]="TypeParameter",i[i.User=25]="User",i[i.Issue=26]="Issue"})(ye||(ye={}));var _d;(function(i){i[i.Deprecated=1]="Deprecated"})(_d||(_d={}));let Bp=class{constructor(e,t){this.label=e,this.kind=t}toJSON(){return{label:this.label,kind:this.kind&&ye[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Bp=B([he],Bp);let $l=class{constructor(e=[],t=!1){this.items=e,this.isIncomplete=t}};$l=B([he],$l);let dv=class{constructor(e,t,n){this.insertText=e,this.range=t,this.command=n}};dv=B([he],dv);let hv=class{constructor(e){this.commands=void 0,this.suppressSuggestions=void 0,this.items=e}};hv=B([he],hv);var Jo;(function(i){i[i.Unknown=0]="Unknown",i[i.Word=1]="Word",i[i.Line=2]="Line",i[i.Suggest=3]="Suggest"})(Jo||(Jo={}));var vd;(function(i){i[i.Active=-1]="Active",i[i.Beside=-2]="Beside",i[i.One=1]="One",i[i.Two=2]="Two",i[i.Three=3]="Three",i[i.Four=4]="Four",i[i.Five=5]="Five",i[i.Six=6]="Six",i[i.Seven=7]="Seven",i[i.Eight=8]="Eight",i[i.Nine=9]="Nine"})(vd||(vd={}));var Os;(function(i){i[i.Left=1]="Left",i[i.Right=2]="Right"})(Os||(Os={}));function D8(i,e){return`${ot.toKey(i)}.${e}`}var jn;(function(i){i[i.Off=0]="Off",i[i.On=1]="On",i[i.Relative=2]="Relative",i[i.Interval=3]="Interval"})(jn||(jn={}));var Ul;(function(i){i[i.Manual=1]="Manual",i[i.AfterDelay=2]="AfterDelay",i[i.FocusOut=3]="FocusOut"})(Ul||(Ul={}));var Wp;(function(i){i[i.Default=0]="Default",i[i.InCenter=1]="InCenter",i[i.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",i[i.AtTop=3]="AtTop"})(Wp||(Wp={}));var Hl;(function(i){i[i.Keyboard=1]="Keyboard",i[i.Mouse=2]="Mouse",i[i.Command=3]="Command"})(Hl||(Hl={}));var wd;(function(i){i[i.Undo=1]="Undo",i[i.Redo=2]="Redo"})(wd||(wd={}));var Xo;(function(i){i[i.OpenOpen=0]="OpenOpen",i[i.ClosedClosed=1]="ClosedClosed",i[i.OpenClosed=2]="OpenClosed",i[i.ClosedOpen=3]="ClosedOpen"})(Xo||(Xo={})),function(i){function e(t){switch(t){case"keyboard":return i.Keyboard;case"mouse":return i.Mouse;case"api":return i.Command}}i.fromValue=e}(Hl||(Hl={}));var Bl;(function(i){i[i.Other=0]="Other",i[i.Comment=1]="Comment",i[i.String=2]="String",i[i.RegEx=3]="RegEx"})(Bl||(Bl={})),function(i){function e(t){switch(t){case i.Other:return"other";case i.Comment:return"comment";case i.String:return"string";case i.RegEx:return"regex"}return"other"}i.toString=e}(Bl||(Bl={}));let Vp=class{constructor(e,t){if(t&&!y.isUri(t))throw Ue("target");if(!Fe.isRange(e)||e.isEmpty)throw Ue("range");this.range=e,this.target=t}};Vp=B([he],Vp);let Wl=class{constructor(e,t,n,r){this.red=e,this.green=t,this.blue=n,this.alpha=r}};Wl=B([he],Wl);let zp=class{constructor(e,t){if(t&&!(t instanceof Wl))throw Ue("color");if(!Fe.isRange(e)||e.isEmpty)throw Ue("range");this.range=e,this.color=t}};zp=B([he],zp);let qp=class{constructor(e){if(!e||typeof e!="string")throw Ue("label");this.label=e}};qp=B([he],qp);var fv;(function(i){i[i.Error=0]="Error",i[i.Warning=1]="Warning",i[i.Information=2]="Information"})(fv||(fv={}));var pv;(function(i){i[i.Unknown=0]="Unknown",i[i.Shutdown=1]="Shutdown",i[i.Process=2]="Process",i[i.User=3]="User",i[i.Extension=4]="Extension"})(pv||(pv={}));var jp;(function(i){i[i.Low=0]="Low",i[i.Medium=1]="Medium",i[i.High=2]="High"})(jp||(jp={}));class k8{constructor(e,t,n){if(this.startIndex=e,this.length=t,this.tooltip=n,typeof e!="number"||e<0)throw Ue("startIndex");if(typeof t!="number"||t<1)throw Ue("length");if(n!==void 0&&typeof n!="string")throw Ue("tooltip")}}class C8{constructor(e){this.uri=e}}class I8{constructor(e){this.terminalCommand=e}}var gv;(function(i){i[i.Panel=1]="Panel",i[i.Editor=2]="Editor"})(gv||(gv={}));class P8{constructor(e){if(this.options=e,typeof e!="object")throw Ue("options")}}var mv;(function(i){i[i.Always=1]="Always",i[i.Silent=2]="Silent",i[i.Never=3]="Never"})(mv||(mv={}));var _v;(function(i){i[i.Shared=1]="Shared",i[i.Dedicated=2]="Dedicated",i[i.New=3]="New"})(_v||(_v={}));let bd=(yr=class{static from(e){switch(e){case"clean":return hr.Clean;case"build":return hr.Build;case"rebuild":return hr.Rebuild;case"test":return hr.Test;default:return}}constructor(e,t){if(this.label=t,typeof e!="string"||typeof t!="string")throw Ue("name");this._id=e}get id(){return this._id}},hr=yr,yr.Clean=new hr("clean","Clean"),yr.Build=new hr("build","Build"),yr.Rebuild=new hr("rebuild","Rebuild"),yr.Test=new hr("test","Test"),yr);bd=hr=B([he],bd);function ZS(i){let e="";for(let t=0;t<i.length;t++)e+=i[t].replace(/,/g,",,")+",";return e}let Vl=class{constructor(e,t,n){if(typeof e!="string")throw Ue("process");this._args=[],this._process=e,t!==void 0&&(Array.isArray(t)?(this._args=t,this._options=n):this._options=t)}get process(){return this._process}set process(e){if(typeof e!="string")throw Ue("process");this._process=e}get args(){return this._args}set args(e){Array.isArray(e)||(e=[]),this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("process"),this._process!==void 0&&e.push(this._process),this._args&&this._args.length>0)for(const t of this._args)e.push(t);return ZS(e)}};Vl=B([he],Vl);let Yo=class{constructor(e,t,n){if(this._args=[],Array.isArray(t)){if(!e)throw Ue("command can't be undefined or null");if(typeof e!="string"&&typeof e.value!="string")throw Ue("command");this._command=e,this._args=t,this._options=n}else{if(typeof e!="string")throw Ue("commandLine");this._commandLine=e,this._options=t}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!="string")throw Ue("commandLine");this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if(typeof e!="string"&&typeof e.value!="string")throw Ue("command");this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("shell"),this._commandLine!==void 0&&e.push(this._commandLine),this._command!==void 0&&e.push(typeof this._command=="string"?this._command:this._command.value),this._args&&this._args.length>0)for(const t of this._args)e.push(typeof t=="string"?t:t.value);return ZS(e)}};Yo=B([he],Yo);var vv;(function(i){i[i.Escape=1]="Escape",i[i.Strong=2]="Strong",i[i.Weak=3]="Weak"})(vv||(vv={}));var Ko;(function(i){i[i.Global=1]="Global",i[i.Workspace=2]="Workspace"})(Ko||(Ko={}));class wv{constructor(e){this._callback=e}computeId(){return"customExecution"+Un()}set callback(e){this._callback=e}get callback(){return this._callback}}let Gp=(xr=class{constructor(e,t,n,r,s,o){this.__deprecated=!1,this._definition=this.definition=e;let a;typeof t=="string"?(this._name=this.name=t,this._source=this.source=n,this.execution=r,a=s,this.__deprecated=!0):t===Ko.Global||t===Ko.Workspace?(this.target=t,this._name=this.name=n,this._source=this.source=r,this.execution=s,a=o):(this.target=t,this._name=this.name=n,this._source=this.source=r,this.execution=s,a=o),typeof a=="string"?(this._problemMatchers=[a],this._hasDefinedMatchers=!0):Array.isArray(a)?(this._problemMatchers=a,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){this.__id!==void 0&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof Vl?this._definition={type:fr.ProcessType,id:this._execution.computeId()}:this._execution instanceof Yo?this._definition={type:fr.ShellType,id:this._execution.computeId()}:this._execution instanceof wv?this._definition={type:fr.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:fr.EmptyType,id:Un()}}get definition(){return this._definition}set definition(e){if(e==null)throw Ue("Kind can't be undefined or null");this.clear(),this._definition=e}get scope(){return this._scope}set target(e){this.clear(),this._scope=e}get name(){return this._name}set name(e){if(typeof e!="string")throw Ue("name");this.clear(),this._name=e}get execution(){return this._execution}set execution(e){e===null&&(e=void 0),this.clear(),this._execution=e;const t=this._definition.type;(fr.EmptyType===t||fr.ProcessType===t||fr.ShellType===t||fr.ExtensionCallbackType===t)&&this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(Array.isArray(e))this.clear(),this._problemMatchers=e,this._hasDefinedMatchers=!0;else{this.clear(),this._problemMatchers=[],this._hasDefinedMatchers=!1;return}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){e!==!0&&e!==!1&&(e=!1),this.clear(),this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!="string"||e.length===0)throw Ue("source must be a string of length > 0");this.clear(),this._source=e}get group(){return this._group}set group(e){e===null&&(e=void 0),this.clear(),this._group=e}get detail(){return this._detail}set detail(e){e===null&&(e=void 0),this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._runOptions=e}},fr=xr,xr.ExtensionCallbackType="customExecution",xr.ProcessType="process",xr.ShellType="shell",xr.EmptyType="$empty",xr);Gp=fr=B([he],Gp);var Zo;(function(i){i[i.SourceControl=1]="SourceControl",i[i.Window=10]="Window",i[i.Notification=15]="Notification"})(Zo||(Zo={}));var bv;(function(i){function e(t){const n=t;return Ds(n.value)?n.tooltip&&!Ge(n.tooltip)?(console.log("INVALID view badge, invalid tooltip",n.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",n.value),!1)}i.isViewBadge=e})(bv||(bv={}));let Qp=tv=class{static isTreeItem(e,t){var r,s;const n=e;if(n.checkboxState!==void 0){const o=Ds(n.checkboxState)?n.checkboxState:Bt(n.checkboxState)&&Ds(n.checkboxState.state)?n.checkboxState.state:void 0,a=!Ds(n.checkboxState)&&Bt(n.checkboxState)?n.checkboxState.tooltip:void 0;if(o===void 0||o!==gr.Checked&&o!==gr.Unchecked||a!==void 0&&!Ge(a))return console.log("INVALID tree item, invalid checkboxState",n.checkboxState),!1}if(e instanceof tv)return!0;if(n.label!==void 0&&!Ge(n.label)&&!((r=n.label)!=null&&r.label))return console.log("INVALID tree item, invalid label",n.label),!1;if(n.id!==void 0&&!Ge(n.id))return console.log("INVALID tree item, invalid id",n.id),!1;if(n.iconPath!==void 0&&!Ge(n.iconPath)&&!y.isUri(n.iconPath)&&(!n.iconPath||!Ge(n.iconPath.id))){const o=n.iconPath;if(!o||!Ge(o.light)&&!y.isUri(o.light)&&!Ge(o.dark)&&!y.isUri(o.dark))return console.log("INVALID tree item, invalid iconPath",n.iconPath),!1}return n.description!==void 0&&!Ge(n.description)&&typeof n.description!="boolean"?(console.log("INVALID tree item, invalid description",n.description),!1):n.resourceUri!==void 0&&!y.isUri(n.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",n.resourceUri),!1):n.tooltip!==void 0&&!Ge(n.tooltip)&&!(n.tooltip instanceof tn)?(console.log("INVALID tree item, invalid tooltip",n.tooltip),!1):n.command!==void 0&&!n.command.command?(console.log("INVALID tree item, invalid command",n.command),!1):n.collapsibleState!==void 0&&n.collapsibleState<ea.None&&n.collapsibleState>ea.Expanded?(console.log("INVALID tree item, invalid collapsibleState",n.collapsibleState),!1):n.contextValue!==void 0&&!Ge(n.contextValue)?(console.log("INVALID tree item, invalid contextValue",n.contextValue),!1):n.accessibilityInformation!==void 0&&!((s=n.accessibilityInformation)!=null&&s.label)?(console.log("INVALID tree item, invalid accessibilityInformation",n.accessibilityInformation),!1):!0}constructor(e,t=ea.None){this.collapsibleState=t,y.isUri(e)?this.resourceUri=e:this.label=e}};Qp=tv=B([he],Qp);var ea;(function(i){i[i.None=0]="None",i[i.Collapsed=1]="Collapsed",i[i.Expanded=2]="Expanded"})(ea||(ea={}));var gr;(function(i){i[i.Unchecked=0]="Unchecked",i[i.Checked=1]="Checked"})(gr||(gr={}));let Jp=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(e){this.value=e}};Jp=B([he],Jp);class Xp extends Jp{}class T8 extends Xp{constructor(t){super("");me(this,Mh);te(this,Mh,t)}asFile(){return I(this,Mh)}}Mh=new WeakMap;class A8{constructor(e,t,n,r){this.name=e,this.uri=t,this._itemId=n,this._getData=r}data(){return this._getData()}}let yd=(g5=class{constructor(e){me(this,Ia);me(this,fs,new Map);for(const[t,n]of e??[]){const r=I(this,fs).get(af(this,Ia,lf).call(this,t));r?r.push(n):I(this,fs).set(af(this,Ia,lf).call(this,t),[n])}}get(e){var t;return(t=I(this,fs).get(af(this,Ia,lf).call(this,e)))==null?void 0:t[0]}set(e,t){I(this,fs).set(af(this,Ia,lf).call(this,e),[t])}forEach(e,t){for(const[n,r]of I(this,fs))for(const s of r)e.call(t,s,n,this)}*[Symbol.iterator](){for(const[e,t]of I(this,fs))for(const n of t)yield[e,n]}},fs=new WeakMap,Ia=new WeakSet,lf=function(e){return e.toLowerCase()},g5);yd=B([he],yd);let yv=class{constructor(e,t,n){this.insertText=e,this.title=t,this.kind=n}};yv=B([he],yv);var xv;(function(i){i[i.Automatic=0]="Automatic",i[i.PasteAs=1]="PasteAs"})(xv||(xv={}));const Oc=class Oc{constructor(e){this.value=e}append(...e){return new Oc((this.value?[this.value,...e]:e).join(Oc.sep))}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+Oc.sep)}};Oc.sep=".";let zl=Oc;zl.Empty=new zl("");class R8{constructor(e,t,n){this.title=t,this.insertText=e,this.kind=n}}let Oi=class{constructor(e,t){this.id=e,this.color=t}static isThemeIcon(e){return typeof e.id!="string"?(console.log("INVALID ThemeIcon, invalid id",e.id),!1):!0}};Oi=B([he],Oi),Oi.File=new Oi("file"),Oi.Folder=new Oi("folder");let xd=class{constructor(e){this.id=e}};xd=B([he],xd);var ql;(function(i){i[i.Global=1]="Global",i[i.Workspace=2]="Workspace",i[i.WorkspaceFolder=3]="WorkspaceFolder"})(ql||(ql={}));let jl=class{get base(){return this._base}set base(e){this._base=e,this._baseUri=y.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e,this._base=e.fsPath}constructor(e,t){if(typeof e!="string"&&(!e||!y.isUri(e)&&!y.isUri(e.uri)))throw Ue("base");if(typeof t!="string")throw Ue("pattern");typeof e=="string"?this.baseUri=y.file(e):y.isUri(e)?this.baseUri=e:this.baseUri=e.uri,this.pattern=t}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};jl=B([he],jl);const e4=new WeakMap;function L8(i,e){e4.set(i,e)}let Gl=class{constructor(e,t,n,r,s){this.enabled=typeof e=="boolean"?e:!0,typeof t=="string"&&(this.condition=t),typeof n=="string"&&(this.hitCondition=n),typeof r=="string"&&(this.logMessage=r),typeof s=="string"&&(this.mode=s)}get id(){return this._id||(this._id=e4.get(this)??Un()),this._id}};Gl=B([he],Gl);let ta=class extends Gl{constructor(e,t,n,r,s,o){if(super(t,n,r,s,o),e===null)throw Ue("location");this.location=e}};ta=B([he],ta);let ia=class extends Gl{constructor(e,t,n,r,s,o){super(t,n,r,s,o),this.functionName=e}};ia=B([he],ia);let Yp=class extends Gl{constructor(e,t,n,r,s,o,a,l){if(super(r,s,o,a,l),!t)throw Ue("dataId");this.label=e,this.dataId=t,this.canPersist=n}};Yp=B([he],Yp);let Kp=class{constructor(e,t,n){this.command=e,this.args=t||[],this.options=n}};Kp=B([he],Kp);let Ed=class{constructor(e,t){this.port=e,this.host=t}};Ed=B([he],Ed);let Zp=class{constructor(e){this.path=e}};Zp=B([he],Zp);let eg=class{constructor(e){this.implementation=e}};eg=B([he],eg);class t4{constructor(e,t,n){this.session=e,this.threadId=t,this.frameId=n}}class i4{constructor(e,t){this.session=e,this.threadId=t}}let tg=class{constructor(e,t){this.range=e,this.expression=t}};tg=B([he],tg);var Sd;(function(i){i[i.Invoke=0]="Invoke",i[i.Automatic=1]="Automatic"})(Sd||(Sd={}));let ig=class{constructor(e,t){this.range=e,this.text=t}};ig=B([he],ig);let ng=class{constructor(e,t,n=!0){this.range=e,this.variableName=t,this.caseSensitiveLookup=n}};ng=B([he],ng);let rg=class{constructor(e,t){this.range=e,this.expression=t}};rg=B([he],rg);let Ev=class{constructor(e,t){this.frameId=e,this.stoppedLocation=t}};Ev=B([he],Ev);var Sv;(function(i){i[i.AIGenerated=1]="AIGenerated"})(Sv||(Sv={}));var Dd;(function(i){i[i.Invoke=0]="Invoke",i[i.Automatic=1]="Automatic"})(Dd||(Dd={}));class N8{constructor(e,t){this.newSymbolName=e,this.tags=t}}var Ql;(function(i){i[i.Changed=1]="Changed",i[i.Created=2]="Created",i[i.Deleted=3]="Deleted"})(Ql||(Ql={}));let Yt=Vi=class extends Error{static FileExists(e){return new Vi(e,Pe.FileExists,Vi.FileExists)}static FileNotFound(e){return new Vi(e,Pe.FileNotFound,Vi.FileNotFound)}static FileNotADirectory(e){return new Vi(e,Pe.FileNotADirectory,Vi.FileNotADirectory)}static FileIsADirectory(e){return new Vi(e,Pe.FileIsADirectory,Vi.FileIsADirectory)}static NoPermissions(e){return new Vi(e,Pe.NoPermissions,Vi.NoPermissions)}static Unavailable(e){return new Vi(e,Pe.Unavailable,Vi.Unavailable)}constructor(e,t=Pe.Unknown,n){super(y.isUri(e)?e.toString(!0):e),this.code=(n==null?void 0:n.name)??"Unknown",e2(this,t),Object.setPrototypeOf(this,Vi.prototype),typeof Error.captureStackTrace=="function"&&typeof n=="function"&&Error.captureStackTrace(this,n)}};Yt=Vi=B([he],Yt);let Dv=class{constructor(e,t,n){this.start=e,this.end=t,this.kind=n}};Dv=B([he],Dv);var Jr;(function(i){i[i.Comment=1]="Comment",i[i.Imports=2]="Imports",i[i.Region=3]="Region"})(Jr||(Jr={}));var kd;(function(i){i[i.Collapsed=0]="Collapsed",i[i.Expanded=1]="Expanded"})(kd||(kd={}));var kv;(function(i){i[i.Editing=0]="Editing",i[i.Preview=1]="Preview"})(kv||(kv={}));var Cv;(function(i){i[i.Published=0]="Published",i[i.Draft=1]="Draft"})(Cv||(Cv={}));var Cd;(function(i){i[i.Unresolved=0]="Unresolved",i[i.Resolved=1]="Resolved"})(Cd||(Cd={}));var Id;(function(i){i[i.Current=0]="Current",i[i.Outdated=1]="Outdated"})(Id||(Id={}));var Pd;(function(i){i[i.Reply=1]="Reply",i[i.Comment=2]="Comment"})(Pd||(Pd={}));class Iv{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}}function O8(i){return typeof i>"u"||tI(i)}class Pv{constructor(e){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,e){this._hasLegend=!0;for(let t=0,n=e.tokenTypes.length;t<n;t++)this._tokenTypeStrToInt.set(e.tokenTypes[t],t);for(let t=0,n=e.tokenModifiers.length;t<n;t++)this._tokenModifierStrToInt.set(e.tokenModifiers[t],t)}}push(e,t,n,r,s){if(typeof e=="number"&&typeof t=="number"&&typeof n=="number"&&typeof r=="number"&&(typeof s=="number"||typeof s>"u"))return typeof s>"u"&&(s=0),this._pushEncoded(e,t,n,r,s);if(Fe.isRange(e)&&typeof t=="string"&&O8(n))return this._push(e,t,n);throw Ue()}_push(e,t,n){if(!this._hasLegend)throw new Error("Legend must be provided in constructor");if(e.start.line!==e.end.line)throw new Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(t))throw new Error("`tokenType` is not in the provided legend");const r=e.start.line,s=e.start.character,o=e.end.character-e.start.character,a=this._tokenTypeStrToInt.get(t);let l=0;if(n)for(const c of n){if(!this._tokenModifierStrToInt.has(c))throw new Error("`tokenModifier` is not in the provided legend");const u=this._tokenModifierStrToInt.get(c);l|=1<<u>>>0}this._pushEncoded(r,s,o,a,l)}_pushEncoded(e,t,n,r,s){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&t<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;const l=this._data.length/5|0;let c=0,u=0;for(let d=0;d<l;d++){let f=this._data[5*d],p=this._data[5*d+1];f===0?(f=c,p+=u):f+=c,this._data[5*d]=f,this._data[5*d+1]=p,c=f,u=p}}let o=e,a=t;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(o-=this._prevLine,o===0&&(a-=this._prevChar)),this._data[this._dataLen++]=o,this._data[this._dataLen++]=a,this._data[this._dataLen++]=n,this._data[this._dataLen++]=r,this._data[this._dataLen++]=s,this._prevLine=e,this._prevChar=t}static _sortAndDeltaEncode(e){const t=[],n=e.length/5|0;for(let a=0;a<n;a++)t[a]=a;t.sort((a,l)=>{const c=e[5*a],u=e[5*l];if(c===u){const d=e[5*a+1],f=e[5*l+1];return d-f}return c-u});const r=new Uint32Array(e.length);let s=0,o=0;for(let a=0;a<n;a++){const l=5*t[a],c=e[l+0],u=e[l+1],d=e[l+2],f=e[l+3],p=e[l+4],b=c-s,w=b===0?u-o:u,v=5*a;r[v+0]=b,r[v+1]=w,r[v+2]=d,r[v+3]=f,r[v+4]=p,s=c,o=u}return r}build(e){return this._dataIsSortedAndDeltaEncoded?new Jl(new Uint32Array(this._data),e):new Jl(Pv._sortAndDeltaEncode(this._data),e)}}class Jl{constructor(e,t){this.resultId=t,this.data=e}}class n4{constructor(e,t,n){this.start=e,this.deleteCount=t,this.data=n}}class sg{constructor(e,t){this.resultId=t,this.edits=e}}var og;(function(i){i[i.Separate=0]="Separate",i[i.MergeWithParent=1]="MergeWithParent"})(og||(og={}));class F8{constructor(e){this.name=e}}var Tv;(function(i){i[i.Title=1]="Title",i[i.Inline=2]="Inline"})(Tv||(Tv={}));let Td=(Fc=class{constructor(){}},Fc.Back={iconPath:new Oi("arrow-left")},Fc);Td=B([he],Td);var Ad;(function(i){i[i.Separator=-1]="Separator",i[i.Default=0]="Default"})(Ad||(Ad={}));var Xl;(function(i){i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error"})(Xl||(Xl={}));var na;(function(i){i[i.UI=1]="UI",i[i.Workspace=2]="Workspace"})(na||(na={}));class Av{static validate(e){if(typeof e.badge=="string"){let t=bx(e.badge,0);if(t<e.badge.length&&(t+=bx(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Oi.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,n){this.badge=e,this.tooltip=t,this.color=n}}let ag=class{constructor(e){this.kind=e}};ag=B([he],ag);var Fs;(function(i){i[i.Light=1]="Light",i[i.Dark=2]="Dark",i[i.HighContrast=3]="HighContrast",i[i.HighContrastLight=4]="HighContrastLight"})(Fs||(Fs={}));let Xr=class xy{static isNotebookRange(e){return e instanceof xy?!0:e?typeof e.start=="number"&&typeof e.end=="number":!1}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,t){if(e<0)throw Ue("start must be positive");if(t<0)throw Ue("end must be positive");e<=t?(this._start=e,this._end=t):(this._start=t,this._end=e)}with(e){let t=this._start,n=this._end;return e.start!==void 0&&(t=e.start),e.end!==void 0&&(n=e.end),t===this._start&&n===this._end?this:new xy(t,n)}},lg=class Ey{static validate(e){if(typeof e.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof e.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof e.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every(t=>Ey.isNotebookCellData(t))}static isNotebookCellData(e){return!0}constructor(e,t,n,r,s,o,a){this.kind=e,this.value=t,this.languageId=n,this.mime=r,this.outputs=s??[],this.metadata=o,this.executionSummary=a,Ey.validate(this)}},r4=class{constructor(e){this.cells=e}},s4=(on=class{static isNotebookCellOutputItem(e){return e instanceof on?!0:e?typeof e.mime=="string"&&e.data instanceof Uint8Array:!1}static error(e){const t={name:e.name,message:e.message,stack:e.stack};return on.json(t,"application/vnd.code.notebook.error")}static stdout(e){return on.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return on.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,t="application/octet-stream"){return new on(e,t)}static text(e,t=Mr.text){const n=I(on,Ym).encode(String(e));return new on(n,t)}static json(e,t="text/x-json"){const n=JSON.stringify(e,void 0,"	");return on.text(n,t)}constructor(e,t){this.data=e,this.mime=t;const n=F2(t,!0);if(!n)throw new Error(`INVALID mime type: ${t}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=n}},Ym=new WeakMap,me(on,Ym,new TextEncoder),on),cg=class Sy{static isNotebookCellOutput(e){return e instanceof Sy?!0:!e||typeof e!="object"?!1:typeof e.id=="string"&&Array.isArray(e.items)}static ensureUniqueMimeTypes(e,t=!1){const n=new Set,r=new Set;for(let s=0;s<e.length;s++){const o=e[s],a=F2(o.mime);if(!n.has(a)||BS(a)){n.add(a);continue}r.add(s),t&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return r.size===0?e:e.filter((s,o)=>!r.has(o))}constructor(e,t,n){this.items=Sy.ensureUniqueMimeTypes(e,!0),typeof t=="string"?(this.id=t,this.metadata=n):(this.id=Un(),this.metadata=t??n)}};var ra;(function(i){i[i.Markup=1]="Markup",i[i.Code=2]="Code"})(ra||(ra={}));var Yl;(function(i){i[i.Idle=1]="Idle",i[i.Pending=2]="Pending",i[i.Executing=3]="Executing"})(Yl||(Yl={}));var ug;(function(i){i[i.Left=1]="Left",i[i.Right=2]="Right"})(ug||(ug={}));var dg;(function(i){i[i.Default=0]="Default",i[i.InCenter=1]="InCenter",i[i.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",i[i.AtTop=3]="AtTop"})(dg||(dg={}));class M8{constructor(e,t){this.text=e,this.alignment=t}}var Rv;(function(i){i[i.Default=1]="Default",i[i.Preferred=2]="Preferred"})(Rv||(Rv={}));var hg;(function(i){i[i.Default=1]="Default",i[i.Preferred=2]="Preferred",i[i.Hidden=-1]="Hidden"})(hg||(hg={}));let o4=class{constructor(e,t=[]){this.uri=e,this.provides=fo(t)}},$8=class{constructor(e){this.label=e}};var Rd;(function(i){i[i.Named=1]="Named",i[i.Indexed=2]="Indexed"})(Rd||(Rd={}));let Lv=class{constructor(e,t){this.label=e,this.timestamp=t}};Lv=B([he],Lv);var Kl;(function(i){i[i.Production=1]="Production",i[i.Development=2]="Development",i[i.Test=3]="Test"})(Kl||(Kl={}));var fg;(function(i){i[i.Node=1]="Node",i[i.Webworker=2]="Webworker"})(fg||(fg={}));var Ms;(function(i){i[i.Other=0]="Other",i[i.Comment=1]="Comment",i[i.String=2]="String",i[i.RegEx=3]="RegEx"})(Ms||(Ms={}));class U8{constructor(e,t){this.ranges=e,this.wordPattern=t}}class H8{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}var Nv;(function(i){i[i.Queued=1]="Queued",i[i.Running=2]="Running",i[i.Passed=3]="Passed",i[i.Failed=4]="Failed",i[i.Skipped=5]="Skipped",i[i.Errored=6]="Errored"})(Nv||(Nv={}));var Zl;(function(i){i[i.Run=1]="Run",i[i.Debug=2]="Debug",i[i.Coverage=3]="Coverage"})(Zl||(Zl={}));let pg=class{constructor(e=void 0,t=void 0,n=void 0,r=!1,s=!0){this.include=e,this.exclude=t,this.profile=n,this.continuous=r,this.preserveFocus=s}};pg=B([he],pg);let Ld=iv=class{static diff(e,t,n){const r=new iv(e);return r.expectedOutput=t,r.actualOutput=n,r}constructor(e){this.message=e}};Ld=iv=B([he],Ld);let Nd=class{constructor(e){this.id=e}};Nd=B([he],Nd);class B8{constructor(e,t,n){this.label=e,this.file=t,this.position=n}}class gg{constructor(e,t){this.covered=e,this.total=t,mg(this)}}function mg(i){if(i){if(i.covered>i.total)throw new Error(`The total number of covered items (${i.covered}) cannot be greater than the total (${i.total})`);if(i.total<0)throw new Error(`The number of covered items (${i.total}) cannot be negative`)}}class sa{static fromDetails(e,t){const n=new gg(0,0),r=new gg(0,0),s=new gg(0,0);for(const a of t)if("branches"in a){n.total+=1,n.covered+=a.executed?1:0;for(const l of a.branches)r.total+=1,r.covered+=l.executed?1:0}else s.total+=1,s.covered+=a.executed?1:0;const o=new sa(e,n,r.total>0?r:void 0,s.total>0?s:void 0);return o.detailedCoverage=t,o}constructor(e,t,n,r,s=[]){this.uri=e,this.statementCoverage=t,this.branchCoverage=n,this.declarationCoverage=r,this.fromTests=s}}class W8{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,n=[]){this.executed=e,this.location=t,this.branches=n}}class V8{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,n){this.executed=e,this.location=t,this.label=n}}class z8{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,n){this.name=e,this.executed=t,this.location=n}}var Ov;(function(i){i[i.None=0]="None",i[i.Option=1]="Option",i[i.Default=2]="Default",i[i.Preferred=3]="Preferred"})(Ov||(Ov={}));var Fv;(function(i){i[i.Untrusted=0]="Untrusted",i[i.Trusted=1]="Trusted",i[i.Unspecified=2]="Unspecified"})(Fv||(Fv={}));var Mv;(function(i){i[i.Notify=1]="Notify",i[i.OpenBrowser=2]="OpenBrowser",i[i.OpenPreview=3]="OpenPreview",i[i.Silent=4]="Silent",i[i.Ignore=5]="Ignore",i[i.OpenBrowserOnce=6]="OpenBrowserOnce"})(Mv||(Mv={}));let $v=class{constructor(e,t,n,r,s,o){this.kind=e,this.name=t,this.detail=n,this.uri=r,this.range=s,this.selectionRange=o}};class Uv{constructor(e){this.uri=e}}class _g{constructor(e,t){this.original=e,this.modified=t}}class a4{constructor(e,t,n,r){this.base=e,this.input1=t,this.input2=n,this.result=r}}class Hv{constructor(e,t){this.uri=e,this.viewType=t}}class l4{constructor(e){this.viewType=e}}class Bv{constructor(e,t){this.uri=e,this.notebookType=t}}class Wv{constructor(e,t,n){this.original=e,this.modified=t,this.notebookType=n}}class c4{constructor(){}}class u4{constructor(e,t){this.uri=e,this.inputBoxUri=t}}class d4{constructor(){}}class h4{constructor(e){this.textDiffs=e}}var Vv;(function(i){i[i.Down=0]="Down",i[i.Up=1]="Up"})(Vv||(Vv={}));var zv;(function(i){i[i.Action=1]="Action",i[i.Toolbar=2]="Toolbar"})(zv||(zv={}));var qv;(function(i){i[i.Short=1]="Short",i[i.Medium=2]="Medium",i[i.Full=3]="Full"})(qv||(qv={}));class q8{constructor(e,t,n){this.id=e,this.label=t,this.values=n}}var jv;(function(i){i[i.Unhelpful=0]="Unhelpful",i[i.Helpful=1]="Helpful",i[i.Undone=2]="Undone",i[i.Accepted=3]="Accepted",i[i.Bug=4]="Bug"})(jv||(jv={}));var Od;(function(i){i[i.Unhelpful=0]="Unhelpful",i[i.Helpful=1]="Helpful"})(Od||(Od={}));let vg=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new tn(e):e}},Fd=class{constructor(e,t){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new tn(e):e,this.vulnerabilities=t}},Md=class{constructor(e,t){this.participant=e,this.command=t}},wg=class{constructor(e,t,n,r){this.title=e,this.message=t,this.data=n,this.buttons=r}};class bg{constructor(e,t){this.value=e,this.baseUri=t}}let yg=class{constructor(e,t){this.value=e,this.title=t}},$d=class{constructor(e){this.value=e}};class f4{constructor(e,t){this.value=e,this.task=t}}let Ud=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new tn(e):e}},xg=class{constructor(e){this.value=e}},Yr=class{constructor(e,t,n){this.value=e,this.iconPath=t,this.options=n}},Eg=class{constructor(e,t,n){this.value=e,this.license=t,this.snippet=n}},Hd=class{constructor(e,t){this.uri=e,this.edits=Array.isArray(t)?t:[t]}};class p4{constructor(e,t,n,r){this.prompt=e,this.command=t,this.references=n,this.participant=r}}class g4{constructor(e,t,n,r){this.response=e,this.result=t,this.participant=n,this.command=r}}var Gn;(function(i){i[i.Panel=1]="Panel",i[i.Terminal=2]="Terminal",i[i.Notebook=3]="Notebook",i[i.Editor=4]="Editor"})(Gn||(Gn={}));var Gv;(function(i){i[i.Complete=1]="Complete",i[i.Partial=2]="Partial",i[i.Omitted=3]="Omitted"})(Gv||(Gv={}));class m4{constructor(e,t,n){this.document=e,this.selection=t,this.wholeRange=n}}class _4{constructor(e){this.cell=e}}var Cn;(function(i){i[i.User=1]="User",i[i.Assistant=2]="Assistant",i[i.System=3]="System"})(Cn||(Cn={}));class Sg{constructor(e,t,n){this.name=e,this.content=t,this.isError=n??!1}}let v4=class Dy{static User(e,t){const n=new Dy(Cn.User,typeof e=="string"?e:"",t);return n.content2=e,n}static Assistant(e,t){return new Dy(Cn.Assistant,e,t)}constructor(e,t,n){this.role=e,this.content=t,this.content2=t,this.name=n}};class Qv{constructor(e,t){this.name=e,this.parameters=t}}class Bd{constructor(e){this.value=e}}class Fi extends Error{static NotFound(e){return new Fi(e,Fi.NotFound.name)}static NoPermissions(e){return new Fi(e,Fi.NoPermissions.name)}static Blocked(e){return new Fi(e,Fi.Blocked.name)}constructor(e,t,n){super(e,{cause:n}),this.name="LanguageModelError",this.code=t??""}}var Jv;(function(i){i[i.SymbolInformation=1]="SymbolInformation",i[i.CommandInformation=2]="CommandInformation",i[i.SearchInformation=3]="SearchInformation",i[i.SettingInformation=4]="SettingInformation"})(Jv||(Jv={}));var Xv;(function(i){i[i.Started=1]="Started",i[i.Recognizing=2]="Recognizing",i[i.Recognized=3]="Recognized",i[i.Stopped=4]="Stopped",i[i.Error=5]="Error"})(Xv||(Xv={}));var Yv;(function(i){i[i.Started=1]="Started",i[i.Stopped=2]="Stopped",i[i.Error=3]="Error"})(Yv||(Yv={}));var Kv;(function(i){i[i.Recognized=1]="Recognized",i[i.Stopped=2]="Stopped"})(Kv||(Kv={}));class j8{constructor(e,t){this.text=e,this.range=t}}var Wd;(function(i){i[i.Invoke=0]="Invoke",i[i.Automatic=1]="Automatic"})(Wd||(Wd={}));var Qn;(function(i){function e(n){const{selectionStartLineNumber:r,selectionStartColumn:s,positionLineNumber:o,positionColumn:a}=n,l=new He(r-1,s-1),c=new He(o-1,a-1);return new Qr(l,c)}i.to=e;function t(n){const{anchor:r,active:s}=n;return{selectionStartLineNumber:r.line+1,selectionStartColumn:r.character+1,positionLineNumber:s.line+1,positionColumn:s.character+1}}i.from=t})(Qn||(Qn={}));var H;(function(i){function e(n){if(!n)return;const{start:r,end:s}=n;return{startLineNumber:r.line+1,startColumn:r.character+1,endLineNumber:s.line+1,endColumn:s.character+1}}i.from=e;function t(n){if(!n)return;const{startLineNumber:r,startColumn:s,endLineNumber:o,endColumn:a}=n;return new Fe(r-1,s-1,o-1,a-1)}i.to=t})(H||(H={}));var $s;(function(i){function e(n){return{uri:n.uri,range:H.from(n.range)}}i.from=e;function t(n){return new gn(y.revive(n.uri),H.to(n.range))}i.to=t})($s||($s={}));var Zv;(function(i){function e(t){switch(t){case bl.Comment:return Ms.Comment;case bl.Other:return Ms.Other;case bl.RegEx:return Ms.RegEx;case bl.String:return Ms.String}}i.to=e})(Zv||(Zv={}));var nt;(function(i){function e(n){return new He(n.lineNumber-1,n.column-1)}i.to=e;function t(n){return{lineNumber:n.line+1,column:n.character+1}}i.from=t})(nt||(nt={}));var ec;(function(i){function e(r,s,o){return Ti(fo(r).map(a=>t(a,s,o)))}i.from=e;function t(r,s,o){if(typeof r=="string")return{$serialized:!0,language:r,isBuiltin:o==null?void 0:o.isBuiltin};if(r)return{$serialized:!0,language:r.language,scheme:n(r.scheme,s),pattern:nn.from(r.pattern)??void 0,exclusive:r.exclusive,notebookType:r.notebookType,isBuiltin:o==null?void 0:o.isBuiltin}}function n(r,s){return s&&typeof r=="string"?s.transformOutgoingScheme(r):r}})(ec||(ec={}));var Dg;(function(i){function e(n){switch(n){case Qo.Unnecessary:return Dl.Unnecessary;case Qo.Deprecated:return Dl.Deprecated}}i.from=e;function t(n){switch(n){case Dl.Unnecessary:return Qo.Unnecessary;case Dl.Deprecated:return Qo.Deprecated;default:return}}i.to=t})(Dg||(Dg={}));var tc;(function(i){function e(n){let r;return n.code&&(Ge(n.code)||Ds(n.code)?r=String(n.code):r={value:String(n.code.value),target:n.code.target}),{...H.from(n.range),message:n.message,source:n.source,code:r,severity:Cg.from(n.severity),relatedInformation:n.relatedInformation&&n.relatedInformation.map(kg.from),tags:Array.isArray(n.tags)?Ti(n.tags.map(Dg.from)):void 0}}i.from=e;function t(n){var s;const r=new Rp(H.to(n),n.message,Cg.to(n.severity));return r.source=n.source,r.code=Ge(n.code)?n.code:(s=n.code)==null?void 0:s.value,r.relatedInformation=n.relatedInformation&&n.relatedInformation.map(kg.to),r.tags=n.tags&&Ti(n.tags.map(Dg.to)),r}i.to=t})(tc||(tc={}));var kg;(function(i){function e(n){return{...H.from(n.location.range),message:n.message,resource:n.location.uri}}i.from=e;function t(n){return new ud(new gn(n.resource,H.to(n)),n.message)}i.to=t})(kg||(kg={}));var Cg;(function(i){function e(n){switch(n){case bi.Error:return Bi.Error;case bi.Warning:return Bi.Warning;case bi.Information:return Bi.Info;case bi.Hint:return Bi.Hint}return Bi.Error}i.from=e;function t(n){switch(n){case Bi.Info:return bi.Information;case Bi.Warning:return bi.Warning;case Bi.Error:return bi.Error;case Bi.Hint:return bi.Hint;default:return bi.Error}}i.to=t})(Cg||(Cg={}));var Kt;(function(i){function e(n){return typeof n=="number"&&n>=vd.One?n-1:n===vd.Beside?b8:w8}i.from=e;function t(n){if(typeof n=="number"&&n>=0)return n+1;throw new Error("invalid 'EditorGroupColumn'")}i.to=t})(Kt||(Kt={}));function G8(i){return typeof i.range<"u"}function w4(i){return i.length===0?!0:!!G8(i[0])}var We;(function(i){function e(a){return a.map(i.from)}i.fromMany=e;function t(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function n(a){let l;if(t(a)){const{language:f,value:p}=a;l={value:"```"+f+`
`+p+"\n```\n"}}else tn.isMarkdownString(a)?l={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,baseUri:a.baseUri}:typeof a=="string"?l={value:a}:l={value:""};const c=Object.create(null);l.uris=c;const u=f=>{try{let p=y.parse(f,!0);p=p.with({query:r(p.query,c)}),c[f]=p}catch{}return""},d=new N2.Renderer;return d.link=u,d.image=f=>typeof f=="string"?u(h7(f).href):"",N2(l.value,{renderer:d}),l}i.from=n;function r(a,l){if(!a)return a;let c;try{c=O2(a)}catch{}if(!c)return a;let u=!1;return c=Af(c,d=>{if(y.isUri(d)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return l[f]=d,u=!0,f}else return}),u?JSON.stringify(c):a}function s(a){const l=new tn(a.value,a.supportThemeIcons);return l.isTrusted=a.isTrusted,l.supportHtml=a.supportHtml,l.baseUri=a.baseUri?y.from(a.baseUri):void 0,l}i.to=s;function o(a){if(a)return typeof a=="string"?a:i.from(a)}i.fromStrict=o})(We||(We={}));function Q8(i){return w4(i)?i.map(e=>({range:H.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?We.fromMany(e.hoverMessage):e.hoverMessage?We.from(e.hoverMessage):void 0,renderOptions:e.renderOptions})):i.map(e=>({range:H.from(e)}))}function Ig(i){return typeof i>"u"?i:typeof i=="string"?y.file(i):i}var ic;(function(i){function e(t){return typeof t>"u"?t:{contentText:t.contentText,contentIconPath:t.contentIconPath?Ig(t.contentIconPath):void 0,border:t.border,borderColor:t.borderColor,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,color:t.color,backgroundColor:t.backgroundColor,margin:t.margin,width:t.width,height:t.height}}i.from=e})(ic||(ic={}));var Pg;(function(i){function e(t){return typeof t>"u"?t:{backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?Ig(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?ic.from(t.before):void 0,after:t.after?ic.from(t.after):void 0}}i.from=e})(Pg||(Pg={}));var ew;(function(i){function e(t){if(typeof t>"u")return t;switch(t){case Xo.OpenOpen:return Sl.AlwaysGrowsWhenTypingAtEdges;case Xo.ClosedClosed:return Sl.NeverGrowsWhenTypingAtEdges;case Xo.OpenClosed:return Sl.GrowsOnlyWhenTypingBefore;case Xo.ClosedOpen:return Sl.GrowsOnlyWhenTypingAfter}}i.from=e})(ew||(ew={}));var tw;(function(i){function e(t){return{isWholeLine:t.isWholeLine,rangeBehavior:t.rangeBehavior?ew.from(t.rangeBehavior):void 0,overviewRulerLane:t.overviewRulerLane,light:t.light?Pg.from(t.light):void 0,dark:t.dark?Pg.from(t.dark):void 0,backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?Ig(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?ic.from(t.before):void 0,after:t.after?ic.from(t.after):void 0}}i.from=e})(tw||(tw={}));var ni;(function(i){function e(n){return{text:n.newText,eol:n.newEol&&oc.from(n.newEol),range:H.from(n.range)}}i.from=e;function t(n){const r=new Ns(H.to(n.range),n.text);return r.newEol=typeof n.eol>"u"?void 0:oc.to(n.eol),r}i.to=t})(ni||(ni={}));var Mi;(function(i){function e(n,r){var o;const s={edits:[]};if(n instanceof jo){const a=new Ny;for(const l of n._allEntries())l._type===Ft.File&&y.isUri(l.to)&&l.from===void 0&&a.add(l.to);for(const l of n._allEntries())if(l._type===Ft.File){let c;(o=l.options)!=null&&o.contents&&(ArrayBuffer.isView(l.options.contents)?c={type:"base64",value:$y(De.wrap(l.options.contents))}:c={type:"dataTransferItem",id:l.options.contents._itemId}),s.edits.push({oldResource:l.from,newResource:l.to,options:{...l.options,contents:c},metadata:l.metadata})}else l._type===Ft.Text?s.edits.push({resource:l.uri,textEdit:ni.from(l.edit),versionId:a.has(l.uri)||r==null?void 0:r.getTextDocumentVersion(l.uri),metadata:l.metadata}):l._type===Ft.Snippet?s.edits.push({resource:l.uri,textEdit:{range:H.from(l.range),text:l.edit.value,insertAsSnippet:!0},versionId:a.has(l.uri)||r==null?void 0:r.getTextDocumentVersion(l.uri),metadata:l.metadata}):l._type===Ft.Cell?s.edits.push({metadata:l.metadata,resource:l.uri,cellEdit:l.edit,notebookMetadata:l.notebookMetadata,notebookVersionId:r==null?void 0:r.getNotebookDocumentVersion(l.uri)}):l._type===Ft.CellReplace&&s.edits.push({metadata:l.metadata,resource:l.uri,notebookVersionId:r==null?void 0:r.getNotebookDocumentVersion(l.uri),cellEdit:{editType:ld.Replace,index:l.index,count:l.count,cells:l.cells.map(Jd.from)}})}return s}i.from=e;function t(n){const r=new jo,s=new $t;for(const o of n.edits)if(o.textEdit){const a=o,l=y.revive(a.resource),c=H.to(a.textEdit.range),u=a.textEdit.text,d=a.textEdit.insertAsSnippet;let f;d?f=qo.replace(c,new Go(u)):f=Ns.replace(c,u);const p=s.get(l);p?p.push(f):s.set(l,[f])}else r.renameFile(y.revive(o.oldResource),y.revive(o.newResource),o.options);for(const[o,a]of s)r.set(o,a);return r}i.to=t})(Mi||(Mi={}));var In;(function(i){const e=Object.create(null);e[dt.File]=ee.File,e[dt.Module]=ee.Module,e[dt.Namespace]=ee.Namespace,e[dt.Package]=ee.Package,e[dt.Class]=ee.Class,e[dt.Method]=ee.Method,e[dt.Property]=ee.Property,e[dt.Field]=ee.Field,e[dt.Constructor]=ee.Constructor,e[dt.Enum]=ee.Enum,e[dt.Interface]=ee.Interface,e[dt.Function]=ee.Function,e[dt.Variable]=ee.Variable,e[dt.Constant]=ee.Constant,e[dt.String]=ee.String,e[dt.Number]=ee.Number,e[dt.Boolean]=ee.Boolean,e[dt.Array]=ee.Array,e[dt.Object]=ee.Object,e[dt.Key]=ee.Key,e[dt.Null]=ee.Null,e[dt.EnumMember]=ee.EnumMember,e[dt.Struct]=ee.Struct,e[dt.Event]=ee.Event,e[dt.Operator]=ee.Operator,e[dt.TypeParameter]=ee.TypeParameter;function t(r){return typeof e[r]=="number"?e[r]:ee.Property}i.from=t;function n(r){for(const s in e)if(e[s]===r)return Number(s);return dt.Property}i.to=n})(In||(In={}));var Kr;(function(i){function e(n){switch(n){case hd.Deprecated:return Zf.Deprecated}}i.from=e;function t(n){switch(n){case Zf.Deprecated:return hd.Deprecated}}i.to=t})(Kr||(Kr={}));var Vd;(function(i){function e(n){return{name:n.name,kind:In.from(n.kind),tags:n.tags&&n.tags.map(Kr.from),containerName:n.containerName,location:zi.from(n.location)}}i.from=e;function t(n){const r=new fd(n.name,In.to(n.kind),n.containerName,zi.to(n.location));return r.tags=n.tags&&n.tags.map(Kr.to),r}i.to=t})(Vd||(Vd={}));var iw;(function(i){function e(n){var s;const r={name:n.name||"!!MISSING: name!!",detail:n.detail,range:H.from(n.range),selectionRange:H.from(n.selectionRange),kind:In.from(n.kind),tags:((s=n.tags)==null?void 0:s.map(Kr.from))??[]};return n.children&&(r.children=n.children.map(e)),r}i.from=e;function t(n){const r=new pd(n.name,n.detail,In.to(n.kind),H.to(n.range),H.to(n.selectionRange));return uu(n.tags)&&(r.tags=n.tags.map(Kr.to)),n.children&&(r.children=n.children.map(t)),r}i.to=t})(iw||(iw={}));var oa;(function(i){function e(n){const r=new sv(In.to(n.kind),n.name,n.detail||"",y.revive(n.uri),H.to(n.range),H.to(n.selectionRange));return r._sessionId=n._sessionId,r._itemId=n._itemId,r}i.to=e;function t(n,r,s){var o;if(r=r??n._sessionId,s=s??n._itemId,r===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:s,name:n.name,detail:n.detail,kind:In.from(n.kind),uri:n.uri,range:H.from(n.range),selectionRange:H.from(n.selectionRange),tags:(o=n.tags)==null?void 0:o.map(Kr.from)}}i.from=t})(oa||(oa={}));var nw;(function(i){function e(t){return new YS(oa.to(t.from),t.fromRanges.map(n=>H.to(n)))}i.to=e})(nw||(nw={}));var rw;(function(i){function e(t){return new KS(oa.to(t.to),t.fromRanges.map(n=>H.to(n)))}i.to=e})(rw||(rw={}));var zi;(function(i){function e(n){return{range:n.range&&H.from(n.range),uri:n.uri}}i.from=e;function t(n){return new gn(y.revive(n.uri),H.to(n.range))}i.to=t})(zi||(zi={}));var zd;(function(i){function e(n){const r=n,s=n;return{originSelectionRange:r.originSelectionRange?H.from(r.originSelectionRange):void 0,uri:r.targetUri?r.targetUri:s.uri,range:H.from(r.targetRange?r.targetRange:s.range),targetSelectionRange:r.targetSelectionRange?H.from(r.targetSelectionRange):void 0}}i.from=e;function t(n){return{targetUri:y.revive(n.uri),targetRange:H.to(n.range),targetSelectionRange:n.targetSelectionRange?H.to(n.targetSelectionRange):void 0,originSelectionRange:n.originSelectionRange?H.to(n.originSelectionRange):void 0}}i.to=t})(zd||(zd={}));var qd;(function(i){function e(n){return{range:H.from(n.range),contents:We.fromMany(n.contents),canIncreaseVerbosity:n.canIncreaseVerbosity,canDecreaseVerbosity:n.canDecreaseVerbosity}}i.from=e;function t(n){const r=n.contents.map(We.to),s=H.to(n.range),o=n.canIncreaseVerbosity,a=n.canDecreaseVerbosity;return new Np(r,s,o,a)}i.to=t})(qd||(qd={}));var sw;(function(i){function e(n){return{range:H.from(n.range),expression:n.expression}}i.from=e;function t(n){return new tg(H.to(n.range),n.expression)}i.to=t})(sw||(sw={}));var Tg;(function(i){function e(n){if(n instanceof ig)return{type:"text",range:H.from(n.range),text:n.text};if(n instanceof ng)return{type:"variable",range:H.from(n.range),variableName:n.variableName,caseSensitiveLookup:n.caseSensitiveLookup};if(n instanceof rg)return{type:"expression",range:H.from(n.range),expression:n.expression};throw new Error("Unknown 'InlineValue' type")}i.from=e;function t(n){switch(n.type){case"text":return{range:H.to(n.range),text:n.text};case"variable":return{range:H.to(n.range),variableName:n.variableName,caseSensitiveLookup:n.caseSensitiveLookup};case"expression":return{range:H.to(n.range),expression:n.expression}}}i.to=t})(Tg||(Tg={}));var Ag;(function(i){function e(n){return{frameId:n.frameId,stoppedLocation:H.from(n.stoppedLocation)}}i.from=e;function t(n){return new Ev(n.frameId,H.to(n.stoppedLocation))}i.to=t})(Ag||(Ag={}));var nc;(function(i){function e(n){return{range:H.from(n.range),kind:n.kind}}i.from=e;function t(n){return new Op(H.to(n.range),n.kind)}i.to=t})(nc||(nc={}));var ow;(function(i){function e(n){return{uri:n.uri,highlights:n.highlights.map(nc.from)}}i.from=e;function t(n){return new Fp(y.revive(n.uri),n.highlights.map(nc.to))}i.to=t})(ow||(ow={}));var aw;(function(i){function e(t){switch(t){case zu.TriggerCharacter:return Ml.TriggerCharacter;case zu.TriggerForIncompleteCompletions:return Ml.TriggerForIncompleteCompletions;case zu.Invoke:default:return Ml.Invoke}}i.to=e})(aw||(aw={}));var lw;(function(i){function e(t){return{triggerKind:aw.to(t.triggerKind),triggerCharacter:t.triggerCharacter}}i.to=e})(lw||(lw={}));var Rg;(function(i){function e(n){switch(n){case _d.Deprecated:return Xf.Deprecated}}i.from=e;function t(n){switch(n){case Xf.Deprecated:return _d.Deprecated}}i.to=t})(Rg||(Rg={}));var Lg;(function(i){const e=new Map([[ye.Method,W.Method],[ye.Function,W.Function],[ye.Constructor,W.Constructor],[ye.Field,W.Field],[ye.Variable,W.Variable],[ye.Class,W.Class],[ye.Interface,W.Interface],[ye.Struct,W.Struct],[ye.Module,W.Module],[ye.Property,W.Property],[ye.Unit,W.Unit],[ye.Value,W.Value],[ye.Constant,W.Constant],[ye.Enum,W.Enum],[ye.EnumMember,W.EnumMember],[ye.Keyword,W.Keyword],[ye.Snippet,W.Snippet],[ye.Text,W.Text],[ye.Color,W.Color],[ye.File,W.File],[ye.Reference,W.Reference],[ye.Folder,W.Folder],[ye.Event,W.Event],[ye.Operator,W.Operator],[ye.TypeParameter,W.TypeParameter],[ye.Issue,W.Issue],[ye.User,W.User]]);function t(s){return e.get(s)??W.Property}i.from=t;const n=new Map([[W.Method,ye.Method],[W.Function,ye.Function],[W.Constructor,ye.Constructor],[W.Field,ye.Field],[W.Variable,ye.Variable],[W.Class,ye.Class],[W.Interface,ye.Interface],[W.Struct,ye.Struct],[W.Module,ye.Module],[W.Property,ye.Property],[W.Unit,ye.Unit],[W.Value,ye.Value],[W.Constant,ye.Constant],[W.Enum,ye.Enum],[W.EnumMember,ye.EnumMember],[W.Keyword,ye.Keyword],[W.Snippet,ye.Snippet],[W.Text,ye.Text],[W.Color,ye.Color],[W.File,ye.File],[W.Reference,ye.Reference],[W.Folder,ye.Folder],[W.Event,ye.Event],[W.Operator,ye.Operator],[W.TypeParameter,ye.TypeParameter],[W.User,ye.User],[W.Issue,ye.Issue]]);function r(s){return n.get(s)??ye.Property}i.to=r})(Lg||(Lg={}));var cw;(function(i){function e(t,n){var s;const r=new Bp(t.label);return r.insertText=t.insertText,r.kind=Lg.to(t.kind),r.tags=(s=t.tags)==null?void 0:s.map(Rg.to),r.detail=t.detail,r.documentation=Io(t.documentation)?We.to(t.documentation):t.documentation,r.sortText=t.sortText,r.filterText=t.filterText,r.preselect=t.preselect,r.commitCharacters=t.commitCharacters,ct.isIRange(t.range)?r.range=H.to(t.range):typeof t.range=="object"&&(r.range={inserting:H.to(t.range.insert),replacing:H.to(t.range.replace)}),r.keepWhitespace=typeof t.insertTextRules>"u"?!1:!!(t.insertTextRules&Mo.KeepWhitespace),typeof t.insertTextRules<"u"&&t.insertTextRules&Mo.InsertAsSnippet?r.insertText=new Go(t.insertText):(r.insertText=t.insertText,r.textEdit=r.range instanceof Fe?new Ns(r.range,r.insertText):void 0),t.additionalTextEdits&&t.additionalTextEdits.length>0&&(r.additionalTextEdits=t.additionalTextEdits.map(o=>ni.to(o))),r.command=n&&t.command?n.fromInternal(t.command):void 0,r}i.to=e})(cw||(cw={}));var Ng;(function(i){function e(n){if(typeof n.label!="string"&&!Array.isArray(n.label))throw new TypeError("Invalid label");return{label:n.label,documentation:We.fromStrict(n.documentation)}}i.from=e;function t(n){return{label:n.label,documentation:Io(n.documentation)?We.to(n.documentation):n.documentation}}i.to=t})(Ng||(Ng={}));var Og;(function(i){function e(n){return{label:n.label,documentation:We.fromStrict(n.documentation),parameters:Array.isArray(n.parameters)?n.parameters.map(Ng.from):[],activeParameter:n.activeParameter}}i.from=e;function t(n){return{label:n.label,documentation:Io(n.documentation)?We.to(n.documentation):n.documentation,parameters:Array.isArray(n.parameters)?n.parameters.map(Ng.to):[],activeParameter:n.activeParameter}}i.to=t})(Og||(Og={}));var jd;(function(i){function e(n){return{activeSignature:n.activeSignature,activeParameter:n.activeParameter,signatures:Array.isArray(n.signatures)?n.signatures.map(Og.from):[]}}i.from=e;function t(n){return{activeSignature:n.activeSignature,activeParameter:n.activeParameter,signatures:Array.isArray(n.signatures)?n.signatures.map(Og.to):[]}}i.to=t})(jd||(jd={}));var uw;(function(i){function e(t,n){const r=new Hp(nt.to(n.position),typeof n.label=="string"?n.label:n.label.map(dw.to.bind(void 0,t)),n.kind&&Fg.to(n.kind));return r.textEdits=n.textEdits&&n.textEdits.map(ni.to),r.tooltip=Io(n.tooltip)?We.to(n.tooltip):n.tooltip,r.paddingLeft=n.paddingLeft,r.paddingRight=n.paddingRight,r}i.to=e})(uw||(uw={}));var dw;(function(i){function e(t,n){const r=new Up(n.label);return r.tooltip=Io(n.tooltip)?We.to(n.tooltip):n.tooltip,E_.is(n.command)&&(r.command=t.fromInternal(n.command)),n.location&&(r.location=zi.to(n.location)),r}i.to=e})(dw||(dw={}));var Fg;(function(i){function e(n){return n}i.from=e;function t(n){return n}i.to=t})(Fg||(Fg={}));var aa;(function(i){function e(n){return{range:H.from(n.range),url:n.target,tooltip:n.tooltip}}i.from=e;function t(n){let r;if(n.url)try{r=typeof n.url=="string"?y.parse(n.url,!0):y.revive(n.url)}catch{}const s=new Vp(H.to(n.range),r);return s.tooltip=n.tooltip,s}i.to=t})(aa||(aa={}));var Mg;(function(i){function e(n){const r=new qp(n.label);return n.textEdit&&(r.textEdit=ni.to(n.textEdit)),n.additionalTextEdits&&(r.additionalTextEdits=n.additionalTextEdits.map(s=>ni.to(s))),r}i.to=e;function t(n){return{label:n.label,textEdit:n.textEdit?ni.from(n.textEdit):void 0,additionalTextEdits:n.additionalTextEdits?n.additionalTextEdits.map(r=>ni.from(r)):void 0}}i.from=t})(Mg||(Mg={}));var rc;(function(i){function e(n){return new Wl(n[0],n[1],n[2],n[3])}i.to=e;function t(n){return[n.red,n.green,n.blue,n.alpha]}i.from=t})(rc||(rc={}));var hw;(function(i){function e(n){return{range:H.from(n.range)}}i.from=e;function t(n){return new md(H.to(n.range))}i.to=t})(hw||(hw={}));var $g;(function(i){function e(t){switch(t){case Il.AUTO:return Ul.AfterDelay;case Il.EXPLICIT:return Ul.Manual;case Il.FOCUS_CHANGE:case Il.WINDOW_CHANGE:return Ul.FocusOut}}i.to=e})($g||($g={}));var sc;(function(i){function e(n){switch(n){case jn.Off:return ki.Off;case jn.Relative:return ki.Relative;case jn.Interval:return ki.Interval;case jn.On:default:return ki.On}}i.from=e;function t(n){switch(n){case ki.Off:return jn.Off;case ki.Relative:return jn.Relative;case ki.Interval:return jn.Interval;case ki.On:default:return jn.On}}i.to=t})(sc||(sc={}));var oc;(function(i){function e(n){if(n===qn.CRLF)return El.CRLF;if(n===qn.LF)return El.LF}i.from=e;function t(n){if(n===El.CRLF)return qn.CRLF;if(n===El.LF)return qn.LF}i.to=t})(oc||(oc={}));var fw;(function(i){function e(t){if(typeof t=="object")return t.viewId;switch(t){case Zo.SourceControl:return Qu.Scm;case Zo.Window:return Qu.Window;case Zo.Notification:return Qu.Notification}throw new Error("Unknown 'ProgressLocation'")}i.from=e})(fw||(fw={}));var Ug;(function(i){function e(n){const r={start:n.start+1,end:n.end+1};return n.kind&&(r.kind=Hg.from(n.kind)),r}i.from=e;function t(n){const r={start:n.start-1,end:n.end-1};return n.kind&&(r.kind=Hg.to(n.kind)),r}i.to=t})(Ug||(Ug={}));var Hg;(function(i){function e(n){if(n)switch(n){case Jr.Comment:return yl.Comment;case Jr.Imports:return yl.Imports;case Jr.Region:return yl.Region}}i.from=e;function t(n){if(n)switch(n.value){case yl.Comment.value:return Jr.Comment;case yl.Imports.value:return Jr.Imports;case yl.Region.value:return Jr.Region}}i.to=t})(Hg||(Hg={}));var Gd;(function(i){function e(t){if(t)return{pinned:typeof t.preview=="boolean"?!t.preview:void 0,inactive:t.background,preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?H.from(t.selection):void 0,override:typeof t.override=="boolean"?TP.id:void 0}}i.from=e})(Gd||(Gd={}));var nn;(function(i){function e(s){return s instanceof jl?s.toJSON():typeof s=="string"?s:t(s)||n(s)?new jl(s.baseUri??s.base,s.pattern).toJSON():s}i.from=e;function t(s){const o=s;return o?y.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function n(s){const o=s;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function r(s){return typeof s=="string"?s:new jl(y.revive(s.baseUri),s.pattern)}i.to=r})(nn||(nn={}));var pw;(function(i){function e(t){if(t){if(Array.isArray(t))return t.map(e);if(typeof t=="string")return t;{const n=t;return{language:n.language,scheme:n.scheme,pattern:nn.from(n.pattern),exclusive:n.exclusive,notebookType:n.notebookType}}}else return}i.from=e})(pw||(pw={}));var Bg;(function(i){function e(n){return!!n&&typeof n=="object"&&"documents"in n&&Array.isArray(n.documents)&&n.documents.every(r=>Array.isArray(r)&&r.every(s=>s&&typeof s=="object"&&"uri"in s&&y.isUri(s.uri)&&"version"in s&&typeof s.version=="number"&&"ranges"in s&&Array.isArray(s.ranges)&&s.ranges.every(o=>o instanceof Fe)))}i.is=e;function t(n){return{documents:n.documents.map(r=>r.map(s=>({uri:y.from(s.uri),version:s.version,ranges:s.ranges.map(o=>H.from(o))})))}}i.from=t})(Bg||(Bg={}));var mr;(function(i){function e(n){return{start:n.start,end:n.end}}i.from=e;function t(n){return new Xr(n.start,n.end)}i.to=t})(mr||(mr={}));var ac;(function(i){function e(n){return{timing:typeof n.runStartTime=="number"&&typeof n.runEndTime=="number"?{startTime:n.runStartTime,endTime:n.runEndTime}:void 0,executionOrder:n.executionOrder,success:n.lastRunSuccess}}i.to=e;function t(n){var r,s;return{lastRunSuccess:n.success,runStartTime:(r=n.timing)==null?void 0:r.startTime,runEndTime:(s=n.timing)==null?void 0:s.endTime,executionOrder:n.executionOrder}}i.from=t})(ac||(ac={}));var gw;(function(i){function e(t){if(t===ad.Unconfirmed)return Yl.Pending;if(t===ad.Pending)return;if(t===ad.Executing)return Yl.Executing;throw new Error(`Unknown state: ${t}`)}i.to=e})(gw||(gw={}));var Qd;(function(i){function e(n){switch(n){case ra.Markup:return Nl.Markup;case ra.Code:default:return Nl.Code}}i.from=e;function t(n){switch(n){case Nl.Markup:return ra.Markup;case Nl.Code:default:return ra.Code}}i.to=t})(Qd||(Qd={}));var Us;(function(i){function e(n){const r={metadata:n.metadata??Object.create(null),cells:[]};for(const s of n.cells)lg.validate(s),r.cells.push(Jd.from(s));return r}i.from=e;function t(n){const r=new r4(n.cells.map(Jd.to));return Px(n.metadata)||(r.metadata=n.metadata),r}i.to=t})(Us||(Us={}));var Jd;(function(i){function e(n){return{cellKind:Qd.from(n.kind),language:n.languageId,mime:n.mime,source:n.value,metadata:n.metadata,internalMetadata:ac.from(n.executionSummary??{}),outputs:n.outputs?n.outputs.map(Hs.from):[]}}i.from=e;function t(n){return new lg(Qd.to(n.cellKind),n.source,n.language,n.mime,n.outputs?n.outputs.map(Hs.to):void 0,n.metadata,n.internalMetadata?ac.to(n.internalMetadata):void 0)}i.to=t})(Jd||(Jd={}));var lc;(function(i){function e(n){return{mime:n.mime,valueBytes:De.wrap(n.data)}}i.from=e;function t(n){return new s4(n.valueBytes.buffer,n.mime)}i.to=t})(lc||(lc={}));var Hs;(function(i){function e(n){return{outputId:n.id,items:n.items.map(lc.from),metadata:n.metadata}}i.from=e;function t(n){const r=n.items.map(lc.to);return new cg(r,n.outputId,n.metadata)}i.to=t})(Hs||(Hs={}));var Wg;(function(i){function e(r){return n(r)?{include:nn.from(r.include)??void 0,exclude:nn.from(r.exclude)??void 0}:nn.from(r)??void 0}i.from=e;function t(r){return n(r)?{include:nn.to(r.include),exclude:nn.to(r.exclude)}:nn.to(r)}i.to=t;function n(r){const s=r;return s?!Wt(s.include)&&!Wt(s.exclude):!1}})(Wg||(Wg={}));var mw;(function(i){function e(t,n,r){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{alignment:t.alignment===ug.Left?kp.Left:kp.Right,command:n.toInternal(s,r),text:t.text,tooltip:t.tooltip,accessibilityInformation:t.accessibilityInformation,priority:t.priority}}i.from=e})(mw||(mw={}));var _w;(function(i){function e(t,n,r){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{command:n.toInternal(s,r),label:t.label,description:t.description,detail:t.detail,documentation:t.documentation}}i.from=e})(_w||(_w={}));var vw;(function(i){function e(t){return{transientOutputs:(t==null?void 0:t.transientOutputs)??!1,transientCellMetadata:(t==null?void 0:t.transientCellMetadata)??{},transientDocumentMetadata:(t==null?void 0:t.transientDocumentMetadata)??{},cellContentMetadata:(t==null?void 0:t.cellContentMetadata)??{}}}i.from=e})(vw||(vw={}));var Vg;(function(i){function e(n){return{uri:n.uri,provides:n.provides}}i.from=e;function t(n){return new o4(y.revive(n.uri),n.provides)}i.to=t})(Vg||(Vg={}));var cc;(function(i){function e(n){var r;return{message:We.fromStrict(n.message)||"",type:Wn.Error,expected:n.expectedOutput,actual:n.actualOutput,contextValue:n.contextValue,location:n.location&&{range:H.from(n.location.range),uri:n.location.uri},stackTrace:(r=n.stackTrace)==null?void 0:r.map(s=>({label:s.label,position:s.position&&nt.from(s.position),uri:s.file&&y.revive(s.file).toJSON()}))}}i.from=e;function t(n){const r=new Ld(typeof n.message=="string"?n.message:We.to(n.message));return r.actualOutput=n.actual,r.expectedOutput=n.expected,r.contextValue=n.contextValue,r.location=n.location?zi.to(n.location):void 0,r}i.to=t})(cc||(cc={}));var Jn;(function(i){i.namespace=op,i.denamespace=_E})(Jn||(Jn={}));var Bs;(function(i){function e(n){const r=fp(n).controllerId;return{extId:Ie.fromExtHostTestItem(n,r).toString(),label:n.label,uri:y.revive(n.uri),busy:n.busy,tags:n.tags.map(s=>Jn.namespace(r,s.id)),range:ct.lift(H.from(n.range)),description:n.description||null,sortText:n.sortText||null,error:n.error&&We.fromStrict(n.error)||null}}i.from=e;function t(n){return{parent:void 0,error:void 0,id:Ie.fromString(n.extId).localId,label:n.label,uri:y.revive(n.uri),tags:(n.tags||[]).map(r=>{const{tagId:s}=Jn.denamespace(r);return new Nd(s)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:H.to(n.range||void 0),canResolveChildren:!1,busy:n.busy,description:n.description||void 0,sortText:n.sortText||void 0}}i.toPlain=t})(Bs||(Bs={})),function(i){function e(n){return{id:n.id}}i.from=e;function t(n){return new Nd(n.id)}i.to=t}(Jn||(Jn={}));var ww;(function(i){const e=(n,r)=>{const s=n.value;if(!s)return;const o={...Bs.toPlain(s.item),parent:r,taskStates:s.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(l=>l.type===Wn.Error).map(cc.to)})),children:[]};if(n.children)for(const a of n.children.values()){const l=e(a,o);l&&o.children.push(l)}return o};function t(n){const r=new r9;for(const a of n.items)r.insert(Ie.fromString(a.item.extId).path,a);const s=[r.nodes],o=[];for(;s.length;)for(const a of s.pop())a.value?o.push(a):a.children&&s.push(a.children.values());return{completedAt:n.completedAt,results:o.map(a=>e(a)).filter(yo)}}i.to=t})(ww||(ww={}));var zg;(function(i){function e(s){return{covered:s.covered,total:s.total}}function t(s){return"line"in s?nt.from(s):H.from(s)}function n(s){if(typeof s.executed=="number"&&s.executed<0)throw new Error(`Invalid coverage count ${s.executed}`);return"branches"in s?{count:s.executed,location:t(s.location),type:Cl.Statement,branches:s.branches.length?s.branches.map(o=>({count:o.executed,location:o.location&&t(o.location),label:o.label})):void 0}:{type:Cl.Declaration,name:s.name,count:s.executed,location:t(s.location)}}i.fromDetails=n;function r(s,o,a){return mg(a.statementCoverage),mg(a.branchCoverage),mg(a.declarationCoverage),{id:o,uri:a.uri,statement:e(a.statementCoverage),branch:a.branchCoverage&&e(a.branchCoverage),declaration:a.declarationCoverage&&e(a.declarationCoverage),testIds:a instanceof sa&&a.fromTests.length?a.fromTests.map(l=>Ie.fromExtHostTestItem(l,s).toString()):void 0}}i.fromFile=r})(zg||(zg={}));var bw;(function(i){function e(t){switch(t){case Kf.Invoke:return gd.Invoke;case Kf.Auto:return gd.Automatic}}i.to=e})(bw||(bw={}));var la;(function(i){function e(n){const r=new $v(In.to(n.kind),n.name,n.detail||"",y.revive(n.uri),H.to(n.range),H.to(n.selectionRange));return r._sessionId=n._sessionId,r._itemId=n._itemId,r}i.to=e;function t(n,r,s){var o;if(r=r??n._sessionId,s=s??n._itemId,r===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:s,kind:In.from(n.kind),name:n.name,detail:n.detail??"",uri:n.uri,range:H.from(n.range),selectionRange:H.from(n.selectionRange),tags:(o=n.tags)==null?void 0:o.map(Kr.from)}}i.from=t})(la||(la={}));var qg;(function(i){function e(t){if(t)return{value:t.value,tooltip:t.tooltip}}i.from=e})(qg||(qg={}));var jg;(function(i){function e(s,o,a){const l=o.fileData;return l?new T8(new A8(l.name,y.revive(l.uri),l.id,R1(()=>a(l.id)))):s===Mr.uriList&&o.uriListData?new Xp(r(o.uriListData)):new Xp(o.asString)}i.to=e;async function t(s,o){const a=await o.asString();if(s===Mr.uriList)return{asString:a,fileData:void 0,uriListData:n(a)};const l=o.asFile();return{asString:a,fileData:l?{name:l.name,uri:l.uri,id:l._itemId??l.id}:void 0}}i.from=t;function n(s){return f_.split(s).map(o=>{if(o.startsWith("#"))return o;try{return y.parse(o)}catch{}return o})}function r(s){return f_.create(s.map(o=>typeof o=="string"?o:y.revive(o)))}})(jg||(jg={}));var Ws;(function(i){function e(n,r){const s=n.items.map(([o,a])=>[o,jg.to(o,a,r)]);return new yd(s)}i.toDataTransfer=e;async function t(n){const r={items:[]},s=[];for(const[o,a]of n)s.push((async()=>{r.items.push([o,await jg.from(o,a)])})());return await Promise.all(s),r}i.from=t})(Ws||(Ws={}));var Xd;(function(i){function e(n,r){return{kind:"reply",agentId:n.participant??(r==null?void 0:r.agentId)??"",subCommand:n.command??(r==null?void 0:r.command),message:n.prompt,title:n.label}}i.from=e;function t(n){return{prompt:n.message,label:n.title,participant:n.agentId,command:n.subCommand}}i.to=t})(Xd||(Xd={}));var Gg;(function(i){function e(n){switch(n){case qr.System:return Cn.System;case qr.User:return Cn.User;case qr.Assistant:return Cn.Assistant}}i.to=e;function t(n){switch(n){case Cn.System:return qr.System;case Cn.User:return qr.User;case Cn.Assistant:return qr.Assistant}return qr.User}i.from=t})(Gg||(Gg={}));var uc;(function(i){function e(n){let r="",s;n.content.type==="text"?r=n.content.value:s=new Sg(n.content.name,n.content.value,n.content.isError);const o=Gg.to(n.role),a=new v4(o,r,n.name);return s!==void 0&&(a.content2=s),a}i.to=e;function t(n){const r=Gg.from(n.role),s=n.name;let o;return n.content2 instanceof Sg?o={type:"function_result",name:n.content2.name,value:n.content2.content,isError:n.content2.isError}:o={type:"text",value:n.content},{role:r,name:s,content:o}}i.from=t})(uc||(uc={}));var Yd;(function(i){function e(n){return{kind:"markdownContent",content:We.from(n.value)}}i.from=e;function t(n){return new vg(We.to(n.content))}i.to=t})(Yd||(Yd={}));var Qg;(function(i){function e(n){return{kind:"markdownVuln",content:We.from(n.value),vulnerabilities:n.vulnerabilities}}i.from=e;function t(n){return new Fd(We.to(n.content),n.vulnerabilities)}i.to=t})(Qg||(Qg={}));var Jg;(function(i){function e(n){return{kind:"agentDetection",agentId:n.participant,command:n.command}}i.from=e;function t(n){return new Md(n.agentId,n.command)}i.to=t})(Jg||(Jg={}));var Xg;(function(i){function e(t){return{kind:"confirmation",title:t.title,message:t.message,data:t.data,buttons:t.buttons}}i.from=e})(Xg||(Xg={}));var Kd;(function(i){function e(n){const{value:r,baseUri:s}=n;function o(a,l){return a.map(c=>{const u=y.joinPath(l,c.name);return{label:c.name,uri:u,children:c.children&&o(c.children,u)}})}return{kind:"treeData",treeData:{label:xo(s),uri:s,children:o(r,s)}}}i.from=e;function t(n){const r=Ki(n.treeData);function s(l){return l.map(c=>({name:c.label,children:c.children&&s(c.children)}))}const o=r.uri,a=r.children?s(r.children):[];return new bg(a,o)}i.to=t})(Kd||(Kd={}));var Zd;(function(i){function e(n){const r=s=>y.isUri(s);return{kind:"inlineReference",name:n.title,inlineReference:r(n.value)?n.value:$s.from(n.value)}}i.from=e;function t(n){const r=Ki(n);return new yg(y.isUri(r.inlineReference)?r.inlineReference:$s.to(r.inlineReference),n.name)}i.to=t})(Zd||(Zd={}));var dc;(function(i){function e(n){return{kind:"progressMessage",content:We.from(n.value)}}i.from=e;function t(n){return new $d(n.content.value)}i.to=t})(dc||(dc={}));var eh;(function(i){function e(n){return{kind:"warning",content:We.from(n.value)}}i.from=e;function t(n){return new Ud(n.content.value)}i.to=t})(eh||(eh={}));var yw;(function(i){function e(t){return{kind:"progressTask",content:We.from(t.value)}}i.from=e})(yw||(yw={}));var xw;(function(i){function e(t){return{kind:"progressTaskResult",content:typeof t=="string"?We.from(t):void 0}}i.from=e})(xw||(xw={}));var th;(function(i){function e(n,r,s){return{kind:"command",command:r.toInternal(n.value,s)??{command:n.value.command,title:n.value.title}}}i.from=e;function t(n,r){return new xg(r.fromInternal(n.command)??{command:n.command.id,title:n.command.title})}i.to=t})(th||(th={}));var Yg;(function(i){function e(n){return{kind:"textEdit",uri:n.uri,edits:n.edits.map(r=>ni.from(r))}}i.from=e;function t(n){return new Hd(y.revive(n.uri),n.edits.map(r=>ni.to(r)))}i.to=t})(Yg||(Yg={}));var Zr;(function(i){function e(n){const r=Si.isThemeIcon(n.iconPath)?n.iconPath:y.isUri(n.iconPath)?{light:y.revive(n.iconPath)}:n.iconPath&&"light"in n.iconPath&&"dark"in n.iconPath&&y.isUri(n.iconPath.light)&&y.isUri(n.iconPath.dark)?{light:y.revive(n.iconPath.light),dark:y.revive(n.iconPath.dark)}:void 0;return"variableName"in n.value?{kind:"reference",reference:{variableName:n.value.variableName,value:y.isUri(n.value.value)||!n.value.value?n.value.value:$s.from(n.value.value)},iconPath:r,options:n.options}:{kind:"reference",reference:y.isUri(n.value)?n.value:$s.from(n.value),iconPath:r,options:n.options}}i.from=e;function t(n){const r=Ki(n),s=o=>y.isUri(o)?o:$s.to(o);return new Yr("variableName"in r.reference?{variableName:r.reference.variableName,value:r.reference.value&&s(r.reference.value)}:s(r.reference))}i.to=t})(Zr||(Zr={}));var Kg;(function(i){function e(t){return{kind:"codeCitation",value:t.value,license:t.license,snippet:t.snippet}}i.from=e})(Kg||(Kg={}));var Zg;(function(i){function e(r,s,o){return r instanceof vg?Yd.from(r):r instanceof yg?Zd.from(r):r instanceof Yr?Zr.from(r):r instanceof $d?dc.from(r):r instanceof bg?Kd.from(r):r instanceof xg?th.from(r,s,o):r instanceof Hd?Yg.from(r):r instanceof Fd?Qg.from(r):r instanceof Md?Jg.from(r):r instanceof Ud?eh.from(r):r instanceof wg?Xg.from(r):r instanceof Eg?Kg.from(r):{kind:"markdownContent",content:We.from("")}}i.from=e;function t(r,s){switch(r.kind){case"reference":return Zr.to(r);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return n(r,s)}}i.to=t;function n(r,s){switch(r.kind){case"markdownContent":return Yd.to(r);case"inlineReference":return Zd.to(r);case"progressMessage":return;case"treeData":return Kd.to(r);case"command":return th.to(r,s)}}i.toContent=n})(Zg||(Zg={}));var Ew;(function(i){function e(t,n){const r=t.variables.variables.filter(o=>o.isTool).map(o=>o.id),s=t.variables.variables.filter(o=>!o.isTool);return{prompt:t.message,command:t.command,attempt:t.attempt??0,enableCommandDetection:t.enableCommandDetection??!0,references:s.map(em.to),location:ih.to(t.location),acceptedConfirmationData:t.acceptedConfirmationData,rejectedConfirmationData:t.rejectedConfirmationData,location2:n,requestedTools:r}}i.to=e})(Ew||(Ew={}));var ih;(function(i){function e(n){switch(n){case Wi.Notebook:return Gn.Notebook;case Wi.Terminal:return Gn.Terminal;case Wi.Panel:return Gn.Panel;case Wi.Editor:return Gn.Editor}}i.to=e;function t(n){switch(n){case Gn.Notebook:return Wi.Notebook;case Gn.Terminal:return Wi.Terminal;case Gn.Panel:return Wi.Panel;case Gn.Editor:return Wi.Editor}}i.from=t})(ih||(ih={}));var em;(function(i){function e(t){const n=t.value;if(!n)throw new Error("Invalid value reference");return{id:t.id,name:t.name,range:t.range&&[t.range.start,t.range.endExclusive],value:ex(n)?y.revive(n):n&&typeof n=="object"&&"uri"in n&&"range"in n&&ex(n.uri)?$s.to(Ki(n)):n,modelDescription:t.modelDescription}}i.to=e})(em||(em={}));var Sw;(function(i){function e(t,n,r){var s;return{id:t.id,label:t.label,fullName:t.fullName,icon:(s=t.icon)==null?void 0:s.id,value:t.values[0].value,insertText:t.insertText,detail:t.detail,documentation:t.documentation,command:n.toInternal(t.command,r)}}i.from=e})(Sw||(Sw={}));var hc;(function(i){function e(t){return{errorDetails:t.errorDetails,metadata:t.metadata}}i.to=e})(hc||(hc={}));var Dw;(function(i){function e(t,n,r){if(n.action.kind==="vote")return;const s=hc.to(t);if(n.action.kind==="command"){const o=n.action.commandButton.command;return{action:{kind:"command",commandButton:{command:r.fromInternal(o)??{command:o.id,title:o.title}}},result:s}}else return n.action.kind==="followUp"?{action:{kind:"followUp",followup:Xd.to(n.action.followup)},result:s}:n.action.kind==="inlineChat"?{action:{kind:"editor",accepted:n.action.action==="accepted"},result:s}:{action:n.action,result:s}}i.to=e})(Dw||(Dw={}));var tm;(function(i){function e(t,n,r){return"terminalCommand"in t?{terminalCommand:t.terminalCommand,shouldExecute:t.shouldExecute}:"uri"in t?{uri:t.uri}:n.toInternal(t,r)}i.from=e})(tm||(tm={}));var kw;(function(i){function e(t){return{kind:Cw.to(t.kind)}}i.to=e})(kw||(kw={}));var Cw;(function(i){function e(t){switch(t){case Vu.Word:return Jo.Word;case Vu.Line:return Jo.Line;case Vu.Suggest:return Jo.Suggest;default:return Jo.Unknown}}i.to=e})(Cw||(Cw={}));var Iw;(function(i){function e(t,n){return{id:n,label:t.label,description:t.description,canEdit:t.canEdit,collapsibleState:t.collapsibleState||V_.None,contextValue:t.contextValue}}i.from=e})(Iw||(Iw={}));var Pw;(function(i){function e(t){return{name:t.name,description:t.description,parametersSchema:t.parametersSchema}}i.to=e})(Pw||(Pw={}));var Tw;(function(i){i[i.Information=1]="Information",i[i.Warning=2]="Warning"})(Tw||(Tw={}));class b4{constructor(e,t,n){this.uri=e,this.ranges=t,this.previewText=n}}class y4{constructor(e,t,n){this.uri=e,this.text=t,this.lineNumber=n}}var es;(function(i){i[i.none=1]="none",i[i.filesExclude=2]="filesExclude",i[i.searchAndFilesExclude=3]="searchAndFilesExclude"})(es||(es={}));var Aw;(function(i){i[i.Information=1]="Information",i[i.Warning=2]="Warning"})(Aw||(Aw={}));function J8(i){return"uri"in i&&"ranges"in i&&"preview"in i}function X8(i){if(J8(i)){const e=fo(i.ranges).map(t=>({sourceRange:t,previewRange:t}));return new b4(i.uri,e,i.preview.text)}else return new y4(i.uri,i.text,i.lineNumber)}const Y8=2e4,x4=" ",E4=" characters skipped ",K8=(x4.length+E4.length+5)*2;var S4;(function(i){i[i.file=0]="file",i[i.text=1]="text",i[i.aiText=2]="aiText"})(S4||(S4={}));var fc;(function(i){i[i.File=1]="File",i[i.Text=2]="Text",i[i.aiText=3]="aiText"})(fc||(fc={}));function Z8(i){return!!i.preview}var D4;(function(i){i[i.Normal=0]="Normal",i[i.NewSearchStarted=1]="NewSearchStarted"})(D4||(D4={}));class eA{constructor(e,t,n,r){this.ranges=t,this.webviewIndex=r;const s=Array.isArray(t)?t:[t];if(n&&n.matchLines===1&&tA(s)){e=ZC(e,n.matchLines);let o="",a=0,l=0;const c=Math.floor(n.charsPerLine/5),u=[];for(const d of s){const f=Math.max(d.startColumn-c,0),p=d.startColumn+n.charsPerLine;if(f>l+c+K8){const b=x4+(f-l)+E4;o+=b+e.slice(f,p),a+=f-(l+b.length)}else o+=e.slice(l,p);u.push(new iA(0,d.startColumn-a,d.endColumn-a)),l=p}this.preview={text:o,matches:Array.isArray(this.ranges)?u:u[0]}}else{const o=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber;this.preview={text:e,matches:du(t,a=>new k4(a.startLineNumber-o,a.startColumn,a.endLineNumber-o,a.endColumn))}}}}function tA(i){const e=i[0].startLineNumber;for(const t of i)if(t.startLineNumber!==e||t.endLineNumber!==e)return!1;return!0}class k4{constructor(e,t,n,r){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=r}}class iA extends k4{constructor(e,t,n){super(e,t,e,n)}}var C4;(function(i){i.List="list",i.Tree="tree"})(C4||(C4={}));var I4;(function(i){i.Default="default",i.FileNames="fileNames",i.Type="type",i.Modified="modified",i.CountDescending="countDescending",i.CountAscending="countAscending"})(I4||(I4={}));function nA(i,e=!0){const t=i&&i.files&&i.files.exclude,n=e&&i&&i.search&&i.search.exclude;if(!t&&!n)return;if(!t||!n)return t||n||void 0;let r=Object.create(null);return r=ko(r,Et(t)),r=ko(r,Et(n),!0),r}function P4(i,e){return i.excludePattern&&od(i.excludePattern,e)?!1:i.includePattern||i.usingSearchPaths?i.includePattern&&od(i.includePattern,e)?!0:i.usingSearchPaths?!!i.folderQueries&&i.folderQueries.some(t=>{const n=t.folder.fsPath;if(Sf(e,n)){const r=bu(n,e);return!t.includePattern||!!od(t.includePattern,r)}else return!1}):!1:!0}var T4;(function(i){i[i.unknownEncoding=1]="unknownEncoding",i[i.regexParseError=2]="regexParseError",i[i.globParseError=3]="globParseError",i[i.invalidLiteral=4]="invalidLiteral",i[i.rgProcessError=5]="rgProcessError",i[i.other=6]="other",i[i.canceled=7]="canceled"})(T4||(T4={}));function im(i,e){const t={...i||{},...e||{}};return Object.keys(t).filter(n=>{const r=t[n];return typeof r=="boolean"&&r})}class A4{constructor(e,t){this._parsedIncludeExpression=null,this._excludeExpression={...e.excludePattern||{},...t.excludePattern||{}},this._parsedExcludeExpression=Ll(this._excludeExpression);let n=e.includePattern;t.includePattern&&(n?n={...n,...t.includePattern}:n=t.includePattern),n&&(this._parsedIncludeExpression=Ll(n))}matchesExcludesSync(e,t,n){return!!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,n))}includedInQuerySync(e,t,n){return!(this._parsedExcludeExpression&&this._parsedExcludeExpression(e,t,n)||this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,n))}includedInQuery(e,t,n){const r=this._parsedExcludeExpression(e,t,n),s=()=>this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,t,n):!0;return Cs(r)?r.then(o=>o?!1:s()):s()}hasSiblingExcludeClauses(){return rA(this._excludeExpression)}}function rA(i){for(const e in i)if(typeof i[e]!="boolean")return!0;return!1}function sA(i){if(!i)return;let e;return t=>(e||(e=(i()||Promise.resolve([])).then(n=>n?R4(n):{})),e.then(n=>!!n[t]))}function oA(i){if(!i)return;let e;return t=>{if(!e){const n=i();e=n?R4(n):{}}return!!e[t]}}function R4(i){const e={};for(const t of i)e[t]=!0;return e}function nh(i,e,t){return new Su(n=>Rw(n,t)).isEqual(i,e)}function aA(i,e,t){return nh(i.uri,e.uri,t)?0:bo(i.uri.toString(),e.uri.toString())}function lA(i,e,t){return i.index!==e.index?i.index<e.index?-1:1:nh(i.uri,e.uri,t)?bo(i.name,e.name):bo(i.uri.toString(),e.uri.toString())}function L4(i,e,t,n){const r=i.slice(0).sort((o,a)=>t(o,a,n)),s=e.slice(0).sort((o,a)=>t(o,a,n));return k5(r,s,(o,a)=>t(o,a,n))}function Rw(i,e){const t=e.getCapabilities(i.scheme);return!(t&&t&or.PathCaseSensitive)}class pc extends t7{static toExtHostWorkspace(e,t,n,r){if(!e)return{workspace:null,added:[],removed:[]};const{id:s,name:o,folders:a,configuration:l,transient:c,isUntitled:u}=e,d=[],f=t;t?a.forEach((v,S)=>{const k=y.revive(v.uri),C=pc._findFolder(n||t,k,r);C?(C.name=v.name,C.index=v.index,d.push(C)):d.push({uri:k,name:v.name,index:S})}):d.push(...a.map(({uri:v,name:S,index:k})=>({uri:y.revive(v),name:S,index:k}))),d.sort((v,S)=>v.index<S.index?-1:1);const p=new pc(s,o,d,!!c,l?y.revive(l):null,!!u,v=>Rw(v,r)),{added:b,removed:w}=L4(f?f.workspaceFolders:[],p.workspaceFolders,aA,r);return{workspace:p,added:b,removed:w}}static _findFolder(e,t,n){for(let r=0;r<e.folders.length;r++){const s=e.workspaceFolders[r];if(nh(s.uri,t,n))return s}}constructor(e,t,n,r,s,o,a){super(e,n.map(l=>new a2(l)),r,s,a),this._name=t,this._isUntitled=o,this._workspaceFolders=[],this._structure=Fr.forUris(a,()=>!0),n.forEach(l=>{this._workspaceFolders.push(l),this._structure.set(l.uri,l)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=i_(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let Lw=class{constructor(e,t,n,r,s){this._onDidChangeWorkspace=new L,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new L,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new fu,this._canonicalUriProviders=new Map,this._logService=r,this._extHostFileSystemInfo=n,this._uriTransformerService=s,this._requestIdProvider=new KI,this._barrier=new rr,this._proxy=e.getProxy(Z.MainThreadWorkspace),this._messageService=e.getProxy(Z.MainThreadMessageService);const o=t.workspace;this._confirmedWorkspace=o?new pc(o.id,o.name,[],!!o.transient,o.configuration?y.revive(o.configuration):null,!!o.isUntitled,a=>Rw(a,n)):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?y.from({scheme:le.untitled,path:xo(i_(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,n,...r){const s=[];if(Array.isArray(r)&&r.forEach(u=>{y.isUri(u.uri)&&!s.some(d=>nh(d.uri,u.uri,this._extHostFileSystemInfo))&&s.push({uri:u.uri,name:u.name||t_(u.uri)})}),this._unconfirmedWorkspace||[t,n].some(u=>typeof u!="number"||u<0)||n===0&&s.length===0)return!1;const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+n>o.length)return!1;const a=o.slice(0);a.splice(t,n,...s.map(u=>({uri:u.uri,name:u.name||t_(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((f,p)=>p!==u&&nh(d.uri,f.uri,this._extHostFileSystemInfo)))return!1}a.forEach((u,d)=>u.index=d);const{added:l,removed:c}=L4(o,a,lA,this._extHostFileSystemInfo);if(l.length===0&&c.length===0)return!1;if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,t,n,s).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const f={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(Vt.Error,h(572,"Extension '{0}' failed to update workspace folders: {1}",u,d.toString()),f,[])})}return this.trySetWorkspaceFolders(a),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;const{folders:e}=this._actualWorkspace;if(e.length!==0)return e[0].uri.fsPath}getRelativePath(e,t){let n,r="";if(typeof e=="string"?(n=y.file(e),r=e):typeof e<"u"&&(n=e,r=e.fsPath),!n)return r;const s=this.getWorkspaceFolder(n,!0);if(!s)return r;typeof t>"u"&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let o=Ox(s.uri,n);return t&&s.name&&(o=`${s.name}/${o}`),o}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=pc.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){const{workspace:t,added:n,removed:r}=pc.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:n,removed:r}))}findFiles(e,t,n,r,s=Nt.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${r.value}, entryPoint: findFiles`);let o="",a=!0;return t===null?a=!1:t!==void 0&&(typeof t=="string"?o=t:o=t.pattern),this._findFilesImpl(e,void 0,{exclude:o,maxResults:n,useDefaultExcludes:a,useDefaultSearchExcludes:!1,useIgnoreFiles:!1},s)}findFiles2(e,t={},n,r=Nt.None){return this._logService.trace(`extHostWorkspace#findFiles2: fileSearch, extension: ${n.value}, entryPoint: findFiles2`),this._findFilesImpl(void 0,e,t,r)}async _findFilesImpl(e,t,n,r=Nt.None){if(r&&r.isCancellationRequested)return Promise.resolve([]);const s=typeof n.exclude=="string"?n.exclude:n.exclude?n.exclude.pattern:void 0,o={ignoreSymlinks:typeof n.followSymlinks=="boolean"?!n.followSymlinks:void 0,disregardIgnoreFiles:typeof n.useIgnoreFiles=="boolean"?!n.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof n.useGlobalIgnoreFiles=="boolean"?!n.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof n.useParentIgnoreFiles=="boolean"?!n.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof n.useDefaultExcludes=="boolean"?!n.useDefaultExcludes:!1,disregardSearchExcludeSettings:typeof n.useDefaultSearchExcludes=="boolean"?!n.useDefaultSearchExcludes:!1,maxResults:n.maxResults,excludePattern:s,shouldGlobSearch:typeof n.fuzzy=="boolean"?!n.fuzzy:!0,_reason:"startFileSearch"};let a;if(e){const{includePattern:l,folder:c}=Nw(nn.from(e));a=c,o.includePattern=l}else{const{includePattern:l,folder:c}=Nw(nn.from(t));a=c,o.filePattern=l}return this._proxy.$startFileSearch(a??null,o,r).then(l=>Array.isArray(l)?l.map(c=>y.revive(c)):[])}async findTextInFiles(e,t,n,r,s=Nt.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${r.value}, entryPoint: findTextInFiles`);const o=this._requestIdProvider.getNext(),a=typeof t.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:t.previewOptions,{includePattern:l,folder:c}=Nw(nn.from(t.include)),u=typeof t.exclude=="string"?t.exclude:t.exclude?t.exclude.pattern:void 0,d={ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles=="boolean"?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useGlobalIgnoreFiles=="boolean"?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof t.useParentIgnoreFiles=="boolean"?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof t.useDefaultExcludes=="boolean"?!t.useDefaultExcludes:!0,disregardSearchExcludeSettings:typeof t.useSearchExclude=="boolean"?!t.useSearchExclude:!0,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:a,afterContext:t.afterContext,beforeContext:t.beforeContext,includePattern:l,excludePattern:u};if(this._activeSearchCallbacks[o]=f=>{const p=y.revive(f.resource);f.results.forEach(b=>{const w=Ki(b);Z8(w)?n({uri:p,preview:{text:w.preview.text,matches:du(w.preview.matches,v=>new Fe(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn))},ranges:du(w.ranges,v=>new Fe(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn))}):n({uri:p,text:w.text,lineNumber:w.lineNumber})})},s.isCancellationRequested)return{};try{const f=await this._proxy.$startTextSearch(e,c??null,d,o,s);return delete this._activeSearchCallbacks[o],f||{}}catch(f){throw delete this._activeSearchCallbacks[o],f}}$handleTextSearchResult(e,t){var n,r;(r=(n=this._activeSearchCallbacks)[t])==null||r.call(n,e)}async save(e){const t=await this._proxy.$save(e,{saveAs:!1});return y.revive(t)}async saveAs(e){const t=await this._proxy.$save(e,{saveAs:!0});return y.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}lookupAuthorization(e){return this._proxy.$lookupAuthorization(e)}lookupKerberosAuthorization(e){return this._proxy.$lookupKerberosAuthorization(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);const n=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(r,n),Me(()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(r)})}async $getEditSessionIdentifier(e,t){this._logService.info("Getting edit session identifier for workspaceFolder",e);const n=await this.resolveWorkspaceFolder(y.revive(e));if(!n){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",n);const r=this._editSessionIdentityProviders.get(n.uri.scheme);if(this._logService.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!r),!r)return;const s=await r.provideEditSessionIdentity(n,t);if(this._logService.info("Provider returned edit session identifier: ",s),!!s)return s}async $provideEditSessionIdentityMatch(e,t,n,r){var l;this._logService.info("Getting edit session identifier for workspaceFolder",e);const s=await this.resolveWorkspaceFolder(y.revive(e));if(!s){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const o=this._editSessionIdentityProviders.get(s.uri.scheme);if(this._logService.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!o),!o)return;const a=await((l=o.provideEditSessionIdentityMatch)==null?void 0:l.call(o,t,n,r));if(this._logService.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(e){return(t,n,r)=>{const s=function(a){t.call(n,a)};return s.extension=e,this._onWillCreateEditSessionIdentityEvent.event(s,void 0,r)}}async $onWillCreateEditSessionIdentity(e,t,n){const r=await this.resolveWorkspaceFolder(y.revive(e));if(r===void 0)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:r},t,async(s,o)=>{const a=Date.now();await Promise.resolve(s),Date.now()-a>n&&this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);const n=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(r,n),Me(()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(r)})}async provideCanonicalUri(e,t,n){var o;const r=this._canonicalUriProviders.get(e.scheme);if(!r)return;const s=await((o=r.provideCanonicalUri)==null?void 0:o.call(r,y.revive(e),t,n));if(s)return s}async $provideCanonicalUri(e,t,n){return this.provideCanonicalUri(y.revive(e),{targetScheme:t},n)}};Lw=B([O(0,it),O(1,Ei),O(2,pl),O(3,rt),O(4,If)],Lw);const ts=ke("IExtHostWorkspace");function Nw(i){let e,t;return i&&(typeof i=="string"?e=i:(e=i.pattern,t=y.revive(i.baseUri))),{includePattern:e,folder:t}}var ri;(function(i){i[i.None=0]="None",i[i.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",i[i.UnexpectedEndOfString=2]="UnexpectedEndOfString",i[i.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",i[i.InvalidUnicode=4]="InvalidUnicode",i[i.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",i[i.InvalidCharacter=6]="InvalidCharacter"})(ri||(ri={}));var pe;(function(i){i[i.OpenBraceToken=1]="OpenBraceToken",i[i.CloseBraceToken=2]="CloseBraceToken",i[i.OpenBracketToken=3]="OpenBracketToken",i[i.CloseBracketToken=4]="CloseBracketToken",i[i.CommaToken=5]="CommaToken",i[i.ColonToken=6]="ColonToken",i[i.NullKeyword=7]="NullKeyword",i[i.TrueKeyword=8]="TrueKeyword",i[i.FalseKeyword=9]="FalseKeyword",i[i.StringLiteral=10]="StringLiteral",i[i.NumericLiteral=11]="NumericLiteral",i[i.LineCommentTrivia=12]="LineCommentTrivia",i[i.BlockCommentTrivia=13]="BlockCommentTrivia",i[i.LineBreakTrivia=14]="LineBreakTrivia",i[i.Trivia=15]="Trivia",i[i.Unknown=16]="Unknown",i[i.EOF=17]="EOF"})(pe||(pe={}));var It;(function(i){i[i.InvalidSymbol=1]="InvalidSymbol",i[i.InvalidNumberFormat=2]="InvalidNumberFormat",i[i.PropertyNameExpected=3]="PropertyNameExpected",i[i.ValueExpected=4]="ValueExpected",i[i.ColonExpected=5]="ColonExpected",i[i.CommaExpected=6]="CommaExpected",i[i.CloseBraceExpected=7]="CloseBraceExpected",i[i.CloseBracketExpected=8]="CloseBracketExpected",i[i.EndOfFileExpected=9]="EndOfFileExpected",i[i.InvalidCommentToken=10]="InvalidCommentToken",i[i.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",i[i.UnexpectedEndOfString=12]="UnexpectedEndOfString",i[i.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",i[i.InvalidUnicode=14]="InvalidUnicode",i[i.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",i[i.InvalidCharacter=16]="InvalidCharacter"})(It||(It={}));var Ow;(function(i){i.DEFAULT={allowTrailingComma:!0}})(Ow||(Ow={}));function cA(i,e=!1){let t=0;const n=i.length;let r="",s=0,o=pe.Unknown,a=ri.None;function l(w){let v=0,S=0;for(;v<w;){const k=i.charCodeAt(t);if(k>=ne._0&&k<=ne._9)S=S*16+k-ne._0;else if(k>=ne.A&&k<=ne.F)S=S*16+k-ne.A+10;else if(k>=ne.a&&k<=ne.f)S=S*16+k-ne.a+10;else break;t++,v++}return v<w&&(S=-1),S}function c(w){t=w,r="",s=0,o=pe.Unknown,a=ri.None}function u(){const w=t;if(i.charCodeAt(t)===ne._0)t++;else for(t++;t<i.length&&gc(i.charCodeAt(t));)t++;if(t<i.length&&i.charCodeAt(t)===ne.dot)if(t++,t<i.length&&gc(i.charCodeAt(t)))for(t++;t<i.length&&gc(i.charCodeAt(t));)t++;else return a=ri.UnexpectedEndOfNumber,i.substring(w,t);let v=t;if(t<i.length&&(i.charCodeAt(t)===ne.E||i.charCodeAt(t)===ne.e))if(t++,(t<i.length&&i.charCodeAt(t)===ne.plus||i.charCodeAt(t)===ne.minus)&&t++,t<i.length&&gc(i.charCodeAt(t))){for(t++;t<i.length&&gc(i.charCodeAt(t));)t++;v=t}else a=ri.UnexpectedEndOfNumber;return i.substring(w,v)}function d(){let w="",v=t;for(;;){if(t>=n){w+=i.substring(v,t),a=ri.UnexpectedEndOfString;break}const S=i.charCodeAt(t);if(S===ne.doubleQuote){w+=i.substring(v,t),t++;break}if(S===ne.backslash){if(w+=i.substring(v,t),t++,t>=n){a=ri.UnexpectedEndOfString;break}switch(i.charCodeAt(t++)){case ne.doubleQuote:w+='"';break;case ne.backslash:w+="\\";break;case ne.slash:w+="/";break;case ne.b:w+="\b";break;case ne.f:w+="\f";break;case ne.n:w+=`
`;break;case ne.r:w+="\r";break;case ne.t:w+="	";break;case ne.u:{const C=l(4);C>=0?w+=String.fromCharCode(C):a=ri.InvalidUnicode;break}default:a=ri.InvalidEscapeCharacter}v=t;continue}if(S>=0&&S<=31)if(nm(S)){w+=i.substring(v,t),a=ri.UnexpectedEndOfString;break}else a=ri.InvalidCharacter;t++}return w}function f(){if(r="",a=ri.None,s=t,t>=n)return s=n,o=pe.EOF;let w=i.charCodeAt(t);if(Fw(w)){do t++,r+=String.fromCharCode(w),w=i.charCodeAt(t);while(Fw(w));return o=pe.Trivia}if(nm(w))return t++,r+=String.fromCharCode(w),w===ne.carriageReturn&&i.charCodeAt(t)===ne.lineFeed&&(t++,r+=`
`),o=pe.LineBreakTrivia;switch(w){case ne.openBrace:return t++,o=pe.OpenBraceToken;case ne.closeBrace:return t++,o=pe.CloseBraceToken;case ne.openBracket:return t++,o=pe.OpenBracketToken;case ne.closeBracket:return t++,o=pe.CloseBracketToken;case ne.colon:return t++,o=pe.ColonToken;case ne.comma:return t++,o=pe.CommaToken;case ne.doubleQuote:return t++,r=d(),o=pe.StringLiteral;case ne.slash:{const v=t-1;if(i.charCodeAt(t+1)===ne.slash){for(t+=2;t<n&&!nm(i.charCodeAt(t));)t++;return r=i.substring(v,t),o=pe.LineCommentTrivia}if(i.charCodeAt(t+1)===ne.asterisk){t+=2;const S=n-1;let k=!1;for(;t<S;){if(i.charCodeAt(t)===ne.asterisk&&i.charCodeAt(t+1)===ne.slash){t+=2,k=!0;break}t++}return k||(t++,a=ri.UnexpectedEndOfComment),r=i.substring(v,t),o=pe.BlockCommentTrivia}return r+=String.fromCharCode(w),t++,o=pe.Unknown}case ne.minus:if(r+=String.fromCharCode(w),t++,t===n||!gc(i.charCodeAt(t)))return o=pe.Unknown;case ne._0:case ne._1:case ne._2:case ne._3:case ne._4:case ne._5:case ne._6:case ne._7:case ne._8:case ne._9:return r+=u(),o=pe.NumericLiteral;default:for(;t<n&&p(w);)t++,w=i.charCodeAt(t);if(s!==t){switch(r=i.substring(s,t),r){case"true":return o=pe.TrueKeyword;case"false":return o=pe.FalseKeyword;case"null":return o=pe.NullKeyword}return o=pe.Unknown}return r+=String.fromCharCode(w),t++,o=pe.Unknown}}function p(w){if(Fw(w)||nm(w))return!1;switch(w){case ne.closeBrace:case ne.closeBracket:case ne.openBrace:case ne.openBracket:case ne.doubleQuote:case ne.colon:case ne.comma:case ne.slash:return!1}return!0}function b(){let w;do w=f();while(w>=pe.LineCommentTrivia&&w<=pe.Trivia);return w}return{setPosition:c,getPosition:()=>t,scan:e?b:f,getToken:()=>o,getTokenValue:()=>r,getTokenOffset:()=>s,getTokenLength:()=>t-s,getTokenError:()=>a}}function Fw(i){return i===ne.space||i===ne.tab||i===ne.verticalTab||i===ne.formFeed||i===ne.nonBreakingSpace||i===ne.ogham||i>=ne.enQuad&&i<=ne.zeroWidthSpace||i===ne.narrowNoBreakSpace||i===ne.mathematicalSpace||i===ne.ideographicSpace||i===ne.byteOrderMark}function nm(i){return i===ne.lineFeed||i===ne.carriageReturn||i===ne.lineSeparator||i===ne.paragraphSeparator}function gc(i){return i>=ne._0&&i<=ne._9}var ne;(function(i){i[i.nullCharacter=0]="nullCharacter",i[i.maxAsciiCharacter=127]="maxAsciiCharacter",i[i.lineFeed=10]="lineFeed",i[i.carriageReturn=13]="carriageReturn",i[i.lineSeparator=8232]="lineSeparator",i[i.paragraphSeparator=8233]="paragraphSeparator",i[i.nextLine=133]="nextLine",i[i.space=32]="space",i[i.nonBreakingSpace=160]="nonBreakingSpace",i[i.enQuad=8192]="enQuad",i[i.emQuad=8193]="emQuad",i[i.enSpace=8194]="enSpace",i[i.emSpace=8195]="emSpace",i[i.threePerEmSpace=8196]="threePerEmSpace",i[i.fourPerEmSpace=8197]="fourPerEmSpace",i[i.sixPerEmSpace=8198]="sixPerEmSpace",i[i.figureSpace=8199]="figureSpace",i[i.punctuationSpace=8200]="punctuationSpace",i[i.thinSpace=8201]="thinSpace",i[i.hairSpace=8202]="hairSpace",i[i.zeroWidthSpace=8203]="zeroWidthSpace",i[i.narrowNoBreakSpace=8239]="narrowNoBreakSpace",i[i.ideographicSpace=12288]="ideographicSpace",i[i.mathematicalSpace=8287]="mathematicalSpace",i[i.ogham=5760]="ogham",i[i._=95]="_",i[i.$=36]="$",i[i._0=48]="_0",i[i._1=49]="_1",i[i._2=50]="_2",i[i._3=51]="_3",i[i._4=52]="_4",i[i._5=53]="_5",i[i._6=54]="_6",i[i._7=55]="_7",i[i._8=56]="_8",i[i._9=57]="_9",i[i.a=97]="a",i[i.b=98]="b",i[i.c=99]="c",i[i.d=100]="d",i[i.e=101]="e",i[i.f=102]="f",i[i.g=103]="g",i[i.h=104]="h",i[i.i=105]="i",i[i.j=106]="j",i[i.k=107]="k",i[i.l=108]="l",i[i.m=109]="m",i[i.n=110]="n",i[i.o=111]="o",i[i.p=112]="p",i[i.q=113]="q",i[i.r=114]="r",i[i.s=115]="s",i[i.t=116]="t",i[i.u=117]="u",i[i.v=118]="v",i[i.w=119]="w",i[i.x=120]="x",i[i.y=121]="y",i[i.z=122]="z",i[i.A=65]="A",i[i.B=66]="B",i[i.C=67]="C",i[i.D=68]="D",i[i.E=69]="E",i[i.F=70]="F",i[i.G=71]="G",i[i.H=72]="H",i[i.I=73]="I",i[i.J=74]="J",i[i.K=75]="K",i[i.L=76]="L",i[i.M=77]="M",i[i.N=78]="N",i[i.O=79]="O",i[i.P=80]="P",i[i.Q=81]="Q",i[i.R=82]="R",i[i.S=83]="S",i[i.T=84]="T",i[i.U=85]="U",i[i.V=86]="V",i[i.W=87]="W",i[i.X=88]="X",i[i.Y=89]="Y",i[i.Z=90]="Z",i[i.ampersand=38]="ampersand",i[i.asterisk=42]="asterisk",i[i.at=64]="at",i[i.backslash=92]="backslash",i[i.bar=124]="bar",i[i.caret=94]="caret",i[i.closeBrace=125]="closeBrace",i[i.closeBracket=93]="closeBracket",i[i.closeParen=41]="closeParen",i[i.colon=58]="colon",i[i.comma=44]="comma",i[i.dot=46]="dot",i[i.doubleQuote=34]="doubleQuote",i[i.equals=61]="equals",i[i.exclamation=33]="exclamation",i[i.greaterThan=62]="greaterThan",i[i.lessThan=60]="lessThan",i[i.minus=45]="minus",i[i.openBrace=123]="openBrace",i[i.openBracket=91]="openBracket",i[i.openParen=40]="openParen",i[i.percent=37]="percent",i[i.plus=43]="plus",i[i.question=63]="question",i[i.semicolon=59]="semicolon",i[i.singleQuote=39]="singleQuote",i[i.slash=47]="slash",i[i.tilde=126]="tilde",i[i.backspace=8]="backspace",i[i.formFeed=12]="formFeed",i[i.byteOrderMark=65279]="byteOrderMark",i[i.tab=9]="tab",i[i.verticalTab=11]="verticalTab"})(ne||(ne={}));function uA(i,e,t=Ow.DEFAULT){const n=cA(i,!1);function r(Q){return Q?()=>Q(n.getTokenOffset(),n.getTokenLength()):()=>!0}function s(Q){return Q?Ce=>Q(Ce,n.getTokenOffset(),n.getTokenLength()):()=>!0}const o=r(e.onObjectBegin),a=s(e.onObjectProperty),l=r(e.onObjectEnd),c=r(e.onArrayBegin),u=r(e.onArrayEnd),d=s(e.onLiteralValue),f=s(e.onSeparator),p=r(e.onComment),b=s(e.onError),w=t&&t.disallowComments,v=t&&t.allowTrailingComma;function S(){for(;;){const Q=n.scan();switch(n.getTokenError()){case ri.InvalidUnicode:k(It.InvalidUnicode);break;case ri.InvalidEscapeCharacter:k(It.InvalidEscapeCharacter);break;case ri.UnexpectedEndOfNumber:k(It.UnexpectedEndOfNumber);break;case ri.UnexpectedEndOfComment:w||k(It.UnexpectedEndOfComment);break;case ri.UnexpectedEndOfString:k(It.UnexpectedEndOfString);break;case ri.InvalidCharacter:k(It.InvalidCharacter);break}switch(Q){case pe.LineCommentTrivia:case pe.BlockCommentTrivia:w?k(It.InvalidCommentToken):p();break;case pe.Unknown:k(It.InvalidSymbol);break;case pe.Trivia:case pe.LineBreakTrivia:break;default:return Q}}}function k(Q,Ce=[],Se=[]){if(b(Q),Ce.length+Se.length>0){let J=n.getToken();for(;J!==pe.EOF;){if(Ce.indexOf(J)!==-1){S();break}else if(Se.indexOf(J)!==-1)break;J=S()}}}function C(Q){const Ce=n.getTokenValue();return Q?d(Ce):a(Ce),S(),!0}function N(){switch(n.getToken()){case pe.NumericLiteral:{let Q=0;try{Q=JSON.parse(n.getTokenValue()),typeof Q!="number"&&(k(It.InvalidNumberFormat),Q=0)}catch{k(It.InvalidNumberFormat)}d(Q);break}case pe.NullKeyword:d(null);break;case pe.TrueKeyword:d(!0);break;case pe.FalseKeyword:d(!1);break;default:return!1}return S(),!0}function A(){return n.getToken()!==pe.StringLiteral?(k(It.PropertyNameExpected,[],[pe.CloseBraceToken,pe.CommaToken]),!1):(C(!1),n.getToken()===pe.ColonToken?(f(":"),S(),be()||k(It.ValueExpected,[],[pe.CloseBraceToken,pe.CommaToken])):k(It.ColonExpected,[],[pe.CloseBraceToken,pe.CommaToken]),!0)}function V(){o(),S();let Q=!1;for(;n.getToken()!==pe.CloseBraceToken&&n.getToken()!==pe.EOF;){if(n.getToken()===pe.CommaToken){if(Q||k(It.ValueExpected,[],[]),f(","),S(),n.getToken()===pe.CloseBraceToken&&v)break}else Q&&k(It.CommaExpected,[],[]);A()||k(It.ValueExpected,[],[pe.CloseBraceToken,pe.CommaToken]),Q=!0}return l(),n.getToken()!==pe.CloseBraceToken?k(It.CloseBraceExpected,[pe.CloseBraceToken],[]):S(),!0}function ae(){c(),S();let Q=!1;for(;n.getToken()!==pe.CloseBracketToken&&n.getToken()!==pe.EOF;){if(n.getToken()===pe.CommaToken){if(Q||k(It.ValueExpected,[],[]),f(","),S(),n.getToken()===pe.CloseBracketToken&&v)break}else Q&&k(It.CommaExpected,[],[]);be()||k(It.ValueExpected,[],[pe.CloseBracketToken,pe.CommaToken]),Q=!0}return u(),n.getToken()!==pe.CloseBracketToken?k(It.CloseBracketExpected,[pe.CloseBracketToken],[]):S(),!0}function be(){switch(n.getToken()){case pe.OpenBracketToken:return ae();case pe.OpenBraceToken:return V();case pe.StringLiteral:return C(!0);default:return N()}}return S(),n.getToken()===pe.EOF?t.allowEmptyContent?!0:(k(It.ValueExpected,[],[]),!1):be()?(n.getToken()!==pe.EOF&&k(It.EndOfFileExpected,[],[]),!0):(k(It.ValueExpected,[],[]),!1)}function rh(i){return Object.isFrozen(i)?i:Yx(i)}class mn{static createEmptyModel(e){return new mn({},[],[],void 0,e)}constructor(e,t,n,r,s){this._contents=e,this._keys=t,this._overrides=n,this.raw=r,this.logService=s,this.overrideConfigurations=new Map}get rawConfiguration(){var e;if(!this._rawConfiguration)if((e=this.raw)!=null&&e.length){const t=this.raw.map(n=>{if(n instanceof mn)return n;const r=new dA("",this.logService);return r.parseRaw(n),r.configurationModel});this._rawConfiguration=t.reduce((n,r)=>r===n?r:n.merge(r),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?pp(this.contents,e):this.contents}inspect(e,t){const n=this;return{get value(){return rh(n.rawConfiguration.getValue(e))},get override(){return t?rh(n.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return rh(t?n.rawConfiguration.override(t).getValue(e):n.rawConfiguration.getValue(e))},get overrides(){const r=[];for(const{contents:s,identifiers:o,keys:a}of n.rawConfiguration.overrides){const l=new mn(s,a,[],void 0,n.logService).getValue(e);l!==void 0&&r.push({identifiers:o,value:l})}return r.length?rh(r):void 0}}}getOverrideValue(e,t){const n=this.getContentsForOverrideIdentifer(t);return n?e?pp(n,e):n:void 0}getKeysForOverrideIdentifier(e){const t=[];for(const n of this.overrides)n.identifiers.includes(e)&&t.push(...n.keys);return el(t)}getAllOverrideIdentifiers(){const e=[];for(const t of this.overrides)e.push(...t.identifiers);return el(e)}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){var o,a;const t=Et(this.contents),n=Et(this.overrides),r=[...this.keys],s=(o=this.raw)!=null&&o.length?[...this.raw]:[this];for(const l of e)if(s.push(...(a=l.raw)!=null&&a.length?l.raw:[l]),!l.isEmpty()){this.mergeContents(t,l.contents);for(const c of l.overrides){const[u]=n.filter(d=>Tr(d.identifiers,c.identifiers));u?(this.mergeContents(u.contents,c.contents),u.keys.push(...c.keys),u.keys=el(u.keys)):n.push(Et(c))}for(const c of l.keys)r.indexOf(c)===-1&&r.push(c)}return new mn(t,r,n,s.every(l=>l instanceof mn)?void 0:s,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const n={};for(const r of el([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[r];const o=t[r];o&&(typeof s=="object"&&typeof o=="object"?(s=Et(s),this.mergeContents(s,o)):s=o),n[r]=s}return new mn(n,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const n of Object.keys(t)){if(n in e&&Bt(e[n])&&Bt(t[n])){this.mergeContents(e[n],t[n]);continue}e[n]=Et(t[n])}}getContentsForOverrideIdentifer(e){let t=null,n=null;const r=s=>{s&&(n?this.mergeContents(n,s):n=Et(s))};for(const s of this.overrides)s.identifiers.length===1&&s.identifiers[0]===e?t=s.contents:s.identifiers.includes(e)&&r(s.contents);return r(t),n}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),XP(this.contents,e),ur.test(e)&&this.overrides.splice(this.overrides.findIndex(n=>Tr(n.identifiers,ed(e))),1))}updateValue(e,t,n){if(BE(this.contents,e,t,r=>this.logService.error(r)),n=n||this.keys.indexOf(e)===-1,n&&this.keys.push(e),ur.test(e)){const r=ed(e),s={identifiers:r,keys:Object.keys(this.contents[e]),contents:O_(this.contents[e],a=>this.logService.error(a))},o=this.overrides.findIndex(a=>Tr(a.identifiers,r));o!==-1?this.overrides[o]=s:this.overrides.push(s)}}}class dA{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||mn.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,t){if(!Wt(e)){const n=this.doParseContent(e);this.parseRaw(n,t)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,t){this._raw=e;const{contents:n,keys:r,overrides:s,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new mn(n,r,s,a?[e]:void 0,this.logService),this._restrictedConfigurations=o||[]}doParseContent(e){let t={},n=null,r=[];const s=[];function o(l){Array.isArray(r)?r.push(l):n!==null&&(r[n]=l)}const a={onObjectBegin:()=>{const l={};o(l),s.push(r),r=l,n=null},onObjectProperty:l=>{n=l},onObjectEnd:()=>{r=s.pop()},onArrayBegin:()=>{const l=[];o(l),s.push(r),r=l,n=null},onArrayEnd:()=>{r=s.pop()},onLiteralValue:o,onError:(l,c,u)=>{}};if(e)try{uA(e,a),t=r[0]||{}}catch(l){this.logService.error(`Error while parsing settings file ${this._name}: ${l}`),this._parseErrors=[l]}return t}doParseRaw(e,t){const n=hi.as(Tl.Configuration).getConfigurationProperties(),r=this.filter(e,n,!0,t);e=r.raw;const s=O_(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),o=Object.keys(e),a=this.toOverrides(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:s,keys:o,overrides:a,restricted:r.restricted,hasExcludedProperties:r.hasExcludedProperties}}filter(e,t,n,r){var l,c,u;let s=!1;if(!(r!=null&&r.scopes)&&!(r!=null&&r.skipRestricted)&&!((l=r==null?void 0:r.exclude)!=null&&l.length))return{raw:e,restricted:[],hasExcludedProperties:s};const o={},a=[];for(const d in e)if(ur.test(d)&&n){const f=this.filter(e[d],t,!1,r);o[d]=f.raw,s=s||f.hasExcludedProperties,a.push(...f.restricted)}else{const f=t[d],p=f?typeof f.scope<"u"?f.scope:Ot.WINDOW:void 0;f!=null&&f.restricted&&a.push(d),!((c=r.exclude)!=null&&c.includes(d))&&((u=r.include)!=null&&u.includes(d)||(p===void 0||r.scopes===void 0||r.scopes.includes(p))&&!(r.skipRestricted&&(f!=null&&f.restricted)))?o[d]=e[d]:s=!0}return{raw:o,restricted:a,hasExcludedProperties:s}}toOverrides(e,t){const n=[];for(const r of Object.keys(e))if(ur.test(r)){const s={};for(const o in e[r])s[o]=e[r][o];n.push({identifiers:ed(r),keys:Object.keys(s),contents:O_(s,t)})}return n}}class hA{constructor(e,t,n,r,s,o,a,l,c,u,d,f,p){this.key=e,this.overrides=t,this._value=n,this.overrideIdentifiers=r,this.defaultConfiguration=s,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=u,this.workspaceConfiguration=d,this.folderConfigurationModel=f,this.memoryConfigurationModel=p}get value(){return rh(this._value)}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){var e;return(e=this.policyInspectValue)==null?void 0:e.merged}get policy(){var e;return((e=this.policyInspectValue)==null?void 0:e.value)!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){var e;return(e=this.applicationInspectValue)==null?void 0:e.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){var e;return(e=this.workspaceInspectValue)==null?void 0:e.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){var e;return(e=this.workspaceFolderInspectValue)==null?void 0:e.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}}let Mw=class b5{constructor(e,t,n,r,s,o,a,l,c,u){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=n,this._localUserConfiguration=r,this._remoteUserConfiguration=s,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=u,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new $t,this._userConfiguration=null}getValue(e,t,n){return this.getConsolidatedConfigurationModel(e,t,n).getValue(e)}updateValue(e,t,n={}){let r;n.resource?(r=this._memoryConfigurationByResource.get(n.resource),r||(r=mn.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(n.resource,r))):r=this._memoryConfiguration,t===void 0?r.removeValue(e):r.setValue(e,t),n.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,n){const r=this.getConsolidatedConfigurationModel(e,t,n),s=this.getFolderConfigurationModelForResource(t.resource,n),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of r.overrides)for(const c of l.identifiers)r.getOverrideValue(e,c)!==void 0&&a.add(c);return new hA(e,t,r.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,n?this._workspaceConfiguration:void 0,s||void 0,o)}keys(e){const t=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:t?t.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,t){this._folderConfigurations.set(e,t),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,t){const n=[];if(!t){const{added:r,updated:s,removed:o}=Vs(this._defaultConfiguration,e);t=[...r,...s,...o]}for(const r of t)for(const s of ed(r)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(s),a=e.getKeysForOverrideIdentifier(s),l=[...a.filter(c=>o.indexOf(c)===-1),...o.filter(c=>a.indexOf(c)===-1),...o.filter(c=>!$n(this._defaultConfiguration.override(s).getValue(c),e.override(s).getValue(c)))];n.push([s,l])}return this.updateDefaultConfiguration(e),{keys:t,overrides:n}}compareAndUpdatePolicyConfiguration(e){const{added:t,updated:n,removed:r}=Vs(this._policyConfiguration,e),s=[...t,...n,...r];return s.length&&this.updatePolicyConfiguration(e),{keys:s,overrides:[]}}compareAndUpdateApplicationConfiguration(e){const{added:t,updated:n,removed:r,overrides:s}=Vs(this.applicationConfiguration,e),o=[...t,...n,...r];return o.length&&this.updateApplicationConfiguration(e),{keys:o,overrides:s}}compareAndUpdateLocalUserConfiguration(e){const{added:t,updated:n,removed:r,overrides:s}=Vs(this.localUserConfiguration,e),o=[...t,...n,...r];return o.length&&this.updateLocalUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateRemoteUserConfiguration(e){const{added:t,updated:n,removed:r,overrides:s}=Vs(this.remoteUserConfiguration,e),o=[...t,...n,...r];return o.length&&this.updateRemoteUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateWorkspaceConfiguration(e){const{added:t,updated:n,removed:r,overrides:s}=Vs(this.workspaceConfiguration,e),o=[...t,...n,...r];return o.length&&this.updateWorkspaceConfiguration(e),{keys:o,overrides:s}}compareAndUpdateFolderConfiguration(e,t){const n=this.folderConfigurations.get(e),{added:r,updated:s,removed:o,overrides:a}=Vs(n,t),l=[...r,...s,...o];return(l.length||!n)&&this.updateFolderConfiguration(e,t),{keys:l,overrides:a}}compareAndDeleteFolderConfiguration(e){const t=this.folderConfigurations.get(e);if(!t)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:n,updated:r,removed:s,overrides:o}=Vs(t,void 0);return{keys:[...n,...r,...s],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,t,n){let r=this.getConsolidatedConfigurationModelForResource(t,n);return t.overrideIdentifier&&(r=r.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(r=r.merge(this._policyConfiguration)),r}getConsolidatedConfigurationModelForResource({resource:e},t){let n=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const r=t.getFolder(e);r&&(n=this.getFolderConsolidatedConfiguration(r.uri)||n);const s=this._memoryConfigurationByResource.get(e);s&&(n=n.merge(s))}return n}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const n=this.getWorkspaceConsolidatedConfiguration(),r=this._folderConfigurations.get(e);r?(t=n.merge(r),this._foldersConsolidatedConfigurations.set(e,t)):t=n}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const n=t.getFolder(e);if(n)return this._folderConfigurations.get(n.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:n,overrides:r,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:n,overrides:r,keys:s}]),e},[])}}allKeys(){const e=new Set;return this._defaultConfiguration.keys.forEach(t=>e.add(t)),this.userConfiguration.keys.forEach(t=>e.add(t)),this._workspaceConfiguration.keys.forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.keys.forEach(n=>e.add(n))),[...e.values()]}allOverrideIdentifiers(){const e=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this.userConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.getAllOverrideIdentifiers().forEach(n=>e.add(n))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const t=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>t.add(n)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>t.add(n)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>t.add(n)),this._folderConfigurations.forEach(n=>n.getKeysForOverrideIdentifier(e).forEach(r=>t.add(r))),[...t.values()]}static parse(e,t){const n=this.parseConfigurationModel(e.defaults,t),r=this.parseConfigurationModel(e.policy,t),s=this.parseConfigurationModel(e.application,t),o=this.parseConfigurationModel(e.user,t),a=this.parseConfigurationModel(e.workspace,t),l=e.folders.reduce((c,u)=>(c.set(y.revive(u[0]),this.parseConfigurationModel(u[1],t)),c),new $t);return new b5(n,r,s,o,mn.createEmptyModel(t),a,l,mn.createEmptyModel(t),new $t,t)}static parseConfigurationModel(e,t){return new mn(e.contents,e.keys,e.overrides,void 0,t)}};class fA{constructor(e,t,n,r,s){this.change=e,this.previous=t,this.currentConfiguraiton=n,this.currentWorkspace=r,this.logService=s,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const a of o)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Mw.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const n=this._marker+e,r=this._affectsConfigStr.indexOf(n);if(r<0)return!1;const s=r+n.length;if(s>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(s);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!$n(l,c)}return!0}}function Vs(i,e){const{added:t,removed:n,updated:r}=N4(e==null?void 0:e.rawConfiguration,i==null?void 0:i.rawConfiguration),s=[],o=(i==null?void 0:i.getAllOverrideIdentifiers())||[],a=(e==null?void 0:e.getAllOverrideIdentifiers())||[];if(e){const l=a.filter(c=>!o.includes(c));for(const c of l)s.push([c,e.getKeysForOverrideIdentifier(c)])}if(i){const l=o.filter(c=>!a.includes(c));for(const c of l)s.push([c,i.getKeysForOverrideIdentifier(c)])}if(e&&i){for(const l of o)if(a.includes(l)){const c=N4({contents:i.getOverrideValue(void 0,l)||{},keys:i.getKeysForOverrideIdentifier(l)},{contents:e.getOverrideValue(void 0,l)||{},keys:e.getKeysForOverrideIdentifier(l)});s.push([l,[...c.added,...c.removed,...c.updated]])}}return{added:t,removed:n,updated:r,overrides:s}}function N4(i,e){const t=i?e?i.keys.filter(s=>e.keys.indexOf(s)===-1):[...i.keys]:[],n=e?i?e.keys.filter(s=>i.keys.indexOf(s)===-1):[...e.keys]:[],r=[];if(i&&e){for(const s of e.keys)if(i.keys.indexOf(s)!==-1){const o=pp(e.contents,s),a=pp(i.contents,s);$n(o,a)||r.push(s)}}return{added:t,removed:n,updated:r}}function sh(i,e){if(e){const t=e.split(".");let n=i;for(let r=0;n&&r<t.length;r++)n=n[t[r]];return n}}function pA(i){return i instanceof y}function gA(i){return i&&i.uri instanceof y&&i.languageId&&typeof i.languageId=="string"}function mA(i){return i&&!i.uri&&i.languageId&&typeof i.languageId=="string"}function _A(i){return i&&i.uri instanceof y&&(!i.name||typeof i.name=="string")&&(!i.index||typeof i.index=="number")}function O4(i){if(pA(i))return{resource:i};if(gA(i))return{resource:i.uri,overrideIdentifier:i.languageId};if(mA(i))return{overrideIdentifier:i.languageId};if(_A(i))return{resource:i.uri};if(i===null)return{resource:null}}let $w=class{constructor(e,t,n){this._proxy=e.getProxy(Z.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=n,this._barrier=new rr,this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new vA(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then(n=>n.$acceptConfigurationChanged(e,t))}};$w=B([O(0,it),O(1,ts),O(2,rt)],$w);class vA{constructor(e,t,n,r){this._onDidChangeConfiguration=new L,this._proxy=e,this._logService=r,this._extHostWorkspace=t,this._configuration=Mw.parse(n,r),this._configurationScopes=this._toMap(n.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const n={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=Mw.parse(e,this._logService),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,n))}getConfiguration(e,t,n){const r=O4(t)||{},s=this._toReadonlyValue(e?sh(this._configuration.getValue(void 0,r,this._extHostWorkspace.workspace),e):this._configuration.getValue(void 0,r,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,r,n==null?void 0:n.identifier);function o(l){if(l==null)return null;if(typeof l=="boolean")return l?ti.USER:ti.WORKSPACE;switch(l){case ql.Global:return ti.USER;case ql.Workspace:return ti.WORKSPACE;case ql.WorkspaceFolder:return ti.WORKSPACE_FOLDER}}const a={has(l){return typeof sh(s,l)<"u"},get:(l,c)=>{this._validateConfigurationAccess(e?`${e}.${l}`:l,r,n==null?void 0:n.identifier);let u=sh(s,l);if(typeof u>"u")u=c;else{let d;const f=(p,b)=>{if(Bt(p)){let w;const v=()=>{d=d||Et(s),w=w||sh(d,b)};return new Proxy(p,{get:(S,k)=>{if(typeof k=="string"&&k.toLowerCase()==="tojson")return v(),()=>w;if(d)return w=w||sh(d,b),w[k];const C=S[k];return typeof k=="string"?f(C,`${b}.${k}`):C},set:(S,k,C)=>(v(),w&&(w[k]=C),!0),deleteProperty:(S,k)=>(v(),w&&delete w[k],!0),defineProperty:(S,k,C)=>(v(),w&&Object.defineProperty(w,k,C),!0)})}return Array.isArray(p)?Et(p):p};u=f(u,l)}return u},update:(l,c,u,d)=>{l=e?`${e}.${l}`:l;const f=o(u);return c!==void 0?this._proxy.$updateConfigurationOption(f,l,c,r,d):this._proxy.$removeConfigurationOption(f,l,r,d)},inspect:l=>{var u,d,f,p,b,w,v,S,k,C,N;l=e?`${e}.${l}`:l;const c=this._configuration.inspect(l,r,this._extHostWorkspace.workspace);if(c)return{key:l,defaultValue:Et(((u=c.policy)==null?void 0:u.value)??((d=c.default)==null?void 0:d.value)),globalValue:Et(((f=c.user)==null?void 0:f.value)??((p=c.application)==null?void 0:p.value)),workspaceValue:Et((b=c.workspace)==null?void 0:b.value),workspaceFolderValue:Et((w=c.workspaceFolder)==null?void 0:w.value),defaultLanguageValue:Et((v=c.default)==null?void 0:v.override),globalLanguageValue:Et(((S=c.user)==null?void 0:S.override)??((k=c.application)==null?void 0:k.override)),workspaceLanguageValue:Et((C=c.workspace)==null?void 0:C.override),workspaceFolderLanguageValue:Et((N=c.workspaceFolder)==null?void 0:N.override),languageIds:Et(c.overrideIdentifiers)}}};return typeof s=="object"&&ko(a,s,!1),Object.freeze(a)}_toReadonlyValue(e){const t=n=>Bt(n)?new Proxy(n,{get:(r,s)=>t(r[s]),set:(r,s,o)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(s)}' of object`)},deleteProperty:(r,s)=>{throw new Error(`TypeError: Cannot delete read only property '${String(s)}' of object`)},defineProperty:(r,s)=>{throw new Error(`TypeError: Cannot define property '${String(s)}' for a readonly object`)},setPrototypeOf:r=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):n;return t(e)}_validateConfigurationAccess(e,t,n){const r=ur.test(e)?Ot.RESOURCE:this._configurationScopes.get(e),s=n?`[${n.value}] `:"";if(Ot.RESOURCE===r){typeof(t==null?void 0:t.resource)>"u"&&this._logService.warn(`${s}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(Ot.WINDOW===r){t!=null&&t.resource&&this._logService.warn(`${s}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){const n=new fA(e,t,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(r,s)=>n.affectsConfiguration(r,O4(s))})}_toMap(e){return e.reduce((t,n)=>(t.set(n[0],n[1]),t),new Map)}}const is=ke("IExtHostConfiguration");class wA{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}}class ca{static isHostExtension(e,t,n){if(t.getExtensionDescription(e))return!1;const r=n.getExtensionDescription(e);return r?!!((r.main||r.browser)&&r.api==="none"):!1}constructor(e,t){this._activationEventsReader=e,this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this._versionId=0,this._extensionDescriptions=t,this._initialize()}_initialize(){this._extensionDescriptions.sort(yA),this._extensionsMap=new Vr,this._extensionsArr=[],this._activationMap=new Map;for(const e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e),this._extensionsArr.push(e);const t=this._activationEventsReader.readActivationEvents(e);for(const n of t)this._activationMap.has(n)||this._activationMap.set(n,[]),this._activationMap.get(n).push(e)}}set(e){return this._extensionDescriptions=e,this._initialize(),this._versionId++,this._onDidChange.fire(void 0),{versionId:this._versionId}}deltaExtensions(e,t){this._extensionDescriptions=F4(this._extensionDescriptions,t),this._extensionDescriptions=this._extensionDescriptions.concat(e);const n=ca._findLoopingExtensions(this._extensionDescriptions);return this._extensionDescriptions=F4(this._extensionDescriptions,n.map(r=>r.identifier)),this._initialize(),this._versionId++,this._onDidChange.fire(void 0),new wA(this._versionId,n)}static _findLoopingExtensions(e){const t=new class{constructor(){this._arcs=new Map,this._nodesSet=new Set,this._nodesArr=[]}addNode(a){this._nodesSet.has(a)||(this._nodesSet.add(a),this._nodesArr.push(a))}addArc(a,l){this.addNode(a),this.addNode(l),this._arcs.has(a)?this._arcs.get(a).push(l):this._arcs.set(a,[l])}getArcs(a){return this._arcs.has(a)?this._arcs.get(a):[]}hasOnlyGoodArcs(a,l){const c=t.getArcs(a);for(let u=0;u<c.length;u++)if(!l.has(c[u]))return!1;return!0}getNodes(){return this._nodesArr}},n=new Vr;for(const a of e)if(n.set(a.identifier,a),a.extensionDependencies)for(const l of a.extensionDependencies)t.addArc(ot.toKey(a.identifier),ot.toKey(l));const r=new Set;t.getNodes().filter(a=>t.getArcs(a).length===0).forEach(a=>r.add(a));const s=t.getNodes().filter(a=>!r.has(a));let o;do{o=!1;for(let a=0;a<s.length;a++){const l=s[a];t.hasOnlyGoodArcs(l,r)&&(s.splice(a,1),a--,r.add(l),o=!0)}}while(o);return s.map(a=>n.get(a))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){const t=this._activationMap.get(e);return t?t.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new bA(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){const t=this._extensionsMap.get(e);return t||void 0}getExtensionDescriptionByUUID(e){for(const t of this._extensionsArr)if(t.uuid===e)return t}getExtensionDescriptionByIdOrUUID(e,t){return this.getExtensionDescription(e)??(t?this.getExtensionDescriptionByUUID(t):void 0)}}class bA{constructor(e,t){this.versionId=e,this.extensions=t}}var zs;(function(i){i[i.Builtin=0]="Builtin",i[i.User=1]="User",i[i.Dev=2]="Dev"})(zs||(zs={}));function yA(i,e){const t=i.isBuiltin?zs.Builtin:i.isUnderDevelopment?zs.Dev:zs.User,n=e.isBuiltin?zs.Builtin:e.isUnderDevelopment?zs.Dev:zs.User;if(t!==n)return t-n;const r=tt.basename(i.extensionLocation.path),s=tt.basename(e.extensionLocation.path);return r<s?-1:r>s?1:0}function F4(i,e){const t=new Uo(e);return i.filter(n=>!t.has(n.identifier))}const Km=class Km{constructor(e,t,n,r){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=n,this.activateResolvedTime=r}};Km.NONE=new Km(!1,-1,-1,-1);let mc=Km;class M4{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new mc(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class rm{constructor(e,t,n,r,s,o){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=n,this.module=r,this.exports=s,this.disposable=o}}class xA extends rm{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,Re.None)}}class EA extends rm{constructor(){super(!1,null,mc.NONE,{activate:void 0,deactivate:void 0},void 0,Re.None)}}class sm extends rm{constructor(e){super(!0,e,mc.NONE,{activate:void 0,deactivate:void 0},void 0,Re.None)}}let Uw=class{constructor(e,t,n,r){this._logService=r,this._registry=e,this._globalRegistry=t,this._host=n,this._operations=new Vr,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){const e=[];for(const[t,n]of this._operations)e.push(n.wait());await Promise.all(e)}isActivated(e){const t=this._operations.get(e);return!!(t&&t.value)}getActivatedExtension(e){const t=this._operations.get(e);if(!t||!t.value)throw new Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;const n=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(n.map(r=>({id:r.identifier,reason:{startup:t,extensionId:r.identifier,activationEvent:e}}))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){const n=this._registry.getExtensionDescription(e);if(!n)throw new Error(`Extension '${e.value}' is not known`);return this._activateExtensions([{id:n.identifier,reason:t}])}async _activateExtensions(e){const t=e.filter(n=>!this.isActivated(n.id)).map(n=>this._handleActivationRequest(n));await Promise.all(t.map(n=>n.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);const t=this._registry.getExtensionDescription(e.id);if(!t){const s=new Error(`Cannot activate unknown extension '${e.id.value}'`),o=this._createAndSaveOperation(e,null,[],new sm(s));return this._host.onExtensionActivationError(e.id,s,new fS(e.id.value)),o}const n=[],r=typeof t.extensionDependencies>"u"?[]:t.extensionDependencies;for(const s of r){if(this._isResolvedExtension(s))continue;const o=this._operations.get(s);if(o){n.push(o);continue}if(this._isHostExtension(s)){n.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(s).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(s);if(a){if(!a.main&&!a.browser)continue;n.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const l=t.displayName||t.identifier.value,c=new Error(`Cannot activate the '${l}' extension because it depends on unknown extension '${s}'`),u=this._createAndSaveOperation(e,t.displayName,[],new sm(c));return this._host.onExtensionActivationError(t.identifier,c,new fS(s)),u}return this._createAndSaveOperation(e,t.displayName,n,null)}_createAndSaveOperation(e,t,n,r){const s=new Hw(e.id,t,e.reason,n,r,this._host,this._logService);return this._operations.set(e.id,s),s}_isHostExtension(e){return ca.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const t=this._globalRegistry.getExtensionDescription(e);return t?!t.main&&!t.browser:!1}};Uw=B([O(3,rt)],Uw);let Hw=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,n,r,s,o,a){this._id=e,this._displayName=t,this._reason=n,this._deps=r,this._value=s,this._host=o,this._logService=a,this._barrier=new rr,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){const t=this._deps[e];if(t.value&&!t.value.activationFailed){this._deps.splice(e,1),e--;continue}if(t.value&&t.value.activationFailed){const n=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);n.detail=t.value.activationFailedError,this._value=new sm(n),this._host.onExtensionActivationError(this._id,n,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(e=>e.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const t=new Error;if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new sm(t),this._isDisposed&&uo(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};Hw=B([O(6,rt)],Hw);class $4{constructor(e,t){this._logService=t,this._onDidChangeStorage=new L,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(Z.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,n){const r=await this._proxy.$initializeExtensionStorage(e,t);let s;return r&&(s=this.safeParseValue(e,t,r)),s||n}setValue(e,t,n){return this._proxy.$setValue(e,t,n)}$acceptValue(e,t,n){const r=this.safeParseValue(e,t,n);r&&this._onDidChangeStorage.fire({shared:e,key:t,value:r})}safeParseValue(e,t,n){try{return JSON.parse(n)}catch(r){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${r}`)}}}const Bw=ke("IExtHostStorage");class U4{constructor(e,t,n){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=n,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(r=>(this._value=r,this)),this._storageListener=this._storage.onDidChangeStorage(r=>{r.shared===this._shared&&r.key===this._id&&(this._value=r.value)}),this._scheduler=new ll(()=>{const r=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const s of r.values())s.complete()}catch(s){for(const o of r.values())o.error(s)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let n=this._value[e];return typeof n>"u"&&(n=t),n}update(e,t){this._value[e]=t;const n=this._deferredPromises.get(e);if(n!==void 0)return n.p;const r=new cl;return this._deferredPromises.set(e,r),this._scheduler.isScheduled()||this._scheduler.schedule(),r.p}dispose(){this._storageListener.dispose()}}class SA extends U4{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}}var _r;let Ww=_r=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new TI,this._proxy=e.getProxy(Z.MainThreadFileSystem);const n=this;this.value=Object.freeze({async stat(r){try{let s;const o=n._fileSystemProvider.get(r.scheme);return o?(await n._proxy.$ensureActivation(r.scheme),s=await o.impl.stat(r)):s=await n._proxy.$stat(r),{type:s.type,ctime:s.ctime,mtime:s.mtime,size:s.size,permissions:s.permissions===fl.Readonly?1:void 0}}catch(s){_r._handleError(s)}},async readDirectory(r){try{const s=n._fileSystemProvider.get(r.scheme);return s?(await n._proxy.$ensureActivation(r.scheme),(await s.impl.readDirectory(r)).slice()):await n._proxy.$readdir(r)}catch(s){return _r._handleError(s)}},async createDirectory(r){try{const s=n._fileSystemProvider.get(r.scheme);return s&&!s.isReadonly?(await n._proxy.$ensureActivation(r.scheme),await n.mkdirp(s.impl,s.extUri,r)):await n._proxy.$mkdir(r)}catch(s){return _r._handleError(s)}},async readFile(r){try{const s=n._fileSystemProvider.get(r.scheme);return s?(await n._proxy.$ensureActivation(r.scheme),(await s.impl.readFile(r)).slice()):(await n._proxy.$readFile(r)).buffer}catch(s){return _r._handleError(s)}},async writeFile(r,s){try{const o=n._fileSystemProvider.get(r.scheme);return o&&!o.isReadonly?(await n._proxy.$ensureActivation(r.scheme),await n.mkdirp(o.impl,o.extUri,o.extUri.dirname(r)),await n._writeQueue.queueFor(r,()=>Promise.resolve(o.impl.writeFile(r,s,{create:!0,overwrite:!0})))):await n._proxy.$writeFile(r,De.wrap(s))}catch(o){return _r._handleError(o)}},async delete(r,s){try{const o=n._fileSystemProvider.get(r.scheme);return o&&!o.isReadonly&&!(s!=null&&s.useTrash)?(await n._proxy.$ensureActivation(r.scheme),await o.impl.delete(r,{recursive:!1,...s})):await n._proxy.$delete(r,{recursive:!1,useTrash:!1,atomic:!1,...s})}catch(o){return _r._handleError(o)}},async rename(r,s,o){try{return await n._proxy.$rename(r,s,{overwrite:!1,...o})}catch(a){return _r._handleError(a)}},async copy(r,s,o){try{return await n._proxy.$copy(r,s,{overwrite:!1,...o})}catch(a){return _r._handleError(a)}},isWritableFileSystem(r){const s=t.getCapabilities(r);if(typeof s=="number")return!(s&or.Readonly)}})}async mkdirp(e,t,n){const r=[];for(;!t.isEqual(n,t.dirname(n));)try{if(!((await e.stat(n)).type&Co.Directory))throw Yt.FileExists(`Unable to create folder '${n.scheme===le.file?n.fsPath:n.toString(!0)}' that already exists but is not a directory`);break}catch(s){if(Lf(s)!==Pe.FileNotFound)throw s;r.push(t.basename(n)),n=t.dirname(n)}for(let s=r.length-1;s>=0;s--){n=t.joinPath(n,r[s]);try{await e.createDirectory(n)}catch(o){if(Lf(o)!==Pe.FileExists)throw o}}}static _handleError(e){if(e instanceof Yt)throw e;if(e instanceof Rf)switch(e.code){case Pe.FileExists:throw Yt.FileExists(e.message);case Pe.FileNotFound:throw Yt.FileNotFound(e.message);case Pe.FileNotADirectory:throw Yt.FileNotADirectory(e.message);case Pe.FileIsADirectory:throw Yt.FileIsADirectory(e.message);case Pe.NoPermissions:throw Yt.NoPermissions(e.message);case Pe.Unavailable:throw Yt.Unavailable(e.message);default:throw new Yt(e.message,e.name)}if(!(e instanceof Error))throw new Yt(String(e));if(e.name==="ENOPRO"||e.message.includes("ENOPRO"))throw Yt.Unavailable(e.message);switch(e.name){case Pe.FileExists:throw Yt.FileExists(e.message);case Pe.FileNotFound:throw Yt.FileNotFound(e.message);case Pe.FileNotADirectory:throw Yt.FileNotADirectory(e.message);case Pe.FileIsADirectory:throw Yt.FileIsADirectory(e.message);case Pe.NoPermissions:throw Yt.NoPermissions(e.message);case Pe.Unavailable:throw Yt.Unavailable(e.message);default:throw new Yt(e.message,e.name)}}addFileSystemProvider(e,t,n){return this._fileSystemProvider.set(e,{impl:t,extUri:n!=null&&n.isCaseSensitive?Ze:gI,isReadonly:!!(n!=null&&n.isReadonly)}),Me(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){var t;return((t=this._fileSystemProvider.get(e))==null?void 0:t.extUri)??Ze}};Ww=_r=B([O(0,it),O(1,pl)],Ww);const om=ke("IExtHostConsumerFileSystem"),Vw=ke("IExtensionStoragePaths");let zw=class{constructor(e,t,n){this._logService=t,this._extHostFileSystem=n,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(r=>this._value=r)}async _getWorkspaceStorageURI(e){return y.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){var n;if(!this._workspace)return Promise.resolve(void 0);const e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace("[ExtHostStorage] storage dir already exists",t),t}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(y.joinPath(t,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:(n=y.revive(this._workspace.configuration))==null?void 0:n.toString(),name:this._workspace.name},void 0,2))),t}catch(r){this._logService.error("[ExtHostStorage]",r);return}}workspaceValue(e){if(this._value)return y.joinPath(this._value,e.identifier.value)}globalValue(e){return y.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};zw=B([O(0,Ei),O(1,rt),O(2,om)],zw);const am=ke("configurationService");var H4;(function(i){i.Http="http",i.Https="https"})(H4||(H4={}));var ua;(function(i){i.ConstantPrivate="constantPrivate",i.Private="private",i.Public="public"})(ua||(ua={}));var B4;(function(i){i[i.Notify=1]="Notify",i[i.OpenBrowser=2]="OpenBrowser",i[i.OpenPreview=3]="OpenPreview",i[i.Silent=4]="Silent",i[i.Ignore=5]="Ignore",i[i.OpenBrowserOnce=6]="OpenBrowserOnce"})(B4||(B4={}));function DA(i){if(i.scheme!=="http"&&i.scheme!=="https")return;const e=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(i.authority);if(e)return{address:e[1],port:+e[2]}}const qw=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function W4(i){return qw.indexOf(i)>=0}const jw=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function V4(i){return jw.indexOf(i)>=0}class kA{constructor(e,t,n){this.remoteAddress=e,this.localAddress=t,this._dispose=n,this._onDispose=new L,this.onDidDispose=this._onDispose.event}dispose(){return this._onDispose.fire(),this._dispose()}}let z4=class extends Re{constructor(e,t){super(),this.logService=e,this.configurationService=t,this._onTunnelOpened=new L,this.onTunnelOpened=this._onTunnelOpened.event,this._onTunnelClosed=new L,this.onTunnelClosed=this._onTunnelClosed.event,this._onAddedTunnelProvider=new L,this.onAddedTunnelProvider=this._onAddedTunnelProvider.event,this._tunnels=new Map,this._canElevate=!1,this._canChangeProtocol=!0,this._privacyOptions=[],this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const e=[],t=Array.from(this._tunnels.values());for(const n of t){const r=Array.from(n.values());for(const s of r){const o=await s.value;o&&typeof o!="string"&&e.push(o)}}return e}async dispose(){super.dispose();for(const e of this._tunnels.values()){for(const{value:t}of e.values())await t.then(n=>typeof n!="string"?n==null?void 0:n.dispose():void 0);e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,t,n,r,s){this.addTunnelToMap(e,t,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:t,localAddress:n,privacy:r,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,t){(V4(e)||W4(e))&&(e=qw[0]);const n=this.getTunnelFromMap(e,t);if(n)return++n.refcount,n.value}openTunnel(e,t,n,r,s,o=!1,a,l){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${t}:${n} on local port ${s}.`);const c=this._tunnelProvider??e;if(!c)return;if(t||(t="localhost"),r||(r=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(n)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.retainOrCreateTunnel(c,t,n,r,s,o,a,l);return u?u.then(d=>{if(d){if(typeof d=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(t,n),d}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(t,n);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.makeTunnel(d);return(d.tunnelRemoteHost!==t||d.tunnelRemotePort!==n)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&d.privacy!==a&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(f),f}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);const t=this._tunnels.get(e.tunnelRemoteHost);if(t){const n=t.get(e.tunnelRemotePort);n&&(n.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,n))}}}}async tryDisposeTunnel(e,t,n){if(n.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${t}.`);const r=n.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(t),r}}async closeTunnel(e,t){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${t} `);const n=this._tunnels.get(e);if(n&&n.has(t)){const r=n.get(t);r.refcount=0,await this.tryDisposeTunnel(e,t,r)}}addTunnelToMap(e,t,n){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(t,{refcount:1,value:n})}async removeEmptyOrErrorTunnelFromMap(e,t){const n=this._tunnels.get(e);if(n){const r=n.get(t),s=r?await r.value:void 0;(!s||typeof s=="string")&&n.delete(t),n.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,t){const n=[e];W4(e)?(n.push(...qw),n.push(...jw)):V4(e)&&n.push(...jw);const r=n.map(s=>this._tunnels.get(s));for(const s of r){const o=s==null?void 0:s.get(t);if(o)return o}}canTunnel(e){return!!DA(e)}createWithProvider(e,t,n,r,s,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${t}:${n} on local port ${r}.`);const l=n;this._factoryInProgress.add(l);const c=r===void 0?n:r,u={elevationRequired:s?this.isPortPrivileged(c):!1},d={remoteAddress:{host:t,port:n},localAddressPort:r,privacy:o,public:o?o!==ua.Private:void 0,protocol:a},f=e.forwardPort(d,u);return f?(this.addTunnelToMap(t,n,f),f.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(l)})):this._factoryInProgress.delete(l),f}};z4=B([O(0,rt),O(1,am)],z4);class CA extends kA{}var Gw;(function(i){function e(n){return{remoteAddress:n.remoteAddress,localAddress:n.localAddress,public:!!n.public,privacy:n.privacy??(n.public?ua.Public:ua.Private),protocol:n.protocol}}i.fromApiTunnel=e;function t(n){return{remoteAddress:{host:n.tunnelRemoteHost,port:n.tunnelRemotePort},localAddress:n.localAddress,public:n.privacy!==ua.ConstantPrivate&&n.privacy!==ua.ConstantPrivate,privacy:n.privacy,protocol:n.protocol}}i.fromServiceTunnel=t})(Gw||(Gw={}));const Qw=ke("IExtHostTunnelService");let Jw=class extends Re{constructor(e,t,n){super(),this.logService=n,this._showCandidatePort=()=>Promise.resolve(!0),this._extensionTunnels=new Map,this._onDidChangeTunnels=new L,this.onDidChangeTunnels=this._onDidChangeTunnels.event,this._providerHandleCounter=0,this._portAttributesProviders=new Map,this._proxy=e.getProxy(Z.MainThreadTunnelService)}async openTunnel(e,t){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${t.remoteAddress.host}:${t.remoteAddress.port}.`);const n=await this._proxy.$openTunnel(t,e.displayName);if(n){const r=new CA(n.remoteAddress,n.localAddress,()=>this._proxy.$closeTunnel(n.remoteAddress));return this._register(r),r}}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,t){e.portRange===void 0&&e.commandPattern===void 0&&this.logService.error("PortAttributesProvider must specify either a portRange or a commandPattern");const n=this.nextPortAttributesProviderHandle();return this._portAttributesProviders.set(n,{selector:e,provider:t}),this._proxy.$registerPortsAttributesProvider(e,n),new Qe(()=>{this._portAttributesProviders.delete(n),this._proxy.$unregisterPortsAttributesProvider(n)})}async $providePortAttributes(e,t,n,r,s){const o=[];for(const l of e){const c=this._portAttributesProviders.get(l);if(!c)return[];o.push(...await Promise.all(t.map(async u=>{let d;try{d=await c.provider.providePortAttributes({port:u,pid:n,commandLine:r},s)}catch{d=await c.provider.providePortAttributes(u,n,r,s)}return{providedAttributes:d,port:u}})))}const a=o.filter(l=>!!l.providedAttributes);return a.length>0?a.map(l=>({autoForwardAction:l.providedAttributes.autoForwardAction,port:l.port})):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,t){var r,s;if(this._forwardPortProvider)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this._forwardPortProvider=async(o,a)=>await e.provideTunnel(o,a,Nt.None)??void 0;const n=t.tunnelFeatures?{elevation:!!((r=t.tunnelFeatures)!=null&&r.elevation),privacyOptions:(s=t.tunnelFeatures)==null?void 0:s.privacyOptions,protocol:t.tunnelFeatures.protocol===void 0?!0:t.tunnelFeatures.protocol}:void 0;return this._proxy.$setTunnelProvider(n),Promise.resolve(Me(()=>{this._forwardPortProvider=void 0,this._proxy.$setTunnelProvider(void 0)}))}async setTunnelFactory(e,t){var n,r,s,o;if(e){e.candidatePortSource!==void 0&&this._proxy.$setCandidatePortSource(e.candidatePortSource),e.showCandidatePort&&(this._showCandidatePort=e.showCandidatePort,this._proxy.$setCandidateFilter());const a=e.tunnelFactory??(t?this.makeManagedTunnelFactory(t):void 0);if(a){this._forwardPortProvider=a;let l=((n=e.tunnelFeatures)==null?void 0:n.privacyOptions)??[];(r=e.tunnelFeatures)!=null&&r.public&&l.length===0&&(l=[{id:"private",label:h(574,"Private"),themeIcon:"lock"},{id:"public",label:h(575,"Public"),themeIcon:"eye"}]);const c=e.tunnelFeatures?{elevation:!!((s=e.tunnelFeatures)!=null&&s.elevation),public:!!((o=e.tunnelFeatures)!=null&&o.public),privacyOptions:l,protocol:!0}:void 0;this._proxy.$setTunnelProvider(c)}}else this._forwardPortProvider=void 0;return Me(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){}async $closeTunnel(e,t){if(this._extensionTunnels.has(e.host)){const n=this._extensionTunnels.get(e.host);n.has(e.port)&&(t&&n.get(e.port).disposeListener.dispose(),await n.get(e.port).tunnel.dispose(),n.delete(e.port))}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,t){if(this._forwardPortProvider)try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const n=this._forwardPortProvider(e,t);if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),n!==void 0){const r=await n;if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),r===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this._extensionTunnels.has(e.remoteAddress.host)||this._extensionTunnels.set(e.remoteAddress.host,new Map);const s=this._register(r.onDidDispose(()=>(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this._proxy.$closeTunnel(r.remoteAddress))));return this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:r,disposeListener:s}),Gw.fromApiTunnel(r)}else this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(n){if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),n instanceof Error)return n.message}}async $applyCandidateFilter(e){const t=await Promise.all(e.map(r=>this._showCandidatePort(r.host,r.port,r.detail??""))),n=e.filter((r,s)=>t[s]);return this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(r=>r.port).join(", ")} to ${n.map(r=>r.port).join(", ")}`),n}};Jw=B([O(0,it),O(1,Ei),O(2,rt)],Jw);function IA(i){return[...i.entries()]}function PA(i){return i?[...i.entries()]:[]}var q4;(function(i){i.AutomationProfile="terminal.integrated.automationProfile.",i.DefaultProfile="terminal.integrated.defaultProfile.",i.Profiles="terminal.integrated.profiles."})(q4||(q4={}));var j4;(function(i){i.SendKeybindingsToShell="terminal.integrated.sendKeybindingsToShell",i.AutomationProfileLinux="terminal.integrated.automationProfile.linux",i.AutomationProfileMacOs="terminal.integrated.automationProfile.osx",i.AutomationProfileWindows="terminal.integrated.automationProfile.windows",i.ProfilesWindows="terminal.integrated.profiles.windows",i.ProfilesMacOs="terminal.integrated.profiles.osx",i.ProfilesLinux="terminal.integrated.profiles.linux",i.DefaultProfileLinux="terminal.integrated.defaultProfile.linux",i.DefaultProfileMacOs="terminal.integrated.defaultProfile.osx",i.DefaultProfileWindows="terminal.integrated.defaultProfile.windows",i.UseWslProfiles="terminal.integrated.useWslProfiles",i.TabsDefaultColor="terminal.integrated.tabs.defaultColor",i.TabsDefaultIcon="terminal.integrated.tabs.defaultIcon",i.TabsEnabled="terminal.integrated.tabs.enabled",i.TabsEnableAnimation="terminal.integrated.tabs.enableAnimation",i.TabsHideCondition="terminal.integrated.tabs.hideCondition",i.TabsShowActiveTerminal="terminal.integrated.tabs.showActiveTerminal",i.TabsShowActions="terminal.integrated.tabs.showActions",i.TabsLocation="terminal.integrated.tabs.location",i.TabsFocusMode="terminal.integrated.tabs.focusMode",i.MacOptionIsMeta="terminal.integrated.macOptionIsMeta",i.MacOptionClickForcesSelection="terminal.integrated.macOptionClickForcesSelection",i.AltClickMovesCursor="terminal.integrated.altClickMovesCursor",i.CopyOnSelection="terminal.integrated.copyOnSelection",i.EnableMultiLinePasteWarning="terminal.integrated.enableMultiLinePasteWarning",i.DrawBoldTextInBrightColors="terminal.integrated.drawBoldTextInBrightColors",i.FontFamily="terminal.integrated.fontFamily",i.FontSize="terminal.integrated.fontSize",i.LetterSpacing="terminal.integrated.letterSpacing",i.LineHeight="terminal.integrated.lineHeight",i.MinimumContrastRatio="terminal.integrated.minimumContrastRatio",i.TabStopWidth="terminal.integrated.tabStopWidth",i.FastScrollSensitivity="terminal.integrated.fastScrollSensitivity",i.MouseWheelScrollSensitivity="terminal.integrated.mouseWheelScrollSensitivity",i.BellDuration="terminal.integrated.bellDuration",i.FontWeight="terminal.integrated.fontWeight",i.FontWeightBold="terminal.integrated.fontWeightBold",i.CursorBlinking="terminal.integrated.cursorBlinking",i.CursorStyle="terminal.integrated.cursorStyle",i.CursorStyleInactive="terminal.integrated.cursorStyleInactive",i.CursorWidth="terminal.integrated.cursorWidth",i.Scrollback="terminal.integrated.scrollback",i.DetectLocale="terminal.integrated.detectLocale",i.DefaultLocation="terminal.integrated.defaultLocation",i.GpuAcceleration="terminal.integrated.gpuAcceleration",i.TerminalTitleSeparator="terminal.integrated.tabs.separator",i.TerminalTitle="terminal.integrated.tabs.title",i.TerminalDescription="terminal.integrated.tabs.description",i.RightClickBehavior="terminal.integrated.rightClickBehavior",i.MiddleClickBehavior="terminal.integrated.middleClickBehavior",i.Cwd="terminal.integrated.cwd",i.ConfirmOnExit="terminal.integrated.confirmOnExit",i.ConfirmOnKill="terminal.integrated.confirmOnKill",i.EnableBell="terminal.integrated.enableBell",i.EnableVisualBell="terminal.integrated.enableVisualBell",i.CommandsToSkipShell="terminal.integrated.commandsToSkipShell",i.AllowChords="terminal.integrated.allowChords",i.AllowMnemonics="terminal.integrated.allowMnemonics",i.TabFocusMode="terminal.integrated.tabFocusMode",i.EnvMacOs="terminal.integrated.env.osx",i.EnvLinux="terminal.integrated.env.linux",i.EnvWindows="terminal.integrated.env.windows",i.EnvironmentChangesIndicator="terminal.integrated.environmentChangesIndicator",i.EnvironmentChangesRelaunch="terminal.integrated.environmentChangesRelaunch",i.ShowExitAlert="terminal.integrated.showExitAlert",i.SplitCwd="terminal.integrated.splitCwd",i.WindowsEnableConpty="terminal.integrated.windowsEnableConpty",i.WordSeparators="terminal.integrated.wordSeparators",i.EnableFileLinks="terminal.integrated.enableFileLinks",i.AllowedLinkSchemes="terminal.integrated.allowedLinkSchemes",i.UnicodeVersion="terminal.integrated.unicodeVersion",i.EnablePersistentSessions="terminal.integrated.enablePersistentSessions",i.PersistentSessionReviveProcess="terminal.integrated.persistentSessionReviveProcess",i.HideOnStartup="terminal.integrated.hideOnStartup",i.CustomGlyphs="terminal.integrated.customGlyphs",i.RescaleOverlappingGlyphs="terminal.integrated.rescaleOverlappingGlyphs",i.PersistentSessionScrollback="terminal.integrated.persistentSessionScrollback",i.InheritEnv="terminal.integrated.inheritEnv",i.ShowLinkHover="terminal.integrated.showLinkHover",i.IgnoreProcessNames="terminal.integrated.ignoreProcessNames",i.AutoReplies="terminal.integrated.autoReplies",i.ShellIntegrationEnabled="terminal.integrated.shellIntegration.enabled",i.ShellIntegrationShowWelcome="terminal.integrated.shellIntegration.showWelcome",i.ShellIntegrationDecorationsEnabled="terminal.integrated.shellIntegration.decorationsEnabled",i.ShellIntegrationCommandHistory="terminal.integrated.shellIntegration.history",i.EnableImages="terminal.integrated.enableImages",i.SmoothScrolling="terminal.integrated.smoothScrolling",i.IgnoreBracketedPasteMode="terminal.integrated.ignoreBracketedPasteMode",i.FocusAfterRun="terminal.integrated.focusAfterRun",i.DeveloperPtyHostLatency="terminal.integrated.developer.ptyHost.latency",i.DeveloperPtyHostStartupDelay="terminal.integrated.developer.ptyHost.startupDelay",i.DevMode="terminal.integrated.developer.devMode"})(j4||(j4={}));var G4;(function(i){i.PowerShell="pwsh",i.Bash="bash",i.Fish="fish",i.Sh="sh",i.Csh="csh",i.Ksh="ksh",i.Zsh="zsh",i.Python="python"})(G4||(G4={}));var Q4;(function(i){i.CommandPrompt="cmd",i.PowerShell="pwsh",i.Wsl="wsl",i.GitBash="gitbash",i.Python="python"})(Q4||(Q4={}));var J4;(function(i){i[i.Api=0]="Api",i[i.Process=1]="Process",i[i.Sequence=2]="Sequence",i[i.Config=3]="Config"})(J4||(J4={}));var _c;(function(i){i.Cwd="cwd",i.InitialCwd="initialCwd",i.FixedDimensions="fixedDimensions",i.Title="title",i.ShellType="shellType",i.HasChildProcesses="hasChildProcesses",i.ResolvedShellLaunchConfig="resolvedShellLaunchConfig",i.OverrideDimensions="overrideDimensions",i.FailedShellIntegrationActivation="failedShellIntegrationActivation",i.UsedShellIntegrationInjection="usedShellIntegrationInjection"})(_c||(_c={}));var X4;(function(i){i[i.Panel=1]="Panel",i[i.Editor=2]="Editor"})(X4||(X4={}));var Y4;(function(i){i.TerminalView="view",i.Editor="editor"})(Y4||(Y4={}));var K4;(function(i){i[i.HighWatermarkChars=1e5]="HighWatermarkChars",i[i.LowWatermarkChars=5e3]="LowWatermarkChars",i[i.CharCountAckSize=5e3]="CharCountAckSize"})(K4||(K4={}));var Z4;(function(i){i[i.Off=0]="Off",i[i.FinalTerm=1]="FinalTerm",i[i.VSCode=2]="VSCode"})(Z4||(Z4={}));var eD;(function(i){i[i.Unknown=0]="Unknown",i[i.Shutdown=1]="Shutdown",i[i.Process=2]="Process",i[i.User=3]="User",i[i.Extension=4]="Extension"})(eD||(eD={}));const TA={Backend:"workbench.contributions.terminal.processBackend"};function Xw(i){return(i==null?void 0:i.toLowerCase())??""}class AA{constructor(e){this.remoteAuthority=e}affects(e){return Xw(e)===this.remoteAuthority}}class RA{constructor(){this._backends=new Map,this._onDidChangeBackends=new L,this.onDidChangeBackends=this._onDidChangeBackends.event}get backends(){return this._backends}registerTerminalBackend(e){const t=Xw(e.remoteAuthority);if(this._backends.has(t))throw new Error(`A terminal backend with remote authority '${t}' was already registered.`);this._backends.set(t,e),this._onDidChangeBackends.fire(new AA(t))}getTerminalBackend(e){return this._backends.get(Xw(e))}}hi.add(TA.Backend,new RA);class LA{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,n=5){const r=t(s=>{const o=typeof s=="string"?s:s.data;let a=this._terminalBufferMap.get(e);if(a){a.data.push(o);return}const l=setTimeout(()=>this.flushBuffer(e),n);a={data:[o],timeoutId:l,dispose:()=>{clearTimeout(l),this.flushBuffer(e),r.dispose()}},this._terminalBufferMap.set(e,a)});return r}stopBuffering(e){const t=this._terminalBufferMap.get(e);t==null||t.dispose()}flushBuffer(e){const t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}}const da=(i,e,t,n)=>{let r=e;return{enumerable:!0,configurable:!1,get(){return r},set(s){var o;if(!t(r,s)){const a=r;r=s,(o=i.listener)==null||o.call(i,n(s,a))}}}},vc=(i,e)=>i===e,qs={range:(i,e)=>i===e?!0:!i||!e?!1:i.isEqual(e),label:vc,description:vc,sortText:vc,busy:vc,error:vc,canResolveChildren:vc,tags:(i,e)=>!(i.length!==e.length||i.some(t=>!e.find(n=>t.id===n.id)))},wc=i=>e=>({op:di.SetProp,update:i(e)}),NA=(i,e)=>({range:(()=>{let t;const n=wc(r=>({range:ct.lift(H.from(r))}));return{enumerable:!0,configurable:!1,get(){return t},set(r){var s,o;(s=i.listener)==null||s.call(i,{op:di.DocumentSynced}),qs.range(t,r)||(t=r,(o=i.listener)==null||o.call(i,n(r)))}}})(),label:da(i,e,qs.label,wc(t=>({label:t}))),description:da(i,void 0,qs.description,wc(t=>({description:t}))),sortText:da(i,void 0,qs.sortText,wc(t=>({sortText:t}))),canResolveChildren:da(i,!1,qs.canResolveChildren,t=>({op:di.UpdateCanResolveChildren,state:t})),busy:da(i,!1,qs.busy,wc(t=>({busy:t}))),error:da(i,void 0,qs.error,wc(t=>({error:We.fromStrict(t)||null}))),tags:da(i,[],qs.tags,(t,n)=>({op:di.SetTags,new:t.map(Jn.from),old:n.map(Jn.from)}))}),OA=i=>{const e=Ie.fromString(i.extId),t=new ha(e.controllerId,e.localId,i.label,y.revive(i.uri)||void 0);return t.range=H.to(i.range||void 0),t.description=i.description||void 0,t.sortText=i.sortText||void 0,t.tags=i.tags.map(n=>Jn.to({id:_E(n).tagId})),t},tD=i=>{let e;for(const t of i.tests){const n=OA(t.item);fp(n).parent=e,e=n}return e};class ha{constructor(e,t,n,r){if(t.includes(kn.Delimiter))throw new Error(`Test IDs may not include the ${JSON.stringify(t)} symbol`);const s=kP(this,e);Object.defineProperties(this,{id:{value:t,enumerable:!0,writable:!1},uri:{value:r,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return s.parent instanceof Yw?void 0:s.parent}},children:{value:DP(s,fp,ha),enumerable:!0,writable:!1},...NA(s,n)})}}class Yw extends ha{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}}class FA extends xP{constructor(e,t,n){super({controllerId:e,getDocumentVersion:r=>{var s;return r&&((s=n.getDocument(r))==null?void 0:s.version)},getApiFor:fp,getChildren:r=>r.children,root:new Yw(e,t),toITestItem:Bs.from})}}let Kw=class extends Re{constructor(e,t){super(),this.initData=e,this.loggerService=t,this._onDidChangeTelemetryEnabled=this._register(new L),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new L),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=Bo.NONE,this._telemetryIsSupported=!1,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this.extHostTelemetryLogFile=y.revive(this.initData.environment.extensionTelemetryLogResource),this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly,this._outputLogger=t.createLogger(this.extHostTelemetryLogFile,{id:RT,name:h(576,"Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0}),this._register(this._outputLogger),this._register(t.onDidChangeLogLevel(n=>{uT(n)&&this.updateLoggerVisibility()})),this._outputLogger.info("Below are logs for extension telemetry events sent to the telemetry output channel API once the log level is set to trace."),this._outputLogger.info("===========================================================")}updateLoggerVisibility(){this.loggerService.setVisibility(this.extHostTelemetryLogFile,this._telemetryIsSupported&&this.loggerService.getLogLevel()===Ye.Trace)}getTelemetryConfiguration(){return this._level===Bo.USAGE}getTelemetryDetails(){return{isCrashEnabled:this._level>=Bo.CRASH,isErrorsEnabled:this._productConfig.error?this._level>=Bo.ERROR:!1,isUsageEnabled:this._productConfig.usage?this._level>=Bo.USAGE:!1}}instantiateLogger(e,t,n){const r=this.getTelemetryDetails(),s=new iD(t,n,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:r.isUsageEnabled,isErrorsEnabled:r.isErrorsEnabled}),o=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...o,s]),s.apiTelemetryLogger}$initializeTelemetryLevel(e,t,n){this._level=e,this._telemetryIsSupported=t,this._productConfig=n??{usage:!0,error:!0},this.updateLoggerVisibility()}getBuiltInCommonProperties(e){const t=Object.create(null);switch(t["common.extname"]=`${e.publisher}.${e.name}`,t["common.extversion"]=e.version,t["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,t["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,t["common.sqmid"]=this.initData.telemetryInfo.sqmId,t["common.devDeviceId"]=this.initData.telemetryInfo.devDeviceId,t["common.vscodeversion"]=this.initData.version,t["common.isnewappinstall"]=nD(this.initData.telemetryInfo.firstSessionDate),t["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case pu.Web:t["common.uikind"]="web";break;case pu.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}return t["common.remotename"]=L_(NT(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;const t=this.getTelemetryDetails();this._telemetryLoggers.forEach((n,r)=>{const s=n.filter(o=>!o.isDisposed);s.length===0?this._telemetryLoggers.delete(r):this._telemetryLoggers.set(r,s)}),this._telemetryLoggers.forEach(n=>{for(const r of n)r.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails()),this.updateLoggerVisibility()}onExtensionError(e,t){const n=this._telemetryLoggers.get(e.value),r=n==null?void 0:n.filter(o=>!o.isDisposed);if(!r)return this._telemetryLoggers.delete(e.value),!1;let s=!1;for(const o of r)o.ignoreUnhandledExtHostErrors||(o.logError(t),s=!0);return s}};Kw=B([O(0,Ei),O(1,hl)],Kw);class iD{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,n,r,s,o,a){this._extension=n,this._logger=r,this._inLoggingOnlyMode=s,this._commonProperties=o,this._onDidChangeEnableStates=new L,this.ignoreUnhandledExtHostErrors=(t==null?void 0:t.ignoreUnhandledErrors)??!1,this._ignoreBuiltinCommonProperties=(t==null?void 0:t.ignoreBuiltInCommonProperties)??!1,this._additionalCommonProperties=t==null?void 0:t.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=hS(t,[]),this._additionalCommonProperties&&(t=ko(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=ko(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){var n;this._sender&&(this._extension.publisher==="vscode"?e=this._extension.name+"/"+e:e=this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||(n=this._sender)==null||n.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e=="string")this.logEvent(e,t);else{const n={name:e.name,message:e.message,stack:e.stack,cause:e.cause},r=hS(n,[]),s=new Error(r.message,{cause:r.cause});s.stack=r.stack,s.name=r.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(s,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){var e;if((e=this._sender)!=null&&e.flush){let t=this._sender;this._sender=void 0,Promise.resolve(t.flush()).then(t=void 0),this._apiObject=void 0}else this._sender=void 0}}function nD(i){const e=Date.now()-new Date(i).getTime();return isNaN(e)?!1:e<1e3*60*60*24}const lm=ke("IExtHostTelemetry");let Zw=(m5=class{constructor(e,t,n){me(this,ps);me(this,$h);me(this,Uh);this._commands=new Map,this._apiCommands=new Map,te(this,ps,e.getProxy(Z.MainThreadCommands)),this._logService=t,te(this,Uh,n),te(this,$h,e.getProxy(Z.MainThreadTelemetry)),this.converter=new MA(this,r=>{const s=this._apiCommands.get(r);return(s==null?void 0:s.result)===xe.Void?s:void 0},t),this._argumentProcessors=[{processArgument(r){return Ki(r)}},{processArgument(r){return Af(r,function(s){if(ct.isIRange(s))return H.to(s);if(pn.isIPosition(s))return nt.to(s);if(ct.isIRange(s.range)&&y.isUri(s.uri))return zi.to(s);if(s instanceof De)return s.buffer.buffer;if(!Array.isArray(s))return s})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const t=this.registerCommand(!1,e.id,async(...n)=>{const r=e.args.map((o,a)=>{if(!o.validate(n[a]))throw new Error(`Invalid argument '${o.name}' when running '${e.id}', received: ${typeof n[a]=="object"?JSON.stringify(n[a],null,"	"):n[a]} `);return o.convert(n[a])}),s=await this.executeCommand(e.internalId,...r);return e.result.convert(s,n,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new Qe(()=>{t.dispose(),this._apiCommands.delete(e.id)})}registerCommand(e,t,n,r,s,o){if(this._logService.trace("ExtHostCommands#registerCommand",t),!t.trim().length)throw new Error("invalid id");if(this._commands.has(t))throw new Error(`command '${t}' already exists`);return this._commands.set(t,{callback:n,thisArg:r,metadata:s,extension:o}),e&&I(this,ps).$registerCommand(t),new Qe(()=>{this._commands.delete(t)&&e&&I(this,ps).$unregisterCommand(t)})}executeCommand(e,...t){return this._logService.trace("ExtHostCommands#executeCommand",e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,n){if(this._commands.has(e))return I(this,ps).$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let r=!1;const s=Af(t,function(o){if(o instanceof He)return nt.from(o);if(o instanceof Fe)return H.from(o);if(o instanceof gn)return zi.from(o);if(Xr.isNotebookRange(o))return mr.from(o);if(o instanceof ArrayBuffer)return r=!0,De.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return r=!0,De.wrap(o);if(o instanceof De)return r=!0,o;if(!Array.isArray(o))return o});try{const o=await I(this,ps).$executeCommand(e,r?new un(s):s,n);return Ki(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this._doExecuteCommand(e,t,!1);throw o}}}async _executeContributedCommand(e,t,n){var c,u,d;const r=this._commands.get(e);if(!r)throw new Error("Unknown command");const{callback:s,thisArg:o,metadata:a}=r;if(a!=null&&a.args)for(let f=0;f<a.args.length;f++)try{sI(t[f],a.args[f].constraint)}catch{throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[f].name}' - ${a.args[f].description}`)}const l=Rr.create();try{return await s.apply(o,t)}catch(f){if(e===this.converter.delegatingCommandId){const p=this.converter.getActualCommand(...t);p&&(e=p.command)}if(this._logService.error(f,e,(c=r.extension)==null?void 0:c.identifier),!n)throw f;if((u=r.extension)!=null&&u.identifier){const p=I(this,Uh).onExtensionError(r.extension.identifier,f);this._logService.trace("forwarded error to extension?",p,(d=r.extension)==null?void 0:d.identifier)}throw new class extends Error{constructor(){var b,w;super($o(f)),this.id=e,this.source=((b=r.extension)==null?void 0:b.displayName)??((w=r.extension)==null?void 0:w.name)}}}finally{this._reportTelemetry(r,e,l.elapsed())}}_reportTelemetry(e,t,n){e.extension&&I(this,$h).$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new U_(t),duration:n})}$executeContributedCommand(e,...t){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const n=this._commands.get(e);return n?(t=t.map(r=>this._argumentProcessors.reduce((s,o)=>{var a;return o.processArgument(s,(a=n.extension)==null?void 0:a.identifier)},r)),this._executeContributedCommand(e,t,!0)):Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace("ExtHostCommands#getCommands",e),I(this,ps).$getCommands().then(t=>(e&&(t=t.filter(n=>n[0]!=="_")),t))}$getContributedCommandMetadata(){const e=Object.create(null);for(const[t,n]of this._commands){const{metadata:r}=n;r&&(e[t]=r)}return Promise.resolve(e)}},ps=new WeakMap,$h=new WeakMap,Uh=new WeakMap,m5);Zw=B([O(0,it),O(1,rt),O(2,lm)],Zw);const fa=ke("IExtHostCommands");class MA{constructor(e,t,n){this._commands=e,this._lookupApiCommand=t,this._logService=n,this.delegatingCommandId=`__vsc${Un()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const n={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return n;const r=this._lookupApiCommand(e.command);if(r)n.id=r.internalId,n.arguments=r.args.map((s,o)=>s.convert(e.arguments&&e.arguments[o]));else if(uu(e.arguments)){const s=`${e.command} /${++this._cachIdPool}`;this._cache.set(s,e),t.add(Me(()=>{this._cache.delete(s),this._logService.trace("CommandsConverter#DISPOSE",s)})),n.$ident=s,n.id=this.delegatingCommandId,n.arguments=[s],this._logService.trace("CommandsConverter#CREATE",e.command,s)}return n}fromInternal(e){return typeof e.$ident=="string"?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}}const Pt=class Pt{static Arr(e){return new Pt(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,t=>Array.isArray(t)&&t.every(n=>e.validate(n)),t=>t.map(n=>e.convert(n)))}constructor(e,t,n,r){this.name=e,this.description=t,this.validate=n,this.convert=r}optional(){return new Pt(this.name,`(optional) ${this.description}`,e=>e==null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,t){return new Pt(e??this.name,t??this.description,this.validate,this.convert)}};Pt.Uri=new Pt("uri","Uri of a text document",e=>y.isUri(e),e=>e),Pt.Position=new Pt("position","A position in a text document",e=>He.isPosition(e),nt.from),Pt.Range=new Pt("range","A range in a text document",e=>Fe.isRange(e),H.from),Pt.Selection=new Pt("selection","A selection in a text document",e=>Qr.isSelection(e),Qn.from),Pt.Number=new Pt("number","",e=>typeof e=="number",e=>e),Pt.String=new Pt("string","",e=>typeof e=="string",e=>e),Pt.StringArray=Pt.Arr(Pt.String),Pt.CallHierarchyItem=new Pt("item","A call hierarchy item",e=>e instanceof sv,oa.from),Pt.TypeHierarchyItem=new Pt("item","A type hierarchy item",e=>e instanceof $v,la.from),Pt.TestItem=new Pt("testItem","A VS Code TestItem",e=>e instanceof ha,Bs.from);let z=Pt;const Zm=class Zm{constructor(e,t){this.description=e,this.convert=t}};Zm.Void=new Zm("no result",e=>e);let xe=Zm;class Ee{constructor(e,t,n,r,s){this.id=e,this.internalId=t,this.description=n,this.args=r,this.result=s}}const bc=ke("IExtHostTerminalService");class rD extends Re{constructor(e,t,n,r){super(),this._proxy=e,this._id=t,this._creationOptions=n,this._name=r,this._disposed=!1,this._state={isInteractedWith:!1},this.isOpen=!1,this._onWillDispose=this._register(new L),this.onWillDispose=this._onWillDispose.event,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(o=>this._pidPromiseComplete=o);const s=this;this.value={get name(){return s._name||""},get processId(){return s._pidPromise},get creationOptions(){return s._creationOptions},get exitStatus(){return s._exitStatus},get state(){return s._state},get selection(){return s._selection},get shellIntegration(){return s.shellIntegration},sendText(o,a=!0){s._checkDisposed(),s._proxy.$sendText(s._id,o,a)},show(o){s._checkDisposed(),s._proxy.$show(s._id,o)},hide(){s._checkDisposed(),s._proxy.$hide(s._id)},dispose(){s._disposed||(s._disposed=!0,s._proxy.$dispose(s._id))},get dimensions(){if(!(s._cols===void 0||s._rows===void 0))return{columns:s._cols,rows:s._rows}}}}dispose(){this._onWillDispose.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??(t==null?void 0:t.cwd)??void 0,env:e.env??void 0,icon:oD(e.iconPath)??void 0,color:gl.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:(t==null?void 0:t.forceShellIntegration)??void 0,isFeatureTerminal:(t==null?void 0:t.isFeatureTerminal)??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:(t==null?void 0:t.useShellEnvironment)??void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e.location,t==null?void 0:t.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,n,r,s){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:r,color:gl.isThemeColor(s)?s.id:void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e,n),isTransient:!0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return typeof e=="object"?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:Kt.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={isInteractedWith:!0},!0)}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}}class eb{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new L,this.onProcessData=this._onProcessData.event,this._onProcessReady=new L,this._onDidChangeProperty=new L,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new L,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){var t,n;(n=(t=this._pty).handleInput)==null||n.call(t,e)}resize(e,t){var n,r;(r=(n=this._pty).setDimensions)==null||r.call(n,{columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){var t,n,r,s,o,a,l,c;this._pty.onDidWrite(u=>this._onProcessData.fire(u)),(n=(t=this._pty).onDidClose)==null||n.call(t,(u=void 0)=>{this._onProcessExit.fire(u===void 0?void 0:u)}),(s=(r=this._pty).onDidOverrideDimensions)==null||s.call(r,u=>{u&&this._onDidChangeProperty.fire({type:_c.OverrideDimensions,value:{cols:u.columns,rows:u.rows}})}),(a=(o=this._pty).onDidChangeName)==null||a.call(o,u=>{this._onDidChangeProperty.fire({type:_c.Title,value:u})}),this._pty.open(e||void 0),e&&((c=(l=this._pty).setDimensions)==null||c.call(l,e)),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let $A=1,tb=class extends Re{get activeTerminal(){var e;return(e=this._activeTerminal)==null?void 0:e.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,t,n){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new po),this._linkProviders=new Set,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new L,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new L,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new L,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new L,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new L,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new L,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new L({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new L({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=n.getProxy(Z.MainThreadTerminalService),this._bufferer=new LA(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:r=>{const s=o=>{var l;const a=o;return(l=this.getTerminalById(a.instanceId))==null?void 0:l.value};switch(r==null?void 0:r.$mid){case mt.TerminalContext:return s(r);default:{if(Array.isArray(r))for(let o=0;o<r.length&&r[o].$mid===mt.TerminalContext;o++)r[o]=s(r[o]);return r}}}}),this._register({dispose:()=>{for(const[r,s]of this._terminalProcesses)s.shutdown(!0)}})}getDefaultShell(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.path)||""}getDefaultShellArgs(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.args)||[]}createExtensionTerminal(e,t){const n=new rD(this._proxy,Un(),e,e.name),r=new eb(e.pty);return n.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,oD(e.iconPath),HA(e.color)).then(s=>{const o=this._setupExtHostProcessListeners(s,r);this._terminalProcessDisposables[s]=o}),this._terminals.push(n),n.value}_serializeParentTerminal(e,t){if(t=t||{},e.location&&typeof e.location=="object"&&"parentTerminal"in e.location){const n=e.location.parentTerminal;if(n){const r=this._terminals.find(s=>s.value===n);r&&(t.resolvedExtHostIdentifier=r._id)}}else e.location&&typeof e.location!="object"?t.location=e.location:t.location&&typeof t.location=="object"&&"splitActiveTerminal"in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){if(!this.getTerminalById(e))throw new Error(`Cannot resolve terminal with id ${e} for virtual process`);const r=new eb(t),s=this._setupExtHostProcessListeners(e,r);this._terminalProcessDisposables[e]=s}async $acceptActiveTerminalChanged(e){const t=this._activeTerminal;if(e===null){this._activeTerminal=void 0,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}const n=this.getTerminalById(e);n&&(this._activeTerminal=n,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){const n=this.getTerminalById(e);n&&this._onDidWriteTerminalData.fire({terminal:n.value,data:t})}async $acceptTerminalDimensions(e,t,n){const r=this.getTerminalById(e);r&&r.setDimensions(t,n)&&this._onDidChangeTerminalDimensions.fire({terminal:r.value,dimensions:r.value.dimensions})}async $acceptDidExecuteCommand(e,t){const n=this.getTerminalById(e);n&&this._onDidExecuteCommand.fire({terminal:n.value,...t})}async $acceptTerminalMaximumDimensions(e,t,n){var r;(r=this._terminalProcesses.get(e))==null||r.resize(t,n)}async $acceptTerminalTitleChange(e,t){const n=this.getTerminalById(e);n&&(n.name=t)}async $acceptTerminalClosed(e,t,n){const r=this._getTerminalObjectIndexById(this._terminals,e);if(r!==null){const s=this._terminals.splice(r,1)[0];s.setExitStatus(t,n),this._onDidCloseTerminal.fire(s.value)}}$acceptTerminalOpened(e,t,n,r){if(t){const a=this._getTerminalObjectIndexById(this._terminals,t);if(a!==null){this._terminals[a]._id=e,this._onDidOpenTerminal.fire(this.terminals[a]),this._terminals[a].isOpen=!0;return}}const s={name:r.name,shellPath:r.executable,shellArgs:r.args,cwd:typeof r.cwd=="string"?r.cwd:y.revive(r.cwd),env:r.env,hideFromUser:r.hideFromUser},o=new rD(this._proxy,e,s,n);this._terminals.push(o),this._onDidOpenTerminal.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(e,t){const n=this.getTerminalById(e);n==null||n._setProcessId(t)}async $startExtensionTerminal(e,t){const n=this.getTerminalById(e);if(!n)return{message:h(573,"Could not find the terminal with id {0} on the extension host",e)};n.isOpen||await new Promise(s=>{const o=this.onDidOpenTerminal(async a=>{a===n.value&&(o.dispose(),s())})});const r=this._terminalProcesses.get(e);r?r.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){const n=new Le;n.add(t.onProcessReady(s=>this._proxy.$sendProcessReady(e,s.pid,s.cwd,s.windowsPty))),n.add(t.onDidChangeProperty(s=>this._proxy.$sendProcessProperty(e,s))),this._bufferer.startBuffering(e,t.onProcessData),n.add(t.onProcessExit(s=>this._onProcessExit(e,s))),this._terminalProcesses.set(e,t);const r=this._extensionTerminalAwaitingStart[e];return r&&t instanceof eb&&(t.startSendingEvents(r.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),n}$acceptProcessAckDataEvent(e,t){var n;(n=this._terminalProcesses.get(e))==null||n.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){var n;(n=this._terminalProcesses.get(e))==null||n.input(t)}$acceptTerminalInteraction(e){const t=this.getTerminalById(e);t!=null&&t.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){var n;(n=this.getTerminalById(e))==null||n.setSelection(t)}$acceptProcessResize(e,t,n){var r;try{(r=this._terminalProcesses.get(e))==null||r.resize(t,n)}catch(s){if(s.code!=="EPIPE"&&s.code!=="ERR_IPC_CHANNEL_CLOSED")throw s}}$acceptProcessShutdown(e,t){var n;(n=this._terminalProcesses.get(e))==null||n.shutdown(t)}$acceptProcessRequestInitialCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getInitialCwd().then(n=>this._proxy.$sendProcessProperty(e,{type:_c.InitialCwd,value:n}))}$acceptProcessRequestCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getCwd().then(n=>this._proxy.$sendProcessProperty(e,{type:_c.Cwd,value:n}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerLinkProvider(e){return this._linkProviders.add(e),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new Qe(()=>{this._linkProviders.delete(e),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}registerProfileProvider(e,t,n){if(this._profileProviders.has(t))throw new Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,n),this._proxy.$registerProfileProvider(t,e.identifier.value),new Qe(()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)})}registerTerminalQuickFixProvider(e,t,n){if(this._quickFixProviders.has(e))throw new Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,n),this._proxy.$registerQuickFixProvider(e,t),new Qe(()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,t){const n=new Qt().token;if(n.isCancellationRequested)return;const r=this._quickFixProviders.get(e);if(!r)return;const s=await r.provideTerminalQuickFixes(t,n);if(s===null||Array.isArray(s)&&s.length===0)return;const o=new Le;if(this._lastQuickFixCommands.value=o,!Array.isArray(s))return s?tm.from(s,this._extHostCommands.converter,o):void 0;const a=[];for(const l of s){const c=tm.from(l,this._extHostCommands.converter,o);c&&a.push(c)}return a}async $createContributedProfileTerminal(e,t){var s;const n=new Qt().token;let r=await((s=this._profileProviders.get(e))==null?void 0:s.provideTerminalProfile(n));if(!n.isCancellationRequested){if(r&&!("options"in r)&&(r={options:r}),!r||!("options"in r))throw new Error(`No terminal profile options provided for id "${e}"`);if("pty"in r.options){this.createExtensionTerminal(r.options,t);return}this.createTerminalFromOptions(r.options,t)}}async $provideLinks(e,t){const n=this.getTerminalById(e);if(!n)return[];this._terminalLinkCache.delete(e);const r=this._terminalLinkCancellationSource.get(e);r==null||r.dispose(!0);const s=new Qt;this._terminalLinkCancellationSource.set(e,s);const o=[],a={terminal:n.value,line:t},l=[];for(const d of this._linkProviders)l.push(ul.withAsyncBody(async f=>{s.token.onCancellationRequested(()=>f({provider:d,links:[]}));const p=await d.provideTerminalLinks(a,s.token)||[];s.token.isCancellationRequested||f({provider:d,links:p})}));const c=await Promise.all(l);if(s.token.isCancellationRequested)return[];const u=new Map;for(const d of c)d&&d.links.length>0&&o.push(...d.links.map(f=>{const p={id:$A++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(p.id,{provider:d.provider,link:f}),p}));return this._terminalLinkCache.set(e,u),o}$activateLink(e,t){var r;const n=(r=this._terminalLinkCache.get(e))==null?void 0:r.get(t);n&&n.provider.handleTerminalLink(n.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];const n=this._terminalProcessDisposables[e];n&&(n.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){const t=this._terminals.findIndex(n=>n.value===e);return t>=0?t:null}_getTerminalObjectById(e,t){const n=this._getTerminalObjectIndexById(e,t);return n!==null?e[n]:null}_getTerminalObjectIndexById(e,t){const n=e.findIndex(r=>r._id===t);return n>=0?n:null}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=this._register(new sD),this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){const n=IA(t.map),r=PA(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,n.length===0?void 0:n,r)}$initEnvironmentVariableCollections(e){e.forEach(t=>{const n=t[0],r=this._register(new sD(t[1]));this._setEnvironmentVariableCollection(n,r)})}$acceptDefaultProfile(e,t){const n=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,(n==null?void 0:n.path)!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),this._register(t.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,t)}))}};tb=B([O(1,fa),O(2,it)],tb);class sD extends Re{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){super(),this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new L,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let n=this.scopedCollections.get(t);return n||(n=new UA(this,e),this.scopedCollections.set(t,n),this._register(n.onDidChangeCollection(()=>this._onDidChangeCollection.fire()))),n}replace(e,t,n,r){this._setIfDiffers(e,{value:t,type:Ol.Replace,options:n??{applyAtProcessCreation:!0},scope:r})}append(e,t,n,r){this._setIfDiffers(e,{value:t,type:Ol.Append,options:n??{applyAtProcessCreation:!0},scope:r})}prepend(e,t,n,r){this._setIfDiffers(e,{value:t,type:Ol.Prepend,options:n??{applyAtProcessCreation:!0},scope:r})}_setIfDiffers(e,t){var o,a,l,c,u,d;if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const n=this.getKey(e,t.scope),r=this.map.get(n),s=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!r||r.value!==t.value||r.type!==t.type||((o=r.options)==null?void 0:o.applyAtProcessCreation)!==s.applyAtProcessCreation||((a=r.options)==null?void 0:a.applyAtShellIntegration)!==s.applyAtShellIntegration||((c=(l=r.scope)==null?void 0:l.workspaceFolder)==null?void 0:c.index)!==((d=(u=t.scope)==null?void 0:u.workspaceFolder)==null?void 0:d.index)){const f=this.getKey(e,t.scope),p={variable:e,...t,options:s};this.map.set(f,p),this._onDidChangeCollection.fire()}}get(e,t){const n=this.getKey(e,t),r=this.map.get(n);return r?aD(r):void 0}getKey(e,t){const n=this.getScopeKey(t);return n.length?`${e}:::${n}`:e}getScopeKey(e){return this.getWorkspaceKey(e==null?void 0:e.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[n,r]of this.map)this.getScopeKey(r.scope)===this.getScopeKey(e)&&t.set(r.variable,aD(r));return t}delete(e,t){const n=this.getKey(e,t);this.map.delete(n),this._onDidChangeCollection.fire()}clear(e){var t,n;if(e!=null&&e.workspaceFolder){for(const[r,s]of this.map)((n=(t=s.scope)==null?void 0:t.workspaceFolder)==null?void 0:n.index)===e.workspaceFolder.index&&this.map.delete(r);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const n=this.getScopeKey(t),r=this.descriptionMap.get(n);if(!r||r.description!==e){let s;typeof e=="string"?s=e:s=e==null?void 0:e.value.split(`

`)[0];const o={description:s,scope:t};this.descriptionMap.set(n,o),this._onDidChangeCollection.fire()}}getDescription(e){var n;const t=this.getScopeKey(e);return(n=this.descriptionMap.get(t))==null?void 0:n.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}}class UA{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new L}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,n){this.collection.replace(e,t,n,this.scope)}append(e,t,n){this.collection.append(e,t,n,this.scope)}prepend(e,t,n){this.collection.prepend(e,t,n,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((n,r)=>e.call(t,r,n,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let ib=class extends tb{constructor(e,t){super(!1,e,t)}createTerminal(e,t,n){throw new C1}createTerminalFromOptions(e,t){throw new C1}};ib=B([O(0,fa),O(1,it)],ib);function oD(i){if(!(!i||typeof i=="string"))return"id"in i?{id:i.id,color:i.color}:i}function HA(i){return gl.isThemeColor(i)?i:void 0}function aD(i){const e={...i};return delete e.scope,e.options=e.options??void 0,delete e.variable,e}const lD="__",nb=ke("IExtHostAuthentication");let rb=class{constructor(e){this._authenticationProviders=new Map,this._onDidChangeSessions=new L,this.onDidChangeSessions=this._onDidChangeSessions.event,this._getSessionTaskSingler=new BA,this._proxy=e.getProxy(Z.MainThreadAuthentication)}async getSession(e,t,n,r={}){const s=ot.toKey(e.identifier),o=[...n].sort().join(" ");return await this._getSessionTaskSingler.getOrCreate(`${s} ${t} ${o}`,async()=>{await this._proxy.$ensureProvider(t);const a=e.displayName||e.name;return this._proxy.$getSession(t,n,s,a,r)})}async getAccounts(e){return await this._proxy.$ensureProvider(e),await this._proxy.$getAccounts(e)}async removeSession(e,t){const n=this._authenticationProviders.get(e);return n?n.provider.removeSession(t):this._proxy.$removeSession(e,t)}registerAuthenticationProvider(e,t,n,r){if(this._authenticationProviders.get(e))throw new Error(`An authentication provider with id '${e}' is already registered.`);this._authenticationProviders.set(e,{label:t,provider:n,options:r??{supportsMultipleAccounts:!1}});const s=n.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(e,o));return this._proxy.$registerAuthenticationProvider(e,t,(r==null?void 0:r.supportsMultipleAccounts)??!1),new Qe(()=>{s.dispose(),this._authenticationProviders.delete(e),this._proxy.$unregisterAuthenticationProvider(e)})}async $createSession(e,t,n){const r=this._authenticationProviders.get(e);if(r)return await r.provider.createSession(t,n);throw new Error(`Unable to find authentication provider with handle: ${e}`)}async $removeSession(e,t){const n=this._authenticationProviders.get(e);if(n)return await n.provider.removeSession(t);throw new Error(`Unable to find authentication provider with handle: ${e}`)}async $getSessions(e,t,n){const r=this._authenticationProviders.get(e);if(r)return await r.provider.getSessions(t,n);throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,t){return e.startsWith(lD)||this._onDidChangeSessions.fire({provider:{id:e,label:t}}),Promise.resolve()}};rb=B([O(0,it)],rb);class BA{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const n=this._inFlightPromises.get(e);if(n)return n;const r=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,r),r}}var sb;const ob=ke("IExtHostLanguageModels");class cD{constructor(e,t){this.option=e,this.stream=new n_,this.stream=t??new n_}}class WA{constructor(){this._responseStreams=new Map,this._defaultStream=new n_,this._isDone=!1;const e=this;this.apiObject={get stream(){return e._defaultStream.asyncIterable},get text(){return So.map(e._defaultStream.asyncIterable,t=>{if(t instanceof Bd)return t.value}).coalesce()}}}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;let t=this._responseStreams.get(e.index);t||(this._responseStreams.size===0?t=new cD(e.index,this._defaultStream):t=new cD(e.index),this._responseStreams.set(e.index,t));let n;e.part.type==="text"?n=new Bd(e.part.value):n=new Qv(e.part.name,e.part.parameters),t.stream.emitOne(n)}reject(e){this._isDone=!0;for(const t of this._streams())t.reject(e)}resolve(){this._isDone=!0;for(const e of this._streams())e.resolve()}}let ab=(Pa=class{constructor(e,t,n){this._logService=t,this._extHostAuthentication=n,this._onDidChangeModelAccess=new L,this._onDidChangeProviders=new L,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._allLanguageModelData=new Map,this._modelAccessList=new Vr,this._pendingRequest=new Map,this._languageAccessInformationExtensions=new Set,this._proxy=e.getProxy(Z.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(e,t,n,r){var l;const s=sb._idPool++;this._languageModels.set(s,{extension:e.identifier,provider:n,languageModelId:t});let o;r.auth&&(o={providerLabel:e.displayName||e.name,accountLabel:typeof r.auth=="object"?r.auth.label:void 0}),this._proxy.$registerLanguageModelProvider(s,`${ot.toKey(e.identifier)}/${s}/${t}`,{extension:e.identifier,id:t,vendor:r.vendor??ot.toKey(e.identifier),name:r.name??"",family:r.family??"",version:r.version,maxInputTokens:r.maxInputTokens,maxOutputTokens:r.maxOutputTokens,auth:o,targetExtensions:r.extensions});const a=(l=n.onDidReceiveLanguageModelResponse2)==null?void 0:l.call(n,({extensionId:c,participant:u,tokenCount:d})=>{this._proxy.$whenLanguageModelChatRequestMade(t,new ot(c),u,d)});return Me(()=>{this._languageModels.delete(s),this._proxy.$unregisterProvider(s),a==null||a.dispose()})}async $startChatRequest(e,t,n,r,s,o){const a=this._languageModels.get(e);if(!a)throw new Error("Provider not found");const l=new Ju(async u=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let d;if(u.part instanceof Qv?d={type:"function_use",name:u.part.name,parameters:u.part.parameters}:u.part instanceof Bd&&(d={type:"text",value:u.part.value}),!d){this._logService.warn(`[CHAT](${a.extension.value}) UNKNOWN part ${JSON.stringify(u)}`);return}this._proxy.$reportResponsePart(t,{index:u.index,part:d})});let c;if(a.provider.provideLanguageModelResponse2)c=Promise.resolve(a.provider.provideLanguageModelResponse2(r.map(uc.to),s,ot.toKey(n),l,o));else{const u=new Ju(async d=>{l.report({index:d.index,part:new Bd(d.part)})});c=Promise.resolve(a.provider.provideLanguageModelResponse(r.map(uc.to),(s==null?void 0:s.modelOptions)??{},ot.toKey(n),u,o))}c.then(()=>{this._proxy.$reportResponseDone(t,void 0)},u=>{this._proxy.$reportResponseDone(t,cu(u))})}$provideTokenLength(e,t,n){const r=this._languageModels.get(e);return r?Promise.resolve(r.provider.provideTokenCount(t,n)):Promise.resolve(0)}$acceptChatModelMetadata(e){var t;if(e.added)for(const{identifier:n,metadata:r}of e.added)this._allLanguageModelData.set(n,{metadata:r,apiObjects:new Vr});if(e.removed)for(const n of e.removed){this._allLanguageModelData.delete(n);for(const[r,s]of this._pendingRequest)s.languageModelId===n&&(s.res.reject(new Ir),this._pendingRequest.delete(r))}(t=e.added)==null||t.forEach(n=>this._fakeAuthPopulate(n.metadata)),this._onDidChangeProviders.fire(void 0)}async selectLanguageModels(e,t){const n=await this._proxy.$selectChatModels({...t,extension:e.identifier}),r=[],s=this;for(const o of n){const a=this._allLanguageModelData.get(o);if(!a)continue;this._isUsingAuth(e.identifier,a.metadata)&&await this._fakeAuthPopulate(a.metadata);let l=a.apiObjects.get(e.identifier);l||(l={id:o,vendor:a.metadata.vendor,family:a.metadata.family,version:a.metadata.version,name:a.metadata.name,maxInputTokens:a.metadata.maxInputTokens,countTokens(c,u){if(!s._allLanguageModelData.has(o))throw Fi.NotFound(o);return s._computeTokenLength(o,c,u??Nt.None)},sendRequest(c,u,d){if(!s._allLanguageModelData.has(o))throw Fi.NotFound(o);return s._sendChatRequest(e,o,c,u??{},d??Nt.None)}},a.apiObjects.set(e.identifier,l)),r.push(l)}return r}async _sendChatRequest(e,t,n,r,s){var c,u;const o=this._convertMessages(e,n),a=e.identifier,l=(c=this._allLanguageModelData.get(t))==null?void 0:c.metadata;if(!l||!this._allLanguageModelData.has(t))throw Fi.NotFound(`Language model '${t}' is unknown.`);if(this._isUsingAuth(a,l)&&(!await this._getAuthAccess(e,{identifier:l.extension,displayName:l.auth.providerLabel},r.justification,!1)||!((u=this._modelAccessList.get(a))!=null&&u.has(l.extension))))throw Fi.NoPermissions(`Language model '${t}' cannot be used by '${a.value}'.`);try{const d=Math.random()*1e6|0,f=new WA;this._pendingRequest.set(d,{languageModelId:t,res:f});try{await this._proxy.$tryStartChatRequest(a,t,d,o,r,s)}catch(p){throw this._pendingRequest.delete(d),p}return f.apiObject}catch(d){throw d.name===Fi.name?d:new Fi(`Language model '${t}' errored: ${$o(d)}`,"Unknown",d)}}_convertMessages(e,t){const n=[];for(const r of t)r.role===Cn.System&&M(e,"languageModelSystem"),r.content2 instanceof Sg&&M(e,"lmTools"),n.push(uc.from(r));return n}async $acceptResponsePart(e,t){const n=this._pendingRequest.get(e);n&&n.res.handleFragment(t)}async $acceptResponseDone(e,t){const n=this._pendingRequest.get(e);n&&(this._pendingRequest.delete(e),t?n.res.reject(y5(t)):n.res.resolve())}async _getAuthAccess(e,t,n,r){const s=lD+t.identifier.value;if(await this._extHostAuthentication.getSession(e,s,[],{silent:!0}))return this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0;if(r)return!1;try{const a=n?h(577,"Justification: {1}",t.displayName,n):void 0;return await this._extHostAuthentication.getSession(e,s,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0}catch{return!1}}_isUsingAuth(e,t){return!!t.auth&&!ot.equals(t.extension,e)}async _fakeAuthPopulate(e){if(e.auth)for(const t of this._languageAccessInformationExtensions)try{await this._getAuthAccess(t,{identifier:e.extension,displayName:""},void 0,!0)}catch(n){this._logService.error("Fake Auth request failed"),this._logService.error(n)}}async _computeTokenLength(e,t,n){if(!this._allLanguageModelData.get(e))throw Fi.NotFound(`Language model '${e}' is unknown.`);const s=yn.find(this._languageModels.values(),o=>o.languageModelId===e);return s?s.provider.provideTokenCount(t,n):this._proxy.$countTokens(e,typeof t=="string"?t:uc.from(t),n)}$updateModelAccesslist(e){const t=new Array;for(const{from:n,to:r,enabled:s}of e){const o=this._modelAccessList.get(n)??new Uo;if(o.has(r)!==s){s?o.add(r):o.delete(r),this._modelAccessList.set(n,o);const l={from:n,to:r};t.push(l),this._onDidChangeModelAccess.fire(l)}}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);const t=this,n=Ht.signal(Ht.filter(this._onDidChangeModelAccess.event,s=>ot.equals(s.from,e.identifier))),r=Ht.signal(this._onDidChangeProviders.event);return{get onDidChange(){return Ht.any(n,r)},canSendRequest(s){let o;e:for(const[l,c]of t._allLanguageModelData)for(const u of c.apiObjects.values())if(u===s){o=c.metadata;break e}if(!o)return;if(!t._isUsingAuth(e.identifier,o))return!0;const a=t._modelAccessList.get(e.identifier);if(a)return a.has(o.extension)}}}},sb=Pa,Pa._idPool=1,Pa);ab=sb=B([O(0,it),O(1,rt),O(2,nb)],ab);function oh(i,e=cn){return aI(i,e)?i.charAt(0).toUpperCase()+i.slice(1):i}function VA(i,e){return i.replace(/^~($|\/|\\)/,`${e}$1`)}var uD;(function(i){i[i.TEXT=0]="TEXT",i[i.VARIABLE=1]="VARIABLE",i[i.SEPARATOR=2]="SEPARATOR"})(uD||(uD={}));class cm{constructor(e){const t=ux(e);this._defaultValue=t,this._asciiMap=cm._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const n=ux(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}var dD;(function(i){i[i.False=0]="False",i[i.True=1]="True"})(dD||(dD={}));var vr;(function(i){i[i.Regular=0]="Regular",i[i.Whitespace=1]="Whitespace",i[i.WordSeparator=2]="WordSeparator"})(vr||(vr={}));class zA extends cm{constructor(e,t){super(vr.Regular),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let n=0,r=e.length;n<r;n++)this.set(e.charCodeAt(n),vr.WordSeparator);this.set(P.Space,vr.Whitespace),this.set(P.Tab,vr.Whitespace)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(const r of this._getIntlSegmenterWordsOnLine(e)){if(r.index>t)break;n=r}return n}findNextIntlWordAtOrAfterOffset(e,t){for(const n of this._getIntlSegmenterWordsOnLine(e))if(!(n.index<t))return n;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}}const hD=new A1(10);function qA(i,e){const t=`${i}/${e.join(",")}`;let n=hD.get(t);return n||(n=new zA(i,e),hD.set(t,n)),n}class fD{constructor(e,t,n,r){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=r}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=pD(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=HC(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new pP(t,this.wordSeparators?qA(this.wordSeparators,[]):null,n?this.searchString:null)}}function pD(i){if(!i||i.length===0)return!1;for(let e=0,t=i.length;e<t;e++){const n=i.charCodeAt(e);if(n===P.LineFeed)return!0;if(n===P.Backslash){if(e++,e>=t)break;const r=i.charCodeAt(e);if(r===P.n||r===P.r||r===P.W)return!0}}return!1}function gD(i,e,t){if(!t)return new D_(i,null);const n=[];for(let r=0,s=e.length;r<s;r++)n[r]=e[r];return new D_(i,n)}function jA(i,e,t,n,r){if(n===0)return!0;const s=e.charCodeAt(n-1);if(i.get(s)!==vr.Regular||s===P.CarriageReturn||s===P.LineFeed)return!0;if(r>0){const o=e.charCodeAt(n);if(i.get(o)!==vr.Regular)return!0}return!1}function GA(i,e,t,n,r){if(n+r===t)return!0;const s=e.charCodeAt(n+r);if(i.get(s)!==vr.Regular||s===P.CarriageReturn||s===P.LineFeed)return!0;if(r>0){const o=e.charCodeAt(n+r-1);if(i.get(o)!==vr.Regular)return!0}return!1}function mD(i,e,t,n,r){return jA(i,e,t,n,r)&&GA(i,e,t,n,r)}class QA{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;const r=n.index,s=n[0].length;if(r===this._prevMatchStartIndex&&s===this._prevMatchLength){if(s===0){wx(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=r,this._prevMatchLength=s,!this._wordSeparators||mD(this._wordSeparators,e,t,r,s))return n}while(n);return null}}const _D=ke("contextService"),JA=ke("editorGroupsService"),XA=ke("pathService");let vD=class{constructor(e,t,n,r,s){this.configurationService=e,this.workspaceContextService=t,this.editorGroupsService=n,this.logService=r,this.pathService=s}text(e,t,n={}){e=this.getContentPattern(e,n);const r=this.configurationService.getValue(),s=t&&t.some(a=>!this.configurationService.getValue({resource:a}).search.useRipgrep);return{...this.commonQuery(t==null?void 0:t.map(l2),n),type:fc.Text,contentPattern:e,previewOptions:n.previewOptions,maxFileSize:n.maxFileSize,usePCRE2:r.search.usePCRE2||s||!1,beforeContext:n.beforeContext,afterContext:n.afterContext,userDisabledExcludesAndIgnoreFiles:n.disregardExcludeSettings&&n.disregardIgnoreFiles}}getContentPattern(e,t){var s,o,a,l;const n=this.configurationService.getValue();e.isRegExp&&(e.pattern=e.pattern.replace(/\r?\n/g,"\\n"));const r={...e,wordSeparators:n.editor.wordSeparators};return this.isCaseSensitive(e,t)&&(r.isCaseSensitive=!0),this.isMultiline(e)&&(r.isMultiline=!0),(s=t.notebookSearchConfig)!=null&&s.includeMarkupInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownInput=t.notebookSearchConfig.includeMarkupInput),(o=t.notebookSearchConfig)!=null&&o.includeMarkupPreview&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownPreview=t.notebookSearchConfig.includeMarkupPreview),(a=t.notebookSearchConfig)!=null&&a.includeCodeInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellInput=t.notebookSearchConfig.includeCodeInput),(l=t.notebookSearchConfig)!=null&&l.includeOutput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellOutput=t.notebookSearchConfig.includeOutput),r}file(e,t={}){return{...this.commonQuery(e,t),type:fc.File,filePattern:t.filePattern?t.filePattern.trim():t.filePattern,exists:t.exists,sortByScore:t.sortByScore,cacheKey:t.cacheKey,shouldGlobMatchFilePattern:t.shouldGlobSearch}}handleIncludeExclude(e,t){return e?(e=Array.isArray(e)?e.map(um):um(e),t?this.parseSearchPaths(e):{pattern:lb(...Array.isArray(e)?e:[e])}):{}}commonQuery(e=[],t={}){const n=this.handleIncludeExclude(t.includePattern,t.expandPatterns),r=this.handleIncludeExclude(t.excludePattern,t.expandPatterns),s=e.length>1,o=(n.searchPaths&&n.searchPaths.length?n.searchPaths.map(c=>this.getFolderQueryForSearchPath(c,t,r)):e.map(c=>this.getFolderQueryForRoot(c,t,r,s))).filter(c=>!!c),a={_reason:t._reason,folderQueries:o,usingSearchPaths:!!(n.searchPaths&&n.searchPaths.length),extraFileResources:t.extraFileResources,excludePattern:r.pattern,includePattern:n.pattern,onlyOpenEditors:t.onlyOpenEditors,maxResults:t.maxResults};if(t.onlyOpenEditors){const c=Ti(this.editorGroupsService.groups.flatMap(f=>f.editors.map(p=>p.resource)));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(c));const u=c.filter(f=>P4(a,f.fsPath)),d=this.commonQueryFromFileList(u);return this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(d)),{...a,...d}}const l=t.extraFileResources&&t.extraFileResources.filter(c=>P4(a,c.fsPath));return a.extraFileResources=l&&l.length?l:void 0,a}commonQueryFromFileList(e){const t=[],n=new $t,r={};let s=!1;return e.forEach(o=>{var l;if(o.scheme===le.walkThrough)return;if(mI(o)){const c=((l=this.workspaceContextService.getWorkspaceFolder(o))==null?void 0:l.uri)??o.with({path:vo(o.fsPath)});let u=n.get(c);u||(s=!0,u={folder:c,includePattern:{}},t.push(u),n.set(c,u));const d=bu(c.fsPath,o.fsPath);al(u.includePattern)[d.replace(/\\/g,"/")]=!0}else o.fsPath&&(s=!0,r[o.fsPath]=!0)}),{folderQueries:t,includePattern:r,usingSearchPaths:!0,excludePattern:s?void 0:{"**/*":!0}}}isCaseSensitive(e,t){if(t.isSmartCase){if(e.isRegExp){if(Ex(e.pattern,!0))return!0}else if(Ex(e.pattern))return!0}return!!e.isCaseSensitive}isMultiline(e){return e.isMultiline||e.isRegExp&&pD(e.pattern)||e.pattern.indexOf(`
`)>=0?!0:!!e.isMultiline}parseSearchPaths(e){const t=d=>z1(d)||/^\.\.?([\/\\]|$)/.test(d),r=(Array.isArray(e)?e:KA(e)).map(d=>{const f=this.pathService.resolvedUserHome;return f?VA(d,f.scheme===le.file?f.fsPath:f.path):d}),s=Ty(r,d=>t(d)?"searchPaths":"exprSegments"),o=(s.exprSegments||[]).map(d=>hx(d,"/")).map(d=>hx(d,"\\")).map(d=>(d[0]==="."&&(d="*"+d),ZA(d))),a={},l=this.expandSearchPathPatterns(s.searchPaths||[]);l&&l.length&&(a.searchPaths=l);const c=o.flat(),u=lb(...c);return u&&(a.pattern=u),a}getExcludesForFolder(e,t){return t.disregardExcludeSettings?void 0:nA(e,!t.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length)return[];const t=e.flatMap(r=>{let{pathPortion:s,globPortion:o}=YA(r);return o&&(o=cb(o)),this.expandOneSearchPath(s).flatMap(l=>this.resolveOneSearchPathPattern(l,o))}),n=new Map;return t.forEach(r=>{const s=r.searchPath.toString(),o=n.get(s);o?r.pattern&&(o.pattern=o.pattern||{},o.pattern[r.pattern]=!0):n.set(s,{searchPath:r.searchPath,pattern:r.pattern?lb(r.pattern):void 0})}),Array.from(n.values())}expandOneSearchPath(e){if(z1(e)){const t=this.workspaceContextService.getWorkspace().folders;return t[0]&&t[0].uri.scheme!==le.file?[{searchPath:t[0].uri.with({path:e})}]:[{searchPath:y.file(nl(e))}]}if(this.workspaceContextService.getWorkbenchState()===Nf.FOLDER){const t=this.workspaceContextService.getWorkspace().folders[0].uri;if(e=um(e),e.startsWith("../")||e===".."){const r=tt.resolve(t.path,e);return[{searchPath:t.with({path:r})}]}const n=cb(e);return[{searchPath:t,pattern:n}]}else{if(e==="./"||e===".\\")return[];{const t=e.replace(/^\.[\/\\]/,""),r=this.workspaceContextService.getWorkspace().folders.map(s=>{const o=t.match(new RegExp(`^${wo(s.name)}(?:/(.*)|$)`));return o?{match:o,folder:s}:null}).filter(yo);if(r.length)return r.map(s=>{const o=s.match[1];return{searchPath:s.folder.uri,pattern:o&&cb(o)}});{const s=e.match(/\.[\/\\](.+)[\/\\]?/),o=s?s[1]:e,a=h(4562,"Workspace folder does not exist: {0}",o);throw new Error(a)}}}}resolveOneSearchPathPattern(e,t){const n=e.pattern&&t?`${e.pattern}/${t}`:e.pattern||t,r=[{searchPath:e.searchPath,pattern:n}];return n&&!n.endsWith("**")&&r.push({searchPath:e.searchPath,pattern:n+"/**"}),r}getFolderQueryForSearchPath(e,t,n){const r=this.getFolderQueryForRoot(l2(e.searchPath),t,n,!1);return r?{...r,includePattern:e.pattern}:null}getFolderQueryForRoot(e,t,n,r){var d,f,p,b;let s;const o=y.isUri(e)?e:e.uri;if(n.searchPaths){const w=n.searchPaths.filter(v=>Nx(v.searchPath,o))[0];if(w&&!w.pattern)return null;w&&(s=w.pattern)}const a=this.configurationService.getValue({resource:o}),c={...this.getExcludesForFolder(a,t)||{},...s||{}},u=y.isUri(e)?xo(e):e.name;return{folder:o,folderName:r?u:void 0,excludePattern:Object.keys(c).length>0?c:void 0,fileEncoding:a.files&&a.files.encoding,disregardIgnoreFiles:typeof t.disregardIgnoreFiles=="boolean"?t.disregardIgnoreFiles:!((d=a.search)!=null&&d.useIgnoreFiles),disregardGlobalIgnoreFiles:typeof t.disregardGlobalIgnoreFiles=="boolean"?t.disregardGlobalIgnoreFiles:!((f=a.search)!=null&&f.useGlobalIgnoreFiles),disregardParentIgnoreFiles:typeof t.disregardParentIgnoreFiles=="boolean"?t.disregardParentIgnoreFiles:!((p=a.search)!=null&&p.useParentIgnoreFiles),ignoreSymlinks:typeof t.ignoreSymlinks=="boolean"?t.ignoreSymlinks:!((b=a.search)!=null&&b.followSymlinks)}}};vD=B([O(0,am),O(1,_D),O(2,JA),O(3,rt),O(4,XA)],vD);function YA(i){const e=i.match(/[\*\{\}\(\)\[\]\?]/);if(e){const t=e.index,n=i.substr(0,t).match(/[/|\\][^/\\]*$/);if(n){let r=i.substr(0,n.index);return r.match(/[/\\]/)||(r+="/"),{pathPortion:r,globPortion:i.substr((n.index||0)+1)}}}return{pathPortion:i}}function lb(...i){return i.length?i.reduce((e,t)=>(e[t]=!0,e),Object.create(null)):void 0}function KA(i){return q_(i,",").map(e=>e.trim()).filter(e=>!!e.length)}function ZA(i){return[`**/${i}/**`,`**/${i}`].map(t=>t.replace(/\*\*\/\*\*/g,"**"))}function um(i){return i.replace(/\\/g,"/")}function cb(i){return um(i).replace(/^\.\//,"").replace(/\/+$/g,"")}ke("searchService");const e6=7e3;function t6(i,e){const t=e.activationEvents;if(!t)return Promise.resolve(void 0);const n=[],r=[];for(const u of t)if(/^workspaceContains:/.test(u)){const d=u.substr(18);d.indexOf("*")>=0||d.indexOf("?")>=0||i.forceUsingSearch?r.push(d):n.push(d)}if(n.length===0&&r.length===0)return Promise.resolve(void 0);const{promise:s,resolve:o}=yI(),a=u=>o({activationEvent:u}),l=Promise.all(n.map(u=>i6(i,u,a))).then(()=>{}),c=n6(i,e.identifier,r,a);return Promise.all([l,c]).then(()=>{o(void 0)}),s}async function i6(i,e,t){for(const n of i.folders)if(await i.exists(Li(y.revive(n),e))){t(`workspaceContains:${e}`);return}}async function n6(i,e,t,n){if(t.length===0)return Promise.resolve(void 0);const r=new Qt,s=i.checkExists(i.folders,t,r.token),o=setTimeout(async()=>{r.cancel(),i.logService.info(`Not activating extension '${e.value}': Timed out while searching for 'workspaceContains' pattern ${t.join(",")}`)},e6);let a=!1;try{a=await s}catch(l){uo(l)||ln(l)}r.dispose(),clearTimeout(o),a&&n(`workspaceContains:${t.join(",")}`)}class wD{constructor(e){this._onDidChangePassword=new L,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(Z.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,n){return this._proxy.$setPassword(e,t,n)}delete(e,t){return this._proxy.$deletePassword(e,t)}}const ub=ke("IExtHostSecretState");class r6{constructor(e,t){me(this,Zs);this.disposables=new Le,this._id=ot.toKey(e.identifier),te(this,Zs,t),this.onDidChange=Ht.map(Ht.filter(I(this,Zs).onDidChangePassword,n=>n.extensionId===this._id),n=>({key:n.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return I(this,Zs).get(this._id,e)}store(e,t){return I(this,Zs).store(this._id,e,t)}delete(e){return I(this,Zs).delete(this._id,e)}}Zs=new WeakMap;let db=class{constructor(e,t,n){this.logService=n,this.bundleCache=new Map,this._proxy=t.getProxy(Z.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===go}getMessage(e,t){var l;const{message:n,args:r,comment:s}=t;if(this.isDefaultLanguage)return dx(n,r??{});let o=n;s&&s.length>0&&(o+=`/${Array.isArray(s)?s.join(""):s}`);const a=(l=this.bundleCache.get(e))==null?void 0:l.contents[o];return a||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),dx(a??n,r??{})}getBundle(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.contents}getBundleUri(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.uri}async initializeLocalizedMessages(e){var r;if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin||this.bundleCache.has(e.identifier.value))return;let t;const n=await this.getBundleLocation(e);if(!n){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const s=await this._proxy.$fetchBundleContents(n),o=JSON.parse(s);t=e.isBuiltin?(r=o.contents)==null?void 0:r.bundle:o}catch(s){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${n}: ${s.message}`);return}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:n})}async getBundleLocation(e){if(e.isBuiltin){const t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return y.revive(t)}return e.l10n?y.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};db=B([O(0,Ei),O(1,it),O(2,rt)],db);const hb=ke("IExtHostLocalizationService"),fb=ke("IExtHostManagedSockets");let pb=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(Z.MainThreadManagedSockets)}setFactory(e,t){for(const n of this._managedRemoteSockets.values())n.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new s6(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw new Error(`No socket factory with id ${e}`);const t=++this._remoteSocketIdCounter,n=await this._factory.makeConnection(),r=new Le;return this._managedRemoteSockets.set(t,new o6(t,n,r)),r.add(Me(()=>this._managedRemoteSockets.delete(t))),r.add(n.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(t),r.dispose()})),r.add(n.onDidClose(s=>{this._proxy.$onDidManagedSocketClose(t,(s==null?void 0:s.stack)??(s==null?void 0:s.message)),r.dispose()})),r.add(n.onDidReceiveMessage(s=>this._proxy.$onDidManagedSocketHaveData(t,De.wrap(s)))),t}$remoteSocketWrite(e,t){var n;(n=this._managedRemoteSockets.get(e))==null||n.actual.send(t.buffer)}$remoteSocketEnd(e){const t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){var t,n,r;await((r=(t=this._managedRemoteSockets.get(e))==null?void 0:(n=t.actual).drain)==null?void 0:r.call(n))}};pb=B([O(0,it)],pb);class s6{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}}class o6 extends Re{constructor(e,t,n){super(),this.socketId=e,this.actual=t,this._register(n)}}var gb;const bD=ke("IHostUtils");let mb=gb=class extends Re{constructor(e,t,n,r,s,o,a,l,c,u,d,f,p){super(),this._extHostManagedSockets=f,this._extHostLanguageModels=p,this._onDidChangeRemoteConnectionData=this._register(new L),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._realPathCache=new Map,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=n,this._initData=a,this._extHostWorkspace=r,this._extHostConfiguration=s,this._logService=o,this._extHostTunnelService=c,this._extHostTerminalService=u,this._extHostLocalizationService=d,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(Z.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(Z.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(Z.MainThreadExtensionService),this._almostReadyToRunExtensions=new rr,this._readyToStartExtensionHost=new rr,this._readyToRunExtensions=new rr,this._eagerExtensionsActivated=new rr,this._activationEventsReader=new l6(this._initData.extensions.activationEvents),this._globalRegistry=new ca(this._activationEventsReader,this._initData.extensions.allExtensions);const b=new Uo(this._initData.extensions.myExtensions);this._myRegistry=new ca(this._activationEventsReader,ED(this._globalRegistry,b)),mo&&(this._logService.info(`Creating extension host with the following global extensions: ${yc(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${yc(this._myRegistry)}`)),this._storage=new $4(this._extHostContext,this._logService),this._secretState=new wD(this._extHostContext),this._storagePath=l,this._instaService=this._store.add(e.createChild(new a_([Bw,this._storage],[ub,this._secretState]))),this._activator=this._register(new Uw(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(w,v,S)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(w,cu(v),S)},actualActivateExtension:async(w,v)=>{if(ca.isHostExtension(w,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(w,v),new EA;const S=this._myRegistry.getExtensionDescription(w);return this._activateExtension(S,v)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),Ui("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){ln(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{e=this._myRegistry.getAllExtensionDescriptions().map(s=>s.identifier).filter(s=>this.isActivated(s)).map(s=>this._deactivate(s))}catch{}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),wu&&Za(r=>{this._logService.error(r)}),this._extHostContext.dispose();const n=this._deactivateAll();Promise.race([Or(5e3),n]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)})}isActivated(e){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(e):!1}async getExtension(e){const t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new ot(t.identifier.value),extensionLocation:y.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then(()=>{const n=this._activator.getActivatedExtension(e);if(n.activationFailed)return Promise.reject(n.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch{return null}}async _realPathExtensionUri(e){if(e.scheme===le.file&&this._hostUtils.fsRealpath){const t=e.fsPath;this._realPathCache.has(t)||this._realPathCache.set(t,this._hostUtils.fsRealpath(t));const n=await this._realPathCache.get(t);return y.file(n)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>new a6(e))),this._extensionPathIndex}async _createExtensionPathIndex(e){const t=Fr.forUris(n=>pI.ignorePathCasing(n));return await Promise.all(e.map(async n=>{if(this._getEntryPoint(n)){const r=await this._realPathExtensionUri(n.extensionLocation);t.set(r,n)}})),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(e))return t;const n=this._activator.getActivatedExtension(e);if(!n)return t;try{typeof n.module.deactivate=="function"&&(t=Promise.resolve(n.module.deactivate()).then(void 0,r=>(this._logService.error(r),Promise.resolve(void 0))))}catch(r){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(r)}try{n.disposable.dispose()}catch(r){this._logService.error(`An error occurred when disposing the subscriptions for extension '${e.value}':`),this._logService.error(r)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then(n=>{const r=n.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,r.codeLoadingTime,r.activateCallTime,r.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,"success",r),n},n=>{throw this._logExtensionActivationTimes(e,t,"failure"),n})}_logExtensionActivationTimes(e,t,n,r){const s=xD(e,t);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...s,...r||{},outcome:n})}_doActivateExtension(e,t){const n=xD(e,t);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",n);const r=this._getEntryPoint(e);if(!r)return Promise.resolve(new xA(mc.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value!==t.extensionId.value?`, root cause: ${t.extensionId.value}`:""}`),this._logService.flush();const s=new Le,o=new M4(t.startup);return Promise.all([this._loadCommonJSModule(e,Li(e.extensionLocation,r),o),this._loadExtensionContext(e,s)]).then(a=>(Ui(`code/extHost/willActivateExtension/${e.identifier.value}`),gb._callActivate(this._logService,e.identifier,a[0],a[1],s,o))).then(a=>(Ui(`code/extHost/didActivateExtension/${e.identifier.value}`),a))}_loadExtensionContext(e,t){const n=this._extHostLanguageModels.createLanguageModelAccessInformation(e),r=t.add(new SA(e,this._storage)),s=t.add(new U4(e.identifier.value,!1,this._storage)),o=t.add(new r6(e,this._secretState)),a=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?Kl.Test:Kl.Development:Kl.Production,l=this._initData.remote.isRemote?na.Workspace:na.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([r.whenReady,s.whenReady,this._storagePath.whenReady]).then(()=>{var p;const c=this;let u,d;const f=ii(e,"ipc")?(p=this._initData.messagePorts)==null?void 0:p.get(ot.toKey(e.identifier)):void 0;return Object.freeze({globalState:r,workspaceState:s,secrets:o,subscriptions:[],get languageModelAccessInformation(){return n},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(b){return Zy(e.extensionLocation.fsPath,b)},get storagePath(){var b;return(b=c._storagePath.workspaceValue(e))==null?void 0:b.fsPath},get globalStoragePath(){return c._storagePath.globalValue(e).fsPath},get logPath(){return Zy(c._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return y.joinPath(c._initData.logsLocation,e.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(e)},get globalStorageUri(){return c._storagePath.globalValue(e)},get extensionMode(){return a},get extension(){return u===void 0&&(u=new ah(c,e.identifier,e,l,!1)),u},get extensionRuntime(){return M(e,"extensionRuntime"),c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!d){if(!f)return;const b=Ht.buffer(Ht.fromDOMEventEmitter(f,"message",w=>w.data));f.start(),d={onDidReceiveMessage:b,postMessage:f.postMessage.bind(f)}}return d}})})}static _callActivate(e,t,n,r,s,o){return n=n||{activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,n,r,o).then(a=>new rm(!1,null,o.build(),n,a,Me(()=>{s.dispose(),Ar(r.subscriptions)})))}static _callActivateOptional(e,t,n,r,s){if(typeof n.activate=="function")try{s.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);const o=typeof global=="object"?global:self,a=n.activate.apply(o,[r]);return s.activateCallStop(),s.activateResolveStart(),Promise.resolve(a).then(l=>(s.activateResolveStop(),l))}catch(o){return Promise.reject(o)}else return Promise.resolve(n)}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,n=>{this._logService.error(n)})}_activateAllStartupFinishedDeferred(e,t=0){const r=Date.now();jy(()=>{for(let s=t;s<e.length;s+=1){const o=e[s];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-r>50){this._activateAllStartupFinishedDeferred(e,s);break}else this._activateOneStartupFinished(o,a)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(aC()),this._extHostConfiguration.getConfigProvider().then(e=>{const t=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),n=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(n);else for(const r of n)if(r.activationEvents)for(const s of r.activationEvents)s==="onStartupFinished"&&this._activateOneStartupFinished(r,s)})}_handleEagerExtensions(){const e=this._activateByEvent("*",!0).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],n=this._handleWorkspaceContainsEagerExtensions(t),r=this._handleRemoteResolverEagerExtensions(),s=Promise.all([r,e,n]).then(()=>{});return Promise.race([s,Or(1e4)]).then(()=>{this._activateAllStartupFinished()}),s}_handleWorkspaceContainsEagerExtensions(e){return e.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(t=>this._handleWorkspaceContainsEagerExtension(e,t))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;const n=!this._initData.remote.isRemote&&!!this._initData.remote.authority,r={logService:this._logService,folders:e.map(o=>o.uri),forceUsingSearch:n||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,l)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,l)},s=await t6(r,t);if(s)return this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:s.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw new Error(h(442,"Cannot load test runner."));const n=await this._loadCommonJSModule(null,t,new M4(!1));if(!n||typeof n.run!="function")throw new Error(h(443,"Path {0} does not point to a valid extension test runner.",t.toString()));return new Promise((r,s)=>{const o=(c,u)=>{c?(mo&&this._logService.error("Test runner called back with error",c),s(c)):(mo&&(u?this._logService.info(`Test runner called back with ${u} failures.`):this._logService.info("Test runner called back with successful outcome.")),r(typeof u=="number"&&u>0?1:0))},a=On(t),l=n.run(a,o);l&&l.then&&l.then(()=>{mo&&this._logService.info("Test runner finished successfully."),r(0)}).catch(c=>{mo&&this._logService.error("Test runner finished with error",c),s(c instanceof Error&&c.stack?c.stack:String(c))})})}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),Or(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")})}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,Me(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){var n;const{resolver:t}=await this._activateAndGetResolver(e);return(n=t==null?void 0:t.resolveExecServer)==null?void 0:n.call(t,e,{resolveAttempt:0})}async _activateAndGetResolver(e){const t=e.indexOf("+");if(t===-1)throw new pr("Not an authority that can be resolved!",jr.InvalidAuthority);const n=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${n}`,!1),{authorityPrefix:n,resolver:this._resolvers[n]}}async $resolveAuthority(e,t){var k;const n=Rr.create(!1),r=()=>`[resolveAuthority(${QS(e)},${t})][${n.elapsed()}ms] `,s=C=>this._logService.info(`${r()}${C}`),o=C=>this._logService.warn(`${r()}${C}`),a=(C,N=void 0)=>this._logService.error(`${r()}${C}`,N),l=C=>{if(C instanceof pr)return{type:"error",error:{code:C._code,message:C._message,detail:C._detail}};throw C},c=async C=>{s(`activating resolver for ${C}...`);const{resolver:N,authorityPrefix:A}=await this._activateAndGetResolver(C);if(!N)throw a(`no resolver for ${A}`),new pr(`No remote extension installed to resolve ${A}.`,jr.NoResolverFound);return{resolver:N,authorityPrefix:A,remoteAuthority:C}},u=e.split(/@|%40/g).reverse();s(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(c)).catch(async C=>{if(!(C instanceof pr)||C._code!==jr.InvalidAuthority)throw C;return o(`resolving nested authorities failed: ${C.message}`),[await c(e)]})}catch(C){return l(C)}const f=new AI;f.cancelAndSet(()=>s("waiting..."),1e3);let p,b;for(const[C,{authorityPrefix:N,resolver:A,remoteAuthority:V}]of d.entries())try{if(C===d.length-1)s("invoking final resolve()..."),Ui(`code/extHost/willResolveAuthority/${N}`),p=await A.resolve(V,{resolveAttempt:t,execServer:b}),Ui(`code/extHost/didResolveAuthorityOK/${N}`),s("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(A,Tp.isManagedResolvedAuthority(p)?p:void 0));else{if(s(`invoking resolveExecServer() for ${V}`),Ui(`code/extHost/willResolveExecServer/${N}`),b=await((k=A.resolveExecServer)==null?void 0:k.call(A,V,{resolveAttempt:t,execServer:b})),!b)throw new pr(`Exec server was not available for ${V}`,jr.NoResolverFound);Ui(`code/extHost/didResolveExecServerOK/${N}`)}}catch(ae){return Ui(`code/extHost/didResolveAuthorityError/${N}`),a("returned an error",ae),f.dispose(),l(ae)}f.dispose();const w={environmentTunnels:p.environmentTunnels,features:p.tunnelFeatures?{elevation:p.tunnelFeatures.elevation,privacyOptions:p.tunnelFeatures.privacyOptions,protocol:p.tunnelFeatures.protocol===void 0?!0:p.tunnelFeatures.protocol}:void 0},v={extensionHostEnv:p.extensionHostEnv,isTrusted:p.isTrusted,authenticationSession:p.authenticationSessionForInitializingExtensions?{id:p.authenticationSessionForInitializingExtensions.id,providerId:p.authenticationSessionForInitializingExtensions.providerId}:void 0};s(`returned ${Tp.isManagedResolvedAuthority(p)?"managed authority":`${p.host}:${p.port}`}`);let S;if(Tp.isManagedResolvedAuthority(p)){const C=t;this._extHostManagedSockets.setFactory(C,p.makeConnection),S={authority:e,connectTo:new y8(C),connectionToken:p.connectionToken}}else S={authority:e,connectTo:new x8(p.host,p.port),connectionToken:p.connectionToken};return{type:"ok",value:{authority:S,options:v,tunnelInformation:w}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${QS(e)})`);const{resolver:n}=await this._activateAndGetResolver(e);if(!n)return null;const r=y.revive(t);if(typeof n.getCanonicalURI>"u")return r;const s=await xi(()=>n.getCanonicalURI(r));return s||r}async $startExtensionHost(e){e.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:n}=yD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(n);return(await this.getExtensionPathIndex()).setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(n),mo&&(this._logService.info(`$startExtensionHost: global extensions: ${yc(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${yc(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return t===H_.Immediate?this._almostReadyToRunExtensions.wait().then(n=>this._activateByEvent(e,!1)):this._readyToRunExtensions.wait().then(n=>this._activateByEvent(e,!1))}async $activate(e,t){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(e)?(await this._activateById(e,t),!0):!1}async $deltaExtensions(e){e.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:n}=yD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(n);return(await this.getExtensionPathIndex()).setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(n),mo&&(this._logService.info(`$deltaExtensions: global extensions: ${yc(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${yc(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const t=De.alloc(e),n=Math.random()%256;for(let r=0;r<e;r++)t.writeUInt8(n,r);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}};mb=gb=B([O(0,kf),O(1,bD),O(2,it),O(3,ts),O(4,is),O(5,rt),O(6,Ei),O(7,Vw),O(8,Qw),O(9,bc),O(10,hb),O(11,fb),O(12,ob)],mb);function yD(i,e,t,n){i.addActivationEvents(n.addActivationEvents);const r=new ca(i,e.getAllExtensionDescriptions());r.deltaExtensions(n.toAdd,n.toRemove);const s=new Uo(t.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of n.myToRemove)s.delete(a);for(const a of n.myToAdd)s.add(a);const o=ED(r,s);return{globalRegistry:r,myExtensions:o}}function xD(i,e){return{id:i.identifier.value,name:i.name,extensionVersion:i.version,publisherDisplayName:i.publisher,activationEvents:i.activationEvents?i.activationEvents.join(","):null,isBuiltin:i.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value}}function yc(i){return i.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const js=ke("IExtHostExtensionService");class ah{constructor(e,t,n,r,s){me(this,Ta);me(this,Hh);me(this,Aa);te(this,Ta,e),te(this,Hh,t),te(this,Aa,n.identifier),this.id=n.identifier.value,this.extensionUri=n.extensionLocation,this.extensionPath=nl(On(n.extensionLocation)),this.packageJSON=n,this.extensionKind=r,this.isFromDifferentExtensionHost=s}get isActive(){return I(this,Ta).isActivated(I(this,Aa))}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return I(this,Ta).getExtensionExports(I(this,Aa))}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await I(this,Ta).activateByIdWithErrors(I(this,Aa),{startup:!1,extensionId:I(this,Hh),activationEvent:"api"}),this.exports}}Ta=new WeakMap,Hh=new WeakMap,Aa=new WeakMap;function ED(i,e){return i.getAllExtensionDescriptions().filter(t=>e.has(t.identifier))}class a6{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class l6{constructor(e){this._map=new Vr,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}}class c6 extends Re{constructor(e,t=[]){super(),this.logger=new fT([e,...t]),this._register(e.onDidChangeLogLevel(n=>this.setLevel(n)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}}let _b=class extends c6{constructor(e,t,n){const r=n.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost",s=n.remote.isRemote?h(697,"Extension Host (Remote)"):e?h(698,"Extension Host (Worker)"):h(699,"Extension Host");super(t.createLogger(r,{name:s}))}};_b=B([O(1,hl),O(2,Ei)],_b);let dm=class extends pT{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map(n=>Ki(n))),this._proxy=e.getProxy(Z.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(y.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,n){return new u6(this._proxy,e,t,n)}};dm=B([O(0,it),O(1,Ei)],dm);class u6 extends JE{constructor(e,t,n,r){super((r==null?void 0:r.logLevel)==="always"),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(n),this.proxy.$createLogger(t,r).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){const n=[[e,t]];this.isLoggerCreated?this.doLog(n):this.buffer.push(...n)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}class SD{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(rt),r=e.get(it).getProxy(Z.MainThreadErrors);Za(s=>{t.error(s);const o=cu(s);r.$onUnexpectedError(o)})}static async installFullHandler(e){const t=e.get(rt),n=e.get(it),r=e.get(js),s=e.get(lm),o=n.getProxy(Z.MainThreadExtensionService),a=n.getProxy(Z.MainThreadErrors),l=await r.getExtensionPathIndex(),c=new WeakMap;function u(p,b){if(c.has(p))return c.get(p).stack;let w="",v,S;for(const C of b)w+=`
	at ${C.toString()}`,S=C.getFileName(),!v&&S&&(v=l.findSubstr(y.file(S)));const k=`${p.name||"Error"}: ${p.message||""}${w}`;return c.set(p,{extensionIdentifier:v==null?void 0:v.identifier,stack:k}),k}const d=Symbol("prepareStackTrace wrapped");let f=u;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return f},set(p){if(p===u||!p||p[d]){f=p||u;return}f=function(b,w){return u(b,w),p.call(Error,b,w)},Object.assign(f,{[d]:!0})}}),Za(p=>{t.error(p);const b=cu(p),w=c.get(p);if(!(w!=null&&w.extensionIdentifier)){a.$onUnexpectedError(b);return}o.$onExtensionRuntimeError(w.extensionIdentifier,b);const v=s.onExtensionError(w.extensionIdentifier,p);t.trace("forwarded error to extension?",v,w)})}}class vb{constructor(e,t,n,r,s){this._hostUtils=n,this._rpcProtocol=new o_(e,null,r),t=vb._transform(t,this._rpcProtocol);const o=new a_(...WI());o.set(Ei,{_serviceBrand:void 0,...t,messagePorts:s}),o.set(it,new qI(this._rpcProtocol)),o.set(If,new jI(r)),o.set(bD,n),o.set(rt,new sr(_b,[!0],!0)),o.set(hl,new sr(dm,[],!0));const a=new Cf(o,!0);wu&&a.invokeFunction(SD.installEarlyHandler),this._logService=a.invokeFunction(l=>l.get(rt)),Ui("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",t),this._extensionService=a.invokeFunction(l=>l.get(js)),this._extensionService.initialize(),wu&&a.invokeFunction(SD.installFullHandler)}async asBrowserUri(e){const t=this._rpcProtocol.getProxy(Z.MainThreadExtensionService);return y.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){return(await this._rpcProtocol.getProxy(Z.MainThreadExtensionService).$getAllStaticBrowserUris()).map(([t,n])=>[y.revive(t),y.revive(n)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach(r=>{r.extensionLocation=y.revive(t.transformIncomingURIs(r.extensionLocation))}),e.environment.appRoot=y.revive(t.transformIncomingURIs(e.environment.appRoot));const n=e.environment.extensionDevelopmentLocationURI;return n&&(e.environment.extensionDevelopmentLocationURI=n.map(r=>y.revive(t.transformIncomingURIs(r)))),e.environment.extensionTestsLocationURI=y.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=y.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=y.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.environment.extensionTelemetryLogResource=y.revive(t.transformIncomingURIs(e.environment.extensionTelemetryLogResource)),e.nlsBaseUrl=y.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=y.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}}const d6=(function(e){const t=n=>{globalThis.removeEventListener("message",t);const r=n.data;Object.defineProperties(globalThis,{postMessage:{value(s,o){r.postMessage(s,o)}},onmessage:{get(){return r.onmessage},set(s){r.onmessage=s}}}),r.addEventListener("message",s=>{globalThis.dispatchEvent(new MessageEvent("message",{data:s.data,ports:s.ports?[...s.ports]:void 0}))}),r.start(),globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}},importScripts(e)};globalThis.addEventListener("message",t)}).toString();class h6 extends EventTarget{constructor(e,t,n){super(),this.onmessage=null,this.onmessageerror=null,this.onerror=null;const r=`((${d6})('${t}'))`,s=new Blob([r],{type:"application/javascript"}),o=URL.createObjectURL(s),a=new MessageChannel,l=o,c={type:"_newWorker",id:l,port:a.port2,url:o,options:n};e(c,[a.port2]),this.postMessage=a.port1.postMessage.bind(a.port1),this.terminate=()=>{e({type:"_terminateWorker",id:l}),URL.revokeObjectURL(o),a.port1.close(),a.port2.close()},Object.defineProperties(this,{onmessage:{get(){return a.port1.onmessage},set(u){a.port1.onmessage=u}},onmessageerror:{get(){return a.port1.onmessageerror},set(u){a.port1.onmessageerror=u}}}),a.port1.addEventListener("messageerror",u=>{const d=new MessageEvent("messageerror",{data:u.data});this.dispatchEvent(d)}),a.port1.addEventListener("message",u=>{const d=new MessageEvent("message",{data:u.data});this.dispatchEvent(d)}),a.port1.start()}}new X("inOutput",!1),new X("activeLogOutput",!1),new X("activeLogOutput.levelSettable",!1),new X("activeLogOutput.level",""),new X("activeLogOutput.levelIsDefault",!1),new X("outputView.scrollLock",!1);var lh;(function(i){i[i.Append=1]="Append",i[i.Replace=2]="Replace",i[i.Clear=3]="Clear"})(lh||(lh={}));const f6={OutputChannels:"workbench.contributions.outputChannels"};class p6{constructor(){this.channels=new Map,this._onDidRegisterChannel=new L,this.onDidRegisterChannel=this._onDidRegisterChannel.event,this._onDidRemoveChannel=new L,this.onDidRemoveChannel=this._onDidRemoveChannel.event}registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){const e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}removeChannel(e){this.channels.delete(e),this._onDidRemoveChannel.fire(e)}}hi.add(f6.OutputChannels,new p6),new X("activeOutputChannel","");function g6(i){return i.getFullYear()+"-"+String(i.getMonth()+1).padStart(2,"0")+"-"+String(i.getDate()).padStart(2,"0")+"T"+String(i.getHours()).padStart(2,"0")+":"+String(i.getMinutes()).padStart(2,"0")+":"+String(i.getSeconds()).padStart(2,"0")+"."+(i.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}class DD extends JE{get disposed(){return this._disposed}constructor(e,t,n,r,s){super(),this.id=e,this.name=t,this.logger=n,this.proxy=r,this.extension=s,this.offset=0,this._disposed=!1,this.visible=!1,this.setLevel(n.getLevel()),this._register(n.onDidChangeLogLevel(o=>this.setLevel(o)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,lh.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,lh.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=De.fromString(t).byteLength,hT(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,lh.Append))}dispose(){super.dispose(),this._disposed||(this.proxy.$dispose(this.id),this._disposed=!0)}}class m6 extends DD{appendLine(e){this.append(e)}}let wb=class{constructor(e,t,n,r,s,o){this.initData=t,this.extHostFileSystem=n,this.extHostFileSystemInfo=r,this.loggerService=s,this.logService=o,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(Z.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${g6(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[t,n]of this.channels)n.visible=t===this.visibleChannelId}createOutputChannel(e,t,n){var c,u;if(e=e.trim(),!e)throw new Error("illegal argument `name`. must not be falsy");const r=typeof t=="object"&&t.log,s=Ge(t)?t:void 0;if(Ge(s)&&!s.trim())throw new Error("illegal argument `languageId`. must not be empty");let o;const a=(u=(c=this.initData.environment.extensionLogLevel)==null?void 0:c.find(([d])=>ot.equals(n.identifier,d)))==null?void 0:u[1];a&&(o=mT(a));const l=r?this.doCreateLogOutputChannel(e,o,n):this.doCreateOutputChannel(e,s,n);return l.then(d=>{this.channels.set(d.id,d),d.visible=d.id===this.visibleChannelId}),r?this.createExtHostLogOutputChannel(e,o??this.logService.getLevel(),l):this.createExtHostOutputChannel(e,l)}async doCreateOutputChannel(e,t,n){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation));const r=await this.outputDirectoryPromise,s=this.extHostFileSystemInfo.extUri.joinPath(r,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),o=this.loggerService.createLogger(s,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0}),a=await this.proxy.$register(e,s,t,n.identifier.value);return new DD(a,e,o,this.proxy,n)}async doCreateLogOutputChannel(e,t,n){const r=await this.createExtensionLogDirectory(n),s=e.replace(/[\\/:\*\?"<>\|]/g,""),o=this.extHostFileSystemInfo.extUri.joinPath(r,`${s}.log`),a=`${n.identifier.value}.${s}`,l=this.loggerService.createLogger(o,{id:a,name:e,logLevel:t,extensionId:n.identifier.value});return new m6(a,e,l,this.proxy,n)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){const n=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(n)}catch(r){if(Lf(r)!==Pe.FileExists)throw r}return n})())}return t}createExtHostOutputChannel(e,t){let n=!1;const r=()=>{if(n)throw new Error("Channel has been closed")};return{get name(){return e},append(s){r(),t.then(o=>o.append(s))},appendLine(s){r(),t.then(o=>o.appendLine(s))},clear(){r(),t.then(s=>s.clear())},replace(s){r(),t.then(o=>o.replace(s))},show(s,o){r(),t.then(a=>a.show(s,o))},hide(){r(),t.then(s=>s.hide())},dispose(){n=!0,t.then(s=>s.dispose())}}}createExtHostLogOutputChannel(e,t,n){const r=new Le,s=()=>{if(r.isDisposed)throw new Error("Channel has been closed")},o=r.add(new L);function a(l){t=l,o.fire(l)}return n.then(l=>{r.add(l),l.logLevel!==t&&a(l.logLevel),r.add(l.onDidChangeLogLevel(c=>a(c)))}),{...this.createExtHostOutputChannel(e,n),get logLevel(){return t},onDidChangeLogLevel:o.event,trace(l,...c){s(),n.then(u=>u.trace(l,...c))},debug(l,...c){s(),n.then(u=>u.debug(l,...c))},info(l,...c){s(),n.then(u=>u.info(l,...c))},warn(l,...c){s(),n.then(u=>u.warn(l,...c))},error(l,...c){s(),n.then(u=>u.error(l,...c))},dispose(){r.dispose()}}}};wb=B([O(0,it),O(1,Ei),O(2,om),O(3,pl),O(4,hl),O(5,rt)],wb);const kD=ke("IExtHostOutputService");var ch;let bb=(eo=class{constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(Z.MainThreadDecorations)}registerFileDecorationProvider(e,t){const n=ch._handlePool++;this._provider.set(n,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(n,t.identifier.value);const r=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(s=>{if(!s){this._proxy.$onDidChange(n,null);return}const o=fo(s);if(o.length<=ch._maxEventSize){this._proxy.$onDidChange(n,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",t.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:$C(u.path,"/")})),l=D5(a,(u,d)=>u.rank-d.rank||bo(u.uri.path,d.uri.path)),c=[];e:for(const u of l){let d;for(const f of u){const p=vo(f.uri.path);if(d!==p&&(d=p,c.push(f.uri)>=ch._maxEventSize))break e}}this._proxy.$onDidChange(n,c)});return new Qe(()=>{r==null||r.dispose(),this._proxy.$unregisterDecorationProvider(n),this._provider.delete(n)})}async $provideDecorations(e,t,n){if(!this._provider.has(e))return Object.create(null);const r=Object.create(null),{provider:s,extensionDescription:o}=this._provider.get(e);return await Promise.all(t.map(async a=>{try{const{uri:l,id:c}=a,u=await Promise.resolve(s.provideFileDecoration(y.revive(l),n));if(!u)return;try{Av.validate(u),u.badge&&typeof u.badge!="string"&&M(o,"codiconDecoration"),r[c]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${d}`)}}catch(l){this._logService.error(l)}})),r}},ch=eo,eo._handlePool=0,eo._maxEventSize=250,eo);bb=ch=B([O(0,it),O(1,rt)],bb);const CD=ke("IExtHostDecorations");class _6{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=ol(e);const n=this.values,r=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(n.length+s),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=ol(e),t=ol(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=ol(e),t=ol(t);const n=this.values,r=this.prefixSum;if(e>=n.length)return!1;const s=n.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(n.length-t),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=ol(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let n=t;n<=e;n++)this.prefixSum[n]=this.prefixSum[n-1]+this.values[n];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,n=this.values.length-1,r=0,s=0,o=0;for(;t<=n;)if(r=t+(n-t)/2|0,s=this.prefixSum[r],o=s-this.values[r],e<o)n=r-1;else if(e>=s)t=r+1;else break;return new v6(r,e-o)}}class v6{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class w6{constructor(e,t,n,r){this._uri=e,this._lines=t,this._eol=n,this._versionId=r,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const n of t)this._acceptDeleteRange(n.range),this._acceptInsertText(new pn(n.range.startLineNumber,n.range.startColumn),n.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,n=new Uint32Array(t);for(let r=0;r<t;r++)n[r]=this._lines[r].length+e;this._lineStarts=new _6(n)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const n=px(t);if(n.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}n[n.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]);const r=new Uint32Array(n.length-1);for(let s=1;s<n.length;s++)this._lines.splice(e.lineNumber+s-1,0,n[s]),r[s-1]=n[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,r)}}const yb=new Map;function b6(i,e){e?yb.set(i,e):yb.delete(i)}function y6(i){return yb.get(i)}class x6 extends w6{constructor(e,t,n,r,s,o,a){super(t,n,r,s),this._proxy=e,this._languageId=o,this._isDirty=a,this._isDisposed=!1}dispose(){Zi(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return Tr(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===le.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?qn.LF:qn.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,n){return e._getWordRangeAtPosition(t,n)},[Symbol.for("debug.description")](){return`TextDocument(${e._uri.toString()})`}}}return Object.freeze(this._document)}_acceptLanguageId(e){Zi(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){Zi(!this._isDisposed),this._isDirty=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const n=this._eol,r=t.start.line,s=t.end.line,o=[];o.push(this._lines[r].substring(t.start.character));for(let a=r+1;a<s;a++)o.push(this._lines[a]);return o.push(this._lines[s].substring(0,t.end.character)),o.join(n)}_lineAt(e){let t;if(e instanceof He?t=e.line:typeof e=="number"&&(t=e),typeof t!="number"||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new E6(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),n=this._lines[t.index].length;return new He(t.index,Math.min(t.remainder,n))}_validateRange(e){if(!(e instanceof Fe))throw new Error("Invalid argument");const t=this._validatePosition(e.start),n=this._validatePosition(e.end);return t===e.start&&n===e.end?e:new Fe(t.line,t.character,n.line,n.character)}_validatePosition(e){if(!(e instanceof He))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:n}=e,r=!1;if(t<0)t=0,n=0,r=!0;else if(t>=this._lines.length)t=this._lines.length-1,n=this._lines[t].length,r=!0;else{const s=this._lines[t].length;n<0?(n=0,r=!0):n>s&&(n=s,r=!0)}return r?new He(t,n):e}_getWordRangeAtPosition(e,t){const n=this._validatePosition(e);if(!t)t=y6(this._languageId);else if(fx(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const r=W2(n.character+1,H2(t),this._lines[n.line],0);if(r)return new Fe(n.line,r.startColumn-1,n.line,r.endColumn-1)}}class E6{constructor(e,t,n){this._line=e,this._text=t,this._isLastLine=n}get lineNumber(){return this._line}get text(){return this._text}get range(){return new Fe(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new Fe(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}class xb{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const e1=class e1{constructor(e,t,n){const r=e1._Keys.nextId();e.$registerTextEditorDecorationType(t.identifier,r,tw.from(n)),this.value=Object.freeze({key:r,dispose(){e.$removeTextEditorDecorationType(r)}})}};e1._Keys=new xb("TextEditorDecorationType");let Eb=e1;class S6{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let n=null;if(e instanceof He)n=new Fe(e,e);else if(e instanceof Fe)n=e;else throw new Error("Unrecognized location");this._pushEdit(n,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new Fe(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof Fe)t=e;else throw new Error("Unrecognized location");this._pushEdit(t,null,!0)}_pushEdit(e,t,n){const r=this._document.validateRange(e);this._collectedEdits.push({range:r,text:t,forceMoveMarkers:n})}setEndOfLine(e){if(this._throwIfFinalized(),e!==qn.LF&&e!==qn.CRLF)throw Ue("endOfLine");this._setEndOfLine=e}}class D6{constructor(e,t,n,r){this._proxy=e,this._id=t,this._accept(n),this._logService=r;const s=this;this.value={get tabSize(){return s._tabSize},set tabSize(o){s._setTabSize(o)},get indentSize(){return s._indentSize},set indentSize(o){s._setIndentSize(o)},get insertSpaces(){return s._insertSpaces},set insertSpaces(o){s._setInsertSpaces(o)},get cursorStyle(){return s._cursorStyle},set cursorStyle(o){s._setCursorStyle(o)},get lineNumbers(){return s._lineNumbers},set lineNumbers(o){s._setLineNumbers(o)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=sc.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(t!==null){if(typeof t=="number"){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(t!==null){if(typeof t=="number"){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e==="auto"?"auto":e==="false"?!1:!!e}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if(typeof t=="boolean"){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:sc.from(e)})))}assign(e){const t={};let n=!1;if(typeof e.tabSize<"u"){const r=this._validateTabSize(e.tabSize);r==="auto"?(n=!0,t.tabSize=r):typeof r=="number"&&this._tabSize!==r&&(this._tabSize=r,n=!0,t.tabSize=r)}if(typeof e.indentSize<"u"){const r=this._validateIndentSize(e.indentSize);r==="tabSize"?(n=!0,t.indentSize=r):typeof r=="number"&&this._originalIndentSize!==r&&(this._indentSize=r,this._originalIndentSize=r,n=!0,t.indentSize=r)}if(typeof e.insertSpaces<"u"){const r=this._validateInsertSpaces(e.insertSpaces);r==="auto"?(n=!0,t.insertSpaces=r):this._insertSpaces!==r&&(this._insertSpaces=r,n=!0,t.insertSpaces=r)}typeof e.cursorStyle<"u"&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,n=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,n=!0,t.lineNumbers=sc.from(e.lineNumbers)),n&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(n=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(n)})}}class k6{constructor(e,t,n,r,s,o,a,l){this.id=e,this._proxy=t,this._logService=n,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=s,this._options=new D6(this._proxy,this.id,o,n),this._visibleRanges=a,this._viewColumn=l;const c=this;this.value=Object.freeze({get document(){return r.value},set document(u){throw new ho("document")},get selection(){return c._selections&&c._selections[0]},set selection(u){if(!(u instanceof Qr))throw Ue("selection");c._selections=[u],c._trySetSelection()},get selections(){return c._selections},set selections(u){if(!Array.isArray(u)||u.some(d=>!(d instanceof Qr)))throw Ue("selections");c._selections=u,c._trySetSelection()},get visibleRanges(){return c._visibleRanges},set visibleRanges(u){throw new ho("visibleRanges")},get options(){return c._options.value},set options(u){c._disposed||c._options.assign(u)},get viewColumn(){return c._viewColumn},set viewColumn(u){throw new ho("viewColumn")},edit(u,d={undoStopBefore:!0,undoStopAfter:!0}){if(c._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const f=new S6(r.value,d);return u(f),c._applyEdit(f)},insertSnippet(u,d,f={undoStopBefore:!0,undoStopAfter:!0}){if(c._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let p;if(!d||Array.isArray(d)&&d.length===0)p=c._selections.map(b=>H.from(b));else if(d instanceof He){const{lineNumber:b,column:w}=nt.from(d);p=[{startLineNumber:b,startColumn:w,endLineNumber:b,endColumn:w}]}else if(d instanceof Fe)p=[H.from(d)];else{p=[];for(const b of d)if(b instanceof Fe)p.push(H.from(b));else{const{lineNumber:w,column:v}=nt.from(b);p.push({startLineNumber:w,startColumn:v,endLineNumber:w,endColumn:v})}}return t.$tryInsertSnippet(e,r.value.version,u.value,p,f)},setDecorations(u,d){const f=d.length===0;f&&!c._hasDecorationsForKey.has(u.key)||(f?c._hasDecorationsForKey.delete(u.key):c._hasDecorationsForKey.add(u.key),c._runOnProxy(()=>{if(w4(d))return t.$trySetDecorations(e,u.key,Q8(d));{const p=new Array(4*d.length);for(let b=0,w=d.length;b<w;b++){const v=d[b];p[4*b]=v.start.line+1,p[4*b+1]=v.start.character+1,p[4*b+2]=v.end.line+1,p[4*b+3]=v.end.character+1}return t.$trySetDecorationsFast(e,u.key,p)}}))},revealRange(u,d){c._runOnProxy(()=>t.$tryRevealRange(e,H.from(u),d||Wp.Default))},show(u){t.$tryShowEditor(e,Kt.from(u))},hide(){t.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){Zi(!this._disposed),this._disposed=!0}_acceptOptions(e){Zi(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){Zi(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){Zi(!this._disposed),this._viewColumn=e}_acceptSelections(e){Zi(!this._disposed),this._selections=e}async _trySetSelection(){const e=this._selections.map(Qn.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const n=t.edits.map(s=>s.range);n.sort((s,o)=>s.end.line===o.end.line?s.end.character===o.end.character?s.start.line===o.start.line?s.start.character-o.start.character:s.start.line-o.start.line:s.end.character-o.end.character:s.end.line-o.end.line);for(let s=0,o=n.length-1;s<o;s++){const a=n[s].end;if(n[s+1].start.isBefore(a))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const r=t.edits.map(s=>({range:H.from(s.range),text:s.text,forceMoveMarkers:s.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,r,{setEndOfLine:typeof t.setEndOfLine=="number"?oc.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this._logService.warn(t),null))}}class C6{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}}let Sb=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new $t,this._onDidAddDocuments=new L,this._onDidRemoveDocuments=new L,this._onDidChangeVisibleTextEditors=new L,this._onDidChangeActiveTextEditor=new L,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const t=[],n=[],r=[];if(e.removedDocuments)for(const s of e.removedDocuments){const o=y.revive(s),a=this._documents.get(o);a!=null&&a.unref()&&(this._documents.delete(o),t.push(a.value))}if(e.addedDocuments)for(const s of e.addedDocuments){const o=y.revive(s.uri);let a=this._documents.get(o);if(a&&o.scheme!==le.vscodeNotebookCell&&o.scheme!==le.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new C6(new x6(this._extHostRpc.getProxy(Z.MainThreadDocuments),o,s.lines,s.EOL,s.versionId,s.languageId,s.isDirty)),this._documents.set(o,a),n.push(a.value)),a.ref()}if(e.removedEditors)for(const s of e.removedEditors){const o=this._editors.get(s);this._editors.delete(s),o&&r.push(o)}if(e.addedEditors)for(const s of e.addedEditors){const o=y.revive(s.documentUri);Zi(this._documents.has(o),`document '${o}' does not exist`),Zi(!this._editors.has(s.id),`editor '${s.id}' already exists!`);const a=this._documents.get(o).value,l=new k6(s.id,this._extHostRpc.getProxy(Z.MainThreadTextEditors),this._logService,new yt(()=>a.document),s.selections.map(Qn.to),s.options,s.visibleRanges.map(c=>H.to(c)),typeof s.editorPosition=="number"?Kt.to(s.editorPosition):void 0);this._editors.set(s.id,l)}e.newActiveEditor!==void 0&&(Zi(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),Ar(t),Ar(r),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(n),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(s=>s.value)),e.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){var t;return(t=this._documents.get(e))==null?void 0:t.value}allDocuments(){return yn.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;const t=this._editors.get(this._activeEditorId);return e?t:t==null?void 0:t.value}allEditors(){return[...this._editors.values()]}};Sb=B([O(0,it),O(1,rt)],Sb);const xc=ke("IExtHostDocumentsAndEditors"),hm=ke("IExtHostApiDeprecationService");let Db=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(Z.MainThreadTelemetry)}report(e,t,n){const r=this.getUsageKey(e,t);this._reportedUsages.has(r)||(this._reportedUsages.add(r),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${n}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};Db=B([O(0,it),O(1,rt)],Db);const I6={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:h(6587,"The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:h(6588,"Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:h(6589,"Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}};var kb;(function(i){function e(t,n,r){if(!t)return;const s=Ge(t.type)?t.type:void 0;if(!s||s.length===0){r.error(h(6590,"The task type configuration is missing the required 'taskType' property"));return}const o=[];if(Array.isArray(t.required))for(const a of t.required)Ge(a)&&o.push(a);return{extensionId:n.value,taskType:s,required:o,properties:t.properties?Et(t.properties):{},when:t.when?Xt.deserialize(t.when):void 0}}i.from=e})(kb||(kb={}));const P6=_S.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(i,e)=>{for(const t of i)t.type&&e.push(`onTaskType:${t.type}`)},jsonSchema:{description:h(6591,"Contributes task kinds"),type:"array",items:I6}});class T6{constructor(){this._onDefinitionsChanged=new L,this.onDefinitionsChanged=this._onDefinitionsChanged.event,this.taskTypes=Object.create(null),this.readyPromise=new Promise((e,t)=>{P6.setHandler((n,r)=>{this._schema=void 0;try{for(const s of r.removed){const o=s.value;for(const a of o)this.taskTypes&&a.type&&this.taskTypes[a.type]&&delete this.taskTypes[a.type]}for(const s of r.added){const o=s.value;for(const a of o){const l=kb.from(a,s.description.identifier,s.collector);l&&(this.taskTypes[l.taskType]=l)}}(r.removed.length>0||r.added.length>0)&&this._onDefinitionsChanged.fire()}catch{}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(this._schema===void 0){const e=[];for(const t of this.all()){const n={type:"object",additionalProperties:!1};t.required.length>0&&(n.required=t.required.slice(0)),t.properties!==void 0?n.properties=Et(t.properties):n.properties=Object.create(null),n.properties.type={type:"string",enum:[t.taskType]},e.push(n)}this._schema={oneOf:e}}return this._schema}}const A6=new T6;new X("taskRunning",!1,h(3790,"Whether a task is currently running.")),l_(3791,"Tasks");var fm;(function(i){i[i.Escape=1]="Escape",i[i.Strong=2]="Strong",i[i.Weak=3]="Weak"})(fm||(fm={})),function(i){function e(t){if(!t)return i.Strong;switch(t.toLowerCase()){case"escape":return i.Escape;case"strong":return i.Strong;case"weak":return i.Weak;default:return i.Strong}}i.from=e}(fm||(fm={}));var ID;(function(i){i.defaults={cwd:"${workspaceFolder}"}})(ID||(ID={}));var uh;(function(i){i[i.Always=1]="Always",i[i.Silent=2]="Silent",i[i.Never=3]="Never"})(uh||(uh={})),function(i){function e(t){switch(t.toLowerCase()){case"always":return i.Always;case"silent":return i.Silent;case"never":return i.Never;default:return i.Always}}i.fromString=e}(uh||(uh={}));var dh;(function(i){i[i.Never=1]="Never",i[i.OnProblem=2]="OnProblem",i[i.Always=3]="Always"})(dh||(dh={})),function(i){function e(t){switch(t.toLowerCase()){case"always":return i.Always;case"never":return i.Never;case"onproblem":return i.OnProblem;default:return i.OnProblem}}i.fromString=e}(dh||(dh={}));var hh;(function(i){i[i.Shared=1]="Shared",i[i.Dedicated=2]="Dedicated",i[i.New=3]="New"})(hh||(hh={})),function(i){function e(t){switch(t.toLowerCase()){case"shared":return i.Shared;case"dedicated":return i.Dedicated;case"new":return i.New;default:return i.Shared}}i.fromString=e}(hh||(hh={}));var PD;(function(i){i.defaults={echo:!0,reveal:uh.Always,revealProblems:dh.Never,focus:!1,panel:hh.Shared,showReuseMessage:!0,clear:!1}})(PD||(PD={}));var pm;(function(i){i[i.Shell=1]="Shell",i[i.Process=2]="Process",i[i.CustomExecution=3]="CustomExecution"})(pm||(pm={})),function(i){function e(n){switch(n.toLowerCase()){case"shell":return i.Shell;case"process":return i.Process;case"customExecution":return i.CustomExecution;default:return i.Process}}i.fromString=e;function t(n){switch(n){case i.Shell:return"shell";case i.Process:return"process";case i.CustomExecution:return"customExecution";default:return"process"}}i.toString=t}(pm||(pm={}));var TD;(function(i){function e(t){return Ge(t)?t:t.value}i.value=e})(TD||(TD={}));var AD;(function(i){i.Clean={_id:"clean",isDefault:!1},i.Build={_id:"build",isDefault:!1},i.Rebuild={_id:"rebuild",isDefault:!1},i.Test={_id:"test",isDefault:!1};function e(n){return n===i.Clean._id||n===i.Build._id||n===i.Rebuild._id||n===i.Test._id}i.is=e;function t(n){if(n!==void 0)return Ge(n)?e(n)?{_id:n,isDefault:!1}:void 0:n}i.from=t})(AD||(AD={}));var RD;(function(i){i[i.Global=1]="Global",i[i.Workspace=2]="Workspace",i[i.Folder=3]="Folder"})(RD||(RD={}));var LD;(function(i){i.Workspace="workspace",i.Extension="extension",i.InMemory="inMemory",i.WorkspaceFile="workspaceFile",i.User="user";function e(t){switch(t){case i.User:return ti.USER;case i.WorkspaceFile:return ti.WORKSPACE;default:return ti.WORKSPACE_FOLDER}}i.toConfigurationTarget=e})(LD||(LD={}));var ND;(function(i){i.parallel="parallel",i.sequence="sequence"})(ND||(ND={}));var Cb;(function(i){i[i.default=1]="default",i[i.folderOpen=2]="folderOpen"})(Cb||(Cb={}));var OD;(function(i){i.defaults={reevaluateOnRerun:!0,runOn:Cb.default,instanceLimit:1}})(OD||(OD={}));var gm;(function(i){i[i.Process=1]="Process",i[i.Terminal=2]="Terminal"})(gm||(gm={})),function(i){i._default=i.Terminal}(gm||(gm={}));var FD;(function(i){i[i.V0_1_0=1]="V0_1_0",i[i.V2_0_0=2]="V2_0_0"})(FD||(FD={}));var pa;(function(i){i.DependsOnStarted="dependsOnStarted",i.AcquiredInput="acquiredInput",i.Start="start",i.ProcessStarted="processStarted",i.Active="active",i.Inactive="inactive",i.Changed="changed",i.Terminated="terminated",i.ProcessEnded="processEnded",i.End="end"})(pa||(pa={}));var mm;(function(i){i.SingleRun="singleRun",i.Background="background"})(mm||(mm={}));var MD;(function(i){i[i.System=0]="System",i[i.User=1]="User",i[i.FolderOpen=2]="FolderOpen",i[i.ConfigurationChange=3]="ConfigurationChange",i[i.Reconnect=4]="Reconnect"})(MD||(MD={}));var $D;(function(i){function e(l){return{taskId:l._id,taskName:l.configurationProperties.name,runType:l.configurationProperties.isBackground?mm.Background:mm.SingleRun,group:l.configurationProperties.group,__task:l}}function t(l,c,u){return{...e(l),kind:pa.Start,terminalId:c,resolvedVariables:u}}i.start=t;function n(l,c,u){return{...e(l),kind:pa.ProcessStarted,terminalId:c,processId:u}}i.processStarted=n;function r(l,c,u){return{...e(l),kind:pa.ProcessEnded,terminalId:c,exitCode:u}}i.processEnded=r;function s(l,c,u){return{...e(l),kind:pa.Terminated,exitReason:u,terminalId:c}}i.terminated=s;function o(l,c,u){return{...e(c),kind:l,terminalId:u}}i.general=o;function a(){return{kind:pa.Changed}}i.changed=a})($D||($D={}));var _m;(function(i){function e(n){const r=Object.keys(n).sort();let s="";for(const o of r){let a=n[o];a instanceof Object?a=e(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),s+=o+","+a+","}return s}function t(n){const s={_key:e(n),type:n.taskType};return Object.assign(s,n),s}i.create=t})(_m||(_m={}));var UD;(function(i){i.AutoDetect="task.autoDetect",i.SaveBeforeRun="task.saveBeforeRun",i.ShowDecorations="task.showDecorations",i.ProblemMatchersNeverPrompt="task.problemMatchers.neverPrompt",i.SlowProviderWarning="task.slowProviderWarning",i.QuickOpenHistory="task.quickOpen.history",i.QuickOpenDetail="task.quickOpen.detail",i.QuickOpenSkip="task.quickOpen.skip",i.QuickOpenShowAll="task.quickOpen.showAll",i.AllowAutomaticTasks="task.allowAutomaticTasks",i.Reconnection="task.reconnection",i.VerboseLogging="task.verboseLogging"})(UD||(UD={}));var HD;(function(i){i.Tasks="tasks",i.SuppressTaskName="tasks.suppressTaskName",i.Windows="tasks.windows",i.Osx="tasks.osx",i.Linux="tasks.linux",i.ShowOutput="tasks.showOutput",i.IsShellCommand="tasks.isShellCommand",i.ServiceTestSetting="tasks.service.testSetting"})(HD||(HD={}));var BD;(function(i){function e(t,n){const r=A6.get(t.type);if(r===void 0){const l=Et(t);return delete l._key,_m.create(l)}const s=Object.create(null);s.type=r.taskType;const o=new Set;r.required.forEach(l=>o.add(l));const a=r.properties;for(const l of Object.keys(a)){const c=t[l];if(c!=null)s[l]=c;else if(o.has(l)){const u=a[l];if(u.default!==void 0)s[l]=Et(u.default);else switch(u.type){case"boolean":s[l]=!1;break;case"number":case"integer":s[l]=0;break;case"string":s[l]="";break;default:n.error(h(3792,"Error: the task identifier '{0}' is missing the required property '{1}'. The task identifier will be ignored.",JSON.stringify(t,void 0,0),l));return}}}return _m.create(s)}i.createTaskIdentifier=e})(BD||(BD={}));var vm;(function(i){function e(n){if(n!=null)return n}i.from=e;function t(n){if(n!=null)return n}i.to=t})(vm||(vm={}));var wm;(function(i){function e(n){if(n!=null)return n}i.from=e;function t(n){if(n!=null)return n}i.to=t})(wm||(wm={}));var Ib;(function(i){function e(n){if(n!=null)return n}i.from=e;function t(n){if(n!=null)return n}i.to=t})(Ib||(Ib={}));var fh;(function(i){function e(r){if(r){const s=r;return s&&!!s.process}else return!1}i.is=e;function t(r){if(r==null)return;const s={process:r.process,args:r.args};return r.options&&(s.options=Ib.from(r.options)),s}i.from=t;function n(r){if(r!=null)return new Vl(r.process,r.args,r.options)}i.to=n})(fh||(fh={}));var Pb;(function(i){function e(n){if(n!=null)return n}i.from=e;function t(n){if(n!=null)return n}i.to=t})(Pb||(Pb={}));var ph;(function(i){function e(r){if(r){const s=r;return s&&(!!s.commandLine||!!s.command)}else return!1}i.is=e;function t(r){if(r==null)return;const s={};return r.commandLine!==void 0?s.commandLine=r.commandLine:(s.command=r.command,s.args=r.args),r.options&&(s.options=Pb.from(r.options)),s}i.from=t;function n(r){if(!(r==null||r.command===void 0&&r.commandLine===void 0))return r.commandLine?new Yo(r.commandLine,r.options):new Yo(r.command,r.args?r.args:[],r.options)}i.to=n})(ph||(ph={}));var ns;(function(i){function e(r){if(r){const s=r;return s&&s.customExecution==="customExecution"}else return!1}i.is=e;function t(r){return{customExecution:"customExecution"}}i.from=t;function n(r,s){return s.get(r)}i.to=n})(ns||(ns={}));var Tb;(function(i){function e(t){if(t!=null)return{_id:t.id,isDefault:t.isDefault}}i.from=e})(Tb||(Tb={}));var Gs;(function(i){function e(r,s){if(r==null)return[];const o=[];for(const a of r){const l=t(a,s);l&&o.push(l)}return o}i.fromMany=e;function t(r,s){if(r==null)return;let o;r.execution instanceof Vl?o=fh.from(r.execution):r.execution instanceof Yo?o=ph.from(r.execution):r.execution&&r.execution instanceof wv&&(o=ns.from(r.execution));const a=vm.from(r.definition);let l;return r.scope?typeof r.scope=="number"?l=r.scope:l=r.scope.uri:l=Ko.Workspace,!a||!l?void 0:{_id:r._id,definition:a,name:r.name,source:{extensionId:s.identifier.value,label:r.source,scope:l},execution:o,isBackground:r.isBackground,group:Tb.from(r.group),presentationOptions:wm.from(r.presentationOptions),problemMatchers:r.problemMatchers,hasDefinedMatchers:r.hasDefinedMatchers,runOptions:r.runOptions?r.runOptions:{reevaluateOnRerun:!0},detail:r.detail}}i.from=t;async function n(r,s,o){if(r==null)return;let a;fh.is(r.execution)?a=fh.to(r.execution):ph.is(r.execution)?a=ph.to(r.execution):ns.is(r.execution)&&(a=ns.to(r._id,o));const l=vm.to(r.definition);let c;if(r.source&&(r.source.scope!==void 0?typeof r.source.scope=="number"?c=r.source.scope:c=await s.resolveWorkspaceFolder(y.revive(r.source.scope)):c=Ko.Workspace),!l||!c)return;const u=new Gp(l,c,r.name,r.source.label,a,r.problemMatchers);return r.isBackground!==void 0&&(u.isBackground=r.isBackground),r.group!==void 0&&(u.group=bd.from(r.group._id),u.group&&r.group.isDefault&&(u.group=new bd(u.group.id,u.group.label),r.group.isDefault===!0&&(u.group.isDefault=r.group.isDefault))),r.presentationOptions&&(u.presentationOptions=wm.to(r.presentationOptions)),r._id&&(u._id=r._id),r.detail&&(u.detail=r.detail),u}i.to=n})(Gs||(Gs={}));var Ab;(function(i){function e(n){return n}i.from=e;function t(n){if(n)return Object.assign(Object.create(null),n)}i.to=t})(Ab||(Ab={}));class Rb{constructor(e,t,n){me(this,Bh);this._id=t,this._task=n,te(this,Bh,e)}get task(){return this._task}terminate(){I(this,Bh).terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}Bh=new WeakMap;let Lb=class{constructor(e,t,n,r,s,o,a,l){this._onDidExecuteTask=new L,this._onDidTerminateTask=new L,this._onDidTaskProcessStarted=new L,this._onDidTaskProcessEnded=new L,this._proxy=e.getProxy(Z.MainThreadTask),this._workspaceProvider=n,this._editorService=r,this._configurationService=s,this._terminalService=o,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=a,this._deprecationService=l,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,n){if(!n)return new Qe(()=>{});const r=this.nextHandle();return this._handlers.set(r,{type:t,provider:n,extension:e}),this._proxy.$registerTaskProvider(r,t),new Qe(()=>{this._handlers.delete(r),this._proxy.$unregisterTaskProvider(r)})}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(Ab.from(e)).then(async t=>{const n=[];for(const r of t){const s=await Gs.to(r,this._workspaceProvider,this._providedCustomExecutions2);s&&n.push(s)}return n})}get taskExecutions(){const e=[];return this._taskExecutions.forEach(t=>e.push(t)),e}terminateTask(e){if(!(e instanceof Rb))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,n){const r=this._providedCustomExecutions2.get(e.id);r&&(this._activeCustomExecutions2.set(e.id,r),this._terminalService.attachPtyToTerminal(t,await r.callback(n))),this._lastStartedTask=e.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;const t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}$provideTasks(e,t){const n=this._handlers.get(e);if(!n)return Promise.reject(new Error("no handler found"));const r=[],s=xi(()=>n.provider.provideTasks(Nt.None)).then(o=>this.provideTasksInternal(t,r,n,o));return new Promise(o=>{s.then(a=>{Promise.all(r).then(()=>{o(a)})})})}async $resolveTask(e,t){const n=this._handlers.get(e);if(!n)return Promise.reject(new Error("no handler found"));if(t.definition.type!==n.type)throw new Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${n.type}].`);const r=await Gs.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!r)throw new Error("Unexpected: Task cannot be resolved.");const s=await n.provider.resolveTask(r,Nt.None);if(!s)return;this.checkDeprecation(s,n);const o=Gs.from(s,n.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(s.definition!==r.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return ns.is(o.execution)&&await this.addCustomExecution(o,s,!0),await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,n){const r=await this._proxy.$createTaskId(e);!n&&!this._providedCustomExecutions2.has(r)&&(this._notProvidedCustomExecutions.add(r),this._activeCustomExecutions2.set(r,t.execution)),this._providedCustomExecutions2.set(r,t.execution)}async getTaskExecution(e,t){if(typeof e=="string"){const s=this._taskExecutionPromises.get(e);if(!s)throw new Pr("Unexpected: The specified task is missing an execution");return s}const n=this._taskExecutionPromises.get(e.id);if(n)return n;let r;return t?r=Promise.resolve(new Rb(this,e.id,t)):r=Gs.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(s=>{if(!s)throw new Pr("Unexpected: Task does not exist.");return new Rb(this,e.id,s)}),this._taskExecutionPromises.set(e.id,r),r.then(s=>(this._taskExecutions.set(e.id,s),s))}checkDeprecation(e,t){e._deprecated&&this._deprecationService.report("Task.constructor",t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){this._activeCustomExecutions2.get(e.id)&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));const n=this._notProvidedCustomExecutions.values();let r=n.next();for(;!r.done;)!this._activeCustomExecutions2.has(r.value)&&this._lastStartedTask!==r.value&&(this._providedCustomExecutions2.delete(r.value),this._notProvidedCustomExecutions.delete(r.value)),r=n.next()}};Lb=B([O(0,it),O(1,Ei),O(2,ts),O(3,xc),O(4,is),O(5,bc),O(6,rt),O(7,hm)],Lb);let Nb=class extends Lb{constructor(e,t,n,r,s,o,a,l){super(e,t,n,r,s,o,a,l),this.registerTaskSystem(le.vscodeRemote,{scheme:le.vscodeRemote,authority:"",platform:uC(An.Web)})}async executeTask(e,t){if(!t.execution)throw new Error("Tasks to execute must include an execution");const n=Gs.from(t,e);if(n===void 0)throw new Error("Task is not valid");if(ns.is(n.execution))await this.addCustomExecution(n,t,!1);else throw new C1;const r=await this.getTaskExecution(await this._proxy.$getTaskExecution(n),t);return this._proxy.$executeTask(n).catch(s=>{throw new Error(s)}),r}provideTasksInternal(e,t,n,r){const s=[];if(r)for(const o of r){if(this.checkDeprecation(o,n),!o.definition||!e[o.definition.type]){const l=o.source?o.source:"No task source";this._logService.warn(`The task [${l}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Gs.from(o,n.extension);a&&ns.is(a.execution)?(s.push(a),t.push(this.addCustomExecution(a,o,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:s,extension:n.extension}}async resolveTaskInternal(e){if(ns.is(e.execution))return e;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(e,t){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,n){}};Nb=B([O(0,it),O(1,Ei),O(2,ts),O(3,xc),O(4,is),O(5,bc),O(6,rt),O(7,hm)],Nb);const WD=ke("IExtHostTask"),gh=ke("IExtHostEditorTabs");class VD{constructor(e,t,n){this._activeTabIdGetter=n,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case dn.TextInput:return new Uv(y.revive(this._dto.input.uri));case dn.TextDiffInput:return new _g(y.revive(this._dto.input.original),y.revive(this._dto.input.modified));case dn.TextMergeInput:return new a4(y.revive(this._dto.input.base),y.revive(this._dto.input.input1),y.revive(this._dto.input.input2),y.revive(this._dto.input.result));case dn.CustomEditorInput:return new Hv(y.revive(this._dto.input.uri),this._dto.input.viewType);case dn.WebviewEditorInput:return new l4(this._dto.input.viewType);case dn.NotebookInput:return new Bv(y.revive(this._dto.input.uri),this._dto.input.notebookType);case dn.NotebookDiffInput:return new Wv(y.revive(this._dto.input.original),y.revive(this._dto.input.modified),this._dto.input.notebookType);case dn.TerminalEditorInput:return new c4;case dn.InteractiveEditorInput:return new u4(y.revive(this._dto.input.uri),y.revive(this._dto.input.inputBoxUri));case dn.ChatEditorInput:return new d4;case dn.MultiDiffEditorInput:return new h4(this._dto.input.diffEditors.map(e=>new _g(y.revive(e.original),y.revive(e.modified))));default:return}}}class R6{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const n of e.tabs)n.isActive&&(this._activeTabId=n.id),this._tabs.push(new VD(n,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return Kt.to(e._dto.viewColumn)},get activeTab(){var n;return(n=e._tabs.find(r=>r.tabId===e._activeTabId))==null?void 0:n.apiObject},get tabs(){return Object.freeze(e._tabs.map(n=>n.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===Nr.TAB_OPEN){const n=new VD(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,n),e.tabDto.isActive&&(this._activeTabId=n.tabId),n}else if(e.kind===Nr.TAB_CLOSE){const n=this._tabs.splice(e.index,1)[0];if(!n)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return n.tabId===this._activeTabId&&(this._activeTabId=""),n}else if(e.kind===Nr.TAB_MOVE){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const n=this._tabs.splice(e.oldIndex,1)[0];if(!n)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,n),n}const t=this._tabs.find(n=>n.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}}let Ob=class{constructor(e){this._onDidChangeTabs=new L,this._onDidChangeTabGroups=new L,this._extHostTabGroups=[],this._proxy=e.getProxy(Z.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(n=>n.apiObject))},get activeTabGroup(){var s;const n=e._activeGroupId;return al((s=e._extHostTabGroups.find(o=>o.groupId===n))==null?void 0:s.apiObject)},close:async(n,r)=>{const s=Array.isArray(n)?n:[n];return s.length?L6(s[0])?this._closeGroups(s,r):this._closeTabs(s,r):!0}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){var c;const t=new Set(this._extHostTabGroups.map(u=>u.groupId)),n=new Set(e.map(u=>u.groupId)),r=T5(t,n),s=this._extHostTabGroups.filter(u=>r.removed.includes(u.groupId)).map(u=>u.apiObject),o=[],a=[];this._extHostTabGroups=e.map(u=>{const d=new R6(u,()=>this._activeGroupId);return r.added.includes(d.groupId)?o.push(d.apiObject):a.push(d.apiObject),d});const l=al((c=e.find(u=>u.isActive===!0))==null?void 0:c.groupId);l!==void 0&&this._activeGroupId!==l&&(this._activeGroupId=l),this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:s,changed:a}))}$acceptTabGroupUpdate(e){const t=this._extHostTabGroups.find(n=>n.groupId===e.groupId);if(!t)throw new Error("Update Group IPC call received before group creation.");t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const t=this._extHostTabGroups.find(r=>r.groupId===e.groupId);if(!t)throw new Error("Update Tabs IPC call received before group creation.");const n=t.acceptTabOperation(e);switch(e.kind){case Nr.TAB_OPEN:this._onDidChangeTabs.fire(Object.freeze({opened:[n.apiObject],closed:[],changed:[]}));return;case Nr.TAB_CLOSE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[n.apiObject],changed:[]}));return;case Nr.TAB_MOVE:case Nr.TAB_UPDATE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[n.apiObject]}));return}}_findExtHostTabFromApi(e){for(const t of this._extHostTabGroups)for(const n of t.tabs)if(n.apiObject===e)return n}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(t=>t.apiObject===e)}async _closeTabs(e,t){const n=[];for(const r of e){const s=this._findExtHostTabFromApi(r);if(!s)throw new Error("Tab close: Invalid tab not found!");n.push(s.tabId)}return this._proxy.$closeTab(n,t)}async _closeGroups(e,t){const n=[];for(const r of e){const s=this._findExtHostTabGroupFromApi(r);if(!s)throw new Error("Group close: Invalid group not found!");n.push(s.groupId)}return this._proxy.$closeGroup(n,t)}};Ob=B([O(0,it)],Ob);function L6(i){return i.tabs!==void 0}class N6{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new L,this._onExit=new L,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(new Error("attempt to set more than one 'Message' callback")),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(new Error("attempt to set more than one 'Event' callback")),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(new Error("attempt to set more than one 'Request' callback")),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend("response",e)}sendRequest(e,t,n,r){const s={command:e};if(t&&Object.keys(t).length>0&&(s.arguments=t),this.internalSend("request",s),typeof r=="number"){const o=setTimeout(()=>{clearTimeout(o);const a=this.pendingRequests.get(s.seq);if(a){this.pendingRequests.delete(s.seq);const l={type:"response",seq:0,request_seq:s.seq,success:!1,command:e,message:h(3793,"Timeout after {0} ms for '{1}'",r,e)};a(l)}},r)}return n&&this.pendingRequests.set(s.seq,n),s.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),this.queue.length===1&&this.processQueue())}needsTaskBoundaryBetween(e,t){return e.type!=="event"||t.type!=="event"}async processQueue(){var t,n;let e;for(;this.queue.length;){if((!e||this.needsTaskBoundaryBetween(this.queue[0],e))&&await Or(0),e=this.queue.shift(),!e)return;switch(e.type){case"event":(t=this.eventCallback)==null||t.call(this,e);break;case"request":(n=this.requestCallback)==null||n.call(this,e);break;case"response":{const r=e,s=this.pendingRequests.get(r.request_seq);s&&(this.pendingRequests.delete(r.request_seq),s(r));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(this.pendingRequests.size===0)return Promise.resolve();const e=new Map;this.pendingRequests.forEach((t,n)=>e.set(n,t)),await Or(500),e.forEach((t,n)=>{t({type:"response",seq:0,request_seq:n,success:!1,command:"canceled",message:"canceled"}),this.pendingRequests.delete(n)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}function O6(i){return i.type&&(i.label||i.program||i.runtime)}const F6=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function M6(i){return!!(i&&i.match(F6))}function zD(i){if(typeof i.path=="string"&&!(typeof i.sourceReference=="number"&&i.sourceReference>0)){if(M6(i.path))return y.parse(i.path);if(z1(i.path))return y.file(i.path)}return i.path}function qD(i){if(typeof i.path=="object"){const e=y.revive(i.path);if(e)return e.scheme===le.file?e.fsPath:e.toString()}return i.path}function $6(i,e){const t=e?zD:qD,n=Et(i);return jD(n,(r,s)=>{r&&s&&(s.path=t(s))}),n}function U6(i,e){const t=e?zD:qD,n=Et(i);return jD(n,(r,s)=>{!r&&s&&(s.path=t(s))}),n}function jD(i,e){var t;switch(i.type){case"event":{const n=i;switch(n.event){case"output":e(!1,n.body.source);break;case"loadedSource":e(!1,n.body.source);break;case"breakpoint":e(!1,n.body.breakpoint.source);break}break}case"request":{const n=i;switch(n.command){case"setBreakpoints":e(!0,n.arguments.source);break;case"breakpointLocations":e(!0,n.arguments.source);break;case"source":e(!0,n.arguments.source);break;case"gotoTargets":e(!0,n.arguments.source);break;case"launchVSCode":n.arguments.args.forEach(r=>e(!1,r));break}break}case"response":{const n=i;if(n.success&&n.body)switch(n.command){case"stackTrace":n.body.stackFrames.forEach(r=>e(!1,r.source));break;case"loadedSources":n.body.sources.forEach(r=>e(!1,r));break;case"scopes":n.body.scopes.forEach(r=>e(!1,r.source));break;case"setFunctionBreakpoints":n.body.breakpoints.forEach(r=>e(!1,r.source));break;case"setBreakpoints":n.body.breakpoints.forEach(r=>e(!1,r.source));break;case"disassemble":(t=n.body)==null||t.instructions.forEach(s=>e(!1,s.location));break}break}}}var ft;(function(i){i.Unknown="unknown",i.Env="env",i.Config="config",i.Command="command",i.Input="input",i.ExtensionInstallFolder="extensionInstallFolder",i.WorkspaceFolder="workspaceFolder",i.Cwd="cwd",i.WorkspaceFolderBasename="workspaceFolderBasename",i.UserHome="userHome",i.LineNumber="lineNumber",i.SelectedText="selectedText",i.File="file",i.FileWorkspaceFolder="fileWorkspaceFolder",i.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",i.RelativeFile="relativeFile",i.RelativeFileDirname="relativeFileDirname",i.FileDirname="fileDirname",i.FileExtname="fileExtname",i.FileBasename="fileBasename",i.FileBasenameNoExtension="fileBasenameNoExtension",i.FileDirnameBasename="fileDirnameBasename",i.ExecPath="execPath",i.ExecInstallFolder="execInstallFolder",i.PathSeparator="pathSeparator",i.PathSeparatorAlias="/"})(ft||(ft={}));class qi extends Error{constructor(e,t){super(t),this.variable=e}}const Ra=class Ra{constructor(e,t,n,r){this._contributedVariables=new Map,this._context=e,this._labelService=t,this._userHomePromise=n,r&&(this._envVariablesPromise=r.then(s=>this.prepareEnv(s)))}prepareEnv(e){if(cn){const t=Object.create(null);return Object.keys(e).forEach(n=>{t[n.toLowerCase()]=e[n]}),t}return e}resolveWithEnvironment(e,t,n){return this.recursiveResolve({env:this.prepareEnv(e),userHome:void 0},t?t.uri:void 0,n)}async resolveAsync(e,t){const n={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(n,e?e.uri:void 0,t)}async resolveAnyBase(e,t,n,r){const s=Et(t);cn&&s.windows?Object.keys(s.windows).forEach(a=>s[a]=s.windows[a]):Rn&&s.osx?Object.keys(s.osx).forEach(a=>s[a]=s.osx[a]):ws&&s.linux&&Object.keys(s.linux).forEach(a=>s[a]=s.linux[a]),delete s.windows,delete s.osx,delete s.linux;const o={env:await this._envVariablesPromise,userHome:await this._userHomePromise};return this.recursiveResolve(o,e?e.uri:void 0,s,n,r)}async resolveAnyAsync(e,t,n){return this.resolveAnyBase(e,t,n)}async resolveAnyMap(e,t,n){const r=new Map;return{newConfig:await this.resolveAnyBase(e,t,n,r),resolvedVariables:r}}resolveWithInteractionReplace(e,t,n,r){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t,n,r){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this._contributedVariables.set(e,t)}async recursiveResolve(e,t,n,r,s){if(Ge(n))return this.resolveString(e,t,n,r,s);if(Array.isArray(n))return Promise.all(n.map(o=>this.recursiveResolve(e,t,o,r,s)));if(Bt(n)){const o=Object.create(null),a=await Promise.all(Object.keys(n).map(async l=>[await this.resolveString(e,t,l,r,s),await this.recursiveResolve(e,t,n[l],r,s)]));for(const[l,c]of a)o[l]=c;return o}return n}resolveString(e,t,n,r,s){return WC(n,Ra.VARIABLE_REGEXP,async(o,a)=>{if(a.includes(Ra.VARIABLE_LHS))return o;let l=await this.evaluateSingleVariable(e,o,a,t,r);return s==null||s.set(a,l),l!==o&&Ge(l)&&l.match(Ra.VARIABLE_REGEXP)&&(l=await this.resolveString(e,t,l,r,s)),l})}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,n,r,s){let o;const a=n.split(":");a.length>1&&(n=a[0],o=a[1]);const l=d=>{const f=this._context.getFilePath();if(f)return oh(f);throw new qi(d,h(4048,"Variable {0} can not be resolved. Please open an editor.",t))},c=d=>{const f=l(d);if(this._context.getWorkspaceFolderPathForFile){const p=this._context.getWorkspaceFolderPathForFile();if(p)return oh(p)}throw new qi(d,h(4049,"Variable {0}: can not find workspace folder of '{1}'.",t,Yi(f)))},u=d=>{if(o){const f=this._context.getFolderUri(o);if(f)return f;throw new qi(d,h(4050,"Variable {0} can not be resolved. No such folder '{1}'.",t,o))}if(r)return r;throw this._context.getWorkspaceFolderCount()>1?new qi(d,h(4051,"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",t)):new qi(d,h(4052,"Variable {0} can not be resolved. Please open a folder.",t))};switch(n){case"env":if(o){if(e.env){const d=e.env[cn?o.toLowerCase():o];if(Ge(d))return d}return""}throw new qi(ft.Env,h(4053,"Variable {0} can not be resolved because no environment variable name is given.",t));case"config":if(o){const d=this._context.getConfigurationValue(r,o);if(Wt(d))throw new qi(ft.Config,h(4054,"Variable {0} can not be resolved because setting '{1}' not found.",t,o));if(Bt(d))throw new qi(ft.Config,h(4055,"Variable {0} can not be resolved because '{1}' is a structured value.",t,o));return d}throw new qi(ft.Config,h(4056,"Variable {0} can not be resolved because no settings name is given.",t));case"command":return this.resolveFromMap(ft.Command,t,o,s,"command");case"input":return this.resolveFromMap(ft.Input,t,o,s,"input");case"extensionInstallFolder":if(o){const d=await this._context.getExtension(o);if(!d)throw new qi(ft.ExtensionInstallFolder,h(4057,"Variable {0} can not be resolved because the extension {1} is not installed.",t,o));return this.fsPath(d.extensionLocation)}throw new qi(ft.ExtensionInstallFolder,h(4058,"Variable {0} can not be resolved because no extension name is given.",t));default:switch(n){case"workspaceRoot":case"workspaceFolder":return oh(this.fsPath(u(ft.WorkspaceFolder)));case"cwd":return r||o?oh(this.fsPath(u(ft.Cwd))):il();case"workspaceRootFolderName":case"workspaceFolderBasename":return oh(Yi(this.fsPath(u(ft.WorkspaceFolderBasename))));case"userHome":{if(e.userHome)return e.userHome;throw new qi(ft.UserHome,h(4059,"Variable {0} can not be resolved. UserHome path is not defined",t))}case"lineNumber":{const d=this._context.getLineNumber();if(d)return d;throw new qi(ft.LineNumber,h(4060,"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",t))}case"selectedText":{const d=this._context.getSelectedText();if(d)return d;throw new qi(ft.SelectedText,h(4061,"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",t))}case"file":return l(ft.File);case"fileWorkspaceFolder":return c(ft.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return Yi(c(ft.FileWorkspaceFolderBasename));case"relativeFile":return r||o?bu(this.fsPath(u(ft.RelativeFile)),l(ft.RelativeFile)):l(ft.RelativeFile);case"relativeFileDirname":{const d=vo(l(ft.RelativeFileDirname));if(r||o){const f=bu(this.fsPath(u(ft.RelativeFileDirname)),d);return f.length===0?".":f}return d}case"fileDirname":return vo(l(ft.FileDirname));case"fileExtname":return q1(l(ft.FileExtname));case"fileBasename":return Yi(l(ft.FileBasename));case"fileBasenameNoExtension":{const d=Yi(l(ft.FileBasenameNoExtension));return d.slice(0,d.length-q1(d).length)}case"fileDirnameBasename":return Yi(vo(l(ft.FileDirnameBasename)));case"execPath":{const d=this._context.getExecPath();return d||t}case"execInstallFolder":{const d=this._context.getAppRoot();return d||t}case"pathSeparator":case"/":return Ln;default:try{const d=o?`${n}:${o}`:n;return this.resolveFromMap(ft.Unknown,t,d,s,void 0)}catch{return t}}}}resolveFromMap(e,t,n,r,s){if(n&&r){const o=s===void 0?r[n]:r[s+":"+n];if(typeof o=="string")return o;throw new qi(e,h(4062,"Variable {0} can not be resolved because the command has no value.",t))}return t}};Ra.VARIABLE_LHS="${",Ra.VARIABLE_REGEXP=/\$\{(.*?)\}/g;let Fb=Ra;const Mb=ke("IExtHostVariableResolverProvider");class H6 extends Fb{constructor(e,t,n,r,s,o,a){function l(){var c;if(n){const u=n.activeEditor();if(u)return u.document.uri;const d=(c=r.tabGroups.all.find(f=>f.isActive))==null?void 0:c.activeTab;if(d!==void 0){if(d.input instanceof _g||d.input instanceof Wv)return d.input.modified;if(d.input instanceof Uv||d.input instanceof Bv||d.input instanceof Hv)return d.input.uri}}}super({getFolderUri:c=>{const u=o.folders.filter(d=>d.name===c);if(u&&u.length>0)return u[0].uri},getWorkspaceFolderCount:()=>o.folders.length,getConfigurationValue:(c,u)=>s.getConfiguration(void 0,c).get(u),getAppRoot:()=>il(),getExecPath:()=>W1.VSCODE_EXEC_PATH,getFilePath:()=>{const c=l();if(c)return nl(c.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const c=l();if(c){const u=t.getWorkspaceFolder(c);if(u)return nl(u.uri.fsPath)}}},getSelectedText:()=>{if(n){const c=n.activeEditor();if(c&&!c.selection.isEmpty)return c.document.getText(c.selection)}},getLineNumber:()=>{if(n){const c=n.activeEditor();if(c)return String(c.selection.end.line+1)}},getExtension:c=>e.getExtension(c)},void 0,a?Promise.resolve(a):void 0,Promise.resolve(W1))}}let $b=class extends Re{constructor(e,t,n,r,s){super(),this.extensionService=e,this.workspaceService=t,this.editorService=n,this.configurationService=r,this.editorTabs=s,this._resolver=new yt(async()=>{const o=await this.configurationService.getConfigProvider(),l={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace(async c=>{l.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new H6(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,l,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};$b=B([O(0,js),O(1,ts),O(2,xc),O(3,is),O(4,gh)],$b);var GD;(function(i){i.ViewletId="workbench.view.extension.test",i.ExplorerViewId="workbench.view.testing",i.OutputPeekContributionId="editor.contrib.testingOutputPeek",i.DecorationsContributionId="editor.contrib.testingDecorations",i.CoverageDecorationsContributionId="editor.contrib.coverageDecorations",i.CoverageViewId="workbench.view.testCoverage",i.ResultsPanelId="workbench.panel.testResults",i.ResultsViewId="workbench.panel.testResults.view",i.MessageLanguageId="vscodeInternalTestMessage"})(GD||(GD={}));var QD;(function(i){i.List="list",i.Tree="true"})(QD||(QD={}));var JD;(function(i){i.ByLocation="location",i.ByStatus="status",i.ByDuration="duration"})(JD||(JD={})),qt.Errored+"",h(4063,"Errored"),qt.Failed+"",h(4064,"Failed"),qt.Passed+"",h(4065,"Passed"),qt.Queued+"",h(4066,"Queued"),qt.Running+"",h(4067,"Running"),qt.Skipped+"",h(4068,"Skipped"),qt.Unset+"",h(4069,"Not yet run"),en.Debug+"",h(4071,"Debug"),en.Run+"",h(4072,"Run"),en.Coverage+"",h(4073,"Coverage");var Ub;(function(i){i.CancelTestRefreshAction="testing.cancelTestRefresh",i.CancelTestRunAction="testing.cancelRun",i.ClearTestResultsAction="testing.clearTestResults",i.CollapseAllAction="testing.collapseAll",i.ConfigureTestProfilesAction="testing.configureProfile",i.ContinousRunUsingForTest="testing.continuousRunUsingForTest",i.CoverageAtCursor="testing.coverageAtCursor",i.CoverageByUri="testing.coverage.uri",i.CoverageClear="testing.coverage.close",i.CoverageCurrentFile="testing.coverageCurrentFile",i.CoverageFilterToTest="testing.coverageFilterToTest",i.CoverageFilterToTestInEditor="testing.coverageFilterToTestInEditor",i.CoverageLastRun="testing.coverageLastRun",i.CoverageSelectedAction="testing.coverageSelected",i.CoverageToggleToolbar="testing.coverageToggleToolbar",i.CoverageViewChangeSorting="testing.coverageViewChangeSorting",i.DebugAction="testing.debug",i.DebugAllAction="testing.debugAll",i.DebugAtCursor="testing.debugAtCursor",i.DebugByUri="testing.debug.uri",i.DebugCurrentFile="testing.debugCurrentFile",i.DebugFailedTests="testing.debugFailTests",i.DebugLastRun="testing.debugLastRun",i.DebugSelectedAction="testing.debugSelected",i.FilterAction="workbench.actions.treeView.testExplorer.filter",i.GetExplorerSelection="_testing.getExplorerSelection",i.GetSelectedProfiles="testing.getSelectedProfiles",i.GoToTest="testing.editFocusedTest",i.GoToRelatedTest="testing.goToRelatedTest",i.PeekRelatedTest="testing.peekRelatedTest",i.GoToRelatedCode="testing.goToRelatedCode",i.PeekRelatedCode="testing.peekRelatedCode",i.HideTestAction="testing.hideTest",i.OpenCoverage="testing.openCoverage",i.OpenOutputPeek="testing.openOutputPeek",i.RefreshTestsAction="testing.refreshTests",i.ReRunFailedTests="testing.reRunFailTests",i.ReRunLastRun="testing.reRunLastRun",i.RunAction="testing.run",i.RunAllAction="testing.runAll",i.RunAllWithCoverageAction="testing.coverageAll",i.RunAtCursor="testing.runAtCursor",i.RunByUri="testing.run.uri",i.RunCurrentFile="testing.runCurrentFile",i.RunSelectedAction="testing.runSelected",i.RunUsingProfileAction="testing.runUsing",i.RunWithCoverageAction="testing.coverage",i.SearchForTestExtension="testing.searchForTestExtension",i.SelectDefaultTestProfiles="testing.selectDefaultTestProfiles",i.ShowMostRecentOutputAction="testing.showMostRecentOutput",i.StartContinousRun="testing.startContinuousRun",i.StopContinousRun="testing.stopContinuousRun",i.TestingSortByDurationAction="testing.sortByDuration",i.TestingSortByLocationAction="testing.sortByLocation",i.TestingSortByStatusAction="testing.sortByStatus",i.TestingViewAsListAction="testing.viewAsList",i.TestingViewAsTreeAction="testing.viewAsTree",i.ToggleContinousRunForTest="testing.toggleContinuousRunForTest",i.ToggleInlineTestOutput="testing.toggleInlineTestOutput",i.UnhideAllTestsAction="testing.unhideAllTests",i.UnhideTestAction="testing.unhideTest"})(Ub||(Ub={}));let B6=0;const XD=new WeakMap,bm=ke("IExtHostTesting");let Hb=class extends Re{constructor(e,t,n,r){super(),this.logService=t,this.commands=n,this.editors=r,this.resultsChangedEmitter=this._register(new L),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new L),this.followupProviders=new Set,this.testFollowups=new Map,this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(Z.MainThreadTesting),this.observer=new G6(this.proxy),this.runTracker=new z6(this.proxy,t),n.registerArgumentProcessor({processArgument:s=>{var o,a,l;switch(s==null?void 0:s.$mid){case mt.TestItemContext:{const c=s,u=c.tests[c.tests.length-1].item.extId,d=this.controllers.get(Ie.root(u));return((o=d==null?void 0:d.collection.tree.get(u))==null?void 0:o.actual)??tD(s)}case mt.TestMessageMenuArgs:{const{test:c,message:u}=s,d=c.item.extId;return{test:((l=(a=this.controllers.get(Ie.root(d)))==null?void 0:a.collection.tree.get(d))==null?void 0:l.actual)??tD({$mid:mt.TestItemContext,tests:[c]}),message:cc.to(u)}}default:return s}}}),n.registerCommand(!1,"testing.getExplorerSelection",async()=>{const s=await n.executeCommand(Ub.GetExplorerSelection),o=a=>{var c;const l=this.controllers.get(Ie.root(a));if(l)return Ie.isRoot(a)?l.controller:(c=l.collection.tree.get(a))==null?void 0:c.actual};return{include:(s==null?void 0:s.include.map(o).filter(yo))||[],exclude:(s==null?void 0:s.exclude.map(o).filter(yo))||[]}})}createTestController(e,t,n,r){if(this.controllers.has(t))throw new Error(`Attempt to insert a duplicate controller with ID "${t}"`);const s=new Le,o=s.add(new FA(t,n,this.editors));o.root.label=n;const a=new Map,l=new Set,c=this.proxy,u=()=>{let p=0;r&&(p|=Xu.Refresh);const b=f.relatedCodeProvider;return b&&(b!=null&&b.provideRelatedTests&&(p|=Xu.TestRelatedToCode),b!=null&&b.provideRelatedCode&&(p|=Xu.CodeRelatedToTest)),p},d={items:o.root.children,get label(){return n},set label(p){n=p,o.root.label=p,c.$updateController(t,{label:n})},get refreshHandler(){return r},set refreshHandler(p){r=p,c.$updateController(t,{capabilities:u()})},get id(){return t},get relatedCodeProvider(){return f.relatedCodeProvider},set relatedCodeProvider(p){M(e,"testRelatedCode"),f.relatedCodeProvider=p,c.$updateController(t,{capabilities:u()})},createRunProfile:(p,b,w,v,S,k)=>{let C=td(p);for(;a.has(C);)C++;return new KD(this.proxy,a,l,this.defaultProfilesChangedEmitter.event,t,C,p,b,w,v,S,k)},createTestItem(p,b,w){return new ha(t,p,b,w)},createTestRun:(p,b,w=!0)=>this.runTracker.createTestRun(e,t,o,p,b,w),invalidateTestResults:p=>{if(p===void 0)this.proxy.$markTestRetired(void 0);else{const b=p instanceof Array?p:[p];this.proxy.$markTestRetired(b.map(w=>Ie.fromExtHostTestItem(w,t).toString()))}},set resolveHandler(p){o.resolveHandler=p},get resolveHandler(){return o.resolveHandler},dispose:()=>{s.dispose()}},f={controller:d,collection:o,profiles:a,extension:e,activeProfiles:l};return c.$registerTestController(t,n,u()),s.add(Me(()=>c.$unregisterTestController(t))),this.controllers.set(t,f),s.add(Me(()=>this.controllers.delete(t))),s.add(o.onDidGenerateDiff(p=>c.$publishDiff(t,p.map(dp.serialize)))),d}createTestObserver(){return this.observer.checkout()}async runTests(e,t=Nt.None){var s,o;const n=YD(e);if(!n)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const r=this.controllers.get(n.controllerId);if(!r)throw new Error("Controller not found");await this.proxy.$runTests({preserveFocus:e.preserveFocus??!0,group:Bb[n.kind],targets:[{testIds:((s=e.include)==null?void 0:s.map(a=>Ie.fromExtHostTestItem(a,r.collection.root.id).toString()))??[r.collection.root.id],profileId:n.profileId,controllerId:n.controllerId}],exclude:(o=e.exclude)==null?void 0:o.map(a=>a.id)},t)}registerTestFollowupProvider(e){return this.followupProviders.add(e),{dispose:()=>{this.followupProviders.delete(e)}}}async $getTestsRelatedToCode(e,t,n){const r=this.editors.getDocument(y.revive(e));if(!r)return[];const s=nt.to(t),o=[];return await Promise.all([...this.controllers.values()].map(async a=>{var c,u;let l;try{l=await((u=(c=a.relatedCodeProvider)==null?void 0:c.provideRelatedTests)==null?void 0:u.call(c,r.document,s,n))}catch(d){n.isCancellationRequested||this.logService.warn(`Error thrown while providing related tests for ${a.controller.label}`,d)}if(l){for(const d of l)o.push(Ie.fromExtHostTestItem(d,a.controller.id).toString());a.collection.flushDiff()}})),o}async $getCodeRelatedToTest(e,t){var o,a;const n=this.controllers.get(Ie.root(e));if(!n)return[];const r=n.collection.tree.get(e);if(!r)return[];const s=await((a=(o=n.relatedCodeProvider)==null?void 0:o.provideRelatedCode)==null?void 0:a.call(o,r.actual,t));return(s==null?void 0:s.map(zi.from))??[]}$syncTests(){for(const{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $getCoverageDetails(e,t,n){const r=await this.runTracker.getCoverageDetails(e,t,n);return r==null?void 0:r.map(zg.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,t){var n,r,s;(s=(r=(n=this.controllers.get(e))==null?void 0:n.profiles.get(t))==null?void 0:r.configureHandler)==null||s.call(r)}$setDefaultRunProfiles(e){const t=new Map;for(const[n,r]of Object.entries(e)){const s=this.controllers.get(n);if(!s)continue;const o=new Map,a=r.filter(c=>!s.activeProfiles.has(c)),l=[...s.activeProfiles].filter(c=>!r.includes(c));for(const c of a)o.set(c,!0),s.activeProfiles.add(c);for(const c of l)o.set(c,!1),s.activeProfiles.delete(c);o.size&&t.set(n,o)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){var n,r,s;await((s=(n=this.controllers.get(e))==null?void 0:(r=n.controller).refreshHandler)==null?void 0:s.call(r,t))}$publishTestResults(e){this.results=Object.freeze(e.map(t=>{const n=ww.to(t);return XD.set(n,t.id),n}).concat(this.results).sort((t,n)=>n.completedAt-t.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){var r;const n=(r=this.controllers.get(Ie.fromString(e).controllerId))==null?void 0:r.collection;n&&(await n.expand(e,t<0?1/0:t),n.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map(t=>dp.deserialize({asCanonicalUri:n=>n},t)))}async $runControllerTests(e,t){return Promise.all(e.map(n=>this.runControllerTestRequest(n,!1,t)))}async $startContinuousRun(e,t){const n=new Qt(t),r=await Promise.all(e.map(s=>this.runControllerTestRequest(s,!0,n.token)));return!t.isCancellationRequested&&!r.some(s=>s.error)&&await new Promise(s=>t.onCancellationRequested(s)),n.dispose(!0),r}async $provideTestFollowups(e,t){const n=this.results.find(o=>XD.get(o)===e.resultId),r=n&&Q6(Ie.fromString(e.extId),n==null?void 0:n.results);if(!r)return[];let s=[];return await Promise.all([...this.followupProviders].map(async o=>{try{const a=await o.provideFollowup(n,r,e.taskIndex,e.messageIndex,t);a&&(s=s.concat(a))}catch(a){this.logService.error("Error thrown while providing followup for test message",a)}})),t.isCancellationRequested?[]:s.map(o=>{const a=B6++;return this.testFollowups.set(a,o),{title:o.title,id:a}})}$disposeTestFollowups(e){for(const t of e)this.testFollowups.delete(t)}$executeTestFollowup(e){const t=this.testFollowups.get(e);return t?this.commands.executeCommand(t.command,...t.arguments||[]):Promise.resolve()}$cancelExtensionTestRun(e){e===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e)}getMetadataForRun(e){for(const t of this.runTracker.trackers){const n=t.getTaskIdForRun(e);if(n)return{taskId:n,runId:t.id}}}async runControllerTestRequest(e,t,n){const r=this.controllers.get(e.controllerId);if(!r)return{};const{collection:s,profiles:o,extension:a}=r,l=o.get(e.profileId);if(!l)return{};const c=e.testIds.map(p=>s.tree.get(p)).filter(yo),u=e.excludeExtIds.map(p=>r.collection.tree.get(p)).filter(yo).filter(p=>c.some(b=>b.fullId.compare(p.fullId)===Bn.IsChild));if(!c.length)return{};const d=new pg(c.some(p=>p.actual instanceof Yw)?void 0:c.map(p=>p.actual),u.map(p=>p.actual),l,t),f=vP(e)&&this.runTracker.prepareForMainThreadTestRun(a,d,mh.fromInternal(e,r.collection),l,n);try{return await l.runHandler(d,n),{}}catch(p){return{error:String(p)}}finally{f&&f.hasRunningTasks&&!n.isCancellationRequested&&await Ht.toPromise(f.onEnd)}}};Hb=B([O(0,it),O(1,rt),O(2,fa),O(3,xc)],Hb);const W6=1e4;var Qs;(function(i){i[i.Running=0]="Running",i[i.Cancelling=1]="Cancelling",i[i.Ended=2]="Ended"})(Qs||(Qs={}));class V6 extends Re{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,t,n,r,s,o){super(),this.dto=e,this.proxy=t,this.logService=n,this.profile=r,this.extension=s,this.state=Qs.Running,this.running=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new L),this.publishedCoverage=new Map,this.onEnd=this.endEmitter.event,this.cts=this._register(new Qt(o));const a=this._register(new ll(()=>this.forciblyEndTasks(),W6));this._register(this.cts.token.onCancellationRequested(()=>a.schedule()));const l=new L;this.onDidDispose=l.event,this._register(Me(()=>{l.fire(),l.dispose()}))}getTaskIdForRun(e){for(const[t,{run:n}]of this.tasks)if(n===e)return t}cancel(){this.state===Qs.Running?(this.cts.cancel(),this.state=Qs.Cancelling):this.state===Qs.Cancelling&&this.forciblyEndTasks()}async getCoverageDetails(e,t,n){var d,f,p,b;const[,r]=Ie.fromString(e).path,s=this.publishedCoverage.get(e);if(!s)return[];const{report:o,extIds:a}=s,l=this.tasks.get(r);if(!l)throw new Error("unreachable: run task was not found");let c;if(t&&o instanceof sa){const w=a.indexOf(t);if(w===-1)return[];c=o.fromTests[w]}return await(c?(f=(d=this.profile)==null?void 0:d.loadDetailedCoverageForTest)==null?void 0:f.call(d,l.run,o,c,n):(b=(p=this.profile)==null?void 0:p.loadDetailedCoverage)==null?void 0:b.call(p,l.run,o,n))??[]}createRun(e){const t=this.dto.id,n=this.dto.controllerId,r=Un(),s=c=>(u,...d)=>{if(a){this.logService.warn(`Setting the state of test "${u.id}" is a no-op after the run ends.`);return}this.ensureTestIsKnown(u),c(u,...d)},o=(c,u)=>{const d=u instanceof Array?u.map(cc.from):[cc.from(u)];if(c.uri&&c.range){const f={range:H.from(c.range),uri:c.uri};for(const p of d)p.location=p.location||f}this.proxy.$appendTestMessagesInRun(t,r,Ie.fromExtHostTestItem(c,n).toString(),d)};let a=!1;const l={isPersisted:this.dto.isPersisted,token:this.cts.token,name:e,onDidDispose:this.onDidDispose,addCoverage:c=>{if(a)return;const u=c instanceof sa?c.fromTests:[];if(u.length){M(this.extension,"attributableCoverage");for(const p of u)this.ensureTestIsKnown(p)}const d=c.uri.toString(),f=new Ie([t,r,d]).toString();this.publishedCoverage.set(f,{report:c,extIds:u.map(p=>Ie.fromExtHostTestItem(p,n).toString())}),this.proxy.$appendCoverage(t,r,zg.fromFile(n,f,c))},enqueued:s(c=>{this.proxy.$updateTestStateInRun(t,r,Ie.fromExtHostTestItem(c,n).toString(),qt.Queued)}),skipped:s(c=>{this.proxy.$updateTestStateInRun(t,r,Ie.fromExtHostTestItem(c,n).toString(),qt.Skipped)}),started:s(c=>{this.proxy.$updateTestStateInRun(t,r,Ie.fromExtHostTestItem(c,n).toString(),qt.Running)}),errored:s((c,u,d)=>{o(c,u),this.proxy.$updateTestStateInRun(t,r,Ie.fromExtHostTestItem(c,n).toString(),qt.Errored,d)}),failed:s((c,u,d)=>{o(c,u),this.proxy.$updateTestStateInRun(t,r,Ie.fromExtHostTestItem(c,n).toString(),qt.Failed,d)}),passed:s((c,u)=>{this.proxy.$updateTestStateInRun(t,r,Ie.fromExtHostTestItem(c,this.dto.controllerId).toString(),qt.Passed,u)}),appendOutput:(c,u,d)=>{a||(d&&this.ensureTestIsKnown(d),this.proxy.$appendOutputToRun(t,r,De.fromString(c),u&&zi.from(u),d&&Ie.fromExtHostTestItem(d,n).toString()))},end:()=>{a||(a=!0,this.proxy.$finishedTestRunTask(t,r),--this.running||this.markEnded())}};return this.running++,this.tasks.set(r,{run:l}),this.proxy.$startedTestRunTask(t,{id:r,ctrlId:this.dto.controllerId,name:e,running:!0}),l}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==Qs.Ended&&(this.state=Qs.Ended,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof ha))throw new hp(e.id);if(this.sharedTestIds.has(Ie.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],n=this.dto.colllection.root;for(;;){const r=Bs.from(e);if(t.unshift(r),this.sharedTestIds.has(r.extId)||(this.sharedTestIds.add(r.extId),e===n))break;e=e.parent||n}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}}class z6{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.trackedById=new Map}getCoverageDetails(e,t,n){var s;const r=Ie.root(e);return((s=this.trackedById.get(r))==null?void 0:s.getCoverageDetails(e,t,n))||[]}disposeTestRun(e){var t;(t=this.trackedById.get(e))==null||t.dispose(),this.trackedById.delete(e);for(const[n,{id:r}]of this.tracked)r===e&&this.tracked.delete(n)}prepareForMainThreadTestRun(e,t,n,r,s){return this.getTracker(t,n,r,e,s)}cancelRunById(e){var t;(t=this.trackedById.get(e))==null||t.cancel()}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,n,r,s,o){var d,f;const a=this.tracked.get(r);if(a)return a.createRun(s);const l=mh.fromPublic(t,n,r,o),c=YD(r);this.proxy.$startedExtensionTestRun({controllerId:t,continuous:!!r.continuous,profile:c&&{group:Bb[c.kind],id:c.profileId},exclude:((d=r.exclude)==null?void 0:d.map(p=>Ie.fromExtHostTestItem(p,n.root.id).toString()))??[],id:l.id,include:((f=r.include)==null?void 0:f.map(p=>Ie.fromExtHostTestItem(p,n.root.id).toString()))??[n.root.id],preserveFocus:r.preserveFocus??!0,persist:o});const u=this.getTracker(r,l,r.profile,e);return Ht.once(u.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(l.id)}),u.createRun(s)}getTracker(e,t,n,r,s){const o=new V6(t,this.proxy,this.logService,n,r,s);return this.tracked.set(e,o),this.trackedById.set(o.id,o),o}}const YD=i=>{if(i.profile){if(!(i.profile instanceof KD))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return i.profile}};class mh{static fromPublic(e,t,n,r){return new mh(e,Un(),r,t)}static fromInternal(e,t){return new mh(e.controllerId,e.runId,!0,t)}constructor(e,t,n,r){this.controllerId=e,this.id=t,this.isPersisted=n,this.colllection=r}}class q6{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,Bs.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const t=Ie.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:n}=this;return{get added(){return[...e].map(r=>r.revived)},get updated(){return[...t].map(r=>r.revived)},get removed(){return[...n].map(r=>r.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}}class j6 extends wP{constructor(){super(...arguments),this.changeEmitter=new L,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:Bs.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new q6(this.changeEmitter)}}class G6{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:R1(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){var t;return(t=this.current)==null?void 0:t.tests.getMirroredTestDataByReference(e)}applyDiff(e){var t;(t=this.current)==null||t.tests.apply(e)}createObserverData(){const e=new j6({asCanonicalUri:t=>t});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}}const _h=(i,e,t,n)=>{t?Object.assign(t,n):e.$updateTestRunConfig(i.controllerId,i.profileId,n)};class KD{constructor(e,t,n,r,s,o,a,l,c,u=!1,d=void 0,f=!1){me(this,Zn);me(this,La);me(this,Wh);me(this,wn);me(this,Mc);this.controllerId=s,this.profileId=o,this._label=a,this.kind=l,this.runHandler=c,this._tag=d,this._supportsContinuousRun=f,te(this,Zn,e),te(this,Mc,t),te(this,La,n),te(this,Wh,r),t.set(o,this);const p=Bb[l];if(typeof p!="number")throw new Error(`Unknown TestRunProfile.group ${l}`);u&&n.add(o),te(this,wn,{profileId:o,controllerId:s,tag:d?Jn.namespace(this.controllerId,d.id):null,label:a,group:p,isDefault:u,hasConfigurationHandler:!1,supportsContinuousRun:f}),queueMicrotask(()=>{I(this,wn)&&(I(this,Zn).$publishTestRunProfile(I(this,wn)),te(this,wn,void 0))})}get label(){return this._label}set label(e){e!==this._label&&(this._label=e,_h(this,I(this,Zn),I(this,wn),{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,_h(this,I(this,Zn),I(this,wn),{supportsContinuousRun:e}))}get isDefault(){return I(this,La).has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?I(this,La).add(this.profileId):I(this,La).delete(this.profileId),_h(this,I(this,Zn),I(this,wn),{isDefault:e}))}get tag(){return this._tag}set tag(e){var t;(e==null?void 0:e.id)!==((t=this._tag)==null?void 0:t.id)&&(this._tag=e,_h(this,I(this,Zn),I(this,wn),{tag:e?Jn.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,_h(this,I(this,Zn),I(this,wn),{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return Ht.chain(I(this,Wh),e=>e.map(t=>{var n;return(n=t.get(this.controllerId))==null?void 0:n.get(this.profileId)}).filter(yo))}dispose(){var e;(e=I(this,Mc))!=null&&e.delete(this.profileId)&&(te(this,Mc,void 0),I(this,Zn).$removeTestProfile(this.controllerId,this.profileId)),te(this,wn,void 0)}}Zn=new WeakMap,La=new WeakMap,Wh=new WeakMap,wn=new WeakMap,Mc=new WeakMap;const Bb={[Zl.Coverage]:en.Coverage,[Zl.Debug]:en.Debug,[Zl.Run]:en.Run};function Q6(i,e){for(let t=0;t<i.path.length;t++){const n=e.find(r=>r.id===i.path[t]);if(!n)return;if(t===i.path.length-1)return n;e=n.children}}const ZD=ke("IExtHostDebugService");let Wb=class extends Re{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){var e;return(e=this._activeDebugSession)==null?void 0:e.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,n,r,s,o,a,l){super(),this._workspaceService=t,this._extensionService=n,this._configurationService=r,this._editorTabs=s,this._variableResolver=o,this._commands=a,this._testing=l,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=this._register(new L),this._onDidTerminateDebugSession=this._register(new L),this._onDidChangeActiveDebugSession=this._register(new L),this._onDidReceiveDebugSessionCustomEvent=this._register(new L),this._debugServiceProxy=e.getProxy(Z.MainThreadDebugService),this._onDidChangeBreakpoints=this._register(new L),this._onDidChangeActiveStackItem=this._register(new L),this._activeDebugConsole=new X6(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(c=>{this._register(c.onDidChange(u=>{this.registerAllDebugTypes(c)})),this.registerAllDebugTypes(c)})}async $getVisualizerTreeItem(e,t){var s,o;const n=this.hydrateVisualizationContext(t);if(!n)return;const r=await((o=(s=this._debugVisualizationTrees.get(e))==null?void 0:s.getTreeItem)==null?void 0:o.call(s,n));return r?this.convertVisualizerTreeItem(e,r):void 0}registerDebugVisualizationTree(e,t,n){const r=ot.toKey(e.identifier),s=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(s,n),this._debugServiceProxy.$registerDebugVisualizerTree(s,!!n.editItem),Me(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(s),this._debugVisualizationTrees.delete(t)})}async $getVisualizerTreeItemChildren(e,t){var s,o,a;const n=(s=this._debugVisualizationElements.get(t))==null?void 0:s.item;if(!n)return[];const r=await((a=(o=this._debugVisualizationTrees.get(e))==null?void 0:o.getChildren)==null?void 0:a.call(o,n));return(r==null?void 0:r.map(l=>this.convertVisualizerTreeItem(e,l)))||[]}async $editVisualizerTreeItem(e,t){var s,o;const n=this._debugVisualizationElements.get(e);if(!n)return;const r=await((o=(s=this._debugVisualizationTrees.get(n.provider))==null?void 0:s.editItem)==null?void 0:o.call(s,n.item,t));return this.convertVisualizerTreeItem(n.provider,r||n.item)}$disposeVisualizedTree(e){var r;const t=this._debugVisualizationElements.get(e);if(!t)return;const n=[t.children];for(const s of n)if(s)for(const o of s)n.push((r=this._debugVisualizationElements.get(o))==null?void 0:r.children),this._debugVisualizationElements.delete(o)}convertVisualizerTreeItem(e,t){let n=this._debugVisualizationTreeItemIds.get(t);return n||(n=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,n),this._debugVisualizationElements.set(n,{provider:e,item:t})),Iw.from(t,n)}asDebugSourceUri(e,t){const n=e;if(typeof n.sourceReference=="number"&&n.sourceReference>0){let r=`debug:${encodeURIComponent(n.path||"")}`,s="?";return t&&(r+=`${s}session=${encodeURIComponent(t.id)}`,s="&"),r+=`${s}ref=${n.sourceReference}`,y.parse(r)}else{if(n.path)return y.file(n.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}registerAllDebugTypes(e){const t=[];for(const n of e.getAllExtensionDescriptions())if(n.contributes){const r=n.contributes.debuggers;if(r&&r.length>0)for(const s of r)O6(s)&&t.push(s.type)}this._debugServiceProxy.$registerDebugTypes(t)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];return this._breakpoints.forEach(t=>e.push(t)),e}async $resolveDebugVisualizer(e,t){var a;const n=this._visualizers.get(e);if(!n)throw new Error(`No debug visualizer found with id '${e}'`);let{v:r,provider:s,extensionId:o}=n;if(r.visualization||(r=await((a=s.resolveDebugVisualization)==null?void 0:a.call(s,r,t))||r,n.v=r),!r.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${s}'`);return this.serializeVisualization(o,r.visualization)}async $executeDebugVisualizerCommand(e){const t=this._visualizers.get(e);if(!t)throw new Error(`No debug visualizer found with id '${e}'`);const n=t.v.visualization;n&&"command"in n&&this._commands.executeCommand(n.command,...n.arguments||[])}hydrateVisualizationContext(e){const t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,n,r){const s=this.hydrateVisualizationContext(n),o=this.extensionVisKey(e,t),a=this._debugVisualizationProviders.get(o);if(!s||!a)return[];const l=await a.provideDebugVisualization(s,r);return l?l.map(c=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:c,provider:a,extensionId:e});const d=c.iconPath?this.getIconPathOrClass(c.iconPath):void 0;return{id:u,name:c.name,iconClass:d==null?void 0:d.iconClass,iconPath:d==null?void 0:d.iconPath,visualization:this.serializeVisualization(e,c.visualization)}}):[]}$disposeDebugVisualizers(e){for(const t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,n){var o,a;if(!((a=(o=e.contributes)==null?void 0:o.debugVisualizers)!=null&&a.some(l=>l.id===t)))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);const r=ot.toKey(e.identifier),s=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(s,n),this._debugServiceProxy.$registerDebugVisualizer(r,t),Me(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(r,t),this._debugVisualizationProviders.delete(t)})}addBreakpoints(e){const t=e.filter(s=>{const o=s.id;return this._breakpoints.has(o)?!1:(this._breakpoints.set(o,s),!0)});this.fireBreakpointChanges(t,[],[]);const n=[],r=new Map;for(const s of t)if(s instanceof ta){let o=r.get(s.location.uri.toString());o||(o={type:"sourceMulti",uri:s.location.uri,lines:[]},r.set(s.location.uri.toString(),o),n.push(o)),o.lines.push({id:s.id,enabled:s.enabled,condition:s.condition,hitCondition:s.hitCondition,logMessage:s.logMessage,line:s.location.range.start.line,character:s.location.range.start.character,mode:s.mode})}else s instanceof ia&&n.push({type:"function",id:s.id,enabled:s.enabled,hitCondition:s.hitCondition,logMessage:s.logMessage,condition:s.condition,functionName:s.functionName,mode:s.mode});return this._debugServiceProxy.$registerBreakpoints(n)}removeBreakpoints(e){const t=e.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],t,[]);const n=t.filter(o=>o instanceof ta).map(o=>o.id),r=t.filter(o=>o instanceof ia).map(o=>o.id),s=t.filter(o=>o instanceof Yp).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(n,r,s)}startDebugging(e,t,n){var s,o,a;const r=n.testRun&&this._testing.getMetadataForRun(n.testRun);return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:n.parentSession?n.parentSession.id:void 0,lifecycleManagedByParent:n.lifecycleManagedByParent,repl:n.consoleMode===og.MergeWithParent?"mergeWithParent":"separate",noDebug:n.noDebug,compact:n.compact,suppressSaveBeforeStart:n.suppressSaveBeforeStart,testRun:r&&{runId:r.runId,taskId:r.taskId},suppressDebugStatusbar:n.suppressDebugStatusbar??((s=n.debugUI)==null?void 0:s.simple),suppressDebugToolbar:n.suppressDebugToolbar??((o=n.debugUI)==null?void 0:o.simple),suppressDebugView:n.suppressDebugView??((a=n.debugUI)==null?void 0:a.simple)})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,n){if(!t)return new Qe(()=>{});const r=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:r,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,n,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,r),new Qe(()=>{this._configProviders=this._configProviders.filter(s=>s.provider!==t),this._debugServiceProxy.$unregisterDebugConfigurationProvider(r)})}registerDebugAdapterDescriptorFactory(e,t,n){if(!n)return new Qe(()=>{});if(!this.definesDebugType(e,t))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const r=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:r,factory:n}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,r),new Qe(()=>{this._adapterFactories=this._adapterFactories.filter(s=>s.factory!==n),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(r)})}registerDebugAdapterTrackerFactory(e,t){if(!t)return new Qe(()=>{});const n=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:n,factory:t}),new Qe(()=>{this._trackerFactories=this._trackerFactories.filter(r=>r.factory!==t)})}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let n;const r=await this.getFolder(e);return r&&(n={uri:r.uri,name:r.name,index:r.index,toResource:()=>{throw new Error("Not implemented")}}),(await this._variableResolver.getResolver()).resolveAnyAsync(n,t)}createDebugAdapter(e,t){if(e.type==="implementation")return new K6(e.implementation)}createSignService(){}async $startDASession(e,t){const n=this,r=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(r.type),r).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}' (extension might have failed to activate)`);const o=this.convertToDto(s),a=this.createDebugAdapter(o,r);if(!a)throw new Error(`Couldn't create a debug adapter for type '${r.type}'.`);const l=a;return this._debugAdapters.set(e,l),this.getDebugAdapterTrackers(r).then(c=>(c&&this._debugAdaptersTrackers.set(e,c),l.onMessage(async u=>{if(u.type==="request"&&u.command==="handshake"){const d=u,f={type:"response",seq:0,command:d.command,request_seq:d.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(this._signService){const p=await this._signService.sign(d.arguments.value);f.body={signature:p},l.sendResponse(f)}else throw new Error("no signer")}catch(p){f.success=!1,f.message=p.message,l.sendResponse(f)}}else c&&c.onDidSendMessage&&c.onDidSendMessage(u),u=U6(u,!0),n._debugServiceProxy.$acceptDAMessage(e,u)}),l.onError(u=>{c&&c.onError&&c.onError(u),this._debugServiceProxy.$acceptDAError(e,u.name,u.message,u.stack)}),l.onExit(u=>{c&&c.onExit&&c.onExit(u??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,u??void 0,void 0)}),c&&c.onWillStartSession&&c.onWillStartSession(),l.startSession()))})}$sendDAMessage(e,t){t=$6(t,!1);const n=this._debugAdaptersTrackers.get(e);n&&n.onWillReceiveMessage&&n.onWillReceiveMessage(t);const r=this._debugAdapters.get(e);r==null||r.sendMessage(t)}$stopDASession(e){const t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();const n=this._debugAdapters.get(e);return this._debugAdapters.delete(e),n?n.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){const t=[],n=[],r=[];if(e.added)for(const s of e.added){const o=s.id;if(o&&!this._breakpoints.has(o)){let a;if(s.type==="function")a=new ia(s.functionName,s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode);else if(s.type==="data")a=new Yp(s.label,s.dataId,s.canPersist,s.enabled,s.hitCondition,s.condition,s.logMessage,s.mode);else{const l=y.revive(s.uri);a=new ta(new gn(l,new He(s.line,s.character)),s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode)}L8(a,o),this._breakpoints.set(o,a),t.push(a)}}if(e.removed)for(const s of e.removed){const o=this._breakpoints.get(s);o&&(this._breakpoints.delete(s),n.push(o))}if(e.changed){for(const s of e.changed)if(s.id){const o=this._breakpoints.get(s.id);if(o){if(o instanceof ia&&s.type==="function"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.functionName=s.functionName}else if(o instanceof ta&&s.type==="source"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.location=new gn(y.revive(s.uri),new He(s.line,s.character))}r.push(o)}}}this.fireBreakpointChanges(t,n,r)}async $acceptStackFrameFocus(e){let t;if(e){const n=await this.getSession(e.sessionId);e.kind==="thread"?t=new i4(n.api,e.threadId):t=new t4(n.api,e.threadId,e.frameId)}this._activeStackItem=t,this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,t,n){return xi(async()=>{const r=this.getConfigProviderByHandle(e);if(!r)throw new Error("no DebugConfigurationProvider found");if(!r.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const s=await this.getFolder(t);return r.provideDebugConfigurations(s,n)}).then(r=>{if(!r)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return r})}$resolveDebugConfiguration(e,t,n,r){return xi(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.getFolder(t);return s.resolveDebugConfiguration(o,n,r)})}$resolveDebugConfigurationWithSubstitutedVariables(e,t,n,r){return xi(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.getFolder(t);return s.resolveDebugConfigurationWithSubstitutedVariables(o,n,r)})}async $provideDebugAdapter(e,t){const n=this.getAdapterDescriptorFactoryByHandle(e);if(!n)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const r=await this.getSession(t);return this.getAdapterDescriptor(n,r).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}'`);return this.convertToDto(s)})}async $acceptDebugSessionStarted(e){const t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){const t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){var t;this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire((t=this._activeDebugSession)==null?void 0:t.api)}async $acceptDebugSessionNameChanged(e,t){const n=await this.getSession(e);n==null||n._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){const r={session:(await this.getSession(e)).api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(r)}convertToDto(e){if(e instanceof Kp)return{type:"executable",command:e.command,args:e.args,options:e.options};if(e instanceof Ed)return{type:"server",port:e.port,host:e.host};if(e instanceof Zp)return{type:"pipeServer",path:e.path};if(e instanceof eg)return{type:"implementation",implementation:e.implementation};throw new Error("convertToDto unexpected type")}getAdapterDescriptorFactoryByType(e){const t=this._adapterFactories.filter(n=>n.type===e);if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){const t=this._adapterFactories.filter(n=>n.handle===e);if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){const t=this._configProviders.filter(n=>n.handle===e);if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){const n=e.contributes.debuggers;if(n&&n.length>0){for(const r of n)if(r.label&&r.type&&r.type===t)return!0}}return!1}getDebugAdapterTrackers(e){const n=e.configuration.type,r=this._trackerFactories.filter(s=>s.type===n||s.type==="*").map(s=>xi(()=>s.factory.createDebugAdapterTracker(e.api)).then(o=>o,o=>null));return Promise.race([Promise.all(r).then(s=>{const o=Ti(s);if(o.length>0)return new Y6(o)}),new Promise(s=>setTimeout(()=>s(void 0),1e3))]).catch(s=>{})}async getAdapterDescriptor(e,t){const n=t.configuration.debugServer;if(typeof n=="number")return Promise.resolve(new Ed(n));if(e){const s=await this._extensionService.getExtensionRegistry();return xi(()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,s))).then(o=>{if(o)return o})}const r=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,r))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,n){(e.length>0||t.length>0||n.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:n}))}async getSession(e){if(e)if(typeof e=="string"){const t=this._debugSessions.get(e);if(t)return t}else{let t=this._debugSessions.get(e.id);if(!t){const n=await this.getFolder(e.folderUri),r=e.parent?this._debugSessions.get(e.parent):void 0;t=new J6(this._debugServiceProxy,e.id,e.type,e.name,n,e.configuration,r==null?void 0:r.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}throw new Error("cannot find session")}getFolder(e){if(e){const t=y.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if("title"in t&&"command"in t)return{type:Ep.Command};if("treeId"in t)return{type:Ep.Tree,id:`${e}\0${t.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(e){const t=this.getIconUris(e);let n,r;return"id"in t?r=Si.asClassName(t):n=t,{iconPath:n,iconClass:r}}getIconUris(e){if(e instanceof Oi)return{id:e.id};const t=typeof e=="object"&&"dark"in e?e.dark:e,n=typeof e=="object"&&"light"in e?e.light:e;return{dark:typeof t=="string"?y.file(t):t,light:typeof n=="string"?y.file(n):n}}};Wb=B([O(0,it),O(1,ts),O(2,js),O(3,is),O(4,gh),O(5,Mb),O(6,fa),O(7,bm)],Wb);class J6{constructor(e,t,n,r,s,o,a){this._debugServiceProxy=e,this._id=t,this._type=n,this._name=r,this._workspaceFolder=s,this._configuration=o,this._parentSession=a}get api(){const e=this;return this.apiSession??(this.apiSession=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,n){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,n)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}}))}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class X6{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}}class Y6{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(n=>n.onExit?n.onExit(e,t):void 0)}}class K6 extends N6{constructor(e){super(),this.implementation=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}}let Vb=class extends Wb{constructor(e,t,n,r,s,o,a,l){super(e,t,n,r,s,o,a,l)}};Vb=B([O(0,it),O(1,ts),O(2,js),O(3,is),O(4,gh),O(5,Mb),O(6,fa),O(7,bm)],Vb);class Z6{constructor(e,t,n){this.config=e,this.provider=t,this.sessionToken=n,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&Ll(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&Ll(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise((n,r)=>{const s=o=>{this.resultCount++,e(o)};if(this.isCanceled)return n({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(o=>{const a=o.toString(),l=Yi(a);this.globalExcludePattern&&this.globalExcludePattern(a,l)||this.matchFile(s,{base:o,basename:l})}),Promise.all(t.map(o=>this.searchInFolder(o,s))).then(o=>{n({limitHit:this.isLimitHit,stats:o[0]||void 0})},o=>{r(new Error($o(o)))})})}async searchInFolder(e,t){const n=new Qt,r=this.getSearchOptionsForFolder(e),s=this.initDirectoryTree(),o=new A4(this.config,e),a=!o.hasSiblingExcludeClauses();let l;try{this.activeCancellationTokens.add(n),l=Rr.create();const c=await this.provider.provideFileSearchResults({pattern:this.config.filePattern||""},r,n.token),u=l.elapsed(),d=Rr.create();return this.isCanceled&&!this.isLimitHit||(c&&c.forEach(f=>{const p=tt.relative(e.folder.path,f.path);if(a){const b=Yi(f.path);this.matchFile(t,{base:e.folder,relativePath:p,basename:b});return}this.addDirectoryEntries(s,e.folder,p,t)}),this.isCanceled&&!this.isLimitHit)?null:(this.matchDirectoryTree(s,o,t),{providerTime:u,postProcessTime:d.elapsed()})}finally{n.dispose(),this.activeCancellationTokens.delete(n)}}getSearchOptionsForFolder(e){const t=im(this.config.includePattern,e.includePattern),n=im(this.config.excludePattern,e.excludePattern);return{folder:e.folder,excludes:n,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,maxResults:this.config.maxResults,session:this.sessionToken}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,n,r){if(n===this.filePattern){const o=Yi(this.filePattern);this.matchFile(r,{base:t,relativePath:this.filePattern,basename:o})}function s(o){const a=Yi(o),l=vo(o);let c=e[l];c||(c=e[l]=[],s(l)),c.push({base:t,relativePath:o,basename:a})}s(n)}matchDirectoryTree({rootEntries:e,pathToEntries:t},n,r){const s=this,o=this.filePattern;function a(l){const c=oA(()=>l.map(u=>u.basename));for(let u=0,d=l.length;u<d;u++){const f=l[u],{relativePath:p,basename:b}=f;if(n.matchesExcludesSync(p,b,o!==b?c:void 0))continue;const w=t[p];if(w)a(w);else{if(p===o)continue;s.matchFile(r,f)}if(s.isLimitHit)break}}a(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}}const t1=class t1{constructor(){this.sessions=new Map}fileSearch(e,t,n,r){const s=this.getSessionTokenSource(e.cacheKey),o=new Z6(e,t,s&&s.token);let a=0;const l=c=>{a+=c.length,n(c.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,t1.BATCH_SIZE,l,r).then(c=>({limitHit:c.limitHit,stats:c.stats?{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:c.stats}:void 0,messages:[]}))}clearCache(e){const t=this.getSessionTokenSource(e);t==null||t.cancel()}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new Qt),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:Li(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,n,r){const s=r.onCancellationRequested(()=>{e.cancel()}),o=l=>{l&&(a.push(l),t>0&&a.length>=t&&(n(a),a=[]))};let a=[];return e.search(o).then(l=>(a.length&&n(a),s.dispose(),l),l=>(a.length&&n(a),s.dispose(),Promise.reject(l)))}};t1.BATCH_SIZE=512;let zb=t1;class ek{constructor(e,t,n){this.queryProviderPair=e,this.fileUtils=t,this.processType=n,this.collector=null,this.isLimitHit=!1,this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,t){const n=this.query.folderQueries||[],r=new Qt(t);return new Promise((s,o)=>{this.collector=new tR(e);let a=!1;const l=(c,u)=>{if(!a&&!this.isLimitHit){const d=this.resultSize(c);vh(c)&&typeof this.query.maxResults=="number"&&this.resultCount+d>this.query.maxResults&&(this.isLimitHit=!0,a=!0,r.cancel(),c=this.trimResultToSize(c,this.query.maxResults-this.resultCount));const f=this.resultSize(c);this.resultCount+=f,(f>0||!vh(c))&&this.collector.add(c,u)}};Promise.all(n.map((c,u)=>this.searchInFolder(c,d=>l(d,u),r.token))).then(c=>{r.dispose(),this.collector.flush();const u=c.some(d=>!!d&&!!d.limitHit);s({limitHit:this.isLimitHit||u,messages:c.flatMap(d=>d!=null&&d.message?Array.isArray(d.message)?d.message:[d.message]:[]),stats:{type:this.processType}})},c=>{r.dispose();const u=$o(c);o(new Error(u))})})}resultSize(e){return vh(e)?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){const n=Array.isArray(e.ranges)?e.ranges:[e.ranges],r=Array.isArray(e.preview.matches)?e.preview.matches:[e.preview.matches];return{ranges:n.slice(0,t),preview:{matches:r.slice(0,t),text:e.preview.text},uri:e.uri}}async searchInFolder(e,t,n){const r=new A4(this.query,e),s=[],o={report:c=>{if(!this.validateProviderResult(c))return;const u=e.folder.scheme===le.file?sA(()=>this.fileUtils.readdir(i_(c.uri))):void 0,d=Ox(e.folder,c.uri);if(d){const f=r.includedInQuery(d,Yi(d),u);Cs(f)?s.push(f.then(p=>{p&&t(c)})):f&&t(c)}}},a=this.getSearchOptionsForFolder(e);let l;return this.queryProviderPair.query.type===fc.aiText?l=await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,a,o,n):l=await this.queryProviderPair.provider.provideTextSearchResults(eR(this.queryProviderPair.query.contentPattern),a,o,n),s.length&&await Promise.all(s),l}validateProviderResult(e){if(vh(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}getSearchOptionsForFolder(e){const t=im(this.query.includePattern,e.includePattern),n=im(this.query.excludePattern,e.excludePattern),r={folder:y.from(e.folder),excludes:n,includes:t,useIgnoreFiles:!e.disregardIgnoreFiles,useGlobalIgnoreFiles:!e.disregardGlobalIgnoreFiles,useParentIgnoreFiles:!e.disregardParentIgnoreFiles,followSymlinks:!e.ignoreSymlinks,encoding:e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults??Y8,previewOptions:this.query.previewOptions,afterContext:this.query.afterContext,beforeContext:this.query.beforeContext};return"usePCRE2"in this.query&&(r.usePCRE2=this.query.usePCRE2),r}}function eR(i){return{isCaseSensitive:i.isCaseSensitive||!1,isRegExp:i.isRegExp||!1,isWordMatch:i.isWordMatch||!1,isMultiline:i.isMultiline||!1,pattern:i.pattern}}class tR{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new qb(512,t=>this.sendItems(t))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!Nx(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(iR(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function iR(i){return vh(i)?{preview:{matches:du(i.preview.matches,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character})),text:i.preview.text},ranges:du(i.ranges,e=>({startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character}))}:{text:i.text,lineNumber:i.lineNumber}}function vh(i){return!!i.preview}const $c=class $c{constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<$c.START_BATCH_AFTER_COUNT?this.flush():this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout(()=>{this.flush()},$c.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}};$c.TIMEOUT=4e3,$c.START_BATCH_AFTER_COUNT=50;let qb=$c;const tk=ke("IExtHostSearch");let jb=class{constructor(e,t,n){this.extHostRpc=e,this._uriTransformer=t,this._logService=n,this._proxy=this.extHostRpc.getProxy(Z.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._aiTextSearchProvider=new Map,this._aiTextSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new zb}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const n=this._handlePool++;return this._textSearchProvider.set(n,t),this._proxy.$registerTextSearchProvider(n,this._transformScheme(e)),Me(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}registerAITextSearchProvider(e,t){if(this._aiTextSearchUsedSchemes.has(e))throw new Error(`an AI text search provider for the scheme '${e}'is already registered`);this._aiTextSearchUsedSchemes.add(e);const n=this._handlePool++;return this._aiTextSearchProvider.set(n,t),this._proxy.$registerAITextSearchProvider(n,this._transformScheme(e)),Me(()=>{this._aiTextSearchUsedSchemes.delete(e),this._aiTextSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const n=this._handlePool++;return this._fileSearchProvider.set(n,t),this._proxy.$registerFileSearchProvider(n,this._transformScheme(e)),Me(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}$provideFileSearchResults(e,t,n,r){const s=Gb(n),o=this._fileSearchProvider.get(e);if(o)return this._fileSearchManager.fileSearch(s,o,a=>{this._proxy.$handleFileMatch(e,t,a.map(l=>l.resource))},r);throw new Error("3 unknown provider: "+e)}async doInternalFileSearchWithCustomCallback(e,t,n){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,n,r){const s=this._textSearchProvider.get(e);if(!s||!s.provideTextSearchResults)throw new Error(`Unknown Text Search Provider ${e}`);const o=Gb(n);return this.createTextSearchManager(o,s).search(l=>this._proxy.$handleTextMatch(e,t,l),r)}$provideAITextSearchResults(e,t,n,r){const s=this._aiTextSearchProvider.get(e);if(!s||!s.provideAITextSearchResults)throw new Error(`Unknown AI Text Search Provider ${e}`);const o=Gb(n);return this.createAITextSearchManager(o,s).search(l=>this._proxy.$handleTextMatch(e,t,l),r)}$enableExtensionHostSearch(){}createTextSearchManager(e,t){return new ek({query:e,provider:t},{readdir:n=>Promise.resolve([]),toCanonicalName:n=>n},"textSearchProvider")}createAITextSearchManager(e,t){return new ek({query:e,provider:t},{readdir:n=>Promise.resolve([]),toCanonicalName:n=>n},"aiTextSearchProvider")}};jb=B([O(0,it),O(1,If),O(2,rt)],jb);function Gb(i){return{...i,folderQueries:i.folderQueries&&i.folderQueries.map(nR),extraFileResources:i.extraFileResources&&i.extraFileResources.map(e=>y.revive(e))}}function nR(i){return{...i,folder:y.revive(i.folder)}}var Qb;let Jb=(Na=class{getState(){const e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e){this._onDidChangeWindowState=new L,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=Qb.InitialState,this._proxy=e.getProxy(Z.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:t,isActive:n})=>{this.onDidChangeWindowProperty("focused",t),this.onDidChangeWindowProperty("active",n)})}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let n;if(typeof e=="string"){n=e;try{e=y.parse(e)}catch{return Promise.reject(`Invalid uri - '${e}'`)}}return yu(e.scheme)?Promise.reject("Invalid scheme - cannot be empty"):e.scheme===le.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,n,t)}async asExternalUri(e,t){if(yu(e.scheme))return Promise.reject("Invalid scheme - cannot be empty");const n=await this._proxy.$asExternalUri(e,t);return y.from(n)}},Qb=Na,Na.InitialState={focused:!0,active:!0},Na);Jb=Qb=B([O(0,it)],Jb);const ik=ke("IExtHostWindow"),nk=ke("IExtHostTerminalShellIntegration");let Xb=class extends Re{constructor(e,t){super(),this._extHostTerminalService=t,this._activeShellIntegrations=new Map,this._onDidChangeTerminalShellIntegration=new L,this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event,this._onDidStartTerminalShellExecution=new L,this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event,this._onDidEndTerminalShellExecution=new L,this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event,this._proxy=e.getProxy(Z.MainThreadTerminalShellIntegration),this._register(Me(()=>{for(const[n,r]of this._activeShellIntegrations)r.dispose();this._activeShellIntegrations.clear()}))}$shellIntegrationChange(e){const t=this._extHostTerminalService.getTerminalById(e);if(!t)return;const n=t.value;let r=this._activeShellIntegrations.get(e);r||(r=new rR(t.value,this._onDidStartTerminalShellExecution),this._activeShellIntegrations.set(e,r),r.store.add(t.onWillDispose(()=>{var s;return(s=this._activeShellIntegrations.get(e))==null?void 0:s.dispose()})),r.store.add(r.onDidRequestShellExecution(s=>this._proxy.$executeCommand(e,s))),r.store.add(r.onDidRequestEndExecution(s=>this._onDidEndTerminalShellExecution.fire(s))),r.store.add(r.onDidRequestChangeShellIntegration(s=>this._onDidChangeTerminalShellIntegration.fire(s))),t.shellIntegration=r.value),this._onDidChangeTerminalShellIntegration.fire({terminal:n,shellIntegration:r.value})}$shellExecutionStart(e,t,n,r,s){var a;this._activeShellIntegrations.has(e)||this.$shellIntegrationChange(e);const o={value:t,confidence:n,isTrusted:r};(a=this._activeShellIntegrations.get(e))==null||a.startShellExecution(o,y.revive(s))}$shellExecutionEnd(e,t,n,r,s){var a;const o={value:t,confidence:n,isTrusted:r};(a=this._activeShellIntegrations.get(e))==null||a.endShellExecution(o,s)}$shellExecutionData(e,t){var n;(n=this._activeShellIntegrations.get(e))==null||n.emitData(t)}$cwdChange(e,t){var n;(n=this._activeShellIntegrations.get(e))==null||n.setCwd(y.revive(t))}$closeTerminal(e){var t;(t=this._activeShellIntegrations.get(e))==null||t.dispose(),this._activeShellIntegrations.delete(e)}};Xb=B([O(0,it),O(1,bc)],Xb);class rR extends Re{get currentExecution(){return this._currentExecution}constructor(e,t){super(),this._terminal=e,this._onDidStartTerminalShellExecution=t,this._ignoreNextExecution=!1,this.store=this._register(new Le),this._onDidRequestChangeShellIntegration=this._register(new L),this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event,this._onDidRequestShellExecution=this._register(new L),this.onDidRequestShellExecution=this._onDidRequestShellExecution.event,this._onDidRequestEndExecution=this._register(new L),this.onDidRequestEndExecution=this._onDidRequestEndExecution.event;const n=this;this.value={get cwd(){return n._cwd},executeCommand(r,s){let o=r;s&&(o+=` "${s.map(c=>`${c.replaceAll('"','\\"')}`).join('" "')}"`),n._onDidRequestShellExecution.fire(o);const a={value:o,confidence:jp.High,isTrusted:!0},l=n.startShellExecution(a,n._cwd,!0).value;return n._ignoreNextExecution=!0,l}}}startShellExecution(e,t,n){if(this._ignoreNextExecution&&this._currentExecution)this._ignoreNextExecution=!1;else{this._currentExecution&&(this._currentExecution.endExecution(void 0),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0}));const r=this._currentExecution=new sR(e,t??this._cwd);n?queueMicrotask(()=>this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:r.value})):this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}return this._currentExecution}emitData(e){var t;(t=this.currentExecution)==null||t.emitData(e)}endShellExecution(e,t){this._currentExecution&&(this._currentExecution.endExecution(e),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:t}),this._currentExecution=void 0)}setCwd(e){let t=!1;y.isUri(this._cwd)?t=!y.isUri(e)||this._cwd.toString()!==e.toString():this._cwd!==e&&(t=!0),t&&(this._cwd=e,this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value}))}}class sR{constructor(e,t){this._commandLine=e,this.cwd=t,this._ended=!1;const n=this;this.value={get commandLine(){return n._commandLine},get cwd(){return n.cwd},read(){return n._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._ended)return So.EMPTY;this._dataStream=new oR}return this._dataStream.createIterable()}emitData(e){var t;(t=this._dataStream)==null||t.emitData(e)}endExecution(e){var t;e&&(this._commandLine=e),(t=this._dataStream)==null||t.endExecution(),this._dataStream=void 0,this._ended=!0}}class oR extends Re{constructor(){super(...arguments),this._emitters=[]}createIterable(){this._barrier||(this._barrier=new rr);const e=this._barrier;return new So(async n=>{this._emitters.push(n),await e.wait()})}emitData(e){for(const t of this._emitters)t.emitOne(e)}endExecution(){var e;(e=this._barrier)==null||e.open(),this._barrier=void 0}}pt(hb,db,ut.Delayed),pt(hl,dm,ut.Delayed),pt(hm,Db,ut.Delayed),pt(fa,Zw,ut.Eager),pt(nb,rb,ut.Eager),pt(ob,ab,ut.Eager),pt(is,$w,ut.Eager),pt(om,Ww,ut.Eager),pt(bm,Hb,ut.Eager),pt(ZD,Vb,ut.Eager),pt(CD,bb,ut.Eager),pt(xc,Sb,ut.Eager),pt(fb,pb,ut.Eager),pt(pl,n7,ut.Eager),pt(kD,wb,ut.Delayed),pt(tk,jb,ut.Eager),pt(Bw,$4,ut.Eager),pt(WD,Nb,ut.Eager),pt(bc,ib,ut.Eager),pt(nk,Xb,ut.Eager),pt(Qw,Jw,ut.Eager),pt(ik,Jb,ut.Eager),pt(ts,Lw,ut.Eager),pt(ub,wD,ut.Eager),pt(lm,Kw,ut.Eager),pt(gh,Ob,ut.Eager),pt(Mb,$b,ut.Eager);function rk(i,e,t,n,r,s){if(Array.isArray(i)){let o=0;for(const a of i){const l=rk(a,e,t,n,r,s);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof i=="string")return n?i==="*"?5:i===t?10:0:0;if(i){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=i;if(!n&&!c)return 0;u&&r&&(e=r);let d=0;if(l)if(l===e.scheme)d=10;else if(l==="*")d=5;else return 0;if(o)if(o===t)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(u)if(u===s)d=10;else if(u==="*"&&s!==void 0)d=Math.max(d,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:nl(a.base)},f===e.fsPath||od(f,e.fsPath))d=10;else return 0}return d}else return 0}}function sk(i){return typeof i=="string"?!1:Array.isArray(i)?i.some(sk):!!i.notebookType}var Yb;(function(i){i[i.None=0]="None",i[i.Indent=1]="Indent",i[i.IndentOutdent=2]="IndentOutdent",i[i.Outdent=3]="Outdent"})(Yb||(Yb={}));var Kb;(function(i){i[i.Complete=100]="Complete",i[i.Partial=50]="Partial",i[i.None=0]="None"})(Kb||(Kb={}));class aR{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(Z.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,n){if(this._relatedInformationProviders.size===0)throw new Error("No related information providers registered");const r=this._relatedInformationProviders.get(e);if(!r)throw new Error("related information provider not found");return await r.provideRelatedInformation(t,n)??[]}getRelatedInformation(e,t,n){return this._proxy.$getAiRelatedInformation(t,n)}registerRelatedInformationProvider(e,t,n){const r=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(r,n),this._proxy.$registerAiRelatedInformationProvider(r,t),new Qe(()=>{this._proxy.$unregisterAiRelatedInformationProvider(r),this._relatedInformationProviders.delete(r)})}}var wh;(function(i){i[i.Full=1]="Full",i[i.Delta=2]="Delta"})(wh||(wh={}));function ok(i){for(let e=0,t=i.length;e<t;e+=4){const n=i[e+0],r=i[e+1],s=i[e+2],o=i[e+3];i[e+0]=o,i[e+1]=s,i[e+2]=r,i[e+3]=n}}function lR(i){const e=new Uint8Array(i.buffer,i.byteOffset,i.length*4);return Jy()||ok(e),De.wrap(e)}function cR(i){const e=i.buffer;if(Jy()||ok(e),e.byteOffset%4===0)return new Uint32Array(e.buffer,e.byteOffset,e.length/4);{const t=new Uint8Array(e.byteLength);return t.set(e),new Uint32Array(t.buffer,t.byteOffset,t.length/4)}}function Zb(i){const e=new Uint32Array(uR(i));let t=0;if(e[t++]=i.id,i.type==="full")e[t++]=wh.Full,e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length;else{e[t++]=wh.Delta,e[t++]=i.deltas.length;for(const n of i.deltas)e[t++]=n.start,e[t++]=n.deleteCount,n.data?(e[t++]=n.data.length,e.set(n.data,t),t+=n.data.length):e[t++]=0}return lR(e)}function uR(i){let e=0;if(e+=2,i.type==="full")e+=1+i.data.length;else{e+=1,e+=3*i.deltas.length;for(const t of i.deltas)t.data&&(e+=t.data.length)}return e}function ak(i){const e=cR(i);let t=0;const n=e[t++];if(e[t++]===wh.Full){const a=e[t++],l=e.subarray(t,t+a);return t+=a,{id:n,type:"full",data:l}}const s=e[t++],o=[];for(let a=0;a<s;a++){const l=e[t++],c=e[t++],u=e[t++];let d;u>0&&(d=e.subarray(t,t+u),t+=u),o[a]={start:l,deleteCount:c,data:d}}return{id:n,type:"delta",deltas:o}}const dR=[new Ee("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[z.Uri,z.Position],new xe("A promise that resolves to an array of DocumentHighlight-instances.",Xn(nc.to))),new Ee("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[z.Uri],new xe("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(i,e)=>{if(P1(i))return;class t extends fd{static to(r){const s=new t(r.name,In.to(r.kind),r.containerName||"",new gn(e[0],H.to(r.range)));return s.detail=r.detail,s.range=s.location.range,s.selectionRange=H.to(r.selectionRange),s.children=r.children?r.children.map(t.to):[],s}}return i.map(t.to)})),new Ee("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[z.Uri,new z("options","Formatting options",i=>!0,i=>i)],new xe("A promise that resolves to an array of TextEdits.",Xn(ni.to))),new Ee("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[z.Uri,z.Range,new z("options","Formatting options",i=>!0,i=>i)],new xe("A promise that resolves to an array of TextEdits.",Xn(ni.to))),new Ee("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[z.Uri,z.Position,new z("ch","Trigger character",i=>typeof i=="string",i=>i),new z("options","Formatting options",i=>!0,i=>i)],new xe("A promise that resolves to an array of TextEdits.",Xn(ni.to))),new Ee("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location or LocationLink instances.",Js)),new Ee("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location-instances.",Xn(zi.to))),new Ee("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Location-instances.",Xn(zi.to))),new Ee("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Hover-instances.",Xn(qd.to))),new Ee("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[z.Uri,z.Position],new xe("A promise that resolves to an array of Hover-instances.",Xn(qd.to))),new Ee("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[z.Uri,new z("position","A position in a text document",i=>Array.isArray(i)&&i.every(e=>He.isPosition(e)),i=>i.map(nt.from))],new xe("A promise that resolves to an array of ranges.",i=>i.map(e=>{let t;for(const n of e.reverse())t=new md(H.to(n),t);return t}))),new Ee("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[z.String.with("query","Search string")],new xe("A promise that resolves to an array of SymbolInformation-instances.",i=>i.map(Vd.to))),new Ee("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[z.Uri,z.Position],new xe("A promise that resolves to an array of CallHierarchyItem-instances",i=>i.map(oa.to))),new Ee("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[z.CallHierarchyItem],new xe("A promise that resolves to an array of CallHierarchyIncomingCall-instances",i=>i.map(nw.to))),new Ee("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[z.CallHierarchyItem],new xe("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",i=>i.map(rw.to))),new Ee("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[z.Uri,z.Position],new xe("A promise that resolves to a range and placeholder text.",i=>{if(i)return{range:H.to(i.range),placeholder:i.text}})),new Ee("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[z.Uri,z.Position,z.String.with("newName","The new symbol name")],new xe("A promise that resolves to a WorkspaceEdit.",i=>{if(i){if(i.rejectReason)throw new Error(i.rejectReason);return Mi.to(i)}})),new Ee("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[z.Uri,z.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new xe("A promise that resolves to an array of DocumentLink-instances.",i=>i.map(aa.to))),new Ee("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[z.Uri],new xe("A promise that resolves to SemanticTokensLegend.",i=>{if(i)return new Iv(i.tokenTypes,i.tokenModifiers)})),new Ee("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[z.Uri],new xe("A promise that resolves to SemanticTokens.",i=>{if(!i)return;const e=ak(i);if(e.type==="full")return new Jl(e.data,void 0)})),new Ee("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[z.Uri,z.Range.optional()],new xe("A promise that resolves to SemanticTokensLegend.",i=>{if(i)return new Iv(i.tokenTypes,i.tokenModifiers)})),new Ee("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[z.Uri,z.Range],new xe("A promise that resolves to SemanticTokens.",i=>{if(!i)return;const e=ak(i);if(e.type==="full")return new Jl(e.data,void 0)})),new Ee("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[z.Uri,z.Position,z.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),z.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new xe("A promise that resolves to a CompletionList-instance.",(i,e,t)=>{if(!i)return new $l([]);const n=i.suggestions.map(r=>cw.to(r,t));return new $l(n,i.incomplete)})),new Ee("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[z.Uri,z.Position,z.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new xe("A promise that resolves to SignatureHelp.",i=>{if(i)return jd.to(i)})),new Ee("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[z.Uri,z.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new xe("A promise that resolves to an array of CodeLens-instances.",(i,e,t)=>Xn(n=>new $p(H.to(n.range),n.command&&t.fromInternal(n.command)))(i))),new Ee("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[z.Uri,new z("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",i=>Fe.isRange(i),i=>Qr.isSelection(i)?Qn.from(i):H.from(i)),z.String.with("kind","Code action kind to return code actions for").optional(),z.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new xe("A promise that resolves to an array of Command-instances.",(i,e,t)=>Xn(n=>{if(n._isSynthetic){if(!n.command)throw new Error("Synthetic code actions must have a command");return t.fromInternal(n.command)}else{const r=new Mp(n.title,n.kind?new St(n.kind):void 0);return n.edit&&(r.edit=Mi.to(n.edit)),n.command&&(r.command=t.fromInternal(n.command)),r.isPreferred=n.isPreferred,r}})(i))),new Ee("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[z.Uri],new xe("A promise that resolves to an array of ColorInformation objects.",i=>i?i.map(e=>new zp(H.to(e.range),rc.to(e.color))):[])),new Ee("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new z("color","The color to show and insert",i=>i instanceof Wl,rc.from),new z("context","Context object with uri and range",i=>!0,i=>({uri:i.uri,range:H.from(i.range)}))],new xe("A promise that resolves to an array of ColorPresentation objects.",i=>i?i.map(Mg.to):[])),new Ee("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[z.Uri,z.Range],new xe("A promise that resolves to an array of Inlay objects",(i,e,t)=>i.map(uw.to.bind(void 0,t)))),new Ee("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[z.Uri],new xe("A promise that resolves to an array of FoldingRange objects",(i,e)=>{if(i)return i.map(Ug.to)})),new Ee("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new xe("A promise that resolves to an array of NotebookContentProvider static info objects.",Xn(i=>({viewType:i.viewType,displayName:i.displayName,options:{transientOutputs:i.options.transientOutputs,transientCellMetadata:i.options.transientCellMetadata,transientDocumentMetadata:i.options.transientDocumentMetadata},filenamePattern:i.filenamePattern.map(e=>Wg.to(e))})))),new Ee("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[z.Uri,z.Range,new z("context","An InlineValueContext",i=>i&&typeof i.frameId=="number"&&i.stoppedLocation instanceof Fe,i=>Ag.from(i))],new xe("A promise that resolves to an array of InlineValue objects",i=>i.map(Tg.to))),new Ee("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new z("uriOrString","Uri-instance or string (only http/https)",i=>y.isUri(i)||typeof i=="string"&&lI(i,le.http,le.https),i=>i),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",i=>i===void 0||typeof i=="number"||typeof i=="object",i=>i&&(typeof i=="number"?[Kt.from(i),void 0]:[Kt.from(i.viewColumn),Gd.from(i)])).optional(),z.String.with("label","").optional()],xe.Void),new Ee("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[z.Uri.with("resource","Resource to open"),z.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",i=>i===void 0||typeof i=="number"||typeof i=="object",i=>i&&(typeof i=="number"?[Kt.from(i),void 0]:[Kt.from(i.viewColumn),Gd.from(i)])).optional()],xe.Void),new Ee("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[z.Uri.with("left","Left-hand side resource of the diff editor"),z.Uri.with("right","Right-hand side resource of the diff editor"),z.String.with("title","Human readable title for the diff editor").optional(),new z("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",i=>i===void 0||typeof i=="object",i=>i&&[Kt.from(i.viewColumn),Gd.from(i)]).optional()],xe.Void),new Ee("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[z.String.with("title","Human readable title for the changes editor"),new z("resourceList","List of resources to compare",i=>{for(const e of i){if(e.length!==3)return!1;const[t,n,r]=e;if(!y.isUri(t)||!y.isUri(n)&&n!==void 0&&n!==null||!y.isUri(r)&&r!==void 0&&r!==null)return!1}return!0},i=>i)],xe.Void),new Ee("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[z.Uri,z.Position],new xe("A promise that resolves to an array of TypeHierarchyItem-instances",i=>i.map(la.to))),new Ee("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[z.TypeHierarchyItem],new xe("A promise that resolves to an array of TypeHierarchyItem-instances",i=>i.map(la.to))),new Ee("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[z.TypeHierarchyItem],new xe("A promise that resolves to an array of TypeHierarchyItem-instances",i=>i.map(la.to))),new Ee("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[z.TestItem],xe.Void),new Ee("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[z.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],xe.Void),new Ee("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[z.String.with("name","The context key name"),new z("value","The context key value",()=>!0,i=>i)],xe.Void),new Ee("vscode.executeMappedEditsProvider","_executeMappedEditsProvider","Execute Mapped Edits Provider",[z.Uri,z.StringArray,new z("MappedEditsContext","Mapped Edits Context",i=>Bg.is(i),i=>Bg.from(i))],new xe("A promise that resolves to a workspace edit or null",i=>i?Mi.to(i):null)),new Ee("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new z("Run arguments","",i=>!0,i=>{if(i)return{initialRange:i.initialRange?H.from(i.initialRange):void 0,initialSelection:Qr.isSelection(i.initialSelection)?Qn.from(i.initialSelection):void 0,message:i.message,autoSend:i.autoSend,position:i.position?nt.from(i.position):void 0}})],xe.Void)];class hR{static register(e){dR.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",w9)}}function Xn(i){return e=>{if(Array.isArray(e))return e.map(i)}}function Js(i){if(!Array.isArray(i))return;const e=[];for(const t of i)fP(t)?e.push(zd.to(t)):e.push(zi.to(t));return e}let e0=class{constructor(e,t){this._proxy=e.getProxy(Z.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:n=>{var r;return(r=t.getDocument(n))==null?void 0:r.version},getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(e,t,n){const r=new un(Mi.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(r,void 0,(n==null?void 0:n.isRefactoring)??!1)}};e0=B([O(0,it)],e0);var lk;(function(i){i[i.Complete=1]="Complete",i[i.Partial=2]="Partial",i[i.Omitted=3]="Omitted"})(lk||(lk={}));var ym;(function(i){i[i.Down=0]="Down",i[i.Up=1]="Up"})(ym||(ym={}));var ck;(function(i){i[i.Action=1]="Action",i[i.Toolbar=2]="Toolbar"})(ck||(ck={}));class fR{constructor(e,t,n,r,s){this._extension=e,this._request=t,this._proxy=n,this._commandsConverter=r,this._sessionDisposables=s,this._stopWatch=Rr.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let t=function(r){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,r),s}};const e=this;this._stopWatch.reset();const n=(r,s)=>{if(typeof this._firstProgress>"u"&&"content"in r&&(this._firstProgress=this._stopWatch.elapsed()),s){const o=this._proxy.$handleProgressChunk(this._request.requestId,r),a={report:l=>{o==null||o.then(c=>{c&&(tn.isMarkdownString(l.value)?this._proxy.$handleProgressChunk(this._request.requestId,eh.from(l),c):this._proxy.$handleProgressChunk(this._request.requestId,Zr.from(l),c))})}};Promise.all([o,s==null?void 0:s(a)]).then(([l,c])=>{l!==void 0&&c!==void 0&&this._proxy.$handleProgressChunk(this._request.requestId,xw.from(c),l)})}else this._proxy.$handleProgressChunk(this._request.requestId,r)};this._apiObject={markdown(r){t(this.markdown);const s=new vg(r),o=Yd.from(s);return n(o),this},markdownWithVulnerabilities(r,s){t(this.markdown),s&&M(e._extension,"chatParticipantAdditions");const o=new Fd(r,s),a=Qg.from(o);return n(a),this},filetree(r,s){t(this.filetree);const o=new bg(r,s),a=Kd.from(o);return n(a),this},anchor(r,s){t(this.anchor);const o=new yg(r,s),a=Zd.from(o);return n(a),this},button(r){t(this.anchor);const s=new xg(r),o=th.from(s,e._commandsConverter,e._sessionDisposables);return n(o),this},progress(r,s){t(this.progress);const o=new f4(r,s),a=s?yw.from(o):dc.from(o);return n(a,s),this},warning(r){t(this.progress),M(e._extension,"chatParticipantAdditions");const s=new Ud(r),o=eh.from(s);return n(o),this},reference(r,s){return this.reference2(r,s)},reference2(r,s,o){var a;if(t(this.reference),"variableName"in r&&M(e._extension,"chatParticipantAdditions"),"variableName"in r&&!r.value){const l=e._request.variables.variables.find(c=>c.name===r.variableName);if(l){let c;if((a=l.references)!=null&&a.length)c=l.references.map(u=>({kind:"reference",reference:{variableName:r.variableName,value:u.reference}}));else{const u=new Yr(r,s,o);c=[Zr.from(u)]}return c.forEach(u=>n(u)),this}}else{const l=new Yr(r,s,o),c=Zr.from(l);n(c)}return this},codeCitation(r,s,o){t(this.codeCitation),M(e._extension,"chatParticipantAdditions");const a=new Eg(r,s,o),l=Kg.from(a);n(l)},textEdit(r,s){t(this.textEdit),M(e._extension,"chatParticipantAdditions");const o=new Hd(r,s),a=Yg.from(o);return n(a),this},detectedParticipant(r,s){t(this.detectedParticipant),M(e._extension,"chatParticipantAdditions");const o=new Md(r,s),a=Jg.from(o);return n(a),this},confirmation(r,s,o,a){t(this.confirmation),M(e._extension,"chatParticipantAdditions");const l=new wg(r,s,o,a),c=Xg.from(l);return n(c),this},push(r){if(t(this.push),(r instanceof Hd||r instanceof Fd||r instanceof Md||r instanceof Ud||r instanceof wg||r instanceof Eg)&&M(e._extension,"chatParticipantAdditions"),r instanceof Yr)this.reference2(r.value,r.iconPath,r.options);else{const s=Zg.from(r,e._commandsConverter,e._sessionDisposables);n(s)}return this}}}return this._apiObject}}const Vh=class Vh extends Re{constructor(e,t,n,r){super(),this._logService=t,this._commands=n,this._documents=r,this._agents=new Map,this._sessionDisposables=this._register(new L1),this._completionDisposables=this._register(new L1),this._proxy=e.getProxy(Z.MainThreadChatAgents2)}transferActiveChat(e){this._proxy.$transferActiveChatSession(e)}createChatAgent(e,t,n){const r=Vh._idPool++,s=new uk(e,t,this._proxy,r,n);return this._agents.set(r,s),this._proxy.$registerAgent(r,e.identifier,t,{},void 0),s.apiAgent}createDynamicChatAgent(e,t,n,r){const s=Vh._idPool++,o=new uk(e,t,this._proxy,s,r);return this._agents.set(s,o),this._proxy.$registerAgent(s,e.identifier,t,{isSticky:!0},n),o.apiAgent}async $invokeAgent(e,t,n,r){var c,u,d;const s=this._agents.get(e);if(!s)throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);const o=Ki(t);let a=this._sessionDisposables.get(o.sessionId);a||(a=new Le,this._sessionDisposables.set(o.sessionId,a));const l=new fR(s.extension,o,this._proxy,this._commands.converter,a);try{const f=await this.prepareHistoryTurns(o.agentId,n);let p;if(((c=o.locationData)==null?void 0:c.type)===Wi.Editor){const w=this._documents.getDocument(o.locationData.document);p=new m4(w,Qn.to(o.locationData.selection),H.to(o.locationData.wholeRange))}else if(((u=o.locationData)==null?void 0:u.type)===Wi.Notebook){const w=this._documents.getDocument(o.locationData.sessionInputUri);p=new _4(w)}else(d=o.locationData)==null||d.type,Wi.Terminal;const b=s.invoke(Ew.to(o,p),{history:f},l.apiObject,r);return await wI(Promise.resolve(b).then(w=>{if(w!=null&&w.metadata)try{JSON.stringify(w.metadata)}catch(S){const k=`result.metadata MUST be JSON.stringify-able. Got error: ${S.message}`;return this._logService.error(`[${s.extension.identifier.value}] [@${s.id}] ${k}`,s.extension),{errorDetails:{message:k},timings:l.timings}}let v;return w!=null&&w.errorDetails&&(v={...w.errorDetails,responseIsIncomplete:!0}),v!=null&&v.responseIsRedacted&&M(s.extension,"chatParticipantPrivate"),{errorDetails:v,timings:l.timings,metadata:w==null?void 0:w.metadata}}),r)}catch(f){return this._logService.error(f,s.extension),f instanceof Fi&&f.cause&&(f=f.cause),{errorDetails:{message:$o(f),responseIsIncomplete:!0}}}finally{l.close()}}async prepareHistoryTurns(e,t){const n=[];for(const r of t.history){const s=hc.to(r.result),o=e===r.request.agentId?s:{...s,metadata:void 0},a=r.request.variables.variables.filter(c=>!c.isTool).map(em.to);n.push(new p4(r.request.message,r.request.command,a,r.request.agentId));const l=Ti(r.response.map(c=>Zg.toContent(c,this._commands.converter)));n.push(new g4(l,o,r.request.agentId,r.request.command))}return n}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e)}async $provideFollowups(e,t,n,r,s){const o=this._agents.get(t);if(!o)return Promise.resolve([]);const a=Ki(e),l=await this.prepareHistoryTurns(o.id,r),c=hc.to(n);return(await o.provideFollowups(c,{history:l},s)).filter(u=>{const d=!u.participant||yn.some(this._agents.values(),f=>f.id===u.participant&&ot.equals(f.extension.identifier,o.extension.identifier));return d||this._logService.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`),d}).map(u=>Xd.from(u,a))}$acceptFeedback(e,t,n,r){const s=this._agents.get(e);if(!s)return;const o=hc.to(t);let a;switch(n){case ym.Down:a=Od.Unhelpful;break;case ym.Up:a=Od.Helpful;break}s.acceptFeedback(Object.freeze(r?{result:o,kind:a,reportIssue:r}:{result:o,kind:a}))}$acceptAction(e,t,n){const r=this._agents.get(e);if(!r||n.action.kind==="vote")return;const s=Dw.to(t,n,this._commands.converter);s&&r.acceptAction(Object.freeze(s))}async $invokeCompletionProvider(e,t,n){const r=this._agents.get(e);if(!r)return[];let s=this._completionDisposables.get(e);return s?s.clear():(s=new Le,this._completionDisposables.set(e,s)),(await r.invokeCompletionProvider(t,n)).map(a=>Sw.from(a,this._commands.converter,s))}async $provideWelcomeMessage(e,t,n){const r=this._agents.get(e);if(r)return await r.provideWelcomeMessage(ih.to(t),n)}async $provideSampleQuestions(e,t,n){const r=this._agents.get(e);if(r)return(await r.provideSampleQuestions(ih.to(t),n)).map(s=>Xd.from(s,void 0))}};Vh._idPool=0;let t0=Vh;class uk{constructor(e,t,n,r,s){this.extension=e,this.id=t,this._proxy=n,this._handle=r,this._requestHandler=s,this._onDidReceiveFeedback=new L,this._onDidPerformAction=new L}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,n){if(!this._followupProvider)return[];const r=await this._followupProvider.provideFollowups(e,t,n);return r?r.filter(s=>!(s&&"commandId"in s)).filter(s=>!(s&&"message"in s)):[]}async provideWelcomeMessage(e,t){if(!this._welcomeMessageProvider)return[];const n=await this._welcomeMessageProvider.provideWelcomeMessage(e,t);return n?n.map(r=>typeof r=="string"?r:We.from(r)):[]}async provideSampleQuestions(e,t){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const n=await this._welcomeMessageProvider.provideSampleQuestions(e,t);return n||[]}get apiAgent(){let e=!1,t=!1;const n=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{icon:this._iconPath?this._iconPath instanceof y?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof Oi?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,isSecondary:this._isSecondary,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix=="string"?this._helpTextPrefix:We.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix=="string"?this._helpTextVariablesPrefix:We.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix=="string"?this._helpTextPostfix:We.from(this._helpTextPostfix),supportIssueReporting:this._supportIssueReporting,requester:this._requester,supportsSlowVariables:this._supportsSlowReferences}),t=!1}))},r=this;return{get id(){return r.id},get iconPath(){return r._iconPath},set iconPath(s){r._iconPath=s,n()},get requestHandler(){return r._requestHandler},set requestHandler(s){Ix(typeof s=="function","Invalid request handler"),r._requestHandler=s},get followupProvider(){return r._followupProvider},set followupProvider(s){r._followupProvider=s,n()},get isDefault(){return M(r.extension,"defaultChatParticipant"),r._isDefault},set isDefault(s){M(r.extension,"defaultChatParticipant"),r._isDefault=s,n()},get helpTextPrefix(){return M(r.extension,"defaultChatParticipant"),r._helpTextPrefix},set helpTextPrefix(s){M(r.extension,"defaultChatParticipant"),r._helpTextPrefix=s,n()},get helpTextVariablesPrefix(){return M(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix},set helpTextVariablesPrefix(s){M(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix=s,n()},get helpTextPostfix(){return M(r.extension,"defaultChatParticipant"),r._helpTextPostfix},set helpTextPostfix(s){M(r.extension,"defaultChatParticipant"),r._helpTextPostfix=s,n()},get isSecondary(){return M(r.extension,"defaultChatParticipant"),r._isSecondary},set isSecondary(s){M(r.extension,"defaultChatParticipant"),r._isSecondary=s,n()},get supportIssueReporting(){return M(r.extension,"chatParticipantPrivate"),r._supportIssueReporting},set supportIssueReporting(s){M(r.extension,"chatParticipantPrivate"),r._supportIssueReporting=s,n()},get onDidReceiveFeedback(){return r._onDidReceiveFeedback.event},set participantVariableProvider(s){if(M(r.extension,"chatParticipantAdditions"),r._agentVariableProvider=s,s){if(!s.triggerCharacters.length)throw new Error("triggerCharacters are required");r._proxy.$registerAgentCompletionsProvider(r._handle,r.id,s.triggerCharacters)}else r._proxy.$unregisterAgentCompletionsProvider(r._handle,r.id)},get participantVariableProvider(){return M(r.extension,"chatParticipantAdditions"),r._agentVariableProvider},set welcomeMessageProvider(s){M(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider=s,n()},get welcomeMessageProvider(){return M(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider},onDidPerformAction:ii(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,set requester(s){r._requester=s,n()},get requester(){return r._requester},set supportsSlowReferences(s){M(r.extension,"chatParticipantPrivate"),r._supportsSlowReferences=s,n()},get supportsSlowReferences(){return M(r.extension,"chatParticipantPrivate"),r._supportsSlowReferences},dispose(){e=!0,r._followupProvider=void 0,r._onDidReceiveFeedback.dispose(),r._proxy.$unregisterAgent(r._handle)}}}invoke(e,t,n,r){return this._requestHandler(e,t,n,r)}}const i1=class i1{constructor(e){this._resolver=new Map,this._proxy=e.getProxy(Z.MainThreadChatVariables)}async $resolveVariable(e,t,n,r){const s=this._resolver.get(e);if(s)try{if(s.resolver.resolve2){M(s.extension,"chatParticipantAdditions");const o=new pR(t,this._proxy),a=await s.resolver.resolve2(s.data.name,{prompt:n},o.apiObject,r);if(a&&a[0])return a[0].value}else{const o=await s.resolver.resolve(s.data.name,{prompt:n},r);if(o&&o[0])return o[0].value}}catch(o){D1(o)}}registerVariableResolver(e,t,n,r,s,o,a,l,c){const u=i1._idPool++,d=c?Si.fromId(c):void 0;return this._resolver.set(u,{extension:e,data:{id:t,name:n,description:r,modelDescription:s,icon:d},resolver:a}),this._proxy.$registerVariable(u,{id:t,name:n,description:r,modelDescription:s,isSlow:o,fullName:l,icon:d}),Me(()=>{this._resolver.delete(u),this._proxy.$unregisterVariable(u)})}};i1._idPool=0;let i0=i1;class pR{constructor(e,t){this._requestId=e,this._proxy=t,this._isClosed=!1}close(){this._isClosed=!0}get apiObject(){if(!this._apiObject){let t=function(r){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,r),s}};const e=this,n=r=>{this._proxy.$handleProgressChunk(this._requestId,r)};this._apiObject={progress(r){t(this.progress);const s=new $d(r),o=dc.from(s);return n(o),this},reference(r){t(this.reference);const s=new Yr(r),o=Zr.from(s);return n(o),this},push(r){return t(this.push),r instanceof Yr?n(Zr.from(r)):r instanceof $d&&n(dc.from(r)),this}}}return this._apiObject}}class gR{constructor(e){const t=e.getProxy(Z.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(n){return t.$writeText(n)}})}}const dk="vscode-cdn.net",mR=`vscode-resource.${dk}`,n0=`'self' https://*.${dk}`;function bh(i,e){return i.scheme===le.http||i.scheme===le.https?i:(e&&e.authority&&e.isRemote&&i.scheme===le.file&&(i=y.from({scheme:le.vscodeRemote,authority:e.authority,path:i.path})),y.from({scheme:le.https,authority:`${i.scheme}+${_R(i.authority)}.${mR}`,path:i.path,fragment:i.fragment,query:i.query}))}function _R(i){return i.replace(/./g,e=>{const t=e.charCodeAt(0);return t>=P.a&&t<=P.z||t>=P.A&&t<=P.Z||t>=P.Digit0&&t<=P.Digit9?e:"-"+t.toString(16).padStart(4,"0")})}class vR{constructor(e,t,n){this._proxy=e,this._editors=t,this._remoteInfo=n,this._handlePool=0,this._disposables=new Le,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{const r=t.getVisibleTextEditors();for(const s of this._insets.values())r.indexOf(s.editor)<0&&s.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,n,r,s){let o;for(const p of this._editors.getVisibleTextEditors(!0))if(p.value===e){o=p;break}if(!o)throw new Error("not a visible editor");const a=this,l=this._handlePool++,c=new L,u=new L,d=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(p){return bh(p,a._remoteInfo)}get cspSource(){return n0}set options(p){this._options=p,a._proxy.$setOptions(l,p)}get options(){return this._options}set html(p){this._html=p,a._proxy.$setHtml(l,p)}get html(){return this._html}get onDidReceiveMessage(){return c.event}postMessage(p){return a._proxy.$postMessage(l,p)}},f=new class{constructor(){this.editor=e,this.line=t,this.height=n,this.webview=d,this.onDidDispose=u.event}dispose(){a._insets.has(l)&&(a._insets.delete(l),a._proxy.$disposeEditorInset(l),u.fire(),u.dispose(),c.dispose())}};return this._proxy.$createEditorInset(l,o.id,o.value.document.uri,t+1,n,r||{},s.identifier,s.extensionLocation),this._insets.set(l,{editor:e,inset:f,onDidReceiveMessage:c}),f}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){const n=this._insets.get(e);n==null||n.onDidReceiveMessage.fire(t)}}function wR(i,e,t){const n=i.getProxy(Z.MainThreadComments),p=class p{constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new Vr,e.registerArgumentProcessor({processArgument:v=>{if(v&&v.$mid===mt.CommentController){const S=this._commentControllers.get(v.handle);return S?S.value:v}else if(v&&v.$mid===mt.CommentThread){const S=v,k=this._commentControllers.get(S.commentControlHandle);if(!k)return S;const C=k.getCommentThread(S.commentThreadHandle);return C?C.value:S}else if(v&&(v.$mid===mt.CommentThreadReply||v.$mid===mt.CommentThreadInstance)){const S=this._commentControllers.get(v.thread.commentControlHandle);if(!S)return v;const k=S.getCommentThread(v.thread.commentThreadHandle);return k?v.$mid===mt.CommentThreadInstance?k.value:{thread:k.value,text:v.text}:v}else if(v&&v.$mid===mt.CommentNode){const S=this._commentControllers.get(v.thread.commentControlHandle);if(!S)return v;const k=S.getCommentThread(v.thread.commentThreadHandle);if(!k)return v;const C=v.commentUniqueId,N=k.getCommentByUniqueId(C);return N||v}else if(v&&v.$mid===mt.CommentThreadNode){const S=this._commentControllers.get(v.thread.commentControlHandle);if(!S)return v;const k=S.getCommentThread(v.thread.commentThreadHandle);if(!k)return v;const C=v.text,N=v.commentUniqueId,A=k.getCommentByUniqueId(N);return A?(typeof A.body=="string"?A.body=C:A.body=new tn(C),A):v}return v}})}createCommentController(v,S,k){const C=p.handlePool++,N=new o(v,C,S,k);this._commentControllers.set(N.handle,N);const A=this._commentControllersByExtension.get(v.identifier)||[];return A.push(N),this._commentControllersByExtension.set(v.identifier,A),N.value}async $createCommentThreadTemplate(v,S,k,C){const N=this._commentControllers.get(v);N&&N.$createCommentThreadTemplate(S,k,C)}async $setActiveComment(v,S){const k=this._commentControllers.get(v);k&&k.$setActiveComment(S??void 0)}async $updateCommentThreadTemplate(v,S,k){const C=this._commentControllers.get(v);C&&C.$updateCommentThreadTemplate(S,k)}$deleteCommentThread(v,S){const k=this._commentControllers.get(v);k==null||k.$deleteCommentThread(S)}async $provideCommentingRanges(v,S,k){const C=this._commentControllers.get(v);if(!C||!C.commentingRangeProvider)return Promise.resolve(void 0);const N=await t.ensureDocumentData(y.revive(S));return xi(async()=>{const A=await C.commentingRangeProvider.provideCommentingRanges(N.document,k);let V;return Array.isArray(A)?V={ranges:A,fileComments:!1}:A?V={ranges:A.ranges||[],fileComments:A.enableFileComments||!1}:V=A??void 0,V}).then(A=>{let V;return A&&(V={ranges:A.ranges.map(ae=>H.from(ae)),fileComments:A.fileComments}),V})}$toggleReaction(v,S,k,C,N){const A=this._commentControllers.get(v);return!A||!A.reactionHandler?Promise.resolve(void 0):xi(()=>{const V=A.getCommentThread(S);if(V){const ae=V.getCommentByUniqueId(C.uniqueIdInThread);if(A!==void 0&&ae&&A.reactionHandler)return A.reactionHandler(ae,c(N))}return Promise.resolve(void 0)})}};p.handlePool=0;let r=p;const b=class b{set threadId(v){this._id=v}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(v){(v===void 0!=(this._range===void 0)||!v||!this._range||!v.isEqual(this._range))&&(this._range=v,this.modifications.range=v,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(v){this._canReply!==v&&(this._canReply=v,this.modifications.canReply=v,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(v){this._label=v,this.modifications.label=v,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(v){this._contextValue=v,this.modifications.contextValue=v,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(v){this._comments=v,this.modifications.comments=v,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(v){this._collapseState=v,this.modifications.collapsibleState=v,this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(v){this._state=v,typeof v=="object"?(M(this.extensionDescription,"commentThreadApplicability"),this.modifications.state=v.resolved,this.modifications.applicability=v.applicability):this.modifications.state=v,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(v,S,k,C,N,A,V,ae,be){this._commentControllerHandle=S,this._id=k,this._uri=C,this._range=N,this._comments=A,this.extensionDescription=V,this._isTemplate=ae,this.handle=b._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new L,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new po,this._acceptInputDisposables.value=new Le,this._id===void 0&&(this._id=`${v}.${this.handle}`),n.$createCommentThread(S,this.handle,this._id,this._uri,H.from(this._range),this._comments.map(Ce=>a(this,Ce,this._commentsMap,this.extensionDescription)),V.identifier,this._isTemplate,be),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this._localDisposables.push({dispose:()=>{n.$deleteCommentThread(S,this.handle)}});const Q=this;this.value={get uri(){return Q.uri},get range(){return Q.range},set range(Ce){Q.range=Ce},get comments(){return Q.comments},set comments(Ce){Q.comments=Ce},get collapsibleState(){return Q.collapsibleState},set collapsibleState(Ce){Q.collapsibleState=Ce},get canReply(){return Q.canReply},set canReply(Ce){Q.canReply=Ce},get contextValue(){return Q.contextValue},set contextValue(Ce){Q.contextValue=Ce},get label(){return Q.label},set label(Ce){Q.label=Ce},get state(){return Q.state},set state(Ce){Q.state=Ce},reveal:(Ce,Se)=>Q.reveal(Ce,Se),hide:()=>Q.hide(),dispose:()=>{Q.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new Le);const v=k=>Object.prototype.hasOwnProperty.call(this.modifications,k),S={};v("range")&&(S.range=H.from(this._range)),v("label")&&(S.label=this.label),v("contextValue")&&(S.contextValue=this.contextValue??null),v("comments")&&(S.comments=this._comments.map(k=>a(this,k,this._commentsMap,this.extensionDescription))),v("collapsibleState")&&(S.collapseState=u(this._collapseState)),v("canReply")&&(S.canReply=this.canReply),v("state")&&(S.state=d(this._state)),v("applicability")&&(S.applicability=f(this._state)),v("isTemplate")&&(S.isTemplate=this._isTemplate),this.modifications={},n.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,S)}getCommentByUniqueId(v){for(const S of this._commentsMap){const k=S[0],C=S[1];if(v===C)return k}}async reveal(v,S){M(this.extensionDescription,"commentReveal");let k;v&&v.body!==void 0?k=v:S=S??v;let C=k?this._commentsMap.get(k):void 0;C??(C=this._commentsMap.get(this._comments[0]));let N=!0,A=!1;return(S==null?void 0:S.focus)===Pd.Reply?(A=!0,N=!1):(S==null?void 0:S.focus)===Pd.Comment&&(N=!1),n.$revealCommentThread(this._commentControllerHandle,this.handle,C,{preserveFocus:N,focusReply:A})}async hide(){return n.$hideCommentThread(this._commentControllerHandle,this.handle)}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(v=>v.dispose())}};b._handlePool=0;let s=b;class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(v){this._commentingRangeProvider=v,v!=null&&v.resourceHints&&M(this._extension,"commentingRangeHint"),n.$updateCommentingRanges(this.handle,v==null?void 0:v.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(v){this._reactionHandler=v,n.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!v})}get options(){return this._options}set options(v){this._options=v,n.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return M(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){return M(this._extension,"activeComment"),this._activeThread}constructor(v,S,k,C){this._extension=v,this._handle=S,this._id=k,this._label=C,this._threads=new Map,n.$registerCommentController(this.handle,k,C,this._extension.identifier.value);const N=this;this.value=Object.freeze({id:N.id,label:N.label,get options(){return N.options},set options(A){N.options=A},get commentingRangeProvider(){return N.commentingRangeProvider},set commentingRangeProvider(A){N.commentingRangeProvider=A},get reactionHandler(){return N.reactionHandler},set reactionHandler(A){N.reactionHandler=A},get activeCommentThread(){return N.activeCommentThread},createCommentThread(A,V,ae){return N.createCommentThread(A,V,ae).value},dispose:()=>{N.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{n.$unregisterCommentController(this.handle)}})}createCommentThread(v,S,k){S===void 0&&M(this._extension,"fileComments");const C=new s(this.id,this.handle,void 0,v,S,k,this._extension,!1);return this._threads.set(C.handle,C),C}$setActiveComment(v){if(!v){this._activeComment=void 0,this._activeThread=void 0;return}const S=this._threads.get(v.commentThreadHandle);S&&(this._activeComment=v.uniqueIdInThread?S.getCommentByUniqueId(v.uniqueIdInThread):void 0,this._activeThread=S)}$createCommentThreadTemplate(v,S,k){const C=new s(this.id,this.handle,void 0,y.revive(v),H.to(S),[],this._extension,!0,k);return C.collapsibleState=xl.Expanded,this._threads.set(C.handle,C),C}$updateCommentThreadTemplate(v,S){const k=this._threads.get(v);k&&(k.range=H.to(S))}$deleteCommentThread(v){const S=this._threads.get(v);S==null||S.dispose(),this._threads.delete(v)}getCommentThread(v){return this._threads.get(v)}dispose(){this._threads.forEach(v=>{v.dispose()}),this._localDisposables.forEach(v=>v.dispose())}}function a(w,v,S,k){var N,A;let C=S.get(v);return C||(C=++w.commentHandle,S.set(v,C)),v.state!==void 0&&M(k,"commentsDraftState"),(N=v.reactions)!=null&&N.some(V=>V.reactors!==void 0)&&M(k,"commentReactor"),{mode:v.mode,contextValue:v.contextValue,uniqueIdInThread:C,body:typeof v.body=="string"?v.body:We.from(v.body),userName:v.author.name,userIconPath:v.author.iconPath,label:v.label,commentReactions:v.reactions?v.reactions.map(V=>l(V)):void 0,state:v.state,timestamp:(A=v.timestamp)==null?void 0:A.toJSON()}}function l(w){return{label:w.label,iconPath:w.iconPath?Ig(w.iconPath):void 0,count:w.count,hasReacted:w.authorHasReacted,reactors:w.reactors&&w.reactors.length>0&&typeof w.reactors[0]!="string"?w.reactors.map(v=>v.name):w.reactors}}function c(w){var v;return{label:w.label||"",count:w.count||0,iconPath:w.iconPath?y.revive(w.iconPath):"",authorHasReacted:w.hasReacted||!1,reactors:(v=w.reactors)==null?void 0:v.map(S=>({name:S}))}}function u(w){if(w!==void 0)switch(w){case kd.Expanded:return xl.Expanded;case kd.Collapsed:return xl.Collapsed}return xl.Collapsed}function d(w){let v;if(typeof w=="object"?v=w.resolved:v=w,v!==void 0)switch(v){case Cd.Unresolved:return qu.Unresolved;case Cd.Resolved:return qu.Resolved}return qu.Unresolved}function f(w){let v;if(typeof w=="object"&&(v=w.applicability),v!==void 0)switch(v){case Id.Current:return ju.Current;case Id.Outdated:return ju.Outdated}return ju.Current}return new r}var hk={exports:{}};(function(i,e){e=i.exports=at;var t;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?t=function(){var E=Array.prototype.slice.call(arguments,0);E.unshift("SEMVER"),console.log.apply(console,E)}:t=function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=256,r=Number.MAX_SAFE_INTEGER||9007199254740991,s=16,o=e.re=[],a=e.src=[],l=0,c=l++;a[c]="0|[1-9]\\d*";var u=l++;a[u]="[0-9]+";var d=l++;a[d]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var f=l++;a[f]="("+a[c]+")\\.("+a[c]+")\\.("+a[c]+")";var p=l++;a[p]="("+a[u]+")\\.("+a[u]+")\\.("+a[u]+")";var b=l++;a[b]="(?:"+a[c]+"|"+a[d]+")";var w=l++;a[w]="(?:"+a[u]+"|"+a[d]+")";var v=l++;a[v]="(?:-("+a[b]+"(?:\\."+a[b]+")*))";var S=l++;a[S]="(?:-?("+a[w]+"(?:\\."+a[w]+")*))";var k=l++;a[k]="[0-9A-Za-z-]+";var C=l++;a[C]="(?:\\+("+a[k]+"(?:\\."+a[k]+")*))";var N=l++,A="v?"+a[f]+a[v]+"?"+a[C]+"?";a[N]="^"+A+"$";var V="[v=\\s]*"+a[p]+a[S]+"?"+a[C]+"?",ae=l++;a[ae]="^"+V+"$";var be=l++;a[be]="((?:<|>)?=?)";var Q=l++;a[Q]=a[u]+"|x|X|\\*";var Ce=l++;a[Ce]=a[c]+"|x|X|\\*";var Se=l++;a[Se]="[v=\\s]*("+a[Ce]+")(?:\\.("+a[Ce]+")(?:\\.("+a[Ce]+")(?:"+a[v]+")?"+a[C]+"?)?)?";var J=l++;a[J]="[v=\\s]*("+a[Q]+")(?:\\.("+a[Q]+")(?:\\.("+a[Q]+")(?:"+a[S]+")?"+a[C]+"?)?)?";var q=l++;a[q]="^"+a[be]+"\\s*"+a[Se]+"$";var oe=l++;a[oe]="^"+a[be]+"\\s*"+a[J]+"$";var re=l++;a[re]="(?:^|[^\\d])(\\d{1,"+s+"})(?:\\.(\\d{1,"+s+"}))?(?:\\.(\\d{1,"+s+"}))?(?:$|[^\\d])";var de=l++;a[de]="(?:~>?)";var fe=l++;a[fe]="(\\s*)"+a[de]+"\\s+",o[fe]=new RegExp(a[fe],"g");var je="$1~",gt=l++;a[gt]="^"+a[de]+a[Se]+"$";var $e=l++;a[$e]="^"+a[de]+a[J]+"$";var gi=l++;a[gi]="(?:\\^)";var oi=l++;a[oi]="(\\s*)"+a[gi]+"\\s+",o[oi]=new RegExp(a[oi],"g");var Zt="$1^",mi=l++;a[mi]="^"+a[gi]+a[Se]+"$";var $i=l++;a[$i]="^"+a[gi]+a[J]+"$";var kt=l++;a[kt]="^"+a[be]+"\\s*("+V+")$|^$";var er=l++;a[er]="^"+a[be]+"\\s*("+A+")$|^$";var _s=l++;a[_s]="(\\s*)"+a[be]+"\\s*("+V+"|"+a[Se]+")",o[_s]=new RegExp(a[_s],"g");var nu="$1$2$3",Xa=l++;a[Xa]="^\\s*("+a[Se]+")\\s+-\\s+("+a[Se]+")\\s*$";var Ve=l++;a[Ve]="^\\s*("+a[J]+")\\s+-\\s+("+a[J]+")\\s*$";var _1=l++;a[_1]="(<|>)?=?\\s*\\*";for(var Ji=0;Ji<l;Ji++)t(Ji,a[Ji]),o[Ji]||(o[Ji]=new RegExp(a[Ji]));e.parse=bn;function bn(E,R){if(E instanceof at)return E;if(typeof E!="string"||E.length>n)return null;var $=R?o[ae]:o[N];if(!$.test(E))return null;try{return new at(E,R)}catch{return null}}e.valid=v1;function v1(E,R){var $=bn(E,R);return $?$.version:null}e.clean=ty;function ty(E,R){var $=bn(E.trim().replace(/^[=v]+/,""),R);return $?$.version:null}e.SemVer=at;function at(E,R){if(E instanceof at){if(E.loose===R)return E;E=E.version}else if(typeof E!="string")throw new TypeError("Invalid Version: "+E);if(E.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof at))return new at(E,R);t("SemVer",E,R),this.loose=R;var $=E.trim().match(R?o[ae]:o[N]);if(!$)throw new TypeError("Invalid Version: "+E);if(this.raw=E,this.major=+$[1],this.minor=+$[2],this.patch=+$[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");$[4]?this.prerelease=$[4].split(".").map(function(se){if(/^[0-9]+$/.test(se)){var G=+se;if(G>=0&&G<r)return G}return se}):this.prerelease=[],this.build=$[5]?$[5].split("."):[],this.format()}at.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},at.prototype.toString=function(){return this.version},at.prototype.compare=function(E){return t("SemVer.compare",this.version,this.loose,E),E instanceof at||(E=new at(E,this.loose)),this.compareMain(E)||this.comparePre(E)},at.prototype.compareMain=function(E){return E instanceof at||(E=new at(E,this.loose)),vs(this.major,E.major)||vs(this.minor,E.minor)||vs(this.patch,E.patch)},at.prototype.comparePre=function(E){if(E instanceof at||(E=new at(E,this.loose)),this.prerelease.length&&!E.prerelease.length)return-1;if(!this.prerelease.length&&E.prerelease.length)return 1;if(!this.prerelease.length&&!E.prerelease.length)return 0;var R=0;do{var $=this.prerelease[R],se=E.prerelease[R];if(t("prerelease compare",R,$,se),$===void 0&&se===void 0)return 0;if(se===void 0)return 1;if($===void 0)return-1;if($===se)continue;return vs($,se)}while(++R)},at.prototype.inc=function(E,R){switch(E){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",R);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",R);break;case"prepatch":this.prerelease.length=0,this.inc("patch",R),this.inc("pre",R);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",R),this.inc("pre",R);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var $=this.prerelease.length;--$>=0;)typeof this.prerelease[$]=="number"&&(this.prerelease[$]++,$=-2);$===-1&&this.prerelease.push(0)}R&&(this.prerelease[0]===R?isNaN(this.prerelease[1])&&(this.prerelease=[R,0]):this.prerelease=[R,0]);break;default:throw new Error("invalid increment argument: "+E)}return this.format(),this.raw=this.version,this},e.inc=iy;function iy(E,R,$,se){typeof $=="string"&&(se=$,$=void 0);try{return new at(E,$).inc(R,se).version}catch{return null}}e.diff=w1;function w1(E,R){if(su(E,R))return null;var $=bn(E),se=bn(R);if($.prerelease.length||se.prerelease.length){for(var G in $)if((G==="major"||G==="minor"||G==="patch")&&$[G]!==se[G])return"pre"+G;return"prerelease"}for(var G in $)if((G==="major"||G==="minor"||G==="patch")&&$[G]!==se[G])return G}e.compareIdentifiers=vs;var b1=/^[0-9]+$/;function vs(E,R){var $=b1.test(E),se=b1.test(R);return $&&se&&(E=+E,R=+R),$&&!se?-1:se&&!$?1:E<R?-1:E>R?1:0}e.rcompareIdentifiers=ny;function ny(E,R){return vs(R,E)}e.major=Zh;function Zh(E,R){return new at(E,R).major}e.minor=ef;function ef(E,R){return new at(E,R).minor}e.patch=ry;function ry(E,R){return new at(E,R).patch}e.compare=tr;function tr(E,R,$){return new at(E,$).compare(new at(R,$))}e.compareLoose=lo;function lo(E,R){return tr(E,R,!0)}e.rcompare=sy;function sy(E,R,$){return tr(R,E,$)}e.sort=oy;function oy(E,R){return E.sort(function($,se){return e.compare($,se,R)})}e.rsort=tf;function tf(E,R){return E.sort(function($,se){return e.rcompare($,se,R)})}e.gt=ru;function ru(E,R,$){return tr(E,R,$)>0}e.lt=co;function co(E,R,$){return tr(E,R,$)<0}e.eq=su;function su(E,R,$){return tr(E,R,$)===0}e.neq=y1;function y1(E,R,$){return tr(E,R,$)!==0}e.gte=ou;function ou(E,R,$){return tr(E,R,$)>=0}e.lte=nf;function nf(E,R,$){return tr(E,R,$)<=0}e.cmp=kr;function kr(E,R,$,se){var G;switch(R){case"===":typeof E=="object"&&(E=E.version),typeof $=="object"&&($=$.version),G=E===$;break;case"!==":typeof E=="object"&&(E=E.version),typeof $=="object"&&($=$.version),G=E!==$;break;case"":case"=":case"==":G=su(E,$,se);break;case"!=":G=y1(E,$,se);break;case">":G=ru(E,$,se);break;case">=":G=ou(E,$,se);break;case"<":G=co(E,$,se);break;case"<=":G=nf(E,$,se);break;default:throw new TypeError("Invalid operator: "+R)}return G}e.Comparator=an;function an(E,R){if(E instanceof an){if(E.loose===R)return E;E=E.value}if(!(this instanceof an))return new an(E,R);t("comparator",E,R),this.loose=R,this.parse(E),this.semver===Ya?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}var Ya={};an.prototype.parse=function(E){var R=this.loose?o[kt]:o[er],$=E.match(R);if(!$)throw new TypeError("Invalid comparator: "+E);this.operator=$[1],this.operator==="="&&(this.operator=""),$[2]?this.semver=new at($[2],this.loose):this.semver=Ya},an.prototype.toString=function(){return this.value},an.prototype.test=function(E){return t("Comparator.test",E,this.loose),this.semver===Ya?!0:(typeof E=="string"&&(E=new at(E,this.loose)),kr(E,this.operator,this.semver,this.loose))},an.prototype.intersects=function(E,R){if(!(E instanceof an))throw new TypeError("a Comparator is required");var $;if(this.operator==="")return $=new Mt(E.value,R),lu(this.value,$,R);if(E.operator==="")return $=new Mt(this.value,R),lu(E.semver,$,R);var se=(this.operator===">="||this.operator===">")&&(E.operator===">="||E.operator===">"),G=(this.operator==="<="||this.operator==="<")&&(E.operator==="<="||E.operator==="<"),m=this.semver.version===E.semver.version,_=(this.operator===">="||this.operator==="<=")&&(E.operator===">="||E.operator==="<="),x=kr(this.semver,"<",E.semver,R)&&(this.operator===">="||this.operator===">")&&(E.operator==="<="||E.operator==="<"),j=kr(this.semver,">",E.semver,R)&&(this.operator==="<="||this.operator==="<")&&(E.operator===">="||E.operator===">");return se||G||m&&_||x||j},e.Range=Mt;function Mt(E,R){if(E instanceof Mt)return E.loose===R?E:new Mt(E.raw,R);if(E instanceof an)return new Mt(E.value,R);if(!(this instanceof Mt))return new Mt(E,R);if(this.loose=R,this.raw=E,this.set=E.split(/\s*\|\|\s*/).map(function($){return this.parseRange($.trim())},this).filter(function($){return $.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+E);this.format()}Mt.prototype.format=function(){return this.range=this.set.map(function(E){return E.join(" ").trim()}).join("||").trim(),this.range},Mt.prototype.toString=function(){return this.range},Mt.prototype.parseRange=function(E){var R=this.loose;E=E.trim(),t("range",E,R);var $=R?o[Ve]:o[Xa];E=E.replace($,uy),t("hyphen replace",E),E=E.replace(o[_s],nu),t("comparator trim",E,o[_s]),E=E.replace(o[fe],je),E=E.replace(o[oi],Zt),E=E.split(/\s+/).join(" ");var se=R?o[kt]:o[er],G=E.split(" ").map(function(m){return x1(m,R)}).join(" ").split(/\s+/);return this.loose&&(G=G.filter(function(m){return!!m.match(se)})),G=G.map(function(m){return new an(m,R)}),G},Mt.prototype.intersects=function(E,R){if(!(E instanceof Mt))throw new TypeError("a Range is required");return this.set.some(function($){return $.every(function(se){return E.set.some(function(G){return G.every(function(m){return se.intersects(m,R)})})})})},e.toComparators=rf;function rf(E,R){return new Mt(E,R).set.map(function($){return $.map(function(se){return se.value}).join(" ").trim().split(" ")})}function x1(E,R){return t("comp",E),E=ge(E,R),t("caret",E),E=Cr(E,R),t("tildes",E),E=ay(E,R),t("xrange",E),E=cy(E,R),t("stars",E),E}function D(E){return!E||E.toLowerCase()==="x"||E==="*"}function Cr(E,R){return E.trim().split(/\s+/).map(function($){return E1($,R)}).join(" ")}function E1(E,R){var $=R?o[$e]:o[gt];return E.replace($,function(se,G,m,_,x){t("tilde",E,se,G,m,_,x);var j;return D(G)?j="":D(m)?j=">="+G+".0.0 <"+(+G+1)+".0.0":D(_)?j=">="+G+"."+m+".0 <"+G+"."+(+m+1)+".0":x?(t("replaceTilde pr",x),x.charAt(0)!=="-"&&(x="-"+x),j=">="+G+"."+m+"."+_+x+" <"+G+"."+(+m+1)+".0"):j=">="+G+"."+m+"."+_+" <"+G+"."+(+m+1)+".0",t("tilde return",j),j})}function ge(E,R){return E.trim().split(/\s+/).map(function($){return lt($,R)}).join(" ")}function lt(E,R){t("caret",E,R);var $=R?o[$i]:o[mi];return E.replace($,function(se,G,m,_,x){t("caret",E,se,G,m,_,x);var j;return D(G)?j="":D(m)?j=">="+G+".0.0 <"+(+G+1)+".0.0":D(_)?G==="0"?j=">="+G+"."+m+".0 <"+G+"."+(+m+1)+".0":j=">="+G+"."+m+".0 <"+(+G+1)+".0.0":x?(t("replaceCaret pr",x),x.charAt(0)!=="-"&&(x="-"+x),G==="0"?m==="0"?j=">="+G+"."+m+"."+_+x+" <"+G+"."+m+"."+(+_+1):j=">="+G+"."+m+"."+_+x+" <"+G+"."+(+m+1)+".0":j=">="+G+"."+m+"."+_+x+" <"+(+G+1)+".0.0"):(t("no pr"),G==="0"?m==="0"?j=">="+G+"."+m+"."+_+" <"+G+"."+m+"."+(+_+1):j=">="+G+"."+m+"."+_+" <"+G+"."+(+m+1)+".0":j=">="+G+"."+m+"."+_+" <"+(+G+1)+".0.0"),t("caret return",j),j})}function ay(E,R){return t("replaceXRanges",E,R),E.split(/\s+/).map(function($){return ly($,R)}).join(" ")}function ly(E,R){E=E.trim();var $=R?o[oe]:o[q];return E.replace($,function(se,G,m,_,x,j){t("xRange",E,se,G,m,_,x,j);var Ae=D(m),et=Ae||D(_),bt=et||D(x),ai=bt;return G==="="&&ai&&(G=""),Ae?G===">"||G==="<"?se="<0.0.0":se="*":G&&ai?(et&&(_=0),bt&&(x=0),G===">"?(G=">=",et?(m=+m+1,_=0,x=0):bt&&(_=+_+1,x=0)):G==="<="&&(G="<",et?m=+m+1:_=+_+1),se=G+m+"."+_+"."+x):et?se=">="+m+".0.0 <"+(+m+1)+".0.0":bt&&(se=">="+m+"."+_+".0 <"+m+"."+(+_+1)+".0"),t("xRange return",se),se})}function cy(E,R){return t("replaceStars",E,R),E.trim().replace(o[_1],"")}function uy(E,R,$,se,G,m,_,x,j,Ae,et,bt,ai){return D($)?R="":D(se)?R=">="+$+".0.0":D(G)?R=">="+$+"."+se+".0":R=">="+R,D(j)?x="":D(Ae)?x="<"+(+j+1)+".0.0":D(et)?x="<"+j+"."+(+Ae+1)+".0":bt?x="<="+j+"."+Ae+"."+et+"-"+bt:x="<="+x,(R+" "+x).trim()}Mt.prototype.test=function(E){if(!E)return!1;typeof E=="string"&&(E=new at(E,this.loose));for(var R=0;R<this.set.length;R++)if(au(this.set[R],E))return!0;return!1};function au(E,R){for(var $=0;$<E.length;$++)if(!E[$].test(R))return!1;if(R.prerelease.length){for(var $=0;$<E.length;$++)if(t(E[$].semver),E[$].semver!==Ya&&E[$].semver.prerelease.length>0){var se=E[$].semver;if(se.major===R.major&&se.minor===R.minor&&se.patch===R.patch)return!0}return!1}return!0}e.satisfies=lu;function lu(E,R,$){try{R=new Mt(R,$)}catch{return!1}return R.test(E)}e.maxSatisfying=dy;function dy(E,R,$){var se=null,G=null;try{var m=new Mt(R,$)}catch{return null}return E.forEach(function(_){m.test(_)&&(!se||G.compare(_)===-1)&&(se=_,G=new at(se,$))}),se}e.minSatisfying=hy;function hy(E,R,$){var se=null,G=null;try{var m=new Mt(R,$)}catch{return null}return E.forEach(function(_){m.test(_)&&(!se||G.compare(_)===1)&&(se=_,G=new at(se,$))}),se}e.validRange=S1;function S1(E,R){try{return new Mt(E,R).range||"*"}catch{return null}}e.ltr=fy;function fy(E,R,$){return sf(E,R,"<",$)}e.gtr=py;function py(E,R,$){return sf(E,R,">",$)}e.outside=sf;function sf(E,R,$,se){E=new at(E,se),R=new Mt(R,se);var G,m,_,x,j;switch($){case">":G=ru,m=nf,_=co,x=">",j=">=";break;case"<":G=co,m=ou,_=ru,x="<",j="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(lu(E,R,se))return!1;for(var Ae=0;Ae<R.set.length;++Ae){var et=R.set[Ae],bt=null,ai=null;if(et.forEach(function(ir){ir.semver===Ya&&(ir=new an(">=0.0.0")),bt=bt||ir,ai=ai||ir,G(ir.semver,bt.semver,se)?bt=ir:_(ir.semver,ai.semver,se)&&(ai=ir)}),bt.operator===x||bt.operator===j||(!ai.operator||ai.operator===x)&&m(E,ai.semver))return!1;if(ai.operator===j&&_(E,ai.semver))return!1}return!0}e.prerelease=gy;function gy(E,R){var $=bn(E,R);return $&&$.prerelease.length?$.prerelease:null}e.intersects=my;function my(E,R,$){return E=new Mt(E,$),R=new Mt(R,$),E.intersects(R)}e.coerce=_y;function _y(E){if(E instanceof at)return E;if(typeof E!="string")return null;var R=E.match(o[re]);return R==null?null:bn((R[1]||"0")+"."+(R[2]||"0")+"."+(R[3]||"0"))}})(hk,hk.exports);const fk=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,bR=/^-(\d{4})(\d{2})(\d{2})$/;function yR(i){return i=i.trim(),i==="*"||fk.test(i)}function pk(i){if(!yR(i))return null;if(i=i.trim(),i==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const e=i.match(fk);return e?{hasCaret:e[1]==="^",hasGreaterEquals:e[1]===">=",majorBase:e[2]==="x"?0:parseInt(e[2],10),majorMustEqual:e[2]!=="x",minorBase:e[4]==="x"?0:parseInt(e[4],10),minorMustEqual:e[4]!=="x",patchBase:e[6]==="x"?0:parseInt(e[6],10),patchMustEqual:e[6]!=="x",preRelease:e[8]||null}:null}function gk(i){if(!i)return null;const e=i.majorBase,t=i.majorMustEqual,n=i.minorBase;let r=i.minorMustEqual;const s=i.patchBase;let o=i.patchMustEqual;i.hasCaret&&(e===0||(r=!1),o=!1);let a=0;if(i.preRelease){const l=bR.exec(i.preRelease);if(l){const[,c,u,d]=l;a=Date.UTC(Number(c),Number(u)-1,Number(d))}}return{majorBase:e,majorMustEqual:t,minorBase:n,minorMustEqual:r,patchBase:s,patchMustEqual:o,isMinimum:i.hasGreaterEquals,notBefore:a}}class xR{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}}function ER(i,e){if(e.serializeBuffersForPostMessage){const t=new xR,r=JSON.stringify(i,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a)};if(ArrayBuffer.isView(a)){const l=SR(a);if(l)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a.buffer),view:{type:l,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),s=t.buffers.map(o=>{const a=new Uint8Array(o);return De.wrap(a)});return{message:r,buffers:s}}else return{message:JSON.stringify(i),buffers:[]}}function SR(i){switch(i.constructor.name){case"Int8Array":return Lt.Int8Array;case"Uint8Array":return Lt.Uint8Array;case"Uint8ClampedArray":return Lt.Uint8ClampedArray;case"Int16Array":return Lt.Int16Array;case"Uint16Array":return Lt.Uint16Array;case"Int32Array":return Lt.Int32Array;case"Uint32Array":return Lt.Uint32Array;case"Float32Array":return Lt.Float32Array;case"Float64Array":return Lt.Float64Array;case"BigInt64Array":return Lt.BigInt64Array;case"BigUint64Array":return Lt.BigUint64Array}}function DR(i,e){const t=e.map(s=>{const o=new ArrayBuffer(s.byteLength);return new Uint8Array(o).set(s.buffer),o}),n=e.length?(s,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:l}=a,c=t[l];if(a.view)switch(a.view.type){case Lt.Int8Array:return new Int8Array(c,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case Lt.Uint8Array:return new Uint8Array(c,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case Lt.Uint8ClampedArray:return new Uint8ClampedArray(c,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case Lt.Int16Array:return new Int16Array(c,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case Lt.Uint16Array:return new Uint16Array(c,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case Lt.Int32Array:return new Int32Array(c,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case Lt.Uint32Array:return new Uint32Array(c,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case Lt.Float32Array:return new Float32Array(c,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case Lt.Float64Array:return new Float64Array(c,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case Lt.BigInt64Array:return new BigInt64Array(c,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case Lt.BigUint64Array:return new BigUint64Array(c,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return c}return o}:void 0;return{message:JSON.parse(i,n),arrayBuffers:t}}class kR{constructor(e,t,n,r,s,o,a){me(this,Oa);me(this,Fa);me(this,zh);me(this,qh);me(this,jh);me(this,Er);me(this,Ma);me(this,$a);me(this,Ua);me(this,Ha);me(this,Gh);me(this,Uc);me(this,Ba);te(this,Ma,""),te(this,Ua,!1),te(this,Ha,!1),this._onMessageEmitter=new L,this.onDidReceiveMessage=this._onMessageEmitter.event,te(this,Ba,new L),this._onDidDispose=I(this,Ba).event,te(this,Oa,e),te(this,Fa,t),te(this,$a,n),te(this,qh,r),te(this,jh,s),te(this,Er,o),te(this,Gh,Ec(o)),te(this,Uc,CR(o)),te(this,zh,a)}dispose(){te(this,Ua,!0),I(this,Ba).fire(),I(this,Ba).dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return te(this,Ha,!0),bh(e,I(this,qh))}get cspSource(){const e=I(this,Er).extensionLocation;if(e.scheme===le.https||e.scheme===le.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+n0}return n0}get html(){return this.assertNotDisposed(),I(this,Ma)}set html(e){this.assertNotDisposed(),I(this,Ma)!==e&&(te(this,Ma,e),I(this,Uc)&&!I(this,Ha)&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(te(this,Ha,!0),I(this,zh).report("Webview vscode-resource: uris",I(this,Er),"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),I(this,Fa).$setHtml(I(this,Oa),this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),I(this,$a)}set options(e){this.assertNotDisposed(),$n(I(this,$a),e)||I(this,Fa).$setOptions(I(this,Oa),mk(I(this,Er),I(this,jh),e)),te(this,$a,e)}async postMessage(e){if(I(this,Ua))return!1;const t=ER(e,{serializeBuffersForPostMessage:I(this,Gh)});return I(this,Fa).$postMessage(I(this,Oa),t.message,...t.buffers)}assertNotDisposed(){if(I(this,Ua))throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){var r;if(!I(this,Uc))return e;const t=((r=I(this,Er).extensionLocation)==null?void 0:r.scheme)===le.vscodeRemote,n=I(this,Er).extensionLocation.scheme===le.vscodeRemote?I(this,Er).extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,l,c,u)=>{const d=y.from({scheme:l||"file",path:decodeURIComponent(c)}),f=bh(d,{isRemote:t,authority:n}).toString();return`${o}${f}${u}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,l,c,u)=>{const d=y.from({scheme:l||"file",path:decodeURIComponent(c)}),f=bh(d,{isRemote:t,authority:n}).toString();return`${o}${f}${u}`})}}Oa=new WeakMap,Fa=new WeakMap,zh=new WeakMap,qh=new WeakMap,jh=new WeakMap,Er=new WeakMap,Ma=new WeakMap,$a=new WeakMap,Ua=new WeakMap,Ha=new WeakMap,Gh=new WeakMap,Uc=new WeakMap,Ba=new WeakMap;function Ec(i){try{const e=gk(pk(i.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return!1}}function CR(i){try{const e=gk(pk(i.engines.vscode));return e?e.majorBase<1||e.majorBase===1&&e.minorBase<60:!1}catch{return!1}}class IR extends Re{constructor(e,t,n,r,s){super(),this.remoteInfo=t,this.workspace=n,this._logService=r,this._deprecationService=s,this._webviews=new Map,this._webviewProxy=e.getProxy(Z.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,n){const r=this.getWebview(e);if(r){const{message:s}=DR(t,n.value);r._onMessageEmitter.fire(s)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,n){const r=new kR(e,this._webviewProxy,PR(t),this.remoteInfo,this.workspace,n,this._deprecationService);this._webviews.set(e,r);const s=r._onDidDispose(()=>{s.dispose(),this.deleteWebview(e)});return r}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function xm(i){return{id:i.identifier,location:i.extensionLocation}}function mk(i,e,t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots||TR(i,e)}}function PR(i){var e;return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:(e=i.localResourceRoots)==null?void 0:e.map(t=>y.from(t))}}function TR(i,e){return[...((e==null?void 0:e.getWorkspaceFolders())||[]).map(t=>t.uri),i.extensionLocation]}const n1=class n1{constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){const t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){n1.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}};n1.enableDebugLogging=!1;let _n=n1;class AR{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new _n("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=MR(this.document.uri)+this._backupCounter++;return Li(this._storagePath,e)}updateBackup(e){var t;(t=this._backup)==null||t.delete(),this._backup=e}disposeBackup(){var e;(e=this._backup)==null||e.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}}class RR{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,n){const r=this.key(e,t.uri);if(this._documents.has(r))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const s=new AR(t,n);return this._documents.set(r,s),s}delete(e,t){const n=this.key(e,t.uri);this._documents.delete(n)}key(e,t){return`${e}@@@${t}`}}var Xs;(function(i){i[i.Text=0]="Text",i[i.Custom=1]="Custom"})(Xs||(Xs={}));class LR{constructor(){this._providers=new Map}addTextProvider(e,t,n){return this.add(e,{type:Xs.Text,extension:t,provider:n})}addCustomProvider(e,t,n){return this.add(e,{type:Xs.Custom,extension:t,provider:n})}get(e){return this._providers.get(e)}add(e,t){if(this._providers.has(e))throw new Error(`Provider for viewType:${e} already registered`);return this._providers.set(e,t),new Qe(()=>this._providers.delete(e))}}class NR{constructor(e,t,n,r,s){this._extHostDocuments=t,this._extensionStoragePaths=n,this._extHostWebview=r,this._extHostWebviewPanels=s,this._editorProviders=new LR,this._documents=new RR,this._proxy=e.getProxy(Z.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,n,r){const s=new Le;return OR(n)?(s.add(this._editorProviders.addTextProvider(t,e,n)),this._proxy.$registerTextEditorProvider(xm(e),t,r.webviewOptions||{},{supportsMove:!!n.moveCustomTextEditor},Ec(e))):(s.add(this._editorProviders.addCustomProvider(t,e,n)),Em(n)&&s.add(n.onDidChangeCustomDocument(o=>{const a=this.getCustomDocumentEntry(t,o.document.uri);if(FR(o)){const l=a.addEdit(o);this._proxy.$onDidEdit(o.document.uri,t,l,o.label)}else this._proxy.$onContentChange(o.document.uri,t)})),this._proxy.$registerCustomEditorProvider(xm(e),t,r.webviewOptions||{},!!r.supportsMultipleEditorsPerDocument,Ec(e))),Qe.from(s,new Qe(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,n,r,s){const o=this._editorProviders.get(t);if(!o)throw new Error(`No provider found for '${t}'`);if(o.type!==Xs.Custom)throw new Error(`Invalid provide type for '${t}'`);const a=y.revive(e),l=await o.provider.openCustomDocument(a,{backupId:n,untitledDocumentData:r==null?void 0:r.buffer},s);let c;return Em(o.provider)&&this._extensionStoragePaths&&(c=this._extensionStoragePaths.workspaceValue(o.extension)??this._extensionStoragePaths.globalValue(o.extension)),this._documents.add(t,l,c),{editable:Em(o.provider)}}async $disposeCustomDocument(e,t){const n=this._editorProviders.get(t);if(!n)throw new Error(`No provider found for '${t}'`);if(n.type!==Xs.Custom)throw new Error(`Invalid provider type for '${t}'`);const r=y.revive(e),{document:s}=this.getCustomDocumentEntry(t,r);this._documents.delete(t,s),s.dispose()}async $resolveCustomEditor(e,t,n,r,s,o){const a=this._editorProviders.get(n);if(!a)throw new Error(`No provider found for '${n}'`);const l=Kt.to(s),c=this._extHostWebview.createNewWebview(t,r.contentOptions,a.extension),u=this._extHostWebviewPanels.createNewWebviewPanel(t,n,r.title,l,r.options,c,r.active),d=y.revive(e);switch(a.type){case Xs.Custom:{const{document:f}=this.getCustomDocumentEntry(n,d);return a.provider.resolveCustomEditor(f,u,o)}case Xs.Text:{const f=this._extHostDocuments.getDocument(d);return a.provider.resolveCustomTextEditor(f,u,o)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,n){this.getCustomDocumentEntry(t,e).disposeEdits(n)}async $onMoveCustomEditor(e,t,n){const r=this._editorProviders.get(n);if(!r)throw new Error(`No provider found for '${n}'`);if(!r.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${n}'`);const s=this._extHostWebviewPanels.getWebviewPanel(e);if(!s)throw new Error("No webview found");const o=y.revive(t),a=this._extHostDocuments.getDocument(o);await r.provider.moveCustomTextEditor(a,s,Nt.None)}async $undo(e,t,n,r){return this.getCustomDocumentEntry(t,e).undo(n,r)}async $redo(e,t,n,r){return this.getCustomDocumentEntry(t,e).redo(n,r)}async $revert(e,t,n){const r=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).revertCustomDocument(r.document,n),r.disposeBackup()}async $onSave(e,t,n){const r=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).saveCustomDocument(r.document,n),r.disposeBackup()}async $onSaveAs(e,t,n,r){const s=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(s.document,y.revive(n),r)}async $backup(e,t,n){const r=this.getCustomDocumentEntry(t,e),o=await this.getCustomEditorProvider(t).backupCustomDocument(r.document,{destination:r.getNewBackupUri()},n);return r.updateBackup(o),o.id}getCustomDocumentEntry(e,t){const n=this._documents.get(e,y.revive(t));if(!n)throw new Error("No custom document found");return n}getCustomEditorProvider(e){const t=this._editorProviders.get(e),n=t==null?void 0:t.provider;if(!n||!Em(n))throw new Error("Custom document is not editable");return n}}function Em(i){return!!i.onDidChangeCustomDocument}function OR(i){return typeof i.resolveCustomTextEditor=="function"}function FR(i){return typeof i.undo=="function"&&typeof i.redo=="function"}function MR(i){const e=i.scheme===le.file||i.scheme===le.untitled?i.fsPath:i.toString();return td(e)+""}var ga;const ey=class ey{constructor(e,t,n,r,s,o,a,l){me(this,gs);me(this,to);me(this,fi);this._name=e,this._owner=t,this._maxDiagnosticsTotal=n,this._maxDiagnosticsPerFile=r,this._modelVersionIdProvider=s,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(r,n),te(this,fi,new $t(c=>o.getComparisonKey(c))),te(this,gs,a),te(this,to,l)}dispose(){var e;this._isDisposed||(I(this,to).fire([...I(this,fi).keys()]),(e=I(this,gs))==null||e.$clear(this._owner),I(this,fi).clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(e,t){if(!e){this.clear();return}this._checkDisposed();let n=[];if(y.isUri(e)){if(!t){this.delete(e);return}I(this,fi).set(e,t.slice()),n=[e]}else if(Array.isArray(e)){n=[];let o;e=[...e].sort(ey._compareIndexedTuplesByUri);for(const a of e){const[l,c]=a;if((!o||l.toString()!==o.toString())&&(o&&I(this,fi).get(o).length===0&&I(this,fi).delete(o),o=l,n.push(l),I(this,fi).set(l,[])),c){const u=I(this,fi).get(l);u==null||u.push(...c)}else{const u=I(this,fi).get(l);u&&(u.length=0)}}}if(I(this,to).fire(n),!I(this,gs))return;const r=[];let s=0;for(const o of n){let a=[];const l=I(this,fi).get(o);if(l)if(l.length>this._maxDiagnosticsPerFile){a=[];const c=[bi.Error,bi.Warning,bi.Information,bi.Hint];e:for(let u=0;u<4;u++)for(const d of l)if(d.severity===c[u]&&a.push({...tc.from(d),modelVersionId:this._modelVersionIdProvider(o)})===this._maxDiagnosticsPerFile)break e;a.push({severity:Bi.Info,message:h(4816,"Not showing {0} further errors and warnings.",l.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=l.map(c=>({...tc.from(c),modelVersionId:this._modelVersionIdProvider(o)}));if(r.push([o,a]),s+=a.length,s>this._maxDiagnosticsTotal)break}I(this,gs).$changeMany(this._owner,r)}delete(e){var t;this._checkDisposed(),I(this,to).fire([e]),I(this,fi).delete(e),(t=I(this,gs))==null||t.$changeMany(this._owner,[[e,void 0]])}clear(){var e;this._checkDisposed(),I(this,to).fire([...I(this,fi).keys()]),I(this,fi).clear(),(e=I(this,gs))==null||e.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(const[n,r]of this)e.call(t,n,r,this)}*[Symbol.iterator](){this._checkDisposed();for(const e of I(this,fi).keys())yield[e,this.get(e)]}get(e){this._checkDisposed();const t=I(this,fi).get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(I(this,fi).get(e))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}};gs=new WeakMap,to=new WeakMap,fi=new WeakMap;let Sm=ey,r0=(Sr=class{static _mapper(e){const t=new $t;for(const n of e)t.set(n,n);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,n,r){this._logService=t,this._fileSystemInfoService=n,this._extHostDocumentsAndEditors=r,this._collections=new Map,this._onDidChangeDiagnostics=new sC({merge:s=>s.flat(),delay:50}),this.onDidChangeDiagnostics=Ht.map(this._onDidChangeDiagnostics.event,ga._mapper),this._proxy=e.getProxy(Z.MainThreadDiagnostics)}createDiagnosticCollection(e,t){const{_collections:n,_proxy:r,_onDidChangeDiagnostics:s,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:l}=this,c=new class{$changeMany(f,p){r.$changeMany(f,p),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,f,p.length===0?"CLEARING":p)}$clear(f){r.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,f)}dispose(){r.dispose()}};let u;if(!t)t="_generated_diagnostic_collection_name_#"+ga._idPool++,u=t;else if(!n.has(t))u=t;else{this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do u=t+ga._idPool++;while(n.has(u))}return new class extends Sm{constructor(){super(t,u,ga._maxDiagnosticsTotal,ga._maxDiagnosticsPerFile,f=>{var p;return(p=l.getDocument(f))==null?void 0:p.version},a.extUri,c,s),n.set(u,this)}dispose(){super.dispose(),n.delete(u)}}}getDiagnostics(e){if(e)return this._getDiagnostics(e);{const t=new Map,n=[];for(const r of this._collections.values())r.forEach((s,o)=>{let a=t.get(s.toString());typeof a>"u"&&(a=n.length,t.set(s.toString(),a),n.push([s,[]])),n[a][1]=n[a][1].concat(...o)});return n}}_getDiagnostics(e){let t=[];for(const n of this._collections.values())n.has(e)&&(t=t.concat(n.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){const t="_generated_mirror",n=new Sm(t,t,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,r=>{},this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(t,n),this._mirrorCollection=n}for(const[t,n]of e)this._mirrorCollection.set(y.revive(t),n.map(tc.to))}},ga=Sr,Sr._idPool=0,Sr._maxDiagnosticsPerFile=1e3,Sr._maxDiagnosticsTotal=1.1*Sr._maxDiagnosticsPerFile,Sr);r0=ga=B([O(1,rt),O(2,pl)],r0);class $R{constructor(e){this._proxy=e.getProxy(Z.MainThreadDialogs)}showOpenDialog(e,t){return t!=null&&t.allowUIResources&&M(e,"showLocal"),this._proxy.$showOpenDialog(t).then(n=>n?n.map(r=>y.revive(r)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(t=>t?y.revive(t):void 0)}}const r1=class r1{constructor(e,t,n){this._documentsAndEditors=t,this._logService=n,this._documentContentProviders=new Map,this._proxy=e.getProxy(Z.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,t){if(Object.keys(le).indexOf(e)>=0)throw new Error(`scheme '${e}' already registered`);const n=r1._handlePool++;this._documentContentProviders.set(n,t),this._proxy.$registerTextContentProvider(n,e);let r;if(typeof t.onDidChange=="function"){let s;r=t.onDidChange(async o=>{if(o.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o))return;s&&await s;const a=this.$provideTextDocumentContent(n,o).then(async l=>{if(!l&&typeof l!="string")return;const c=this._documentsAndEditors.getDocument(o);if(!c)return;const u=px(l);if(!c.equalLines(u))return this._proxy.$onVirtualDocumentChange(o,l)}).catch(ln).finally(()=>{s===a&&(s=void 0)});s=a})}return new Qe(()=>{this._documentContentProviders.delete(n)&&this._proxy.$unregisterTextContentProvider(n),r&&(r.dispose(),r=void 0)})}$provideTextDocumentContent(e,t){const n=this._documentContentProviders.get(e);return n?Promise.resolve(n.provideTextDocumentContent(y.revive(t),Nt.None)):Promise.reject(new Error(`unsupported uri-scheme: ${t.scheme}`))}};r1._handlePool=0;let s0=r1;class UR{constructor(e,t,n,r={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=n,this._thresholds=r,this._callbacks=new hu,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,n,r)=>{const o={dispose:this._callbacks.push([t,n,e])};return Array.isArray(r)&&r.push(o),o}}async $participateInSave(e,t){const n=y.revive(e);let r=!1;const s=setTimeout(()=>r=!0,this._thresholds.timeout),o=[];try{for(const a of[...this._callbacks]){if(r)break;const l=this._documents.getDocument(n),c=await this._deliverEventAsyncAndBlameBadListeners(a,{document:l,reason:$g.to(t)});o.push(c)}}finally{clearTimeout(s)}return o}_deliverEventAsyncAndBlameBadListeners([e,t,n],r){const s=this._badListeners.get(e);return typeof s=="number"&&s>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(n,e,t,r).then(()=>!0,o=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' threw ERROR`),this._logService.error(o),!(o instanceof Error)||o.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,a?a+1:1),typeof a=="number"&&a>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,n,r){const s=[],o=Date.now(),{document:a,reason:l}=r,{version:c}=a,u=Object.freeze({document:a,reason:l,waitUntil(d){if(Object.isFrozen(s))throw k1("waitUntil can not be called async");s.push(Promise.resolve(d))}});try{t.apply(n,[u])}catch(d){return Promise.reject(d)}return new Promise((d,f)=>{const p=setTimeout(()=>f(new Error("timeout")),this._thresholds.timeout);return Promise.all(s).then(b=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`),clearTimeout(p),d(b)}).catch(b=>{clearTimeout(p),f(b)})}).then(d=>{const f={edits:[]};for(const p of d)if(Array.isArray(p)&&p.every(b=>b instanceof Ns))for(const{newText:b,newEol:w,range:v}of p)f.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:v&&H.from(v),text:b,eol:w&&oc.from(w)}});if(f.edits.length!==0)return c===a.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new un(f)):Promise.reject(new Error("concurrent_edits"))})}}class HR{constructor(e,t){this._onDidAddDocument=new L,this._onDidRemoveDocument=new L,this._onDidChangeDocument=new L,this._onDidSaveDocument=new L,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new Le,this._documentLoader=new Map,this._proxy=e.getProxy(Z.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(n=>{for(const r of n)this._onDidRemoveDocument.fire(r.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(n=>{for(const r of n)this._onDidAddDocument.fire(r.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!(t!=null&&t.document))throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e){const t=this._documentsAndEditors.getDocument(e);if(t)return Promise.resolve(t);let n=this._documentLoader.get(e.toString());return n||(n=this._proxy.$tryOpenDocument(e).then(r=>{this._documentLoader.delete(e.toString());const s=y.revive(r);return al(this._documentsAndEditors.getDocument(s))},r=>(this._documentLoader.delete(e.toString()),Promise.reject(r))),this._documentLoader.set(e.toString(),n)),n}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(t=>y.revive(t))}$acceptModelLanguageChanged(e,t){const n=y.revive(e),r=this._documentsAndEditors.getDocument(n);if(!r)throw new Error("unknown document");this._onDidRemoveDocument.fire(r.document),r._acceptLanguageId(t),this._onDidAddDocument.fire(r.document)}$acceptModelSaved(e){const t=y.revive(e),n=this._documentsAndEditors.getDocument(t);if(!n)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(n.document)}$acceptDirtyStateChanged(e,t){const n=y.revive(e),r=this._documentsAndEditors.getDocument(n);if(!r)throw new Error("unknown document");r._acceptIsDirty(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,n){const r=y.revive(e),s=this._documentsAndEditors.getDocument(r);if(!s)throw new Error("unknown document");s._acceptIsDirty(n),s.onEvents(t);let o;t.isUndoing?o=wd.Undo:t.isRedoing&&(o=wd.Redo),this._onDidChangeDocument.fire(Yx({document:s.document,contentChanges:t.changes.map(a=>({range:H.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text})),reason:o}))}setWordDefinitionFor(e,t){b6(e,t)}}class BR{constructor(e){this._provider=new Map,this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this._allKnownModels=new Set,this._handlePool=0,this._proxy=e.getProxy(Z.MainThreadEmbeddings)}registerEmbeddingsProvider(e,t,n){if(this._allKnownModels.has(t))throw new Error("An embeddings provider for this model is already registered");const r=this._handlePool++;return this._proxy.$registerEmbeddingProvider(r,t),this._provider.set(r,{id:t,provider:n}),Me(()=>{this._allKnownModels.delete(t),this._proxy.$unregisterEmbeddingProvider(r),this._provider.delete(r)})}async computeEmbeddings(e,t,n){n??(n=Nt.None);let r=!1;typeof t=="string"&&(t=[t],r=!0);const s=await this._proxy.$computeEmbeddings(e,t,n);if(s.length!==t.length)throw new Error;if(r){if(s.length!==1)throw new Error;return s[0]}return s}async $provideEmbeddings(e,t,n){const r=this._provider.get(e);if(!r)return[];const s=await r.provider.provideEmbeddings(t,n);return s||[]}get embeddingsModels(){return Array.from(this._allKnownModels)}$acceptEmbeddingModels(e){this._allKnownModels=new Set(e),this._onDidChange.fire()}}class WR{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(Z.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,n){if(this._AiEmbeddingVectorProviders.size===0)throw new Error("No embedding vector providers registered");const r=this._AiEmbeddingVectorProviders.get(e);if(!r)throw new Error("Embedding vector provider not found");const s=await r.provideEmbeddingVector(t,n);if(!s)throw new Error("Embedding vector provider returned undefined");return s}registerEmbeddingVectorProvider(e,t,n){const r=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(r,n),this._proxy.$registerAiEmbeddingVectorProvider(t,r),new Qe(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(r),this._AiEmbeddingVectorProviders.delete(r)})}}var ve;(function(i){i[i.Invalid=0]="Invalid",i[i.Start=1]="Start",i[i.H=2]="H",i[i.HT=3]="HT",i[i.HTT=4]="HTT",i[i.HTTP=5]="HTTP",i[i.F=6]="F",i[i.FI=7]="FI",i[i.FIL=8]="FIL",i[i.BeforeColon=9]="BeforeColon",i[i.AfterColon=10]="AfterColon",i[i.AlmostThere=11]="AlmostThere",i[i.End=12]="End",i[i.Accept=13]="Accept",i[i.LastKnownState=14]="LastKnownState"})(ve||(ve={}));class VR{constructor(e,t,n){const r=new Uint8Array(e*t);for(let s=0,o=e*t;s<o;s++)r[s]=n;this._data=r,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,n){this._data[e*this.cols+t]=n}}class _k{constructor(e){let t=0,n=ve.Invalid;for(let s=0,o=e.length;s<o;s++){const[a,l,c]=e[s];l>t&&(t=l),a>n&&(n=a),c>n&&(n=c)}t++,n++;const r=new VR(n,t,ve.Invalid);for(let s=0,o=e.length;s<o;s++){const[a,l,c]=e[s];r.set(a,l,c)}this._states=r,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?ve.Invalid:this._states.get(e,t)}}let o0=null;function zR(){return o0===null&&(o0=new _k([[ve.Start,P.h,ve.H],[ve.Start,P.H,ve.H],[ve.Start,P.f,ve.F],[ve.Start,P.F,ve.F],[ve.H,P.t,ve.HT],[ve.H,P.T,ve.HT],[ve.HT,P.t,ve.HTT],[ve.HT,P.T,ve.HTT],[ve.HTT,P.p,ve.HTTP],[ve.HTT,P.P,ve.HTTP],[ve.HTTP,P.s,ve.BeforeColon],[ve.HTTP,P.S,ve.BeforeColon],[ve.HTTP,P.Colon,ve.AfterColon],[ve.F,P.i,ve.FI],[ve.F,P.I,ve.FI],[ve.FI,P.l,ve.FIL],[ve.FI,P.L,ve.FIL],[ve.FIL,P.e,ve.BeforeColon],[ve.FIL,P.E,ve.BeforeColon],[ve.BeforeColon,P.Colon,ve.AfterColon],[ve.AfterColon,P.Slash,ve.AlmostThere],[ve.AlmostThere,P.Slash,ve.End]])),o0}var Dt;(function(i){i[i.None=0]="None",i[i.ForceTermination=1]="ForceTermination",i[i.CannotEndIn=2]="CannotEndIn"})(Dt||(Dt={}));let yh=null;function qR(){if(yh===null){yh=new cm(Dt.None);const i=` 	<>'"`;for(let t=0;t<i.length;t++)yh.set(i.charCodeAt(t),Dt.ForceTermination);const e=".,;:";for(let t=0;t<e.length;t++)yh.set(e.charCodeAt(t),Dt.CannotEndIn)}return yh}class Dm{static _createLink(e,t,n,r,s){let o=s-1;do{const a=t.charCodeAt(o);if(e.get(a)!==Dt.CannotEndIn)break;o--}while(o>r);if(r>0){const a=t.charCodeAt(r-1),l=t.charCodeAt(o);(a===P.OpenParen&&l===P.CloseParen||a===P.OpenSquareBracket&&l===P.CloseSquareBracket||a===P.OpenCurlyBrace&&l===P.CloseCurlyBrace)&&o--}return{range:{startLineNumber:n,startColumn:r+1,endLineNumber:n,endColumn:o+2},url:t.substring(r,o+1)}}static computeLinks(e,t=zR()){const n=qR(),r=[];for(let s=1,o=e.getLineCount();s<=o;s++){const a=e.getLineContent(s),l=a.length;let c=0,u=0,d=0,f=ve.Start,p=!1,b=!1,w=!1,v=!1;for(;c<l;){let S=!1;const k=a.charCodeAt(c);if(f===ve.Accept){let C;switch(k){case P.OpenParen:p=!0,C=Dt.None;break;case P.CloseParen:C=p?Dt.None:Dt.ForceTermination;break;case P.OpenSquareBracket:w=!0,b=!0,C=Dt.None;break;case P.CloseSquareBracket:w=!1,C=b?Dt.None:Dt.ForceTermination;break;case P.OpenCurlyBrace:v=!0,C=Dt.None;break;case P.CloseCurlyBrace:C=v?Dt.None:Dt.ForceTermination;break;case P.SingleQuote:case P.DoubleQuote:case P.BackTick:d===k?C=Dt.ForceTermination:d===P.SingleQuote||d===P.DoubleQuote||d===P.BackTick?C=Dt.None:C=Dt.ForceTermination;break;case P.Asterisk:C=d===P.Asterisk?Dt.ForceTermination:Dt.None;break;case P.Pipe:C=d===P.Pipe?Dt.ForceTermination:Dt.None;break;case P.Space:C=w?Dt.None:Dt.ForceTermination;break;default:C=n.get(k)}C===Dt.ForceTermination&&(r.push(Dm._createLink(n,a,s,u,c)),S=!0)}else if(f===ve.End){let C;k===P.OpenSquareBracket?(b=!0,C=Dt.None):C=n.get(k),C===Dt.ForceTermination?S=!0:f=ve.Accept}else f=t.nextState(f,k),f===ve.Invalid&&(S=!0);S&&(f=ve.Start,p=!1,b=!1,v=!1,u=c+1,d=k),c++}f===ve.Accept&&r.push(Dm._createLink(n,a,s,u,l))}return r}}class jR{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let n,r,s=ve.LastKnownState,o=ve.LastKnownState;for(const a of e){let l=n?VC(n,a):0;for(l===0?r=ve.Start:r=o;l<a.length;l++)l+1===a.length?(s=o,o=ve.BeforeColon):o+=1,t.push([r,a.toUpperCase().charCodeAt(l),o]),t.push([r,a.toLowerCase().charCodeAt(l),o]),r=o;n=a,o=s}t.push([ve.BeforeColon,P.Colon,ve.AfterColon]),t.push([ve.AfterColon,P.Slash,ve.End]),this._stateMachine=new _k(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],n=Dm.computeLinks({getLineContent(r){return e.lineAt(r-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const r of n){const s=aa.to(r);s.target&&t.push(s)}return t}}class km{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new jR,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(Z.MainThreadFileSystem)}dispose(){var e;(e=this._linkProviderRegistration)==null||e.dispose()}registerFileSystemProvider(e,t,n,r={}){if(km._validateFileSystemProvider(n),this._registeredSchemes.has(t))throw new Error(`a provider for the scheme '${t}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider));const s=this._handlePool++;this._linkProvider.add(t),this._registeredSchemes.add(t),this._fsProvider.set(s,n);let o=or.FileReadWrite;r.isCaseSensitive&&(o+=or.PathCaseSensitive),r.isReadonly&&(o+=or.Readonly),typeof n.copy=="function"&&(o+=or.FileFolderCopy),typeof n.open=="function"&&typeof n.close=="function"&&typeof n.read=="function"&&typeof n.write=="function"&&(M(e,"fsChunks"),o+=or.FileOpenReadWriteClose);let a;r.isReadonly&&Io(r.isReadonly)&&r.isReadonly.value!==""&&(a={value:r.isReadonly.value,isTrusted:r.isReadonly.isTrusted,supportThemeIcons:r.isReadonly.supportThemeIcons,supportHtml:r.isReadonly.supportHtml,baseUri:r.isReadonly.baseUri,uris:r.isReadonly.uris}),this._proxy.$registerFileSystemProvider(s,t,o,a).catch(c=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${t}`),console.error(c)});const l=n.onDidChangeFile(c=>{const u=[];for(const d of c){const{uri:f,type:p}=d;if(f.scheme!==t)continue;let b;switch(p){case Ql.Changed:b=Iu.UPDATED;break;case Ql.Created:b=Iu.ADDED;break;case Ql.Deleted:b=Iu.DELETED;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:b})}this._proxy.$onFileSystemChange(s,u)});return Me(()=>{l.dispose(),this._linkProvider.delete(t),this._registeredSchemes.delete(t),this._fsProvider.delete(s),this._proxy.$unregisterProvider(s)})}static _validateFileSystemProvider(e){if(!e)throw new Error("MISSING provider");if(typeof e.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof e.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof e.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof e.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof e.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof e.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof e.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof e.rename!="function")throw new Error("Provider does NOT implement rename")}static _asIStat(e){const{type:t,ctime:n,mtime:r,size:s,permissions:o}=e;return{type:t,ctime:n,mtime:r,size:s,permissions:o}}$stat(e,t){return Promise.resolve(this._getFsProvider(e).stat(y.revive(t))).then(n=>km._asIStat(n))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(y.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(y.revive(t))).then(n=>De.wrap(n))}$writeFile(e,t,n,r){return Promise.resolve(this._getFsProvider(e).writeFile(y.revive(t),n.buffer,r))}$delete(e,t,n){return Promise.resolve(this._getFsProvider(e).delete(y.revive(t),n))}$rename(e,t,n,r){return Promise.resolve(this._getFsProvider(e).rename(y.revive(t),y.revive(n),r))}$copy(e,t,n,r){const s=this._getFsProvider(e);if(!s.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(s.copy(y.revive(t),y.revive(n),r))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(y.revive(t)))}$watch(e,t,n,r){const s=this._getFsProvider(e).watch(y.revive(n),r);this._watches.set(t,s)}$unwatch(e,t){const n=this._watches.get(t);n&&(n.dispose(),this._watches.delete(t))}$open(e,t,n){const r=this._getFsProvider(e);if(!r.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(r.open(y.revive(t),n))}$close(e,t){const n=this._getFsProvider(e);if(!n.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(n.close(t))}$read(e,t,n,r){const s=this._getFsProvider(e);if(!s.read)throw new Error('FileSystemProvider does not implement "read"');const o=De.alloc(r);return Promise.resolve(s.read(t,n,o.buffer,0,r)).then(a=>o.slice(0,a))}$write(e,t,n,r){const s=this._getFsProvider(e);if(!s.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(s.write(t,n,r.buffer,0,r.byteLength))}_getFsProvider(e){const t=this._fsProvider.get(e);if(!t){const n=new Error;throw n.name="ENOPRO",n.message="no provider",n}return t}}class GR{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,n,r,s,o){this.session=Math.random(),this._onDidCreate=new L,this._onDidChange=new L,this._onDidDelete=new L,this._config=0,o!=null&&o.ignoreCreateEvents&&(this._config+=1),o!=null&&o.ignoreChangeEvents&&(this._config+=2),o!=null&&o.ignoreDeleteEvents&&(this._config+=4);const a=Ll(s),l=typeof s=="string",c=o==null?void 0:o.correlate,u=r(d=>{if(!(typeof d.session=="number"&&d.session!==this.session)&&!(c&&typeof d.session>"u")){if(!(o!=null&&o.ignoreCreateEvents))for(const f of d.created){const p=y.revive(f);a(p.fsPath)&&(!l||t.getWorkspaceFolder(p))&&this._onDidCreate.fire(p)}if(!(o!=null&&o.ignoreChangeEvents))for(const f of d.changed){const p=y.revive(f);a(p.fsPath)&&(!l||t.getWorkspaceFolder(p))&&this._onDidChange.fire(p)}if(!(o!=null&&o.ignoreDeleteEvents))for(const f of d.deleted){const p=y.revive(f);a(p.fsPath)&&(!l||t.getWorkspaceFolder(p))&&this._onDidDelete.fire(p)}}});this._disposable=Qe.from(this.ensureWatching(e,n,s,o,o==null?void 0:o.correlate),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,n,r,s){const o=Qe.from();if(typeof n=="string"||r!=null&&r.ignoreChangeEvents&&(r!=null&&r.ignoreCreateEvents)&&(r!=null&&r.ignoreDeleteEvents))return o;const a=e.getProxy(Z.MainThreadFileSystemEventService);let l=!1;(n.pattern.includes(sd)||n.pattern.includes(z_))&&(l=!0);let c;return s&&(r!=null&&r.ignoreChangeEvents||r!=null&&r.ignoreCreateEvents||r!=null&&r.ignoreDeleteEvents)&&(c=Is.UPDATED|Is.ADDED|Is.DELETED,r!=null&&r.ignoreChangeEvents&&(c&=~Is.UPDATED),r!=null&&r.ignoreCreateEvents&&(c&=~Is.ADDED),r!=null&&r.ignoreDeleteEvents&&(c&=~Is.DELETED)),a.$watch(t.identifier.value,this.session,n.baseUri,{recursive:l,excludes:(r==null?void 0:r.excludes)??[],filter:c},!!s),Qe.from({dispose:()=>a.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class QR{constructor(e){this._events=e,this.session=this._events.session,this._created=new yt(()=>this._events.created.map(y.revive)),this._changed=new yt(()=>this._events.changed.map(y.revive)),this._deleted=new yt(()=>this._events.deleted.map(y.revive))}get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}}class JR{constructor(e,t,n){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=n,this._onFileSystemEvent=new L,this._onDidRenameFile=new L,this._onDidCreateFile=new L,this._onDidDeleteFile=new L,this._onWillRenameFile=new fu,this._onWillCreateFile=new fu,this._onWillDeleteFile=new fu,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,n,r){return new GR(this._mainContext,e,t,this._onFileSystemEvent.event,nn.from(n),r)}$onFileEvent(e){this._onFileSystemEvent.fire(new QR(e))}$onDidRunFileOperation(e,t){switch(e){case ar.MOVE:this._onDidRenameFile.fire(Object.freeze({files:t.map(n=>({oldUri:y.revive(n.source),newUri:y.revive(n.target)}))}));break;case ar.DELETE:this._onDidDeleteFile.fire(Object.freeze({files:t.map(n=>y.revive(n.target))}));break;case ar.CREATE:case ar.COPY:this._onDidCreateFile.fire(Object.freeze({files:t.map(n=>y.revive(n.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(n,r,s)=>{const o=function(l){n.call(r,l)};return o.extension=e,t.event(o,void 0,s)}}async $onWillRunFileOperation(e,t,n,r){switch(e){case ar.MOVE:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(s=>({oldUri:y.revive(s.source),newUri:y.revive(s.target)}))},n,r);case ar.DELETE:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(s=>y.revive(s.target))},n,r);case ar.CREATE:case ar.COPY:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(s=>y.revive(s.target))},n,r)}}async _fireWillEvent(e,t,n,r){const s=new Set,o=[];if(await e.fireAsync(t,r,async(l,c)=>{const u=Date.now(),d=await Promise.resolve(l);d instanceof jo&&(o.push([c.extension,d]),s.add(c.extension.displayName??c.extension.identifier.value)),Date.now()-u>n&&this._logService.warn("SLOW file-participant",c.extension.identifier)}),r.isCancellationRequested||o.length===0)return;const a={edits:[]};for(const[,l]of o){const{edits:c}=Mi.from(l,{getTextDocumentVersion:u=>{var d;return(d=this._extHostDocumentsAndEditors.getDocument(u))==null?void 0:d.version},getNotebookDocumentVersion:()=>{}});a.edits=a.edits.concat(c)}return{edit:a,extensionNames:Array.from(s)}}}class XR{constructor(e,t,n,r,s){this._extHostNotebooks=t,this._textDocumentsAndEditors=n,this._commands=r;const o=new Ee("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new z("showOptions","Show Options",a=>!0,a=>a),new z("resource","Interactive resource Uri",a=>!0,a=>a),new z("controllerId","Notebook controller Id",a=>!0,a=>a),new z("title","Interactive editor title",a=>!0,a=>a)],new xe("Notebook and input URI",a=>{if(s.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId),a.notebookEditorId!==void 0){const l=this._extHostNotebooks.getEditorById(a.notebookEditorId);return s.debug("[ExtHostInteractive] notebook editor found",l.id),{notebookUri:y.revive(a.notebookUri),inputUri:y.revive(a.inputUri),notebookEditor:l.apiEditor}}return s.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri),{notebookUri:y.revive(a.notebookUri),inputUri:y.revive(a.inputUri)}}));this._commands.registerApiCommand(o)}$willAddInteractiveDocument(e,t,n,r){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:n,uri:e,isDirty:!1,versionId:1}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class YR{constructor(e){this._handlePool=0,this._proxy=e.getProxy(Z.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),Me(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}}var Ys;(function(i){i[i.LTR=0]="LTR",i[i.RTL=1]="RTL"})(Ys||(Ys={}));class vn extends ct{constructor(e,t,n,r){super(e,t,n,r),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=r}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return vn.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?Ys.LTR:Ys.RTL}setEndPosition(e,t){return this.getDirection()===Ys.LTR?new vn(this.startLineNumber,this.startColumn,e,t):new vn(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new pn(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new pn(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===Ys.LTR?new vn(e,t,this.endLineNumber,this.endColumn):new vn(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new vn(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===Ys.LTR?new vn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new vn(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new vn(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,n,r,s){return s===Ys.LTR?new vn(e,t,n,r):new vn(n,r,e,t)}}class Cm{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(e,t){const n=this._documents.getDocument(e),r=await this._provider.provideDocumentSymbols(n,t);if(!P1(r))return r[0]instanceof pd?r.map(iw.from):Cm._asDocumentSymbolTree(r)}static _asDocumentSymbolTree(e){var r,s;e=e.slice(0).sort((o,a)=>{let l=o.location.range.start.compareTo(a.location.range.start);return l===0&&(l=a.location.range.end.compareTo(o.location.range.end)),l});const t=[],n=[];for(const o of e){const a={name:o.name||"!!MISSING: name!!",kind:In.from(o.kind),tags:((r=o.tags)==null?void 0:r.map(Kr.from))||[],detail:"",containerName:o.containerName,range:H.from(o.location.range),selectionRange:H.from(o.location.range),children:[]};for(;;){if(n.length===0){n.push(a),t.push(a);break}const l=n[n.length-1];if(ct.containsRange(l.range,a.range)&&!ct.equalsRange(l.range,a.range)){(s=l.children)==null||s.push(a),n.push(a);break}n.pop()}}return t}}class Im{constructor(e,t,n,r,s,o){this._documents=e,this._commands=t,this._provider=n,this._extension=r,this._extTelemetry=s,this._logService=o,this._cache=new _n("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const n=this._documents.getDocument(e),r=await this._provider.provideCodeLenses(n,t);if(!r||t.isCancellationRequested)return;const s=this._cache.add(r),o=new Le;this._disposables.set(s,o);const a={cacheId:s,lenses:[]};for(let l=0;l<r.length;l++)a.lenses.push({cacheId:[s,l],range:H.from(r[l].range),command:this._commands.toInternal(r[l].command,o)});return a}async resolveCodeLens(e,t){const n=e.cacheId&&this._cache.get(...e.cacheId);if(!n)return;let r;if(typeof this._provider.resolveCodeLens!="function"||n.isResolved?r=n:r=await this._provider.resolveCodeLens(n,t),r||(r=n),t.isCancellationRequested)return;const s=e.cacheId&&this._disposables.get(e.cacheId[0]);if(s){if(!r.command){const o=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,o),this._logService.error(o);return}return e.command=this._commands.toInternal(r.command,s),e}}releaseCodeLenses(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}}function Pm(i){return Array.isArray(i)?i.map(zd.from):i?[zd.from(i)]:[]}class vk{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideDefinition(r,s,n);return Pm(o)}}class wk{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideDeclaration(r,s,n);return Pm(o)}}class bk{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideImplementation(r,s,n);return Pm(o)}}class yk{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideTypeDefinition(r,s,n);return Pm(o)}}const s1=class s1{constructor(e,t){this._documents=e,this._provider=t,this._hoverCounter=0,this._hoverMap=new Map}async provideHover(e,t,n,r){const s=this._documents.getDocument(e),o=nt.to(t);let a;if(n&&n.verbosityRequest){const d=n.verbosityRequest.previousHover.id,f=this._hoverMap.get(d);if(!f)throw new Error(`Hover with id ${d} not found`);const p={verbosityDelta:n.verbosityRequest.verbosityDelta,previousHover:f};a=await this._provider.provideHover(s,o,r,p)}else a=await this._provider.provideHover(s,o,r);if(!a||P1(a.contents))return;a.range||(a.range=s.getWordRangeAtPosition(o)),a.range||(a.range=new Fe(o,o));const l=qd.from(a),c=this._hoverCounter;if(this._hoverMap.size===s1.HOVER_MAP_MAX_SIZE){const d=Math.min(...this._hoverMap.keys());this._hoverMap.delete(d)}return this._hoverMap.set(c,a),this._hoverCounter+=1,{...l,id:c}}releaseHover(e){this._hoverMap.delete(e)}};s1.HOVER_MAP_MAX_SIZE=10;let xh=s1;class xk{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideEvaluatableExpression(r,s,n);if(o)return sw.from(o)}}class Ek{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,n,r){const s=this._documents.getDocument(e),o=await this._provider.provideInlineValues(s,H.to(t),Ag.to(n),r);if(Array.isArray(o))return o.map(a=>Tg.from(a))}}class Sk{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideDocumentHighlights(r,s,n);if(Array.isArray(o))return o.map(nc.from)}}class Dk{constructor(e,t){this._documents=e,this._provider=t}async provideMultiDocumentHighlights(e,t,n,r){const s=this._documents.getDocument(e),o=n.map(c=>this._documents.getDocument(c)),a=nt.to(t),l=await this._provider.provideMultiDocumentHighlights(s,a,o,r);if(Array.isArray(l))return l.map(ow.from)}}class kk{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideLinkedEditingRanges(r,s,n);if(o&&Array.isArray(o.ranges))return{ranges:Ti(o.ranges.map(H.from)),wordPattern:o.wordPattern}}}class Ck{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,n,r){const s=this._documents.getDocument(e),o=nt.to(t),a=await this._provider.provideReferences(s,o,n,r);if(Array.isArray(a))return a.map(zi.from)}}const Hc=class Hc{constructor(e,t,n,r,s,o,a){this._documents=e,this._commands=t,this._diagnostics=n,this._provider=r,this._logService=s,this._extension=o,this._apiDeprecation=a,this._cache=new _n("CodeAction"),this._disposables=new Map}async provideCodeActions(e,t,n,r){var p;const s=this._documents.getDocument(e),o=vn.isISelection(t)?Qn.to(t):H.to(t),a=[];for(const b of this._diagnostics.getDiagnostics(e))if(o.intersection(b.range)&&a.push(b)>Hc._maxCodeActionsPerFile)break;const l={diagnostics:a,only:n.only?new St(n.only):void 0,triggerKind:bw.to(n.trigger)},c=await this._provider.provideCodeActions(s,o,l,r);if(!uu(c)||r.isCancellationRequested)return;const u=this._cache.add(c),d=new Le;this._disposables.set(u,d);const f=[];for(let b=0;b<c.length;b++){const w=c[b];if(w)if(Hc._isCommand(w))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:w.title,command:this._commands.toInternal(w,d)});else{l.only&&(w.kind?l.only.contains(w.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action is of kind '${w.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const v=w.ranges??[];f.push({cacheId:[u,b],title:w.title,command:w.command&&this._commands.toInternal(w.command,d),diagnostics:w.diagnostics&&w.diagnostics.map(tc.from),edit:w.edit&&Mi.from(w.edit,void 0),kind:w.kind&&w.kind.value,isPreferred:w.isPreferred,isAI:ii(this._extension,"codeActionAI")?w.isAI:!1,ranges:ii(this._extension,"codeActionRanges")?Ti(v.map(H.from)):void 0,disabled:(p=w.disabled)==null?void 0:p.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(e,t){const[n,r]=e,s=this._cache.get(n,r);if(!s||Hc._isCommand(s))return{};if(!this._provider.resolveCodeAction)return{};const o=await this._provider.resolveCodeAction(s,t)??s;let a;o.edit&&(a=Mi.from(o.edit,void 0));let l;if(o.command){const c=this._disposables.get(n);c&&(l=this._commands.toInternal(o.command,c))}return{edit:a,command:l}}releaseCodeActions(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return typeof e.command=="string"&&typeof e.title=="string"}};Hc._maxCodeActionsPerFile=1e3;let Sc=Hc;class Eh{constructor(e,t,n,r,s){this._proxy=e,this._documents=t,this._provider=n,this._handle=r,this._extension=s,this._cache=new _n("DocumentPasteEdit")}async prepareDocumentPaste(e,t,n,r){if(!this._provider.prepareDocumentPaste)return;const s=this._documents.getDocument(e),o=t.map(c=>H.to(c)),a=Ws.toDataTransfer(n,()=>{throw new x5});if(await this._provider.prepareDocumentPaste(s,o,a,r),r.isCancellationRequested)return;const l=Array.from(a).filter(([,c])=>!(c instanceof Xp));return Ws.from(l)}async providePasteEdits(e,t,n,r,s,o){if(!this._provider.provideDocumentPasteEdits)return[];const a=this._documents.getDocument(t),l=n.map(f=>H.to(f)),c=Ws.toDataTransfer(r,async f=>(await this._proxy.$resolvePasteFileData(this._handle,e,f)).buffer),u=await this._provider.provideDocumentPasteEdits(a,l,c,{only:s.only?new zl(s.only):void 0,triggerKind:s.triggerKind},o);if(!u||o.isCancellationRequested)return[];const d=this._cache.add(u);return u.map((f,p)=>{var b;return{_cacheId:[d,p],title:f.title??h(4817,"Paste using '{0}' extension",this._extension.displayName||this._extension.name),kind:f.kind,yieldTo:(b=f.yieldTo)==null?void 0:b.map(w=>w.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?Mi.from(f.additionalEdit,void 0):void 0}})}async resolvePasteEdit(e,t){const[n,r]=e,s=this._cache.get(n,r);if(!s||!this._provider.resolveDocumentPasteEdit)return{};const o=await this._provider.resolveDocumentPasteEdit(s,t)??s;return{additionalEdit:o.additionalEdit?Mi.from(o.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._cache.delete(e)}}class Ik{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,n){const r=this._documents.getDocument(e),s=await this._provider.provideDocumentFormattingEdits(r,t,n);if(Array.isArray(s))return s.map(ni.from)}}class a0{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,n,r){const s=this._documents.getDocument(e),o=H.to(t),a=await this._provider.provideDocumentRangeFormattingEdits(s,o,n,r);if(Array.isArray(a))return a.map(ni.from)}async provideDocumentRangesFormattingEdits(e,t,n,r){Ix(typeof this._provider.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const s=this._documents.getDocument(e),o=t.map(H.to),a=await this._provider.provideDocumentRangesFormattingEdits(s,o,n,r);if(Array.isArray(a))return a.map(ni.from)}}class Pk{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,n,r,s){const o=this._documents.getDocument(e),a=nt.to(t),l=await this._provider.provideOnTypeFormattingEdits(o,a,n,r,s);if(Array.isArray(l))return l.map(ni.from)}}class Tm{constructor(e,t){this._provider=e,this._logService=t,this._cache=new _n("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const n=await this._provider.provideWorkspaceSymbols(e,t);if(!uu(n))return{symbols:[]};const r=this._cache.add(n),s={cacheId:r,symbols:[]};for(let o=0;o<n.length;o++){const a=n[o];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}s.symbols.push({...Vd.from(a),cacheId:[r,o]})}return s}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const n=this._cache.get(...e.cacheId);if(n){const r=await this._provider.resolveWorkspaceSymbol(n,t);return r&&ko(e,Vd.from(r),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class ma{static supportsResolving(e){return typeof e.prepareRename=="function"}constructor(e,t,n){this._documents=e,this._provider=t,this._logService=n}async provideRenameEdits(e,t,n,r){const s=this._documents.getDocument(e),o=nt.to(t);try{const a=await this._provider.provideRenameEdits(s,o,n,r);return a?Mi.from(a):void 0}catch(a){const l=ma._asMessage(a);return l?{rejectReason:l,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(e,t,n){if(typeof this._provider.prepareRename!="function")return Promise.resolve(void 0);const r=this._documents.getDocument(e),s=nt.to(t);try{const o=await this._provider.prepareRename(r,s,n);let a,l;if(Fe.isRange(o)?(a=o,l=r.getText(o)):Bt(o)&&(a=o.range,l=o.placeholder),!a||!l)return;if(a.start.line>s.line||a.end.line<s.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:H.from(a),text:l}}catch(o){const a=ma._asMessage(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}const Qh=class Qh{constructor(e,t,n){this._documents=e,this._provider=t,this._logService=n}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(e,t,n,r){const s=this._documents.getDocument(e),o=H.to(t);try{const a=Qh.languageTriggerKindToVSCodeTriggerKind[n],l=await this._provider.provideNewSymbolNames(s,o,a,r);return l?l.map(c=>typeof c=="string"?{newSymbolName:c}:{newSymbolName:c.newSymbolName,tags:c.tags}):void 0}catch(a){this._logService.error(Qh._asMessage(a)??JSON.stringify(a,null,"	"));return}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}};Qh.languageTriggerKindToVSCodeTriggerKind={[ep.Invoke]:Dd.Invoke,[ep.Automatic]:Dd.Automatic};let Sh=Qh;class l0{constructor(e,t){this.resultId=e,this.tokens=t}}class rn{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(e,t,n){const r=this._documents.getDocument(e),s=t!==0?this._previousResults.get(t):null;let o=typeof(s==null?void 0:s.resultId)=="string"&&typeof this._provider.provideDocumentSemanticTokensEdits=="function"?await this._provider.provideDocumentSemanticTokensEdits(r,s.resultId,n):await this._provider.provideDocumentSemanticTokens(r,n);return s&&this._previousResults.delete(t),o?(o=rn._fixProvidedSemanticTokens(o),this._send(rn._convertToEdits(s,o),o)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){return rn._isSemanticTokens(e)?rn._isCorrectSemanticTokens(e)?e:new Jl(new Uint32Array(e.data),e.resultId):rn._isSemanticTokensEdits(e)?rn._isCorrectSemanticTokensEdits(e)?e:new sg(e.edits.map(t=>new n4(t.start,t.deleteCount,t.data?new Uint32Array(t.data):t.data)),e.resultId):e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(e,t){if(!rn._isSemanticTokens(t)||!e||!e.tokens)return t;const n=e.tokens,r=n.length,s=t.data,o=s.length;let a=0;const l=Math.min(r,o);for(;a<l&&n[a]===s[a];)a++;if(a===r&&a===o)return new sg([],t.resultId);let c=0;const u=l-a;for(;c<u&&n[r-c-1]===s[o-c-1];)c++;return new sg([{start:a,deleteCount:r-a-c,data:s.subarray(a,o-c)}],t.resultId)}_send(e,t){if(rn._isSemanticTokens(e)){const n=this._nextResultId++;return this._previousResults.set(n,new l0(e.resultId,e.data)),Zb({id:n,type:"full",data:e.data})}if(rn._isSemanticTokensEdits(e)){const n=this._nextResultId++;return rn._isSemanticTokens(t)?this._previousResults.set(n,new l0(t.resultId,t.data)):this._previousResults.set(n,new l0(e.resultId)),Zb({id:n,type:"delta",deltas:(e.edits||[]).map(r=>({start:r.start,deleteCount:r.deleteCount,data:r.data}))})}return null}}class Tk{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,n){const r=this._documents.getDocument(e),s=await this._provider.provideDocumentRangeSemanticTokens(r,H.to(t),n);return s?this._send(s):null}_send(e){return Zb({id:0,type:"full",data:e.data})}}class _a{static supportsResolving(e){return typeof e.resolveCompletionItem=="function"}constructor(e,t,n,r,s){this._documents=e,this._commands=t,this._provider=n,this._apiDeprecation=r,this._extension=s,this._cache=new _n("CompletionItem"),this._disposables=new Map}async provideCompletionItems(e,t,n,r){const s=this._documents.getDocument(e),o=nt.to(t),a=s.getWordRangeAtPosition(o)||new Fe(o,o),l=a.with({end:o}),c=new Rr,u=await this._provider.provideCompletionItems(s,o,r,lw.to(n));if(!u||r.isCancellationRequested)return;const d=Array.isArray(u)?new $l(u):u,f=_a.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]),p=new Le;this._disposables.set(f,p);const b=[],w={x:f,[sl.completions]:b,[sl.defaultRanges]:{replace:H.from(a),insert:H.from(l)},[sl.isIncomplete]:d.isIncomplete||void 0,[sl.duration]:c.elapsed()};for(let v=0;v<d.items.length;v++){const S=d.items[v],k=this._convertCompletionItem(S,[f,v],l,a);b.push(k)}return w}async resolveCompletionItem(e,t){if(typeof this._provider.resolveCompletionItem!="function")return;const n=this._cache.get(...e);if(!n)return;const r=this._convertCompletionItem(n,e),s=await this._provider.resolveCompletionItem(n,t);if(!s)return;const o=this._convertCompletionItem(s,e);return(r[Ne.insertText]!==o[Ne.insertText]||r[Ne.insertTextRules]!==o[Ne.insertTextRules])&&this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(r[Ne.commandIdent]!==o[Ne.commandIdent]||r[Ne.commandId]!==o[Ne.commandId]||!$n(r[Ne.commandArguments],o[Ne.commandArguments]))&&this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...r,[Ne.documentation]:o[Ne.documentation],[Ne.detail]:o[Ne.detail],[Ne.additionalTextEdits]:o[Ne.additionalTextEdits],[Ne.insertText]:o[Ne.insertText],[Ne.insertTextRules]:o[Ne.insertTextRules],[Ne.commandIdent]:o[Ne.commandIdent],[Ne.commandId]:o[Ne.commandId],[Ne.commandArguments]:o[Ne.commandArguments]}}releaseCompletionItems(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,n,r){var c;const s=this._disposables.get(t[0]);if(!s)throw Error("DisposableStore is missing...");const o=this._commands.toInternal(e.command,s),a={x:t,[Ne.label]:e.label,[Ne.kind]:e.kind!==void 0?Lg.from(e.kind):void 0,[Ne.kindModifier]:e.tags&&e.tags.map(Rg.from),[Ne.detail]:e.detail,[Ne.documentation]:typeof e.documentation>"u"?void 0:We.fromStrict(e.documentation),[Ne.sortText]:e.sortText!==e.label?e.sortText:void 0,[Ne.filterText]:e.filterText!==e.label?e.filterText:void 0,[Ne.preselect]:e.preselect||void 0,[Ne.insertTextRules]:e.keepWhitespace?Mo.KeepWhitespace:Mo.None,[Ne.commitCharacters]:(c=e.commitCharacters)==null?void 0:c.join(""),[Ne.additionalTextEdits]:e.additionalTextEdits&&e.additionalTextEdits.map(ni.from),[Ne.commandIdent]:o==null?void 0:o.$ident,[Ne.commandId]:o==null?void 0:o.id,[Ne.commandArguments]:o!=null&&o.$ident||o==null?void 0:o.arguments};e.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a[Ne.insertText]=e.textEdit.newText):typeof e.insertText=="string"?a[Ne.insertText]=e.insertText:e.insertText instanceof Go&&(a[Ne.insertText]=e.insertText.value,a[Ne.insertTextRules]|=Mo.InsertAsSnippet);let l;return e.textEdit?l=e.textEdit.range:e.range&&(l=e.range),Fe.isRange(l)?a[Ne.range]=H.from(l):l&&(!(n!=null&&n.isEqual(l.inserting))||!(r!=null&&r.isEqual(l.replacing)))&&(a[Ne.range]={insert:H.from(l.inserting),replace:H.from(l.replacing)}),a}}class Dc{async provideInlineCompletions(e,t,n,r){}async provideInlineEdits(e,t,n,r){}disposeCompletions(e){}handleDidShowCompletionItem(e,t,n){}handlePartialAccept(e,t,n,r){}}class KR extends Dc{constructor(e,t,n,r){super(),this._extension=e,this._documents=t,this._provider=n,this._commands=r,this._references=new Ak,this._isAdditionsProposedApiEnabled=ii(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[Yf.Automatic]:Sd.Automatic,[Yf.Explicit]:Sd.Invoke}}get supportsHandleEvents(){return ii(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem=="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem=="function")}async provideInlineCompletions(e,t,n,r){const s=this._documents.getDocument(e),o=nt.to(t),a=await this._provider.provideInlineCompletionItems(s,o,{selectedCompletionInfo:n.selectedSuggestionInfo?{range:H.to(n.selectedSuggestionInfo.range),text:n.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[n.triggerKind]},r);if(!a||r.isCancellationRequested)return;const l=Array.isArray(a)?a:a.items,c=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d;return{pid:this._references.createReferenceId({dispose(){d==null||d.dispose()},items:l}),items:l.map((p,b)=>{let w;p.command&&(d||(d=new Le),w=this._commands.toInternal(p.command,d));const v=p.insertText;return{insertText:typeof v=="string"?v:{snippet:v.value},filterText:p.filterText,range:p.range?H.from(p.range):void 0,command:w,idx:b,completeBracketPairs:this._isAdditionsProposedApiEnabled?p.completeBracketPairs:!1}}),commands:c.map(p=>(d||(d=new Le),this._commands.toInternal(p,d))),suppressSuggestions:!1,enableForwardStability:u}}async provideInlineEdits(e,t,n,r){if(!this._provider.provideInlineEdits)return;M(this._extension,"inlineCompletionsAdditions");const s=this._documents.getDocument(e),o=H.to(t),a=await this._provider.provideInlineEdits(s,o,{selectedCompletionInfo:n.selectedSuggestionInfo?{range:H.to(n.selectedSuggestionInfo.range),text:n.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[n.triggerKind],userPrompt:n.userPrompt},r);if(!a||r.isCancellationRequested)return;const l=Array.isArray(a)?a:a.items,c=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d;return{pid:this._references.createReferenceId({dispose(){d==null||d.dispose()},items:l}),items:l.map((p,b)=>{let w;p.command&&(d||(d=new Le),w=this._commands.toInternal(p.command,d));const v=p.insertText;return{insertText:typeof v=="string"?v:{snippet:v.value},filterText:p.filterText,range:p.range?H.from(p.range):void 0,command:w,idx:b,completeBracketPairs:this._isAdditionsProposedApiEnabled?p.completeBracketPairs:!1}}),commands:c.map(p=>(d||(d=new Le),this._commands.toInternal(p,d))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}handleDidShowCompletionItem(e,t,n){var s;const r=(s=this._references.get(e))==null?void 0:s.items[t];r&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(r,n)}handlePartialAccept(e,t,n,r){var o;const s=(o=this._references.get(e))==null?void 0:o.items[t];s&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&(this._provider.handleDidPartiallyAcceptCompletionItem(s,n),this._provider.handleDidPartiallyAcceptCompletionItem(s,kw.to(r)))}}class c0{async provideInlineEdits(e,t,n){const r=this._documents.getDocument(e),s=await this._provider.provideInlineEdit(r,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind]},n);if(!s||n.isCancellationRequested)return;let o;const a=this._references.createReferenceId({dispose(){o==null||o.dispose()},item:s});let l;s.accepted&&(o||(o=new Le),l=this._commands.toInternal(s.accepted,o));let c;return s.rejected&&(o||(o=new Le),c=this._commands.toInternal(s.rejected,o)),{pid:a,text:s.text,range:H.from(s.range),accepted:l,rejected:c}}disposeEdit(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}constructor(e,t,n,r){this._documents=t,this._provider=n,this._commands=r,this._references=new Ak,this.languageTriggerKindToVSCodeTriggerKind={[tp.Automatic]:Wd.Automatic,[tp.Invoke]:Wd.Invoke}}}class Ak{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}}class u0{constructor(e,t){this._documents=e,this._provider=t,this._cache=new _n("SignatureHelp")}async provideSignatureHelp(e,t,n,r){const s=this._documents.getDocument(e),o=nt.to(t),a=this.reviveContext(n),l=await this._provider.provideSignatureHelp(s,o,r,a);if(l){const c=this._cache.add([l]);return{...jd.from(l),id:c}}}reviveContext(e){let t;if(e.activeSignatureHelp){const n=jd.to(e.activeSignatureHelp),r=this._cache.get(e.activeSignatureHelp.id,0);r?(t=r,t.activeSignature=n.activeSignature,t.activeParameter=n.activeParameter):t=n}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}}class Am{constructor(e,t,n,r,s){this._documents=e,this._commands=t,this._provider=n,this._logService=r,this._extension=s,this._cache=new _n("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,n){const r=this._documents.getDocument(e),s=H.to(t),o=await this._provider.provideInlayHints(r,s,n);if(!Array.isArray(o)||o.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(n.isCancellationRequested)return;const a=this._cache.add(o);this._disposables.set(a,new Le);const l={hints:[],cacheId:a};for(let c=0;c<o.length;c++)this._isValidInlayHint(o[c],s)&&l.hints.push(this._convertInlayHint(o[c],[a,c]));return this._logService.trace(`[InlayHints] ${l.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),l}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!="function")return;const n=this._cache.get(...e);if(!n)return;const r=await this._provider.resolveInlayHint(n,t);if(r&&this._isValidInlayHint(r))return this._convertInlayHint(r,e)}releaseHints(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(n=>n.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const n=this._disposables.get(t[0]);if(!n)throw Error("DisposableStore is missing...");const r={label:"",cacheId:t,tooltip:We.fromStrict(e.tooltip),position:nt.from(e.position),textEdits:e.textEdits&&e.textEdits.map(ni.from),kind:e.kind&&Fg.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")r.label=e.label;else{const s=[];r.label=s;for(const o of e.label){if(!o.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:o.value,tooltip:We.fromStrict(o.tooltip)};gn.isLocation(o.location)&&(a.location=zi.from(o.location)),o.command&&(a.command=this._commands.toInternal(o.command,n)),s.push(a)}}return r}}class Ks{constructor(e,t){this._documents=e,this._provider=t,this._cache=new _n("DocumentLink")}async provideLinks(e,t){const n=this._documents.getDocument(e),r=await this._provider.provideDocumentLinks(n,t);if(!(!Array.isArray(r)||r.length===0)&&!t.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!="function")return{links:r.filter(Ks._validateLink).map(aa.from)};{const s=this._cache.add(r),o={links:[],cacheId:s};for(let a=0;a<r.length;a++){if(!Ks._validateLink(r[a]))continue;const l=aa.from(r[a]);l.cacheId=[s,a],o.links.push(l)}return o}}}static _validateLink(e){return e.target&&e.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(e,t){if(typeof this._provider.resolveDocumentLink!="function")return;const n=this._cache.get(...e);if(!n)return;const r=await this._provider.resolveDocumentLink(n,t);if(!(!r||!Ks._validateLink(r)))return aa.from(r)}releaseLinks(e){this._cache.delete(e)}}class d0{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const n=this._documents.getDocument(e),r=await this._provider.provideDocumentColors(n,t);return Array.isArray(r)?r.map(o=>({color:rc.from(o.color),range:H.from(o.range)})):[]}async provideColorPresentations(e,t,n){const r=this._documents.getDocument(e),s=H.to(t.range),o=rc.to(t.color),a=await this._provider.provideColorPresentations(o,{document:r,range:s},n);if(Array.isArray(a))return a.map(Mg.from)}}class Rk{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,n){const r=this._documents.getDocument(e),s=await this._provider.provideFoldingRanges(r,t,n);if(Array.isArray(s))return s.map(Ug.from)}}class Lk{constructor(e,t,n){this._documents=e,this._provider=t,this._logService=n}async provideSelectionRanges(e,t,n){const r=this._documents.getDocument(e),s=t.map(nt.to),o=await this._provider.provideSelectionRanges(r,s,n);if(!uu(o))return[];if(o.length!==s.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const a=[];for(let l=0;l<s.length;l++){const c=[];a.push(c);let u=s[l],d=o[l];for(;;){if(!d.range.contains(u))throw new Error("INVALID selection range, must contain the previous range");if(c.push(hw.from(d)),!d.parent)break;u=d.range,d=d.parent}}return a}}class Dh{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new xb(""),this._cache=new Map}async prepareSession(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.prepareCallHierarchy(r,s,n);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(l=>this._cacheAndConvertItem(a,l)):[this._cacheAndConvertItem(a,o)]}async provideCallsTo(e,t,n){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyIncomingCalls(r,n);if(s)return s.map(o=>({from:this._cacheAndConvertItem(e,o.from),fromRanges:o.fromRanges.map(a=>H.from(a))}))}async provideCallsFrom(e,t,n){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyOutgoingCalls(r,n);if(s)return s.map(o=>({to:this._cacheAndConvertItem(e,o.to),fromRanges:o.fromRanges.map(a=>H.from(a))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const n=this._cache.get(e),r=oa.from(t,e,n.size.toString(36));return n.set(r._itemId,t),r}_itemFromCache(e,t){const n=this._cache.get(e);return n==null?void 0:n.get(t)}}class kh{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new xb(""),this._cache=new Map}async prepareSession(e,t,n){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.prepareTypeHierarchy(r,s,n);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(l=>this._cacheAndConvertItem(a,l)):[this._cacheAndConvertItem(a,o)]}async provideSupertypes(e,t,n){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySupertypes(r,n);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}async provideSubtypes(e,t,n){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySubtypes(r,n);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const n=this._cache.get(e),r=la.from(t,e,n.size.toString(36));return n.set(r._itemId,t),r}_itemFromCache(e,t){const n=this._cache.get(e);return n==null?void 0:n.get(t)}}class Rm{constructor(e,t,n,r,s){this._proxy=e,this._documents=t,this._provider=n,this._handle=r,this._extension=s,this._cache=new _n("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,n,r,s){const o=this._documents.getDocument(t),a=nt.to(n),l=Ws.toDataTransfer(r,async f=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,f)).buffer),c=await this._provider.provideDocumentDropEdits(o,a,l,s);if(!c)return;const u=fo(c),d=this._cache.add(u);return u.map((f,p)=>{var b,w;return{_cacheId:[d,p],title:f.title??h(4818,"Drop using '{0}' extension",this._extension.displayName||this._extension.name),kind:(b=f.kind)==null?void 0:b.value,yieldTo:(w=f.yieldTo)==null?void 0:w.map(v=>v.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?Mi.from(f.additionalEdit,void 0):void 0}})}async resolveDropEdit(e,t){const[n,r]=e,s=this._cache.get(n,r);if(!s||!this._provider.resolveDocumentDropEdit)return{};const o=await this._provider.resolveDocumentDropEdit(s,t)??s;return{additionalEdit:o.additionalEdit?Mi.from(o.additionalEdit,void 0):void 0}}releaseDropEdits(e){this._cache.delete(e)}}class Nk{constructor(e,t){this._documents=e,this._provider=t}async provideMappedEdits(e,t,n,r){var u,d;const s=y.revive(e),o=this._documents.getDocument(s),a=n.documents.map(f=>f.map(p=>({uri:y.revive(p.uri),version:p.version,ranges:p.ranges.map(b=>H.to(b))}))),l={documents:a,selections:((d=(u=a[0])==null?void 0:u[0])==null?void 0:d.ranges)??[]},c=await this._provider.provideMappedEdits(o,t,l,r);return c?Mi.from(c):null}}class Ch{constructor(e,t){this.adapter=e,this.extension=t}}const Gt=class Gt{constructor(e,t,n,r,s,o,a,l){this._uriTransformer=t,this._documents=n,this._commands=r,this._diagnostics=s,this._logService=o,this._apiDeprecation=a,this._extensionTelemetry=l,this._adapter=new Map,this._proxy=e.getProxy(Z.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return ec.from(e,this._uriTransformer,t)}_createDisposable(e){return new Qe(()=>{this._adapter.delete(e),this._proxy.$unregister(e)})}_nextHandle(){return Gt._handlePool++}async _withAdapter(e,t,n,r,s,o=!1){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof t))return r;const l=Date.now();o||this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${n.toString().replace(/[\r\n]/g,"")}'`);const c=n(a.adapter,a.extension);return Promise.resolve(c).catch(u=>{uo(u)||(this._logService.error(`[${a.extension.identifier.value}] provider FAILED`),this._logService.error(u),this._extensionTelemetry.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-l}ms`)}),Nt.isCancellationToken(s)?bI(c,s):c}_addNewAdapter(e,t){const n=this._nextHandle();return this._adapter.set(n,new Ch(e,t)),n}static _extLabel(e){return e.displayName||e.name}static _extId(e){return e.identifier.value}registerDocumentSymbolProvider(e,t,n,r){const s=this._addNewAdapter(new Cm(this._documents,n),e),o=r&&r.label||Gt._extLabel(e);return this._proxy.$registerDocumentSymbolProvider(s,this._transformDocumentSelector(t,e),o),this._createDisposable(s)}$provideDocumentSymbols(e,t,n){return this._withAdapter(e,Cm,r=>r.provideDocumentSymbols(y.revive(t),n),void 0,n)}registerCodeLensProvider(e,t,n){const r=this._nextHandle(),s=typeof n.onDidChangeCodeLenses=="function"?this._nextHandle():void 0;this._adapter.set(r,new Ch(new Im(this._documents,this._commands.converter,n,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(r,this._transformDocumentSelector(t,e),s);let o=this._createDisposable(r);if(s!==void 0){const a=n.onDidChangeCodeLenses(l=>this._proxy.$emitCodeLensEvent(s));o=Qe.from(o,a)}return o}$provideCodeLenses(e,t,n){return this._withAdapter(e,Im,r=>r.provideCodeLenses(y.revive(t),n),void 0,n)}$resolveCodeLens(e,t,n){return this._withAdapter(e,Im,r=>r.resolveCodeLens(t,n),void 0,void 0)}$releaseCodeLenses(e,t){this._withAdapter(e,Im,n=>Promise.resolve(n.releaseCodeLenses(t)),void 0,void 0)}registerDefinitionProvider(e,t,n){const r=this._addNewAdapter(new vk(this._documents,n),e);return this._proxy.$registerDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDefinition(e,t,n,r){return this._withAdapter(e,vk,s=>s.provideDefinition(y.revive(t),n,r),[],r)}registerDeclarationProvider(e,t,n){const r=this._addNewAdapter(new wk(this._documents,n),e);return this._proxy.$registerDeclarationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDeclaration(e,t,n,r){return this._withAdapter(e,wk,s=>s.provideDeclaration(y.revive(t),n,r),[],r)}registerImplementationProvider(e,t,n){const r=this._addNewAdapter(new bk(this._documents,n),e);return this._proxy.$registerImplementationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideImplementation(e,t,n,r){return this._withAdapter(e,bk,s=>s.provideImplementation(y.revive(t),n,r),[],r)}registerTypeDefinitionProvider(e,t,n){const r=this._addNewAdapter(new yk(this._documents,n),e);return this._proxy.$registerTypeDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideTypeDefinition(e,t,n,r){return this._withAdapter(e,yk,s=>s.provideTypeDefinition(y.revive(t),n,r),[],r)}registerHoverProvider(e,t,n,r){const s=this._addNewAdapter(new xh(this._documents,n),e);return this._proxy.$registerHoverProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideHover(e,t,n,r,s){return this._withAdapter(e,xh,o=>o.provideHover(y.revive(t),n,r,s),void 0,s)}$releaseHover(e,t){this._withAdapter(e,xh,n=>Promise.resolve(n.releaseHover(t)),void 0,void 0)}registerEvaluatableExpressionProvider(e,t,n,r){const s=this._addNewAdapter(new xk(this._documents,n),e);return this._proxy.$registerEvaluatableExpressionProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideEvaluatableExpression(e,t,n,r){return this._withAdapter(e,xk,s=>s.provideEvaluatableExpression(y.revive(t),n,r),void 0,r)}registerInlineValuesProvider(e,t,n,r){const s=typeof n.onDidChangeInlineValues=="function"?this._nextHandle():void 0,o=this._addNewAdapter(new Ek(this._documents,n),e);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(t,e),s);let a=this._createDisposable(o);if(s!==void 0){const l=n.onDidChangeInlineValues(c=>this._proxy.$emitInlineValuesEvent(s));a=Qe.from(a,l)}return a}$provideInlineValues(e,t,n,r,s){return this._withAdapter(e,Ek,o=>o.provideInlineValues(y.revive(t),n,r,s),void 0,s)}registerDocumentHighlightProvider(e,t,n){const r=this._addNewAdapter(new Sk(this._documents,n),e);return this._proxy.$registerDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}registerMultiDocumentHighlightProvider(e,t,n){const r=this._addNewAdapter(new Dk(this._documents,n),e);return this._proxy.$registerMultiDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentHighlights(e,t,n,r){return this._withAdapter(e,Sk,s=>s.provideDocumentHighlights(y.revive(t),n,r),void 0,r)}$provideMultiDocumentHighlights(e,t,n,r,s){return this._withAdapter(e,Dk,o=>o.provideMultiDocumentHighlights(y.revive(t),n,r.map(a=>y.revive(a)),s),void 0,s)}registerLinkedEditingRangeProvider(e,t,n){const r=this._addNewAdapter(new kk(this._documents,n),e);return this._proxy.$registerLinkedEditingRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideLinkedEditingRanges(e,t,n,r){return this._withAdapter(e,kk,async s=>{const o=await s.provideLinkedEditingRanges(y.revive(t),n,r);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?Gt._serializeRegExp(o.wordPattern):void 0}},void 0,r)}registerReferenceProvider(e,t,n){const r=this._addNewAdapter(new Ck(this._documents,n),e);return this._proxy.$registerReferenceSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideReferences(e,t,n,r,s){return this._withAdapter(e,Ck,o=>o.provideReferences(y.revive(t),n,r,s),void 0,s)}registerCodeActionProvider(e,t,n,r){var a,l;const s=new Le,o=this._addNewAdapter(new Sc(this._documents,this._commands.converter,this._diagnostics,n,this._logService,e,this._apiDeprecation),e);return this._proxy.$registerCodeActionSupport(o,this._transformDocumentSelector(t,e),{providedKinds:(a=r==null?void 0:r.providedCodeActionKinds)==null?void 0:a.map(c=>c.value),documentation:(l=r==null?void 0:r.documentation)==null?void 0:l.map(c=>({kind:c.kind.value,command:this._commands.converter.toInternal(c.command,s)}))},Gt._extLabel(e),Gt._extId(e),!!n.resolveCodeAction),s.add(this._createDisposable(o)),s}$provideCodeActions(e,t,n,r,s){return this._withAdapter(e,Sc,o=>o.provideCodeActions(y.revive(t),n,r,s),void 0,s)}$resolveCodeAction(e,t,n){return this._withAdapter(e,Sc,r=>r.resolveCodeAction(t,n),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,Sc,n=>Promise.resolve(n.releaseCodeActions(t)),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,n){const r=this._addNewAdapter(new Ik(this._documents,n),e);return this._proxy.$registerDocumentFormattingSupport(r,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(r)}$provideDocumentFormattingEdits(e,t,n,r){return this._withAdapter(e,Ik,s=>s.provideDocumentFormattingEdits(y.revive(t),n,r),void 0,r)}registerDocumentRangeFormattingEditProvider(e,t,n){const r=typeof n.provideDocumentRangesFormattingEdits=="function",s=this._addNewAdapter(new a0(this._documents,n),e);return this._proxy.$registerRangeFormattingSupport(s,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,r),this._createDisposable(s)}$provideDocumentRangeFormattingEdits(e,t,n,r,s){return this._withAdapter(e,a0,o=>o.provideDocumentRangeFormattingEdits(y.revive(t),n,r,s),void 0,s)}$provideDocumentRangesFormattingEdits(e,t,n,r,s){return this._withAdapter(e,a0,o=>o.provideDocumentRangesFormattingEdits(y.revive(t),n,r,s),void 0,s)}registerOnTypeFormattingEditProvider(e,t,n,r){const s=this._addNewAdapter(new Pk(this._documents,n),e);return this._proxy.$registerOnTypeFormattingSupport(s,this._transformDocumentSelector(t,e),r,e.identifier),this._createDisposable(s)}$provideOnTypeFormattingEdits(e,t,n,r,s,o){return this._withAdapter(e,Pk,a=>a.provideOnTypeFormattingEdits(y.revive(t),n,r,s,o),void 0,o)}registerWorkspaceSymbolProvider(e,t){const n=this._addNewAdapter(new Tm(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(n,typeof t.resolveWorkspaceSymbol=="function"),this._createDisposable(n)}$provideWorkspaceSymbols(e,t,n){return this._withAdapter(e,Tm,r=>r.provideWorkspaceSymbols(t,n),{symbols:[]},n)}$resolveWorkspaceSymbol(e,t,n){return this._withAdapter(e,Tm,r=>r.resolveWorkspaceSymbol(t,n),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,Tm,n=>n.releaseWorkspaceSymbols(t),void 0,void 0)}registerRenameProvider(e,t,n){const r=this._addNewAdapter(new ma(this._documents,n,this._logService),e);return this._proxy.$registerRenameSupport(r,this._transformDocumentSelector(t,e),ma.supportsResolving(n)),this._createDisposable(r)}$provideRenameEdits(e,t,n,r,s){return this._withAdapter(e,ma,o=>o.provideRenameEdits(y.revive(t),n,r,s),void 0,s)}$resolveRenameLocation(e,t,n,r){return this._withAdapter(e,ma,s=>s.resolveRenameLocation(y.revive(t),n,r),void 0,r)}registerNewSymbolNamesProvider(e,t,n){const r=this._addNewAdapter(new Sh(this._documents,n,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,Sh,t=>t.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(e,t,n,r,s){return this._withAdapter(e,Sh,o=>o.provideNewSymbolNames(y.revive(t),n,r,s),void 0,s)}registerDocumentSemanticTokensProvider(e,t,n,r){const s=this._addNewAdapter(new rn(this._documents,n),e),o=typeof n.onDidChangeSemanticTokens=="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(s,this._transformDocumentSelector(t,e),r,o);let a=this._createDisposable(s);if(o){const l=n.onDidChangeSemanticTokens(c=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=Qe.from(a,l)}return a}$provideDocumentSemanticTokens(e,t,n,r){return this._withAdapter(e,rn,s=>s.provideDocumentSemanticTokens(y.revive(t),n,r),null,r)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,rn,n=>n.releaseDocumentSemanticColoring(t),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,n,r){const s=this._addNewAdapter(new Tk(this._documents,n),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(s,this._transformDocumentSelector(t,e),r),this._createDisposable(s)}$provideDocumentRangeSemanticTokens(e,t,n,r){return this._withAdapter(e,Tk,s=>s.provideDocumentRangeSemanticTokens(y.revive(t),n,r),null,r)}registerCompletionItemProvider(e,t,n,r){const s=this._addNewAdapter(new _a(this._documents,this._commands.converter,n,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(s,this._transformDocumentSelector(t,e),r,_a.supportsResolving(n),e.identifier),this._createDisposable(s)}$provideCompletionItems(e,t,n,r,s){return this._withAdapter(e,_a,o=>o.provideCompletionItems(y.revive(t),n,r,s),void 0,s)}$resolveCompletionItem(e,t,n){return this._withAdapter(e,_a,r=>r.resolveCompletionItem(t,n),void 0,n)}$releaseCompletionItems(e,t){this._withAdapter(e,_a,n=>n.releaseCompletionItems(t),void 0,void 0)}registerInlineCompletionsProvider(e,t,n,r){var a;const s=new KR(e,this._documents,n,this._commands.converter),o=this._addNewAdapter(s,e);return this._proxy.$registerInlineCompletionsSupport(o,this._transformDocumentSelector(t,e),s.supportsHandleEvents,ot.toKey(e.identifier.value),((a=r==null?void 0:r.yieldTo)==null?void 0:a.map(l=>ot.toKey(l)))||[]),this._createDisposable(o)}$provideInlineCompletions(e,t,n,r,s){return this._withAdapter(e,Dc,o=>o.provideInlineCompletions(y.revive(t),n,r,s),void 0,s)}$provideInlineEdits(e,t,n,r,s){return this._withAdapter(e,Dc,o=>o.provideInlineEdits(y.revive(t),n,r,s),void 0,s)}$handleInlineCompletionDidShow(e,t,n,r){this._withAdapter(e,Dc,async s=>{s.handleDidShowCompletionItem(t,n,r)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,n,r,s){this._withAdapter(e,Dc,async o=>{o.handlePartialAccept(t,n,r,s)},void 0,void 0)}$freeInlineCompletionsList(e,t){this._withAdapter(e,Dc,async n=>{n.disposeCompletions(t)},void 0,void 0)}registerInlineEditProvider(e,t,n){const r=new c0(e,this._documents,n,this._commands.converter),s=this._addNewAdapter(r,e);return this._proxy.$registerInlineEditProvider(s,this._transformDocumentSelector(t,e),e.identifier),this._createDisposable(s)}$provideInlineEdit(e,t,n,r){return this._withAdapter(e,c0,s=>s.provideInlineEdits(y.revive(t),n,r),void 0,r)}$freeInlineEdit(e,t){this._withAdapter(e,c0,async n=>{n.disposeEdit(t)},void 0,void 0)}registerSignatureHelpProvider(e,t,n,r){const s=Array.isArray(r)?{triggerCharacters:r,retriggerCharacters:[]}:r,o=this._addNewAdapter(new u0(this._documents,n),e);return this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(t,e),s),this._createDisposable(o)}$provideSignatureHelp(e,t,n,r,s){return this._withAdapter(e,u0,o=>o.provideSignatureHelp(y.revive(t),n,r,s),void 0,s)}$releaseSignatureHelp(e,t){this._withAdapter(e,u0,n=>n.releaseSignatureHelp(t),void 0,void 0)}registerInlayHintsProvider(e,t,n){const r=typeof n.onDidChangeInlayHints=="function"?this._nextHandle():void 0,s=this._addNewAdapter(new Am(this._documents,this._commands.converter,n,this._logService,e),e);this._proxy.$registerInlayHintsProvider(s,this._transformDocumentSelector(t,e),typeof n.resolveInlayHint=="function",r,Gt._extLabel(e));let o=this._createDisposable(s);if(r!==void 0){const a=n.onDidChangeInlayHints(l=>this._proxy.$emitInlayHintsEvent(r));o=Qe.from(o,a)}return o}$provideInlayHints(e,t,n,r){return this._withAdapter(e,Am,s=>s.provideInlayHints(y.revive(t),n,r),void 0,r)}$resolveInlayHint(e,t,n){return this._withAdapter(e,Am,r=>r.resolveInlayHint(t,n),void 0,n)}$releaseInlayHints(e,t){this._withAdapter(e,Am,n=>n.releaseHints(t),void 0,void 0)}registerDocumentLinkProvider(e,t,n){const r=this._addNewAdapter(new Ks(this._documents,n),e);return this._proxy.$registerDocumentLinkProvider(r,this._transformDocumentSelector(t,e),typeof n.resolveDocumentLink=="function"),this._createDisposable(r)}$provideDocumentLinks(e,t,n){return this._withAdapter(e,Ks,r=>r.provideLinks(y.revive(t),n),void 0,n,t.scheme==="output")}$resolveDocumentLink(e,t,n){return this._withAdapter(e,Ks,r=>r.resolveLink(t,n),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,Ks,n=>n.releaseLinks(t),void 0,void 0,!0)}registerColorProvider(e,t,n){const r=this._addNewAdapter(new d0(this._documents,n),e);return this._proxy.$registerDocumentColorProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentColors(e,t,n){return this._withAdapter(e,d0,r=>r.provideColors(y.revive(t),n),[],n)}$provideColorPresentations(e,t,n,r){return this._withAdapter(e,d0,s=>s.provideColorPresentations(y.revive(t),n,r),void 0,r)}registerFoldingRangeProvider(e,t,n){const r=this._nextHandle(),s=typeof n.onDidChangeFoldingRanges=="function"?this._nextHandle():void 0;this._adapter.set(r,new Ch(new Rk(this._documents,n),e)),this._proxy.$registerFoldingRangeProvider(r,this._transformDocumentSelector(t,e),e.identifier,s);let o=this._createDisposable(r);if(s!==void 0){const a=n.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(s));o=Qe.from(o,a)}return o}$provideFoldingRanges(e,t,n,r){return this._withAdapter(e,Rk,s=>s.provideFoldingRanges(y.revive(t),n,r),void 0,r)}registerSelectionRangeProvider(e,t,n){const r=this._addNewAdapter(new Lk(this._documents,n,this._logService),e);return this._proxy.$registerSelectionRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideSelectionRanges(e,t,n,r){return this._withAdapter(e,Lk,s=>s.provideSelectionRanges(y.revive(t),n,r),[],r)}registerCallHierarchyProvider(e,t,n){const r=this._addNewAdapter(new Dh(this._documents,n),e);return this._proxy.$registerCallHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareCallHierarchy(e,t,n,r){return this._withAdapter(e,Dh,s=>Promise.resolve(s.prepareSession(y.revive(t),n,r)),void 0,r)}$provideCallHierarchyIncomingCalls(e,t,n,r){return this._withAdapter(e,Dh,s=>s.provideCallsTo(t,n,r),void 0,r)}$provideCallHierarchyOutgoingCalls(e,t,n,r){return this._withAdapter(e,Dh,s=>s.provideCallsFrom(t,n,r),void 0,r)}$releaseCallHierarchy(e,t){this._withAdapter(e,Dh,n=>Promise.resolve(n.releaseSession(t)),void 0,void 0)}registerTypeHierarchyProvider(e,t,n){const r=this._addNewAdapter(new kh(this._documents,n),e);return this._proxy.$registerTypeHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareTypeHierarchy(e,t,n,r){return this._withAdapter(e,kh,s=>Promise.resolve(s.prepareSession(y.revive(t),n,r)),void 0,r)}$provideTypeHierarchySupertypes(e,t,n,r){return this._withAdapter(e,kh,s=>s.provideSupertypes(t,n,r),void 0,r)}$provideTypeHierarchySubtypes(e,t,n,r){return this._withAdapter(e,kh,s=>s.provideSubtypes(t,n,r),void 0,r)}$releaseTypeHierarchy(e,t){this._withAdapter(e,kh,n=>Promise.resolve(n.releaseSession(t)),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,n,r){const s=this._nextHandle();return this._adapter.set(s,new Ch(new Rm(this._proxy,this._documents,n,s,e),e)),this._proxy.$registerDocumentOnDropEditProvider(s,this._transformDocumentSelector(t,e),ii(e,"documentPaste")&&r?{supportsResolve:!!n.resolveDocumentDropEdit,dropMimeTypes:r.dropMimeTypes}:void 0),this._createDisposable(s)}$provideDocumentOnDropEdits(e,t,n,r,s,o){return this._withAdapter(e,Rm,a=>Promise.resolve(a.provideDocumentOnDropEdits(t,y.revive(n),r,s,o)),void 0,void 0)}$resolveDropEdit(e,t,n){return this._withAdapter(e,Rm,r=>r.resolveDropEdit(t,n),{},void 0)}$releaseDocumentOnDropEdits(e,t){this._withAdapter(e,Rm,n=>Promise.resolve(n.releaseDropEdits(t)),void 0,void 0)}registerMappedEditsProvider(e,t,n){const r=this._addNewAdapter(new Nk(this._documents,n),e);return this._proxy.$registerMappedEditsProvider(r,this._transformDocumentSelector(t,e),e.displayName??e.name),this._createDisposable(r)}$provideMappedEdits(e,t,n,r,s){return this._withAdapter(e,Nk,o=>Promise.resolve(o.provideMappedEdits(t,n,r,s)),null,s)}registerDocumentPasteEditProvider(e,t,n,r){var o;const s=this._nextHandle();return this._adapter.set(s,new Ch(new Eh(this._proxy,this._documents,n,s,e),e)),this._proxy.$registerPasteEditProvider(s,this._transformDocumentSelector(t,e),{supportsCopy:!!n.prepareDocumentPaste,supportsPaste:!!n.provideDocumentPasteEdits,supportsResolve:!!n.resolveDocumentPasteEdit,providedPasteEditKinds:(o=r.providedPasteEditKinds)==null?void 0:o.map(a=>a.value),copyMimeTypes:r.copyMimeTypes,pasteMimeTypes:r.pasteMimeTypes}),this._createDisposable(s)}$prepareDocumentPaste(e,t,n,r,s){return this._withAdapter(e,Eh,o=>o.prepareDocumentPaste(y.revive(t),n,r,s),void 0,s)}$providePasteEdits(e,t,n,r,s,o,a){return this._withAdapter(e,Eh,l=>l.providePasteEdits(t,y.revive(n),r,s,o,a),void 0,a)}$resolvePasteEdit(e,t,n){return this._withAdapter(e,Eh,r=>r.resolvePasteEdit(t,n),{},void 0)}$releasePasteEdits(e,t){this._withAdapter(e,Eh,n=>Promise.resolve(n.releasePasteEdits(t)),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:Gt._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:Gt._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?Gt._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?Gt._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:Gt._serializeRegExp(e.beforeText),afterText:e.afterText?Gt._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?Gt._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(Gt._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(t=>Bl.toString(t)):void 0}}static _serializeAutoClosingPairs(e){return e.map(Gt._serializeAutoClosingPair)}setLanguageConfiguration(e,t,n){const{wordPattern:r}=n;if(r&&fx(r))throw new Error(`Invalid language configuration: wordPattern '${r}' is not allowed to match the empty string.`);r?this._documents.setWordDefinitionFor(t,r):this._documents.setWordDefinitionFor(t,void 0),n.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,"Do not use."),n.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,"Do not use.");const s=this._nextHandle(),o={comments:n.comments,brackets:n.brackets,wordPattern:n.wordPattern?Gt._serializeRegExp(n.wordPattern):void 0,indentationRules:n.indentationRules?Gt._serializeIndentationRule(n.indentationRules):void 0,onEnterRules:n.onEnterRules?Gt._serializeOnEnterRules(n.onEnterRules):void 0,__electricCharacterSupport:n.__electricCharacterSupport,__characterPairSupport:n.__characterPairSupport,autoClosingPairs:n.autoClosingPairs?Gt._serializeAutoClosingPairs(n.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(s,t,o),this._createDisposable(s)}$setWordDefinitions(e){for(const t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}};Gt._handlePool=0;let h0=Gt;class ZR{constructor(e){this._registeredTools=new Map,this._allTools=new Map,this._proxy=e.getProxy(Z.MainThreadLanguageModelTools),this._proxy.$getTools().then(t=>{for(const n of t)this._allTools.set(n.name,Ki(n))})}async invokeTool(e,t,n){return await this._proxy.$invokeTool(e,t,n)}async $acceptToolDelta(e){e.added&&this._allTools.set(e.added.name,e.added),e.removed&&this._allTools.delete(e.removed)}get tools(){return Array.from(this._allTools.values()).map(e=>Pw.to(e))}async $invokeTool(e,t,n){const r=this._registeredTools.get(e);if(!r)throw new Error(`Unknown tool ${e}`);return await r.tool.invoke(t,n)}registerTool(e,t,n){return this._registeredTools.set(t,{extension:e,tool:n}),this._proxy.$registerTool(t),Me(()=>{this._registeredTools.delete(t),this._proxy.$unregisterTool(t)})}}class e3{constructor(e,t,n,r){this._documents=t,this._commands=n,this._uriTransformer=r,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(Z.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const n=this._documents.getDocumentData(e);if(!n)throw new Error(`document '${e.toString()}' NOT found`);return n.document}async tokenAtPosition(e,t){const n=e.version,r=nt.from(t),s=await this._proxy.$tokensAtPosition(e.uri,r),o={type:Ms.Other,range:e.getWordRangeAtPosition(t)??new Fe(t.line,t.character,t.line,t.character)};if(!s)return o;const a={range:H.to(s.range),type:Zv.to(s.type)};return!a.range.contains(t)||n!==e.version?o:a}createLanguageStatusItem(e,t,n){const r=this._handlePool++,s=this._proxy,o=this._ids,a=`${e.identifier.value}/${t}`;if(o.has(a))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);o.add(a);const l={selector:n,id:t,name:e.displayName??e.name,severity:Fl.Information,command:void 0,text:"",detail:"",busy:!1};let c;const u=new Le,d=()=>{if(c==null||c.dispose(),!o.has(a)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=CI(()=>{u.clear(),this._proxy.$setLanguageStatus(r,{id:a,name:l.name??e.displayName??e.name,source:e.displayName??e.name,selector:ec.from(l.selector,this._uriTransformer),label:l.text,detail:l.detail??"",severity:l.severity===Fl.Error?Vt.Error:l.severity===Fl.Warning?Vt.Warning:Vt.Info,command:l.command&&this._commands.toInternal(l.command,u),accessibilityInfo:l.accessibilityInformation,busy:l.busy})},0)},f={dispose(){u.dispose(),c==null||c.dispose(),s.$removeLanguageStatus(r),o.delete(a)},get id(){return l.id},get name(){return l.name},set name(p){l.name=p,d()},get selector(){return l.selector},set selector(p){l.selector=p,d()},get text(){return l.text},set text(p){l.text=p,d()},set text2(p){M(e,"languageStatusText"),l.text=p,d()},get text2(){return M(e,"languageStatusText"),l.text},get detail(){return l.detail},set detail(p){l.detail=p,d()},get severity(){return l.severity},set severity(p){l.severity=p,d()},get accessibilityInformation(){return l.accessibilityInformation},set accessibilityInformation(p){l.accessibilityInformation=p,d()},get command(){return l.command},set command(p){l.command=p,d()},get busy(){return l.busy},set busy(p){l.busy=p,d()}};return d(),f}}function t3(i){return i&&i.title}let f0=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(Z.MainThreadMessageService)}showMessage(e,t,n,r,s){const o={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;typeof r=="string"||t3(r)?a=[r,...s]:(o.modal=r==null?void 0:r.modal,o.useCustom=r==null?void 0:r.useCustom,o.detail=r==null?void 0:r.detail,a=s),o.useCustom&&M(e,"resolvers");const l=[];let c=!1;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d=="string")l.push({title:d,handle:u,isCloseAffordance:!1});else if(typeof d=="object"){const{title:f,isCloseAffordance:p}=d;l.push({title:f,isCloseAffordance:!!p,handle:u}),p&&(c?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d):c=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}return this._proxy.$showMessage(t,n,o,l).then(u=>{if(typeof u=="number")return a[u]})}};f0=B([O(1,rt)],f0);class p0{constructor(e,t,n,r){this.start=e,this.deletedCount=t,this.deletedItems=n,this.items=r}asApiEvent(){return{range:new Xr(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class g0{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1}}constructor(e,t,n){this.notebook=e,this._extHostDocument=t,this._cellData=n,this.handle=n.handle,this.uri=y.revive(n.uri),this.cellKind=n.cellKind,this._outputs=n.outputs.map(Hs.to),this._internalMetadata=n.internalMetadata??{},this._metadata=Object.freeze(n.metadata??{}),this._previousResult=Object.freeze(ac.to(n.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const n={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Qd.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(r){e._mime=r},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(n)}return this._apiCell}setOutputs(e){this._outputs=e.map(Hs.to)}setOutputItems(e,t,n){const r=n.map(lc.to),s=this._outputs.find(o=>o.id===e);if(s&&(t||(s.items.length=0),s.items.push(...r),s.items.length>1&&s.items.every(o=>BS(o.mime)))){const o=new Map,a=[];s.items.forEach(l=>{let c;o.has(l.mime)?c=o.get(l.mime):(c=[],o.set(l.mime,c),a.push(l.mime)),c.push(l.data)}),s.items.length=0,a.forEach(l=>{const c=d8(o.get(l));s.items.push({mime:l,data:c.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(ac.to(e))}setMime(e){}}const o1=class o1{constructor(e,t,n,r,s){this._proxy=e,this._textDocumentsAndEditors=t,this._textDocuments=n,this.uri=r,this.handle=o1._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=s.viewType,this._metadata=Object.freeze(s.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,s.cells]],!0,void 0),this._versionId=s.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===le.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(n){return n=e._validateIndex(n),e._cells[n].apiCell},getCells(n){return(n?e._getCells(n):e._cells).map(s=>s.apiCell)},save(){return e._save()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,n){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:n});const r={notebook:this.apiNotebook,metadata:n,cellChanges:[],contentChanges:[]},s=[];for(const a of e.rawEvents)a.kind===zn.ModelChange?this._spliceNotebookCells(a.changes,!1,r.contentChanges):a.kind===zn.Move?this._moveCells(a.index,a.length,a.newIdx,r.contentChanges):a.kind===zn.Output?(this._setCellOutputs(a.index,a.outputs),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===zn.OutputItem?(this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===zn.ChangeCellLanguage?(this._changeCellLanguage(a.index,a.language),s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})):a.kind===zn.ChangeCellContent?s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document}):a.kind===zn.ChangeCellMime?this._changeCellMime(a.index,a.mime):a.kind===zn.ChangeCellMetadata?(this._changeCellMetadata(a.index,a.metadata),s.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})):a.kind===zn.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(a.index,a.internalMetadata),s.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<s.length;a++){const l=s[a],c=o.get(l.cell);if(c===void 0){const u=r.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...l});o.set(l.cell,u-1)}else r.cellChanges[c]={...r.cellChanges[c],...l}}return r}_validateIndex(e){return e=e|0,e<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=e.start|0,n=e.end|0;return t<0&&(t=0),n>this._cells.length&&(n=this._cells.length),e.with({start:t,end:n})}_getCells(e){e=this._validateRange(e);const t=[];for(let n=e.start;n<e.end;n++)t.push(this._cells[n]);return t}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,n){if(this._disposed)return;const r=[],s=[],o=[];if(e.reverse().forEach(a=>{const c=a[2].map(f=>{const p=new g0(this,this._textDocumentsAndEditors,f);return t||s.push(g0.asModelAddData(f)),p}),u=new p0(a[0],a[1],[],c),d=this._cells.splice(a[0],a[1],...c);for(const f of d)o.push(f.uri),u.deletedItems.push(f.apiCell);r.push(u)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:s,removedDocuments:o}),n)for(const a of r)n.push(a.asApiEvent())}_moveCells(e,t,n,r){const s=this._cells.splice(e,t);this._cells.splice(n,0,...s);const o=[new p0(e,t,s.map(a=>a.apiCell),[]),new p0(n,0,[],s)];for(const a of o)r.push(a.asApiEvent())}_setCellOutputs(e,t){this._cells[e].setOutputs(t)}_setCellOutputItems(e,t,n,r){this._cells[e].setOutputItems(t,n,r)}_changeCellLanguage(e,t){const n=this._cells[e];n.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(n.uri,t)}_changeCellMime(e,t){const n=this._cells[e];n.apiCell.mime=t}_changeCellMetadata(e,t){this._cells[e].setMetadata(t)}_changeCellInternalMetadata(e,t){this._cells[e].setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find(t=>t.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(t=>t.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}};o1._handlePool=0;let m0=o1;const a1=class a1{constructor(e,t,n,r,s,o){this.id=e,this._proxy=t,this.notebookData=n,this._selections=[],this._visibleRanges=[],this._visible=!1,this._selections=s,this._visibleRanges=r,this._viewColumn=o}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(t){this.selections=[t]},get selections(){return e._selections},set selections(t){if(!Array.isArray(t)||!t.every(Xr.isNotebookRange))throw Ue("selections");e._selections=t,e._trySetSelections(t)},get visibleRanges(){return e._visibleRanges},revealRange(t,n){e._proxy.$tryRevealRange(e.id,mr.from(t),n??dg.Default)},get viewColumn(){return e._viewColumn},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}},a1.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(mr.from))}_acceptViewColumn(e){this._viewColumn=e}};a1.apiEditorsToExtHost=new WeakMap;let Ih=a1;class _0{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==ue)return v0(this.right);let e=this;for(;e.parent!==ue&&e.parent.left!==e;)e=e.parent;return e.parent===ue?ue:e.parent}prev(){if(this.left!==ue)return Ok(this.left);let e=this;for(;e.parent!==ue&&e.parent.right!==e;)e=e.parent;return e.parent===ue?ue:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}var Oe;(function(i){i[i.Black=0]="Black",i[i.Red=1]="Red"})(Oe||(Oe={}));const ue=new _0(null,Oe.Black);ue.parent=ue,ue.left=ue,ue.right=ue,ue.color=Oe.Black;function v0(i){for(;i.left!==ue;)i=i.left;return i}function Ok(i){for(;i.right!==ue;)i=i.right;return i}function w0(i){return i===ue?0:i.size_left+i.piece.length+w0(i.right)}function b0(i){return i===ue?0:i.lf_left+i.piece.lineFeedCnt+b0(i.right)}function y0(){ue.parent=ue}function Ph(i,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==ue&&(t.left.parent=e),t.parent=e.parent,e.parent===ue?i.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function Th(i,e){const t=e.left;e.left=t.right,t.right!==ue&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===ue?i.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Lm(i,e){let t,n;if(e.left===ue?(n=e,t=n.right):e.right===ue?(n=e,t=n.left):(n=v0(e.right),t=n.right),n===i.root){i.root=t,t.color=Oe.Black,e.detach(),y0(),i.root.parent=ue;return}const r=n.color===Oe.Red;if(n===n.parent.left?n.parent.left=t:n.parent.right=t,n===e?(t.parent=n.parent,Ah(i,t)):(n.parent===e?t.parent=n:t.parent=n.parent,Ah(i,t),n.left=e.left,n.right=e.right,n.parent=e.parent,n.color=e.color,e===i.root?i.root=n:e===e.parent.left?e.parent.left=n:e.parent.right=n,n.left!==ue&&(n.left.parent=n),n.right!==ue&&(n.right.parent=n),n.size_left=e.size_left,n.lf_left=e.lf_left,Ah(i,n)),e.detach(),t.parent.left===t){const o=w0(t),a=b0(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const l=o-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,rs(i,t.parent,l,c)}}if(Ah(i,t.parent),r){y0();return}let s;for(;t!==i.root&&t.color===Oe.Black;)t===t.parent.left?(s=t.parent.right,s.color===Oe.Red&&(s.color=Oe.Black,t.parent.color=Oe.Red,Ph(i,t.parent),s=t.parent.right),s.left.color===Oe.Black&&s.right.color===Oe.Black?(s.color=Oe.Red,t=t.parent):(s.right.color===Oe.Black&&(s.left.color=Oe.Black,s.color=Oe.Red,Th(i,s),s=t.parent.right),s.color=t.parent.color,t.parent.color=Oe.Black,s.right.color=Oe.Black,Ph(i,t.parent),t=i.root)):(s=t.parent.left,s.color===Oe.Red&&(s.color=Oe.Black,t.parent.color=Oe.Red,Th(i,t.parent),s=t.parent.left),s.left.color===Oe.Black&&s.right.color===Oe.Black?(s.color=Oe.Red,t=t.parent):(s.left.color===Oe.Black&&(s.right.color=Oe.Black,s.color=Oe.Red,Ph(i,s),s=t.parent.left),s.color=t.parent.color,t.parent.color=Oe.Black,s.left.color=Oe.Black,Th(i,t.parent),t=i.root));t.color=Oe.Black,y0()}function Fk(i,e){for(Ah(i,e);e!==i.root&&e.parent.color===Oe.Red;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===Oe.Red?(e.parent.color=Oe.Black,t.color=Oe.Black,e.parent.parent.color=Oe.Red,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Ph(i,e)),e.parent.color=Oe.Black,e.parent.parent.color=Oe.Red,Th(i,e.parent.parent))}else{const t=e.parent.parent.left;t.color===Oe.Red?(e.parent.color=Oe.Black,t.color=Oe.Black,e.parent.parent.color=Oe.Red,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,Th(i,e)),e.parent.color=Oe.Black,e.parent.parent.color=Oe.Red,Ph(i,e.parent.parent))}i.root.color=Oe.Black}function rs(i,e,t,n){for(;e!==i.root&&e!==ue;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}function Ah(i,e){let t=0,n=0;if(e!==i.root){for(;e!==i.root&&e===e.parent.right;)e=e.parent;if(e!==i.root)for(e=e.parent,t=w0(e.left)-e.size_left,n=b0(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=n;e!==i.root&&(t!==0||n!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=n),e=e.parent}}const ss=65535;function Mk(i){let e;return i[i.length-1]<65536?e=new Uint16Array(i.length):e=new Uint32Array(i.length),e.set(i,0),e}class i3{constructor(e,t,n,r,s){this.lineStarts=e,this.cr=t,this.lf=n,this.crlf=r,this.isBasicASCII=s}}function os(i,e=!0){const t=[0];let n=1;for(let r=0,s=i.length;r<s;r++){const o=i.charCodeAt(r);o===P.CarriageReturn?r+1<s&&i.charCodeAt(r+1)===P.LineFeed?(t[n++]=r+2,r++):t[n++]=r+1:o===P.LineFeed&&(t[n++]=r+1)}return e?Mk(t):t}function n3(i,e){i.length=0,i[0]=0;let t=1,n=0,r=0,s=0,o=!0;for(let l=0,c=e.length;l<c;l++){const u=e.charCodeAt(l);u===P.CarriageReturn?l+1<c&&e.charCodeAt(l+1)===P.LineFeed?(s++,i[t++]=l+2,l++):(n++,i[t++]=l+1):u===P.LineFeed?(r++,i[t++]=l+1):o&&u!==P.Tab&&(u<32||u>126)&&(o=!1)}const a=new i3(Mk(i),n,r,s,o);return i.length=0,a}class ji{constructor(e,t,n,r,s){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=r,this.length=s}}class va{constructor(e,t){this.buffer=e,this.lineStarts=t}}class r3{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==ue&&e.iterate(e.root,n=>(n!==ue&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class s3{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const n=this._cache;for(let r=0;r<n.length;r++){const s=n[r];if(s.node.parent===null||s.nodeStartOffset>=e){n[r]=null,t=!0;continue}}if(t){const r=[];for(const s of n)s!==null&&r.push(s);this._cache=r}}}class o3{constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new va("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=ue,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let r=null;for(let s=0,o=e.length;s<o;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=os(e[s].buffer));const a=new ji(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),r=this.rbInsertRight(r,a)}this._searchCache=new s3(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=ss,n=t-Math.floor(t/3),r=n*2;let s="",o=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),u=c.length;if(o<=n||o+u<r)return s+=c,o+=u,!0;const d=s.replace(/\r\n|\r|\n/g,e);return a.push(new va(d,os(d))),s=c,o=u,!0}),o>0){const l=s.replace(/\r\n|\r|\n/g,e);a.push(new va(l,os(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new r3(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,r=>{if(r===ue)return!0;const s=this.getNodeContent(r),o=s.length,a=e.nodeAt(t),l=e.nodeAt(t+o),c=e.getValueInRange2(a,l);return t+=o,s===c})}getOffsetAt(e,t){let n=0,r=this.root;for(;r!==ue;)if(r.left!==ue&&r.lf_left+1>=e)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt+1>=e){n+=r.size_left;const s=this.getAccumulatedValue(r,e-r.lf_left-2);return n+=s+t-1}else e-=r.lf_left+r.piece.lineFeedCnt,n+=r.size_left+r.piece.length,r=r.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0;const r=e;for(;t!==ue;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const s=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+s.index,s.index===0){const o=this.getOffsetAt(n+1,1),a=r-o;return new pn(n+1,a+1)}return new pn(n+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===ue){const s=this.getOffsetAt(n+1,1),o=r-e-s;return new pn(n+1,o+1)}else t=t.right;return new pn(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const n=this.nodeAt2(e.startLineNumber,e.startColumn),r=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(n,r);return t?t!==this._EOL||!this._EOLNormalized?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let n=e.node;const r=this._buffers[n.piece.bufferIndex].buffer,s=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);let o=r.substring(s+e.remainder,s+n.piece.length);for(n=n.next();n!==ue;){const a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){o+=a.substring(l,l+t.remainder);break}else o+=a.substr(l,n.piece.length);n=n.next()}return o}getLinesContent(){const e=[];let t=0,n="",r=!1;return this.iterate(this.root,s=>{if(s===ue)return!0;const o=s.piece;let a=o.length;if(a===0)return!0;const l=this._buffers[o.bufferIndex].buffer,c=this._buffers[o.bufferIndex].lineStarts,u=o.start.line,d=o.end.line;let f=c[u]+o.start.column;if(r&&(l.charCodeAt(f)===P.LineFeed&&(f++,a--),e[t++]=n,n="",r=!1,a===0))return!0;if(u===d)return!this._EOLNormalized&&l.charCodeAt(f+a-1)===P.CarriageReturn?(r=!0,n+=l.substr(f,a-1)):n+=l.substr(f,a),!0;n+=this._EOLNormalized?l.substring(f,Math.max(f,c[u+1]-this._EOLLength)):l.substring(f,c[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let p=u+1;p<d;p++)n=this._EOLNormalized?l.substring(c[p],c[p+1]-this._EOLLength):l.substring(c[p],c[p+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return!this._EOLNormalized&&l.charCodeAt(c[d]+o.end.column-1)===P.CarriageReturn?(r=!0,o.end.column===0?t--:n=l.substr(c[d],o.end.column-1)):n=l.substr(c[d],o.end.column),!0}),r&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const n=this._buffers[t.piece.bufferIndex],r=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(r)}else{const t=this._buffers[e.node.piece.bufferIndex],r=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(r)}}getLineCharCode(e,t){const n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){const t=this.nodeAt(e);if(t.remainder===t.node.piece.length){const n=t.node.next();if(!n||n===ue)return"";const r=this._buffers[n.piece.bufferIndex],s=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return r.buffer.substring(s,s+n.piece.length)}else{const n=this._buffers[t.node.piece.bufferIndex],r=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),s=r+t.remainder,o=r+t.node.piece.length;return n.buffer.substring(s,o)}}findMatchesInNode(e,t,n,r,s,o,a,l,c,u,d){const f=this._buffers[e.piece.bufferIndex],p=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),b=this.offsetInBuffer(e.piece.bufferIndex,s),w=this.offsetInBuffer(e.piece.bufferIndex,o);let v;const S={line:0,column:0};let k,C;t._wordSeparators?(k=f.buffer.substring(b,w),C=N=>N+b,t.reset(0)):(k=f.buffer,C=N=>N,t.reset(b));do if(v=t.next(k),v){if(C(v.index)>=w)return u;this.positionInBuffer(e,C(v.index)-p,S);const N=this.getLineFeedCnt(e.piece.bufferIndex,s,S),A=S.line===s.line?S.column-s.column+r:S.column+1,V=A+v[0].length;if(d[u++]=gD(new ct(n+N,A,n+N,V),v,l),C(v.index)+v[0].length>=w||u>=c)return u}while(v);return u}findMatchesLineByLine(e,t,n,r){const s=[];let o=0;const a=new QA(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let u=this.positionInBuffer(l.node,l.remainder);const d=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,u,d,t,n,r,o,s),s;let f=e.startLineNumber,p=l.node;for(;p!==c.node;){const w=this.getLineFeedCnt(p.piece.bufferIndex,u,p.piece.end);if(w>=1){const S=this._buffers[p.piece.bufferIndex].lineStarts,k=this.offsetInBuffer(p.piece.bufferIndex,p.piece.start),C=S[u.line+w],N=f===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(p,a,f,N,u,this.positionInBuffer(p,C-k),t,n,r,o,s),o>=r)return s;f+=w}const v=f===e.startLineNumber?e.startColumn-1:0;if(f===e.endLineNumber){const S=this.getLineContent(f).substring(v,e.endColumn-1);return o=this._findMatchesInLine(t,a,S,e.endLineNumber,v,o,s,n,r),s}if(o=this._findMatchesInLine(t,a,this.getLineContent(f).substr(v),f,v,o,s,n,r),o>=r)return s;f++,l=this.nodeAt2(f,1),p=l.node,u=this.positionInBuffer(l.node,l.remainder)}if(f===e.endLineNumber){const w=f===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(f).substring(w,e.endColumn-1);return o=this._findMatchesInLine(t,a,v,e.endLineNumber,w,o,s,n,r),s}const b=f===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(c.node,a,f,b,u,d,t,n,r,o,s),s}_findMatchesInLine(e,t,n,r,s,o,a,l,c){const u=e.wordSeparators;if(!l&&e.simpleSearch){const f=e.simpleSearch,p=f.length,b=n.length;let w=-p;for(;(w=n.indexOf(f,w+p))!==-1;)if((!u||mD(u,n,b,w,p))&&(a[o++]=new D_(new ct(r,w+1+s,r,w+1+p+s),null),o>=c))return o;return o}let d;t.reset(0);do if(d=t.next(n),d&&(a[o++]=gD(new ct(r,d.index+1+s,r,d.index+1+d[0].length+s),d,l),o>=c))return o;while(d);return o}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==ue){const{node:r,remainder:s,nodeStartOffset:o}=this.nodeAt(e),a=r.piece,l=a.bufferIndex,c=this.positionInBuffer(r,s);if(r.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<ss){this.appendToNode(r,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,r),this._searchCache.validate(e);else if(o+r.piece.length>e){const u=[];let d=new ji(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(r,s)===10){const w={line:d.start.line+1,column:0};d=new ji(d.bufferIndex,w,d.end,this.getLineFeedCnt(d.bufferIndex,w,d.end),d.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(r,s-1)===13){const w=this.positionInBuffer(r,s-1);this.deleteNodeTail(r,w),t="\r"+t,r.piece.length===0&&u.push(r)}else this.deleteNodeTail(r,c);else this.deleteNodeTail(r,c);const f=this.createNewPieces(t);d.length>0&&this.rbInsertRight(r,d);let p=r;for(let b=0;b<f.length;b++)p=this.rbInsertRight(p,f[b]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,r)}else{const r=this.createNewPieces(t);let s=this.rbInsertLeft(null,r[0]);for(let o=1;o<r.length;o++)s=this.rbInsertRight(s,r[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===ue)return;const n=this.nodeAt(e),r=this.nodeAt(e+t),s=n.node,o=r.node;if(s===o){const f=this.positionInBuffer(s,n.remainder),p=this.positionInBuffer(s,r.remainder);if(n.nodeStartOffset===e){if(t===s.piece.length){const b=s.next();Lm(this,s),this.validateCRLFWithPrevNode(b),this.computeBufferMetadata();return}this.deleteNodeHead(s,p),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),this.computeBufferMetadata();return}if(n.nodeStartOffset+s.piece.length===e+t){this.deleteNodeTail(s,f),this.validateCRLFWithNextNode(s),this.computeBufferMetadata();return}this.shrinkNode(s,f,p),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(s,n.remainder);this.deleteNodeTail(s,l),this._searchCache.validate(e),s.piece.length===0&&a.push(s);const c=this.positionInBuffer(o,r.remainder);this.deleteNodeHead(o,c),o.piece.length===0&&a.push(o);const u=s.next();for(let f=u;f!==ue&&f!==o;f=f.next())a.push(f);const d=s.piece.length===0?s.prev():s;this.deleteNodes(a),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},l=new ji(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=l,e+=`
`,rs(this,t,-1,-1),t.piece.length===0&&n.push(t)}const r=this.createNewPieces(e);let s=this.rbInsertLeft(t,r[r.length-1]);for(let o=r.length-2;o>=0;o--)s=this.rbInsertLeft(s,r[o]);this.validateCRLFWithPrevNode(s),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const n=this.createNewPieces(e),r=this.rbInsertRight(t,n[0]);let s=r;for(let o=1;o<n.length;o++)s=this.rbInsertRight(s,n[o]);this.validateCRLFWithPrevNode(r)}positionInBuffer(e,t,n){const r=e.piece,s=e.piece.bufferIndex,o=this._buffers[s].lineStarts,l=o[r.start.line]+r.start.column+t;let c=r.start.line,u=r.end.line,d=0,f=0,p=0;for(;c<=u&&(d=c+(u-c)/2|0,p=o[d],d!==u);)if(f=o[d+1],l<p)u=d-1;else if(l>=f)c=d+1;else break;return n?(n.line=d,n.column=l-p,null):{line:d,column:l-p}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;const r=this._buffers[e].lineStarts;if(n.line===r.length-1)return n.line-t.line;const s=r[n.line+1],o=r[n.line]+n.column;if(s>o+1)return n.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Lm(this,e[t])}createNewPieces(e){if(e.length>ss){const u=[];for(;e.length>ss;){const f=e.charCodeAt(ss-1);let p;f===P.CarriageReturn||f>=55296&&f<=56319?(p=e.substring(0,ss-1),e=e.substring(ss-1)):(p=e.substring(0,ss),e=e.substring(ss));const b=os(p);u.push(new ji(this._buffers.length,{line:0,column:0},{line:b.length-1,column:p.length-b[b.length-1]},b.length-1,p.length)),this._buffers.push(new va(p,b))}const d=os(e);return u.push(new ji(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length)),this._buffers.push(new va(e,d)),u}let t=this._buffers[0].buffer.length;const n=os(e,!1);let r=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},r=this._lastChangeBufferPos;for(let u=0;u<n.length;u++)n[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<n.length;u++)n[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=s-this._buffers[0].lineStarts[o],l={line:o,column:a},c=new ji(0,r,l,this.getLineFeedCnt(0,r,l),s-t);return this._lastChangeBufferPos=l,[c]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,r="";const s=this._searchCache.get2(e);if(s){n=s.node;const o=this.getAccumulatedValue(n,e-s.nodeStartLineNumber-1),a=this._buffers[n.piece.bufferIndex].buffer,l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(s.nodeStartLineNumber+n.piece.lineFeedCnt===e)r=a.substring(l+o,l+n.piece.length);else{const c=this.getAccumulatedValue(n,e-s.nodeStartLineNumber);return a.substring(l+o,l+c-t)}}else{let o=0;const a=e;for(;n!==ue;)if(n.left!==ue&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(n,e-n.lf_left-2),c=this.getAccumulatedValue(n,e-n.lf_left-1),u=this._buffers[n.piece.bufferIndex].buffer,d=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return o+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-n.lf_left)}),u.substring(d+l,d+c-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(n,e-n.lf_left-2),c=this._buffers[n.piece.bufferIndex].buffer,u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);r=c.substring(u+l,u+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,o+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==ue;){const o=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(n,0),l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return r+=o.substring(l,l+a-t),r}else{const a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);r+=o.substr(a,n.piece.length)}n=n.next()}return r}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==ue;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){const n=e.piece,r=this.positionInBuffer(e,t),s=r.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,n.start,r);if(o!==s)return{index:o,remainder:0}}return{index:s,remainder:r.column}}getAccumulatedValue(e,t){if(t<0)return 0;const n=e.piece,r=this._buffers[n.bufferIndex].lineStarts,s=n.start.line+t+1;return s>n.end.line?r[n.end.line]+n.end.column-r[n.start.line]-n.start.column:r[s]-r[n.start.line]-n.start.column}deleteNodeTail(e,t){const n=e.piece,r=n.lineFeedCnt,s=this.offsetInBuffer(n.bufferIndex,n.end),o=t,a=this.offsetInBuffer(n.bufferIndex,o),l=this.getLineFeedCnt(n.bufferIndex,n.start,o),c=l-r,u=a-s,d=n.length+u;e.piece=new ji(n.bufferIndex,n.start,o,l,d),rs(this,e,u,c)}deleteNodeHead(e,t){const n=e.piece,r=n.lineFeedCnt,s=this.offsetInBuffer(n.bufferIndex,n.start),o=t,a=this.getLineFeedCnt(n.bufferIndex,o,n.end),l=this.offsetInBuffer(n.bufferIndex,o),c=a-r,u=s-l,d=n.length+u;e.piece=new ji(n.bufferIndex,o,n.end,a,d),rs(this,e,u,c)}shrinkNode(e,t,n){const r=e.piece,s=r.start,o=r.end,a=r.length,l=r.lineFeedCnt,c=t,u=this.getLineFeedCnt(r.bufferIndex,r.start,c),d=this.offsetInBuffer(r.bufferIndex,t)-this.offsetInBuffer(r.bufferIndex,s);e.piece=new ji(r.bufferIndex,r.start,c,u,d),rs(this,e,d-a,u-l);const f=new ji(r.bufferIndex,n,o,this.getLineFeedCnt(r.bufferIndex,n,o),this.offsetInBuffer(r.bufferIndex,o)-this.offsetInBuffer(r.bufferIndex,n)),p=this.rbInsertRight(e,f);this.validateCRLFWithPrevNode(p)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),r=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=os(t,!1);for(let p=0;p<s.length;p++)s[p]+=r;if(n){const p=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:r-p}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],l={line:o,column:a},c=e.piece.length+t.length,u=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,l),f=d-u;e.piece=new ji(e.piece.bufferIndex,e.piece.start,l,d,c),this._lastChangeBufferPos=l,rs(this,e,t.length,f)}nodeAt(e){let t=this.root;const n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let r=0;for(;t!==ue;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){r+=t.size_left;const s={node:t,remainder:e-t.size_left,nodeStartOffset:r};return this._searchCache.set(s),s}else e-=t.size_left+t.piece.length,r+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,r=0;for(;n!==ue;)if(n.left!==ue&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){const s=this.getAccumulatedValue(n,e-n.lf_left-2),o=this.getAccumulatedValue(n,e-n.lf_left-1);return r+=n.size_left,{node:n,remainder:Math.min(s+t-1,o),nodeStartOffset:r}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const s=this.getAccumulatedValue(n,e-n.lf_left-2);if(s+t-1<=n.piece.length)return{node:n,remainder:s+t-1,nodeStartOffset:r};t-=n.piece.length-s;break}else e-=n.lf_left+n.piece.lineFeedCnt,r+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==ue;){if(n.piece.lineFeedCnt>0){const s=this.getAccumulatedValue(n,0),o=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,s),nodeStartOffset:o}}else if(n.piece.length>=t-1){const s=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:s}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const n=this._buffers[e.piece.bufferIndex],r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(r)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===ue||e.piece.lineFeedCnt===0)return!1;const t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,r=t.start.line,s=n[r]+t.start.column;return r===n.length-1||n[r+1]>s+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(s)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===ue||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const n=[],r=this._buffers[e.piece.bufferIndex].lineStarts;let s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new ji(e.piece.bufferIndex,e.piece.start,s,a,o),rs(this,e,-1,-1),e.piece.length===0&&n.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new ji(t.piece.bufferIndex,l,t.piece.end,u,c),rs(this,t,-1,-1),t.piece.length===0&&n.push(t);const d=this.createNewPieces(`\r
`);this.rbInsertRight(e,d[0]);for(let f=0;f<n.length;f++)Lm(this,n[f])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)Lm(this,n);else{const r=n.piece,s={line:r.start.line+1,column:0},o=r.length-1,a=this.getLineFeedCnt(r.bufferIndex,s,r.end);n.piece=new ji(r.bufferIndex,s,r.end,a,o),rs(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===ue)return t(ue);const n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===ue)return"";const t=this._buffers[e.piece.bufferIndex],n=e.piece,r=this.offsetInBuffer(n.bufferIndex,n.start),s=this.offsetInBuffer(n.bufferIndex,n.end);return t.buffer.substring(r,s)}getPieceContent(e){const t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),r=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(n,r)}rbInsertRight(e,t){const n=new _0(t,Oe.Red);if(n.left=ue,n.right=ue,n.parent=ue,n.size_left=0,n.lf_left=0,this.root===ue)this.root=n,n.color=Oe.Black;else if(e.right===ue)e.right=n,n.parent=e;else{const s=v0(e.right);s.left=n,n.parent=s}return Fk(this,n),n}rbInsertLeft(e,t){const n=new _0(t,Oe.Red);if(n.left=ue,n.right=ue,n.parent=ue,n.size_left=0,n.lf_left=0,this.root===ue)this.root=n,n.color=Oe.Black;else if(e.left===ue)e.left=n,n.parent=e;else{const r=Ok(e.left);r.right=n,n.parent=r}return Fk(this,n),n}getContentOfSubTree(e){let t="";return this.iterate(e,n=>(t+=this.getNodeContent(n),!0)),t}}var as;(function(i){i[i.Unknown=0]="Unknown",i[i.Invalid=3]="Invalid",i[i.LF=1]="LF",i[i.CRLF=2]="CRLF"})(as||(as={}));function x0(i){let e=0,t=0,n=0,r=as.Unknown;for(let s=0,o=i.length;s<o;s++){const a=i.charCodeAt(s);a===P.CarriageReturn?(e===0&&(t=s),e++,s+1<o&&i.charCodeAt(s+1)===P.LineFeed?(r|=as.CRLF,s++):r|=as.Invalid,n=s+1):a===P.LineFeed&&(r|=as.LF,e===0&&(t=s),e++,n=s+1)}return e===0&&(t=i.length),[e,t,i.length-n,r]}let E0;function a3(){return E0||(E0=new TextDecoder("UTF-16LE")),E0}function l3(i,e,t){const n=new Uint16Array(i.buffer,e,t);return t>0&&(n[0]===65279||n[0]===65534)?c3(i,e,t):a3().decode(n)}function c3(i,e,t){const n=[];let r=0;for(let s=0;s<t;s++){const o=B5(i,e);e+=2,n[r++]=String.fromCharCode(o)}return n.join("")}function Nm(i){return i.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Yn{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,n,r){this.oldPosition=e,this.oldText=t,this.newPosition=n,this.newText=r}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Nm(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Nm(this.oldText)}")`:`(replace@${this.oldPosition} "${Nm(this.oldText)}" with "${Nm(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){const r=t.length;hf(e,r,n),n+=4;for(let s=0;s<r;s++)W5(e,t.charCodeAt(s),n),n+=2;return n}static _readString(e,t){const n=df(e,t);return t+=4,l3(e,t,n)}writeSize(){return 8+Yn._writeStringSize(this.oldText)+Yn._writeStringSize(this.newText)}write(e,t){return hf(e,this.oldPosition,t),t+=4,hf(e,this.newPosition,t),t+=4,t=Yn._writeString(e,this.oldText,t),t=Yn._writeString(e,this.newText,t),t}static read(e,t,n){const r=df(e,t);t+=4;const s=df(e,t);t+=4;const o=Yn._readString(e,t);t+=Yn._writeStringSize(o);const a=Yn._readString(e,t);return t+=Yn._writeStringSize(a),n.push(new Yn(r,o,s,a)),t}}class kc extends Re{constructor(e,t,n,r,s,o,a){super(),this._onDidChangeContent=this._register(new L),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=r,this._mightContainUnusualLineTerminators=s,this._pieceTree=new o3(e,n,a)}equals(e){return!(e instanceof kc)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const n=e+t,r=this.getPositionAt(e),s=this.getPositionAt(n);return new ct(r.lineNumber,r.column,s.lineNumber,s.column)}getValueInRange(e,t=Wr.TextDefined){if(e.isEmpty())return"";const n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=Wr.TextDefined){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const n=this.getOffsetAt(e.startLineNumber,e.startColumn),r=this.getOffsetAt(e.endLineNumber,e.endColumn);let s=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length,c=e.endLineNumber-e.startLineNumber;s=l*c}return r-n+s}getCharacterCountInRange(e,t=Wr.TextDefined){if(this._mightContainNonBasicASCII){let n=0;const r=e.startLineNumber,s=e.endLineNumber;for(let o=r;o<=s;o++){const a=this.getLineContent(o),l=o===r?e.startColumn-1:0,c=o===s?e.endColumn-1:a.length;for(let u=l;u<c;u++)Y1(a.charCodeAt(u))?(n=n+1,u=u+1):n=n+1}return n+=this._getEndOfLine(t).length*(s-r),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const t=Q1(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=BC(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case Wr.LF:return`
`;case Wr.CRLF:return`\r
`;case Wr.TextDefined:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let r=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let w=0;w<e.length;w++){const v=e[w];a&&v._isTracked&&(a=!1);const S=v.range;if(v.text){let V=!0;o||(V=!JC(v.text),o=V),!r&&V&&(r=yx(v.text)),!s&&V&&(s=xx(v.text))}let k="",C=0,N=0,A=0;if(v.text){let V;[C,N,A,V]=x0(v.text);const ae=this.getEOL(),be=ae===`\r
`?as.CRLF:as.LF;V===as.Unknown||V===be?k=v.text:k=v.text.replace(/\r\n|\r|\n/g,ae)}l[w]={sortIndex:w,identifier:v.identifier||null,range:S,rangeOffset:this.getOffsetAt(S.startLineNumber,S.startColumn),rangeLength:this.getValueLengthInRange(S),text:k,eolCount:C,firstLineLength:N,lastLineLength:A,forceMoveMarkers:!!v.forceMoveMarkers,isAutoWhitespaceEdit:v.isAutoWhitespaceEdit||!1}}l.sort(kc._sortOpsAscending);let c=!1;for(let w=0,v=l.length-1;w<v;w++){const S=l[w].range.getEndPosition(),k=l[w+1].range.getStartPosition();if(k.isBeforeOrEqual(S)){if(k.isBefore(S))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const u=n||t?kc._getInverseEditRanges(l):[],d=[];if(t)for(let w=0;w<l.length;w++){const v=l[w],S=u[w];if(v.isAutoWhitespaceEdit&&v.range.isEmpty())for(let k=S.startLineNumber;k<=S.endLineNumber;k++){let C="";k===S.startLineNumber&&(C=this.getLineContent(v.range.startLineNumber),Q1(C)!==-1)||d.push({lineNumber:k,oldContent:C})}}let f=null;if(n){let w=0;f=[];for(let v=0;v<l.length;v++){const S=l[v],k=u[v],C=this.getValueInRange(S.range),N=S.rangeOffset+w;w+=S.text.length-C.length,f[v]={sortIndex:S.sortIndex,identifier:S.identifier,range:k,text:C,textChange:new Yn(S.rangeOffset,C,N,S.text)}}c||f.sort((v,S)=>v.sortIndex-S.sortIndex)}this._mightContainRTL=r,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=o;const p=this._doApplyEdits(l);let b=null;if(t&&d.length>0){d.sort((w,v)=>v.lineNumber-w.lineNumber),b=[];for(let w=0,v=d.length;w<v;w++){const S=d[w].lineNumber;if(w>0&&d[w-1].lineNumber===S)continue;const k=d[w].oldContent,C=this.getLineContent(S);C.length===0||C===k||Q1(C)!==-1||b.push(S)}}return this._onDidChangeContent.fire(),new gP(f,p,b)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const n=e[0].range,r=e[e.length-1].range,s=new ct(n.startLineNumber,n.startColumn,r.endLineNumber,r.endColumn);let o=n.startLineNumber,a=n.startColumn;const l=[];for(let p=0,b=e.length;p<b;p++){const w=e[p],v=w.range;t=t||w.forceMoveMarkers,l.push(this.getValueInRange(new ct(o,a,v.startLineNumber,v.startColumn))),w.text.length>0&&l.push(w.text),o=v.endLineNumber,a=v.endColumn}const c=l.join(""),[u,d,f]=x0(c);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,Wr.TextDefined),text:c,eolCount:u,firstLineLength:d,lastLineLength:f,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(kc._sortOpsDescending);const t=[];for(let n=0;n<e.length;n++){const r=e[n],s=r.range.startLineNumber,o=r.range.startColumn,a=r.range.endLineNumber,l=r.range.endColumn;if(s===a&&o===l&&r.text.length===0)continue;r.text?(this._pieceTree.delete(r.rangeOffset,r.rangeLength),this._pieceTree.insert(r.rangeOffset,r.text,!0)):this._pieceTree.delete(r.rangeOffset,r.rangeLength);const c=new ct(s,o,a,l);t.push({range:c,rangeLength:r.rangeLength,text:r.text,rangeOffset:r.rangeOffset,forceMoveMarkers:r.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,r){return this._pieceTree.findMatchesLineByLine(e,t,n,r)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){const n=e.startLineNumber,r=e.startColumn,[s,o,a]=x0(t);let l;if(t.length>0){const c=s+1;c===1?l=new ct(n,r,n,r+o):l=new ct(n,r,n+c-1,a+1)}else l=new ct(n,r,n,r);return l}static _getInverseEditRanges(e){const t=[];let n=0,r=0,s=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c,u;s?s.range.endLineNumber===l.range.startLineNumber?(c=n,u=r+(l.range.startColumn-s.range.endColumn)):(c=n+(l.range.startLineNumber-s.range.endLineNumber),u=l.range.startColumn):(c=l.range.startLineNumber,u=l.range.startColumn);let d;if(l.text.length>0){const f=l.eolCount+1;f===1?d=new ct(c,u,c,u+l.firstLineLength):d=new ct(c,u,c+f-1,l.lastLineLength+1)}else d=new ct(c,u,c,u);n=d.endLineNumber,r=d.endColumn,t.push(d),s=l}return t}static _sortOpsAscending(e,t){const n=ct.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){const n=ct.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}}class u3{constructor(e,t,n,r,s,o,a,l,c){this._chunks=e,this._bom=t,this._cr=n,this._lf=r,this._crlf=s,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===Gu.LF?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let s=0,o=n.length;s<o;s++){const a=n[s].buffer.replace(/\r\n|\r|\n/g,t),l=os(a);n[s]=new va(a,l)}const r=new kc(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:r,disposable:r}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class $k{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&KC(e)&&(this.BOM=YC,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===P.CarriageReturn||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=n3(this._tmpLineStarts,e);this.chunks.push(new va(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=yx(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=xx(e)))}finish(e=!0){return this._finish(),new u3(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=os(e.buffer);e.lineStarts=t,this._previousChar===P.CarriageReturn&&this.cr++}}}class d3 extends Re{constructor(e,t,n){super(),this._source=e,this._inputTextBuffer=t,this._outputs=n,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new ct(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new $k;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:n,disposable:r}=t.create(Gu.LF);this._inputTextBuffer=n,this._register(r)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map(e=>{const t=new $k;t.acceptChunk(e);const n=t.finish(!0),{textBuffer:r,disposable:s}=n.create(Gu.LF);return this._register(s),r})),this._outputTextBuffers}findInInputs(e){const n=new fD(e,!1,!1,null).parseSearchRequest();if(!n)return[];const r=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(r,n,!0,5e3)}findInOutputs(e){const n=new fD(e,!1,!1,null).parseSearchRequest();return n?this.outputTextBuffers.map(r=>{const s=r.findMatchesLineByLine(this._getFullModelRange(r),n,!0,5e3);if(s.length!==0)return{textBuffer:r,matches:s}}).filter(r=>!!r):[]}}function Uk(i,e){let t=-1;const n=[];let r=[];return i.forEach(o=>{o.range.startLineNumber!==t&&r.length>0&&(n.push([...r]),r=[]),r.push(o),t=o.range.endLineNumber}),r.length>0&&n.push([...r]),n.map(o=>{const a=[],l=o[0].range.startLineNumber,c=o[o.length-1].range.endLineNumber;for(let u=l;u<=c;u++)a.push(e.getLineContent(u));return new eA(a.join(`
`)+`
`,o.map(u=>new ct(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}const h3=ke("remoteAgentService"),f3=ke("IUserDataProfilesService");Object.freeze({id:"application",order:100,title:h(4488,"Application"),type:"object"});const p3=Object.freeze({id:"workbench",order:7,title:h(4489,"Workbench"),type:"object"}),g3=Object.freeze({id:"security",scope:Ot.APPLICATION,title:h(4490,"Security"),type:"object",order:7});Object.freeze({id:"problems",title:h(4491,"Problems"),type:"object",order:101});const m3=Object.freeze({id:"window",order:8,title:h(4492,"Window"),type:"object"}),_3={ConfigurationMigration:"base.contributions.configuration.migration"};class v3{constructor(){this.migrations=[],this._onDidRegisterConfigurationMigrations=new L,this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}}const Om=new v3;hi.add(_3.ConfigurationMigration,Om);let Hk=(Bc=class extends Re{constructor(e,t){super(),this.configurationService=e,this.workspaceService=t,this._register(this.workspaceService.onDidChangeWorkspaceFolders(async n=>{for(const r of n.added)await this.migrateConfigurationsForFolder(r,Om.migrations)})),this.migrateConfigurations(Om.migrations),this._register(Om.onDidRegisterConfigurationMigration(n=>this.migrateConfigurations(n)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(const t of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(t,e)}async migrateConfigurationsForFolder(e,t){await Promise.all([t.map(n=>this.migrateConfigurationsForFolderAndOverride(n,e==null?void 0:e.uri))])}async migrateConfigurationsForFolderAndOverride(e,t){const n=this.configurationService.inspect(e.key,{resource:t}),r=this.workspaceService.getWorkbenchState()===Nf.WORKSPACE?[["user",ti.USER],["userLocal",ti.USER_LOCAL],["userRemote",ti.USER_REMOTE],["workspace",ti.WORKSPACE],["workspaceFolder",ti.WORKSPACE_FOLDER]]:[["user",ti.USER],["userLocal",ti.USER_LOCAL],["userRemote",ti.USER_REMOTE],["workspace",ti.WORKSPACE]];for(const[s,o]of r){const a=n[s];if(!a)continue;const l=[];if(a.value!==void 0){const c=await this.runMigration(e,s,a.value,t,void 0);for(const u of c??[])l.push([u,[]])}for(const{identifiers:c,value:u}of a.overrides??[])if(u!==void 0){const d=await this.runMigration(e,s,u,t,c);for(const f of d??[])l.push([f,c])}l.length&&await Promise.allSettled(l.map(async([[c,u],d])=>this.configurationService.updateValue(c,u.value,{resource:t,overrideIdentifiers:d},o)))}}async runMigration(e,t,n,r,s){const o=l=>{var d,f;const u=this.configurationService.inspect(l,{resource:r})[t];if(u)return s?(f=(d=u.overrides)==null?void 0:d.find(({identifiers:p})=>$n(p,s)))==null?void 0:f.value:u.value},a=await e.migrateFn(n,o);return Array.isArray(a)?a:[[e.key,a]]}},Bc.ID="workbench.contrib.configurationMigration",Bc);Hk=B([O(0,am),O(1,_D)],Hk);let Bk=(Wc=class extends Re{constructor(e){super(),this.remoteAgentService=e,this._ready=new cl,this.ready=this._ready.p,this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!cn){const t=await this.remoteAgentService.getEnvironment();if((t==null?void 0:t.os)!==tl.Windows)return}hi.as(Tl.Configuration).registerConfiguration({...g3,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h(4493,"UNC host names must not contain backslashes.")},default:[],markdownDescription:h(4494,"A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:Ot.MACHINE},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h(4495,"If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:Ot.MACHINE}}})}},Wc.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration",Wc);Bk=B([O(0,h3)],Bk);const Rh="window.newWindowProfile";let Wk=(Vc=class extends Re{constructor(e,t){super(),this.userDataProfilesService=e,this.configurationService=t,this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(n=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(t.onDidChangeConfiguration(n=>{n.source!==ti.DEFAULT&&n.affectsConfiguration(Rh)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}registerNewWindowProfileConfiguration(){const e=hi.as(Tl.Configuration),t={...m3,properties:{[Rh]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(n=>n.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(n=>""),h(4496,"Active Window")],description:h(4497,"Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:Ot.APPLICATION}}};this.configurationNode?e.updateConfigurations({add:[t],remove:[this.configurationNode]}):e.registerConfiguration(t),this.configurationNode=t}setNewWindowProfile(){const e=this.configurationService.getValue(Rh);this.newWindowProfile=e?this.userDataProfilesService.profiles.find(t=>t.name===e):void 0}checkAndResetNewWindowProfileConfig(){const e=this.configurationService.getValue(Rh);if(!e)return;const t=this.newWindowProfile?this.userDataProfilesService.profiles.find(n=>n.id===this.newWindowProfile.id):void 0;e!==(t==null?void 0:t.name)&&this.configurationService.updateValue(Rh,t==null?void 0:t.name)}},Vc.ID="workbench.contrib.dynamicWindowConfiguration",Vc);Wk=B([O(0,f3),O(1,am)],Wk);const w3=hi.as(Tl.Configuration),b3={...p3,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h(5659,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};w3.registerConfiguration(b3);var S0;(function(i){i.builtin="builtin",i.option="option",i.exclusive="exclusive",i.default="default"})(S0||(S0={}));var Vk;(function(i){i[i.ABORT=1]="ABORT",i[i.NONE=2]="NONE"})(Vk||(Vk={}));function y3(i,e){if(new Set([le.extension,le.webviewPanel,le.vscodeWorkspaceTrust,le.vscodeSettings]).has(e.scheme))return!1;const r=typeof i=="string"&&i.indexOf(tt.sep)>=0?`${e.scheme}:${e.path}`:xo(e);return od(typeof i=="string"?i.toLowerCase():i,r.toLowerCase())}const Wa=class Wa{get activeNotebookEditor(){var e;return(e=this._activeNotebookEditor)==null?void 0:e.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,t,n,r,s,o,a){this._textDocumentsAndEditors=n,this._textDocuments=r,this._extHostFileSystem=s,this._extHostSearch=o,this._logService=a,this._notebookStatusBarItemProviders=new Map,this._documents=new $t,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new L,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new L,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new L,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new L,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new _n("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=e.getProxy(Z.MainThreadNotebook),this._notebookDocumentsProxy=e.getProxy(Z.MainThreadNotebookDocuments),this._notebookEditorsProxy=e.getProxy(Z.MainThreadNotebookEditors),this._commandsConverter=t.converter,t.registerArgumentProcessor({processArgument:l=>{var c;if(l&&l.$mid===mt.NotebookCellActionContext){const u=(c=l.notebookEditor)==null?void 0:c.notebookUri,d=l.cell.handle,f=this._documents.get(u),p=f==null?void 0:f.getCell(d);if(p)return p.apiCell}if(l&&l.$mid===mt.NotebookActionContext){const u=l.uri,d=this._documents.get(u);if(d)return d.apiNotebook}return l}}),Wa._registerApiCommands(t)}getEditorById(e){const t=this._editors.get(e);if(!t)throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(const[t,n]of this._editors)if(n.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){const n=this._documents.get(e);if(!n&&!t)throw new Error(`NO notebook document for '${e}'`);return n}static _convertNotebookRegistrationData(e,t){if(!t)return;const n=t.filenamePattern.map(r=>Wg.from(r)).filter(r=>r!==void 0);if(t.filenamePattern&&!n){console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`);return}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:n,priority:t.exclusive?S0.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(e,t,n){const r=Wa._notebookStatusBarItemProviderHandlePool++,s=typeof n.onDidChangeCellStatusBarItems=="function"?Wa._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(r,n),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(r,s,t);let o;return s!==void 0&&(o=n.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(s))),new Qe(()=>{this._notebookStatusBarItemProviders.delete(r),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(r,s),o==null||o.dispose()})}async createNotebookDocument(e){const t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&Us.from(e.content)});return y.revive(t)}async openNotebookDocument(e){const t=this._documents.get(e);if(t)return t.apiNotebook;const n=await this._notebookDocumentsProxy.$tryOpenNotebook(e),r=this._documents.get(y.revive(n));return al(r==null?void 0:r.apiNotebook)}async showNotebookDocument(e,t){var o;y.isUri(e)&&(e=await this.openNotebookDocument(e));let n;typeof t=="object"?n={position:Kt.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(mr.from),pinned:typeof t.preview=="boolean"?!t.preview:void 0}:n={preserveFocus:!1};const r=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,e.notebookType,n),s=r&&((o=this._editors.get(r))==null?void 0:o.apiEditor);if(s)return s;throw r?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,n,r){const s=this._notebookStatusBarItemProviders.get(e),o=y.revive(t),a=this._documents.get(o);if(!a||!s)return;const l=a.getCellFromIndex(n);if(!l)return;const c=await s.provideCellStatusBarItems(l.apiCell,r);if(!c)return;const u=new Le,d=this._statusBarCache.add([u]),p=(Array.isArray(c)?c:[c]).map(b=>mw.from(b,this._commandsConverter,u));return{cacheId:d,items:p}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,t,n,r,s){if(yu(t))throw new Error("viewType cannot be empty or just whitespace");const o=this._handlePool++;return this._notebookSerializer.set(o,{viewType:t,serializer:n,options:r}),this._notebookProxy.$registerNotebookSerializer(o,{id:e.identifier,location:e.extensionLocation},t,vw.from(r),Wa._convertNotebookRegistrationData(e,s)),Me(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,t,n){const r=this._notebookSerializer.get(e);if(!r)throw new Error("NO serializer found");const s=await r.serializer.deserializeNotebook(t.buffer,n);return new un(Us.from(s))}async $notebookToData(e,t,n){const r=this._notebookSerializer.get(e);if(!r)throw new Error("NO serializer found");const s=await r.serializer.serializeNotebook(Us.to(t.value),n);return De.wrap(s)}async $saveNotebook(e,t,n,r,s){var b;const o=y.revive(t),a=this._notebookSerializer.get(e);if(this.trace(`enter saveNotebook(versionId: ${n}, ${o.toString()})`),!a)throw new Error("NO serializer found");const l=this._documents.get(o);if(!l)throw new Error("Document NOT found");if(l.versionId!==n)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme))throw new u_(h(4819,"Unable to modify read-only file '{0}'",this._resourceForError(o)),fn.FILE_PERMISSION_DENIED);const c={metadata:Zx(l.apiNotebook.metadata,w=>{var v;return!(((v=a.options)==null?void 0:v.transientDocumentMetadata)??{})[w]}),cells:[]};for(const w of l.apiNotebook.getCells()){const v=new lg(w.kind,w.document.getText(),w.document.languageId,w.mime,(b=a.options)!=null&&b.transientOutputs?[]:[...w.outputs],w.metadata,w.executionSummary);v.metadata=Zx(w.metadata,S=>{var k;return!(((k=a.options)==null?void 0:k.transientCellMetadata)??{})[S]}),c.cells.push(v)}if(await this._validateWriteFile(o,r),s.isCancellationRequested)throw new Error("canceled");const u=await a.serializer.serializeNotebook(c,s);if(s.isCancellationRequested)throw new Error("canceled");this.trace(`serialized versionId: ${n} ${o.toString()}`),await this._extHostFileSystem.value.writeFile(o,u),this.trace(`Finished write versionId: ${n} ${o.toString()}`);const d=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme),f=await this._extHostFileSystem.value.stat(o),p={name:d.basename(o),isFile:(f.type&Co.File)!==0,isDirectory:(f.type&Co.Directory)!==0,isSymbolicLink:(f.type&Co.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&fl.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&fl.Locked),etag:i2({mtime:f.mtime,size:f.size}),children:void 0};return this.trace(`exit saveNotebook(versionId: ${n}, ${o.toString()})`),p}async $searchInNotebooks(e,t,n,r,s){var f;const o=(f=this._notebookSerializer.get(e))==null?void 0:f.serializer;if(!o)return{limitHit:!1,results:[]};const a=new Ny;await(async(p,b,w)=>{await Promise.all(p.map(async v=>await Promise.all(v.filenamePatterns.map(S=>{const k={_reason:w._reason,folderQueries:w.folderQueries,includePattern:w.includePattern,excludePattern:w.excludePattern,maxResults:w.maxResults,type:fc.File,filePattern:S};return this._extHostSearch.doInternalFileSearchWithCustomCallback(k,b,C=>{C.forEach(N=>{a.has(N)||r.some(V=>v.isFromSettings&&!V.isFromSettings?!1:V.filenamePatterns.some(ae=>y3(ae,N)))||a.add(N)})}).catch(C=>{if(C.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw C})}))))})(n,s,t);const c=new $t;let u=!1;const d=Array.from(a).map(async p=>{const b=[];try{if(s.isCancellationRequested)return;if(t.maxResults&&[...c.values()].reduce((k,C)=>k+C.cellResults.length,0)>t.maxResults){u=!0;return}const w=[],v=this._documents.get(p);if(v)v.apiNotebook.getCells().forEach(C=>w.push({input:C.document.getText(),outputs:C.outputs.flatMap(N=>N.items.map(A=>A.data.toString()))}));else{const k=await this._extHostFileSystem.value.readFile(p),C=De.fromString(k.toString()),N=await o.deserializeNotebook(C.buffer,s);if(s.isCancellationRequested)return;Us.from(N).cells.forEach(V=>w.push({input:V.source,outputs:V.outputs.flatMap(ae=>ae.items.map(be=>be.valueBytes.toString()))}))}if(s.isCancellationRequested)return;w.forEach((k,C)=>{const N=t.contentPattern.pattern,A=new d3(k.input,void 0,k.outputs),V=A.findInInputs(N),ae=A.findInOutputs(N),be=ae.flatMap(Q=>Uk(Q.matches,Q.textBuffer)).map((Q,Ce)=>(Q.webviewIndex=Ce,Q));if(V.length>0||ae.length>0){const Q={index:C,contentResults:Uk(V,A.inputTextBuffer),webviewResults:be};b.push(Q)}});const S={resource:p,cellResults:b};c.set(p,S);return}catch{return}});return await Promise.all(d),{limitHit:u,results:[...c.values()]}}async _validateWriteFile(e,t){const n=await this._extHostFileSystem.value.stat(e);if(typeof(t==null?void 0:t.mtime)=="number"&&typeof t.etag=="string"&&t.etag!==e7&&typeof n.mtime=="number"&&typeof n.size=="number"&&t.mtime<n.mtime&&t.etag!==i2({mtime:t.mtime,size:n.size}))throw new u_(h(4820,"File Modified Since"),fn.FILE_MODIFIED_SINCE,t)}_resourceForError(e){return e.scheme===le.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,n){if(this._editors.has(t))throw new Error(`editor with id ALREADY EXSIST: ${t}`);const r=new Ih(t,this._notebookEditorsProxy,e,n.visibleRanges.map(mr.to),n.selections.map(mr.to),typeof n.viewColumn=="number"?Kt.to(n.viewColumn):void 0);this._editors.set(t,r)}$acceptDocumentAndEditorsDelta(e){var t,n,r;if(e.value.removedDocuments)for(const s of e.value.removedDocuments){const o=y.revive(s),a=this._documents.get(o);a&&(a.dispose(),this._documents.delete(o),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:a.apiNotebook.getCells().map(l=>l.document.uri)}),this._onDidCloseNotebookDocument.fire(a.apiNotebook));for(const l of this._editors.values())l.notebookData.uri.toString()===o.toString()&&this._editors.delete(l.id)}if(e.value.addedDocuments){const s=[];for(const o of e.value.addedDocuments){const a=y.revive(o.uri);if(this._documents.has(a))throw new Error(`adding EXISTING notebook ${a} `);const l=new m0(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,a,o);s.push(...o.cells.map(c=>g0.asModelAddData(c))),(t=this._documents.get(a))==null||t.dispose(),this._documents.set(a,l),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:s}),this._onDidOpenNotebookDocument.fire(l.apiNotebook)}}if(e.value.addedEditors)for(const s of e.value.addedEditors){if(this._editors.has(s.id))return;const o=y.revive(s.documentUri),a=this._documents.get(o);a&&this._createExtHostEditor(a,s.id,s)}if(e.value.removedEditors)for(const s of e.value.removedEditors){const o=this._editors.get(s);o&&(this._editors.delete(s),((n=this._activeNotebookEditor)==null?void 0:n.id)===o.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(o=>this._editors.get(o)).filter(o=>!!o);const s=new Set;this._visibleNotebookEditors.forEach(o=>s.add(o.id));for(const o of this._editors.values()){const a=s.has(o.id);o._acceptVisibility(a)}this._visibleNotebookEditors=[...this._editors.values()].map(o=>o).filter(o=>o.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}e.value.newActiveEditor===null?this._activeNotebookEditor=void 0:e.value.newActiveEditor&&(this._editors.get(e.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)),e.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire((r=this._activeNotebookEditor)==null?void 0:r.apiEditor)}static _registerApiCommands(e){const t=z.String.with("notebookType","A notebook type"),n=new Ee("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[t,new z("data","Bytes to convert to data",s=>s instanceof Uint8Array,s=>De.wrap(s))],new xe("Notebook Data",s=>Us.to(s.value))),r=new Ee("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[t,new z("NotebookData","Notebook data to convert to bytes",s=>!0,s=>new un(Us.from(s)))],new xe("Bytes",s=>s.buffer));e.registerApiCommand(n),e.registerApiCommand(r)}trace(e){this._logService.trace(`[Extension Host Notebook] ${e}`)}};Wa._notebookStatusBarItemProviderHandlePool=0;let D0=Wa;class x3{constructor(e,t,n,r={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=n,this._thresholds=r,this._onWillSaveNotebookDocumentEvent=new fu}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,n,r)=>{const s=function(a){t.call(n,a)};return s.extension=e,this._onWillSaveNotebookDocumentEvent.event(s,void 0,r)}}async $participateInSave(e,t,n){const r=y.revive(e),s=this._notebooksAndEditors.getNotebookDocument(r);if(!s)throw new Error("Unable to resolve notebook document");const o=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:s.apiNotebook,reason:$g.to(t)},n,async(l,c)=>{const u=Date.now(),d=await await Promise.resolve(l);Date.now()-u>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier),!n.isCancellationRequested&&d&&(d instanceof jo?o.push(d):this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier,"ignored due to invalid data"))}),n.isCancellationRequested)return!1;if(o.length===0)return!0;const a={edits:[]};for(const l of o){const{edits:c}=Mi.from(l);a.edits=a.edits.concat(c)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new un(a))}}class E3{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new L,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new L,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,n,r){const o=this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptModelChanged(t.value,n,r);this._onDidChangeNotebookDocument.fire(o)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(y.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}}let k0=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new L,this._onDidChangeNotebookEditorVisibleRanges=new L,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,t);const n=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&n._acceptVisibleRanges(t.visibleRanges.ranges.map(mr.to)),t.selections&&n._acceptSelections(t.selections.selections.map(mr.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:n.apiEditor,visibleRanges:n.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:n.apiEditor,selections:n.apiEditor.selections}))}$acceptEditorViewColumns(e){for(const t in e)this._notebooksAndEditors.getEditorById(t)._acceptViewColumn(Kt.to(e[t]))}};k0=B([O(0,rt)],k0);var Cc;(function(i){i[i.Output=1]="Output",i[i.OutputItems=2]="OutputItems",i[i.ExecutionState=3]="ExecutionState"})(Cc||(Cc={}));const S3=100;let C0=class{constructor(e,t,n,r,s){this._initData=t,this._extHostNotebook=n,this._commands=r,this._logService=s,this._activeExecutions=new $t,this._activeNotebookExecutions=new $t,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new L,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=e.getProxy(Z.MainThreadNotebookKernels);const o=new Ee("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new z("options","Select kernel options",l=>!0,l=>{if(l&&"notebookEditor"in l&&"id"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);return{id:l.id,extension:l.extension,notebookEditorId:c}}else if(l&&"notebookEditor"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);if(c===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${l.notebookEditor.notebook.uri.toString()}`);return{notebookEditorId:c}}return l})],xe.Void),a=new Ee("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[z.Uri],new xe("A promise that resolves to an array of variables",(l,c)=>l.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this._commands.registerApiCommand(o),this._commands.registerApiCommand(a)}createNotebookController(e,t,n,r,s,o){for(const A of this._kernelData.values())if(A.controller.id===t&&ot.equals(e.identifier,A.extensionId))throw new Error(`notebook controller with id '${t}' ALREADY exist`);const a=this._handlePool++,l=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${t}`);const c=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${e.identifier}'`);let u=!1;const d=new L,f=new L,p={id:Fm(e.identifier,t),notebookType:n,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:r||e.identifier.value,preloads:o?o.map(Vg.from):[]};let b=s??c,w,v;this._proxy.$addKernel(a,p).catch(A=>{console.log(A),u=!0});let S=0;const k=()=>{if(u)return;const A=++S;Promise.resolve().then(()=>{A===S&&this._proxy.$updateKernel(a,p)})},C=new $t,N={get id(){return t},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return p.label},set label(A){p.label=A??e.displayName??e.name,k()},get detail(){return p.detail??""},set detail(A){p.detail=A,k()},get description(){return p.description??""},set description(A){p.description=A,k()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(A){p.supportedLanguages=A,k()},get supportsExecutionOrder(){return p.supportsExecutionOrder??!1},set supportsExecutionOrder(A){p.supportsExecutionOrder=A,k()},get rendererScripts(){return p.preloads?p.preloads.map(Vg.to):[]},get executeHandler(){return b},set executeHandler(A){b=A??c},get interruptHandler(){return w},set interruptHandler(A){w=A,p.supportsInterrupt=!!A,k()},set variableProvider(A){M(e,"notebookVariableProvider"),v=A,p.hasVariableProvider=!!A,A==null||A.onDidChangeVariables(V=>l._proxy.$variablesUpdated(V.uri)),k()},get variableProvider(){return v},createNotebookCellExecution(A){if(u)throw new Error("notebook controller is DISPOSED");if(!C.has(A.notebook.uri))throw l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(C.keys()).map(V=>V.toString())),new Error(`notebook controller is NOT associated to notebook: ${A.notebook.uri.toString()}`);return l._createNotebookCellExecution(A,Fm(e.identifier,this.id))},createNotebookExecution(A){if(M(e,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!C.has(A.uri))throw l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(C.keys()).map(V=>V.toString())),new Error(`notebook controller is NOT associated to notebook: ${A.uri.toString()}`);return l._createNotebookExecution(A,Fm(e.identifier,this.id))},dispose:()=>{u||(this._logService.trace(`NotebookController[${a}], DISPOSED`),u=!0,this._kernelData.delete(a),d.dispose(),f.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(A,V){V===hg.Hidden&&M(e,"notebookControllerAffinityHidden"),l._proxy.$updateNotebookPriority(a,A.uri,V)},onDidReceiveMessage:f.event,postMessage(A,V){return M(e,"notebookMessaging"),l._proxy.$postMessage(a,V&&l._extHostNotebook.getIdByEditor(V),A)},asWebviewUri(A){return M(e,"notebookMessaging"),bh(A,l._initData.remote)}};return this._kernelData.set(a,{extensionId:e.identifier,controller:N,onDidReceiveMessage:f,onDidChangeSelection:d,associatedNotebooks:C}),N}getIdByController(e){for(const[t,n]of this._kernelData)if(n.controller===e)return Fm(n.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){const n=this._kernelDetectionTaskHandlePool++,r=this;this._logService.trace(`NotebookControllerDetectionTask[${n}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(n,t);const s={dispose:()=>{this._kernelDetectionTask.delete(n),r._proxy.$removeKernelDetectionTask(n)}};return this._kernelDetectionTask.set(n,s),s}registerKernelSourceActionProvider(e,t,n){const r=this._kernelSourceActionProviderHandlePool++,s=typeof n.onDidChangeNotebookKernelSourceActions=="function"?r:void 0,o=this;this._kernelSourceActionProviders.set(r,n),this._logService.trace(`NotebookKernelSourceActionProvider[${r}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(r,r,t);let a;return s!==void 0&&(a=n.onDidChangeNotebookKernelSourceActions(l=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(s))),{dispose:()=>{this._kernelSourceActionProviders.delete(r),o._proxy.$removeKernelSourceActionProvider(r,r),a==null||a.dispose()}}}async $provideKernelSourceActions(e,t){const n=this._kernelSourceActionProviders.get(e);if(n){const r=new Le;return(await n.provideNotebookKernelSourceActions(t)??[]).map(o=>_w.from(o,this._commands.converter,r))}return[]}$acceptNotebookAssociation(e,t,n){const r=this._kernelData.get(e);if(r){const s=this._extHostNotebook.getNotebookDocument(y.revive(t));n?r.associatedNotebooks.set(s.uri,!0):r.associatedNotebooks.delete(s.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,s.uri.toString(),n),r.onDidChangeSelection.fire({selected:n,notebook:s.apiNotebook})}}async $executeCells(e,t,n){const r=this._kernelData.get(e);if(!r)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(t)),o=[];for(const a of n){const l=s.getCell(a);l&&o.push(l.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,s.uri.toString(),o.length),await r.controller.executeHandler.call(r.controller,o,s.apiNotebook,r.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(e,t,n){var o;const r=this._kernelData.get(e);if(!r)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(t));if(r.controller.interruptHandler)await r.controller.interruptHandler.call(r.controller,s.apiNotebook);else for(const a of n){const l=s.getCell(a);l&&((o=this._activeExecutions.get(l.uri))==null||o.cancel())}if(r.controller.interruptHandler){const a=this._activeNotebookExecutions.get(s.uri);this._activeNotebookExecutions.delete(s.uri),n.length&&Array.isArray(a)&&a.length&&a.forEach(l=>l.dispose())}}async $provideVariables(e,t,n,r,s,o,a){const l=this._kernelData.get(e);if(!l)return;const c=this._extHostNotebook.getNotebookDocument(y.revive(n)),u=l.controller.variableProvider;if(!u)return;let d;if(r!==void 0){if(d=this.variableStore[r],!d)return}else this.variableStore={};const f=s==="named"?Rd.Named:Rd.Indexed,p=u.provideVariables(c.apiNotebook,d,f,o,a);let b=0;for await(const w of p){if(a.isCancellationRequested)return;const v={id:this.id++,name:w.variable.name,value:w.variable.value,type:w.variable.type,interfaces:w.variable.interfaces,language:w.variable.language,expression:w.variable.expression,hasNamedChildren:w.hasNamedChildren,indexedChildrenCount:w.indexedChildrenCount,extensionId:l.extensionId.value};if(this.variableStore[v.id]=w.variable,this._proxy.$receiveVariable(t,v),b++>=S3)return}}$acceptKernelMessageFromRenderer(e,t,n){const r=this._kernelData.get(e);if(!r)return;const s=this._extHostNotebook.getEditorById(t);r.onDidReceiveMessage.fire(Object.freeze({editor:s.apiEditor,message:n}))}$cellExecutionChanged(e,t,n){const s=this._extHostNotebook.getNotebookDocument(y.revive(e)).getCell(t);if(s){const o=n?gw.to(n):Yl.Idle;o!==void 0&&this._onDidChangeCellExecutionState.fire({cell:s.apiCell,state:o})}}_createNotebookCellExecution(e,t){if(e.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const r=this._extHostNotebook.getNotebookDocument(e.notebook.uri).getCellFromApiCell(e);if(!r)throw new Error("invalid cell");if(this._activeExecutions.has(r.uri))throw new Error(`duplicate execution for ${r.uri}`);const s=new I0(t,r,this._proxy);this._activeExecutions.set(r.uri,s);const o=s.onDidChangeState(()=>{s.state===Kn.Resolved&&(s.dispose(),o.dispose(),this._activeExecutions.delete(r.uri))});return s.asApiObject()}_createNotebookExecution(e,t){const n=this._extHostNotebook.getNotebookDocument(e.uri),r=e.getCells().find(a=>{const l=n.getCellFromApiCell(a);return l&&this._activeExecutions.has(l.uri)});if(r)throw new Error(`duplicate cell execution for ${r.document.uri}`);if(this._activeNotebookExecutions.has(n.uri))throw new Error(`duplicate notebook execution for ${n.uri}`);const s=new P0(t,n,this._proxy),o=s.onDidChangeState(()=>{s.state===ls.Resolved&&(s.dispose(),o.dispose(),this._activeNotebookExecutions.delete(n.uri))});return this._activeNotebookExecutions.set(n.uri,[s,o]),s.asApiObject()}};C0=B([O(4,rt)],C0);var Kn;(function(i){i[i.Init=0]="Init",i[i.Started=1]="Started",i[i.Resolved=2]="Resolved"})(Kn||(Kn={}));const l1=class l1 extends Re{get state(){return this._state}constructor(e,t,n){super(),this._cell=t,this._proxy=n,this._handle=l1.HANDLE++,this._onDidChangeState=new L,this.onDidChangeState=this._onDidChangeState.event,this._state=Kn.Init,this._tokenSource=this._register(new Qt),this._collector=new D3(10,r=>this.update(r)),this._executionOrder=t.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new un(t))}verifyStateForOutput(){if(this._state===Kn.Init)throw new Error("Must call start before modifying cell output");if(this._state===Kn.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw new Error("INVALID cell");return t.handle}validateAndConvertOutputs(e){return e.map(t=>{const n=cg.ensureUniqueMimeTypes(t.items,!0);return n===t.items?Hs.from(t):Hs.from({items:n,id:t.id,metadata:t.metadata})})}async updateOutputs(e,t,n){const r=this.cellIndexToHandle(t),s=this.validateAndConvertOutputs(fo(e));return this.updateSoon({editType:Cc.Output,cellHandle:r,append:n,outputs:s})}async updateOutputItems(e,t,n){return e=cg.ensureUniqueMimeTypes(fo(e),!0),this.updateSoon({editType:Cc.OutputItems,items:e.map(lc.from),outputId:t.id,append:n})}asApiObject(){const e=this;return Object.freeze({get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(n){e._executionOrder=n,e.update([{editType:Cc.ExecutionState,executionOrder:e._executionOrder}])},start(n){if(e._state===Kn.Resolved||e._state===Kn.Started)throw new Error("Cannot call start again");e._state=Kn.Started,e._onDidChangeState.fire(),e.update({editType:Cc.ExecutionState,runStartTime:n})},end(n,r,s){if(e._state===Kn.Resolved)throw new Error("Cannot call resolve twice");e._state=Kn.Resolved,e._onDidChangeState.fire(),e._collector.flush();const o=s?{message:s.message,stack:s.stack,location:s!=null&&s.location?{startLineNumber:s.location.start.line,startColumn:s.location.start.character,endLineNumber:s.location.end.line,endColumn:s.location.end.character}:void 0,uri:s.uri}:void 0;e._proxy.$completeExecution(e._handle,new un({runEndTime:r,lastRunSuccess:n,error:o}))},clearOutput(n){return e.verifyStateForOutput(),e.updateOutputs([],n,!1)},appendOutput(n,r){return e.verifyStateForOutput(),e.updateOutputs(n,r,!0)},replaceOutput(n,r){return e.verifyStateForOutput(),e.updateOutputs(n,r,!1)},appendOutputItems(n,r){return e.verifyStateForOutput(),e.updateOutputItems(n,r,!0)},replaceOutputItems(n,r){return e.verifyStateForOutput(),e.updateOutputItems(n,r,!1)}})}};l1.HANDLE=0;let I0=l1;var ls;(function(i){i[i.Init=0]="Init",i[i.Started=1]="Started",i[i.Resolved=2]="Resolved"})(ls||(ls={}));const c1=class c1 extends Re{get state(){return this._state}constructor(e,t,n){super(),this._notebook=t,this._proxy=n,this._handle=c1.HANDLE++,this._onDidChangeState=new L,this.onDidChangeState=this._onDidChangeState.event,this._state=ls.Init,this._tokenSource=this._register(new Qt),this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this._state===ls.Resolved||this._state===ls.Started)throw new Error("Cannot call start again");this._state=ls.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===ls.Resolved)throw new Error("Cannot call resolve twice");this._state=ls.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}})}};c1.HANDLE=0;let P0=c1;class D3{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new cl,this.startedTimer=Date.now(),Or(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}}function Fm(i,e){return`${i.value}/${e}`}class k3{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(Z.MainThreadNotebookRenderers)}$postRendererMessage(e,t,n){var s;const r=this._extHostNotebook.getEditorById(e);(s=this._rendererMessageEmitters.get(t))==null||s.fire({editor:r.apiEditor,message:n})}createRendererMessaging(e,t){var r,s;if(!((s=(r=e.contributes)==null?void 0:r.notebookRenderer)!=null&&s.some(o=>o.id===t)))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(o,a,l)=>this.getOrCreateEmitterFor(t).event(o,a,l),postMessage:(o,a)=>{Ih.apiEditorsToExtHost.has(o)&&([o,a]=[a,o]);const l=a&&Ih.apiEditorsToExtHost.get(a);return this.proxy.$postMessage(l==null?void 0:l.id,t,o)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new L({onDidRemoveLastListener:()=>{t==null||t.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}}class C3{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(Z.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,n){if(M(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,n),this.proxy.$registerProfileContentHandler(t,n.name,n.description,e.identifier.value),Me(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,n,r){const s=this.handlers.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.saveProfile(t,n,r)}async $readProfile(e,t,n){const r=this.handlers.get(e);if(!r)throw new Error(`Unknown handler with id: ${e}`);return r.readProfile(Ge(t)?t:y.revive(t),n)}}function zk(i){return(e,t,n)=>{let r=null,s=null;if(typeof n.value=="function"?(r="value",s=n.value):typeof n.get=="function"&&(r="get",s=n.get),!s)throw new Error("not supported");n[r]=i(s,t)}}function qk(i,e,t){return zk((n,r)=>{const s=`$debounce$${r}`,o=`$debounce$result$${r}`;return function(...a){this[o]||(this[o]=void 0),clearTimeout(this[s]),this[s]=setTimeout(()=>{n.apply(this,a),this[o]=void 0},i)}})}function I3(i,e,t){return zk((n,r)=>{const s=`$throttle$timer$${r}`,o=`$throttle$result$${r}`,a=`$throttle$lastRun$${r}`,l=`$throttle$pending$${r}`;return function(...c){if(this[o]||(this[o]=t?t():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),e&&(this[o]=e(this[o],...c)),this[l])return;const u=this[a]+i;u<=Date.now()?(this[a]=Date.now(),n.apply(this,[this[o]]),this[o]=t?t():void 0):(this[l]=!0,this[s]=setTimeout(()=>{this[l]=!1,this[a]=Date.now(),n.apply(this,[this[o]]),this[o]=t?t():void 0},u-Date.now()))}})}class P3{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,n){const r=this._handles++,{title:s,location:o,cancellable:a}=t,l={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(r,{location:fw.from(o),title:s,source:l,cancellable:a},e.isUnderDevelopment?void 0:e.identifier.value).catch(D1),this._withProgress(r,n,!!a)}_withProgress(e,t,n){let r;n&&(r=new Qt,this._mapHandleToCancellationSource.set(e,r));const s=a=>{this._proxy.$progressEnd(a),this._mapHandleToCancellationSource.delete(a),r==null||r.dispose()};let o;try{o=t(new T0(this._proxy,e),n&&r?r.token:Nt.None)}catch(a){throw s(e),a}return o.then(a=>s(e),a=>s(e)),o}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}}function T3(i,e){return i.message=e.message,typeof e.increment=="number"&&(typeof i.increment=="number"?i.increment+=e.increment:i.increment=e.increment),i}class T0 extends Ju{constructor(e,t){super(n=>this.throttledReport(n)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}T0.__decorator=B([I3(100,(i,e)=>T3(i,e),()=>Object.create(null))],T0.prototype,"throttledReport",null);const u1=class u1{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(Z.MainThreadQuickDiff)}$provideOriginalResource(e,t,n){const r=y.revive(t),s=this.providers.get(e);return s?xi(()=>s.provideOriginalResource(r,n)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(e,t,n,r){const s=u1.handlePool++;return this.providers.set(s,t),this.proxy.$registerQuickDiffProvider(s,ec.from(e,this.uriTransformer),n,r),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(s),this.providers.delete(s)}}}};u1.handlePool=0;let A0=u1;function A3(i,e,t){const n=i.getProxy(Z.MainThreadQuickOpen);class r{constructor(b,w){this._sessions=new Map,this._instances=0,this._workspace=b,this._commands=w}showQuickPick(b,w,v,S=Nt.None){this._onDidSelectItem=void 0;const k=Promise.resolve(w),C=++this._instances,N=n.$show(C,{title:v==null?void 0:v.title,placeHolder:v==null?void 0:v.placeHolder,matchOnDescription:v==null?void 0:v.matchOnDescription,matchOnDetail:v==null?void 0:v.matchOnDetail,ignoreFocusLost:v==null?void 0:v.ignoreFocusOut,canPickMany:v==null?void 0:v.canPickMany},S),A={},V=N.then(()=>A);return Promise.race([V,k]).then(ae=>{if(ae===A)return;const be=ii(b,"quickPickItemTooltip");return k.then(Q=>{const Ce=[];for(let Se=0;Se<Q.length;Se++){const J=Q[Se];if(typeof J=="string")Ce.push({label:J,handle:Se});else if(J.kind===Ad.Separator)Ce.push({type:"separator",label:J.label});else{J.tooltip&&!be&&console.warn(`Extension '${b.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${b.identifier.value}`);const q=J.iconPath?c(J.iconPath):void 0;Ce.push({label:J.label,iconPath:q==null?void 0:q.iconPath,iconClass:q==null?void 0:q.iconClass,description:J.description,detail:J.detail,picked:J.picked,alwaysShow:J.alwaysShow,tooltip:be?We.fromStrict(J.tooltip):void 0,handle:Se})}}return v&&typeof v.onDidSelectItem=="function"&&(this._onDidSelectItem=Se=>{v.onDidSelectItem(Q[Se])}),n.$setItems(C,Ce),N.then(Se=>{if(typeof Se=="number")return Q[Se];if(Array.isArray(Se))return Se.map(J=>Q[J])})})}).then(void 0,ae=>{if(!uo(ae))return n.$setError(C,ae),Promise.reject(ae)})}$onItemSelected(b){var w;(w=this._onDidSelectItem)==null||w.call(this,b)}showInput(b,w=Nt.None){return this._validateInput=b==null?void 0:b.validateInput,n.$input(b,typeof this._validateInput=="function",w).then(void 0,v=>{if(!uo(v))return Promise.reject(v)})}async $validateInput(b){if(!this._validateInput)return;const w=await this._validateInput(b);if(!w||typeof w=="string")return w;let v;switch(w.severity){case Xl.Info:v=Vt.Info;break;case Xl.Warning:v=Vt.Warning;break;case Xl.Error:v=Vt.Error;break;default:v=w.message?Vt.Error:Vt.Ignore;break}return{content:w.message,severity:v}}async showWorkspaceFolderPick(b,w=Nt.None){const v=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[b]);if(!v)return;const S=await this._workspace.getWorkspaceFolders2();if(S)return S.find(k=>k.uri.toString()===v.uri.toString())}createQuickPick(b){const w=new u(b,()=>this._sessions.delete(w._id));return this._sessions.set(w._id,w),w}createInputBox(b){const w=new d(b,()=>this._sessions.delete(w._id));return this._sessions.set(w._id,w),w}$onDidChangeValue(b,w){const v=this._sessions.get(b);v==null||v._fireDidChangeValue(w)}$onDidAccept(b){const w=this._sessions.get(b);w==null||w._fireDidAccept()}$onDidChangeActive(b,w){const v=this._sessions.get(b);v instanceof u&&v._fireDidChangeActive(w)}$onDidChangeSelection(b,w){const v=this._sessions.get(b);v instanceof u&&v._fireDidChangeSelection(w)}$onDidTriggerButton(b,w){const v=this._sessions.get(b);v==null||v._fireDidTriggerButton(w)}$onDidTriggerItemButton(b,w,v){const S=this._sessions.get(b);S instanceof u&&S._fireDidTriggerItemButton(w,v)}$onDidHide(b){const w=this._sessions.get(b);w==null||w._fireDidHide()}}const f=class f{constructor(b,w){this._extension=b,this._onDidDispose=w,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new L,this._onDidChangeValueEmitter=new L,this._onDidTriggerButtonEmitter=new L,this._onDidHideEmitter=new L,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(b){this._title=b,this.update({title:b})}get step(){return this._steps}set step(b){this._steps=b,this.update({step:b})}get totalSteps(){return this._totalSteps}set totalSteps(b){this._totalSteps=b,this.update({totalSteps:b})}get enabled(){return this._enabled}set enabled(b){this._enabled=b,this.update({enabled:b})}get busy(){return this._busy}set busy(b){this._busy=b,this.update({busy:b})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(b){this._ignoreFocusOut=b,this.update({ignoreFocusOut:b})}get value(){return this._value}set value(b){this._value=b,this.update({value:b})}get placeholder(){return this._placeholder}set placeholder(b){this._placeholder=b,this.update({placeholder:b})}get buttons(){return this._buttons}set buttons(b){const w=ii(this._extension,"quickInputButtonLocation");!w&&b.some(v=>v.location)&&console.warn(`Extension '${this._extension.identifier.value}' uses a button location which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`),this._buttons=b.slice(),this._handlesToButtons.clear(),b.forEach((v,S)=>{const k=v===Td.Back?-1:S;this._handlesToButtons.set(k,v)}),this.update({buttons:b.map((v,S)=>({...c(v.iconPath),tooltip:v.tooltip,handle:v===Td.Back?-1:S,location:w?v.location:void 0}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(b){this._value=b,this._onDidChangeValueEmitter.fire(b)}_fireDidTriggerButton(b){const w=this._handlesToButtons.get(b);w&&this._onDidTriggerButtonEmitter.fire(w)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=Ar(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),n.$dispose(this._id))}update(b){if(!this._disposed){for(const w of Object.keys(b)){const v=b[w];this._pendingUpdate[w]=v===void 0?null:v}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){n.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}};f._nextId=1;let s=f;function o(p){if(p instanceof Oi)return{id:p.id};const b=l(p),w=a(p);return{dark:typeof b=="string"?y.file(b):b,light:typeof w=="string"?y.file(w):w}}function a(p){return typeof p=="object"&&"light"in p?p.light:p}function l(p){return typeof p=="object"&&"dark"in p?p.dark:p}function c(p){const b=o(p);let w,v;return"id"in b?v=Si.asClassName(b):w=b,{iconPath:w,iconClass:v}}class u extends s{constructor(b,w){super(b,w),this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new L,this._selectedItems=[],this._onDidChangeSelectionEmitter=new L,this._onDidTriggerItemButtonEmitter=new L,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(b){var S;this._items=b.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),b.forEach((k,C)=>{this._handlesToItems.set(C,k),this._itemsToHandles.set(k,C)});const w=ii(this._extension,"quickPickItemTooltip"),v=[];for(let k=0;k<b.length;k++){const C=b[k];if(C.kind===Ad.Separator)v.push({type:"separator",label:C.label});else{C.tooltip&&!w&&console.warn(`Extension '${this._extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`);const N=C.iconPath?c(C.iconPath):void 0;v.push({handle:k,label:C.label,iconPath:N==null?void 0:N.iconPath,iconClass:N==null?void 0:N.iconClass,description:C.description,detail:C.detail,picked:C.picked,alwaysShow:C.alwaysShow,tooltip:w?We.fromStrict(C.tooltip):void 0,buttons:(S=C.buttons)==null?void 0:S.map((A,V)=>({...c(A.iconPath),tooltip:A.tooltip,handle:V}))})}}this.update({items:v})}get canSelectMany(){return this._canSelectMany}set canSelectMany(b){this._canSelectMany=b,this.update({canSelectMany:b})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(b){this._matchOnDescription=b,this.update({matchOnDescription:b})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(b){this._matchOnDetail=b,this.update({matchOnDetail:b})}get sortByLabel(){return this._sortByLabel}set sortByLabel(b){this._sortByLabel=b,this.update({sortByLabel:b})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(b){this._keepScrollPosition=b,this.update({keepScrollPosition:b})}get activeItems(){return this._activeItems}set activeItems(b){this._activeItems=b.filter(w=>this._itemsToHandles.has(w)),this.update({activeItems:this._activeItems.map(w=>this._itemsToHandles.get(w))})}get selectedItems(){return this._selectedItems}set selectedItems(b){this._selectedItems=b.filter(w=>this._itemsToHandles.has(w)),this.update({selectedItems:this._selectedItems.map(w=>this._itemsToHandles.get(w))})}_fireDidChangeActive(b){const w=Ti(b.map(v=>this._handlesToItems.get(v)));this._activeItems=w,this._onDidChangeActiveEmitter.fire(w)}_fireDidChangeSelection(b){const w=Ti(b.map(v=>this._handlesToItems.get(v)));this._selectedItems=w,this._onDidChangeSelectionEmitter.fire(w)}_fireDidTriggerItemButton(b,w){const v=this._handlesToItems.get(b);if(!v||!v.buttons||!v.buttons.length)return;const S=v.buttons[w];S&&this._onDidTriggerItemButtonEmitter.fire({button:S,item:v})}}class d extends s{constructor(b,w){super(b,w),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(b){this._password=b,this.update({password:b})}get prompt(){return this._prompt}set prompt(b){this._prompt=b,this.update({prompt:b})}get valueSelection(){return this._valueSelection}set valueSelection(b){this._valueSelection=b,this.update({valueSelection:b})}get validationMessage(){return this._validationMessage}set validationMessage(b){this._validationMessage=b,b?typeof b=="string"?this.update({validationMessage:b,severity:Vt.Error}):this.update({validationMessage:b.message,severity:b.severity??Vt.Error}):this.update({validationMessage:void 0,severity:Vt.Ignore})}}return new r(e,t)}const jk=new yt(()=>{const i=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:i,collatorIsNumeric:i.resolvedOptions().numeric}});function R3(i,e,t=!1){const n=i||"",r=e||"",s=jk.value.collator.compare(n,r);return jk.value.collatorIsNumeric&&s===0&&n!==r?n<r?-1:1:s}function L3(i,e,t=!1){return t||(i=i&&i.toLowerCase(),e=e&&e.toLowerCase()),i===e?0:i<e?-1:1}function Mm(i,e,t=!1){const n=i.split(Ln),r=e.split(Ln),s=n.length-1,o=r.length-1;let a,l;for(let c=0;;c++){if(a=s===c,l=o===c,a&&l)return R3(n[c],r[c],t);if(a)return-1;if(l)return 1;const u=L3(n[c],r[c],t);if(u!==0)return u}}var R0;function Gk(i){return i instanceof y}function N3(i,e){return i.scheme===le.file&&e.scheme===le.file&&ws?i.toString()===e.toString():i.toString().toLowerCase()===e.toString().toLowerCase()}function L0(i){if(i)return typeof i.iconPath=="string"?y.file(i.iconPath):y.isUri(i.iconPath)||Si.isThemeIcon(i.iconPath)?i.iconPath:void 0}function Qk(i){if(i){if(y.isUri(i))return i;if(Si.isThemeIcon(i))return i;{const e=i;return{light:e.light,dark:e.dark}}}else return}function N0(i){var n;const e=Qk(i.icon),t=(n=i.labels)==null?void 0:n.map(r=>({title:r.title,icon:Qk(r.icon)}));return{...i,icon:e,labels:t}}function O0(i,e){if(!i.iconPath&&!e.iconPath)return 0;if(i.iconPath){if(!e.iconPath)return 1}else return-1;const t=typeof i.iconPath=="string"?i.iconPath:y.isUri(i.iconPath)?i.iconPath.fsPath:i.iconPath.id,n=typeof e.iconPath=="string"?e.iconPath:y.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return Mm(t,n)}function O3(i,e){let t=0;if(i.strikeThrough!==e.strikeThrough)return i.strikeThrough?1:-1;if(i.faded!==e.faded)return i.faded?1:-1;if(i.tooltip!==e.tooltip)return(i.tooltip||"").localeCompare(e.tooltip||"");if(t=O0(i,e),t!==0)return t;if(i.light&&e.light)t=O0(i.light,e.light);else{if(i.light)return 1;if(e.light)return-1}if(t!==0)return t;if(i.dark&&e.dark)t=O0(i.dark,e.dark);else{if(i.dark)return 1;if(e.dark)return-1}return t}function F3(i,e){if(i.command!==e.command)return i.command<e.command?-1:1;if(i.title!==e.title)return i.title<e.title?-1:1;if(i.tooltip!==e.tooltip){if(i.tooltip!==void 0&&e.tooltip!==void 0)return i.tooltip<e.tooltip?-1:1;if(i.tooltip!==void 0)return 1;if(e.tooltip!==void 0)return-1}if(i.arguments===e.arguments)return 0;if(i.arguments)if(e.arguments){if(i.arguments.length!==e.arguments.length)return i.arguments.length-e.arguments.length}else return 1;else return-1;for(let t=0;t<i.arguments.length;t++){const n=i.arguments[t],r=e.arguments[t];if(n!==r&&!(Gk(n)&&Gk(r)&&N3(n,r)))return n<r?-1:1}return 0}function Jk(i,e){let t=Mm(i.resourceUri.fsPath,e.resourceUri.fsPath,!0);if(t!==0)return t;if(i.command&&e.command)t=F3(i.command,e.command);else{if(i.command)return 1;if(e.command)return-1}if(t!==0)return t;if(i.decorations&&e.decorations)t=O3(i.decorations,e.decorations);else{if(i.decorations)return 1;if(e.decorations)return-1}if(i.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri)t=Mm(i.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(i.multiFileDiffEditorModifiedUri)return 1;if(e.multiFileDiffEditorModifiedUri)return-1}if(i.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri)t=Mm(i.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,!0);else{if(i.multiDiffEditorOriginalUri)return 1;if(e.multiDiffEditorOriginalUri)return-1}return t}function M3(i,e){for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}function $3(i,e){return i.command===e.command&&i.title===e.title&&i.tooltip===e.tooltip&&(i.arguments&&e.arguments?M3(i.arguments,e.arguments):i.arguments===e.arguments)}function U3(i,e){return Tr(i,e,$3)}class H3{constructor(e,t,n,r,s){me(this,Dr);me(this,Jh);this._extension=e,this._sourceControlHandle=r,this._documentUri=s,this._value="",this._onDidChange=new L,this._placeholder="",this._enabled=!0,this._visible=!0,te(this,Jh,t),te(this,Dr,n)}get value(){return this._value}set value(e){e=e??"",I(this,Dr).$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){I(this,Dr).$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return M(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if(M(this._extension,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,I(this,Dr).$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,I(this,Dr).$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,I(this,Dr).$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return M(this._extension,"scmTextDocument"),I(this,Jh).getDocument(this._documentUri)}showValidationMessage(e,t){M(this._extension,"scmValidation"),I(this,Dr).$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}}Dr=new WeakMap,Jh=new WeakMap;const d1=class d1{get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(e,t,n,r,s,o,a){this._proxy=e,this._commands=t,this._sourceControlHandle=n,this._id=r,this._label=s,this.multiDiffEditorEnableViewChanges=o,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new L,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new L,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._hideWhenEmpty=void 0,this.handle=d1._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){const n=this._resourceStatesCommandsMap.get(e);return n?xi(()=>this._commands.executeCommand(n.command,...n.arguments||[],t)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){var o;const e=[...this._resourceStates].sort(Jk),n=Cy(this._resourceSnapshot,e,Jk).map(a=>{const l=a.toInsert.map(c=>{const u=this._resourceHandlePool++;this._resourceStatesMap.set(u,c);const d=c.resourceUri;let f;if(c.command)if(c.command.command==="vscode.open"||c.command.command==="vscode.diff"||c.command.command==="vscode.changes"){const Q=new Le;f=this._commands.converter.toInternal(c.command,Q),this._resourceStatesDisposablesMap.set(u,Q)}else this._resourceStatesCommandsMap.set(u,c.command);const p=ii(this._extension,"scmMultiDiffEditor"),b=p?c.multiDiffEditorOriginalUri:void 0,w=p?c.multiFileDiffEditorModifiedUri:void 0,v=L0(c.decorations),S=c.decorations&&L0(c.decorations.light)||v,k=c.decorations&&L0(c.decorations.dark)||v,C=[S,k],N=c.decorations&&c.decorations.tooltip||"",A=c.decorations&&!!c.decorations.strikeThrough,V=c.decorations&&!!c.decorations.faded,ae=c.contextValue||"";return{rawResource:[u,d,C,N,A,V,ae,f,b,w],handle:u}});return{start:a.start,deleteCount:a.deleteCount,toInsert:l}}),r=n.map(({start:a,deleteCount:l,toInsert:c})=>[a,l,c.map(u=>u.rawResource)]),s=n.reverse();for(const{start:a,deleteCount:l,toInsert:c}of s){const u=c.map(f=>f.handle),d=this._handlesSnapshot.splice(a,l,...u);for(const f of d)this._resourceStatesMap.delete(f),this._resourceStatesCommandsMap.delete(f),(o=this._resourceStatesDisposablesMap.get(f))==null||o.dispose(),this._resourceStatesDisposablesMap.delete(f)}return this._resourceSnapshot=e,r}dispose(){this._disposed=!0,this._onDidDispose.fire()}};d1._handlePool=0;let F0=d1;const h1=class h1{constructor(e,t,n,r,s,o,a){me(this,pi);this._extension=e,this._commands=r,this._id=s,this._label=o,this._rootUri=a,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._historyProviderDisposable=new po,this._commitTemplate=void 0,this._acceptInputDisposables=new po,this._acceptInputCommand=void 0,this._actionButtonDisposables=new po,this._statusBarDisposables=new po,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new L,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=h1._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,te(this,pi,n);const l=y.from({scheme:le.vscodeSourceControl,path:`${s}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new H3(e,t,I(this,pi),this.handle,l),I(this,pi).$registerSourceControl(this.handle,s,o,a,l)}get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,I(this,pi).$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let t;ii(this._extension,"quickDiffProvider")&&(t=e==null?void 0:e.label),I(this,pi).$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get historyProvider(){return M(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(e){M(this._extension,"scmHistoryProvider"),this._historyProvider=e,this._historyProviderDisposable.value=new Le,I(this,pi).$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemGroup(()=>{this._historyProviderCurrentHistoryItemGroup=e==null?void 0:e.currentHistoryItemGroup,I(this,pi).$onDidChangeHistoryProviderCurrentHistoryItemGroup(this.handle,this._historyProviderCurrentHistoryItemGroup)}))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,I(this,pi).$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new Le,this._acceptInputCommand=e;const t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);I(this,pi).$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return M(this._extension,"scmActionButton"),this._actionButton}set actionButton(e){var n;M(this._extension,"scmActionButton"),this._actionButtonDisposables.value=new Le,this._actionButton=e;const t=e!==void 0?{command:this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),secondaryCommands:(n=e.secondaryCommands)==null?void 0:n.map(r=>r.map(s=>this._commands.converter.toInternal(s,this._actionButtonDisposables.value))),description:e.description,enabled:e.enabled}:void 0;I(this,pi).$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&U3(this._statusBarCommands,e))return;this._statusBarDisposables.value=new Le,this._statusBarCommands=e;const t=(e||[]).map(n=>this._commands.converter.toInternal(n,this._statusBarDisposables.value));I(this,pi).$updateSourceControl(this.handle,{statusBarCommands:t})}get selected(){return this._selected}createResourceGroup(e,t,n){const r=ii(this._extension,"scmMultiDiffEditor")&&(n==null?void 0:n.multiDiffEditorEnableViewChanges)===!0,s=new F0(I(this,pi),this._commands,this.handle,e,t,r,this._extension),o=Ht.once(s.onDidDispose)(()=>this.createdResourceGroups.delete(s));return this.createdResourceGroups.set(s,o),this.eventuallyAddResourceGroups(),s}eventuallyAddResourceGroups(){const e=[],t=[];for(const[n,r]of this.createdResourceGroups){r.dispose();const s=n.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(n),this.eventuallyUpdateResourceStates()});Ht.once(n.onDidDispose)(()=>{this.updatedResourceGroups.delete(n),s.dispose(),this._groups.delete(n.handle),I(this,pi).$unregisterGroup(this.handle,n.handle)}),e.push([n.handle,n.id,n.label,n.features,n.multiDiffEditorEnableViewChanges]);const o=n._takeResourceStateSnapshot();o.length>0&&t.push([n.handle,o]),this._groups.set(n.handle,n)}I(this,pi).$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(t=>{const n=t._takeResourceStateSnapshot();n.length!==0&&e.push([t.handle,n])}),e.length>0&&I(this,pi).$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(e=>e.dispose()),I(this,pi).$unregisterSourceControl(this.handle)}};pi=new WeakMap,h1._handlePool=0;let wa=h1;wa.__decorator=B([qk(100)],wa.prototype,"eventuallyAddResourceGroups",null),wa.__decorator=B([qk(100)],wa.prototype,"eventuallyUpdateResourceStates",null);let M0=(Va=class{get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,n,r){this._commands=t,this._extHostDocuments=n,this.logService=r,this._sourceControls=new Map,this._sourceControlsByExtension=new Vr,this._onDidChangeActiveProvider=new L,this._proxy=e.getProxy(Z.MainThreadSCM),this._telemetry=e.getProxy(Z.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:s=>{if(s&&s.$mid===mt.ScmResource){const o=this._sourceControls.get(s.sourceControlHandle);if(!o)return s;const a=o.getResourceGroup(s.groupHandle);return a?a.getResourceState(s.handle):s}else if(s&&s.$mid===mt.ScmResourceGroup){const o=this._sourceControls.get(s.sourceControlHandle);return o?o.getResourceGroup(s.groupHandle):s}else if(s&&s.$mid===mt.ScmProvider){const o=this._sourceControls.get(s.handle);return o||s}return s}})}createSourceControl(e,t,n,r){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,t,n,r),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const s=R0._handlePool++,o=new wa(e,this._extHostDocuments,this._proxy,this._commands,t,n,r);this._sourceControls.set(s,o);const a=this._sourceControlsByExtension.get(e.identifier)||[];return a.push(o),this._sourceControlsByExtension.set(e.identifier,a),o}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const t=this._sourceControlsByExtension.get(e.identifier),n=t&&t[t.length-1];return n&&n.inputBox}$provideOriginalResource(e,t,n){const r=y.revive(t);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,r.toString());const s=this._sourceControls.get(e);return!s||!s.quickDiffProvider||!s.quickDiffProvider.provideOriginalResource?Promise.resolve(null):xi(()=>s.quickDiffProvider.provideOriginalResource(r,n)).then(o=>o||null)}$onInputBoxValueChange(e,t){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const n=this._sourceControls.get(e);return n&&n.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)}$executeResourceCommand(e,t,n,r){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,t,n);const s=this._sourceControls.get(e);if(!s)return Promise.resolve(void 0);const o=s.getResourceGroup(t);return o?o.$executeResourceCommand(n,r):Promise.resolve(void 0)}$validateInput(e,t,n){this.logService.trace("ExtHostSCM#$validateInput",e);const r=this._sourceControls.get(e);return!r||!r.inputBox.validateInput?Promise.resolve(void 0):xi(()=>r.inputBox.validateInput(t,n)).then(s=>{if(!s)return Promise.resolve(void 0);const o=We.fromStrict(s.message);return o?Promise.resolve([o,s.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(e){var t,n;return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e),e!==void 0&&((t=this._sourceControls.get(e))==null||t.setSelectionState(!0)),this._selectedSourceControlHandle!==void 0&&((n=this._sourceControls.get(this._selectedSourceControlHandle))==null||n.setSelectionState(!1)),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemGroupCommonAncestor(e,t,n,r){var o;const s=(o=this._sourceControls.get(e))==null?void 0:o.historyProvider;return await(s==null?void 0:s.resolveHistoryItemGroupCommonAncestor(t,n,r))??void 0}async $resolveHistoryItemGroupCommonAncestor2(e,t,n){var s;const r=(s=this._sourceControls.get(e))==null?void 0:s.historyProvider;return await(r==null?void 0:r.resolveHistoryItemGroupCommonAncestor2(t,n))??void 0}async $provideHistoryItems(e,t,n,r){var a;const s=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider,o=await(s==null?void 0:s.provideHistoryItems(t,n,r));return(o==null?void 0:o.map(l=>N0(l)))??void 0}async $provideHistoryItems2(e,t,n){var o;const r=(o=this._sourceControls.get(e))==null?void 0:o.historyProvider,s=await(r==null?void 0:r.provideHistoryItems2(t,n));return(s==null?void 0:s.map(a=>N0(a)))??void 0}async $provideHistoryItemSummary(e,t,n,r){var a;const s=(a=this._sourceControls.get(e))==null?void 0:a.historyProvider;if(typeof(s==null?void 0:s.provideHistoryItemSummary)!="function")return;const o=await s.provideHistoryItemSummary(t,n,r);return o?N0(o):void 0}async $provideHistoryItemChanges(e,t,n,r){var o;const s=(o=this._sourceControls.get(e))==null?void 0:o.historyProvider;return await(s==null?void 0:s.provideHistoryItemChanges(t,n,r))??void 0}},R0=Va,Va._handlePool=0,Va);M0=R0=B([O(3,rt)],M0);const f1=class f1{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(Z.MainThreadShare)}async $provideShare(e,t,n){const r=this.providers.get(e);return await(r==null?void 0:r.provideShare({selection:H.to(t.selection),resourceUri:y.revive(t.resourceUri)},n))??void 0}registerShareProvider(e,t){const n=f1.handlePool++;return this.providers.set(n,t),this.proxy.$registerShareProvider(n,ec.from(e,this.uriTransformer),t.id,t.label,t.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(n),this.providers.delete(n)}}}};f1.handlePool=0;let $0=f1;const p1=class p1{constructor(e){this.providers=new Map,this.sessions=new Map,this.synthesizers=new Map,this.proxy=e.getProxy(Z.MainThreadSpeech)}async $createSpeechToTextSession(e,t,n){const r=this.providers.get(e);if(!r)return;const s=new Le,o=new Qt;this.sessions.set(t,o);const a=await r.provideSpeechToTextSession(o.token,n?{language:n}:void 0);a&&(s.add(a.onDidChange(l=>{o.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,l)})),s.add(o.token.onCancellationRequested(()=>s.dispose())))}async $cancelSpeechToTextSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}async $createTextToSpeechSession(e,t,n){const r=this.providers.get(e);if(!r)return;const s=new Le,o=new Qt;this.sessions.set(t,o);const a=await r.provideTextToSpeechSession(o.token,n?{language:n}:void 0);a&&(this.synthesizers.set(t,a),s.add(a.onDidChange(l=>{o.token.isCancellationRequested||this.proxy.$emitTextToSpeechEvent(t,l)})),s.add(o.token.onCancellationRequested(()=>s.dispose())))}async $synthesizeSpeech(e,t){var n;(n=this.synthesizers.get(e))==null||n.synthesize(t)}async $cancelTextToSpeechSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e),this.synthesizers.delete(e)}async $createKeywordRecognitionSession(e,t){const n=this.providers.get(e);if(!n)return;const r=new Le,s=new Qt;this.sessions.set(t,s);const o=await n.provideKeywordRecognitionSession(s.token);o&&(r.add(o.onDidChange(a=>{s.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,a)})),r.add(s.token.onCancellationRequested(()=>r.dispose())))}async $cancelKeywordRecognitionSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}registerProvider(e,t,n){const r=p1.ID_POOL++;return this.providers.set(r,n),this.proxy.$registerProvider(r,t,{extension:e,displayName:e.value}),Me(()=>{this.proxy.$unregisterProvider(r),this.providers.delete(r)})}};p1.ID_POOL=1;let U0=p1;const za=class za{constructor(e,t,n,r,s,o=Os.Left,a){me(this,zc);me(this,qc);if(this._disposed=!1,this._text="",this._staleCommandRegistrations=new Le,te(this,zc,e),te(this,qc,t),s&&r){this._entryId=D8(r.identifier,s);const l=n.get(this._entryId);l&&(o=l.alignLeft?Os.Left:Os.Right,a=l.priority,this._visible=!0,this.name=l.name,this.text=l.text,this.tooltip=l.tooltip,this.command=l.command,this.accessibilityInformation=l.accessibilityInformation)}else this._entryId=String(za.ID_GEN++);this._extension=r,this._id=s,this._alignment=o,this._priority=this.validatePriority(a)}validatePriority(e){if(Ds(e))return e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){var e;return(e=this._command)==null?void 0:e.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(e){e&&!za.ALLOWED_BACKGROUND_COLORS.has(e.id)&&(e=void 0),this._backgroundColor=e,this.update()}set command(e){var t;((t=this._command)==null?void 0:t.fromApi)!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new Le,typeof e=="string"?this._command={fromApi:e,internal:I(this,qc).toInternal({title:"",command:e},this._latestCommandRegistration)}:e?this._command={fromApi:e,internal:I(this,qc).toInternal(e,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,I(this,zc).$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{var s,o;this._timeoutHandle=void 0;let e;this._extension?this._id?e=`${this._extension.identifier.value}.${this._id}`:e=this._extension.identifier.value:e=this._id;let t;this._name?t=this._name:t=h(4821,"{0} (Extension)",this._extension.displayName||this._extension.name);let n=this._color;this._backgroundColor&&(n=za.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));const r=We.fromStrict(this._tooltip);I(this,zc).$setEntry(this._entryId,e,(s=this._extension)==null?void 0:s.identifier.value,t,this._text,r,(o=this._command)==null?void 0:o.internal,n,this._backgroundColor,this._alignment===Os.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){this.hide(),this._disposed=!0}};zc=new WeakMap,qc=new WeakMap,za.ID_GEN=0,za.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new xd("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new xd("statusBarItem.warningForeground")]]);let H0=za;class B3{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",Os.Left,Number.MIN_VALUE),this._item.name=h(4822,"Extension Status")}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new Qe(()=>{const n=this._messages.indexOf(t);n>=0&&(this._messages.splice(n,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}}class W3{constructor(e,t){this._existingItems=new Map,this._proxy=e.getProxy(Z.MainThreadStatusBar),this._commands=t,this._statusMessage=new B3(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}createStatusBarEntry(e,t,n,r){return new H0(this._proxy,this._commands,this._existingItems,e,t,n,r)}setStatusBarMessage(e,t){const n=this._statusMessage.setMessage(e);let r;return typeof t=="number"?r=setTimeout(()=>n.dispose(),t):typeof t<"u"&&t.then(()=>n.dispose(),()=>n.dispose()),new Qe(()=>{n.dispose(),clearTimeout(r)})}}class V3 extends Re{constructor(e,t){super(),this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new L,this._onDidChangeTextEditorOptions=new L,this._onDidChangeTextEditorVisibleRanges=new L,this._onDidChangeTextEditorViewColumn=new L,this._onDidChangeActiveTextEditor=new L,this._onDidChangeVisibleTextEditors=new L,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(Z.MainThreadTextEditors),this._register(this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(n=>this._onDidChangeVisibleTextEditors.fire(n))),this._register(this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(n=>this._onDidChangeActiveTextEditor.fire(n)))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(n=>n.value)}async showTextDocument(e,t,n){let r;typeof t=="number"?r={position:Kt.from(t),preserveFocus:n}:typeof t=="object"?r={position:Kt.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?H.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:r={preserveFocus:!1};const s=await this._proxy.$tryShowTextDocument(e.uri,r),o=s&&this._extHostDocumentsAndEditors.getEditor(s);if(o)return o.value;throw s?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new Eb(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const n=this._extHostDocumentsAndEditors.getEditor(e);if(!n)throw new Error("unknown text editor");if(t.options&&n._acceptOptions(t.options),t.selections){const r=t.selections.selections.map(Qn.to);n._acceptSelections(r)}if(t.visibleRanges){const r=Ti(t.visibleRanges.map(H.to));n._acceptVisibleRanges(r)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:n.value,options:{...t.options,lineNumbers:sc.to(t.options.lineNumbers)}}),t.selections){const r=Hl.fromValue(t.selections.source),s=t.selections.selections.map(Qn.to);this._onDidChangeTextEditorSelection.fire({textEditor:n.value,selections:s,kind:r})}if(t.visibleRanges){const r=Ti(t.visibleRanges.map(H.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:n.value,visibleRanges:r})}}$acceptEditorPositionData(e){for(const t in e){const n=this._extHostDocumentsAndEditors.getEditor(t);if(!n)throw new Error("Unknown text editor");const r=Kt.to(e[t]);n.value.viewColumn!==r&&(n._acceptViewColumn(r),this._onDidChangeTextEditorViewColumn.fire({textEditor:n.value,viewColumn:r}))}}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let B0=class{constructor(e){this._actual=new ag(Fs.Dark),this._onDidChangeActiveColorTheme=new L}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case"light":t=Fs.Light;break;case"hcDark":t=Fs.HighContrast;break;case"hcLight":t=Fs.HighContrastLight;break;default:t=Fs.Dark}this._actual=new ag(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};B0=B([O(0,it)],B0);class z3{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(Z.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(n,r)=>{var s,o,a;if(n&&n.$mid===mt.TimelineActionContext)if(this._providers.get(n.source)&&ot.equals(r,(s=this._providers.get(n.source))==null?void 0:s.extension)){const l=n.uri===void 0?void 0:y.revive(n.uri);return(a=(o=this._itemsBySourceAndUriMap.get(n.source))==null?void 0:o.get(Xk(l)))==null?void 0:a.get(n.handle)}else return;return n}})}async $getTimeline(e,t,n,r){const s=this._providers.get(e);return s==null?void 0:s.provider.provideTimeline(y.revive(t),n,r)}registerTimelineProvider(e,t,n,r){const s=new Le,o=this.convertTimelineItem(t.id,r,s).bind(this);let a;t.onDidChange&&(a=t.onDidChange(c=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...c,id:t.id}),this));const l=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(c,u,d){var b;u!=null&&u.resetCache&&(s.clear(),(b=l.get(t.id))==null||b.clear());const f=await t.provideTimeline(c,u,d);if(f==null)return;const p=o(c,u);return{...f,source:t.id,items:f.items.map(p)}},dispose(){var c;for(const u of l.values())(c=u.get(t.id))==null||c.clear();a==null||a.dispose(),s.dispose()}},n)}convertTimelineItem(e,t,n){return(r,s)=>{let o;if(s!=null&&s.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);a===void 0&&(a=new Map,this._itemsBySourceAndUriMap.set(e,a));const l=Xk(r);o=a.get(l),o===void 0&&(o=new Map,a.set(l,o))}return a=>{const{iconPath:l,...c}=a,u=`${e}|${a.id??a.timestamp}`;o==null||o.set(u,a);let d,f,p;a.iconPath&&(l instanceof Oi?p={id:l.id,color:l.color}:y.isUri(l)?(d=l,f=l):{light:d,dark:f}=l);let b;return tn.isMarkdownString(c.tooltip)?b=We.from(c.tooltip):Ge(c.tooltip)?b=c.tooltip:tn.isMarkdownString(c.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),b=We.from(c.detail)):Ge(c.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),b=c.detail),{...c,id:c.id??void 0,handle:u,source:e,command:a.command?t.toInternal(a.command,n):void 0,icon:d,iconDark:f,themeIcon:p,tooltip:b,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),Me(()=>{var r;for(const s of this._itemsBySourceAndUriMap.values())(r=s.get(e.id))==null||r.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}}function Xk(i){return i==null?void 0:i.toString()}const q3={IconContribution:"base.contributions.icons"};var Yk;(function(i){function e(n){return{weight:n.weight,style:n.style,src:n.src.map(r=>({format:r.format,location:r.location.toString()}))}}i.toJSONObject=e;function t(n){const r=s=>Ge(s)?s:void 0;if(n&&Array.isArray(n.src)&&n.src.every(s=>Ge(s.format)&&Ge(s.location)))return{weight:r(n.weight),style:r(n.style),src:n.src.map(s=>({format:s.format,location:y.parse(s.location)}))}}i.fromJSONObject=t})(Yk||(Yk={}));class j3{constructor(){this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h(4397,"The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:h(4398,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Si.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,r){const s=this.iconsById[e];if(s){if(n&&!s.description){s.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=n),this._onDidChange.fire()}return s}const o={id:e,description:n,defaults:t,deprecationMessage:r};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return r&&(a.deprecationMessage=r),n&&(a.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];const t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){const n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(s,o)=>s.id.localeCompare(o.id),t=s=>{for(;Si.isThemeIcon(s.defaults);)s=this.iconsById[s.defaults.id];return`codicon codicon-${s?s.id:""}`},n=[];n.push("| preview     | identifier                        | default codicon ID                | description"),n.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const r=Object.keys(this.iconsById).map(s=>this.iconsById[s]);for(const s of r.filter(o=>!!o.description).sort(e))n.push(`|<i class="${t(s)}"></i>|${s.id}|${Si.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);n.push("| preview     | identifier                        "),n.push("| ----------- | --------------------------------- |");for(const s of r.filter(o=>!Si.isThemeIcon(o.defaults)).sort(e))n.push(`|<i class="${t(s)}"></i>|${s.id}|`);return n.join(`
`)}}const Lh=new j3;hi.add(q3.IconContribution,Lh);function $m(i,e,t,n){return Lh.registerIcon(i,e,t,n)}function G3(){const i=s7();for(const e in i){const t="\\"+i[e].toString(16);Lh.registerIcon(e,{fontCharacter:t})}}G3();const Kk="vscode://schemas/icons",Zk=hi.as(gp.JSONContribution);Zk.registerSchema(Kk,Lh.getIconSchema());const e5=new ll(()=>Zk.notifySchemaChanged(Kk),200);Lh.onDidChange(()=>{e5.isScheduled()||e5.schedule()}),$m("widget-close",_e.close,h(4399,"Icon for the close action in widgets.")),$m("goto-previous-location",_e.arrowUp,h(4400,"Icon for goto previous editor location.")),$m("goto-next-location",_e.arrowDown,h(4401,"Icon for goto next editor location.")),Si.modify(_e.sync,"spin"),Si.modify(_e.loading,"spin"),h(5291,"Views"),$m("default-view-icon",_e.window,h(5292,"Default view icon."));var Um;(function(i){i.ViewContainersRegistry="workbench.registry.view.containers",i.ViewsRegistry="workbench.registry.view"})(Um||(Um={}));var Nh;(function(i){i[i.Sidebar=0]="Sidebar",i[i.Panel=1]="Panel",i[i.AuxiliaryBar=2]="AuxiliaryBar"})(Nh||(Nh={})),Nh.Sidebar,Nh.Panel,Nh.AuxiliaryBar;class Q3 extends Re{constructor(){super(...arguments),this._onDidRegister=this._register(new L),this.onDidRegister=this._onDidRegister.event,this._onDidDeregister=this._register(new L),this.onDidDeregister=this._onDidDeregister.event,this.viewContainers=new Map,this.defaultViewContainers=[]}get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,n){const r=this.get(e.id);if(r)return r;const s=e;return s.openCommandActionDescriptor=n!=null&&n.doNotRegisterOpenCommand?void 0:s.openCommandActionDescriptor??{id:s.id},A5(this.viewContainers,t,[]).push(s),n!=null&&n.isDefault&&this.defaultViewContainers.push(s),this._onDidRegister.fire({viewContainer:s,viewContainerLocation:t}),s}deregisterViewContainer(e){for(const t of this.viewContainers.keys()){const n=this.viewContainers.get(t),r=n==null?void 0:n.indexOf(e);if(r!==-1){n==null||n.splice(r,1),n.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(n=>(n==null?void 0:n.id)===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}}hi.add(Um.ViewContainersRegistry,new Q3);var Hm;(function(i){i.Open="2_open",i.Debug="4_debug",i.SCM="5_scm",i.More="9_more"})(Hm||(Hm={}));function J3(i,e){const t=i.group??Hm.More,n=e.group??Hm.More;return t!==n?t.localeCompare(n):(i.order??5)-(e.order??5)}class X3 extends Re{constructor(){super(...arguments),this._onViewsRegistered=this._register(new L),this.onViewsRegistered=this._onViewsRegistered.event,this._onViewsDeregistered=this._register(new L),this.onViewsDeregistered=this._onViewsDeregistered.event,this._onDidChangeContainer=this._register(new L),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeViewWelcomeContent=this._register(new L),this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event,this._viewContainers=[],this._views=new Map,this._viewWelcomeContents=new Oy}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:n})=>this.addViews(t,n)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){const n=this.removeViews(e,t);n.length&&this._onViewsDeregistered.fire({views:n,viewContainer:t})}moveViews(e,t){for(const n of this._views.keys())if(n!==t){const r=this.removeViews(e,n);r.length&&(this.addViews(r,t),this._onDidChangeContainer.fire({views:r,from:n,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(const t of this._viewContainers){const n=(this._views.get(t)||[]).filter(r=>r.id===e)[0];if(n)return n}return null}getViewContainer(e){for(const t of this._viewContainers)if((this._views.get(t)||[]).filter(r=>r.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),Me(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){const n=new Map;for(const[r,s]of t)this._viewWelcomeContents.add(e,s),n.set(r,Me(()=>{this._viewWelcomeContents.delete(e,s),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),n}getViewWelcomeContent(e){const t=[];return this._viewWelcomeContents.forEach(e,n=>t.push(n)),t.sort(J3)}addViews(e,t){let n=this._views.get(t);n||(n=[],this._views.set(t,n),this._viewContainers.push(t));for(const r of e){if(this.getView(r.id)!==null)throw new Error(h(5293,"A view with id '{0}' is already registered",r.id));n.push(r)}}removeViews(e,t){const n=this._views.get(t);if(!n)return[];const r=[],s=[];for(const o of n)e.includes(o)?r.push(o):s.push(o);return r.length&&(s.length?this._views.set(t,s):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),r}}hi.add(Um.ViewsRegistry,new X3);var t5;(function(i){i[i.Default=0]="Default",i[i.Expand=1]="Expand"})(t5||(t5={}));var i5;(function(i){i[i.None=0]="None",i[i.Collapsed=1]="Collapsed",i[i.Expanded=2]="Expanded"})(i5||(i5={}));class cs extends Error{constructor(e){super(h(5294,"No tree view with id '{0}' registered.",e)),this.name="NoTreeViewError"}static is(e){return e.name==="NoTreeViewError"}}class Y3{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}}function n5(i,e){if(Ge(i))return{label:i};if(i&&typeof i=="object"&&typeof i.label=="string"){let t;return Array.isArray(i.highlights)&&(t=i.highlights.filter(n=>n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"),t=t.length?t:void 0),{label:i.label,highlights:t}}}class K3 extends Re{constructor(e,t,n){super(),this._proxy=e,this.commands=t,this.logService=n,this.treeViews=new Map,this.treeDragAndDropService=new Y3;function r(s){return s&&s.$treeViewId&&(s.$treeItemHandle||s.$selectedTreeItems||s.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:s=>r(s)?this.convertArgument(s):Array.isArray(s)&&s.length>0?s.map(o=>r(o)?this.convertArgument(o):o):s})}registerTreeDataProvider(e,t,n){const r=this.createTreeView(e,{treeDataProvider:t},n);return{dispose:()=>r.dispose()}}createTreeView(e,t,n){var f,p,b,w;if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const r=((f=t.dragAndDropController)==null?void 0:f.dropMimeTypes)??[],s=((p=t.dragAndDropController)==null?void 0:p.dragMimeTypes)??[],o=!!((b=t.dragAndDropController)!=null&&b.handleDrag),a=!!((w=t.dragAndDropController)!=null&&w.handleDrop),l=this.createExtHostTreeView(e,t,n),c={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:r,dragMimeTypes:s,hasHandleDrag:o,hasHandleDrop:a,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},u=this._proxy.$registerTreeViewDataProvider(e,c),d={get onDidCollapseElement(){return l.onDidCollapseElement},get onDidExpandElement(){return l.onDidExpandElement},get selection(){return l.selectedElements},get onDidChangeSelection(){return l.onDidChangeSelection},get activeItem(){return M(n,"treeViewActiveItem"),l.focusedElement},get onDidChangeActiveItem(){return M(n,"treeViewActiveItem"),l.onDidChangeActiveItem},get visible(){return l.visible},get onDidChangeVisibility(){return l.onDidChangeVisibility},get onDidChangeCheckboxState(){return l.onDidChangeCheckboxState},get message(){return l.message},set message(v){Io(v)&&M(n,"treeViewMarkdownMessage"),l.message=v},get title(){return l.title},set title(v){l.title=v},get description(){return l.description},set description(v){l.description=v},get badge(){return l.badge},set badge(v){v!==void 0&&bv.isViewBadge(v)?l.badge={value:Math.floor(Math.abs(v.value)),tooltip:v.tooltip}:v===void 0&&(l.badge=void 0)},reveal:(v,S)=>l.reveal(v,S),dispose:async()=>{await u,this.treeViews.delete(e),l.dispose()}};return this._register(d),d}$getChildren(e,t){const n=this.treeViews.get(e);return n?n.getChildren(t):Promise.reject(new cs(e))}async $handleDrop(e,t,n,r,s,o,a,l){const c=this.treeViews.get(e);if(!c)return Promise.reject(new cs(e));const u=Ws.toDataTransfer(n,async d=>(await this._proxy.$resolveDropFileData(e,t,d)).buffer);return a===e&&l&&await this.addAdditionalTransferItems(u,c,l,s,o),c.onDrop(u,r,s)}async addAdditionalTransferItems(e,t,n,r,s){var a;const o=this.treeDragAndDropService.removeDragOperationTransfer(s);if(o)(a=await o)==null||a.forEach((l,c)=>{l&&e.set(c,l)});else if(s&&t.handleDrag){const l=t.handleDrag(n,e,r);this.treeDragAndDropService.addDragOperationTransfer(s,l),await l}return e}async $handleDrag(e,t,n,r){const s=this.treeViews.get(e);if(!s)return Promise.reject(new cs(e));const o=await this.addAdditionalTransferItems(new yd,s,t,r,n);if(!(!o||r.isCancellationRequested))return Ws.from(o)}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new cs(e);return t.hasResolve}$resolve(e,t,n){const r=this.treeViews.get(e);if(!r)throw new cs(e);return r.resolveTreeItem(t,n)}$setExpanded(e,t,n){const r=this.treeViews.get(e);if(!r)throw new cs(e);r.setExpanded(t,n)}$setSelectionAndFocus(e,t,n){const r=this.treeViews.get(e);if(!r)throw new cs(e);r.setSelectionAndFocus(t,n)}$setVisible(e,t){const n=this.treeViews.get(e);if(!n){if(!t)return;throw new cs(e)}n.setVisible(t)}$changeCheckboxState(e,t){const n=this.treeViews.get(e);if(!n)throw new cs(e);n.setCheckboxState(t)}createExtHostTreeView(e,t,n){const r=this._register(new W0(e,t,this._proxy,this.commands.converter,this.logService,n));return this.treeViews.set(e,r),r}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}}const jc=class jc extends Re{get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!Wt(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,n,r,s,o){if(super(),this.viewId=e,this.proxy=n,this.commands=r,this.logService=s,this.extension=o,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new L),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new L),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new L),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new L),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new L),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new L),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new L),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new Qt,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const d of o.contributes.views[u])d.id===e&&(this._title=d.name);this.dataProvider=t.treeDataProvider,this.dndController=t.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this._onDidChangeData.fire({message:!1,element:u})}));let a,l;const c=Ht.debounce(this._onDidChangeData.event,(u,d)=>(u||(u={message:!1,elements:[]}),d.element!==!1&&(a||(a=new Promise(f=>l=f),this.refreshPromise=this.refreshPromise.then(()=>a)),Array.isArray(d.element)?u.elements.push(...d.element):u.elements.push(d.element)),d.message&&(u.message=!0),u),200,!0);this._register(c(({message:u,elements:d})=>{d.length&&(this.refreshQueue=this.refreshQueue.then(()=>{const f=l;return a=null,this.refresh(d).then(()=>f())})),u&&this.proxy.$setMessage(this.viewId,We.fromStrict(this._message)??"")}))}async getChildren(e){const t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this.logService.error(`No tree item with id '${e}' found.`),Promise.resolve([]);let n=this.getChildrenNodes(e);return n||(n=await this.fetchChildrenNodes(t)),n?n.map(r=>r.item):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,t){t=t||{select:!0,focus:!1};const n=Wt(t.select)?!0:t.select,r=Wt(t.focus)?!1:t.focus,s=Wt(t.expand)?!1:t.expand;return typeof this.dataProvider.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):e?this.refreshPromise.then(()=>this.resolveUnknownParentChain(e)).then(o=>this.resolveTreeNode(e,o[o.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:o.map(l=>l.item)},{select:n,focus:r,expand:s})),o=>this.logService.error(o)):this.proxy.$reveal(this.viewId,void 0,{select:n,focus:r,expand:s})}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){var t,n;((t=this._badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((n=this._badge)==null?void 0:n.tooltip)===(e==null?void 0:e.tooltip)||(this._badge=qg.from(e),this.proxy.$setBadge(this.viewId,e))}setExpanded(e,t){const n=this.getExtensionElement(e);n&&(t?this._onDidExpandElement.fire(Object.freeze({element:n})):this._onDidCollapseElement.fire(Object.freeze({element:n})))}setSelectionAndFocus(e,t){const n=!Tr(this._selectedHandles,e);this._selectedHandles=e;const r=this._focusedHandle!==t;this._focusedHandle=t,n&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),r&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){const t=(await Promise.all(e.map(async n=>{const r=this.getExtensionElement(n.treeItemHandle);return r?{extensionItem:r,treeItem:await this.dataProvider.getTreeItem(r),newState:n.newState?gr.Checked:gr.Unchecked}:Promise.resolve(void 0)}))).filter(n=>n!==void 0);t.forEach(n=>{n.treeItem.checkboxState=n.newState?gr.Checked:gr.Unchecked}),this._onDidChangeCheckboxState.fire({items:t.map(n=>[n.extensionItem,n.newState])})}async handleDrag(e,t,n){var s;const r=[];for(const o of e){const a=this.getExtensionElement(o);a&&r.push(a)}if(!(!((s=this.dndController)!=null&&s.handleDrag)||r.length===0))return await this.dndController.handleDrag(r,t,n),t}get hasHandleDrag(){var e;return!!((e=this.dndController)!=null&&e.handleDrag)}async onDrop(e,t,n){var s;const r=t?this.getExtensionElement(t):void 0;if(!(!r&&t||!((s=this.dndController)!=null&&s.handleDrop)))return xi(()=>{var o;return(o=this.dndController)!=null&&o.handleDrop?this.dndController.handleDrop(r,e,n):void 0})}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this.dataProvider.resolveTreeItem)return;const n=this.elements.get(e);if(n){const r=this.nodes.get(n);if(r){const s=await this.dataProvider.resolveTreeItem(r.extensionItem,n,t)??r.extensionItem;return this.validateTreeItem(s),r.item.tooltip=this.getTooltip(s.tooltip),r.item.command=this.getCommand(r.disposableStore,s.command),r.item}}}resolveUnknownParentChain(e){return this.resolveParent(e).then(t=>t?this.resolveUnknownParentChain(t).then(n=>this.resolveTreeNode(t,n[n.length-1]).then(r=>(n.push(r),n))):Promise.resolve([]))}resolveParent(e){const t=this.nodes.get(e);return t?Promise.resolve(t.parent?this.elements.get(t.parent.item.handle):void 0):xi(()=>this.dataProvider.getParent(e))}resolveTreeNode(e,t){const n=this.nodes.get(e);return n?Promise.resolve(n):xi(()=>this.dataProvider.getTreeItem(e)).then(r=>this.createHandle(e,r,t,!0)).then(r=>this.getChildren(t?t.item.handle:void 0).then(()=>{const s=this.getExtensionElement(r);if(s){const o=this.nodes.get(s);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${r} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(e){if(e){let t;if(typeof e=="string"){const n=this.getExtensionElement(e);t=n?this.nodes.get(n):void 0}else t=e;return t&&t.children||void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const t=new Qt(this._refreshCancellationSource.token);try{const n=e?this.nodes.get(e):void 0,r=await this.dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;const s=Ti(r||[]),o=await Promise.all(Ti(s).map(l=>this.dataProvider.getTreeItem(l)));if(t.token.isCancellationRequested)return;const a=o.map((l,c)=>l?this.createAndRegisterTreeNode(s[c],l,n):null);return Ti(a)}finally{t.dispose()}}refresh(e){if(e.some(n=>!n))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new Qt,this.clearAll(),this.proxy.$refresh(this.viewId);{const n=this.getHandlesToRefresh(e);if(n.length)return this.refreshHandles(n)}return Promise.resolve(void 0)}getHandlesToRefresh(e){const t=new Set,n=e.map(s=>this.nodes.get(s));for(const s of n)if(s&&!t.has(s.item.handle)){let o=s;for(;o&&o.parent&&n.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.elements.get(o.parent.item.handle);o=a?this.nodes.get(a):void 0}o&&!o.parent&&t.add(s.item.handle)}const r=[];return t.forEach(s=>{const o=this.elements.get(s);if(o){const a=this.nodes.get(o);a&&(!a.parent||!t.has(a.parent.item.handle))&&r.push(s)}}),r}refreshHandles(e){const t={};return Promise.all(e.map(n=>this.refreshNode(n).then(r=>{r&&(t[n]=r.item)}))).then(()=>Object.keys(t).length?this.proxy.$refresh(this.viewId,t):void 0)}refreshNode(e){const t=this.getExtensionElement(e);if(t){const n=this.nodes.get(t);if(n)return this.clearChildren(t),xi(()=>this.dataProvider.getTreeItem(t)).then(r=>{if(r){const s=this.createTreeNode(t,r,n.parent);return this.updateNodeCache(t,s,n,n.parent),n.dispose(),s}return null})}return Promise.resolve(null)}createAndRegisterTreeNode(e,t,n){const r=this.createTreeNode(e,t,n);if(t.id&&this.elements.has(r.item.handle))throw new Error(h(4823,"Element with id {0} is already registered",t.id));return this.addNodeToCache(e,r),this.addNodeToParentCache(r,n),r}getTooltip(e){return tn.isMarkdownString(e)?We.from(e):e}getCommand(e,t){return t?{...this.commands.toInternal(t,e),originalId:t.command}:void 0}getCheckbox(e){if(e.checkboxState===void 0)return;let t,n,r;return typeof e.checkboxState=="number"?t=e.checkboxState:(t=e.checkboxState.state,n=e.checkboxState.tooltip,r=e.checkboxState.accessibilityInformation),{isChecked:t===gr.Checked,tooltip:n,accessibilityInformation:r}}validateTreeItem(e){if(!Qp.isTreeItem(e,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(e,t,n){this.validateTreeItem(t);const r=this._register(new Le),s=this.createHandle(e,t,n),o=this.getLightIconPath(t);return{item:{handle:s,parentHandle:n?n.item.handle:void 0,label:n5(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this.getTooltip(t.tooltip),command:this.getCommand(r,t.command),contextValue:t.contextValue,icon:o,iconDark:this.getDarkIconPath(t)||o,themeIcon:this.getThemeIcon(t),collapsibleState:Wt(t.collapsibleState)?ea.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this.getCheckbox(t)},extensionItem:t,parent:n,children:void 0,disposableStore:r,dispose(){r.dispose()}}}getThemeIcon(e){return e.iconPath instanceof Oi?e.iconPath:void 0}createHandle(e,{id:t,label:n,resourceUri:r},s,o){if(t)return`${jc.ID_HANDLE_PREFIX}/${t}`;const a=n5(n),l=s?s.item.handle:jc.LABEL_HANDLE_PREFIX;let c=a?a.label:r?xo(r):"";c=c.indexOf("/")!==-1?c.replace("/","//"):c;const u=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0,d=this.getChildrenNodes(s)||[];let f,p=0;do{if(f=`${l}/${p}:${c}`,o||!this.elements.has(f)||u===f)break;p++}while(p<=d.length);return f}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Oi))return typeof e.iconPath=="string"||y.isUri(e.iconPath)?this.getIconPath(e.iconPath):this.getIconPath(e.iconPath.light)}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Oi)&&e.iconPath.dark)return this.getIconPath(e.iconPath.dark)}getIconPath(e){return y.isUri(e)?e:y.file(e)}addNodeToCache(e,t){this.elements.set(t.item.handle,e),this.nodes.set(e,t)}updateNodeCache(e,t,n,r){this.elements.delete(t.item.handle),this.nodes.delete(e),t.item.handle!==n.item.handle&&this.elements.delete(n.item.handle),this.addNodeToCache(e,t);const s=this.getChildrenNodes(r)||[],o=s.filter(a=>a.item.handle===n.item.handle)[0];o&&s.splice(s.indexOf(o),1,t)}addNodeToParentCache(e,t){t?(t.children||(t.children=[]),t.children.push(e)):(this.roots||(this.roots=[]),this.roots.push(e))}clearChildren(e){if(e){const t=this.nodes.get(e);if(t){if(t.children)for(const n of t.children){const r=this.elements.get(n.item.handle);r&&this.clear(r)}t.children=void 0}}else this.clearAll()}clear(e){const t=this.nodes.get(e);if(t){if(t.children)for(const n of t.children){const r=this.elements.get(n.item.handle);r&&this.clear(r)}this.nodes.delete(e),this.elements.delete(t.item.handle),t.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach(e=>e.dispose()),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}};jc.LABEL_HANDLE_PREFIX="0",jc.ID_HANDLE_PREFIX="1";let W0=jc;const g1=class g1{constructor(e){this._openers=new Map,this._proxy=e.getProxy(Z.MainThreadUriOpeners)}registerExternalUriOpener(e,t,n,r){if(this._openers.has(t))throw new Error(`Opener with id '${t}' already registered`);const s=r.schemes.find(o=>!g1.supportedSchemes.has(o));if(s)throw new Error(`Scheme '${s}' is not supported. Only http and https are currently supported.`);return this._openers.set(t,n),this._proxy.$registerUriOpener(t,r.schemes,e,r.label),Me(()=>{this._openers.delete(t),this._proxy.$unregisterUriOpener(t)})}async $canOpenUri(e,t,n){const r=this._openers.get(e);if(!r)throw new Error(`Unknown opener with id: ${e}`);const s=y.revive(t);return r.canOpenExternalUri(s,n)}async $openUri(e,t,n){const r=this._openers.get(e);if(!r)throw new Error(`Unknown opener id: '${e}'`);return r.openExternalUri(y.revive(t.resolvedUri),{sourceUri:y.revive(t.sourceUri)},n)}};g1.supportedSchemes=new Set([le.http,le.https]);let V0=g1;const m1=class m1{constructor(e){this.handles=new Uo,this.handlers=new Map,this._proxy=e.getProxy(Z.MainThreadUrls)}registerUriHandler(e,t){const n=e.identifier;if(this.handles.has(n))throw new Error(`Protocol handler already registered for extension ${n}`);const r=m1.HandlePool++;return this.handles.add(n),this.handlers.set(r,t),this._proxy.$registerUriHandler(r,n,e.displayName||e.name),Me(()=>{this.handles.delete(n),this.handlers.delete(r),this._proxy.$unregisterUriHandler(r)})}$handleExternalUri(e,t){const n=this.handlers.get(e);if(!n)return Promise.resolve(void 0);try{n.handleUri(y.revive(t))}catch(r){ln(r)}return Promise.resolve(void 0)}async createAppUri(e){return y.revive(await this._proxy.$createAppUri(e))}};m1.HandlePool=0;let z0=m1;class Z3 extends Re{constructor(t,n,r,s){super();me(this,io);me(this,no);me(this,Xh);me(this,Gc);me(this,Yh);me(this,qa);me(this,Qc);me(this,ms);me(this,Jc);me(this,Xc);me(this,ro);me(this,Yc);me(this,Kc);te(this,ms,void 0),te(this,Jc,!0),te(this,ro,!1),te(this,Yc,this._register(new L)),this.onDidDispose=I(this,Yc).event,te(this,Kc,this._register(new L)),this.onDidChangeViewState=I(this,Kc).event,te(this,io,t),te(this,no,n),te(this,Gc,r),te(this,Xh,s.viewType),te(this,Yh,s.panelOptions),te(this,ms,s.viewColumn),te(this,qa,s.title),te(this,Xc,s.active)}dispose(){I(this,ro)||(te(this,ro,!0),I(this,Yc).fire(),I(this,no).$disposeWebview(I(this,io)),I(this,Gc).dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),I(this,Gc)}get viewType(){return this.assertNotDisposed(),I(this,Xh)}get title(){return this.assertNotDisposed(),I(this,qa)}set title(t){this.assertNotDisposed(),I(this,qa)!==t&&(te(this,qa,t),I(this,no).$setTitle(I(this,io),t))}get iconPath(){return this.assertNotDisposed(),I(this,Qc)}set iconPath(t){this.assertNotDisposed(),I(this,Qc)!==t&&(te(this,Qc,t),I(this,no).$setIconPath(I(this,io),y.isUri(t)?{light:t,dark:t}:t))}get options(){return I(this,Yh)}get viewColumn(){if(this.assertNotDisposed(),!(typeof I(this,ms)=="number"&&I(this,ms)<0))return I(this,ms)}get active(){return this.assertNotDisposed(),I(this,Xc)}get visible(){return this.assertNotDisposed(),I(this,Jc)}_updateViewState(t){I(this,ro)||(this.active!==t.active||this.visible!==t.visible||this.viewColumn!==t.viewColumn)&&(te(this,Xc,t.active),te(this,Jc,t.visible),te(this,ms,t.viewColumn),I(this,Kc).fire({webviewPanel:this}))}reveal(t,n){this.assertNotDisposed(),I(this,no).$reveal(I(this,io),{viewColumn:typeof t>"u"?void 0:Kt.from(t),preserveFocus:!!n})}assertNotDisposed(){if(I(this,ro))throw new Error("Webview is disposed")}}io=new WeakMap,no=new WeakMap,Xh=new WeakMap,Gc=new WeakMap,Yh=new WeakMap,qa=new WeakMap,Qc=new WeakMap,ms=new WeakMap,Jc=new WeakMap,Xc=new WeakMap,ro=new WeakMap,Yc=new WeakMap,Kc=new WeakMap;class q0 extends Re{static newHandle(){return Un()}constructor(e,t,n){super(),this.webviews=t,this.workspace=n,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(Z.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(e=>e.dispose()),this._webviewPanels.clear()}createWebviewPanel(e,t,n,r,s={}){const o=typeof r=="object"?r.viewColumn:r,a={viewColumn:Kt.from(o),preserveFocus:typeof r=="object"&&!!r.preserveFocus},l=Ec(e),c=q0.newHandle();this._proxy.$createWebviewPanel(xm(e),c,t,{title:n,panelOptions:eL(s),webviewOptions:mk(e,this.workspace,s),serializeBuffersForPostMessage:l},a);const u=this.webviews.createNewWebview(c,s,e);return this.createNewWebviewPanel(c,t,n,o,s,u,!0)}$onDidChangeWebviewPanelViewStates(e){const t=Object.keys(e);t.sort((n,r)=>{const s=e[n],o=e[r];return s.active?1:o.active?-1:+s.visible-+o.visible});for(const n of t){const r=this.getWebviewPanel(n);if(!r)continue;const s=e[n];r._updateViewState({active:s.active,visible:s.visible,viewColumn:Kt.to(s.position)})}}async $onDidDisposeWebviewPanel(e){const t=this.getWebviewPanel(e);t==null||t.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,n){if(this._serializers.has(t))throw new Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:n,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:Ec(e)}),new Qe(()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)})}async $deserializeWebviewPanel(e,t,n,r){const s=this._serializers.get(t);if(!s)throw new Error(`No serializer found for '${t}'`);const{serializer:o,extension:a}=s,l=this.webviews.createNewWebview(e,n.webviewOptions,a),c=this.createNewWebviewPanel(e,t,n.title,r,n.panelOptions,l,n.active);await o.deserializeWebviewPanel(c,n.state)}createNewWebviewPanel(e,t,n,r,s,o,a){const l=new Z3(e,this._proxy,o,{viewType:t,title:n,viewColumn:r,panelOptions:s,active:a});return this._webviewPanels.set(e,l),l}getWebviewPanel(e){return this._webviewPanels.get(e)}}function eL(i){return{enableFindWidget:i.enableFindWidget,retainContextWhenHidden:i.retainContextWhenHidden}}class tL extends Re{constructor(t,n,r,s,o,a){super();me(this,so);me(this,oo);me(this,Kh);me(this,Zc);me(this,ao);me(this,ja);me(this,Ga);me(this,eu);me(this,Qa);me(this,tu);me(this,iu);te(this,ao,!1),te(this,tu,this._register(new L)),this.onDidChangeVisibility=I(this,tu).event,te(this,iu,this._register(new L)),this.onDidDispose=I(this,iu).event,te(this,Kh,r),te(this,Ga,s),te(this,so,t),te(this,oo,n),te(this,Zc,o),te(this,ja,a)}dispose(){I(this,ao)||(te(this,ao,!0),I(this,iu).fire(),I(this,Zc).dispose(),super.dispose())}get title(){return this.assertNotDisposed(),I(this,Ga)}set title(t){this.assertNotDisposed(),I(this,Ga)!==t&&(te(this,Ga,t),I(this,oo).$setWebviewViewTitle(I(this,so),t))}get description(){return this.assertNotDisposed(),I(this,eu)}set description(t){this.assertNotDisposed(),I(this,eu)!==t&&(te(this,eu,t),I(this,oo).$setWebviewViewDescription(I(this,so),t))}get visible(){return I(this,ja)}get webview(){return I(this,Zc)}get viewType(){return I(this,Kh)}_setVisible(t){t===I(this,ja)||I(this,ao)||(te(this,ja,t),I(this,tu).fire())}get badge(){return this.assertNotDisposed(),I(this,Qa)}set badge(t){var n,r;this.assertNotDisposed(),!((t==null?void 0:t.value)===((n=I(this,Qa))==null?void 0:n.value)&&(t==null?void 0:t.tooltip)===((r=I(this,Qa))==null?void 0:r.tooltip))&&(te(this,Qa,qg.from(t)),I(this,oo).$setWebviewViewBadge(I(this,so),t))}show(t){this.assertNotDisposed(),I(this,oo).$show(I(this,so),!!t)}assertNotDisposed(){if(I(this,ao))throw new Error("Webview is disposed")}}so=new WeakMap,oo=new WeakMap,Kh=new WeakMap,Zc=new WeakMap,ao=new WeakMap,ja=new WeakMap,Ga=new WeakMap,eu=new WeakMap,Qa=new WeakMap,tu=new WeakMap,iu=new WeakMap;class iL{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(Z.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,n,r){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:n,extension:e}),this._proxy.$registerWebviewViewProvider(xm(e),t,{retainContextWhenHidden:r==null?void 0:r.retainContextWhenHidden,serializeBuffersForPostMessage:Ec(e)}),new Qe(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,n,r,s){const o=this._viewProviders.get(t);if(!o)throw new Error(`No view provider found for '${t}'`);const{provider:a,extension:l}=o,c=this._extHostWebview.createNewWebview(e,{},l),u=new tL(e,this._proxy,t,n,c,!0);this._webviewViews.set(e,u),await a.resolveWebviewView(u,{state:r},s)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}}function nL(i){const e=i.get(Ei),t=i.get(pl),n=i.get(om),r=i.get(js),s=i.get(ts),o=i.get(lm),a=i.get(is),l=i.get(If),c=i.get(it),u=i.get(Bw),d=i.get(Vw),f=i.get(hl),p=i.get(rt),b=i.get(Qw),w=i.get(hm),v=i.get(ik),S=i.get(ub),k=i.get(gh),C=i.get(fb),N=i.get(nb),A=i.get(ob);c.set(ce.ExtHostFileSystemInfo,t),c.set(ce.ExtHostLogLevelServiceShape,f),c.set(ce.ExtHostWorkspace,s),c.set(ce.ExtHostConfiguration,a),c.set(ce.ExtHostExtensionService,r),c.set(ce.ExtHostStorage,u),c.set(ce.ExtHostTunnelService,b),c.set(ce.ExtHostWindow,v),c.set(ce.ExtHostSecretState,S),c.set(ce.ExtHostTelemetry,o),c.set(ce.ExtHostEditorTabs,k),c.set(ce.ExtHostManagedSockets,C),c.set(ce.ExtHostAuthentication,N),c.set(ce.ExtHostChatProvider,A);const V=c.set(ce.ExtHostDecorations,i.get(CD)),ae=c.set(ce.ExtHostDocumentsAndEditors,i.get(xc)),be=c.set(ce.ExtHostCommands,i.get(fa)),Q=c.set(ce.ExtHostTerminalService,i.get(bc)),Ce=c.set(ce.ExtHostTerminalShellIntegration,i.get(nk)),Se=c.set(ce.ExtHostDebugService,i.get(ZD)),J=c.set(ce.ExtHostSearch,i.get(tk)),q=c.set(ce.ExtHostTask,i.get(WD)),oe=c.set(ce.ExtHostOutputService,i.get(kD)),re=c.set(ce.ExtHostLocalization,i.get(hb)),de=c.set(ce.ExtHostUrls,new z0(c)),fe=c.set(ce.ExtHostDocuments,new HR(c,ae)),je=c.set(ce.ExtHostDocumentContentProviders,new s0(c,ae,p)),gt=c.set(ce.ExtHostDocumentSaveParticipant,new UR(p,fe,c.getProxy(Z.MainThreadBulkEdits))),$e=c.set(ce.ExtHostNotebook,new D0(c,be,ae,fe,n,J,p)),gi=c.set(ce.ExtHostNotebookDocuments,new E3($e)),oi=c.set(ce.ExtHostNotebookEditors,new k0(p,$e)),Zt=c.set(ce.ExtHostNotebookKernels,new C0(c,e,$e,be,p)),mi=c.set(ce.ExtHostNotebookRenderers,new k3(c,$e)),$i=c.set(ce.ExtHostNotebookDocumentSaveParticipant,new x3(p,$e,c.getProxy(Z.MainThreadBulkEdits))),kt=c.set(ce.ExtHostEditors,new V3(c,ae)),er=c.set(ce.ExtHostTreeViews,new K3(c.getProxy(Z.MainThreadTreeViews),be,p)),_s=c.set(ce.ExtHostEditorInsets,new vR(c.getProxy(Z.MainThreadEditorInsets),kt,e.remote)),nu=c.set(ce.ExtHostDiagnostics,new r0(c,p,t,ae)),Xa=c.set(ce.ExtHostLanguages,new e3(c,fe,be.converter,l)),Ve=c.set(ce.ExtHostLanguageFeatures,new h0(c,l,fe,be,nu,p,w,o)),_1=c.set(ce.ExtHostFileSystem,new km(c,Ve)),Ji=c.set(ce.ExtHostFileSystemEventService,new JR(c,p,ae)),bn=c.set(ce.ExtHostQuickOpen,A3(c,s,be)),v1=c.set(ce.ExtHostSCM,new M0(c,be,fe,p)),ty=c.set(ce.ExtHostQuickDiff,new A0(c,l)),at=c.set(ce.ExtHostShare,new $0(c,l)),iy=c.set(ce.ExtHostComments,wR(c,be,fe)),w1=c.set(ce.ExtHostProgress,new P3(c.getProxy(Z.MainThreadProgress))),b1=c.set(ce.ExtHostLabelService,new YR(c)),vs=c.set(ce.ExtHostTheming,new B0(c)),ny=c.set(ce.ExtHostTimeline,new z3(c,be)),Zh=c.set(ce.ExtHostWebviews,new IR(c,e.remote,s,p,w)),ef=c.set(ce.ExtHostWebviewPanels,new q0(c,Zh,s)),ry=c.set(ce.ExtHostCustomEditors,new NR(c,fe,d,Zh,ef)),tr=c.set(ce.ExtHostWebviewViews,new iL(c,Zh)),lo=c.set(ce.ExtHostTesting,i.get(bm)),sy=c.set(ce.ExtHostUriOpeners,new V0(c)),oy=c.set(ce.ExtHostProfileContentHandlers,new C3(c));c.set(ce.ExtHostInteractive,new XR(c,$e,ae,be,p));const tf=c.set(ce.ExtHostChatAgents2,new t0(c,p,be,fe)),ru=c.set(ce.ExtHostChatVariables,new i0(c)),co=c.set(ce.ExtHostLanguageModelTools,new ZR(c)),su=c.set(ce.ExtHostAiRelatedInformation,new aR(c)),y1=c.set(ce.ExtHostAiEmbeddingVector,new WR(c)),ou=c.set(ce.ExtHostStatusBar,new W3(c,be.converter)),nf=c.set(ce.ExtHostSpeech,new U0(c)),kr=c.set(ce.ExtHostEmbeddings,new BR(c)),an=Object.values(ce);c.assertRegistered(an);const Ya=new e0(c,ae),Mt=new gR(c),rf=new f0(c,p),x1=new $R(c);return hR.register(be),function(D,Cr,E1){function ge(m){return(_,x,j)=>{const Ae=m(et=>{try{_.call(x,et)}catch(bt){D1(new Error(`[ExtensionListenerError] Extension '${D.identifier.value}' FAILED to handle event: ${bt.toString()}`,{cause:bt})),o.onExtensionError(D.identifier,bt)}});return j==null||j.push(Ae),Ae}}const lt=function(){let m=!D.isUnderDevelopment;function _(){m||(p.info(`Extension '${D.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),m=!0)}return function x(j){if(Array.isArray(j))j.forEach(x);else if(typeof j=="string")_();else{const Ae=j;typeof Ae.scheme>"u"&&_(),typeof Ae.exclusive=="boolean"&&M(D,"documentFiltersExclusive")}return j}}(),ay={getSession(m,_,x){return typeof(x==null?void 0:x.forceNewSession)=="object"&&x.forceNewSession.learnMore&&M(D,"authLearnMore"),x!=null&&x.account&&M(D,"authGetSessions"),N.getSession(D,m,_,x)},getAccounts(m){return M(D,"authGetSessions"),N.getAccounts(m)},async hasSession(m,_){return M(D,"authSession"),!!await N.getSession(D,m,_,{silent:!0})},get onDidChangeSessions(){return ge(N.onDidChangeSessions)},registerAuthenticationProvider(m,_,x,j){return N.registerAuthenticationProvider(m,_,x,j)}},ly={registerCommand(m,_,x){return be.registerCommand(!0,m,_,x,void 0,D)},registerTextEditorCommand(m,_,x){return be.registerCommand(!0,m,(...j)=>{const Ae=kt.getActiveTextEditor();if(!Ae){p.warn("Cannot execute "+m+" because there is no active text editor.");return}return Ae.edit(et=>{_.apply(x,[Ae,et,...j])}).then(et=>{et||p.warn("Edits from command "+m+" were not applied.")},et=>{p.warn("An error occurred while running command "+m,et)})},void 0,void 0,D)},registerDiffInformationCommand:(m,_,x)=>(M(D,"diffCommand"),be.registerCommand(!0,m,async(...j)=>{const Ae=ae.activeEditor(!0);if(!Ae){p.warn("Cannot execute "+m+" because there is no active text editor.");return}const et=await kt.getDiffInformation(Ae.id);_.apply(x,[et,...j])},void 0,void 0,D)),executeCommand(m,..._){return be.executeCommand(m,..._)},getCommands(m=!1){return be.getCommands(m)}},cy={get machineId(){return e.telemetryInfo.machineId},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){var m;return((m=e.environment.appRoot)==null?void 0:m.fsPath)??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return Mt.value},get shell(){return Q.getDefaultShell(!1)},get onDidChangeShell(){return ge(Q.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return ge(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return M(D,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return M(D,"telemetry"),ge(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return nD(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(m,_){return iD.validateSender(m),o.instantiateLogger(D,m,_)},openExternal(m,_){return v.openUri(m,{allowTunneling:!!e.remote.authority,allowContributedOpeners:_==null?void 0:_.allowContributedOpeners})},async asExternalUri(m){if(m.scheme===e.environment.appUriScheme)return de.createAppUri(m);try{return await v.asExternalUri(m,{allowTunneling:!!e.remote.authority})}catch(_){if(Z1(m,le.http)||Z1(m,le.https))return m;throw _}},get remoteName(){return L_(e.remote.authority)},get remoteAuthority(){return M(D,"resolvers"),e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return ge(p.onDidChangeLogLevel)},get appQuality(){return M(D,"resolvers"),e.quality},get appCommit(){return M(D,"resolvers"),e.commit}},uy={createTestController(m,_,x){return lo.createTestController(D,m,_,x)},createTestObserver(){return M(D,"testObserver"),lo.createTestObserver()},runTests(m){return M(D,"testObserver"),lo.runTests(m)},registerTestFollowupProvider(m){return M(D,"testObserver"),lo.registerTestFollowupProvider(m)},get onDidChangeTestResults(){return M(D,"testObserver"),ge(lo.onResultsChanged)},get testResults(){return M(D,"testObserver"),lo.results}},au=e.remote.isRemote?na.Workspace:na.UI,lu={getExtension(m,_){ii(D,"extensionsAny")||(_=!1);const x=Cr.mine.getExtensionDescription(m);if(x)return new ah(r,D.identifier,x,au,!1);if(_){const j=Cr.all.getExtensionDescription(m);if(j)return new ah(r,D.identifier,j,au,!0)}},get all(){const m=[];for(const _ of Cr.mine.getAllExtensionDescriptions())m.push(new ah(r,D.identifier,_,au,!1));return m},get allAcrossExtensionHosts(){M(D,"extensionsAny");const m=new Uo(Cr.mine.getAllExtensionDescriptions().map(x=>x.identifier)),_=[];for(const x of Cr.all.getAllExtensionDescriptions()){const j=!m.has(x.identifier);_.push(new ah(r,D.identifier,x,au,j))}return _},get onDidChange(){return ii(D,"extensionsAny")?ge(Ht.any(Cr.mine.onDidChange,Cr.all.onDidChange)):ge(Cr.mine.onDidChange)}},dy={createDiagnosticCollection(m){return nu.createDiagnosticCollection(D.identifier,m)},get onDidChangeDiagnostics(){return ge(nu.onDidChangeDiagnostics)},getDiagnostics:m=>nu.getDiagnostics(m),getLanguages(){return Xa.getLanguages()},setTextDocumentLanguage(m,_){return Xa.changeLanguage(m.uri,_)},match(m,_){var Ae;const x=pw.from(m);let j;return sk(x)&&(j=(Ae=$e.notebookDocuments.find(et=>et.apiNotebook.getCells().find(bt=>bt.document===_)))==null?void 0:Ae.apiNotebook),rk(x,_.uri,_.languageId,!0,j==null?void 0:j.uri,j==null?void 0:j.notebookType)},registerCodeActionsProvider(m,_,x){return Ve.registerCodeActionProvider(D,lt(m),_,x)},registerDocumentPasteEditProvider(m,_,x){return M(D,"documentPaste"),Ve.registerDocumentPasteEditProvider(D,lt(m),_,x)},registerCodeLensProvider(m,_){return Ve.registerCodeLensProvider(D,lt(m),_)},registerDefinitionProvider(m,_){return Ve.registerDefinitionProvider(D,lt(m),_)},registerDeclarationProvider(m,_){return Ve.registerDeclarationProvider(D,lt(m),_)},registerImplementationProvider(m,_){return Ve.registerImplementationProvider(D,lt(m),_)},registerTypeDefinitionProvider(m,_){return Ve.registerTypeDefinitionProvider(D,lt(m),_)},registerHoverProvider(m,_){return Ve.registerHoverProvider(D,lt(m),_,D.identifier)},registerEvaluatableExpressionProvider(m,_){return Ve.registerEvaluatableExpressionProvider(D,lt(m),_,D.identifier)},registerInlineValuesProvider(m,_){return Ve.registerInlineValuesProvider(D,lt(m),_,D.identifier)},registerDocumentHighlightProvider(m,_){return Ve.registerDocumentHighlightProvider(D,lt(m),_)},registerMultiDocumentHighlightProvider(m,_){return Ve.registerMultiDocumentHighlightProvider(D,lt(m),_)},registerLinkedEditingRangeProvider(m,_){return Ve.registerLinkedEditingRangeProvider(D,lt(m),_)},registerReferenceProvider(m,_){return Ve.registerReferenceProvider(D,lt(m),_)},registerRenameProvider(m,_){return Ve.registerRenameProvider(D,lt(m),_)},registerNewSymbolNamesProvider(m,_){return M(D,"newSymbolNamesProvider"),Ve.registerNewSymbolNamesProvider(D,lt(m),_)},registerDocumentSymbolProvider(m,_,x){return Ve.registerDocumentSymbolProvider(D,lt(m),_,x)},registerWorkspaceSymbolProvider(m){return Ve.registerWorkspaceSymbolProvider(D,m)},registerDocumentFormattingEditProvider(m,_){return Ve.registerDocumentFormattingEditProvider(D,lt(m),_)},registerDocumentRangeFormattingEditProvider(m,_){return Ve.registerDocumentRangeFormattingEditProvider(D,lt(m),_)},registerOnTypeFormattingEditProvider(m,_,x,...j){return Ve.registerOnTypeFormattingEditProvider(D,lt(m),_,[x].concat(j))},registerDocumentSemanticTokensProvider(m,_,x){return Ve.registerDocumentSemanticTokensProvider(D,lt(m),_,x)},registerDocumentRangeSemanticTokensProvider(m,_,x){return Ve.registerDocumentRangeSemanticTokensProvider(D,lt(m),_,x)},registerSignatureHelpProvider(m,_,x,...j){return typeof x=="object"?Ve.registerSignatureHelpProvider(D,lt(m),_,x):Ve.registerSignatureHelpProvider(D,lt(m),_,typeof x>"u"?[]:[x,...j])},registerCompletionItemProvider(m,_,...x){return Ve.registerCompletionItemProvider(D,lt(m),_,x)},registerInlineCompletionItemProvider(m,_,x){return _.handleDidShowCompletionItem&&M(D,"inlineCompletionsAdditions"),_.handleDidPartiallyAcceptCompletionItem&&M(D,"inlineCompletionsAdditions"),x&&M(D,"inlineCompletionsAdditions"),Ve.registerInlineCompletionsProvider(D,lt(m),_,x)},registerInlineEditProvider(m,_){return M(D,"inlineEdit"),Ve.registerInlineEditProvider(D,lt(m),_)},registerDocumentLinkProvider(m,_){return Ve.registerDocumentLinkProvider(D,lt(m),_)},registerColorProvider(m,_){return Ve.registerColorProvider(D,lt(m),_)},registerFoldingRangeProvider(m,_){return Ve.registerFoldingRangeProvider(D,lt(m),_)},registerSelectionRangeProvider(m,_){return Ve.registerSelectionRangeProvider(D,m,_)},registerCallHierarchyProvider(m,_){return Ve.registerCallHierarchyProvider(D,m,_)},registerTypeHierarchyProvider(m,_){return Ve.registerTypeHierarchyProvider(D,m,_)},setLanguageConfiguration:(m,_)=>Ve.setLanguageConfiguration(D,m,_),getTokenInformationAtPosition(m,_){return M(D,"tokenInformation"),Xa.tokenAtPosition(m,_)},registerInlayHintsProvider(m,_){return Ve.registerInlayHintsProvider(D,m,_)},createLanguageStatusItem(m,_){return Xa.createLanguageStatusItem(D,m,_)},registerDocumentDropEditProvider(m,_,x){return Ve.registerDocumentOnDropEditProvider(D,m,_,ii(D,"documentPaste")?x:void 0)}},hy={get activeTextEditor(){return kt.getActiveTextEditor()},get visibleTextEditors(){return kt.getVisibleTextEditors()},get activeTerminal(){return Q.activeTerminal},get terminals(){return Q.terminals},async showTextDocument(m,_,x){y.isUri(m)&&m.scheme===le.vscodeRemote&&!m.authority&&w.report("workspace.showTextDocument",D,"A URI of 'vscode-remote' scheme requires an authority.");const j=await(y.isUri(m)?Promise.resolve(S1.openTextDocument(m)):Promise.resolve(m));return kt.showTextDocument(j,_,x)},createTextEditorDecorationType(m){return kt.createTextEditorDecorationType(D,m)},onDidChangeActiveTextEditor(m,_,x){return ge(kt.onDidChangeActiveTextEditor)(m,_,x)},onDidChangeVisibleTextEditors(m,_,x){return ge(kt.onDidChangeVisibleTextEditors)(m,_,x)},onDidChangeTextEditorSelection(m,_,x){return ge(kt.onDidChangeTextEditorSelection)(m,_,x)},onDidChangeTextEditorOptions(m,_,x){return ge(kt.onDidChangeTextEditorOptions)(m,_,x)},onDidChangeTextEditorVisibleRanges(m,_,x){return ge(kt.onDidChangeTextEditorVisibleRanges)(m,_,x)},onDidChangeTextEditorViewColumn(m,_,x){return ge(kt.onDidChangeTextEditorViewColumn)(m,_,x)},onDidCloseTerminal(m,_,x){return ge(Q.onDidCloseTerminal)(m,_,x)},onDidOpenTerminal(m,_,x){return ge(Q.onDidOpenTerminal)(m,_,x)},onDidChangeActiveTerminal(m,_,x){return ge(Q.onDidChangeActiveTerminal)(m,_,x)},onDidChangeTerminalDimensions(m,_,x){return M(D,"terminalDimensions"),ge(Q.onDidChangeTerminalDimensions)(m,_,x)},onDidChangeTerminalState(m,_,x){return ge(Q.onDidChangeTerminalState)(m,_,x)},onDidWriteTerminalData(m,_,x){return M(D,"terminalDataWriteEvent"),ge(Q.onDidWriteTerminalData)(m,_,x)},onDidExecuteTerminalCommand(m,_,x){return M(D,"terminalExecuteCommandEvent"),ge(Q.onDidExecuteTerminalCommand)(m,_,x)},onDidChangeTerminalShellIntegration(m,_,x){return M(D,"terminalShellIntegration"),ge(Ce.onDidChangeTerminalShellIntegration)(m,_,x)},onDidStartTerminalShellExecution(m,_,x){return M(D,"terminalShellIntegration"),ge(Ce.onDidStartTerminalShellExecution)(m,_,x)},onDidEndTerminalShellExecution(m,_,x){return M(D,"terminalShellIntegration"),ge(Ce.onDidEndTerminalShellExecution)(m,_,x)},get state(){return v.getState()},onDidChangeWindowState(m,_,x){return ge(v.onDidChangeWindowState)(m,_,x)},showInformationMessage(m,..._){return rf.showMessage(D,Vt.Info,m,_[0],_.slice(1))},showWarningMessage(m,..._){return rf.showMessage(D,Vt.Warning,m,_[0],_.slice(1))},showErrorMessage(m,..._){return rf.showMessage(D,Vt.Error,m,_[0],_.slice(1))},showQuickPick(m,_,x){return bn.showQuickPick(D,m,_,x)},showWorkspaceFolderPick(m){return bn.showWorkspaceFolderPick(m)},showInputBox(m,_){return bn.showInput(m,_)},showOpenDialog(m){return x1.showOpenDialog(D,m)},showSaveDialog(m){return x1.showSaveDialog(m)},createStatusBarItem(m,_,x){let j,Ae,et;return typeof m=="string"?(j=m,Ae=_,et=x):(Ae=m,et=_),ou.createStatusBarEntry(D,j,Ae,et)},setStatusBarMessage(m,_){return ou.setStatusBarMessage(m,_)},withScmProgress(m){return w.report("window.withScmProgress",D,"Use 'withProgress' instead."),w1.withProgress(D,{location:Zo.SourceControl},(_,x)=>m({report(j){}}))},withProgress(m,_){return w1.withProgress(D,m,_)},createOutputChannel(m,_){return oe.createOutputChannel(m,_,D)},createWebviewPanel(m,_,x,j){return ef.createWebviewPanel(D,m,_,x,j)},createWebviewTextEditorInset(m,_,x,j){return M(D,"editorInsets"),_s.createWebviewEditorInset(m,_,x,j,D)},createTerminal(m,_,x){return typeof m=="object"?"pty"in m?Q.createExtensionTerminal(m):Q.createTerminalFromOptions(m):Q.createTerminal(m,_,x)},registerTerminalLinkProvider(m){return Q.registerLinkProvider(m)},registerTerminalProfileProvider(m,_){return Q.registerProfileProvider(D,m,_)},registerTerminalQuickFixProvider(m,_){return M(D,"terminalQuickFixProvider"),Q.registerTerminalQuickFixProvider(m,D.identifier.value,_)},registerTreeDataProvider(m,_){return er.registerTreeDataProvider(m,_,D)},createTreeView(m,_){return er.createTreeView(m,_,D)},registerWebviewPanelSerializer:(m,_)=>ef.registerWebviewPanelSerializer(D,m,_),registerCustomEditorProvider:(m,_,x={})=>ry.registerCustomEditorProvider(D,m,_,x),registerFileDecorationProvider(m){return V.registerFileDecorationProvider(m,D)},registerUriHandler(m){return de.registerUriHandler(D,m)},createQuickPick(){return bn.createQuickPick(D)},createInputBox(){return bn.createInputBox(D)},get activeColorTheme(){return vs.activeColorTheme},onDidChangeActiveColorTheme(m,_,x){return ge(vs.onDidChangeActiveColorTheme)(m,_,x)},registerWebviewViewProvider(m,_,x){return tr.registerWebviewViewProvider(D,m,_,x==null?void 0:x.webviewOptions)},get activeNotebookEditor(){return $e.activeNotebookEditor},onDidChangeActiveNotebookEditor(m,_,x){return ge($e.onDidChangeActiveNotebookEditor)(m,_,x)},get visibleNotebookEditors(){return $e.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return ge($e.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(m,_,x){return ge(oi.onDidChangeNotebookEditorSelection)(m,_,x)},onDidChangeNotebookEditorVisibleRanges(m,_,x){return ge(oi.onDidChangeNotebookEditorVisibleRanges)(m,_,x)},showNotebookDocument(m,_){return $e.showNotebookDocument(m,_)},registerExternalUriOpener(m,_,x){return M(D,"externalUriOpener"),sy.registerExternalUriOpener(D.identifier,m,_,x)},registerProfileContentHandler(m,_){return M(D,"profileContentHandlers"),oy.registerProfileContentHandler(D,m,_)},registerQuickDiffProvider(m,_,x,j){return M(D,"quickDiffProvider"),ty.registerQuickDiffProvider(lt(m),_,x,j)},get tabGroups(){return k.tabGroups},registerShareProvider(m,_){return M(D,"shareProvider"),at.registerShareProvider(lt(m),_)}},S1={get rootPath(){return w.report("workspace.rootPath",D,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),s.getPath()},set rootPath(m){throw new ho("rootPath")},getWorkspaceFolder(m){return s.getWorkspaceFolder(m)},get workspaceFolders(){return s.getWorkspaceFolders()},get name(){return s.name},set name(m){throw new ho("name")},get workspaceFile(){return s.workspaceFile},set workspaceFile(m){throw new ho("workspaceFile")},updateWorkspaceFolders:(m,_,...x)=>s.updateWorkspaceFolders(D,m,_||0,...x),onDidChangeWorkspaceFolders:function(m,_,x){return ge(s.onDidChangeWorkspace)(m,_,x)},asRelativePath:(m,_)=>s.getRelativePath(m,_),findFiles:(m,_,x,j)=>s.findFiles(m,_,x,D.identifier,j),findFiles2:(m,_,x)=>(M(D,"findFiles2"),s.findFiles2(m,_,D.identifier,x)),findFiles2New:(m,_,x)=>{var Ae,et,bt;M(D,"findFiles2New");const j={exclude:_!=null&&_.exclude&&_.exclude.length>0?_.exclude[0]:void 0,useDefaultExcludes:!(_!=null&&_.useExcludeSettings)||(_==null?void 0:_.useExcludeSettings)===es.filesExclude||(_==null?void 0:_.useExcludeSettings)===es.searchAndFilesExclude,useDefaultSearchExcludes:!(_!=null&&_.useExcludeSettings)||(_==null?void 0:_.useExcludeSettings)===es.searchAndFilesExclude,maxResults:_==null?void 0:_.maxResults,useIgnoreFiles:(Ae=_==null?void 0:_.useIgnoreFiles)==null?void 0:Ae.local,useGlobalIgnoreFiles:(et=_==null?void 0:_.useIgnoreFiles)==null?void 0:et.global,useParentIgnoreFiles:(bt=_==null?void 0:_.useIgnoreFiles)==null?void 0:bt.parent,followSymlinks:_==null?void 0:_.followSymlinks};return s.findFiles2(m&&m.length>0?m[0]:void 0,j,D.identifier,x)},findTextInFiles:(m,_,x,j)=>{M(D,"findTextInFiles");let Ae,et;return typeof _=="object"?(Ae=_,et=x):(Ae={},et=_,j=x),s.findTextInFiles(m,Ae||{},et,D.identifier,j)},findTextInFilesNew:(m,_,x)=>{var bt,ai,ir,_5,v5;M(D,"findTextInFilesNew"),M(D,"textSearchProviderNew");let j={};_&&(j={include:_.include&&_.include.length>0?_.include[0]:void 0,exclude:_.exclude&&_.exclude.length>0?_.exclude[0]:void 0,useDefaultExcludes:_.useExcludeSettings===void 0||_.useExcludeSettings===es.filesExclude||_.useExcludeSettings===es.searchAndFilesExclude,useSearchExclude:_.useExcludeSettings===void 0||_.useExcludeSettings===es.searchAndFilesExclude,maxResults:_.maxResults,useIgnoreFiles:(bt=_.useIgnoreFiles)==null?void 0:bt.local,useGlobalIgnoreFiles:(ai=_.useIgnoreFiles)==null?void 0:ai.global,useParentIgnoreFiles:(ir=_.useIgnoreFiles)==null?void 0:ir.parent,followSymlinks:_.followSymlinks,encoding:_.encoding,previewOptions:_.previewOptions?{matchLines:((_5=_.previewOptions)==null?void 0:_5.matchLines)??100,charsPerLine:((v5=_.previewOptions)==null?void 0:v5.charsPerLine)??1e4}:void 0,beforeContext:_.surroundingContext,afterContext:_.surroundingContext});const Ae=Promise.resolve(void 0);return{results:new So(async of=>{const vL=async vy=>(of.emitOne(X8(vy)),vy);await Ae.then(vy=>s.findTextInFiles(m,j,vL,D.identifier,x))}),complete:Ae.then(of=>({limitHit:(of==null?void 0:of.limitHit)??!1}))}},save:m=>s.save(m),saveAs:m=>s.saveAs(m),saveAll:m=>s.saveAll(m),applyEdit(m,_){return Ya.applyWorkspaceEdit(m,D,_)},createFileSystemWatcher:(m,_,x,j)=>{let Ae;return typeof _=="boolean"?Ae={ignoreCreateEvents:!!_,ignoreChangeEvents:!!x,ignoreDeleteEvents:!!j,correlate:!1}:_&&(M(D,"createFileSystemWatcher"),Ae={..._,correlate:!0}),Ji.createFileSystemWatcher(s,D,m,Ae)},get textDocuments(){return fe.getAllDocumentData().map(m=>m.document)},set textDocuments(m){throw new ho("textDocuments")},openTextDocument(m){let _;const x=m;if(typeof m=="string")_=Promise.resolve(y.file(m));else if(y.isUri(m))_=Promise.resolve(m);else if(!x||typeof x=="object")_=fe.createDocumentData(x);else throw new Error("illegal argument - uriOrFileNameOrOptions");return _.then(j=>(j.scheme===le.vscodeRemote&&!j.authority&&w.report("workspace.openTextDocument",D,"A URI of 'vscode-remote' scheme requires an authority."),fe.ensureDocumentData(j).then(Ae=>Ae.document)))},onDidOpenTextDocument:(m,_,x)=>ge(fe.onDidAddDocument)(m,_,x),onDidCloseTextDocument:(m,_,x)=>ge(fe.onDidRemoveDocument)(m,_,x),onDidChangeTextDocument:(m,_,x)=>ge(fe.onDidChangeDocument)(m,_,x),onDidSaveTextDocument:(m,_,x)=>ge(fe.onDidSaveDocument)(m,_,x),onWillSaveTextDocument:(m,_,x)=>ge(gt.getOnWillSaveTextDocumentEvent(D))(m,_,x),get notebookDocuments(){return $e.notebookDocuments.map(m=>m.apiNotebook)},async openNotebookDocument(m,_){let x;if(y.isUri(m))x=m,await $e.openNotebookDocument(m);else if(typeof m=="string")x=y.revive(await $e.createNotebookDocument({viewType:m,content:_}));else throw new Error("Invalid arguments");return $e.getNotebookDocument(x).apiNotebook},onDidSaveNotebookDocument(m,_,x){return ge(gi.onDidSaveNotebookDocument)(m,_,x)},onDidChangeNotebookDocument(m,_,x){return ge(gi.onDidChangeNotebookDocument)(m,_,x)},onWillSaveNotebookDocument(m,_,x){return ge($i.getOnWillSaveNotebookDocumentEvent(D))(m,_,x)},get onDidOpenNotebookDocument(){return ge($e.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return ge($e.onDidCloseNotebookDocument)},registerNotebookSerializer(m,_,x,j){return $e.registerNotebookSerializer(D,m,_,x,ii(D,"notebookLiveShare")?j:void 0)},onDidChangeConfiguration:(m,_,x)=>ge(E1.onDidChangeConfiguration)(m,_,x),getConfiguration(m,_){return _=arguments.length===1?void 0:_,E1.getConfiguration(m,_,D)},registerTextDocumentContentProvider(m,_){return je.registerTextDocumentContentProvider(m,_)},registerTaskProvider:(m,_)=>(w.report("window.registerTaskProvider",D,"Use the corresponding function on the 'tasks' namespace instead"),q.registerTaskProvider(D,m,_)),registerFileSystemProvider(m,_,x){return My(_1.registerFileSystemProvider(D,m,_,x),n.addFileSystemProvider(m,_,x))},get fs(){return n.value},registerFileSearchProvider:(m,_)=>(M(D,"fileSearchProvider"),J.registerFileSearchProvider(m,_)),registerTextSearchProvider:(m,_)=>(M(D,"textSearchProvider"),J.registerTextSearchProvider(m,_)),registerAITextSearchProvider:(m,_)=>(M(D,"aiTextSearchProvider"),M(D,"textSearchProvider"),J.registerAITextSearchProvider(m,_)),registerFileSearchProviderNew:(m,_)=>(M(D,"fileSearchProviderNew"),{dispose:()=>{}}),registerTextSearchProviderNew:(m,_)=>(M(D,"textSearchProviderNew"),{dispose:()=>{}}),registerAITextSearchProviderNew:(m,_)=>(M(D,"aiTextSearchProviderNew"),M(D,"textSearchProviderNew"),{dispose:()=>{}}),registerRemoteAuthorityResolver:(m,_)=>(M(D,"resolvers"),r.registerRemoteAuthorityResolver(m,_)),registerResourceLabelFormatter:m=>(M(D,"resolvers"),b1.$registerResourceLabelFormatter(m)),getRemoteExecServer:m=>(M(D,"resolvers"),r.getRemoteExecServer(m)),onDidCreateFiles:(m,_,x)=>ge(Ji.onDidCreateFile)(m,_,x),onDidDeleteFiles:(m,_,x)=>ge(Ji.onDidDeleteFile)(m,_,x),onDidRenameFiles:(m,_,x)=>ge(Ji.onDidRenameFile)(m,_,x),onWillCreateFiles:(m,_,x)=>ge(Ji.getOnWillCreateFileEvent(D))(m,_,x),onWillDeleteFiles:(m,_,x)=>ge(Ji.getOnWillDeleteFileEvent(D))(m,_,x),onWillRenameFiles:(m,_,x)=>ge(Ji.getOnWillRenameFileEvent(D))(m,_,x),openTunnel:m=>(M(D,"tunnels"),b.openTunnel(D,m).then(_=>{if(!_)throw new Error("cannot open tunnel");return _})),get tunnels(){return M(D,"tunnels"),b.getTunnels()},onDidChangeTunnels:(m,_,x)=>(M(D,"tunnels"),ge(b.onDidChangeTunnels)(m,_,x)),registerPortAttributesProvider:(m,_)=>(M(D,"portsAttributes"),b.registerPortsAttributesProvider(m,_)),registerTunnelProvider:(m,_)=>(M(D,"tunnelFactory"),b.registerTunnelProvider(m,_)),registerTimelineProvider:(m,_)=>(M(D,"timeline"),ny.registerTimelineProvider(m,_,D.identifier,be.converter)),get isTrusted(){return s.trusted},requestWorkspaceTrust:m=>(M(D,"workspaceTrust"),s.requestWorkspaceTrust(m)),onDidGrantWorkspaceTrust:(m,_,x)=>ge(s.onDidGrantWorkspaceTrust)(m,_,x),registerEditSessionIdentityProvider:(m,_)=>(M(D,"editSessionIdentityProvider"),s.registerEditSessionIdentityProvider(m,_)),onWillCreateEditSessionIdentity:(m,_,x)=>(M(D,"editSessionIdentityProvider"),ge(s.getOnWillCreateEditSessionIdentityEvent(D))(m,_,x)),registerCanonicalUriProvider:(m,_)=>(M(D,"canonicalUriProvider"),s.registerCanonicalUriProvider(m,_)),getCanonicalUri:(m,_,x)=>(M(D,"canonicalUriProvider"),s.provideCanonicalUri(m,_,x))},fy={get inputBox(){return w.report("scm.inputBox",D,"Use 'SourceControl.inputBox' instead"),v1.getLastInputBox(D)},createSourceControl(m,_,x){return v1.createSourceControl(D,m,_,x)}},py={createCommentController(m,_){return iy.createCommentController(D,m,_)}},sf={get activeDebugSession(){return Se.activeDebugSession},get activeDebugConsole(){return Se.activeDebugConsole},get breakpoints(){return Se.breakpoints},get activeStackItem(){return Se.activeStackItem},registerDebugVisualizationProvider(m,_){return M(D,"debugVisualization"),Se.registerDebugVisualizationProvider(D,m,_)},registerDebugVisualizationTreeProvider(m,_){return M(D,"debugVisualization"),Se.registerDebugVisualizationTree(D,m,_)},onDidStartDebugSession(m,_,x){return ge(Se.onDidStartDebugSession)(m,_,x)},onDidTerminateDebugSession(m,_,x){return ge(Se.onDidTerminateDebugSession)(m,_,x)},onDidChangeActiveDebugSession(m,_,x){return ge(Se.onDidChangeActiveDebugSession)(m,_,x)},onDidReceiveDebugSessionCustomEvent(m,_,x){return ge(Se.onDidReceiveDebugSessionCustomEvent)(m,_,x)},onDidChangeBreakpoints(m,_,x){return ge(Se.onDidChangeBreakpoints)(m,_,x)},onDidChangeActiveStackItem(m,_,x){return ge(Se.onDidChangeActiveStackItem)(m,_,x)},registerDebugConfigurationProvider(m,_,x){return Se.registerDebugConfigurationProvider(m,_,x||xp.Initial)},registerDebugAdapterDescriptorFactory(m,_){return Se.registerDebugAdapterDescriptorFactory(D,m,_)},registerDebugAdapterTrackerFactory(m,_){return Se.registerDebugAdapterTrackerFactory(m,_)},startDebugging(m,_,x){return!x||typeof x=="object"&&"configuration"in x?Se.startDebugging(m,_,{parentSession:x}):Se.startDebugging(m,_,x||{})},stopDebugging(m){return Se.stopDebugging(m)},addBreakpoints(m){return Se.addBreakpoints(m)},removeBreakpoints(m){return Se.removeBreakpoints(m)},asDebugSourceUri(m,_){return Se.asDebugSourceUri(m,_)}},gy={registerTaskProvider:(m,_)=>q.registerTaskProvider(D,m,_),fetchTasks:m=>q.fetchTasks(m),executeTask:m=>q.executeTask(D,m),get taskExecutions(){return q.taskExecutions},onDidStartTask:(m,_,x)=>ge(q.onDidStartTask)(m,_,x),onDidEndTask:(m,_,x)=>ge(q.onDidEndTask)(m,_,x),onDidStartTaskProcess:(m,_,x)=>ge(q.onDidStartTaskProcess)(m,_,x),onDidEndTaskProcess:(m,_,x)=>ge(q.onDidEndTaskProcess)(m,_,x)},my={createNotebookController(m,_,x,j,Ae){return Zt.createNotebookController(D,m,_,x,j,ii(D,"notebookMessaging")?Ae:void 0)},registerNotebookCellStatusBarItemProvider:(m,_)=>$e.registerNotebookCellStatusBarItemProvider(D,m,_),createRendererMessaging(m){return mi.createRendererMessaging(D,m)},createNotebookControllerDetectionTask(m){return M(D,"notebookKernelSource"),Zt.createNotebookControllerDetectionTask(D,m)},registerKernelSourceActionProvider(m,_){return M(D,"notebookKernelSource"),Zt.registerKernelSourceActionProvider(D,m,_)},onDidChangeNotebookCellExecutionState(m,_,x){return M(D,"notebookCellExecutionState"),ge(Zt.onDidChangeNotebookCellExecutionState)(m,_,x)}},_y={t(...m){if(typeof m[0]=="string"){const _=m.shift(),x=!m||typeof m[0]!="object"?m:m[0];return re.getMessage(D.identifier.value,{message:_,args:x})}return re.getMessage(D.identifier.value,m[0])},get bundle(){return re.getBundle(D.identifier.value)},get uri(){return re.getBundleUri(D.identifier.value)}},E={_version:1,transferActiveChat(m){return M(D,"interactive"),tf.transferActiveChat(m)}},R={getRelatedInformation(m,_){return M(D,"aiRelatedInformation"),su.getRelatedInformation(D,m,_)},registerRelatedInformationProvider(m,_){return M(D,"aiRelatedInformation"),su.registerRelatedInformationProvider(D,m,_)},registerEmbeddingVectorProvider(m,_){return M(D,"aiRelatedInformation"),y1.registerEmbeddingVectorProvider(D,m,_)}},$={_version:1,registerChatResponseProvider(m,_,x){return M(D,"chatProvider"),A.registerLanguageModel(D,m,_,x)},registerChatVariableResolver(m,_,x,j,Ae,et,bt,ai){return M(D,"chatVariableResolver"),ru.registerVariableResolver(D,m,_,x,j,Ae,et,bt,ai==null?void 0:ai.id)},registerMappedEditsProvider(m,_){return M(D,"mappedEditsProvider"),Ve.registerMappedEditsProvider(D,m,_)},createChatParticipant(m,_){return tf.createChatAgent(D,m,_)},createDynamicChatParticipant(m,_,x){return M(D,"chatParticipantPrivate"),tf.createDynamicChatAgent(D,m,_,x)}},se={selectChatModels:m=>A.selectLanguageModels(D,m??{}),onDidChangeChatModels:(m,_,x)=>A.onDidChangeProviders(m,_,x),registerChatModelProvider:(m,_,x)=>(M(D,"chatProvider"),A.registerLanguageModel(D,m,_,x)),get embeddingModels(){return M(D,"embeddings"),kr.embeddingsModels},onDidChangeEmbeddingModels:(m,_,x)=>(M(D,"embeddings"),kr.onDidChange(m,_,x)),registerEmbeddingsProvider(m,_){return M(D,"embeddings"),kr.registerEmbeddingsProvider(D,m,_)},async computeEmbeddings(m,_,x){return M(D,"embeddings"),kr.computeEmbeddings(m,_,x)},registerTool(m,_){return M(D,"lmTools"),co.registerTool(D,m,_)},invokeTool(m,_,x){return M(D,"lmTools"),co.invokeTool(m,_,x)},get tools(){return M(D,"lmTools"),co.tools}},G={registerSpeechProvider(m,_){return M(D,"speech"),nf.registerProvider(D.identifier,m,_)}};return{version:e.version,ai:R,authentication:ay,commands:ly,comments:py,chat:$,debug:sf,env:cy,extensions:lu,interactive:E,l10n:_y,languages:dy,lm:se,notebooks:my,scm:fy,speech:G,tasks:gy,tests:uy,window:hy,workspace:S1,Breakpoint:Gl,TerminalOutputAnchor:nv,ChatResultFeedbackKind:Od,ChatVariableLevel:qv,ChatCompletionItem:q8,CallHierarchyIncomingCall:YS,CallHierarchyItem:sv,CallHierarchyOutgoingCall:KS,CancellationError:Ir,CancellationTokenSource:Qt,CandidatePortSource:G1,CodeAction:Mp,CodeActionKind:St,CodeActionTriggerKind:gd,CodeLens:$p,Color:Wl,ColorInformation:zp,ColorPresentation:qp,ColorThemeKind:Fs,CommentMode:kv,CommentState:Cv,CommentThreadCollapsibleState:kd,CommentThreadState:Cd,CommentThreadApplicability:Id,CommentThreadFocus:Pd,CompletionItem:Bp,CompletionItemKind:ye,CompletionItemTag:_d,CompletionList:$l,CompletionTriggerKind:Ml,ConfigurationTarget:ql,CustomExecution:wv,DebugAdapterExecutable:Kp,DebugAdapterInlineImplementation:eg,DebugAdapterNamedPipeServer:Zp,DebugAdapterServer:Ed,DebugConfigurationProviderTriggerKind:xp,DebugConsoleMode:og,DebugVisualization:F8,DecorationRangeBehavior:Xo,Diagnostic:Rp,DiagnosticRelatedInformation:ud,DiagnosticSeverity:bi,DiagnosticTag:Qo,Disposable:Qe,DocumentHighlight:Op,DocumentHighlightKind:dd,MultiDocumentHighlight:Fp,DocumentLink:Vp,DocumentSymbol:pd,EndOfLine:qn,EnvironmentVariableMutatorType:Ol,EvaluatableExpression:tg,InlineValueText:ig,InlineValueVariableLookup:ng,InlineValueEvaluatableExpression:rg,InlineCompletionTriggerKind:Sd,EventEmitter:L,ExtensionKind:na,ExtensionMode:Kl,ExternalUriOpenerPriority:Ov,FileChangeType:Ql,FileDecoration:Av,FileDecoration2:Av,FileSystemError:Yt,FileType:Co,FilePermission:fl,FoldingRange:Dv,FoldingRangeKind:Jr,FunctionBreakpoint:ia,InlineCompletionItem:dv,InlineCompletionList:hv,Hover:Lp,VerboseHover:Np,HoverVerbosityAction:rv,IndentAction:Yb,Location:gn,MarkdownString:tn,OverviewRulerLane:S_,ParameterInformation:ov,PortAutoForwardAction:Mv,Position:He,ProcessExecution:Vl,ProgressLocation:Zo,QuickInputButtonLocation:Tv,QuickInputButtons:Td,Range:Fe,RelativePattern:jl,Selection:Qr,SelectionRange:md,SemanticTokens:Jl,SemanticTokensBuilder:Pv,SemanticTokensEdit:n4,SemanticTokensEdits:sg,SemanticTokensLegend:Iv,ShellExecution:Yo,ShellQuoting:vv,SignatureHelp:lv,SignatureHelpTriggerKind:cv,SignatureInformation:av,SnippetString:Go,SourceBreakpoint:ta,StandardTokenType:Ms,StatusBarAlignment:Os,SymbolInformation:fd,SymbolKind:dt,SymbolTag:hd,Task:Gp,TaskGroup:bd,TaskPanelKind:_v,TaskRevealKind:mv,TaskScope:Ko,TerminalLink:k8,TerminalQuickFixTerminalCommand:I8,TerminalQuickFixOpener:C8,TerminalLocation:gv,TerminalProfile:P8,TerminalExitReason:pv,TerminalShellExecutionCommandLineConfidence:jp,TextDocumentSaveReason:Ul,TextEdit:Ns,SnippetTextEdit:qo,TextEditorCursorStyle:cr,TextEditorLineNumbersStyle:jn,TextEditorRevealType:Wp,TextEditorSelectionChangeKind:Hl,SyntaxTokenType:Bl,TextDocumentChangeReason:wd,ThemeColor:xd,ThemeIcon:Oi,TreeItem:Qp,TreeItemCheckboxState:gr,TreeItemCollapsibleState:ea,TypeHierarchyItem:$v,UIKind:pu,Uri:y,ViewColumn:vd,WorkspaceEdit:jo,DocumentPasteTriggerKind:xv,DocumentDropEdit:yv,DocumentDropOrPasteEditKind:zl,DocumentPasteEdit:R8,InlayHint:Hp,InlayHintLabelPart:Up,InlayHintKind:uv,RemoteAuthorityResolverError:pr,ResolvedAuthority:S8,ManagedResolvedAuthority:Tp,SourceControlInputBoxValidationType:fv,ExtensionRuntime:fg,TimelineItem:Lv,NotebookRange:Xr,NotebookCellKind:ra,NotebookCellExecutionState:Yl,NotebookCellData:lg,NotebookData:r4,NotebookRendererScript:o4,NotebookCellStatusBarAlignment:ug,NotebookEditorRevealType:dg,NotebookCellOutput:cg,NotebookCellOutputItem:s4,NotebookCellStatusBarItem:M8,NotebookControllerAffinity:Rv,NotebookControllerAffinity2:hg,NotebookEdit:Ap,NotebookKernelSourceAction:$8,NotebookVariablesRequestKind:Rd,PortAttributes:H8,LinkedEditingRanges:U8,TestResultState:Nv,TestRunRequest:pg,TestMessage:Ld,TestMessage2:Ld,TestMessageStackFrame:B8,TestTag:Nd,TestRunProfileKind:Zl,TextSearchCompleteMessageType:Tw,DataTransfer:yd,DataTransferItem:Jp,TestCoverageCount:gg,FileCoverage:sa,FileCoverage2:sa,StatementCoverage:W8,BranchCoverage:V8,DeclarationCoverage:z8,WorkspaceTrustState:Fv,LanguageStatusSeverity:Fl,QuickPickItemKind:Ad,InputBoxValidationSeverity:Xl,TabInputText:Uv,TabInputTextDiff:_g,TabInputTextMerge:a4,TabInputCustom:Hv,TabInputNotebook:Bv,TabInputNotebookDiff:Wv,TabInputWebview:l4,TabInputTerminal:c4,TabInputInteractiveWindow:u4,TabInputChat:d4,TabInputTextMultiDiff:h4,TelemetryTrustedValue:U_,LogLevel:Ye,EditSessionIdentityMatch:Kb,InteractiveSessionVoteDirection:Vv,ChatCopyKind:zv,InteractiveEditorResponseFeedbackKind:jv,DebugStackFrame:t4,DebugThread:i4,RelatedInformationType:Jv,SpeechToTextStatus:Xv,TextToSpeechStatus:Yv,PartialAcceptTriggerKind:Jo,KeywordRecognitionStatus:Kv,ChatResponseMarkdownPart:vg,ChatResponseFileTreePart:bg,ChatResponseAnchorPart:yg,ChatResponseProgressPart:$d,ChatResponseProgressPart2:f4,ChatResponseReferencePart:Yr,ChatResponseReferencePart2:Yr,ChatResponseCodeCitationPart:Eg,ChatResponseWarningPart:Ud,ChatResponseTextEditPart:Hd,ChatResponseMarkdownWithVulnerabilitiesPart:Fd,ChatResponseCommandButtonPart:xg,ChatResponseDetectedParticipantPart:Md,ChatResponseConfirmationPart:wg,ChatResponseReferencePartStatusKind:Gv,ChatRequestTurn:p4,ChatResponseTurn:g4,ChatLocation:Gn,ChatRequestEditorData:m4,ChatRequestNotebookData:_4,LanguageModelChatMessageRole:Cn,LanguageModelChatMessage:v4,LanguageModelChatMessageFunctionResultPart:Sg,LanguageModelChatResponseTextPart:Bd,LanguageModelChatResponseFunctionUsePart:Qv,LanguageModelError:Fi,NewSymbolName:N8,NewSymbolNameTag:Sv,NewSymbolNameTriggerKind:Dd,InlineEdit:j8,InlineEditTriggerKind:Wd,ExcludeSettingOptions:es,TextSearchContextNew:y4,TextSearchMatchNew:b4,TextSearchCompleteMessageTypeNew:Aw}}}var Bm;let j0=class{constructor(e,t,n,r,s,o,a){this._apiFactory=e,this._extensionRegistry=t,this._instaService=n,this._extHostConfiguration=r,this._extHostExtensionService=s,this._initData=o,this._logService=a,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),Ui("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();Ui("code/extHost/didWaitForConfig");const t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new rL(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(G0)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(Q0,t,this._initData.environment.appUriScheme))}register(e){if("nodeModuleName"in e)if(Array.isArray(e.nodeModuleName))for(const t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);typeof e.alternativeModuleName=="function"&&this._alternatives.push(t=>e.alternativeModuleName(t))}};j0=B([O(2,kf),O(3,is),O(4,js),O(5,Ei),O(6,rt)],j0);let G0=(Ja=class{constructor(e){if(e.environment.appRoot&&Bm.aliased.size){const t=wo(this.forceForwardSlashes(e.environment.appRoot.fsPath)),n="[a-z0-9_.-]",r=`@${n}+\\/${n}+|${n}+`,s="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${t}/${s}\\/)(${r})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re)return;const t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;const[,n,r,s]=t,o=Bm.aliased.get(r);if(o!==void 0)return console.warn(`${r} as been renamed to ${o}, please update your imports`),n+o+s}forceForwardSlashes(e){return e.replace(/\\/g,"/")}},Bm=Ja,Ja.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]]),Ja);G0=Bm=B([O(0,Ei)],G0);class rL{constructor(e,t,n,r,s){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=n,this._configProvider=r,this._logService=s,this.nodeModuleName="vscode",this._extApiImpl=new Vr}load(e,t){const n=this._extensionPaths.findSubstr(t);if(n){let r=this._extApiImpl.get(n.identifier);return r||(r=this._apiFactory(n,this._extensionRegistry,this._configProvider),this._extApiImpl.set(n.identifier,r)),r}if(!this._defaultApiImpl){let r="";this._extensionPaths.forEach((s,o)=>r+=`	${o} -> ${s.identifier.value}
`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${r}`),this._defaultApiImpl=this._apiFactory(UT,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let Q0=class{constructor(e,t,n){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=n.getProxy(Z.MainThreadTelemetry);const r=n.getProxy(Z.MainThreadWindow);this._impl=(s,o)=>{const a=y.parse(s);return o?this.callOriginal(s,o):a.scheme==="http"||a.scheme==="https"?r.$openUri(a,s,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this._appUriScheme?r.$openUri(a,s,{}):this.callOriginal(s,o)}}load(e,t,n){const r=this._extensionPaths.findSubstr(t);return r&&(this._extensionId=r.identifier.value,this.sendShimmingTelemetry()),this._original=n(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};Q0=B([O(2,it)],Q0);let J0=class{constructor(e,t){this._mainThreadConsole=e.getProxy(Z.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,t){const n=this,r=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){n._handleConsoleCall(e,t,r,arguments)}})}_handleConsoleCall(e,t,n,r){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:t,arguments:oL(r,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,n,r)}};J0=B([O(0,it),O(1,Ei)],J0);const sL=1e5;function oL(i,e){const t=[];if(i.length)for(let n=0;n<i.length;n++){let r=i[n];if(typeof r>"u")r="undefined";else if(r instanceof Error){const s=r;s.stack?r=s.stack:r=s.toString()}t.push(r)}if(e){const n=new Error().stack;n&&t.push({__$stack:n.split(`
`).slice(3).join(`
`)})}try{const n=YI(t);return n.length>sL?"Output omitted for a large object that exceeds the limits":n}catch(n){return`Output omitted for an object that cannot be inspected ('${n.toString()}')`}}let X0=class extends J0{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,n){t.apply(console,n)}};X0=B([O(0,it),O(1,Ei)],X0);class aL extends j0{_installInterceptor(){}getModule(e,t){for(const n of this._alternatives){const r=n(e);if(r){e=r;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}}class lL extends mb{constructor(){super(...arguments),this.extensionRuntime=fg.Webworker}async _beforeAlmostReadyToRunExtensions(){wu&&this._instaService.createInstance(X0),this._apiFactory=this._instaService.invokeFunction(nL),this._fakeModules=this._instaService.createInstance(aL,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,n){t=t.with({path:cL(t.path,".js")});const r=e==null?void 0:e.identifier.value;r&&performance.mark(`code/extHost/willFetchExtensionCode/${r}`);const s=y.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),o=await fetch(s.toString(!0));if(r&&performance.mark(`code/extHost/didFetchExtensionCode/${r}`),o.status!==200)throw new Error(o.statusText);const a=await o.text(),l=`${t.toString(!0)}#vscode-extension`,c=`${a}
//# sourceURL=${l}`;let u;try{u=new Function("module","exports","require",c)}catch(b){throw console.error(r?`Loading code for extension ${r} failed: ${b.message}`:`Loading code failed: ${b.message}`),console.error(`${t.toString(!0)}${typeof b.line=="number"?` line ${b.line}`:""}${typeof b.column=="number"?` column ${b.column}`:""}`),console.error(b),b}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const d={},f={exports:d},p=b=>{const w=this._fakeModules.getModule(b,t);if(w===void 0)throw new Error(`Cannot load module '${b}'`);return w};try{return n.codeLoadingStart(),r&&performance.mark(`code/extHost/willLoadExtensionCode/${r}`),u(f,d,p),f.exports!==d?f.exports:d}finally{r&&performance.mark(`code/extHost/didLoadExtensionCode/${r}`),n.codeLoadingStop()}}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await Or(10)}}function cL(i,e){return i.endsWith(e)?i:i+e}pt(js,lL,ut.Eager),pt(Vw,zw,ut.Eager);const r5=self.close.bind(self);self.close=()=>console.trace("'close' has been blocked");const s5=postMessage.bind(self);self.postMessage=()=>console.trace("'postMessage' has been blocked");function o5(i){return/^(file|extension-file|vscode-remote):/i.test(i)}const a5=fetch.bind(self);function uL(i){self.fetch=async function(e,t){return e instanceof Request||o5(String(e))&&(e=(await i(y.parse(String(e)))).toString(!0)),a5(e,t)},self.XMLHttpRequest=class extends XMLHttpRequest{open(e,t,n,r,s){(async()=>(o5(t.toString())&&(t=(await i(y.parse(t.toString()))).toString(!0)),super.open(e,t,n??!0,r,s)))()}}}self.importScripts=()=>{throw new Error("'importScripts' has been blocked")},self.addEventListener=()=>console.trace("'addEventListener' has been blocked"),self.AMDLoader=void 0,self.NLSLoaderPlugin=void 0,self.define=void 0,self.require=void 0,self.webkitRequestFileSystem=void 0,self.webkitRequestFileSystemSync=void 0,self.webkitResolveLocalFileSystemSyncURL=void 0,self.webkitResolveLocalFileSystemURL=void 0;function dL(i,e){if(self.Worker){const t=self.Worker;Worker=function(n,r){if(/^vscode-remote:/i.test(n.toString()))throw new Error("Creating workers from remote extensions is currently not supported.");async function s(a){const[l,c]=await Promise.all([i(a).then(p=>p.toString(!0)),e().then(p=>Object.fromEntries(p.map(([b,w])=>[b.toString(!0),w.toString(!0)])))]),d=`(${(function(b,w){function v(C){return typeof C=="string"||C instanceof URL?(C=String(C).replace(/^file:\/\//i,"vscode-file://vscode-app"),w[C]??C):C}const S=fetch.bind(self);self.fetch=function(C,N){return C instanceof Request?S(C,N):S(v(C),N)},self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments),this.notFound=!1}open(C,N,A,V,ae){const be=v(N);return this.notFound=be.startsWith("extension-file:"),super.open(C,be,A??!0,V,ae)}send(C){this.notFound||super.send(C)}get status(){return this.notFound?404:super.status}};const k=importScripts.bind(self);self.importScripts=(...C)=>{k(...C.map(v))},self.importExt=C=>new Function("url","return import(url)")(v(C)),k(b)}).toString()}('${l}', ${JSON.stringify(c)}))`,f=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(f)}r=r||{},r.name=`${name} -> ${r.name||Yi(n.toString())}`;class o{constructor(l,c){this._onmessage=null,this._onmessageerror=null,this._onerror=null,this.workerPromise=s(y.parse(l instanceof URL?l.toString():l)).then(u=>new t(u,c))}set onmessage(l){this._onmessage=l,this.workerPromise.then(c=>{c.onmessage=l},console.error)}get onmessage(){return this._onmessage}set onmessageerror(l){this._onmessageerror=l,this.workerPromise.then(c=>{c.onmessageerror=l},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(l){this._onerror=l,this.workerPromise.then(c=>{c.onerror=l},console.error)}get onerror(){return this._onerror}postMessage(l,c){this.workerPromise.then(u=>{u.postMessage(l,c)},console.error)}terminate(){this.workerPromise.then(l=>{l.terminate()},console.error)}addEventListener(l,c,u){this.workerPromise.then(d=>{d.addEventListener(l,c,u)},console.error)}removeEventListener(l,c,u){this.workerPromise.then(d=>{d.removeEventListener(l,c,u)},console.error)}dispatchEvent(l){return this.workerPromise.then(c=>{c.dispatchEvent(l)},console.error),!1}}return new o(n,r)}}else self.Worker=class extends h6{constructor(t,n){super(s5,t,{name:Yi(t.toString()),...n})}}}const hL=new class{constructor(){this.pid=void 0}exit(i){r5()}};class fL{constructor(){const e=new MessageChannel,t=new L;let n=!1;s5(e.port2,[e.port2]),e.port1.onmessage=r=>{const{data:s}=r;if(!(s instanceof ArrayBuffer)){console.warn("UNKNOWN data received",s);return}const o=De.wrap(new Uint8Array(s,0,s.byteLength));if(oC(o,Pn.Terminate)){n=!0,l5("received terminate message from renderer");return}t.fire(o)},this.protocol={onMessage:t.event,send:r=>{if(!n){const s=r.buffer.buffer.slice(r.buffer.byteOffset,r.buffer.byteOffset+r.buffer.byteLength);e.port1.postMessage(s,[s])}}}}}function pL(i){return new Promise(e=>{const t=i.onMessage(n=>{t.dispose();const r=JSON.parse(n.toString());i.send(Hy(Pn.Initialized)),e({protocol:i,initData:r})});i.send(Hy(Pn.Ready))})}let l5=i=>r5();function gL(i){return!!i&&typeof i=="object"&&i.type==="vscode.init"&&i.data instanceof Map}function mL(){Ui("code/extHost/willConnectToRenderer");const i=new fL;return{onmessage(e){gL(e)&&pL(i.protocol).then(t=>{Ui("code/extHost/didWaitForInitData");const n=new vb(t.protocol,t.initData,hL,null,e.data);uL(r=>n.asBrowserUri(r)),dL(r=>n.asBrowserUri(r),()=>n.getAllStaticBrowserUris()),l5=r=>n.terminate(r)})}}}const _L=mL();globalThis.onmessage=i=>_L.onmessage(i.data)})();
